var e,t,o,a=Object.defineProperty,i=(e,t,o)=>(((e,t,o)=>{t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o})(e,"symbol"!=typeof t?t+"":t,o),o);import{l as s,ey as n,ez as r,o as l,eA as d,bP as c,dz as u,d as m,eB as p,r as h,a as g,W as f,eC as y,eD as v,R as _,j as w,b0 as b,cM as T,b1 as x,cO as S,cP as E,eE as I,cN as C,b2 as k,eF as A,eG as j,eH as N,b4 as R,k as P,eI as D,eJ as O,eK as L,eL as F,eM as M,eN as U,eO as B,eP as V,eQ as W,eR as G,aJ as H,eS as $,eT as K,eU as z,eV as Y,eW as J,eX as q,dE as X,eY as Q,bo as Z,eZ as ee,e_ as te,e as oe,e$ as ae,f0 as ie,f1 as se,f2 as ne,f3 as re,f4 as le,f5 as de,f6 as ce,f7 as ue,f8 as me,f9 as pe,fa as he,fb as ge,fc as fe,b as ye,h as ve,V as _e,fd as we,aA as be,fe as Te,ff as xe,fg as Se,fh as Ee,fi as Ie,aR as Ce,ax as ke,fj as Ae,w as je,fk as Ne,fl as Re,fm as Pe,fn as De,fo as Oe,fp as Le,fq as Fe,fr as Me,fs as Ue,ft as Be,u as Ve,fu as We,fv as Ge,$ as He,_ as $e,d$ as Ke,a1 as ze,a2 as Ye,fw as Je,fx as qe,df as Xe,cp as Qe,fy as Ze,fz as et,fA as tt,fB as ot,fC as at,fD as it,b3 as st,fE as nt,fF as rt,fG as lt,ev as dt,fH as ct,fI as ut,b7 as mt,fJ as pt,a0 as ht,fK as gt,fL as ft,X as yt,Z as vt,d6 as _t,cA as wt,fM as bt,fN as Tt,a_ as xt,fO as St,U as Et,T as It,fP as Ct,c1 as kt,eo as At,bU as jt,bj as Nt,b$ as Rt,fQ as Pt,ep as Dt,N as Ot,fR as Lt,L as Ft,H as Mt,fS as Ut,fT as Bt,fU as Vt,fV as Wt,fW as Gt,fX as Ht,m as $t,fY as Kt,S as zt,i as Yt,fZ as Jt,f_ as qt,f$ as Xt,g0 as Qt,g1 as Zt,g2 as eo,aQ as to,g3 as oo,g4 as ao,g5 as io,g6 as so,g7 as no,g8 as ro,g9 as lo,ga as co,gb as uo,gc as mo,gd as po,ge as ho,cC as go,gf as fo,cE as yo,cD as vo,de as _o,bt as wo,v as bo,gg as To,gh as xo,gi as So,cH as Eo,z as Io,cf as Co,cg as ko,t as Ao,cV as jo,aq as No,ao as Ro,ap as Po,ar as Do,aY as Oo,aZ as Lo,cL as Fo,gj as Mo,gk as Uo,bu as Bo,bq as Vo,cq as Wo,gl as Go,gm as Ho,gn as $o,d4 as Ko,go as zo,gp as Yo,gq as Jo,gr as qo,gs as Xo,gt as Qo,gu as Zo,gv as ea,gw as ta,gx as oa,gy as aa,gz as ia,gA as sa,gB as na,gC as ra,gD as la,gE as da,gF as ca,bJ as ua,bD as ma,gG as pa,en as ha,bB as ga,bA as fa,gH as ya,gI as va,gJ as _a,gK as wa,c$ as ba,gL as Ta,f as xa,cr as Sa,cs as Ea,gM as Ia,cu as Ca,aP as ka,n as Aa,gN as ja,gO as Na,gP as Ra,gQ as Pa,gR as Da,gS as Oa,gT as La,B as Fa,gU as Ma,gV as Ua,gW as Ba,gX as Va,be as Wa,gY as Ga,gZ as Ha,g_ as $a,by as Ka,bz as za,g$ as Ya,h0 as Ja,h1 as qa,h2 as Xa,dL as Qa,c9 as Za,h3 as ei,h4 as ti,cG as oi,h5 as ai,h6 as ii,h7 as si,h8 as ni,h9 as ri,ha as li,hb as di,bL as ci,bM as ui,bN as mi,hc as pi,hd as hi,he as gi,hf as fi,hg as yi,cz as vi,hh as _i,hi as wi,hj as bi,dJ as Ti,hk as xi,hl as Si,F as Ei,hm as Ii,hn as Ci,ho as ki,hp as Ai,er as ji,aG as Ni,hq as Ri,hr as Pi,hs as Di,ht as Oi,hu as Li,es as Fi,hv as Mi,hw as Ui,hx as Bi,hy as Vi,hz as Wi,hA as Gi,hB as Hi,hC as $i,hD as Ki,hE as zi,hF as Yi,hG as Ji,dZ as qi,hH as Xi,hI as Qi,hJ as Zi,bF as es,hK as ts,hL as os,hM as as,hN as is,hO as ss,hP as ns,hQ as rs,hR as ls,hS as ds,hT as cs,bk as us,bl as ms,cb as ps,hU as hs,hV as gs,dx as fs,hW as ys,hX as vs,hY as _s,hZ as ws,h_ as bs,h$ as Ts,i0 as xs,i1 as Ss,i2 as Es,i3 as Is,i4 as Cs,i5 as ks,i6 as As,bp as js,aH as Ns,i7 as Rs}from"./vendor-3b0a39e0.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let Ps=!1;const Ds=new Set,Os=e=>Ps?(e(),()=>{}):(Ds.add(e),()=>{Ps||Ds.delete(e)});class Ls extends EventTarget{constructor(){super(),i(this,"totals",new Map),i(this,"eventThrottle"),this.dispatchUpdate=s.throttle(this.dispatchUpdate.bind(this),100,{leading:!1,trailing:!0})}dispatchUpdate(){const e=new CustomEvent("update");this.dispatchEvent(e)}clear(){this.totals=new Map,this.dispatchUpdate()}getSortedCategories(){this.totals=new Map([...this.totals].sort(((e,t)=>"uncategorized"===e[0]?-1:"uncategorized"===t[0]?1:t[1].total.time-e[1].total.time)));for(const[e,t]of this.totals)t.totalByKey=new Map([...t.totalByKey].sort(((e,t)=>t[1].time-e[1].time)));return this.totals}push(e){const t=e.labels.join(".");if(this.totals.has(e.category)){const o=this.totals.get(e.category);if(o.total.time+=e.time,o.total.hits+=e.hits,o.totalByKey.has(t)){const a=o.totalByKey.get(t);a.time+=e.time,a.hits+=e.hits}else o.totalByKey.set(t,{time:e.time,hits:e.hits})}else{const o={time:e.time,hits:e.hits};this.totals.set(e.category,{total:o,totalByKey:new Map([[t,{...o}]])})}this.dispatchUpdate()}}const Fs=new Ls,Ms=(e,t,o)=>{function a(...a){const i=performance.now(),s=o.apply(this,a),n=()=>{const o=performance.now();Fs.push({category:e,labels:t,time:o-i,hits:1})};return s instanceof Promise?s.then((e=>(n(),e))):(n(),s)}const i=o.displayName||o.name;return i&&(a.displayName=`profiled(${i})`),a.original=o,a},Us=(e,t,o)=>Ms(e,t,o)(),Bs=WebSocket.prototype.send;let Vs=0;Os((()=>{WebSocket.prototype.send=function(...e){return Vs+=1,Bs.apply(this,e)}}));function Ws(e,t=0){const[o,a]=[Math.min(e,t),Math.max(e,t)],i=Math.abs(a-o);return[...Array(i+1).keys()].map((e=>e+o))}function Gs(e,t=2){return+parseFloat((e??0).toString()).toFixed(t)}function Hs(e){return e.reduce(((e,t)=>(e[t.id]=t,e)),{})}const $s=(e,t)=>{if(!e||!t)return!1;return e.split("@")[1]===t.split("@")[1]};function Ks(e,t){return e.length>t?`${e.substr(0,t-1)}...`:e}const zs=()=>{const e=document.domain||"",t=e.startsWith("localhost");return e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||t&&["3000","4000","5000"].includes(window.location.port)||e.startsWith("192.")||e.startsWith("10.0.")||e.startsWith("10.1.")},Ys=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ");let Js=1e5;function qs(e){return(e/100).toLocaleString("en-US",{style:"currency",currency:"USD"})}function Xs(e,t,o){let a;return e.has(t)?(a=e.get(t),o.update&&(a=o.update(a),e.set(t,a))):o.insert&&(a=o.insert(),e.set(t,a)),a}const Qs="#0083e2",Zs="bar",en="40%",tn="100%",on="30%",an=3840,sn=1280,nn=10,rn=390,ln=280,dn=854,cn=100,un=["#0083e2","#a15164","#11dabf","#79d304","#0936b1","#034748","#74be2f","#886F68","#E34A6F","#FFBA08","#D00000","#75DDDD","#4B2E39","#6E9075","#f7c306","#d4ae12","#074c5a","#07d86f","#d1680c","#04248b","#7d8aee"],mn=[{en:"Afrikaans",label:"Afrikaans (Suid-Afrika)",translateCode:"af",transcriptionVariants:[{en:"Afrikaans",code:"af-ZA",label:"Afrikaans (Suid-Afrika)"}]},{en:"Albanian",label:"shqip (Shqipëri)",translateCode:"sq",transcriptionVariants:[{en:"Albanian",code:"sq-AL",label:"shqip (Shqipëri)"}]},{en:"Amharic",label:"አማርኛ (ኢትዮጵያ)",translateCode:"am",transcriptionVariants:[{en:"Amharic",code:"am-ET",label:"አማርኛ (ኢትዮጵያ)"}]},{en:"Arabic",label:"العربية",translateCode:"ar",transcriptionVariants:[{en:"Arabic",code:"ar-SA",label:"العربية"}]},{en:"Armenian",label:"Հայ (Հայաստան)",translateCode:"hy",transcriptionVariants:[{en:"Armenian",code:"hy-AM",label:"Հայ (Հայաստան)"}]},{en:"Azerbaijani",label:"Azərbaycan (Azərbaycan)",translateCode:"az",transcriptionVariants:[{en:"Azerbaijani",code:"az-AZ",label:"Azərbaycan (Azərbaycan)"}]},{en:"Basque",label:"Euskara (Espainia)",translateCode:"eu",transcriptionVariants:[{en:"Basque",code:"eu-ES",label:"Euskara (Espainia)"}]},{en:"Bengali",label:"বাংলা",translateCode:"bn",transcriptionVariants:[{en:"Bangla",code:"bn-BD",label:"বাংলা (বাংলাদেশ)"},{en:"Bangla",code:"bn-IN",label:"বাংলা (ভারত)"}]},{en:"Bulgarian",label:"Български (България)",translateCode:"bg",transcriptionVariants:[{en:"Bulgarian",code:"bg-BG",label:"Български (България)"}]},{en:"Burmese",label:"ဗမာ (မြန်မာ)",translateCode:"my",transcriptionVariants:[{en:"Burmese",code:"my-MM",label:"ဗမာ (မြန်မာ)"}]},{en:"Catalan",label:"Català (Espanya)",translateCode:"ca",transcriptionVariants:[{en:"Catalan",code:"ca-ES",label:"Català (Espanya)"}]},{en:"Chinese (Simplified)",label:"普通話",noSpaces:!0,translateCode:"zh",transcriptionVariants:[{en:"Chinese, Cantonese ",code:"yue-Hant-HK",label:"粵語"},{en:"Chinese, Mandarin (Simplified)",code:"cmn-Hans-CN",label:"普通话 简体"}]},{en:"Chinese (Traditional)",label:"國語 (台灣)",noSpaces:!0,translateCode:"zh-TW",transcriptionVariants:[]},{en:"Croatian",label:"Hrvatski (Hrvatska)",translateCode:"hr",transcriptionVariants:[{en:"Croatian",code:"hr-HR",label:"Hrvatski (Hrvatska)"}]},{en:"Czech",label:"Čeština (Česká republika)",translateCode:"cs",transcriptionVariants:[{en:"Czech",code:"cs-CZ",label:"Čeština (Česká republika)"}]},{en:"Danish",label:"Dansk (Danmark)",translateCode:"da",transcriptionVariants:[{en:"Danish",code:"da-DK",label:"Dansk (Danmark)"}]},{en:"Dutch",label:"Nederlands (Nederland)",translateCode:"nl",transcriptionVariants:[{en:"Dutch",code:"nl-NL",label:"Nederlands (Nederland)"}]},{en:"English",label:"English",translateCode:"en",transcriptionVariants:[{en:"English",code:"en-AU",label:"English (Australia)"},{en:"English",code:"en",label:"English (Global)"},{en:"English",code:"en-GB",label:"English (United Kingdom)"},{en:"English",code:"en-US",label:"English (United States)"}]},{en:"Estonian",label:"eesti keel (Eesti)",translateCode:"et",transcriptionVariants:[{en:"Estonian",code:"et-EE",label:"eesti keel (Eesti)"}]},{en:"Finnish",label:"Suomi (Suomi)",translateCode:"fi",transcriptionVariants:[{en:"Finnish",code:"fi-FI",label:"Suomi (Suomi)"}]},{en:"French",label:"Français",translateCode:"fr",transcriptionVariants:[{en:"French",code:"fr-FR",label:"Français"}]},{en:"Galician",label:"Galego (España)",translateCode:"gl",transcriptionVariants:[{en:"Galician",code:"gl-ES",label:"Galego (España)"}]},{en:"Georgian",label:"ქართული (საქართველო)",translateCode:"ka",transcriptionVariants:[{en:"Georgian",code:"ka-GE",label:"ქართული (საქართველო)"}]},{en:"German",label:"Deutsch (Deutschland)",translateCode:"de",transcriptionVariants:[{en:"German",code:"de-DE",label:"Deutsch (Deutschland)"}]},{en:"Greek",label:"Ελληνικά (Ελλάδα)",translateCode:"el",transcriptionVariants:[{en:"Greek",code:"el-GR",label:"Ελληνικά (Ελλάδα)"}]},{en:"Gujarati",label:"ગુજરાતી (ભારત)",translateCode:"gu",transcriptionVariants:[{en:"Gujarati",code:"gu-IN",label:"ગુજરાતી (ભારત)"}]},{en:"Hebrew",label:"עברית (ישראל)",translateCode:"he",transcriptionVariants:[{en:"Hebrew",code:"he-IL",label:"עברית (ישראל)"}]},{en:"Hindi",label:"हिन्दी (भारत)",translateCode:"hi",transcriptionVariants:[{en:"Hindi",code:"hi-IN",label:"हिन्दी (भारत)"}]},{en:"Hungarian",label:"Magyar (Magyarország)",translateCode:"hu",transcriptionVariants:[{en:"Hungarian",code:"hu-HU",label:"Magyar (Magyarország)"}]},{en:"Icelandic",label:"Íslenska (Ísland)",translateCode:"is",transcriptionVariants:[{en:"Icelandic",code:"is-IS",label:"Íslenska (Ísland)"}]},{en:"Indonesian",label:"Bahasa Indonesia",translateCode:"id",transcriptionVariants:[{en:"Indonesian",code:"id-ID",label:"Bahasa Indonesia (Indonesia)"}]},{en:"Italian",label:"Italiano (Italia)",translateCode:"it",transcriptionVariants:[{en:"Italian",code:"it-IT",label:"Italiano (Italia)"}]},{en:"Japanese",label:"日本語（日本）",noSpaces:!0,translateCode:"ja",transcriptionVariants:[{en:"Japanese",code:"ja-JP",label:"日本語（日本）"}]},{en:"Javanese",label:"Jawa (Indonesia)",translateCode:"jv",transcriptionVariants:[{en:"Javanese",code:"jv-ID",label:"Jawa (Indonesia)"}]},{en:"Kannada",label:"ಕನ್ನಡ (ಭಾರತ)",translateCode:"kn",transcriptionVariants:[{en:"Kannada",code:"kn-IN",label:"ಕನ್ನಡ (ಭಾರತ)"}]},{en:"Kazakh",label:"қазақ (Қазақстан)",translateCode:"kk",transcriptionVariants:[{en:"Kazakh",code:"kk-KZ",label:"қазақ (Қазақстан)"}]},{en:"Khmer",label:"ភាសាខ្មែរ (កម្ពុជា)",translateCode:"km",noSpaces:!0,transcriptionVariants:[{en:"Khmer",code:"km-KH",label:"ភាសាខ្មែរ (កម្ពុជា)"}]},{en:"Kinyarwanda",label:"Kinyarwanda (Rwanda)",translateCode:"rw",transcriptionVariants:[{en:"Kinyarwanda",code:"rw-RW",label:"Kinyarwanda (Rwanda)"}]},{en:"Korean",label:"한국어 (대한민국)",translateCode:"ko",transcriptionVariants:[{en:"Korean",code:"ko-KR",label:"한국어 (대한민국)"}]},{en:"Lao",label:"ລາວ (ລາວ)",translateCode:"lo",noSpaces:!0,transcriptionVariants:[{en:"Lao",code:"lo-LA",label:"ລາວ (ລາວ)"}]},{en:"Latvian",label:"Latviešu (latviešu)",translateCode:"lv",transcriptionVariants:[{en:"Latvian",code:"lv-LV",label:"Latviešu (latviešu)"}]},{en:"Lithuanian",label:"Lietuvių (Lietuva)",translateCode:"lt",transcriptionVariants:[{en:"Lithuanian",code:"lt-LT",label:"Lietuvių (Lietuva)"}]},{en:"Macedonian",label:"македонски (Северна Македонија)",translateCode:"mk",transcriptionVariants:[{en:"Macedonian",code:"mk-MK",label:"македонски (Северна Македонија)"}]},{en:"Malay",label:"Bahasa Melayu (Malaysia)",translateCode:"ms",transcriptionVariants:[{en:"Malay",code:"ms-MY",label:"Bahasa Melayu (Malaysia)"}]},{en:"Malayalam",label:"മലയാളം (ഇന്ത്യ)",translateCode:"ml",transcriptionVariants:[{en:"Malayalam",code:"ml-IN",label:"മലയാളം (ഇന്ത്യ)"}]},{en:"Marathi",label:"मराठी (भारत)",translateCode:"mr",transcriptionVariants:[{en:"Marathi",code:"mr-IN",label:"मराठी (भारत)"}]},{en:"Mongolian",label:"Монгол (Монгол)",translateCode:"mn",transcriptionVariants:[{en:"Mongolian",code:"mn-MN",label:"Монгол (Монгол)"}]},{en:"Nepali",label:"नेपाली (नेपाल)",translateCode:"ne",transcriptionVariants:[{en:"Nepali",code:"ne-NP",label:"नेपाली (नेपाल)"}]},{en:"Norwegian",label:"Norsk",translateCode:"no",transcriptionVariants:[{en:"Norwegian",code:"no-NO",label:"Norsk bokmål (Norge)"}]},{en:"Oromo",label:"Afaan Oromoo",translateCode:"om",transcriptionVariants:[]},{en:"Persian",label:"فارسی",translateCode:"fa",transcriptionVariants:[{en:"Persian",code:"fa-IR",label:"فارسی (ایران)"}]},{en:"Polish",label:"Polski (Polska)",translateCode:"pl",transcriptionVariants:[{en:"Polish",code:"pl-PL",label:"Polski (Polska)"}]},{en:"Portuguese",label:"Português",translateCode:"pt",transcriptionVariants:[{en:"Portuguese",code:"pt-BR",label:"Português (Brasil)"},{en:"Portuguese",code:"pt-PT",label:"Português (Portugal)"}]},{en:"Punjabi",label:"ਪੰਜਾਬੀ (ਗੁਰਮੁਖੀ ਭਾਰਤ)",translateCode:"pa",transcriptionVariants:[{en:"Punjabi",code:"pa-Guru-IN",label:"ਪੰਜਾਬੀ (ਗੁਰਮੁਖੀ ਭਾਰਤ)"}]},{en:"Romanian",label:"Română (România)",translateCode:"ro",transcriptionVariants:[{en:"Romanian",code:"ro-RO",label:"Română (România)"}]},{en:"Russian",label:"Русский (Россия)",translateCode:"ru",transcriptionVariants:[{en:"Russian",code:"ru-RU",label:"Русский"}]},{en:"Serbian",label:"Српски (Србија)",translateCode:"sr",transcriptionVariants:[{en:"Serbian",code:"sr-RS",label:"Српски (Србија)"}]},{en:"Sesotho",label:"Sesotho (Afrika Borwa)",translateCode:"st",transcriptionVariants:[{en:"Sesotho",code:"st-ZA",label:"Sesotho (Afrika Borwa)"}]},{en:"Sinhala (Sinhalese)",label:"සිංහල (ශ්රී ලංකාව)",translateCode:"si",transcriptionVariants:[{en:"Sinhala",code:"si-LK",label:"සිංහල (ශ්රී ලංකාව)"}]},{en:"Slovak",label:"Slovenčina (Slovensko)",translateCode:"sk",transcriptionVariants:[{en:"Slovak",code:"sk-SK",label:"Slovenčina (Slovensko)"}]},{en:"Slovenian",label:"Slovenščina (Slovenija)",translateCode:"sl",transcriptionVariants:[{en:"Slovenian",code:"sl-SI",label:"Slovenščina (Slovenija)"}]},{en:"Spanish",label:"Español",translateCode:"es",transcriptionVariants:[{en:"Spanish",code:"es-MX",label:"Español"}]},{en:"Sundanese",label:"Urang (Indonesia)",translateCode:"su",transcriptionVariants:[{en:"Urang",code:"su-ID",label:"Urang (Indonesia)"}]},{en:"Swahili",label:"Swahili",translateCode:"sw",transcriptionVariants:[{en:"Swahili",code:"sw-KE",label:"Swahili (Kenya)"},{en:"Swahili",code:"sw-TZ",label:"Swahili (Tanzania)"}]},{en:"Swedish",label:"Svenska (Sverige)",translateCode:"sv",transcriptionVariants:[{en:"Swedish",code:"sv-SE",label:"Svenska (Sverige)"}]},{en:"Tagalog",label:"Filipino (Pilipinas)",translateCode:"tl",transcriptionVariants:[{en:"Filipino",code:"fil-PH",label:"Filipino (Pilipinas)"}]},{en:"Tamil",label:"தமிழ்",translateCode:"ta",transcriptionVariants:[{en:"Tamil",code:"ta-IN",label:"தமிழ் (இந்தியா)"},{en:"Tamil",code:"ta-MY",label:"தமிழ் (மலேசியா)"},{en:"Tamil",code:"ta-SG",label:"தமிழ் (சிங்கப்பூர்)"},{en:"Tamil",code:"ta-LK",label:"தமிழ் (இலங்கை)"}]},{en:"Telugu",label:"తెలుగు (భారతదేశం)",translateCode:"te",transcriptionVariants:[{en:"Telugu",code:"te-IN",label:"తెలుగు (భారతదేశం)"}]},{en:"Thai",label:"ไทย (ประเทศไทย)",translateCode:"th",noSpaces:!0,transcriptionVariants:[{en:"Thai",code:"th-TH",label:"ไทย (ประเทศไทย)"}]},{en:"Turkish",label:"Türkçe (Türkiye)",translateCode:"tr",transcriptionVariants:[{en:"Turkish",code:"tr-TR",label:"Türkçe (Türkiye)"}]},{en:"Ukrainian",label:"Українська (Україна)",translateCode:"uk",transcriptionVariants:[{en:"Ukrainian",code:"uk-UA",label:"Українська (Україна)"}]},{en:"Urdu",label:"اردو",translateCode:"ur",transcriptionVariants:[{en:"Urdu",code:"ur-IN",label:"اردو (بھارت)"},{en:"Urdu",code:"ur-PK",label:"اردو (پاکستان)"}]},{en:"Uzbek",label:"O'zbek (O'zbekiston)",translateCode:"uz",transcriptionVariants:[{en:"Uzbek",code:"uz-UZ",label:"O'zbek (O'zbekiston)"}]},{en:"Vietnamese",label:"Tiếng Việt (Việt Nam)",translateCode:"vi",transcriptionVariants:[{en:"Vietnamese",code:"vi-VN",label:"Tiếng Việt (Việt Nam)"}]},{en:"Xhosa",label:"IsiXhosa (eMzantsi Afrika)",translateCode:"xh",transcriptionVariants:[{en:"Xhosa",code:"xh-ZA",label:"IsiXhosa (eMzantsi Afrika)"}]},{en:"Zulu",label:"IsiZulu (Ningizimu Afrika)",translateCode:"zu",transcriptionVariants:[{en:"Zulu",code:"zu-ZA",label:"IsiZulu (Ningizimu Afrika)"}]}],pn=new Map;for(const FB of mn){pn.set(FB.translateCode,FB);for(const e of FB.transcriptionVariants)pn.set(e.code,FB)}const hn="kapwing-useast1",gn="https://storage.googleapis.com",fn="https://cdn.kapwing.com",yn="https://cdn-useast1.kapwing.com",vn=1048576,_n=1024*vn,wn=1e3,bn=864e5,Tn={justForYou20:{discountPercentage:20,activeOnDay:7,expiresOnDay:10},justForYou25:{discountPercentage:25,activeOnDay:10,expiresOnDay:14},justForYou30:{discountPercentage:30,activeOnDay:14,expiresOnDay:21}},xn=Object.keys(Tn),Sn=1e3,En="639a7747d4a7387dad8ae8ff",In="0.9",Cn="0.9".split(".").map((e=>parseInt(e)));var kn=(e=>(e[e.personal=0]="personal",e[e.team=1]="team",e))(kn||{});const An="Untitled Project",jn="Untitled Export",Nn="62962eab0af119277ab7c9c3",Rn="62d61954f85729d3ec1db3f4",Pn=["#53E4DC","#F35D93","#FFD53F"],Dn=["https://cdn-useast1.kapwing.com/static/MHQ-workspace_default_logo_1.webp","https://cdn-useast1.kapwing.com/static/9X9-workspace_default_logo_2.webp","https://cdn-useast1.kapwing.com/static/7k2-workspace_default_logo_3.webp","https://cdn-useast1.kapwing.com/static/4Y--workspace_default_logo_4.webp","https://cdn-useast1.kapwing.com/static/Jm2-workspace_default_logo_5.webp","https://cdn-useast1.kapwing.com/static/62Z-workspace_default_logo_6.webp"],On=Object.freeze({failed:-1,pending:0,uploading:1,uploaded:2});var Ln=(e=>(e[e.public_write=-1]="public_write",e[e.unlisted=0]="unlisted",e[e.private=1]="private",e))(Ln||{}),Fn=(e=>(e.unlisted="unlisted",e.private="private",e))(Fn||{});const Mn=Object.freeze({admin:100,free:0,student:"student",teacher:"teacher",googleAppLicenseUser:"googleAppLicenseUser"});var Un=(e=>(e[e.creator=0]="creator",e[e.teamMember=1]="teamMember",e[e.invited=2]="invited",e[e.pending=3]="pending",e))(Un||{});const Bn=Object.freeze({member:0,owner:1}),Vn="shared-with-me";var Wn=(e=>(e.ScheduledMarketingEmail="SME",e.RequestToEditEmail="RTE",e.RequestToJoinEmail="RTJ",e))(Wn||{});const Gn="1080p",Hn="4K",$n=["AUTO","480p","720p","1080p","4K"];var Kn=(e=>(e.IMAGE="image",e.MP4="mp4",e.MP3="mp3",e.GIF="gif",e))(Kn||{});const zn="https://cdn-useast1.kapwing.com/static/Z69-Untitled_Export-xwaurqQYg.webp",Yn="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Jn=["uh","um","uh huh","hmm","hm","mhm","m","ah"],qn={failed:-1,started:0,completed:1},Xn=mn.flatMap((({translateCode:e,transcriptionVariants:t})=>t.map((t=>({en:t.en,code:t.code,label:t.label,translateCode:e}))))).sort(((e,t)=>e.en.localeCompare(t.en))),Qn=mn.map((e=>({en:e.en,label:e.label,code:e.translateCode}))),Zn=3,er=6e4,tr=6e4,or="Trending Now";let ar=null;try{ar="undefined"!=typeof window?n():null}catch(IGe){console.error(IGe)}ar&&ar.listen((e=>{r.pageview(e.pathname)}));const ir=ar;function sr(){if(!globalThis.globalStore)throw new Error("No Global Store Available");const e=globalThis.globalStore,t=e.dispatch,o=e.getState();return{dispatch:t,history:ir,get layers(){return function(e){let t=[];const{scenes:o}=e||{};if(o)for(const a of o)t=[...t,...a.layers];return t}(o.studio)},state:o,store:e,subscribe:e.subscribe}}const nr={epochs:["yr","month","day","hr","min"],yr:31536e3,month:2592e3,day:86400,hr:3600,min:60},rr=new Date;function lr(e,t){try{const t=function(e){for(let t=0;t<nr.epochs.length;t+=1){const o=nr.epochs[t];if(!o)continue;const a=Math.floor(e/nr[o]);if(a>=1)return{interval:a,epoch:o}}return null}(Math.floor((new Date-new Date(e))/1e3)),o=t.interval>1||0===t.interval?"s":"";return`${t.interval} ${t.epoch}${o}`}catch(IGe){return t||"a little while"}}function dr(e,t={}){const{excludeMs:o,msPrecision:a=2,dontPadMax:i}=t,s=!i,n=Number(Number.parseFloat(e).toFixed(a));if(Number.isNaN(n))return"0.00";const r=Math.round(1e3*n),l=Math.floor(r%1e3),d=Math.floor(n%60),c=Math.floor(r/6e4%60),u=Math.floor(r/36e5%60);let m=l.toString(),p=d.toString(),h=c.toString(),g=u.toString();u<10&&s&&(g=`0${u}`),c<10&&(u>0||s)&&(h=`0${c}`),d<10&&(u>0||c>0||s)&&(p=`0${d}`),l<100&&(m=`0${l}`),l<10&&a>2&&(m=`0${m}`);let f=`${p}`;return o||(f=`${p}.${m.slice(0,a)}`),(c>0||parseFloat(g))&&(f=`${h}:${f}`),u>0&&(f=`${g}:${f}`),f}function cr(e,t,o){let a=dr(e,o);return t||(a=a.replace(".00","")),a.includes(":")||(a=`0:${a}`),a.startsWith("0")&&!a.startsWith("0:")&&(a=a.slice(1)),a}const ur=(e,t)=>{const o=e.getTime(),a=t.getTime();return Math.floor(Math.abs(o-a)/864e5)},mr=e=>{const t=l(new Date).diff(e,"days"),o=l(e).day(),a=l().day(),i=l().subtract(1,"days").day();return t<7?o===a?l(e).format("[today at] h:mma"):o===i?l(e).format("[yesterday at] h:mma"):l(e).format("[last] dddd [at] h:mma"):l(e).format("MM/DD/YYYY")},pr=e=>{const t=l(e).get("date"),o=l().get("date"),a=l().subtract(1,"days").get("date");return t===o?l(e).format("[today at] h:mma"):t===a?l(e).format("[yesterday at] h:mma"):l(e).format("MM/DD/YYYY")};function hr(e){const t=new Date(1e3*e);return`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()}`}function gr(e){const t=Math.floor(e/1e3),o=Math.floor(t/60),a=Math.floor(o/60),i=t%60,s=o%60;return a>0?`${a}h ${s}m`:o>0?`${s}m ${i}s`:`${i}s`}function fr(e){return`${gr(e)} ago`}const yr=e=>{if(!e)return null;const t=/^(?:\d+h)?(?:\d+m)?(?:\d+s)?$/gi.test(e),o=/^\d*\.?\d*$/gi.test(e),a=/^(\d{1,2}:)?(\d{1,2}:)(\d{1,2})(\.\d*)?$/gi.test(e);if(!(t||o||a))return null;const i={h:0,m:0,s:0};if(o)i.s+=parseFloat(e);else if(t)e.toLowerCase().split(/(.*?[h|m|s])/gi).forEach((e=>{if(!e)return;const t=parseFloat(e),o=e[e.length-1];i[o]+=t}));else if(a){const t=e.split(":");if(2===t.length){const[e,o]=t;i.m+=parseFloat(e),i.s+=parseFloat(o)}else{const[e,o,a]=t;i.h+=parseFloat(e),i.m+=parseFloat(o),i.s+=parseFloat(a)}}return 60*i.h*60+60*i.m+i.s},vr={COMMIT:"fb81cb8c",IN_GKE:!0,NODE_ENV:"production",REACT_APP_KAPWING_SERVER:"production",SENTRY_ENV:"production",VERSION:"v2023.12.22.1",REACT_CUSTOM_PROFILER:!1,DEPLOY_TARGET:""}.JEST_WORKER_ID,_r={COMMIT:"fb81cb8c",IN_GKE:!0,NODE_ENV:"production",REACT_APP_KAPWING_SERVER:"production",SENTRY_ENV:"production",VERSION:"v2023.12.22.1",REACT_CUSTOM_PROFILER:!1,DEPLOY_TARGET:""}.KAPWING_NOTIFICATION_URL,wr=vr||document.domain.startsWith("localhost");function br(){return{type:"REQUEST_USER"}}function Tr(){const e=new d;return e.remove("ssrSignedInCookie",{path:"/"}),e.remove("samlSignedInCookie",{path:"/"}),{type:"SIGN_OUT"}}function xr(){return new Worker("/assets/gzip-worker-4454b757.js")}function Sr(e,t,o,a){const[i,s]=e<t?[e,t]:[t,e],[n,r]=o<a?[o,a]:[a,o];return i<r&&n<s}function Er(e){return null!==e}function Ir(e){return null!=e}function Cr(e){return new Promise((t=>setTimeout(t,e)))}function kr(){return void 0!==vr}const Ar="You might want to add { supportPortals: true } to your render.";function jr(e){return e.map((e=>({value:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({value:e})=>e))}function Nr(e,t){return[...e].some((e=>t.has(e)))}function Rr(){return"v2023.12.22.1"}function Pr(){let e="local";return e="fb81cb8c","fb81cb8c"}const Dr={Accept:"application/json","Content-Type":"application/json","X-Client-Version":"v2023.12.22.1"},Or={method:"GET",parseJSON:!0,timeout:3e4},Lr="undefined"!=typeof window;function Fr(){return Lr?window.location.host:"localhost:5000"}function Mr(){let e=Fr();return e=e.startsWith("http")?e.replace("http","ws"):e.startsWith("localhost")?`ws://${e}/websocket`:`wss://${e}/websocket`,e=e.replace("localhost:3000","localhost:5000"),e}function Ur(){return["127.0.0.1","localhost"].some((e=>Fr().startsWith(e)))}function Br(e){if(e.includeAuth){const a=(null==(o=null==(t=sr().state)?void 0:t.currentUser)?void 0:o.token)||"";a&&(e.headers={"x-access-token":a,...e.headers||{}})}var t,o}function Vr(e,t){let o=e;const{params:a}=t;if(a){const t=e.includes("?")?"&":"?",i=function(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(a);o+=`${t}${i}`}return o}async function Wr(e,t={}){var o;const a={...Or,...t},{body:i,parseJSON:s,timeout:n=3e4,retries:r=0}=a;delete a.parseJSON,a.headers={...Dr,...a.headers||{}};const l="multipart/form-data"===(null==(o=a.headers)?void 0:o.enctype);l&&"Content-Type"in a.headers&&delete a.headers["Content-Type"],"object"!=typeof i||l||(a.body=JSON.stringify(a.body));let d,m;a.body&&"string"==typeof a.body&&a.body.length>5e4&&!l&&"string"==typeof a.body&&(a.headers={...a.headers,"Content-Encoding":"gzip"},a.body=await async function(e){return new Promise(((t,o)=>{const a=new xr;a.postMessage(e),a.onmessage=e=>{a.terminate(),t(e.data)},a.onerror=()=>{a.terminate(),o()}}))}(a.body));const p=new Date;let h=null,g=0;const f=Lr&&window.openReplayFetch;for(;g<=r;){n&&(delete a.timeout,m=new(f?window.AbortController:AbortController),a.signal=t.signal||m.signal,d=setTimeout((()=>{console.debug("timeout on url",e," req sent on ",p," options are ",JSON.stringify(a)),m.abort()}),n));const o=Vr(e,a);try{const t=f?window.openReplayFetch:c;h=await t(o,a),h.ok||await Gr(e,h);break}catch(y){if(g>=r||kr())throw y;u({category:"fetch retry",message:`Url ${e} retry ${g}`}),g+=1,await new Promise((e=>setTimeout(e,2**g*1e3)))}finally{d&&clearTimeout(d)}}return h&&!h.ok&&await Gr(e,h),s?h.json():h}async function Gr(e,t){let o=t.statusText||"An unexpected error occurred.",a=null;try{const e=await t.json(),{message:i,statusText:s,invalid_token:n,error:r,...l}=e;o=i||s||r,Object.keys(l).length>0&&(a=l),n&&(sr().dispatch(Tr()),o="Your token was invalid. Please sign in again.")}catch(i){try{o=await t.text()||o}catch(s){}}throw new Hr(o,t.status,e,a)}class Hr extends Error{constructor(e,t,o,a){super(e),i(this,"name","FetchStatusError"),this.status=t,this.url=o,this.additionalData=a}}async function $r(e,t={}){return async function(e,t={}){const o={...t,includeAuth:!0};let a;if(Br(o),_r)a=_r;else{a=`https://notifications.${Ur()||Fr().includes("dev")?"kapwing-dev":"kapwing"}.com`}return Wr(`${a}/${e}`,o)}(e,{...t,method:"POST"})}async function Kr(e,t={}){const o={...t,includeAuth:!0};Br(o);return Wr(`${Ur()?"http":"https"}://${Fr()}${e}`,o)}function zr(e,t={}){return Kr(e,{...t,method:"DELETE"})}function Yr(e,t={}){return Kr(e,{...t,method:"GET"})}function Jr(e,t={}){return Kr(e,{...t,method:"POST"})}function qr(e,t={}){return Kr(e,{...t,method:"PUT"})}function Xr(e,t={}){return Kr(e,{...t,method:"PATCH"})}function Qr(e,t={}){return function(e,t={}){Br(t);const{CLOUD_FUNCTIONS_PREFIX:o}=sr().state.config;return Wr(`https://us-central1-kapwing-181323.cloudfunctions.net/${o}${e}`,t)}(e,{...t,method:"POST"})}const Zr={};window.location.hostname.endsWith("kapwing.com")||(Zr.strictSelectors=!0);const el=(e,t)=>Object.is(e,t),tl=(e,t=el)=>{const[,o]=h.useReducer((e=>e+1),0),a=h.useContext(g.ReactReduxContext),i=h.useRef(e),s=h.useRef(),n=h.useRef(),r=h.useRef(!1),l=h.useRef(),d=h.useRef(t);d.current=t,l.current&&(console.error("Selectors are meant to return the same value for the same store. this selector is broken. please fix",e),l.current=!1);const c=h.useCallback(((e,t)=>{const a=t(e);if(!d.current(n.current,a)&&(n.current=a,r.current||(o(),r.current=!0),Zr.strictSelectors&&void 0===l.current)){const o=t(e);d.current(o,n.current)||(l.current=!0)}}),[]),u=a.store.getState();return null==s.current?(s.current=u,n.current=e(s.current)):s.current===u&&e===i.current||(s.current=u,c(u,e)),i.current=e,h.useLayoutEffect((()=>{r.current=!1})),h.useLayoutEffect((()=>a.store.subscribe((()=>{const e=a.store.getState();Object.is(e,s.current)||(s.current=e,c(e,i.current))}))),[c]),n.current},ol=g.shallowEqual,al=g.batch,il=g.useDispatch;m((e=>e.studio.scenes),(e=>e.some((({layers:e})=>e.some((({type:e})=>"audio"===e||"video"===e))))));let sl=!1;const nl=e=>{var t,o,a;const i=e.playbackRate||1;let s=0;if(e.isTrimmed){const{endTime:o,startTime:a=0}=e;s=Math.min(o,(null==(t=e.preview)?void 0:t.duration)||o)-a}else e.duration&&(s=(null==(o=e.preview)?void 0:o.duration)||e.duration,(null==(a=e.preview)?void 0:a.duration)&&Math.abs(e.duration-e.preview.duration)>.5&&!sl&&(f("Preview duration very different from original",{extra:{layerId:e.id}}),sl=!0));return s/i};function rl(e){for(const t in e)delete e[t]}const ll=p(y,ol),dl=p(y,s.isEqual),cl=v({initialState:{},name:"sessionValues",reducers:{setOnboarding:(e,t)=>{e.onboarding=t.payload},setShowRequestEditModal:(e,t)=>{e.showRequestEditModal=t.payload},setShowRemoveFillerWordsModal:(e,t)=>{e.showRemoveFillerWordsModal=t.payload},setHideTimeline:(e,t)=>{e.hideTimeline=t.payload}},extraReducers:e=>e.addCase("SIGN_OUT",(e=>{rl(e)}))}),{setOnboarding:ul,setShowRequestEditModal:ml,setShowRemoveFillerWordsModal:pl,setHideTimeline:hl}=cl.actions,gl={},fl=v({name:"toasts",initialState:gl,reducers:{clearToasts:()=>gl,hideToast:(e,t)=>{const o=e[t.payload];o&&(o.open=!1)},removeToast:(e,t)=>{delete e[t.payload]},showToast:(e,t)=>{if(Object.values(e).some((e=>e.open&&e.type===t.payload.type&&e.link===t.payload.link&&e.description===t.payload.description&&e.subDescription===t.payload.subDescription)))return;e[(Js+=1,String(Js))]={...t.payload,open:!0}}}}),{clearToasts:yl,hideToast:vl,removeToast:_l,showToast:wl}=fl.actions;function bl(e){r.event({category:e,action:e,label:e})}var Tl=(e=>(e.Email="email",e.InApp="inApp",e))(Tl||{}),xl=(e=>(e.Export="export",e.Invite="invite",e.Comment="comment",e.Request="request",e.Scheduled="scheduled",e.Joined="joined",e.Welcome="welcome",e))(xl||{}),Sl=(e=>(e.unsent="unsent",e.sent="sent",e.read="read",e))(Sl||{}),El=(e=>(e.project="project",e.folder="folder",e.team="team",e))(El||{}),Il=(e=>(e.Month="month",e.Year="year",e.None="none",e))(Il||{}),Cl=(e=>(e.Free="free",e.Basic="basic",e.Pro="pro",e.Team="team",e.Edu="edu",e.Business="business",e.Enterprise="enterprise",e))(Cl||{}),kl=(e=>(e[e.Editor=0]="Editor",e[e.Admin=1]="Admin",e))(kl||{});const Al={0:"Editor",1:"Admin"},jl=250,Nl=6,Rl=240,Pl=4,Dl=7200,Ol=2,Ll=3600,Fl=3,Ml=10800,Ul=2;var Bl=(e=>(e.NO_UPSELLS="NO_UPSELLS",e.REPORT_ISSUE="REPORT_ISSUE",e.ALLOW_STOCK_CONTENT="ALLOW_STOCK_CONTENT",e.CHANGE_PRIVACY="CHANGE_PRIVACY",e.CLEAN_AUDIO="CLEAN_AUDIO",e.CREATE_NEW_FOLDER="CREATE_NEW_FOLDER",e.EXPORT_ALL_WITHOUT_WATERMARK="EXPORT_ALL_WITHOUT_WATERMARK",e.EXPORT_30_SEC_WITHOUT_WATERMARK="EXPORT_30_SEC_WITHOUT_WATERMARK",e.HIGH_QUALITY="HIGH_QUALITY",e.UNLIMITED_EXPORT_DURATION_LIMIT="UNLIMITED_EXPORT_DURATION_LIMIT",e.UNLIMITED_UPLOAD_SIZE_LIMIT="UNLIMITED_UPLOAD_SIZE_LIMIT",e.REMOVE_BACKGROUND="REMOVE_BACKGROUND",e.SMART_CUT="SMART_CUT",e.AUDIOGRAM="AUDIOGRAM",e.UNLIMITED_STORAGE="UNLIMITED_STORAGE",e.NO_CUMULATIVE_DURATION_LIMIT="NO_CUMULATIVE_DURATION_LIMIT",e.SUBTITLER="SUBTITLER",e.TRANSCRIBE="TRANSCRIBE",e.TEXT_TO_SPEECH="TEXT_TO_SPEECH",e.VOICE_DUBBING="VOICE_DUBBING",e.BRANDKIT="BRANDKIT",e.FAST_EXPORT="FAST_EXPORT",e.ROYALTY_FREE="ROYALTY_FREE",e.CHANGE_MEMBER_ROLES="CHANGE_MEMBER_ROLES",e.SUBTITLE_PRESETS="SUBTITLE_PRESETS",e.TEXT_PRESETS="TEXT_PRESETS",e.TEXT_TEMPLATES="TEXT_TEMPLATES",e.GENERATE_IMAGES="GENERATE_IMAGES",e.GENERATE_LONG_DURATION_AI="GENERATE_LONG_DURATION_AI",e.GENERATE_SCRIPT="GENERATE_SCRIPT",e.GENERATE_DOCUMENT_TO_VIDEO="GENERARATE_DOCUMENT_TO_VIDEO",e.GENERATE_MEME="GENERATE_MEME",e.GENERATE_TTS_VIDEO="GENERATE_TTS_VIDEO",e.GENERATE_VIDEO="GENERATE_VIDEO",e.GENERATE_ARTICLE_TO_VIDEO="GENERATE_ARTICLE_TO_VIDEO",e.GENERATE_SCRIPT_TO_VIDEO="GENERATE_SCRIPT_TO_VIDEO",e.GENERATE_SCRIPT_IN_SCRIPT_TO_VIDEO="GENERATE_SCRIPT_IN_SCRIPT_TO_VIDEO",e.GENERATE_B_ROLL="GENERATE_B_ROLL",e.PREMIUM_ASSETS="PREMIUM_ASSETS",e.USE_MAGIC_FILL="USE_MAGIC_FILL",e.SSO_LOGIN="SSO_LOGIN",e.MORE_AUTO_TRANSLATE="MORE_AUTO_TRANSLATE",e.ENHANCE_IMAGE="ENHANCE_IMAGE",e.NO_LIMITS_PAYWALL="NO_LIMITS_PAYWALL",e.CLONED_VOICES="CLONED_VOICES",e.CLONED_VOICES_LIMIT="CLONED_VOICES_LIMIT",e))(Bl||{}),Vl=(e=>(e.AUDIOGRAM_BAR="audiogram-bar",e.AUDIOGRAM_WAVE="audiogram-wave",e.AUTO_TRANSLATE="auto-translate",e.BACKGROUND_IMAGE_ERASE="background-image-erase",e.BRAND_TEMPLATES="brand-templates",e.BRANDKIT="brandkit",e.CHANGE_MEMBER_ROLES="change-member-roles",e.CLEAN_AUDIO="clean-audio",e.CLONED_VOICES="cloned-voices",e.CLONED_VOICES_LIMIT="cloned-voices-limit",e.CREATE_NEW_FOLDER="create-new-folder",e.CUMULATIVE_EXPORT_DURATION="cumulative-export-duration",e.CUSTOM_SPELLING="custom-spelling",e.DEFAULT="default",e.DEFAULT_PRIVACY="default-privacy",e.DELETION_WARNING="deletion-warning",e.ENHANCE_IMAGE="enhance-image",e.FULL_HD="full-hd",e.GENERARATE_MEME="generate-meme",e.GENERATE_ARTICLE_TO_VIDEO="generate-article-to-video",e.GENERATE_B_ROLL="generate-b-roll",e.GENERATE_DOCUMENT_TO_VIDEO="generate-document-to-video",e.GENERATE_IMAGES="generate-images",e.GENERATE_LONG_DURATION_AI="generate-long-duration-ai",e.GENERATE_SCRIPT="generate-script",e.GENERATE_SCRIPT_IN_SCRIPT_TO_VIDEO="generate-script-in-script-to-video",e.GENERATE_SCRIPT_TO_VIDEO="generate-script-to-video",e.GENERATE_TTS_VIDEO="generate-tts-video",e.GENERATE_VIDEO="generate-video",e.HEADER="header",e.HIGH_QUALITY="high-quality",e.LINK="link",e.MAGIC_SUBTITLE_FILE_DL="magic-subtitle-file-download",e.MAGIC_TRANSCRIBE="magic-transcribe",e.LIMITS_WARNING="limits-warning",e.ONBOARDING_SURVEY="onboarding-survey",e.PREMIUM_ASSETS="premium-assets",e.PRICING="pricing",e.PRICING_PAGE="pricing-page",e.PRIVACY="privacy",e.REACTIVATE_LICENSE="reactivate-license",e.REMOVE_30_SEC_WATERMARK="remove-30-sec-watermark",e.REMOVE_VIDEO_BACKGROUND="remove-video-background",e.REMOVE_WATERMARK="remove-watermark",e.ROYALTY_FREE="royalty-free",e.SETTINGS="settings",e.SIDEBAR="sidebar",e.SINGLE_VIDEO_DURATION_LIMIT="single-video-duration-limit",e.SMART_CUT_AUDIO="smart-cut-audio",e.SMART_CUT_VIDEO="smart-cut-video",e.STOCK_ASSETS_IMAGE="stock-assets-image",e.STOCK_ASSETS_MUSIC="stock-assets-music",e.STOCK_ASSETS_SFX="stock-assets-sfx",e.STOCK_ASSETS_VIDEO="stock-assets-video",e.STORAGE_LIMIT="storage-limit",e.STUDIO="studio",e.STUDIO_MEDIA_SIDEBAR="studio-media-sidebar",e.SUBTITLE_PRESETS="subtitle-presets",e.SUBTITLER="subtitler",e.TEXT_PRESETS="text-presets",e.TEXT_TEMPLATES="text-templates",e.TEXT_TO_SPEECH="text-to-speech",e.VOICE_DUBBING="voice-dubbing",e.TRIM_WITH_TRANSCRIPT_TRANSCRIBE="trim-with-transcript-transcribe",e.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT_UPSELL="two-week-post-onboarding-multi-account-upsell",e.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT_UPSELL="two-week-post-onboarding-single-account-upsell",e.TWO_WEEK_RECURRING_MULTI_ACCOUNT_UPSELL="two-week-recurring-multi-account-upsell",e.TWO_WEEK_RECURRING_SINGLE_ACCOUNT_UPSELL="two-week-recurring-single-account-upsell",e.UNKNOWN="unknown",e.UNLIMITED_CONTENT="unlimited-content",e.UPLOAD_FONTS="upload-fonts",e.UPLOAD_LIMIT="upload-limit",e.USE_MAGIC_FILL="use-magic-fill",e.WORKSPACE_SETTINGS="workspace-settings",e.REPURPOSE_STUDIO="repurpose-studio",e))(Vl||{});const Wl={free:{isFree:!0,planTier:"free",basePrice:{month:0,year:0,none:0},modalReasons:[],cancelReasons:["All projects export with Kapwing watermark","Auto subtitler limited to 60 mins/month","Videos limited to 4 minutes","Files limited to 250 MB","Video quality limited to 720p resolution"],canCancel:!1,canChangeSeats:!1,canSwitchToAnnual:!1,upsellsTo:"pro"},basic:{upsellsTo:"pro",isFree:!1,planTier:"basic",basePrice:{month:10,year:72,none:0},everythingIn:["free"],modalReasons:["Remove watermarks on images or videos shorter than 30 seconds."],cancelReasons:["Remove watermarks on images or videos shorter than 30 seconds."]},pro:{isFree:!1,planTier:"pro",basePrice:{month:24,year:192,none:0},everythingIn:["free","basic"],modalReasons:["Remove all watermarks","Upload files up to 6 GB","Store and edit unlimited projects","Increased transcription limits and SRT downloads","Export projects up to 2 hours long","Export content in 4K resolution","Increased Generative AI tool uses"],andMuchMore:!0,cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Increased video transcription","Export projects up to 1 hour long","Export projects in 4K resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Increased Generative AI tool uses"],upsellsTo:"business",upsellsFrom:"free"},business:{isFree:!1,planTier:"business",basePrice:{month:64,year:600,none:0},everythingIn:["free","basic","pro"],modalReasons:["Auto-subtitle videos (up to 900 min/month)","Translate videos (up to 900 min/month)","Edit with AI features (up to 200 times/month)","Create custom voice clones"],andMuchMore:!0,cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Increased video transcription","Export projects up to 1 hour long","Export projects in 4K resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Increased Generative AI tool uses"],upsellsTo:"enterprise",upsellsFrom:"pro"},edu:{isFree:!1,planTier:"edu",basePrice:{month:0,year:0,none:0},modalReasons:[],cancelReasons:[]},team:{isFree:!1,planTier:"team",basePrice:{month:24,year:192,none:0},everythingIn:["pro"],modalReasons:["Remove all watermarks","Ensure consistency with Brand Kit templates and other assets","Upload files up to 6 GB","Export content up to 1 hour long","Export content in 4K resolution","Unlimited transcription and SRT / VTT downloads","Consolidated billing"],cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Unrestricted video transcription","Export projects up to 1 hour long","Export projects in 4K resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Unrestricted Generative AI tools"]},enterprise:{upsellsFrom:"business",isFree:!1,planTier:"enterprise",basePrice:{month:24,year:192,none:0},everythingIn:["free","basic","pro","business"],modalReasons:["Custom amount of auto-subtitling","Custom amount of translation","Custom usage of generative AI features","Custom billing","Dedicated account manager","Priority customer support","Onboarding & training","SAML single sign-on (SSO)"],andMuchMore:!0,cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Unrestricted video transcription","Export projects up to 1 hour long","Export projects in 4K resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Unrestricted Generative AI tools"],canCancel:!1,canSwitchToAnnual:!1}};var Gl=(e=>(e.Read="read:subscription",e.Update="update:subscription",e))(Gl||{}),Hl=(e=>(e.Read="read:teamMember",e.Create="create:teamMember",e.Update="update:teamMember",e.Delete="delete:teamMember",e))(Hl||{}),$l=(e=>(e.Read="read:workspaceSettings",e.Update="update:workspaceSettings",e.Delete="delete:workspaceSettings",e))($l||{});const Kl={[kl.Admin]:new Set(["read:subscription","update:subscription","read:teamMember","create:teamMember","update:teamMember","delete:teamMember","read:workspaceSettings","update:workspaceSettings","delete:workspaceSettings","read:brandControls","update:brandControls","read:project","create:project","update:project","delete:project","read:folder","create:folder","update:folder","delete:folder"]),[kl.Editor]:new Set(["read:teamMember","read:workspaceSettings","read:brandControls","read:project","create:project","update:project","delete:project","read:folder","create:folder","update:folder","delete:folder"])};var zl=(e=>(e.Audio="audio",e.Image="image",e.Shape="shape",e.Text="text",e.Video="video",e.Placeholder="placeholder",e))(zl||{}),Yl=(e=>(e.None="none",e.Drop="drop",e.FlickerInGlow="flicker-in-glow",e.FocusIn="focus-in",e.HueRotate="hue-rotate",e.PopInBounce="pop-in-bounce",e.ProgressBar="progress-bar",e.Reveal="reveal",e.SlideUp="slide-up",e.Vibrate="vibrate",e.WipeRectangle="wipe-rectangle",e.BlurIn="blur-in",e.BlurOut="blur-out",e.FadeIn="fade-in",e.FadeOut="fade-out",e.HideIn="hide-in",e.HideOut="hide-out",e.MagicFade="magic-fade",e.MagicFlip="magic-flip",e.MagicPop="magic-pop",e.MagicWBW="magic-wbw",e))(Yl||{}),Jl=(e=>(e.CrossDissolve="cross-dissolve",e.CrossBlur="cross-blur",e))(Jl||{});function ql(e){return"audio"===e.type}function Xl(e){return"image"===e.type}function Ql(e){return!!e&&("type"in e&&"video"===e.type)}var Zl=(e=>(e.CREATE_NEW_PROJECT="Create new projct",e.GO_TO_PROJECT="Go to project",e.TRY_A_SAMPLE="Try a sample",e.DISMISS="Dismiss",e))(Zl||{}),ed=(e=>(e.transcriptTabTrim="transcriptTabTrim",e))(ed||{}),td=(e=>(e.individualPositionHint="individualPositionHint",e))(td||{}),od=(e=>(e.School="School",e.Work="Work",e.PersonalProjects="Personal Projects",e))(od||{}),ad=(e=>(e.LandingPage="LandingPage",e.Onboarding="Onboarding",e.RepurposeOnboarding="RepurposeOnboarding",e.Unknown="Unknown",e))(ad||{});function id(e){return"start"in e}function sd(e){const[t]=e;return!!t&&id(t)}function nd(e){const[t]=e.words;return!!t&&id(t)}var rd=(e=>(e.PEXELS="PEXELS",e.PIXABAY="PIXABAY",e.GETTY="GETTY",e))(rd||{}),ld=(e=>(e.ObjectTracking="object_tracking",e.ObjectTrackingV2="object_tracking_v2",e.ImageObjectDetection="image_object_detection",e))(ld||{});const dd=e=>"object_tracking_v2"===e.job_type;var cd=(e=>(e[e.AlwaysInvitationOnly=-1]="AlwaysInvitationOnly",e[e.InvitationOnly=0]="InvitationOnly",e[e.RequestToJoin=1]="RequestToJoin",e[e.AnyoneCanJoin=2]="AnyoneCanJoin",e))(cd||{}),ud=(e=>(e.PATCH="patch",e.FULL_VIDEO="full_video",e.IMAGE_FRAME="image_frame",e.EXPORTING="exporting",e.FAILED="failed",e))(ud||{}),md=(e=>(e.SAME="SAME",e.PRIVATE_TO_SHARED="PRIVATE_TO_SHARED",e.SHARED_TO_PRIVATE="SHARED_TO_PRIVATE",e.CHANGE_TEAMS="CHANGE_TEAMS",e))(md||{}),pd=(e=>(e.COPY="Copy",e.MOVE="Move",e))(pd||{}),hd=(e=>(e.GOOGLE="Google",e.AZURE="Azure AD",e))(hd||{}),gd=(e=>(e.PENDING="pending",e.RUNNING="running",e.COMPLETE="complete",e.FAILED="failed",e))(gd||{});function fd(e){return"complete"===e.status}function yd(e){return"running"===e.status||"pending"===e.status}var vd=(e=>(e.POSITION="position",e.ROTATION="rotation",e.ZOOM="zoom",e.COLOR="color",e.VOLUME="volume",e.OPACITY="opacity",e.BRIGHTNESS="brightness",e.CONTRAST="contrast",e.SATURATION="saturate",e.BLUR="blurPercent",e.BACKGROUND="background",e))(vd||{}),_d=(e=>(e.Studio="studio",e.Export="export",e))(_d||{}),wd=(e=>(e.PreExtractValidation="Pre-Extraction Validation",e.Extraction="Extraction",e.ExtractionValidation="Extraction Validation",e.AssetCreation="Asset Creation",e.LayerCreation="Layer Creation",e.HandleFinish="Handle Finish",e.Finish="Finish",e))(wd||{}),bd=(e=>(e.fhInWorkspace="Repurpose - Find Highlights",e.autocut="Autocut",e))(bd||{});const Td={tooltip:"tooltips-module_tooltip_XFJWd",tooltipBubble:"tooltips-module_tooltipBubble_Bv6aR",tooltipTextBottomAlignRight:"tooltips-module_tooltipTextBottomAlignRight_u0253",tooltipTextBottomAlignLeft:"tooltips-module_tooltipTextBottomAlignLeft_t70M4",tooltipTextSlightTop:"tooltips-module_tooltipTextSlightTop_xWCYX",tooltipTextTop:"tooltips-module_tooltipTextTop_WGoTp",keyboardShortcut:"tooltips-module_keyboardShortcut_ZCE9l",keyboardShortcutWithOutline:"tooltips-module_keyboardShortcutWithOutline_wrPrH"},xd="SliderControl-module_controlSliderContainer_Jjmfq",Sd="SliderControl-module_sliderRoot_LNEVN",Ed="SliderControl-module_sliderTrack_jDKrq",Id="SliderControl-module_sliderThumb_OfrlV",Cd="SliderControl-module_controlSliderPrecisionInput_-FEqj",kd="SliderControl-module_controlSliderPrecisionUnit_GozJo",Ad="SliderControl-module_header_G3gxJ",jd="SliderControl-module_labelIcon_ICEFR",Nd="SliderControl-module_label_nukbN",Rd="SliderControl-module_reset_8UK09",Pd="SliderControl-module_sliderDragBubble_r-k3U",Dd="SliderControl-module_sliderDragBubbleText_oKMis",Od="SliderControl-module_sliderDragBubbleArrow_WopPo",Ld=e=>{const[,t]=h.useState(0),o=h.useRef("function"==typeof e?e():e);return[h.useCallback((()=>o.current),[]),h.useCallback((e=>{o.current="function"==typeof e?e(o.current):e,t((e=>e+1))}),[])]},Fd={opacity:.2,pointerEvents:"none"},Md=_.memo((function({className:e,label:t,labelIcon:o,min:a,max:i,defaultValue:s,step:n=1,onSliderChange:r,disabled:l=!1,tooltip:d=!1,dataCy:c="",onReset:u,precisionOptions:m,dragTooltipText:p,style:g}){const f=void 0===s?+a+(+i-+a)/2:s,[y,v]=h.useState(String(f)),[_,A]=Ld(f),[j,N]=h.useState(!1),R=h.useRef(null);h.useEffect((()=>{A(f),v(String(f))}),[f,A]);const P=h.useCallback((e=>{const t=Number(e);if(isNaN(t))return null;let o=Math.round(+t/n)*n;return t>i&&(o=i),t<a&&(o=a),o}),[i,a,n]),D=h.useCallback((e=>{N(!0);const[t]=e;if(void 0===t)throw new Error("value is undefined");A(t),r(t,!1),v(String(t))}),[r,A]),O=h.useCallback((e=>{const t=e.target,{value:o}=t;v(o);const a=P(o);null!==a&&(A(a),r(a,!1))}),[r,P,A]),L=h.useCallback((()=>{N(!1),r(_(),!0)}),[r,_]),F=_(),M=h.useMemo((()=>[F]),[F]),U=h.useCallback((()=>{N(!0)}),[]),B=h.useCallback((()=>{N(!1),L()}),[L]);return w.jsxs("div",{className:e,style:{width:"100%",...g},children:[(o||t||u)&&w.jsxs("div",{className:Ad,children:[o&&w.jsx("div",{className:jd,children:o}),t&&w.jsx("div",{className:Nd,children:t}),u&&w.jsx("button",{type:"button",className:Rd,onClick:u,children:"Reset"})]}),w.jsxs("div",{className:d?Td.tooltip:"",children:[d&&w.jsxs("span",{className:Td.tooltipTextTop,style:(()=>{let e=+_()/+i*100;return e>90?e=90:e<10&&(e=10),{left:`${e}%`}})(),children:[Math.round(100*+_()),"%"]}),w.jsxs("div",{className:xd,children:[w.jsx(b,{className:Sd,ref:R,"data-testid":"slider","data-cy":(c?`${c}-`:"")+"slider-control",style:l?Fd:void 0,min:a,max:i,step:n,value:M,onValueChange:D,disabled:l,onPointerDown:U,onPointerUp:B,children:w.jsxs(T,{open:!!j||void 0,delayDuration:400,children:[w.jsx(x,{className:Ed}),p&&w.jsx(S,{children:w.jsxs(E,{className:Pd,updatePositionStrategy:"always",sideOffset:2,children:[w.jsx("div",{className:Dd,children:p(_())}),w.jsx(I,{className:Od})]})}),w.jsx(C,{asChild:!0,children:w.jsx(k,{className:Id})})]})}),m&&w.jsxs(w.Fragment,{children:[w.jsx("input",{"data-testid":"slider-input","data-cy":"slider-input",className:Cd,min:a,max:i,value:y,onChange:O,onBlur:L,onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur(),L())},disabled:l}),w.jsx("span",{className:kd,children:m.unit})]})]})]})]})})),Ud=.7,Bd=600.5,Vd=[.7,1.3,2.8,5.3,10,20,40,85,150,600.5],Wd={width:130};function Gd(e){let t=0,o=Number.MAX_SAFE_INTEGER;return Vd.forEach(((a,i)=>{const s=Math.abs(a-e);s<o&&(t=i,o=s)})),t}const Hd={marginLeft:8,cursor:"pointer"},$d={marginLeft:4,marginRight:5,cursor:"pointer"},Kd=_.memo((({isMobile:e,pxInSecond:t,setPxInSecond:o})=>{const a=t??Vd[0],[i,n]=h.useState(Gd(a));h.useEffect((function(){n(Gd(a))}),[a]);const r=h.useCallback((e=>{const t=[.2,.4,.5,1,1,10,10,10,100,100];let i=a??.7;if(a)if(a<.7&&1===e)o(.7);else if(.7!==a||-1!==e)if(a>600.5&&-1===e)o(600.5);else if(600.5!==a||1!==e){for(let o=0;o<Vd.length-1;o+=1){const s=Vd[o],n=Vd[o+1],r=t[o];if(s&&n&&r&&(s<a&&a<n||a===s||a===n)){i+=r*e;break}}o(i)}}),[a,o]),l=h.useMemo((()=>s.debounce((e=>o(e)),30)),[o]),d=h.useCallback((e=>{n(e);const t=Vd[e];t&&l(t)}),[l]),c=h.useCallback((()=>r(-1)),[r]),u=h.useCallback((()=>r(1)),[r]);return w.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[w.jsx(A,{"data-cy":"zoom-out",size:24,onClick:c,style:Hd}),!e&&w.jsx(Md,{min:0,max:Vd.length-1,step:1,defaultValue:i,onSliderChange:d,style:Wd}),w.jsx(j,{"data-cy":"zoom-in",size:24,onClick:u,style:$d})]})}));const zd=new class{constructor(){i(this,"_queued",[]),i(this,"_pending",{})}clear(){this._pending={},this._queued=[]}getAllPendingOps(){return Object.values(this._pending)}push(e){this._queued.push(e),"presence"!==e.p[0]&&(this._pending[e.__localMd.id]=e)}dequeueAll(){return this._queued.splice(0)}removePending(e){delete this._pending[e.__localMd.id]}toJSON(){}},Yd={},Jd=v({initialState:Yd,name:"projectSessionSettings",reducers:{showOverlayWithKey:(e,t)=>{e.overlay=t.payload},hideOverlay:e=>{e.overlay=null},setMediaSidebar:(e,t)=>{e.mediaSidebar=t.payload},updateTimelinePosition:(e,t)=>{e.timelinePosition=t.payload},setPxInSecond:(e,t)=>{t.payload<=600.5?e.pxInSecond=t.payload:e.pxInSecond=600.5},setCopiedModifications:(e,t)=>{e.copiedModifications=t.payload},setPreservedTextOptions:(e,t)=>{e.preservedTextOptions=t.payload},setSessionSettings:(e,t)=>{rl(e),Object.assign(e,t.payload),zd.clear();for(const o of t.payload.offlineOps??[])zd.push(o)},logAddLayer:e=>{e.addLayerLogged?e.addLayerLogged+=1:e.addLayerLogged=1},logSplitVideo:e=>{e.splitsLogged?e.splitsLogged+=1:e.splitsLogged=1},logUsedTrimmer:(e,t)=>{const o=t.payload;if(e.trimsLogged){const t=e.trimsLogged[o]||0;e.trimsLogged={...e.trimsLogged,[o]:t+1}}else e.trimsLogged={[o]:1}},addPendingUpload:(e,t)=>{e.pendingUploadMediaCacheIds||(e.pendingUploadMediaCacheIds=[]),e.pendingUploadMediaCacheIds.includes(t.payload)||e.pendingUploadMediaCacheIds.push(t.payload)},removePendingUpload:(e,t)=>{e.pendingUploadMediaCacheIds&&(e.pendingUploadMediaCacheIds=e.pendingUploadMediaCacheIds.filter((e=>e!==t.payload)))},setDraftEmailRef:(e,t)=>{e.draftEmailRef=t.payload},setDisableKeyframingHelper:(e,t)=>{e.disableKeyframingHelper=t.payload},setDisableIndividualPositionHint:(e,t)=>{e.disableIndividualPositionHint=t.payload},setDisableMagicCreateHighlight:(e,t)=>{e.disableMagicCreateHighlight=t.payload},setTrimWithTranscriptEnabledAssets:(e,t)=>{e.trimWithTranscriptEnabledAssets=t.payload},updateTrimWithTranscriptAnalytics:(e,t)=>{e.trimWithTranscriptAnalytics={...e.trimWithTranscriptAnalytics,...t.payload}},updateSidebarCollapsedState:(e,t)=>{e.collapsibleSectionOpenStates||(e.collapsibleSectionOpenStates={}),e.collapsibleSectionOpenStates[t.payload.key]=t.payload.open}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":case"JEST_CLEAR_STORE":return zd.clear(),{...Yd};case"SET_STUDIO":return t.projectIdChanged?(zd.clear(),{...Yd}):e;default:return e}}))}),{addPendingUpload:qd,hideOverlay:Xd,logAddLayer:Qd,logSplitVideo:Zd,logUsedTrimmer:ec,removePendingUpload:tc,setCopiedModifications:oc,setDraftEmailRef:ac,setMediaSidebar:ic,setPxInSecond:sc,setPreservedTextOptions:nc,setSessionSettings:rc,showOverlayWithKey:lc,updateTimelinePosition:dc,setDisableKeyframingHelper:cc,setTrimWithTranscriptEnabledAssets:uc,updateTrimWithTranscriptAnalytics:mc,updateSidebarCollapsedState:pc,setDisableMagicCreateHighlight:hc,setDisableIndividualPositionHint:gc}=Jd.actions,fc={},yc=function(e,t,o){if(!t||0===t.length)return e();const a=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in fc)return;fc[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(!!o)for(let o=a.length-1;o>=0;o--){const i=a[o];if(i.href===e&&(!t||"stylesheet"===i.rel))return}else if(document.querySelector(`link[href="${e}"]${i}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise(((t,o)=>{s.addEventListener("load",t),s.addEventListener("error",(()=>o(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e())).catch((e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}))},vc={_id:"anon_team",name:"My Team",users:[{_id:"anon_user",email:" ",hasLicense:!1,userId:"anon_user",role:kl.Admin,createdAt:new Date,firstName:"",lastName:"",name:"",teamId:"anon_team"}],creatorId:"anon_user",planTier:Cl.Free,createdAt:new Date,emailDomain:"",settings:{inviteByLink:!0,defaultPrivacy:Ln.unlisted},limits:{cumulativeExportDuration:0,lastUpdatedCumulativeDuration:new Date,transcribeUsage:0,lastUpdatedTranscribe:new Date,generatedDocumentToVideo:0,generatedArticleToVideo:0,generatedMemes:0,generatedScripts:0,generatedScriptToVideo:0,generatedScriptsInScriptToVideo:0,generatedTTSVideos:0,generatedVideos:0,generatedImages:0,lastReset:new Date,monthlyTranslateUsage:0,monthlyAIGenerateUsage:0,monthlyTTSUsage:0,TTSVoiceClones:0}},_c=e=>{const{teams:{allTeams:t}}=sr().state;return t.find((t=>t._id===e))||vc};function wc(e){const{user:t,token:o}=e||{};return!(s.isEmpty(t)||!o)}const bc=()=>wc(tl((e=>e.currentUser)));function Tc(e){if(!wc(e))return!1;const{accountType:t}=e.user;return t===Mn.admin}function xc(e){var t;if(!wc(e))return!1;const{onboarding:o}=e.user,a=null==(t=null==o?void 0:o.survey)?void 0:t.occupation;return"student"===a||"teacher"===a}function Sc(e){if(!wc(e))return"";const{user:t}=e,{name:o,firstName:a,lastName:i}=t;return o||(a&&i?`${a} ${i}`:a||(i||""))}function Ec(e){if(!wc(e))return"";const{user:t}=e,{name:o,firstName:a}=t;let i="";try{if(a){const e=a.split(" ")[0];e&&(i=Ks(e,24))}else if(o){const e=o.split(" ")[0];e&&(i=Ks(e,24))}}catch(IGe){}return i}function Ic(e){if(!wc(e))return"";const{user:t}=e,{email:o}=t;return o||""}const Cc=m((e=>e.currentUser),(e=>{return Tc(e)?(t=e)&&Tc(t)?{_id:"admin_team",name:"Admin Team",users:[{_id:"admin_team_user",userId:t.user._id,role:kl.Admin,createdAt:new Date,email:t.user.email,firstName:t.user.firstName,lastName:t.user.lastName,name:t.user.name,teamId:"admin_team"}],creatorId:t.user._id,planTier:Cl.Pro,createdAt:new Date,emailDomain:"kapwing.com",settings:{inviteByLink:!0,defaultPrivacy:Ln.unlisted},limits:{cumulativeExportDuration:0,lastUpdatedCumulativeDuration:new Date,transcribeUsage:0,lastUpdatedTranscribe:new Date,generatedDocumentToVideo:0,generatedMemes:0,generatedScripts:0,generatedScriptToVideo:0,generatedScriptsInScriptToVideo:0,generatedTTSVideos:0,generatedVideos:0,generatedImages:0,lastReset:new Date,monthlyTranslateUsage:0,monthlyAIGenerateUsage:0,monthlyTTSUsage:0,generatedArticleToVideo:0,TTSVoiceClones:0}}:vc:void 0;var t})),kc=m((e=>{var t;return null==(t=e.teams)?void 0:t.allTeams}),(e=>{var t;return null==(t=e.teams)?void 0:t.selectedTeamId}),Cc,((e,t,o)=>{const a=e[0];if(!t||!a)return vc;const i=null==e?void 0:e.filter((e=>!!e)).find((e=>e._id===t));return i||(o||a)})),Ac=()=>tl(kc),jc=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ");function Nc(e,t,o){return 1===Math.abs(o)?e:t}const Rc=(e,t)=>{const o=e.getTime(),a=t.getTime();return Math.round(Math.abs(o-a)/864e5)};function Pc(e){if(!e)return!1;const t=new URLSearchParams(e),o=36e5,a=t.get("X-Goog-Date"),i=t.get("X-Goog-Expires");if(a&&i){const[,e,t,s,n,r,l]=a.match(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})/)||[];if(null==l)return!0;const d=Date.parse(`${e}-${t}-${s}T${n}:${r}:${l}`)+1e3*parseInt(i,10)-o;return Date.now()>=d}const s=t.get("Expires");if(s){return 1e3*parseInt(s,10)-Date.now()<o}return!0}const Dc=Bl.NO_UPSELLS;var Oc=(e=>(e.TRANSCRIBE="TRANSCRIBE",e.TRANSLATE="TRANSLATE",e.AI_GENERATE="AI_GENERATE",e.TTS="TTS",e.CLONED_VOICES="CLONED_VOICES",e))(Oc||{});const Lc={TRANSCRIBE:{limit:{[Cl.Free]:60,[Cl.Pro]:300,[Cl.Business]:900},unit:"minute",name:"subtitle",dbKey:"transcribeUsage",label:"Auto subtitle + transcription minutes",shortLabel:"Auto subtitle minutes",description:"Using Magic subtitles, trim with transcript, smart B-roll and Magic create features count towards this limit",monthly:!0,showWarnings:!0},TRANSLATE:{limit:{[Cl.Free]:10,[Cl.Pro]:300,[Cl.Business]:900},unit:"minute",name:"translation",dbKey:"monthlyTranslateUsage",label:"Subtitle translation minutes",description:"Using subtitle translation features count towards this limit",monthly:!0,showWarnings:!0},AI_GENERATE:{limit:{[Cl.Pro]:50,[Cl.Business]:200},unit:"use",name:"generative AI",dbKey:"monthlyAIGenerateUsage",label:"Generative AI tools",description:"Using the AI Video Generator, Image Generator, Meme Generator, Generate Slideshow, Script Generator, Document to Video, Script to Video and Article to Video features count towards this limit",monthly:!0,showWarnings:!0},TTS:{limit:{[Cl.Free]:10,[Cl.Pro]:100,[Cl.Business]:300},unit:"minute",name:"text to speech",dbKey:"monthlyTTSUsage",label:"Text to Speech minutes",description:"Using text to speech voices count towards this limit",monthly:!0,showWarnings:!0},CLONED_VOICES:{limit:{[Cl.Free]:0,[Cl.Pro]:0,[Cl.Business]:2,[Cl.Enterprise]:4},unit:"slot",name:"voice clone",dbKey:"TTSVoiceClones",label:"Text to Speech voice clones",description:"Cloning text to speech voices count towards this limit",monthly:!1,showWarnings:!1}},Fc=750,Mc=[Cl.Pro,Cl.Team,Cl.Edu,Cl.Business,Cl.Enterprise],Uc=[Cl.Basic,...Mc],Bc={[Bl.NO_UPSELLS]:{planTiers:Mc},[Bl.REPORT_ISSUE]:{planTiers:Uc},[Bl.SSO_LOGIN]:{planTiers:[Cl.Enterprise]},[Bl.FAST_EXPORT]:{planTiers:Mc},[Bl.BRANDKIT]:{planTiers:Mc,heroHeader:"Staying on brand has never been easier",heroBody:"Upgrade so you can stay on-brand all the time with Brand Kit. Set up your own Brand Templates and upload your own brand colors, fonts, images, and videos to make the same assets available to everyone in this workspace.",heroImg:"https://cdn-useast1.kapwing.com/static/51e-brandkit-upgrade-banner-spot.webp"},[Bl.UNLIMITED_UPLOAD_SIZE_LIMIT]:{planTiers:Mc},[Bl.NO_CUMULATIVE_DURATION_LIMIT]:{planTiers:Mc},[Bl.TRANSCRIBE]:{planTiers:Mc},[Bl.SUBTITLER]:{planTiers:Mc},[Bl.TEXT_TO_SPEECH]:{planTiers:Mc,upsellHeading:"Text to Speech",upsellBody:"Upgrade to use our full library of Premium Voice options"},[Bl.VOICE_DUBBING]:{planTiers:Mc,upsellHeading:"Voice Dubbing",upsellBody:"Upgrade to use our full library of Premium Voice options"},[Bl.REMOVE_BACKGROUND]:{planTiers:Mc,upsellHeading:"Background remover",upsellBody:"Upgrade to export with Remove Background",imgSrc:"https://cdn-useast1.kapwing.com/static/tB5-remove-video-background-cta-image.webp"},[Bl.CLEAN_AUDIO]:{planTiers:Mc,upsellHeading:"Clearer audio",upsellBody:"Upgrade to apply Clean Audio to all your projects",imgSrc:"https://cdn-useast1.kapwing.com/static/LII-clean-audio-upsell-banner-image.webp"},[Bl.ENHANCE_IMAGE]:{planTiers:Mc,upsellHeading:"Clearer images",upsellBody:"Upgrade to export projects with Image Enhancements applied"},[Bl.SMART_CUT]:{planTiers:Mc,upsellHeading:"Remove silences automatically with Smart Cut",upsellBody:"Upgrade to export projects edited with Smart Cut",imgSrc:"https://cdn-useast1.kapwing.com/static/EwQ-smart-cut-upsell-block-image.webp"},[Bl.AUDIOGRAM]:{planTiers:Mc,upsellHeading:"Use a dynamic waveform layer to visualize audio",upsellBody:"Upgrade to export projects with waveform layers",imgSrc:"https://cdn-useast1.kapwing.com/static/zlv-bars.webp"},[Bl.UNLIMITED_EXPORT_DURATION_LIMIT]:{planTiers:Mc},[Bl.CREATE_NEW_FOLDER]:{planTiers:Mc},[Bl.HIGH_QUALITY]:{planTiers:Mc},[Bl.ALLOW_STOCK_CONTENT]:{planTiers:Mc,upsellHeading:"Thousands of royalty-free assets",upsellBody:"Upgrade to use our full library of high quality images, video, and audio",imgSrc:"https://cdn-useast1.kapwing.com/static/XYa-Frame-307.webp"},[Bl.UNLIMITED_STORAGE]:{planTiers:Mc,upsellHeading:"Bigger, bolder assets",upsellBody:"Upgrade to upload and store assets over 250+ megabytes",imgSrc:"https://cdn-useast1.kapwing.com/static/C4x-img_upsell_media.webp"},[Bl.CHANGE_PRIVACY]:{planTiers:Mc},[Bl.EXPORT_ALL_WITHOUT_WATERMARK]:{planTiers:Mc},[Bl.EXPORT_30_SEC_WITHOUT_WATERMARK]:{planTiers:Uc},[Bl.ROYALTY_FREE]:{planTiers:Mc},[Bl.CHANGE_MEMBER_ROLES]:{planTiers:Mc},[Bl.SUBTITLE_PRESETS]:{planTiers:Mc},[Bl.TEXT_PRESETS]:{planTiers:Mc},[Bl.TEXT_TEMPLATES]:{planTiers:Mc},[Bl.GENERATE_IMAGES]:{planTiers:Mc},[Bl.GENERATE_LONG_DURATION_AI]:{planTiers:Mc},[Bl.GENERATE_DOCUMENT_TO_VIDEO]:{planTiers:Mc},[Bl.GENERATE_SCRIPT_TO_VIDEO]:{planTiers:Mc},[Bl.GENERATE_TTS_VIDEO]:{planTiers:Mc},[Bl.GENERATE_VIDEO]:{planTiers:Mc},[Bl.GENERATE_MEME]:{planTiers:Mc},[Bl.GENERATE_SCRIPT]:{planTiers:Mc},[Bl.GENERATE_ARTICLE_TO_VIDEO]:{planTiers:Mc},[Bl.GENERATE_SCRIPT_IN_SCRIPT_TO_VIDEO]:{planTiers:Mc},[Bl.GENERATE_B_ROLL]:{planTiers:Mc},[Bl.PREMIUM_ASSETS]:{planTiers:Mc},[Bl.USE_MAGIC_FILL]:{planTiers:Mc},[Bl.MORE_AUTO_TRANSLATE]:{planTiers:Mc},[Bl.NO_LIMITS_PAYWALL]:{planTiers:[Cl.Enterprise]},[Bl.CLONED_VOICES]:{planTiers:[Cl.Business,Cl.Enterprise]},[Bl.CLONED_VOICES_LIMIT]:{planTiers:[Cl.Enterprise]}},Vc={[Vl.UNKNOWN]:{metadata:{prettyUpgradeSource:"Unknown"}},[Vl.CHANGE_MEMBER_ROLES]:{permission:Bl.CHANGE_MEMBER_ROLES,metadata:{prettyUpgradeSource:"Change Member Roles"}},[Vl.ROYALTY_FREE]:{permission:Bl.ROYALTY_FREE,metadata:{prettyUpgradeSource:"Filter Royalty Free"}},[Vl.SUBTITLE_PRESETS]:{permission:Bl.SUBTITLE_PRESETS,metadata:{prettyUpgradeSource:"Subtitle Presets"}},[Vl.TEXT_PRESETS]:{permission:Bl.TEXT_PRESETS,metadata:{prettyUpgradeSource:"Text Presets"}},[Vl.TEXT_TEMPLATES]:{permission:Bl.TEXT_TEMPLATES,metadata:{prettyUpgradeSource:"Text Templates"}},[Vl.TEXT_TO_SPEECH]:{permission:Bl.TEXT_TO_SPEECH,metadata:{prettyUpgradeSource:"Text to Speech"}},[Vl.VOICE_DUBBING]:{permission:Bl.VOICE_DUBBING,metadata:{prettyUpgradeSource:"Voice Dubbing"}},[Vl.ENHANCE_IMAGE]:{permission:Bl.ENHANCE_IMAGE,metadata:{prettyUpgradeSource:"Enhance Image"}},[Vl.DEFAULT_PRIVACY]:{permission:Bl.CHANGE_PRIVACY,metadata:{prettyUpgradeSource:"Default Privacy"}},[Vl.DELETION_WARNING]:{permission:Bl.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Deletion Warning"}},[Vl.HEADER]:{metadata:{prettyUpgradeSource:"Link in Header"}},[Vl.HIGH_QUALITY]:{permission:Bl.HIGH_QUALITY,metadata:{prettyUpgradeSource:"High Quality",upsellHeading:"Export in full HD quality",upsellBody:"Upgrade to export your projects in Full HD resolution"}},[Vl.PRICING]:{metadata:{prettyUpgradeSource:"Pricing Page"}},[Vl.PRIVACY]:{permission:Bl.CHANGE_PRIVACY,metadata:{prettyUpgradeSource:"Video Privacy"}},[Vl.SETTINGS]:{metadata:{prettyUpgradeSource:"Account Settings"}},[Vl.SIDEBAR]:{metadata:{prettyUpgradeSource:"Link in Sidebar"}},[Vl.SINGLE_VIDEO_DURATION_LIMIT]:{permission:Bl.NO_CUMULATIVE_DURATION_LIMIT,metadata:{prettyUpgradeSource:"Single Video Duration Limit"}},[Vl.STORAGE_LIMIT]:{permission:Bl.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Storage Limit"}},[Vl.STUDIO]:{metadata:{prettyUpgradeSource:"Link in Studio"}},[Vl.SUBTITLER]:{permission:Bl.SUBTITLER,metadata:{prettyUpgradeSource:"Download SRT"}},[Vl.CUMULATIVE_EXPORT_DURATION]:{permission:Bl.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Total Video Duration"}},[Vl.UNLIMITED_CONTENT]:{permission:Bl.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Load More Button"}},[Vl.UPLOAD_FONTS]:{permission:Bl.BRANDKIT,metadata:{prettyUpgradeSource:"Upload font"}},[Vl.CUSTOM_SPELLING]:{permission:Bl.BRANDKIT,metadata:{prettyUpgradeSource:"Custom spelling"}},[Vl.UPLOAD_LIMIT]:{permission:Bl.UNLIMITED_UPLOAD_SIZE_LIMIT,metadata:{prettyUpgradeSource:"Upload Limit"}},[Vl.MAGIC_TRANSCRIBE]:{permission:Bl.TRANSCRIBE,metadata:{prettyUpgradeSource:"Magic Transcription Limit"}},[Vl.TRIM_WITH_TRANSCRIPT_TRANSCRIBE]:{permission:Bl.TRANSCRIBE,metadata:{prettyUpgradeSource:"Trim with Transcript Transcription Limit"}},[Vl.REMOVE_30_SEC_WATERMARK]:{permission:Bl.EXPORT_30_SEC_WITHOUT_WATERMARK,metadata:{prettyUpgradeSource:"Remove Watermark",upsellHeading:"Create watermark-free content",upsellBody:"Upgrade to remove our watermark from your projects",imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp"}},[Vl.REMOVE_WATERMARK]:{permission:Bl.EXPORT_ALL_WITHOUT_WATERMARK,metadata:{prettyUpgradeSource:"Remove Watermark",upsellHeading:"Create watermark-free content",upsellBody:"Upgrade to remove our watermark from your projects",imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp"}},[Vl.FULL_HD]:{permission:Bl.HIGH_QUALITY,metadata:{prettyUpgradeSource:"Full HD"}},[Vl.BACKGROUND_IMAGE_ERASE]:{permission:Bl.REMOVE_BACKGROUND,metadata:{prettyUpgradeSource:"Background Image Erase",upsellBody:"Upgrade to export projects with Remove Background applied to images",imgSrc:"https://cdn-useast1.kapwing.com/static/nOm-remove-background-banner-image.svg"}},[Vl.BRAND_TEMPLATES]:{permission:Bl.BRANDKIT,metadata:{prettyUpgradeSource:"Use Brand Kit",heroBody:"Stay on-brand all the time with Brand Kit, now including templates. Create your own templates and easily start from them to save time and stay consistent across projects and team members.",heroHeader:"Introducing Brand Templates"}},[Vl.BRANDKIT]:{permission:Bl.BRANDKIT,metadata:{prettyUpgradeSource:"Use Brand Kit"}},[Vl.STUDIO_MEDIA_SIDEBAR]:{permission:Bl.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Media Sidebar"}},[Vl.CREATE_NEW_FOLDER]:{permission:Bl.CREATE_NEW_FOLDER,metadata:{prettyUpgradeSource:"New Folder"}},[Vl.ONBOARDING_SURVEY]:{metadata:{prettyUpgradeSource:"Onboarding Survey"}},[Vl.MAGIC_SUBTITLE_FILE_DL]:{permission:Bl.SUBTITLER,metadata:{prettyUpgradeSource:"Magic Subtitle File Dl"}},[Vl.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Post Onboarding Single Account Upsell"}},[Vl.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Post Onboarding Multi-Account Upsell"}},[Vl.TWO_WEEK_RECURRING_SINGLE_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Recurring Single Account Upsell"}},[Vl.TWO_WEEK_RECURRING_MULTI_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Recurring Multi Account Upsell"}},[Vl.WORKSPACE_SETTINGS]:{metadata:{prettyUpgradeSource:"Workspace Settings"}},[Vl.DEFAULT]:{metadata:{prettyUpgradeSource:"Default"}},[Vl.CLEAN_AUDIO]:{permission:Bl.CLEAN_AUDIO,metadata:{prettyUpgradeSource:"Clean Audio"}},[Vl.SMART_CUT_VIDEO]:{permission:Bl.SMART_CUT,metadata:{prettyUpgradeSource:"Smart Cut Video"}},[Vl.SMART_CUT_AUDIO]:{permission:Bl.SMART_CUT,metadata:{prettyUpgradeSource:"Smart Cut Audio"}},[Vl.REMOVE_VIDEO_BACKGROUND]:{permission:Bl.REMOVE_BACKGROUND,metadata:{prettyUpgradeSource:"Remove Video Background"}},[Vl.AUDIOGRAM_WAVE]:{permission:Bl.AUDIOGRAM,metadata:{prettyUpgradeSource:"Waveform Audiogram",imgSrc:"https://cdn-useast1.kapwing.com/static/F-T-white_waveform.webp"}},[Vl.AUDIOGRAM_BAR]:{permission:Bl.AUDIOGRAM,metadata:{prettyUpgradeSource:"Waveform Audiogram",imgSrc:"https://cdn-useast1.kapwing.com/static/zlv-bars.webp"}},[Vl.STOCK_ASSETS_MUSIC]:{permission:Bl.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Music"}},[Vl.STOCK_ASSETS_SFX]:{permission:Bl.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets SFX"}},[Vl.STOCK_ASSETS_VIDEO]:{permission:Bl.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Video"}},[Vl.STOCK_ASSETS_IMAGE]:{permission:Bl.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Image"}},[Vl.PRICING_PAGE]:{metadata:{prettyUpgradeSource:"Pricing Page"}},[Vl.LINK]:{metadata:{prettyUpgradeSource:"Checkout Link"}},[Vl.REACTIVATE_LICENSE]:{metadata:{prettyUpgradeSource:"Reactivate License"}},[Vl.GENERATE_IMAGES]:{permission:Bl.GENERATE_IMAGES,metadata:{prettyUpgradeSource:"AI Image Generator",upsellBody:"Upgrade for unlimited image generation."}},[Vl.GENERATE_LONG_DURATION_AI]:{permission:Bl.GENERATE_LONG_DURATION_AI,metadata:{upsellBody:"Upgrade for longer AI generations."}},[Vl.GENERATE_DOCUMENT_TO_VIDEO]:{permission:Bl.GENERATE_DOCUMENT_TO_VIDEO,metadata:{prettyUpgradeSource:"Document to Video Generator",upsellBody:"Upgrade to convert unlimited documents to video."}},[Vl.GENERARATE_MEME]:{permission:Bl.GENERATE_MEME,metadata:{prettyUpgradeSource:"AI Meme Generator",upsellBody:"Upgrade to convert unlimited documents to video."}},[Vl.GENERATE_SCRIPT]:{permission:Bl.GENERATE_SCRIPT,metadata:{prettyUpgradeSource:"AI Script Generator",upsellBody:"Upgrade to generate unlimited scripts."}},[Vl.GENERATE_SCRIPT_TO_VIDEO]:{permission:Bl.GENERATE_SCRIPT_TO_VIDEO,metadata:{prettyUpgradeSource:"Script to Video Generator",upsellBody:"Upgrade to convert unlimited scripts to video."}},[Vl.GENERATE_SCRIPT_IN_SCRIPT_TO_VIDEO]:{permission:Bl.GENERATE_SCRIPT,metadata:{prettyUpgradeSource:"AI Script Generator",upsellBody:"Upgrade to generate unlimited scripts."}},[Vl.GENERATE_TTS_VIDEO]:{permission:Bl.GENERATE_TTS_VIDEO,metadata:{prettyUpgradeSource:"AI Video Generator",upsellBody:"Upgrade to generate unlimited videos."}},[Vl.GENERATE_VIDEO]:{permission:Bl.GENERATE_VIDEO,metadata:{prettyUpgradeSource:"AI Slideshow Generator",upsellBody:"Upgrade to generate unlimited slideshows."}},[Vl.GENERATE_B_ROLL]:{permission:Bl.GENERATE_B_ROLL,metadata:{prettyUpgradeSource:"AI B-Roll Generator",upsellBody:"Upgrade to automatically find images related to your project."}},[Vl.PREMIUM_ASSETS]:{permission:Bl.PREMIUM_ASSETS,metadata:{prettyUpgradeSource:"Premium Assets",upsellBody:"Upgrade to access premium assets."}},[Vl.USE_MAGIC_FILL]:{permission:Bl.USE_MAGIC_FILL,metadata:{prettyUpgradeSource:"Magic Fill",upsellBody:"Upgrade to use Magic Fill on all your images."}},[Vl.AUTO_TRANSLATE]:{permission:Bl.MORE_AUTO_TRANSLATE,metadata:{prettyUpgradeSource:"Auto Translate",upsellBody:"Upgrade to translate more subtitles."}},[Vl.GENERATE_ARTICLE_TO_VIDEO]:{permission:Bl.GENERATE_ARTICLE_TO_VIDEO,metadata:{prettyUpgradeSource:"Article to Video Generator",upsellBody:"Upgrade to convert unlimited articles to video."}},[Vl.LIMITS_WARNING]:{permission:Bl.NO_LIMITS_PAYWALL},[Vl.REPURPOSE_STUDIO]:{permission:Bl.NO_LIMITS_PAYWALL},[Vl.CLONED_VOICES]:{permission:Bl.CLONED_VOICES,metadata:{prettyUpgradeSource:"brandkit cloned voices",upsellBody:"Upgrade to clone your voice for Text to Speech voiceovers."}},[Vl.CLONED_VOICES_LIMIT]:{permission:Bl.CLONED_VOICES_LIMIT,metadata:{prettyUpgradeSource:"brandkit cloned voices limit",upsellBody:"Upgrade to save up to 4 cloned voices."}}},Wc=e=>Vc[e].permission||Dc,Gc="https://cdn-useast1.kapwing.com/static/9EB-img_upsell_sidebar.webp",Hc=e=>{var t,o,a,i,s,n,r,l;const d=e&&Vc[e],c=(null==d?void 0:d.permission)&&Bc[null==d?void 0:d.permission];return{img:{imgSrc:(null==(t=null==d?void 0:d.metadata)?void 0:t.imgSrc)||(null==c?void 0:c.imgSrc)||Gc,imgAlt:(null==(o=null==d?void 0:d.metadata)?void 0:o.upsellHeading)||(null==c?void 0:c.upsellHeading)||"Upgrade to store unlimited projects, comment, and more."},heroImg:{imgSrc:(null==(a=null==d?void 0:d.metadata)?void 0:a.heroImg)||(null==c?void 0:c.heroImg)||Gc,imgAlt:(null==(i=null==d?void 0:d.metadata)?void 0:i.heroHeader)||(null==c?void 0:c.heroHeader)||"Staying on brand has never been easier"},upsellHeroHeading:(null==(s=null==d?void 0:d.metadata)?void 0:s.heroHeader)||(null==c?void 0:c.heroHeader)||"Staying on brand has never been easier",upsellHeroBody:(null==(n=null==d?void 0:d.metadata)?void 0:n.heroBody)||(null==c?void 0:c.heroBody)||"Upgrade so you can stay on-brand all the time with Brand Kit. Set up your own Brand Templates and upload your own brand colors, fonts, images, and videos to make the same assets available to everyone in this workspace.",upsellBlockHeading:(null==(r=null==d?void 0:d.metadata)?void 0:r.upsellHeading)||(null==c?void 0:c.upsellHeading)||"Unlock the full Kapwing experience",upsellBlockBody:(null==(l=null==d?void 0:d.metadata)?void 0:l.upsellBody)||(null==c?void 0:c.upsellBody)||"Upgrade to store unlimited projects, comment, and more.",upgradePermission:Wc(e),buttonText:"Upgrade"}},$c=e=>{switch(e){case Cl.Free:return new zc;case Cl.Basic:return new Jc;case Cl.Pro:return new qc;case Cl.Business:return new Xc;case Cl.Edu:return new Zc;case Cl.Team:return new eu;case Cl.Enterprise:return new Qc;default:return new zc}};class Kc{constructor(e){this._planTier=e}get type(){return this._planTier}get name(){return jc(this._planTier)}get planDescription(){switch(this._planTier){case Cl.Free:return"Perfect for anyone getting started with video editing.";case Cl.Basic:return"Edit images and short videos quickly and easily.";case Cl.Pro:return"For individuals and small groups looking to create more content in less time";case Cl.Business:return"For individuals and teams that need to supercharge their content creation workflow";case Cl.Enterprise:return"For large organizations that need advanced controls and support";case Cl.Team:return"Unlock the full power of Kapwing for your business.";default:return""}}get upgradesTo(){return this.planData.upsellsTo||null}get upgradesFrom(){return this.planData.upsellsFrom||null}get className(){return this._planTier.toLowerCase()}get planData(){return Wl[this._planTier]}get isPaid(){return this._planTier!==Cl.Free}get isFree(){return this._planTier===Cl.Free}get isEdu(){return this._planTier===Cl.Edu}get showUpgrades(){return!this.hasPermission(Bl.NO_UPSELLS)}get canSwitchToAnnual(){return void 0===this.planData.canSwitchToAnnual||this.planData.canSwitchToAnnual}get canCancel(){return void 0===this.planData.canCancel||this.planData.canCancel}get canChangeSeats(){return void 0===this.planData.canChangeSeats||this.planData.canChangeSeats}is(e){return this._planTier===e}hasPermission(e){return Bc[e].planTiers.includes(this.type)}getBasePrice(){return this.planData.basePrice}getPriceForInterval(e){return this.getBasePrice()[e]}}class zc extends Kc{constructor(){super(Cl.Free)}}class Yc extends Kc{constructor(e){super(e),this._planTier=e}get planTier(){return this._planTier}}class Jc extends Yc{constructor(){super(Cl.Basic)}}class qc extends Yc{constructor(){super(Cl.Pro)}}class Xc extends Yc{constructor(){super(Cl.Business)}}class Qc extends Yc{constructor(){super(Cl.Enterprise)}}class Zc extends Yc{constructor(){super(Cl.Edu)}}class eu extends Yc{constructor(){super(Cl.Team)}}const tu=m(kc,(e=>{if(!e)return $c(Cl.Free);let{planTier:t}=e;return t||(t=Cl.Free),$c(t)})),ou=()=>tl(tu),au=()=>tu(sr().state),iu=e=>{const t=_c(e);let{planTier:o}=t;return o||(o=Cl.Free),$c(o)},su=e=>{let{planTier:t}=e;return t||(t=Cl.Free),$c(t)},nu=e=>{var t;const{currentUser:o}=e;return!!(null==(t=null==o?void 0:o.user)?void 0:t._id)};let ru=!1;const lu=e=>{ru=e,null==amplitude||amplitude.getInstance().setUserProperties({"Is Qualified Domain":e})};async function du(){const{state:e}=sr();if(!nu(e))return;const{isQualifiedDomain:t}=await Yr("/api/v1/users/qualifiedDomain");lu(t)}function cu(){const[e,t]=h.useState(!1),o=tl((e=>{var t;if(!e.currentUser)return!1;if("object"!=typeof e.currentUser.user||!e.currentUser.user)return!1;const o=null==(t=e.currentUser.user.onboarding)?void 0:t.survey;return!!o&&(("marketing"===o.occupation||"creative agency"===o.occupation)&&o.usage===od.Work)}));return h.useEffect((function(){du().then((()=>{t(ru)}))}),[]),e&&o}let uu=null,mu=!1;function pu(e,t){uu&&uu.issue(e,t)}function hu(e,t){uu&&uu.event(e,t)}const gu=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const e=ou(),t=e.isPaid,o=e.className,a=cu(),i="undefined"!=typeof window&&!window.Cypress&&!kr()&&!wr,{userID:s,videoId:n}=tl((e=>{const{_id:t}=e.currentUser.user||{};return{userID:t,videoId:e.studio._id}}),ol),r=i&&(a||t);return h.useEffect((function(){r&&!mu&&async function(e,t){var o,a;const{default:i}=await yc((()=>import("./index-ec866c31.js").then((e=>e.i))),["assets/index-ec866c31.js","assets/vendor-3b0a39e0.js"]);uu=new i({projectKey:"XWKtmaC5j8aO78qMVX4v",network:{capturePayload:!0,captureInIframes:!1,failuresOnly:!1,ignoreHeaders:!1,sessionTokenHeader:!1},onStart:({sessionToken:e})=>{N("openReplaySessionToken",e),uu&&N("openReplaySessionURL",uu.getSessionURL())},obscureInputDates:!1,obscureInputEmails:!1,obscureInputNumbers:!1,obscureTextEmails:!1,obscureTextNumbers:!1,defaultInputMode:0}),window.openReplayFetch=fetch;try{await uu.start({userID:e,forceNew:!1,metadata:{version:"v2023.12.22.1",amplitudeSession:null==(a=null==(o=null==amplitude?void 0:amplitude.getInstance())?void 0:o.getSessionId)?void 0:a.call(o),...t}}),mu=!0,console.debug("Started openreplay")}catch(s){if(console.error("openreplay failed to start: ",s),"string"==typeof s&&s.includes("capture limit has been reached"))return;R(s)}}(s,{CurrentPlan:o})}),[o,r,s]),h.useEffect((function(){r&&mu&&n&&uu&&uu.event("opened_video",n)}),[n,r]),null},logOpenReplayEvent:hu,reportOpenReplayIssue:pu},Symbol.toStringTag,{value:"Module"})),fu=v({initialState:{assetIdToMediaCacheId:{},mediaCacheIdToAssetId:{},mediaCacheIdToUploadId:{},uploadIdToMediaCacheId:{}},name:"mediaCache",reducers:{linkAssetToMediaCache:(e,t)=>{e.assetIdToMediaCacheId[t.payload.assetId]=t.payload.mediaCacheId,e.mediaCacheIdToAssetId[t.payload.mediaCacheId]=t.payload.assetId},bulkLinkAssetToMediaCache:(e,t)=>{t.payload.forEach((t=>{e.assetIdToMediaCacheId[t.assetId]=t.mediaCacheId,e.mediaCacheIdToAssetId[t.mediaCacheId]=t.assetId}))},linkUploadToMediaCache:(e,t)=>{e.uploadIdToMediaCacheId[t.payload.uploadId]=t.payload.mediaCacheId,e.mediaCacheIdToUploadId[t.payload.mediaCacheId]=t.payload.uploadId},bulkLinkUploadToMediaCache:(e,t)=>{t.payload.forEach((t=>{e.uploadIdToMediaCacheId[t.uploadId]=t.mediaCacheId,e.mediaCacheIdToUploadId[t.mediaCacheId]=t.uploadId}))}}}),{linkAssetToMediaCache:yu,bulkLinkAssetToMediaCache:vu,linkUploadToMediaCache:_u,bulkLinkUploadToMediaCache:wu}=fu.actions,bu=(e,t=sr().state.mediaCache)=>{const{dispatch:o}=sr(),a=Tu(e,t);if(a)return a;const i=P();let s=!1;const n=e.asset_id;return n&&(o(yu({assetId:n,mediaCacheId:i})),s=!0),e.uploadId&&(o(_u({mediaCacheId:i,uploadId:e.uploadId})),s=!0),s||console.error("Could not link media cache id to anything",e),i};function Tu(e,t=sr().state.mediaCache){const{assetIdToMediaCacheId:o,uploadIdToMediaCacheId:a}=t;if(e.asset_id){const t=o[e.asset_id];if(t)return t}if(e.uploadId){const t=a[e.uploadId];if(t)return t}return null}function xu(e){const t=new Map;for(const o of Object.values(e.allLayers.byId)){if(!ql(o)&&!Ql(o))continue;const{asset_id:e}=o;if(!e)continue;const a=t.get(e)||0;t.set(e,a+1)}return Array.from(t.values()).reduce(((e,t)=>e+(t-1)),0)}const Su=e=>{var t;if(void 0!==window.TouchEvent&&e instanceof window.TouchEvent)return!0;return!!(null==(t=null==e?void 0:e.touches)?void 0:t.length)},Eu=e=>{var t,o,a,i;if(Su(e)){const s=e;return[(null==(o=null==(t=null==s?void 0:s.touches)?void 0:t[0])?void 0:o.clientX)||0,(null==(i=null==(a=null==s?void 0:s.touches)?void 0:a[0])?void 0:i.clientY)||0]}const s=e;return[s.clientX,s.clientY]},Iu=(e,t=(e=>e))=>{if(e.length<=1)return!0;const[o,...a]=e;if(!o)return!1;const i=t(o);return a.every((e=>Object.is(t(e),i)))},Cu=e=>{if("undefined"!=typeof window&&window.matchMedia){const[t,o]=h.useState(window.matchMedia(e).matches);return h.useEffect((()=>{const a=window.matchMedia(e);a.matches!==t&&o(a.matches);const i=()=>o(a.matches);return a.addListener(i),()=>a.removeListener(i)}),[t,e]),t}return!1},ku=()=>tl((e=>e.isMobile)),Au=()=>{const e=window,t=document,o=t.documentElement,a=t.body;return(e.innerWidth||o.clientWidth||a.clientWidth)<=768},ju=e=>{if(e.dataTransfer.types)for(let t=0;t<e.dataTransfer.types.length;t+=1)if("Files"===e.dataTransfer.types[t])return!0;return!1},Nu=()=>{const e=ku(),t=Cu("(orientation: landscape)");return!(!e||!t)},Ru=(e,t,o)=>Math.min(Math.max(parseFloat(e),t),o),Pu=(e,t)=>e?e.length<=t?e:`${e.substring(0,t-3)}...`:"";function Du(e){return Object.keys(e).filter((t=>e[t])).join(" ").trim()}const Ou=(e,t=3)=>{const o=10**t;return Math.round(e*o)/o},Lu=Math.random().toString(36).substring(2),Fu=()=>{try{if("undefined"!=typeof window&&"undefined"!=typeof document){const e=document.domain||"",t=e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||e.startsWith("localhost")&&["3000","4000","5000","3030"].includes(window.location.port),o=t?"461b8b8947f81e4f070013ded04799df":"e3eca64f2da6246ee6a22cd63f455a07",a={includeUtm:!0,includeReferrer:!0,includeGclid:!0,includeFbclid:!0,useDynamicConfig:!0,onExitPage:()=>{window.amplitudeOnExit&&window.amplitudeOnExit()}};amplitude.getInstance().init(o,null,a);const i="v2023.12.22.1",s=Pr(),n=t?s:i;return amplitude.setVersionName(n),amplitude}}catch(IGe){}return null},Mu={basicTier:{control:.9,test:.1},canvasWatermark:{control:.9,test:.1},inHouse:{control:.2,test:.8},speakerTranscription:{control:.9,test:.1},speakerTranscriptionBatchTwo:{control:.6,test:.4}};function Uu(){const e=localStorage.getItem("EXPERIMENTS_LOCAL_STORAGE_KEY")||"{}";return JSON.parse(e)||{}}function Bu(e){return"test"===Gu()[e]}let Vu;const Wu=()=>{const e=Uu(),t=(e=>{const t=Object.keys(e);return Object.keys(Mu).filter((e=>!t.includes(e)))})(e);if(t.length){const a=(()=>{const e={};return Object.keys(Mu).forEach((t=>{const o=Math.random();let a=0;const i=Mu[t];if(i)for(const[s,n]of Object.entries(i))if(a+=n,o<a){e[t]=s;break}})),e})();t.forEach((t=>{e[t]=a[t]})),o=e,localStorage.setItem("EXPERIMENTS_LOCAL_STORAGE_KEY",JSON.stringify(o))}var o;return Vu=e,e},Gu=()=>(null==Vu&&(Vu=Wu()),Vu),Hu=e=>{const{teams:t}=e??sr().state,{allTeams:o,selectedTeamId:a}=t;if(!a||!o.length)return vc;try{return t.allTeams.find((e=>e._id===t.selectedTeamId))}catch(IGe){throw console.error("Unable to find current team..."),new Error(`Unable to find team - ${null==t?void 0:t.selectedTeamId}`)}},$u=e=>e?e.status:"unknown",Ku=e=>e&&e.plan&&e.plan.interval?e.plan.interval:Il.Month,zu=e=>!!e&&"past_due"===e.status,Yu=e=>!!e&&"active"===e.status,Ju=e=>e?{status:$u(e),interval:Ku(e),isPastDue:zu(e),isActive:Yu(e),isCancelled:!!e.cancel_at_period_end,numPaidSeats:e.quantity}:{status:"unknown",interval:Il.None,isPastDue:!1,isActive:!1,isCancelled:!1,numPaidSeats:0},qu=e=>{const{interval:t}=Ju(e);return"month"===t},Xu=e=>{const{cancel_at_period_end:t}=e;if(qu(e))return!!t;return Rc(new Date(e.current_period_end),new Date)<30},Qu=({interval:e,capitalize:t=!0})=>{switch(e){case Il.Month:return t?"Monthly":"monthly";case Il.Year:return t?"Annually":"annually";case Il.None:default:return t?"Never":"never"}};function Zu(e){return e.type===zl.Audio}function em(e){return e.type===zl.Image}function tm(e){return e.type===zl.Shape&&"progressBar"===e.shapeType}function om(e){return e.type===zl.Video}function am(e){return e.type===zl.Text}function im(e){return e.type===zl.Shape}function sm(e){return em(e)||Zu(e)||om(e)}function nm(e){return em(e)||im(e)||am(e)||om(e)}function rm(e){const t=[];return e.forEach((e=>{(om(e)||Zu(e))&&t.push(e)})),t}function lm(e,t){if(e){const o=e[t];null!=o&&"number"!=typeof o&&(e[t]=Number(o))}}function dm(e){let{startTime:t,endTime:o,videoDelay:a,duration:i,playbackRate:s}=e;return null==i&&(i=3),null==t&&(t=0),null==o&&(o=i),null==a&&(a=0),null==s&&(s=1),{startTime:t,endTime:o,videoDelay:a,duration:i,playbackRate:s}}const cm=(e,t=0,o=!1)=>{if(!e||0===Object.keys(e).length)return{start:0,end:0};lm(e,"startTime"),lm(e,"endTime"),lm(e,"duration"),lm(e,"videoDelay");const a=e.type===zl.Video||e.type===zl.Audio?e.videoDelay||0:e.startTime||0;let i=um(e)||t;e.loopMode&&"duration"===e.loopMode&&t&&!o&&(i=t);return{start:a,end:i+a}},um=e=>{const t=e.playbackRate||1;let o=0;return e.isTrimmed?o=e.endTime-e.startTime:e.duration&&(o=e.duration),o/t},mm=e=>e&&0!==Object.keys(e).length?(lm(e,"globalAlpha"),e.globalAlpha):0,pm=(e,t,o)=>{const{crop:a}=o;let i=e,s=t;if(o.width&&o.height){let e=o.width/o.height;a&&(e*=a.width/a.height),i/s>e?s=i/e:i=s*e,a&&(i*=100/a.width,s*=100/a.height)}return{width:i,height:s}};function hm(e,t){return Math.floor(Math.ceil(100*e*t.maxFramerate)/100)}function gm(e,t,o){const{start:a,end:i}=cm(e,o.duration),s=hm(a,o),n=hm(i,o);return 0===a&&0===i&&0===o.duration||s<=t&&t<n}function fm(e,t,o){const{start:a,end:i}=cm(e,o.duration);return a<=t&&t<i}var ym=(e=>(e.TELEPROMPTER_OPENED="Teleprompter Opened",e.REQUEST_TO_EDIT_SENT="Request to Edit Sent",e.SELECTED_PAST_PROMPT="Selected Past Prompt",e.SYNC_VIDEO_TO_SHARED_DOC="Sync Video To Shared Doc",e.PROJECT_STUDIO_LINK_VISITED="Project Studio Link Visited",e.GENERATE_THUMBNAIL="Generate Thumbnail",e.FAILED_TO_DISPATCH_TO_EXPORT_CLUSTERS="Failed to Dispatch to Export Clusters",e.ACCESS_FINAL_VIDEO_PAGE="Access Final Video Page",e.ACCESS_SNAPSHOT_PAGE="Access Snapshot Page",e.ACCESS_EXPIRED_EXPORT="Access Expired Export",e.SHARE_FINAL_VIDEO="Share Final Video",e.CONVERT_PROJECT_TO_BRAND_TEMPLATE_DROPDOWN="Make a brand template from the project's workspace dropdown",e.COPY_PROJECT="Copy Project",e.DELETE_TEAM_WORKSPACE="Delete Workspace",e.INITIATE_DELETE_WORKSPACE="Initiate Delete Team Workspace",e.MOVE_PROJECT="Move Project",e.NEW_BRAND_TEMPLATE_STUDIO="Start a new brand template within the studio",e.NEW_PROJECT_STUDIO="Start a new project within the studio",e.AUTO_GENERATE_SUBTITLES="Auto-generate Subtitles",e.AUTO_GENERATE_SUBTITLES_FAILS="Auto-generate Subtitles Fails",e.AUTO_GENERATE_SUBTITLES_SUCCEEDS="Auto-generate Subtitles Succeeds",e.TRANSCRIPTION_FEEDBACK="Transcript Feedback",e.SUBTITLES_DELETED="Subtitles Deleted",e.SUBTITLE_CHANGES_EXPORTED="Subtitles With Changes Exported",e.TRIM_WITH_TRANSCRIPT_OPEN_TAB="Trim with Transcript - Opened Tab",e.TRIM_WITH_TRANSCRIPT_START_GENERATE="Trim with Transcript - Started Generation",e.TRIM_WITH_TRANSCRIPT_VIEW_TRANSCRIPT="Trim with Transcript - Viewed Transcript",e.TRIM_WITH_TRANSCRIPT_RESTORED_TRANSCRIPT="Trim with Transcript - Restored Transcript",e.TRIM_WITH_TRANSCRIPT_TRIMMED_TRANSCRIPT="Trim with Transcript - Trimmed Transcript",e.TRIM_WITH_TRANSCRIPT_DOWNLOADED_TRANSCRIPT="Trim with Transcript - Downloaded Transcript",e.TRIM_WITH_TRANSCRIPT_VIEW_SUBTITLES="Trim with Transcript - View Subtitles",e.TRIM_WITH_TRANSCRIPT_USED_SEARCH="Trim with Transcript - Used Search",e.TRIM_WITH_TRANSCRIPT_SHOWED_SUGGESTIVE_POPUP="Trim with Transcript - Showed Suggestive Popup",e.FIND_HIGHLIGHTS_DEV_QUALITY_REPORT="Find Highlights - Dev Quality Report",e.FIND_HIGHLIGHTS_GENERATED_BACKEND="Find Highlights - Generation Complete Backend",e.FIND_HIGHLIGHTS_FAILED_BACKEND="Find Highlights - Generation Failed Backend",e.FIND_HIGHLIGHTS_GENERATE_STARTED_CLIENT="Find Highlights - Generation Started Client",e.FIND_HIGHLIGHTS_GENERATE_SUCCESS_CLIENT="Find Highlights - Generation Success Client",e.FIND_HIGHLIGHTS_GENERATE_FAILURE_CLIENT="Find Highlights - Generation Failure Client",e.FIND_HIGHLIGHTS_HIGHLIGHT_OPENED="Find Highlights - Highlight Opened",e.FIND_HIGHLIGHTS_HIGHLIGHTS_REGENERATED="Find Highlights - Highlights Regenerated",e.REMOVE_FILLER_WORDS="Remove Filler Words",e.REMOVE_FILLER_WORDS_BACKEND_FAILED="Remove Filler Words - Backend Failed",e.REMOVE_FILLER_WORDS_BACKEND_SUCCESS="Remove Filler Words - Backend Success",e.DISMISSED_WORKSPACE_DETAILS_SIDEBAR_UPSELL="Dismissed Workspace Details Sidebar Upsell",e.RECENT_EXPORTS_TO_VERSION_HISTORY="Recent Exports to Version History",e.SHOWN_WORKSPACE_DETAILS_SIDEBAR_UPSELL="Shown Workspace Details Sidebar Upsell",e.UPDATE_TEAM_JOIN_LINK="Update Team Join Link",e.OPEN_SEAT_ADDED="Open Seat Added",e.OPEN_SEAT_REMOVED="Open Seat Removed",e.LEFT_TEAM="Left Team",e.UPGRADE_MONTHLY_TO_ANNUAL="Upgrade Monthly to Annual",e.TEAM_CREATED="Team Created - Team",e.TEAM_DISBANDED="Team Disbanded - Team",e.TEAM_FAILED_PAYMENT_EXPANSION="Team Failed Payment - Expansion",e.TEAM_UPGRADE_WORKSPACE="Upgrade Workspace - Team",e.TEAM_DOWNGRADE_WORKSPACE="Downgrade Workspace - Team",e.TEAM_PAID_SEATS_ADDED="Paid Seats Added - Team",e.TEAM_PAID_SEATS_REMOVED="Paid Seats Removed - Team",e.TEAM_ENTERPRISE_USAGE_OUT="Enterprise packaging usage out - Team",e.TEAM_ENTERPRISE_USAGE_CLOSE="Enterprise packaging limit almost out - Team",e.TEAM_ENTERPRISE_USAGE_HALF="Enterprise packaging usage half out - Team",e.TEAM_ENTERPRISE_FORM_SUBMITTED="Enterprise form submitted - Team",e.MAKE_EDITOR_SHARE_DIALOG="Make Editor from Share Dialog",e.REMOVE_MEMBER_SURVEY="Remove Member Survey",e.CANCEL_SCHEDULED_PROJECT_DELETION_EMAILS="Cancel Scheduled Project Deletion Emails",e.RETRY_DISPATCH_FROM_HEROKU="Retry Dispatch From Heroku",e.TOOK_WELCOME_SCREEN_ACTION="Took Welcome Screen Action",e.STUDIO_TOUR_TRY_A_SAMPLE="Studio Tour - shown try a sample tooltip",e.STUDIO_TOUR_SPLIT="Studio Tour - shown split tooltip",e.STUDIO_TOUR_TRIM_TRANSCRIPT="Studio Tour - shown trim with transcript tooltip",e.STUDIO_TOUR_SUBTITLES="Studio Tour - shown subtitle tooltip",e.STUDIO_TOUR_EXPORT="Studio Tour - shown export tooltip",e.STUDIO_TOUR_DISMISS="Studio Tour - dismissed",e.STUDIO_TOUR_COMPLETE="Studio Tour - finished tour",e.ADDED_KEYFRAME="Added Keyframe",e.ADDED_TEXT_PRESET="Added Text Preset",e.ADDED_TEXT_TEMPLATE="Added Text Template",e.ADDED_WORKSPACE_LOGO="Added Workspace Logo",e.ADDED_WORKSPACE_NAME="Added Workspace Name",e.ADD_AUDIOGRAM="Add Audiogram",e.ADD_FROM_GOOGLE_DRIVE="Add from Google Drive",e.ADD_FROM_GOOGLE_PHOTOS="Add from Google Photos",e.ADD_FROM_PASTED_LINK="Add from Pasted Link",e.ADD_LAYER_FROM_MUSIC_SIDEBAR="Add layer from music sidebar",e.ADD_LAYER_FROM_ELEMENT_SEARCH="Add layer from element search",e.ADD_LAYER_FROM_GENERATE_IMAGE="Add Layer from Generate Image",e.ADD_LAYER_FROM_IMAGE_SEARCH="Add layer from image search",e.ADD_LAYER_FROM_PLUGIN="Add layer from Plugin",e.ADD_LAYER_FROM_SHAPE_SIDEBAR="Add layer from shape sidebar",e.ADD_LAYER_FROM_SOUND_EFFECT_SIDEBAR="Add layer from sound effect sidebar",e.ADD_LAYER_FROM_VIDEO_SEARCH="Add layer from video search",e.ADD_LAYER_FROM_DND="Add Layer From DND",e.ADD_LAYER_TO_PROJECT="Add Layer To Project",e.ADD_PLACEHOLDER_LAYER="Add placeholder layer",e.ADD_PROGRESS_BAR="Add Progress Bar",e.ADD_TEMPLATE_FROM_SIDEBAR="Add  template from sidebar",e.ADD_TEXT_LAYER="Add Text Layer",e.ADD_TRANSITION="Add Transition",e.ADD_VIDEO_LAYER_TO_PROJECT="Add Video Layer To Project",e.ADJUST_LEFT_SIDEBAR="Adjust left sidebar",e.AI_GENERATION_TIMES="AI Generation Times",e.AI_GENERATOR_CANCELLED="AI Generator Cancelled",e.ALL_WORKSPACE_FOLDERS_LOADED="All Workspace Folders Loaded",e.ARTICLE_TO_VIDEO_GENERATOR_PASTED_LINK="Pasted Link in Article to Video Generator",e.ARTICLE_TO_VIDEO_GENERATOR_GENERATE_OUTLINE="Generated Outline in Article to Video Generator",e.ARTICLE_TO_VIDEO_GENERATOR_ADD_VIDEO_TO_CANVAS="Added Video to Canvas in Article to Video Generator",e.ASSET_WAVEFORM_GENERATION="Asset Waveform Generation",e.AUDIO_FETCH_MORE="Audio Tab Fetching More Entries",e.AUTO_LEVEL_VOLUME="Auto Level Volume",e.AUTOPLAY_BLOCKED="Autoplay blocked",e.BEGAN_ONBOARDING_SURVEY="Began Onboarding Survey",e.BEGIN_ADD_WORKSPACE_DETAILS="Begin Add Workspace Details",e.BEGIN_HOW_DID_YOU_HEAR_ABOUT_US="Begin how did you hear about us",e.BEGIN_SUGGESTED_WORKSPACES="Begin Suggested Workspaces",e.BEGIN_WORKSPACE_SHARE="Begin Workspace Share",e.BLUR_VIDEO_BACKGROUND="Blur video background",e.BROLL_PARSE_TRANSCRIPT_KEYWORDS="BRoll Parse Transcript Keywords",e.B_ROLL_ADD_LAYERS="B-Roll Add Images",e.B_ROLL_GENERATION_RESULT="B-Roll Generation Result",e.B_ROLL_IMAGE_SEARCH="B-Roll Image Search",e.B_ROLL_PREVIEW_CLICK="B-Roll Preview Click",e.BULK_ACTIONS_ERROR="Bulk Actions Error",e.CANVASBLUR_USED="CanvasBlur Used",e.CANVAS_RESIZE="Canvas Resize",e.CANVAS_RESIZE_ATTEMPT="Canvas Resize Attempt",e.CHANGED_AUDIO_TAB="Changed Audio Tab",e.CHANGED_TEXT_OUTLINE_COLOR="Changed Text Outline Color",e.CLICKED_CREATE_A_TEAM="Clicked Create a Team",e.CLICKED_DEFAULT_SUBTITLE_PRESET="Clicked Default Subtitle Preset",e.CLICKED_ON_THE_SURVEY="Clicked on the survey",e.CLICKED_SIGN_IN_TO_EXPORT="Clicked Sign In to Export",e.COMPLETED_HOW_DID_YOU_HEAR_ABOUT_US="Completed how did you hear about us",e.COMPLETED_ONBOARDING_SURVEY="Completed Onboarding Survey",e.COMPLETE_TRIM_AND_DRAG_ONBOARDING="Complete Trim And Drag Onboarding",e.CONTINUE_TO_SURVEY="Continue to Survey",e.CONVERSION_BEGINS="Conversion Begins",e.CONVERSION_FAILS="Conversion Fails",e.CREATE_FAILED_CLIENT_SIDE_VIDEO="Create Failed Client Side Video",e.CREATE_FOLDER="Create Folder",e.CREATE_TEAM="Create Team",e.CREATE_VIDEO="Create Video",e.CROSS_PROJECT_COPY="Cross-Project Copy",e.DELETE_LAYER="Delete Layer",e.DELETE_LAYER_PRESSED="Delete Layer Pressed",e.DETACH_AUDIO="Detach audio",e.DISMISS_SUGGESTED_WORKSPACES="Dismiss Suggested Workspaces",e.DISMISS_TRIM_AND_DRAG_ONBOARDING="Dismiss Trim And Drag Onboarding",e.DISPLAYED_TOAST_FOR_UNEXPECTED_ERROR="Displayed Toast For Unexpected Error",e.DOWNGRADED_WORKSPACE_SURVEY="Downgraded Workspace Survey",e.DOWNGRADE_WORKSPACE="Downgrade Workspace",e.DOWNLOAD_FILE="Download File",e.DOWNLOAD_SRT_ATTEMPT="Download SRT Attempt",e.DOWNLOAD_SRT_ERROR="Download SRT Error",e.DOWNLOAD_TRANSCRIPT_ATTEMPT="Download Transcript Attempt",e.DOWNLOAD_TRANSCRIPT_ERROR="Download Transcript Error",e.DOWNLOAD_VTT_ATTEMPT="Download VTT Attempt",e.DOWNLOAD_VTT_ERROR="Download VTT Error",e.DRAFT_RESUMED_VIA_EMAIL="Draft Resumed Via Email",e.DUPLICATE_LAYER="Duplicate Layer",e.EMPTY_COMMENT_PANE="Sign In to Comment",e.ENHANCE_AUDIO_ATTEMPT="Enhance Audio Attempt",e.ENHANCE_AUDIO_FAILS="Enhance Audio Fails",e.ENHANCE_AUDIO_SUCCEEDS="Enhance Audio Succeeds",e.ENHANCE_IMAGE_EXPLAINER_OPENED="Open Enhance Image Modal",e.ENHANCE_IMAGE_SUCCEEDS="Enhance Image Succeeds",e.ERROR_BOUNDARY="Error Boundary",e.EXPORT_BLOCKED_BY_REMAINING_UPLOAD="Export Blocked by Remaining Upload",e.EXTRACT_VIDEO_BEGINS="Extract Video Begins",e.EXTRACT_VIDEO_FAILS="Extract Video Fails",e.FAILED_PREEMPTIVE_DOWNLOAD_MODAL_SHOWN="Failed Preemptive Download Modal Shown",e.FAILED_TO_LOAD_WORKSPACE="Failed to load workspace",e.FINISH_SCENE_SPLIT="Finish Scene Split",e.FINISH_SMART_CUT="Finish Smart Cut",e.FINISH_TRIM="Finish Trim",e.FOLDER_UPLOAD="Folder Upload",e.FONT_UPLOAD="Font Upload",e.GENERATE_BROLL_ATTEMPT="Generate BRoll Attempt",e.GENERATE_IMAGE_QUERY="Generate Image Query",e.GETMEDIAINFO_FAILURE="getMediaInfo failure",e.GETMEDIAINFO_STARTED="getMediaInfo Started",e.GROUPING_LAYERS="Grouping layers",e.GROWTH_SURVEY_RESPONSE="Growth Survey Response",e.IMAGE_GENERATOR_FAILED="Image Generator Failed",e.INITIATED_CANCELLATION="Initiated Cancellation",e.INITIATED_PAYMENT_DETAILS_UPDATE="Initiated Payment Details Update",e.INITIATE_SIGN_IN="Initiate Sign In",e.INPUT_CLICK="Initiate Signed Out Comment",e.IN_HTTP_FALLBACK_MODE="In HTTP fallback mode",e.JOIN_REQUEST_ACCEPTED="Join Request Accepted",e.JOIN_REQUEST_DECLINED="Join Request Declined",e.LIGHT_ROUGH_CUT_CRITERIA_MET="Light Rough Cut Criteria Met",e.LOADED_PROJECT_WITH_BROKEN_UPLOAD="Loaded project with broken upload",e.LOCALSTORAGE_QUOTA_EXCEEDED="Localstorage Quota Exceeded",e.LOCK_LAYER_PRESSED="Lock Layer Pressed",e.LONG_WAVEFORM_GENERATION="Long waveform generation",e.MAGIC_CREATE_APPLIED="Magic Create Applied",e.MAGIC_CREATE_CUSTOMIZE_FINISH="Magic Create Customize Finish",e.MAGIC_CREATE_CUSTOMIZE_START="Magic Create Customize Start",e.MAGIC_CREATE_OPEN="Magic Create Open",e.MAGIC_CREATE_PRESET_SELECTED="Magic Create Preset Selected",e.MAGIC_FILL_ADDED_TO_CANVAS="Magic Fill Added to Canvas",e.MAGIC_FILL_CANCELLED="Magic Fill Cancelled",e.MAGIC_FILL_INITIATED="Magic Fill Initiated",e.MAGIC_FILL_OPENED="Magic Fill Opened",e.MAGIC_FILL_PROCESSING_COMPLETE="Magic Fill Processing Complete",e.MAKE_A_BRAND_TEMPLATE_WITHIN_THE_STUDIO="Make a brand template within the studio",e.MEDIA_LIBRARY_TRIM_CLICKED="Media library trim clicked",e.MULTI_SELECT_PROJECT_MANAGEMENT_ACTION_INITIATED="Multi Select Project Management Action Initiated",e.MULTI_UPLOAD="Multi Upload",e.NEW_COMMENT_ACTIVITY="New Comment Activity",e.NEW_PROJECT_IN_WORKSPACE="New Project In Workspace",e.NEW_PROJECT_VERSION_WARNING="New Project Version Warning Shown",e.NOTIFICATIONS_OPENED="Notifications Opened",e.NOTIFICATION_CLICKED="Notification Clicked",e.OPEN_FOLDER="Open folder",e.OPEN_LAYERS_TAB="Open Layers Tab",e.OPEN_SHARED_WITH_ME="Open Shared with Me",e.OPTIMIZATION_DURATION_MISMATCH="Optimization Duration Mismatch",e.PAST_DUE_RESOLVED="Past Due Resolved",e.PAYMENTACTION="paymentAction",e.PAYWALLED_EXPORT_CLICKED="Paywalled Export Clicked",e.PAYWALLED_UPLOAD="Paywalled Upload",e.PERFORMANCE_BASELINE="Performance Baseline",e.KAPWING_FROZE="Kapwing froze",e.KAPWING_STARTUP_STARTED="Kapwing startup started",e.KAPWING_STARTUP_FINISHED="Kapwing startup finished",e.POTENTIAL_LOST_WORK="Potential lost work",e.REJECTED_UPLOAD="Rejected Upload",e.REMOTE_REEDIT_STARTED="Remote Re-Edit Started",e.REMOVE_VIDEO_BACKGROUND="Remove video background",e.RENAME_MY_MEDIA="Rename My Media",e.REPLACE_LAYER="Replace Layer",e.REPORT_A_PROBLEM="Report a Problem",e.REPURPOSE_BUTTON_CLICKED="Repurpose Button Clicked",e.REPURPOSE_GENERATION_STARTED="Repurpose Generation Started",e.REPURPOSE_VIEWED_COMPLETED_EDITOR="Repurpose Viewed Completed Editor",e.REPURPOSE_EDIT_IN_STUDIO="Repurpose Edit In Studio",e.REPURPOSE_EXPORT_FROM_REPURPOSE_EDITOR="Repurpose Export From Repurpose Editor",e.REPURPOSE_DL_FROM_REPURPOSE_EDITOR="Repurpose Download From Repurpose Editor",e.REQUEST_TO_EDIT_BUTTON_CLICKED="Request to Edit Button Clicked",e.REQUEST_TO_JOIN="Request to Join",e.REVERT_TO_A_PREVIOUS_VERSION="Revert to a previous version",e.ROUGH_CUT_CRITERIA_MET="Rough Cut Criteria Met",e.SAFEZONE_USED="Safezone Used",e.SAVED_REMOVE_BACKGROUND="Saved Remove Background",e.SCENE_SPLIT_OPENED="Scene Split Opened",e.SCENE_SPLIT_RETRIEVAL_ATTEMPTED="Scene Split Retrieval Attempted",e.SCENE_SPLIT_RETRIEVAL_FAILED="Scene Split Retrieval Failed",e.SCENE_SPLIT_RETRIEVAL_SUCCEEDED="Scene Split Retrieval Succeeded",e.SCRIPT_TO_VIDEO_GENERATOR_FAILED="Script to Video Generator Failed",e.SEARCH_IN_MY_MEDIA="Search in My Media",e.SELECTED_ENTIRE_ROW="Selected Entire Row",e.SHOWN_BROWSER_WARNING="Shown Browser Warning",e.SHOWN_TRIM_AND_DRAG_ONBOARDING="Shown Trim And Drag Onboarding",e.SHOW_VIDEO_OPTIMIZATION_MESSAGE="Show Video Optimization Message",e.SIGN_IN_ERROR_OCCURRED="Sign In Error Occurred",e.SMART_CUT_OPENED="Smart Cut Opened",e.SPLIT_LAYERS="Split Layers",e.SPLIT_VIDEO_LAYER="Split Video Layer",e.STARTED_DOCUMENT_TO_VIDEO_GENERATOR="Started Document to Video Generator",e.STARTED_SCRIPT_TO_VIDEO_GENERATOR="Started Script to Video Generator",e.STARTED_EDITING="Started Editing",e.STARTED_IMAGE_GENERATOR="Started Image Generator",e.STARTED_MEME_GENERATOR="Started Meme Generator",e.STARTED_RECORDING="Started Recording",e.FINISHED_RECORDING="Finished Recording",e.STARTED_SCRIPT_GENERATOR="Started Script Generator",e.STARTED_SCRIPT_REGENERATION="Started Script Regeneration",e.STARTED_VIDEO_GENERATOR="Started Video Generator",e.STARTED_TTS_VIDEO_GENERATOR="Started TTS Video Generator",e.START_NEW_PROJECT_FROM_FINAL_VIDEO="Start New Project from Final Video",e.STUDIO_EXPORT_PANEL_OPENED="Studio Export Panel Opened",e.SUBMIT_ENDING_SURVEY="Submit Ending Survey",e.TEAM_BRANDKIT_UPDATE="Team Brandkit Update",e.TEAM_BUY_LICENSE="Team Buy License",e.TEAM_CANCELLED_LICENSES="Team Cancelled Licenses",e.TEAM_MEMBERS_INVITED="Team Members Invited",e.TEAM_PROJECT_ACCESSED="Team Project Accessed",e.TEAM_WORKSPACE_ACCESSED="Team Workspace Accessed",e.TEXT_TO_SPEECH_AUDIO_LAYER="Text to Speech Audio Layer",e.TEXT_TO_SPEECH_AUDIO_PREVIEW="Text to Speech Audio Preview",e.TEXT_TO_SPEECH_TAB_NAVIGATED_FROM_TEXT_LAYER="Text to Speech tab navigated from text layer",e.TIMING_TAB_EXACT_TIME_SET="Timing Tab Exact Time Set",e.TRANSLATED_SUBTITLES="Translated Subtitles",e.TRANSLATE_SUBTITLES_ATTEMPT="Translate Subtitles Attempt",e.TRANSLATE_SUBTITLES_FAILS="Translate Subtitles Fails",e.TTS_ENDPOINT_CALLED="TTS Endpoint Called",e.TTS_VIDEO_GENERATOR_FAILED="TTS Video Generator Failed",e.UPDATED_PAYMENT_DETAILS="Updated Payment Details",e.UPGRADE_WORKSPACE="Upgrade Workspace",e.UPLOAD_AND_CONVERT_ONE_OFF="Upload and convert, one-off",e.UPLOAD_FAILED_IDB_ADD="Upload Failed IDB Add",e.UPLOAD_FAILS="Upload Fails",e.UPLOAD_FINISHED="Upload Finished",e.UPLOAD_SRT_ATTEMPT="Upload SRT Attempt",e.UPLOAD_SRT_ERROR="Upload SRT Error",e.UPLOAD_SRT_SUCCESS="Upload SRT Success",e.UPLOAD_STALLED="Upload Stalled",e.UPLOAD_STARTED="Upload Started",e.UPLOAD_VTT_ATTEMPT="Upload VTT Attempt",e.UPLOAD_VTT_ERROR="Upload VTT Error",e.UPLOAD_VTT_SUCCESS="Upload VTT Success",e.USED_CROP="Used Crop",e.USED_ERASE="Used Erase",e.USED_PLAYBACK_SPEED_CONTROL="Used playback speed control",e.USED_REMOVE_BACKGROUND="Used Remove Background",e.USED_TRIMMER="Used Trimmer",e.USER_UPDATE="User Update",e.VIDEOTAGLOAD="VideoTagLoad",e.VIDEO_ELEMENT_ERROR="Video Element Error",e.VIDEO_GENERATOR_FAILED="Video Generator Failed",e.VIDEO_PROCCESSED="Video Proccessed",e.VIDEO_USAGE="Video usage",e.VISIT_CHECKOUT="Visit Checkout",e.VISIT_FROM_JOIN_REQUEST_EMAIL="Visit from Join Request Email",e.VISIT_FROM_MARKETING_EMAIL="Visit From Marketing Email",e.WAVEFORM_GENERATION_FAILURE="Waveform Generation Failure",e.WORKSPACE_SEARCH="Workspace Search",e.WORKSPACE_SEARCH_CLICK="Workspace Search Click",e.WORKFLOW_JOB_STARTED="Workflow Job Started",e.WORKFLOW_JOB_RESTARTED="Workflow Job Restarted",e.WORKFLOW_JOB_SKIPPED="Workflow Job Skipped",e.WORKFLOW_JOB_FAILED="Workflow Job Failed",e.WORKFLOW_JOB_COMPLETED="Workflow Job Completed",e.WORKFLOW_RUN_ALL_COMPLETED="Workflow Run All Completed",e.ADD_BRANDKIT_MEDIA_TO_PROJECT="Add Brandkit Media to Project",e.SHOWN_BRANDKIT_PREPOPULATED_TOOLTIP="Shown Brandkit Pre-Populated Tooltip",e.ENTERPRISE_USAGE_OUT="Enterprise packaging usage out",e.ENTERPRISE_USAGE_CLOSE="Enterprise packaging limit almost out",e.ENTERPRISE_USAGE_HALF="Enterprise packaging usage half out",e.ENTERPRISE_USAGE_BLOCKED="Enterprise packaging usage blocked",e.ENTERPRISE_USAGE_UI_SHOWN="Enterprise packaging usage UI shown",e.ENTERPRISE_FORM_SUBMITTED="Enterprise form submitted",e.SHOWN_CREATE_NEW_PROJECT_TOOLTIP="Shown Create New Project Tooltip",e.BEGIN_SUGGESTED_BRANDKIT_ASSETS="Begin Suggested Brand Kit Assets",e.CONFIRMED_BRANDKIT_ASSETS="Confirmed Brand Kit Assets",e.DECLINED_BRANDKIT_ASSETS="Declined Brand Kit Assets",e.VISION_JOB_COMPLETED="Vision Job Completed",e.RUN_VISION_JOBS_FOR_ALL_LAYERS_RESULT="Run Vision Jobs for All Layers Result",e.CLICKED_SMART_REFRAME_BUTTON="Clicked Smart Reframe Button",e.VOICE_DUBBING_OPENED="Voice Dubbing Opened",e.VOICE_DUBBING_STARTED="Voice Dubbing Started",e.VOICE_DUBBING_FINISHED="Voice Dubbing Finished",e.VOICE_CLONING_CLICKED="Voice Cloning Clicked",e.VOICE_CLONING_STARTED="Voice Cloning Started",e.VOICE_CLONING_FINISHED="Voice Cloning Finished",e.REQUESTED_MOBILE_UPLOAD_LINK="Requested Mobile Upload Link",e.MOBILE_UPLOAD_PAGE_ACCESSED="Accessed Mobile Upload Page",e.UPLOADED_FROM_MOBILE="Uploaded from Mobile",e))(ym||{});function vm(e){var t;if(!e)return;return null==(t=$c(e))?void 0:t.name}const _m={"Current Plan":vm,"Purchased Plan":vm,"Usage Category":function(e){return Lc[e].name},"Teleprompter Text":(wm=200,e=>e.slice(0,wm))};var wm;function bm(e){if(!e)return"";if("string"!=typeof e)return"";try{return((e.split(/#|\?/)[0]??"").split(".").pop()??"").trim()}catch{return""}}function Tm(e){const t=bm(e);return""===t?"project":"jpg"===t||"png"===t||"jpeg"===t?"image":"gif"===t||"webp"===t?"gif":"mp3"===t?"audio":"video"}function xm(e){let t="";const{isCreator:o,origin:a}=e;t=e.isTrimmedOnly||e.isAudioTrimmedOnly?"Trimmed":e.memeTemplate||o&&"memeMaker"===a?"Meme":e.isStopMotionVideo?"Stop Motion":o&&"subtitler"===a?"Subtitled":e.isLooped?"Looped":e.isMontage?"Montage":e.isCollage||o&&"collage"===a?"Collage":e.isReversed?"Reversed":e.isImageVideo?"Converted Image":e.isTextVideo||o&&"addText"===a?"Text Added":e.isRotate?"Rotated":e.isSpeedVideo?"Speed Change":e.isConvertVideo?"Converted":e.isCreator||e.isStudio?"Studio":"Edited";const i=Tm(e.fullPath);return t+=` ${i.charAt(0).toUpperCase()}${i.slice(1)}`,t}function Sm(e){const{state:t}=sr(),{currentUser:o}=t;return e===o.user._id}function Em(e){const{state:t}=sr(),{teams:o}=t;return!!o.allTeams.find((t=>t._id===e))}const Im=e=>{var t;return null==(t=null==window?void 0:window.fbq)?void 0:t.call(window,"trackCustom",e)};function Cm(){if("undefined"==typeof window||"undefined"==typeof document)return!1;let e=null;try{e=localStorage.getItem("isTWA")}catch(IGe){console.error(IGe)}return"getDigitalGoodsService"in window&&e&&window.matchMedia("(display-mode: standalone)").matches}function km(){const{state:e}=sr(),{user:t}=e.currentUser,{email:o}=t;if(t&&o){return o.split("@").pop()}return""}const Am=e=>Pn.includes(e.value)&&void 0===(null==e?void 0:e.default)||!0===(null==e?void 0:e.default),jm=e=>"62d61954f85729d3ec1db3f4"===e,Nm=()=>{const{state:e}=sr(),{activeBrandkit:t}=e.teams;return!!t&&!!t.isPrepopulated};var Rm=(e=>(e.GetStarted="Get Started",e.Sample="Sample",e.NewContentWorkspace="New Content (Workspace)",e.EditThisTemplate="Edit this Template",e.PasteALink="Paste a Link",e.UploadFiles="Upload File(s)",e.OnboardingModal="Onboarding Modal",e.RequestToEditEmail="Request to Edit Email",e))(Rm||{});const Pm={},Dm={videoId:"",events:{}};Fu();let Om=!1;if("undefined"!=typeof window){const e=document.domain||"",t=e.startsWith("localhost");Om=e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||t&&["3000","4000","5000"].includes(window.location.port)||e.startsWith("192.")||e.startsWith("10.0.")||e.startsWith("10.1.")}let Lm=[];"undefined"!=typeof window&&(window.onload=()=>{Fu()},window.addEventListener("online",(()=>{const e=[...Lm];Lm=[],e.forEach((e=>{e.userId&&amplitude.getInstance().setUserId(e.userId),amplitude.getInstance().logEvent(e.eventName,{...e.eventProperties,"Event Sent While Offline":!0,"Offline Event Time":e.dateTime},(()=>{}),(()=>{navigator.onLine?console.error(`Error submitting event ${e.eventName}: `,e.eventProperties):Lm.push(e)}))}))})));const Fm=(e,t,o={})=>{var a,i;try{const{state:s}=sr(),n=null==(i=null==(a=s.currentUser)?void 0:a.user)?void 0:i._id;(o.overrideUserId||n)&&amplitude.getInstance().setUserId(o.overrideUserId||n);const r=((e={})=>{var t,o;const{state:a}=sr(),{currentVideo:i,studio:s,teams:n}=a||{};if(amplitude.getInstance().setUserProperties({"Workspace Count":n.allTeams.length}),!e["Video ID"]){const{_id:t}=i||{},{_id:o}=s||{},a=o||t;a&&(e["Video ID"]=a)}const r=au();if(e["Current Plan"]=r.type,!e["Team ID"]){const a=Hu();a&&(e["Team ID"]=a._id,e["Number of Workspace Members"]=(null==(t=a.teamUserDTOs)?void 0:t.length)??(null==(o=a.users)?void 0:o.length))}const l=Pr(),d=Om?l:"v2023.12.22.1";return e["App Version"]=d,e["Canary Server"]=!1,e["App Type"]=Cm()?"Android":"Web",e.hostname=window.location.hostname,{...e,...Vm()}})(t),l=r["Video ID"];if(l){Dm.videoId!==l&&(Dm.videoId=l,Dm.events={});const t=Pm[e];if(t){const o=Dm.events[e]??0;if(o>=t)return;Dm.events[e]=o+1}}amplitude.getInstance().logEvent(e,(e=>{const t={};for(const o in e){const a=_m[o];t[o]=a?a(e[o]):e[o]}return t})(r),(()=>o.onSuccess?o.onSuccess():null),(()=>{navigator.onLine?console.error(`Error submitting event ${e}: `,t):Lm.push({eventName:e,eventProperties:t||{},dateTime:new Date,userId:n})})),hu(e)}catch(IGe){console.error(`Error submitting event ${e}: `,t)}};function Mm(){const{state:e,dispatch:t}=sr();(e.projectSessionSettings.splitsLogged||0)<100&&(Fm(ym.SPLIT_VIDEO_LAYER),t(Zd()))}function Um(e,t){const{state:o,dispatch:a}=sr();(o.projectSessionSettings.addLayerLogged||0)<50&&"video"===e&&(Fm(ym.ADD_VIDEO_LAYER_TO_PROJECT,{place:t}),a(Qd()))}function Bm(e){var t;const{state:o,dispatch:a}=sr();((null==(t=o.projectSessionSettings.trimsLogged)?void 0:t[e])||0)<2&&(a(ec(e)),Fm(ym.USED_TRIMMER,{location:e}))}function Vm(){return{...Uu(),maxExportDurationNonPro:240}}function Wm(e,t,o,a=!1){let i={Email:e.email,"Entry Point":o};a&&(i={...i,"Google One-Tap":!0}),amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email,Domain:km()}),t?(amplitude.getInstance().logEvent("Create Account",i),Im("Create Account"),bl("Create Account")):amplitude.getInstance().logEvent("Log In",i)}function Gm({interval:e,planTier:t,upgradeSource:o,teamId:a,quantity:i,extraAmplitudeEventProperties:s,couponId:n=null}){const r=$m(o),l=jc(t);Fm(ym.UPGRADE_WORKSPACE,{"Monthly/Annual":Qu({interval:e}),"License Tier Purchased":l,"Upgrade Source":r,"Team ID":a,"Number of Workspace Members":i,"Brand Kit Pre-Populated":Nm(),Coupon:n,...s});const d={"Account Type":l};n&&(d.Coupon=n),amplitude.getInstance().setUserProperties(d),Im("Upgraded")}function Hm(e,t){const o={"Layer Type":t,"Start or End Input":e};Fm(ym.TIMING_TAB_EXACT_TIME_SET,o)}const $m=e=>{var t;return e&&(null==(t=Vc[e].metadata)?void 0:t.prettyUpgradeSource)||e};function Km(e,t,o){const{analytics:a,magicSubtitles:i,scenes:s}=t;if(a&&(a.usedSplit&&(e["Used Split"]=!0),e["Number of Video Splits"]=xu(o.studio),a.usedCollaboration&&(e["User Collaboration"]=!0),a.usedCollaborationWithOtherUser&&(e["User Collaboration With Other User"]=!0),a.usedSmartCut&&(e["Used Smart Cut"]=!0),a.usedSceneSplit&&(e["Used Scene Split"]=!0),a.usedCanvasResize&&(e["Used Canvas Resize"]=!0),a.usedGroupDrag&&(e["Used Group Drag"]=!0),a.usedGroupTrim&&(e["Used Group Trim"]=!0)),s){let t=0;const a=new Set;for(const i of s)for(const s of i.layers){const i=Tu(s,o.mediaCache);s.type===zl.Video&&i&&a.add(i),s.type===zl.Text&&(e["Has Text"]=!0,t+=1)}e["Number of Video Input Files"]=a.size,e["Number of Text Layers"]=t,(e=>{var t;for(const o of e)for(const e of o.layers)if(null==(t=e.usedProFeatures)?void 0:t.includes("text-to-speech"))return!0;return!1})(s)&&(e["Used Text to Speech"]=!0)}i&&Object.values(i).some((e=>null==e?void 0:e.enabled))&&(e["Has Magic Subtitles"]=!0),t.duration&&(e.Duration=t.duration)}function zm(e=window.location.pathname){var t,o;const{state:{currentUser:a,mediaCache:i,studioLocal:{initialIDBAssetIdLoadDone:s,isProjectFetched:n,idbAssetIds:r,isNewProject:l},studio:d}}=sr(),{creatorEmail:c,scenes:u}=d;if(!(s&&n||l))return;const m=new Set(r);let p=0,h=!1;for(const T of u)for(const e of T.layers){const t=Tu(e,i);sm(e)&&t&&!m.has(t)&&(p+=1,e.type===zl.Video&&(h=!0))}let g=d.origin;const f=e.includes("/sharing");f&&(g="Project Share");const{history:y}=sr(),v=(null==(t=y.location.state)?void 0:t.from)===Vn;v&&(g="Shared with Me");let _=!1;const w=null==(o=a.user)?void 0:o.email;wc(a)&&(_=$s(w,c));const b={"Video ID":d._id,"N Remote Layers":p,"Has Remote Video":h,"Project Owner Email":c,Origin:g,"Owner And Collaborator Domain Match":_,"Project Collaborator Email":w||"Anonymous","Is Team Member":Em(d.teamId??""),"Is Project Owner":Sm(d.creatorId??"")};(p>0||f||v)&&Fm(ym.REMOTE_REEDIT_STARTED,b)}const Ym=new Map;function Jm({accountType:e}){switch(e){case Mn.student:return"Student";case Mn.teacher:return"Teacher"}switch(e){case Mn.admin:return"Admin";case Mn.free:return"Free"}return null}function qm(e,t){Fm(ym.ADD_TRANSITION,{"Add Transition Method":e,"Transition Name":t})}const Xm=[];function Qm(e,t){const o=()=>Fm(e,t);return Xm.push(o),()=>{const e=Xm.indexOf(o);e>-1&&Xm.splice(e,1)}}"undefined"!=typeof window&&(window.amplitudeOnExit=()=>{for(const e of Xm)e()});const Zm=(e,t,o,a)=>{if(!a.includes("/sharing")&&!a.includes("/invites"))return;const{currentFolderId:i,currentVideoId:s,creatorEmail:n,workspaceOwnerEmail:r,teamId:l,teamOwnerEmail:d}={currentFolderId:(c=sr().state).workspaces.sharedWorkspaceId,currentVideoId:c.studio._id,creatorEmail:c.studio.creatorEmail,workspaceOwnerEmail:c.workspaces.workspaceOwnerEmail,teamId:c.teams.sharedTeamId,teamOwnerEmail:c.teams.sharedTeamOwnerEmail};var c;const u=null==a?void 0:a.includes("/studio/editor"),m=null==a?void 0:a.includes("team");let p,h,g,f,y;u?(p="Studio Project",h="Video ID",g=s,f="Project Owner Email",y=n):m?(p="Team",h="Team ID",g=l,f="Team Owner Email",y=d):(p="Folder",h="Folder ID",g=i,f="Folder Owner Email",y=r);const v=$s(e.email,y),_={"Share Flow":p,"Sign In Method":o,Email:e.email,"New User":t,[h]:g,[f]:y,"Owner and Collaborator Domain Match":v};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Share Sign In Success",_)},ep=(e,t,o,a,i,s)=>{const n={"Project Owner Email":o,"Sharer Email":e.email,"Share Type":i,"Video ID":t,"Share Origin":a};void 0!==s&&(n["Is Sharing with Team Member"]=s),amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Project Share Completed",n)},tp=(e,t,o={})=>{const{includeTimestamp:a,teamId:i,creatorId:s}=o,n={"Activity type":e,"Comment location":t};a&&(n["Timestamp included"]=a),i&&(n["Is Team Member"]=Em(i)),s&&(n["Is Project Owner"]=Sm(s)),Fm(ym.NEW_COMMENT_ACTIVITY,n)},op=(e,t)=>{Fm(ym.CHANGED_TEXT_OUTLINE_COLOR,{layerType:e,color:t})},ap=e=>e/1024/1024,ip=()=>{if(!("memory"in performance))return{};const e=performance.memory;return{"Heap Size Limit":ap(e.jsHeapSizeLimit),"Total Heap Size":ap(e.totalJSHeapSize),"Used Heap Size":ap(e.usedJSHeapSize)}};function sp(e,t,o=null){var a;const i=31536e3;return(new d).set("ssrSignedInCookie",t,{path:"/",expires:new Date(Date.now()+31536e6),maxAge:i,secure:!0}),e.email&&(null==(a=window.profitwell)||a.call(window,"user_email",e.email)),function(e){const t=Jm(e),o=Ym.get(e._id);t&&t!==o&&(amplitude.getInstance().setUserProperties({"Account Type":t}),Ym.set(e._id,t))}(e),{type:"RECEIVE_USER_AND_SET_TOKEN",user:e,token:t,receivedAt:Date.now(),impersonatingAdminEmail:o}}async function np(){const{dispatch:e,state:t}=sr(),{user:o,token:a,impersonatingAdminEmail:i}=t.currentUser||{},{_id:s}=o||{};if(!s||!a){return void(new d).remove("ssrSignedInCookie",{path:"/"})}const n={userId:s,token:a},r=await Jr("/api/v1/users/getProfile",{body:n});e(sp(r.user,r.token,i))}function rp(e){return{type:"SET_USER",user:e}}function lp(){const{state:e}=sr(),{token:t,user:o}=e.currentUser||{};if(!o)return null;const{_id:a}=o;return t?qr("/api/v1/users/lastOptimizedProjectTime",{body:{token:t,userId:a},parseJSON:!1}).then((()=>{np()})):Promise.resolve()}async function dp(e,t,o){const{state:a,dispatch:i}=sr(),{token:s,user:n}=a.currentUser||{},{_id:r}=n||{};try{const a=await $r("api/v1/settingsUpdate",{body:{token:s,userId:r,notifType:e,on:t,location:o}});a.success?i(function(e,t,o){return{type:"UPDATE_USER_NOTIF_SETTING",on:e,notifType:t,location:o}}(t,e,o)):(console.error("Error update user settings:",a.messsage),i(wl({description:"There was an error with updating your notification settings.",type:"error"})))}catch(l){console.error("Error update user settings:",l),i(wl({description:"There was an error with updating your notification settings.",type:"error"}))}}function cp(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};return o(rp({...a,onboarding:e})),a._id?Jr("/api/v1/users/updateProfile/onboarding",{body:{onboarding:e},parseJSON:!1}).then((()=>{np()})):(o(ul(e)),new Promise((()=>{})))}function up(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};o(rp({...a,resizeCanvasShortcuts:e})),a._id&&Jr("/api/v1/users/updateProfile/resizeCanvasShortcuts",{body:{resizeCanvasShortcuts:e},parseJSON:!1}).catch((e=>console.error(e)))}function mp(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};o(rp({...a,royaltyFreePreference:e})),a._id&&Jr("/api/v1/users/updateProfile/royaltyFreePreference",{body:{royaltyFreePreference:e},parseJSON:!1}).catch((e=>console.error(e)))}async function pp(e){return Jr("/api/v1/users/updateProfile/upsells",{body:{upsells:e},parseJSON:!1})}async function hp(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};if(o(rp({...a,tooltipActivity:e})),a._id)return Jr("/api/v1/users/updateProfile/tooltipActivity",{body:{tooltipActivity:e},parseJSON:!1}).then((()=>{np()}))}function gp(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};o(rp({...a,shownPopups:{...a.shownPopups,[e]:!0}})),a._id&&Jr("/api/v1/users/updateProfile/shownPopup",{body:{shownPopup:e},parseJSON:!1}).catch((e=>console.error(e)))}function fp(e){return{type:"SET_COLLABORATING",isCollaborating:e}}function yp(e,t){return{type:"INIT_PRESENCE",presenceInfo:e,userId:t}}function vp(e,t){return{type:"UPDATE_PRESENCE",presenceInfo:e,userId:t}}function _p(e){return{type:"SET_PRESENT_USER",userId:e}}async function wp(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};o(rp({...a,transcriptionPreferences:e})),await Jr("/api/v1/users/updateProfile/transcriptionPreferences",{body:{transcriptionPreferences:e},parseJSON:!1})}var bp=(e=>(e.UPDATE_ANALYTICS="UPDATE_ANALYTICS",e.ADD_CONTEXT_MENU_ANALYTICS="ADD_CONTEXT_MENU_ANALYTICS",e))(bp||{});function Tp(e){return{type:"UPDATE_ANALYTICS",updates:e}}async function xp(e){return await Yr(`/api/v1/ai/clone-voice-elevenlabs/${e}`)}async function Sp(e,t){const{id:o}=await async function(e,t){return await Jr(`/api/v1/ai/clone-voice-elevenlabs/${t}`,{headers:{"Content-Type":"multipart/form-data",enctype:"multipart/form-data"},body:e})}(e,t),a=e=>new Promise((t=>setTimeout(t,e)));let i=!1;for(;!i;){const{error:e,result:t}=await xp(o);if(e)throw new Error(e);if(t&&"pending"!==t)return i=!0,{voiceId:t};await a(1e3)}}async function Ep(e){await zr("/api/v1/ai/clone-voice-elevenlabs/delete",{body:{voiceId:e}})}function Ip(e){return{type:"SET_CURRENT_TEAM",_id:e}}function Cp(e){return{type:"SET_IS_FETCHING_TEAMS",isFetching:e}}function kp(e){return{type:"SET_TEAMS",teams:e}}function Ap(e){return{type:"SET_USER_TEAM_INVITES",invites:e}}function jp(e,t){return{type:"UPDATE_TEAM",id:e,updateDict:t}}function Np(e,t){return{type:"UPDATE_TEAM_NAME",id:e,name:t}}function Rp(e){return{type:"SET_ACTIVE_BRANDKIT",update:e}}function Pp(e){return{type:"SET_BRANDKIT_TEMPLATES",templates:e}}async function Dp(){var e;const{state:t,dispatch:o}=sr(),{teams:a,currentUser:i}=t,{selectedTeamId:s}=a;if(!s)return;const n=await Fp(s,i,0===((null==(e=a.brandkitTemplates)?void 0:e.length)||0));let{brandkit:r}=n;r={isPrepopulated:!1,...r},o(Rp(r));const{brandkitTemplates:l}=n;l&&o(Pp(l))}async function Op(){var e;const{dispatch:t,state:o}=sr(),{teams:{selectedTeamId:a},currentUser:i}=o,{token:s,user:n}=i||{},{_id:r}=n||{},l={token:s,userId:r};try{const o=await Yr("/api/v2/teams/user",{params:l});return a||t(Ip((null==(e=o[0])?void 0:e._id)||"")),t(kp(o)),o}catch(IGe){return[]}}async function Lp(){const{state:e,dispatch:t}=sr(),{teams:o}=e,{selectedTeamId:a}=o,i=await Yr(`/api/v2/teams/${a}`);t(jp(i._id,i))}function Fp(e,t,o){const{token:a,user:i}=t||{},{_id:s}=i||{};return Yr(`/api/v2/teams/${e}`,{params:{token:a,userId:s,teamId:e,fetchBrandkitTemplates:o}})}function Mp(e,t){const{token:o,user:a}=sr().state.currentUser||{},{_id:i}=a||{};return Jr(`/api/v1/teams/${e}`,{body:{token:o,userId:i,teamId:e,updateDict:t},parseJSON:!1})}function Up(e,t,o){const{token:a,user:i}=o||{},{_id:s}=i||{};return Jr(`/api/v2/teams/${e}/removeUser`,{body:{token:a,userId:s,teamId:e,userIdToRemove:t},parseJSON:!1})}async function Bp(e){await Jr(`/api/v2/teams/${e}/leave`),np()}async function Vp(e){var t;const{dispatch:o,state:a}=sr(),{token:i,user:s}=a.currentUser||{},{allTeams:n,activeBrandkit:r}=a.teams,{_id:l}=s||{};(null==r?void 0:r.clonedVoices)&&(null==r||r.clonedVoices.forEach((async e=>{await Ep(e.voiceId)}))),await zr("/api/v1/teams/delete",{body:{token:i,userId:l,teamId:e},parseJSON:!1}),o(kp([...n.filter((t=>t._id!==e))])),o(Ip((null==(t=n[0])?void 0:t._id)||""))}async function Wp(e,t,o){const{state:a}=sr(),{currentUser:i}=a,{token:s,user:n}=i,{_id:r}=n||{};await Jr(`/api/v1/teams/${e}/updateUser`,{body:{token:s,userId:r,updateUserId:t,teamId:e,updateDict:o},parseJSON:!1})}async function Gp(e,t){const{state:o}=sr(),{currentUser:a}=o,{token:i,user:s}=a||{},n={privacy:t,token:i,userId:s&&s._id};await qr(`/api/v2/teams/${e}/privacy`,{body:n}),Lp()}async function Hp(e,t){const{state:o}=sr(),{currentUser:a}=o,{token:i,user:s}=a||{},n={discoverability:t,token:i,userId:s&&s._id},r=await qr(`/api/v2/teams/${e}/discoverability`,{body:n});return Lp(),r}function $p(){const{state:e,dispatch:t}=sr();e.teams.allTeams.map((async e=>{try{const{limits:o}=e,{lastReset:a,lastUpdatedTranscribe:i,lastUpdatedCumulativeDuration:s}=o;if(new Date(a||i||s).getUTCMonth()===(new Date).getUTCMonth())return;const n=await Jr(`/api/v2/teams/${e._id}/limits/reset`);t(jp(e._id,{...e,limits:n}))}catch(IGe){}}))}function Kp(e){if(!e)throw Error("currentUser not set.");return!!e.impersonatingAdminEmail}function zp(){return{type:"MOCK_SIGN_IN"}}function Yp(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function Jp(){const{state:e}=sr(),{presence:t}=e.studio,o=[];t&&Object.entries(t).forEach((([e,t])=>{e&&o.push(t.color)}));const a=un.filter((e=>!o.includes(e))),i=a[Math.floor(Math.random()*a.length)];if(!i)throw Error();return i}const qp=["Abyssinian","Balinese","Bengal","Bobtail","Calico","Maine Coon","Manx","Mau","Munchkin","Persian","Peterbald","Ragdoll","Russian Blue","Scottish Fold","Shorthair","Siamese","Sphynx","Tabby"],Xp=["https://cdn-useast1.kapwing.com/samples/kat_blue.jpeg","https://cdn-useast1.kapwing.com/samples/kat_blue_gradient.jpeg","https://cdn-useast1.kapwing.com/samples/kat_brown.jpeg","https://cdn-useast1.kapwing.com/samples/kat_purple.jpeg","https://cdn-useast1.kapwing.com/samples/kat_purple_gradient.jpeg","https://cdn-useast1.kapwing.com/samples/kat_yellow.jpeg"];function Qp(e,t){if(!e._id){const e=qp[Math.floor(Math.random()*qp.length)];return{color:Jp(),heartbeat:Date.now(),name:`Anonymous ${e}`,profileImg:Xp[Math.floor(Math.random()*Xp.length)],selectedLayerId:t}}const{name:o,picture:a}=e;return{color:Jp(),heartbeat:Date.now(),name:o,profileImg:a??void 0,selectedLayerId:t}}function Zp(e,t){if(!e||!t)return;const o=Object.entries(e).find((([e,o])=>{if(o&&o.selectedLayerId===t&&eh(o.heartbeat))return e}));return o?o[0]:void 0}function eh(e){return function(e,t){const o=new Date(e),a=new Date(t);return(o.getTime()-a.getTime())/1e3}(Date.now(),e)<60}function th(e,t,o){if(!e)return;let a=!1;Object.entries(e).forEach((([e,i])=>{if(e===t)return;const s=eh(i.heartbeat);s&&(a=!0),s||o({type:"REMOVE_PRESENCE",presenceInfo:i,userId:e})})),a?sr().state.studio.analytics.usedCollaborationWithOtherUser||o(Tp({usedCollaborationWithOtherUser:!0})):o(fp(!1))}const oh=e=>{var t,o;return!(!(null==(t=e.statusText)?void 0:t.toLowerCase().includes("Captcha check error.".toLocaleLowerCase()))&&!(null==(o=e.message)?void 0:o.toLocaleLowerCase().includes("Captcha check error.".toLocaleLowerCase())))};async function ah(){const{state:e,dispatch:t}=sr(),{currentUser:o,teams:a}=e,{allTeams:i}=a;if(!wc(o))return[];const{token:s,user:n,email:r}=o||{},{_id:l}=n||{},d={token:s,userId:l,email:r};try{const e=(await Yr("/api/v1/users/team-invites",{params:d})).filter((e=>!i.some((t=>e.team._id===t._id))));return t(Ap(e)),e}catch(IGe){return[]}}const ih=async(e,t)=>{await qr("/api/v1/users/countedPopups",{body:{[e]:t}}),await np()};[...qp].map((e=>e.replace(" ","")));Object.assign(window,{anonymousObjects:{}});const sh=new class{constructor(){if(i(this,"storageEvictionAttempts",0),i(this,"supported"),i(this,"evictOldVideoUsageKeys",s.throttle((()=>{const e=Date.now();try{for(let t=0;t<localStorage.length;t++){const o=localStorage.key(t);if(o.startsWith("video_usage_")){const t=this.get(o,{disabled:null});t&&e-t.lastUpdated>432e6&&this.remove(o)}}}catch{}}),216e5,{leading:!0,trailing:!1})),"undefined"==typeof window)return void(this.supported=!1);let e;try{e=typeof localStorage}catch(t){console.error(t)}this.supported=!!e}get(e,t){if(!this.supported)return t.disabled||null;const o=localStorage.getItem(e);if(null===o)return null;try{return JSON.parse(o)}catch(a){return null}}set(e,t){if(!this.supported)return;const o=JSON.stringify(t);try{return void localStorage.setItem(e,o)}catch(a){console.error("localStorage.setItem failed with: ",a,"\ntrying again...")}this.evictOldSessionsFromStorage(),this.evictOldVideoUsageKeys();try{localStorage.setItem(e,o)}catch(a){console.error(`Failed to write ${e} in localstorage`,a)}}getAndUnset(e){const t=this.get(e,{disabled:null});return this.remove(e),t}remove(e){this.supported&&localStorage.removeItem(e)}evictOldSessionsFromStorage(){this.storageEvictionAttempts+=1;const e=[];for(let t=0;t<localStorage.length;t+=1){const o=localStorage.key(t);o&&o.startsWith("session_")&&e.push(o)}(1===this.storageEvictionAttempts||Math.random()<.1)&&Fm(ym.LOCALSTORAGE_QUOTA_EXCEEDED,{"Cached Sessions":e.length,"Storage Size (MB)":this.getLocalStorageSizeMB(),"Eviction Attempts":this.storageEvictionAttempts});for(const t of e)Math.random()<.3&&localStorage.removeItem(t)}getLocalStorageSizeMB(){return new Blob(Object.values(localStorage)).size/1e3/1e3}},nh=()=>!!sh.get("devMode",{disabled:null}),rh=()=>{(()=>{if(!Ps){Ps=!0;for(const e of Ds)e();Ds.clear()}})(),sh.set("devMode",!0)},lh=()=>{sh.remove("devMode")};nh()&&rh();const dh=["arrowup","arrowup","arrowdown","arrowdown","arrowleft","arrowright","arrowleft","arrowright","b","a"],ch=e=>{let t=0;const o=a=>{dh[t]===a.key.toLowerCase()?(t+=1,dh.length===t&&(rh(),null==e||e(),document.removeEventListener("keydown",o))):t=0};document.addEventListener("keydown",o);return()=>{document.removeEventListener("keydown",o)}},uh={plugins:(e=[],t)=>{switch(t.type){case"OPEN_PLUGIN":{const o=e.map((e=>e.id));return t.pluginName&&!o.includes(t.pluginName)?[...e,{id:t.pluginName,isMediaLibraryUpload:t.isMediaLibraryUpload,idOfLayerToReplace:t.idOfLayerToReplace}]:[...e]}case"CLOSE_PLUGIN":{const o=e.map((e=>e.id));if(t.pluginName&&o.includes(t.pluginName)){const a=o.indexOf(t.pluginName);if(a>-1)return e.splice(a,1),[...e]}return[...e]}case"RESET_EDITOR":return[];default:return e}},pluginOrder:(e=[],t)=>{switch(t.type){case"OPEN_PLUGIN":return t.pluginName&&!e.includes(t.pluginName)?[...e,t.pluginName]:[...e];case"CLOSE_PLUGIN":if(t.pluginName&&e.includes(t.pluginName)){const o=e.indexOf(t.pluginName);if(o>-1)return e.splice(o,1),[...e]}return[...e];case"PLUGIN_TO_TOP":if(e.includes(t.pluginName)){const o=e.indexOf(t.pluginName);if(o>-1&&o!==e.length-1){const[t]=e.splice(o,1);return[...e,t]}}return[...e];case"RESET_EDITOR":return[];default:return e}}};function mh({description:e,error:t,sendToSentry:o}){try{const{dispatch:a}=sr(),{message:i,reportToSentry:s}=ph(t);a(wl({description:e,subDescription:i,type:"error"})),console.error(t),(!0===o||void 0===o&&s)&&R(t,{extra:{toastDescription:e},tags:{triggeredToast:!0}});let n=e;i&&(n+=`(${i})`),Fm(ym.DISPLAYED_TOAST_FOR_UNEXPECTED_ERROR,{message:n})}catch(a){console.error("error handling error: ",a)}}function ph(e,t=""){if(e instanceof Hr)return{message:e.message,reportToSentry:!1};if(e instanceof Response)try{Gr(e.url,e)}catch(a){return ph(a)}let o=t;return"string"==typeof e&&(o=e),e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message&&(o=e.message),{message:o,reportToSentry:!0}}function hh({description:e,sentryMessage:t,extra:o,tags:a}){try{const{dispatch:i}=sr();i(wl({description:e,type:"error"})),t&&f(t,{extra:o,tags:a})}catch(i){console.error("error handling error: ",i)}}var gh=(e=>(e.DELETE_ACCOUNT="DELETE_ACCOUNT",e.MOVE_PROJECT="MOVE_PROJECT",e.COPY_PROJECT="COPY_PROJECT",e.EMBED_CODE="EMBED_CODE",e.SWM_REMOVE_PROJECT="SWM REMOVE PROJECT",e.DELETE_PROJECT="DELETE_PROJECT",e.START_FROM_BRAND_TEMPLATE="START_FROM_BRAND_TEMPLATE",e.FOLDER_UPLOAD="FOLDER_UPLOAD",e.SIGN_IN="SIGN_IN",e))(gh||{});const fh=v({name:"modal",initialState:{modalProps:{}},reducers:{showModal:(e,t)=>{e.modalProps=t.payload,e.modalResult=void 0},hideModal:(e,t)=>{e.modalResult=t.payload.modalResult,e.modalProps={},e.title=void 0,e.subtitle=void 0},setModalTitle:(e,t)=>{e.title=t.payload.title,e.subtitle=t.payload.subtitle}}}),yh=fh.actions,vh=e=>{const{dispatch:t}=sr();return t({type:yh.hideModal.type,payload:{modalResult:e}})},_h=e=>{const{dispatch:t}=sr();return t(yh.showModal({modalType:e.modalType,name:e.name,teamId:e.teamId,projectIds:e.projectIds,projectId:e.projectId,modalStyle:e.modalStyle,onSubmit:async(...t)=>{if(e.onSubmit)try{await e.onSubmit(...t),vh()}catch(IGe){return void mh({description:"Failed to submit",error:IGe})}vh()},onCancel:()=>{e.onCancel&&e.onCancel(),vh()},immediateRedirectPathname:e.immediateRedirectPathname}))},wh=v({name:"explorer",initialState:{teams:[],folders:[]},reducers:{setTeams:(e,t)=>{e.teams=t.payload.teams,t.payload.folders.find((e=>e.sharedAt))&&(e.teams=t.payload.teams.concat({_id:Vn,name:"Shared with Me"})),e.folders=t.payload.folders.map((e=>e.sharedAt?{...e,teamId:Vn}:e))}}}),bh=async(e=!1)=>{const{state:t,dispatch:o}=sr(),{explorer:a,currentUser:i}=t;if(!wc(i)||a.teams.length&&!e)return;const s=await Yr("/api/v1/explorer");o({type:wh.actions.setTeams.type,payload:s})},Th=e=>{const t=bc();h.useEffect((()=>{bh(e)}),[e,t]);return{refetchExplorer:h.useCallback((()=>{bh(!0)}),[])}},xh=()=>tl((e=>e.explorer)).folders.length>1,Sh=["ABeeZee","Abel","Abhaya Libre","Abril Fatface","Aclonica","Acme","Actor","Adamina","Advent Pro","Aguafina Script","Akronim","Aladin","Alata","Alatsi","Aldrich","Alef","Alegreya","Alegreya SC","Alegreya Sans","Alegreya Sans SC","Aleo","Alex Brush","Alfa Slab One","Alice","Alike","Alike Angular","Allan","Allerta","Allerta Stencil","Allura","Almarai","Almendra","Almendra Display","Almendra SC","Amarante","Amaranth","Amatic SC","Amethysta","Amiko","Amiri","Amita","Anaheim","Andada","Andika","Angkor","Annie Use Your Telescope","Anonymous Pro","Antic","Antic Didone","Antic Slab","Anton","Arapey","Arbutus","Arbutus Slab","Architects Daughter","Archivo","Archivo Black","Archivo Narrow","Aref Ruqaa","Arima Madurai","Arimo","Arizonia","Armata","Arsenal","Artifika","Arvo","Arya","Asap","Asap Condensed","Asar","Asset","Assistant","Astloch","Asul","Athiti","Atma","Atomic Age","Aubrey","Audiowide","Autour One","Average","Average Sans","Averia Gruesa Libre","Averia Libre","Averia Sans Libre","Averia Serif Libre","B612","B612 Mono","Bad Script","Bahiana","Bahianita","Bai Jamjuree","Baloo 2","Baloo Bhai 2","Baloo Bhaina 2","Baloo Chettan 2","Baloo Da 2","Baloo Paaji 2","Baloo Tamma 2","Baloo Tammudu 2","Baloo Thambi 2","Balsamiq Sans","Balthazar","Bangers","Barlow","Barlow Condensed","Barlow Semi Condensed","Barriecito","Barrio","Basic","Baskervville","Battambang","Baumans","Bayon","Be Vietnam","Bebas Neue","Belgrano","Bellefair","Belleza","Bellota","Bellota Text","BenchNine","Bentham","Berkshire Swash","Beth Ellen","Bevan","Big Shoulders Display","Big Shoulders Text","Bigelow Rules","Bigshot One","Bilbo","Bilbo Swash Caps","BioRhyme","BioRhyme Expanded","Biryani","Bitter","Black And White Picture","Black Han Sans","Black Ops One","Blinker","Bokor","Bonbon","Boogaloo","Bowlby One","Bowlby One SC","Brawler","Bree Serif","Bubblegum Sans","Bubbler One","Buda","Buenard","Bungee","Bungee Hairline","Bungee Inline","Bungee Outline","Bungee Shade","Butcherman","Butterfly Kids","Cabin","Cabin Condensed","Cabin Sketch","Caesar Dressing","Cagliostro","Cairo","Caladea","Calistoga","Calligraffitti","Cambay","Cambo","Candal","Cantarell","Cantata One","Cantora One","Capriola","Cardo","Carme","Carrois Gothic","Carrois Gothic SC","Carter One","Catamaran","Caudex","Caveat","Caveat Brush","Cedarville Cursive","Ceviche One","Chakra Petch","Changa","Changa One","Chango","Charm","Charmonman","Chathura","Chau Philomene One","Chela One","Chelsea Market","Chenla","Cherry Cream Soda","Cherry Swash","Chewy","Chicle","Chilanka","Chivo","Chonburi","Cinzel","Cinzel Decorative","Clicker Script","Coda","Coda Caption","Codystar","Coiny","Combo","Comfortaa","Comic Neue","Coming Soon","Concert One","Condiment","Content","Contrail One","Convergence","Cookie","Copse","Corben","Cormorant","Cormorant Garamond","Cormorant Infant","Cormorant SC","Cormorant Unicase","Cormorant Upright","Courgette","Courier Prime","Cousine","Coustard","Covered By Your Grace","Crafty Girls","Creepster","Crete Round","Crimson Pro","Crimson Text","Croissant One","Crushed","Cuprum","Cute Font","Cutive","Cutive Mono","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Damion","Dancing Script","Dangrek","Darker Grotesque","David Libre","Dawning of a New Day","Days One","Dekko","Delius","Delius Swash Caps","Delius Unicase","Della Respira","Denk One","Devonshire","Dhurjati","Didact Gothic","Diplomata","Diplomata SC","Do Hyeon","Dokdo","Domine","Donegal One","Doppio One","Dorsa","Dosis","Dr Sugiyama","Duru Sans","Dynalight","EB Garamond","Eagle Lake","East Sea Dokdo","Eater","Economica","Eczar","El Messiri","Electrolize","Elsie","Elsie Swash Caps","Emblema One","Emilys Candy","Encode Sans","Encode Sans Condensed","Encode Sans Expanded","Encode Sans Semi Condensed","Encode Sans Semi Expanded","Engagement","Englebert","Enriqueta","Epilogue","Erica One","Esteban","Euphoria Script","Ewert","Exo","Exo 2","Expletus Sans","Fahkwang","Fanwood Text","Farro","Farsan","Fascinate","Fascinate Inline","Faster One","Fasthand","Fauna One","Faustina","Federant","Federo","Felipa","Fenix","Finger Paint","Fira Code","Fira Mono","Fira Sans","Fira Sans Condensed","Fira Sans Extra Condensed","Fjalla One","Fjord One","Flamenco","Flavors","Fondamento","Fontdiner Swanky","Forum","Francois One","Frank Ruhl Libre","Freckle Face","Fredericka the Great","Fredoka One","Freehand","Fresca","Frijole","Fruktur","Fugaz One","GFS Didot","GFS Neohellenic","Gabriela","Gaegu","Gafata","Galada","Galdeano","Galindo","Gamja Flower","Gayathri","Gelasio","Gentium Basic","Gentium Book Basic","Geo","Geostar","Geostar Fill","Germania One","Gidugu","Gilda Display","Girassol","Give You Glory","Glass Antiqua","Glegoo","Gloria Hallelujah","Goblin One","Gochi Hand","Gorditas","Gothic A1","Gotu","Goudy Bookletter 1911","Graduate","Grand Hotel","Grandstander","Gravitas One","Great Vibes","Grenze","Grenze Gotisch","Griffy","Gruppo","Gudea","Gugi","Gupter","Gurajada","Habibi","Halant","Hammersmith One","Hanalei","Hanalei Fill","Handlee","Hanuman","Happy Monkey","Harmattan","Headland One","Heebo","Henny Penny","Hepta Slab","Herr Von Muellerhoff","Hi Melody","Hind","Hind Guntur","Hind Madurai","Hind Siliguri","Hind Vadodara","Holtwood One SC","Homemade Apple","Homenaje","IBM Plex Mono","IBM Plex Sans","IBM Plex Sans Condensed","IBM Plex Serif","IM Fell DW Pica","IM Fell DW Pica SC","IM Fell Double Pica","IM Fell Double Pica SC","IM Fell English","IM Fell English SC","IM Fell French Canon","IM Fell French Canon SC","IM Fell Great Primer","IM Fell Great Primer SC","Ibarra Real Nova","Iceberg","Iceland","Imprima","Inconsolata","Inder","Indie Flower","Inika","Inknut Antiqua","Inria Sans","Inria Serif","Inter","Irish Grover","Istok Web","Italiana","Italianno","Itim","Jacques Francois","Jacques Francois Shadow","Jaldi","Jim Nightshade","Jockey One","Jolly Lodger","Jomhuria","Jomolhari","Josefin Sans","Josefin Slab","Jost","Joti One","Jua","Judson","Julee","Julius Sans One","Junge","Jura","Just Another Hand","Just Me Again Down Here","K2D","Kadwa","Kalam","Kameron","Kanit","Kantumruy","Karla","Karma","Katibeh","Kaushan Script","Kavivanar","Kavoon","Kdam Thmor","Keania One","Kelly Slab","Kenia","Khand","Khmer","Khula","Kirang Haerang","Kite One","Knewave","KoHo","Kodchasan","Kosugi","Kosugi Maru","Kotta One","Koulen","Kranky","Kreon","Kristi","Krona One","Krub","Kufam","Kulim Park","Kumar One","Kumar One Outline","Kumbh Sans","Kurale","La Belle Aurore","Lacquer","Laila","Lakki Reddy","Lalezar","Lancelot","Lateef","Lato","League Script","Leckerli One","Ledger","Lekton","Lemon","Lemonada","Lexend Deca","Lexend Exa","Lexend Giga","Lexend Mega","Lexend Peta","Lexend Tera","Lexend Zetta","Libre Barcode 128","Libre Barcode 128 Text","Libre Barcode 39","Libre Barcode 39 Extended","Libre Barcode 39 Extended Text","Libre Barcode 39 Text","Libre Baskerville","Libre Caslon Display","Libre Caslon Text","Libre Franklin","Life Savers","Lilita One","Lily Script One","Limelight","Linden Hill","Literata","Liu Jian Mao Cao","Livvic","Lobster","Lobster Two","Londrina Outline","Londrina Shadow","Londrina Sketch","Londrina Solid","Long Cang","Lora","Love Ya Like A Sister","Loved by the King","Lovers Quarrel","Luckiest Guy","Lusitana","Lustria","M PLUS 1p","M PLUS Rounded 1c","Ma Shan Zheng","Macondo","Macondo Swash Caps","Mada","Magra","Maiden Orange","Maitree","Major Mono Display","Mako","Mali","Mallanna","Mandali","Manjari","Manrope","Mansalva","Manuale","Marcellus","Marcellus SC","Marck Script","Margarine","Markazi Text","Marko One","Marmelad","Martel","Martel Sans","Marvel","Mate","Mate SC","Maven Pro","McLaren","Meddon","MedievalSharp","Medula One","Meera Inimai","Megrim","Meie Script","Merienda","Merienda One","Merriweather","Merriweather Sans","Metal","Metal Mania","Metamorphous","Metrophobic","Michroma","Milonga","Miltonian","Miltonian Tattoo","Mina","Miniver","Miriam Libre","Mirza","Miss Fajardose","Mitr","Modak","Modern Antiqua","Mogra","Molengo","Molle","Monda","Monofett","Monoton","Monsieur La Doulaise","Montaga","Montez","Montserrat","Montserrat Alternates","Montserrat Subrayada","Moul","Moulpali","Mountains of Christmas","Mouse Memoirs","Mr Bedfort","Mr Dafoe","Mr De Haviland","Mrs Saint Delafield","Mrs Sheppards","Mukta","Mukta Mahee","Mukta Malar","Mukta Vaani","Mulish","MuseoModerno","Mystery Quest","NTR","Nanum Brush Script","Nanum Gothic","Nanum Gothic Coding","Nanum Myeongjo","Nanum Pen Script","Neucha","Neuton","New Rocker","News Cycle","Niconne","Niramit","Nixie One","Nobile","Nokora","Norican","Nosifer","Notable","Nothing You Could Do","Noticia Text","Noto Sans","Noto Sans HK","Noto Sans JP","Noto Sans KR","Noto Sans SC","Noto Sans TC","Noto Serif","Noto Serif JP","Noto Serif KR","Noto Serif SC","Noto Serif TC","Nova Cut","Nova Flat","Nova Mono","Nova Oval","Nova Round","Nova Script","Nova Slim","Nova Square","Numans","Nunito","Nunito Sans","Odibee Sans","Odor Mean Chey","Offside","Old Standard TT","Oldenburg","Oleo Script","Oleo Script Swash Caps","Open Sans","Open Sans Condensed","Oranienbaum","Orbitron","Oregano","Orienta","Original Surfer","Oswald","Over the Rainbow","Overlock","Overlock SC","Overpass","Overpass Mono","Ovo","Oxanium","Oxygen","Oxygen Mono","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Pacifico","Padauk","Palanquin","Palanquin Dark","Pangolin","Paprika","Parisienne","Passero One","Passion One","Pathway Gothic One","Patrick Hand","Patrick Hand SC","Pattaya","Patua One","Pavanam","Paytone One","Peddana","Peralta","Permanent Marker","Petit Formal Script","Petrona","Philosopher","Piazzolla","Piedra","Pinyon Script","Pirata One","Plaster","Play","Playball","Playfair Display","Playfair Display SC","Podkova","Poiret One","Poller One","Poly","Pompiere","Pontano Sans","Poor Story","Poppins","Port Lligat Sans","Port Lligat Slab","Pragati Narrow","Prata","Preahvihear","Press Start 2P","Pridi","Princess Sofia","Prociono","Prompt","Prosto One","Proza Libre","Public Sans","Puritan","Purple Purse","Quando","Quantico","Quattrocento","Quattrocento Sans","Questrial","Quicksand","Quintessential","Qwigley","Racing Sans One","Radley","Rajdhani","Rakkas","Raleway","Raleway Dots","Ramabhadra","Ramaraja","Rambla","Rammetto One","Ranchers","Rancho","Ranga","Rasa","Rationale","Ravi Prakash","Recursive","Red Hat Display","Red Hat Text","Red Rose","Redressed","Reem Kufi","Reenie Beanie","Revalia","Rhodium Libre","Ribeye","Ribeye Marrow","Righteous","Risque","Roboto","Roboto Condensed","Roboto Mono","Roboto Slab","Rochester","Rock Salt","Rokkitt","Romanesco","Ropa Sans","Rosario","Rosarivo","Rouge Script","Rowdies","Rozha One","Rubik","Rubik Mono One","Ruda","Rufina","Ruge Boogie","Ruluko","Rum Raisin","Ruslan Display","Russo One","Ruthie","Rye","Sacramento","Sahitya","Sail","Saira","Saira Condensed","Saira Extra Condensed","Saira Semi Condensed","Saira Stencil One","Salsa","Sanchez","Sancreek","Sansita","Sansita Swashed","Sarabun","Sarala","Sarina","Sarpanch","Satisfy","Sawarabi Gothic","Sawarabi Mincho","Scada","Scheherazade","Schoolbell","Scope One","Seaweed Script","Secular One","Sedgwick Ave","Sedgwick Ave Display","Sen","Sevillana","Seymour One","Shadows Into Light","Shadows Into Light Two","Shanti","Share","Share Tech","Share Tech Mono","Shojumaru","Short Stack","Shrikhand","Siemreap","Sigmar One","Signika","Signika Negative","Simonetta","Single Day","Sintony","Sirin Stencil","Six Caps","Skranji","Slabo 13px","Slabo 27px","Slackey","Smokum","Smythe","Sniglet","Snippet","Snowburst One","Sofadi One","Sofia","Solway","Song Myung","Sonsie One","Sora","Sorts Mill Goudy","Source Code Pro","Source Sans Pro","Source Serif Pro","Space Mono","Spartan","Special Elite","Spectral","Spectral SC","Spicy Rice","Spinnaker","Spirax","Squada One","Sree Krushnadevaraya","Sriracha","Srisakdi","Staatliches","Stalemate","Stalinist One","Stardos Stencil","Stint Ultra Condensed","Stint Ultra Expanded","Stoke","Strait","Stylish","Sue Ellen Francisco","Suez One","Sulphur Point","Sumana","Sunflower","Sunshiney","Supermercado One","Sura","Suranna","Suravaram","Suwannaphum","Swanky and Moo Moo","Syncopate","Syne","Tajawal","Tangerine","Taprom","Tauri","Taviraj","Teko","Telex","Tenali Ramakrishna","Tenor Sans","Text Me One","Thasadith","The Girl Next Door","Tienne","Tillana","Timmana","Tinos","Titan One","Titillium Web","Tomorrow","Trade Winds","Trirong","Trocchi","Trochut","Trykker","Tulpen One","Turret Road","Ubuntu","Ubuntu Condensed","Ubuntu Mono","Ultra","Uncial Antiqua","Underdog","Unica One","UnifrakturCook","UnifrakturMaguntia","Unkempt","Unlock","Unna","VT323","Vampiro One","Varela","Varela Round","Varta","Vast Shadow","Vesper Libre","Viaoda Libre","Vibes","Vibur","Vidaloka","Viga","Voces","Volkhov","Vollkorn","Vollkorn SC","Voltaire","Waiting for the Sunrise","Wallpoet","Walter Turncoat","Warnes","Wellfleet","Wendy One","Wire One","Work Sans","Yanone Kaffeesatz","Yantramanav","Yatra One","Yellowtail","Yeon Sung","Yeseva One","Yesteryear","Yrsa","ZCOOL KuaiLe","ZCOOL QingKe HuangYou","ZCOOL XiaoWei","Zeyada","Zhi Mang Xing","Zilla Slab","Zilla Slab Highlight"],Eh=["Arial","Impact","Comic Sans MS","Bebas Neue","Georgia","Raleway","Nunito","Times New Roman","Lato","Roboto Mono","Roboto Slab","Libre Baskerville","Dancing Script","Fredoka One","Sacramento","Luckiest Guy","Orbitron","Satisfy","Permanent Marker","Playfair Display","Noto Sans","Amatic SC","Days One","Rock Salt","New Rocker","Passion One","Indie Flower","Quicksand","Shadows Into Light","Source Code Pro","Aladin","Calligraffitti","Trebuchet MS","Courier New","Montserrat"],Ih=new Set;Eh.forEach((e=>{Sh.includes(e)||Ih.add(e)}));const Ch={"B Koodak":"BKoodak.ttf","B Titr":"BTitr.ttf",Nazanin:"Nazanin.ttf","Noto Kufi Arabic":"NotoKufiArabic-Regular.ttf","Noto Naskh Arabic":"NotoNaskhArabicUI-Regular.ttf","Noto Sans Arabic":"NotoSansArabic-Regular.ttf",Yekan:"Yekan.ttf","The Bold Font":"TheBoldFont.ttf"},kh=[...new Set([...Eh,...Sh,...Object.keys(Ch)])].sort(),Ah=new Set(Sh),jh={};Ih.forEach((e=>{jh[e]="success"}));const Nh=v({initialState:jh,name:"loadedFonts",reducers:{updateFontLoadStatuses:(e,t)=>{for(const{font:o,status:a}of t.payload)e[o]=a}}}),{updateFontLoadStatuses:Rh}=Nh.actions,Ph={backgroundColor:"rgba(0, 0, 0, 0.8)",backgroundPadding:10,backgroundStyle:"wrap",borderRadius:15,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Montserrat"},fontSize:30,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom"},Dh={heightPct:0,widthPct:80,xPct:10,yPct:90,rotation:0},Oh={heightPct:0,widthPct:80,xPct:10,yPct:85,rotation:0},Lh={heightPct:0,widthPct:80,xPct:10,yPct:80,rotation:0},Fh={heightPct:0,widthPct:80,xPct:10,yPct:60,rotation:0},Mh=["#FDFA54","#72F459",void 0,"#FDFA54","#72F459"],Uh=[0,-5,5,-5,0,5],Bh={[Yl.None]:{},Color:{active:{color:"#3de1d9"}},Reveal:{unspoken:{color:"transparent",textShadow:"none",textDecoration:"none",display:"inline-block"}},Highlight:{active:{backgroundColor:"#3de1d9",borderRadius:"0.25em"}},Bounce:{active:{bottom:"0.25em"}},Paint:{spoken:{color:"#3de1d9"}},Custom:{spoken:{color:"#18E1D6",borderRadius:"0.125em",backgroundColor:"transparent",bottom:"0rem"},active:{color:"#FF4D8D",borderRadius:"0.125em",backgroundColor:"transparent",bottom:"0rem"},unspoken:{borderRadius:"0.125em",backgroundColor:"transparent",bottom:"0rem"}}};function Vh(e){return{animationId:Yl.MagicWBW,animationName:e,wordByWordStyles:{[e]:Bh[e]}}}function Wh(e){var t,o;const a=Vh("Color");return{...a,wordByWordStyles:{Color:{active:{...null==(o=null==(t=a.wordByWordStyles)?void 0:t.Color)?void 0:o.active,...e}}}}}function Gh(e){var t,o;const a=Vh("Highlight");return{...a,wordByWordStyles:{Highlight:{active:{...null==(o=null==(t=a.wordByWordStyles)?void 0:t.Highlight)?void 0:o.active,...e}}}}}function Hh(e){var t,o;const a=Vh("Paint");return{...a,wordByWordStyles:{Paint:{spoken:{...null==(o=null==(t=a.wordByWordStyles)?void 0:t.Paint)?void 0:o.spoken,...e}}}}}const $h={transitionId:Yl.MagicFade,transitionDuration:.25,transitionOverlapDuration:.15,transitionSpeed:50},Kh={transitionId:Yl.MagicFlip,transitionDuration:.1,transitionOverlapDuration:0,transitionSpeed:50},zh={transitionId:Yl.MagicPop,transitionDuration:.1,transitionOverlapDuration:0,transitionSpeed:50},Yh={presetId:"DEFAULT_PRESET",title:"Default",style:Ph,wordByWordAnimations:Wh({color:"#18E1D6"})},Jh={presetId:"CLASSIC_PRESET",title:"Classic",style:{...Ph,backgroundColor:"#FFFFFF",backgroundPadding:25,borderRadius:25,fontColor:"#000000",fontFamily:{type:"default",fontFamily:"Montserrat"},fontWeight:"normal"},wordByWordAnimations:Wh({color:"#0083E2"}),transition:zh},qh={presetId:"TYPEWRITER_PRESET",title:"Typewriter",style:{...Ph,backgroundColor:"#FFFFFF",backgroundPadding:25,borderRadius:0,fontColor:"#000000",fontFamily:{type:"default",fontFamily:"Courier New"},fontWeight:"normal"},wordByWordAnimations:Vh("Reveal"),transition:Kh},Xh={presetId:"STRONG_PRESET",title:"Strong",style:{...Ph,backgroundColor:"#D23E3E",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Impact"},fontWeight:"bold",textTransform:"uppercase"},wordByWordAnimations:Wh({color:"#FF9B97"}),transition:zh},Qh={presetId:"HANDWRITING_PRESET",title:"Handwriting",style:{...Ph,backgroundColor:"#FFDCDC",backgroundPadding:25,borderRadius:25,fontColor:"#D23E3E",fontFamily:{type:"default",fontFamily:"Dancing Script"},fontWeight:"normal"},wordByWordAnimations:Vh("Reveal"),transition:$h},Zh={presetId:"COMIC_PRESET",title:"Comic",style:{...Ph,backgroundColor:"#FFE279",backgroundPadding:25,borderRadius:0,fontColor:"#000000",fontFamily:{type:"default",fontFamily:"Comic Sans MS"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Vh("Bounce"),transition:zh},eg={presetId:"MEME_TEXT_PRESET",title:"Meme Text",style:{...Ph,backgroundColor:"transparent",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Impact"},fontWeight:"normal"},wordByWordAnimations:Vh("Paint"),transition:zh},tg={presetId:"FORMAL_PRESET",title:"Formal",style:{...Ph,backgroundColor:"#000000",backgroundPadding:25,borderRadius:25,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Times New Roman"},fontWeight:"normal"},wordByWordAnimations:Gh({backgroundColor:"#404040"}),transition:$h},og={presetId:"GRAFITTI_PRESET",title:"Grafitti",style:{...Ph,backgroundColor:"#C5E6FF",backgroundPadding:25,borderRadius:0,fontColor:"#21A2FF",fontFamily:{type:"default",fontFamily:"Permanent Marker"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Hh({color:"#196794"}),transition:zh},ag={presetId:"EARTH_TONED_PRESET",title:"Earth Toned",style:{...Ph,backgroundColor:"#CCDEBF",backgroundPadding:25,borderRadius:25,fontColor:"#3D6422",fontFamily:{type:"default",fontFamily:"Playfair Display"},fontWeight:"normal"},wordByWordAnimations:Gh({backgroundColor:"#3D6422",color:"#FFFFFF"}),transition:$h},ig={presetId:"PLAYFUL_PRESET",title:"Playful",style:{...Ph,backgroundColor:"#93518C",backgroundPadding:25,borderRadius:25,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Amatic SC"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Vh("Bounce"),transition:zh},sg={presetId:"HARDCORE_PRESET",title:"Hardcore",style:{...Ph,backgroundColor:"#000000",backgroundPadding:50,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"New Rocker"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:function(e,t,o){var a,i,s,n,r,l;const d=Vh("Custom");return{...d,wordByWordStyles:{Custom:{spoken:{...null==(i=null==(a=d.wordByWordStyles)?void 0:a.Custom)?void 0:i.spoken,...e},active:{...null==(n=null==(s=d.wordByWordStyles)?void 0:s.Custom)?void 0:n.active,...t},unspoken:{...null==(l=null==(r=d.wordByWordStyles)?void 0:r.Custom)?void 0:l.unspoken,...o}}}}}({color:"#917F7F"},{},{}),transition:$h},ng={presetId:"BOLD_PRESET",title:"Bold",style:{...Ph,backgroundColor:"#0047FF",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Passion One"},fontWeight:"bold"},wordByWordAnimations:Vh("Color"),transition:zh},rg={presetId:"INDIE_PRESET",title:"Indie",style:{...Ph,backgroundColor:"#FFF5E9",backgroundPadding:25,borderRadius:25,fontColor:"#794718",fontFamily:{type:"default",fontFamily:"Indie Flower"},fontWeight:"normal"},wordByWordAnimations:Hh({color:"#D81B60"}),transition:Kh},lg={presetId:"CONSOLE_PRESET",title:"Console",style:{...Ph,backgroundColor:"#000000",backgroundPadding:25,borderRadius:0,fontColor:"#3EFF51",fontFamily:{type:"default",fontFamily:"Source Code Pro"},fontWeight:"normal"},wordByWordAnimations:Vh("Reveal"),transition:$h},dg={presetId:"BUBBLE_GUM_PRESET",title:"Bubble Gum",style:{...Ph,backgroundColor:"#FF66A6",backgroundPadding:25,borderRadius:50,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Fredoka One"},fontWeight:"normal"},wordByWordAnimations:Vh("Bounce"),transition:Kh},cg={presetId:"GOOFY_PRESET",title:"Goofy",style:{...Ph,backgroundColor:"#F08253",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Luckiest Guy"},fontWeight:"normal"},wordByWordAnimations:Gh({backgroundColor:"#F25D37"}),transition:Kh},ug={presetId:"CLEAN_PRESET",title:"Clean",style:{...Ph,backgroundColor:"#622424",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Quicksand"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Vh("Color"),transition:$h},mg={presetId:"OLIVE_PRESET",title:"Olive",style:{...Ph,backgroundColor:"#6a8268",backgroundPadding:25,borderRadius:25,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Raleway"},fontWeight:"normal",textShadow:"#35442F"},wordByWordAnimations:Wh({color:"#FFFF00"}),transition:$h},pg={presetId:"FRESH_PRESET",title:"Fresh",style:{...Ph,backgroundColor:"#E7FBFF",backgroundPadding:25,borderRadius:0,fontColor:"#3589B9",fontFamily:{type:"default",fontFamily:"Georgia"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Hh({color:"#1B3445"}),transition:Kh},hg={presetId:"POP_ART_PRESET",title:"Pop Art",style:{...Ph,backgroundColor:"rgba(-255,-255,-255,0)",fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"The Bold Font"},fontSize:64,textOutline:{color:"#000000",width:17},textTransform:"uppercase",textShadow:"#000000",dropShadow:{blur:.12,distance:.17,rotation:45,color:"#000000"},lineHeight:1,colorHighlights:Mh,rotationOffsets:Uh},transition:zh},gg={presetId:"RED_PRESET",title:"Red",style:{...Ph,backgroundColor:"rgba(234,64,63,0.8)",backgroundPadding:25,backgroundStyle:"wrap",borderRadius:25,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Josefin Sans"},fontSize:30,fontStyle:"normal",fontWeight:"normal",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"middle"},wordByWordAnimations:Vh("Bounce"),transition:zh},fg={presetId:"CHELSEA",title:"Chelsea",style:{...Ph,backgroundColor:"rgba(-255,-255,-255,0)",backgroundPadding:10,backgroundStyle:"wrap",borderRadius:15,fontColor:"#aeeae6",fontFamily:{type:"default",fontFamily:"Chelsea Market"},fontSize:36,fontStyle:"normal",fontWeight:"normal",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:.1,distance:.08,rotation:45,color:"#404040"}},wordByWordAnimations:Vh("Reveal"),transition:$h},yg={presetId:"CURSIVE",title:"Cursive",style:{...Ph,backgroundColor:"rgba(-255,-255,-255,0)",backgroundPadding:10,backgroundStyle:"wrap",borderRadius:15,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Yesteryear"},fontSize:48,fontStyle:"normal",fontWeight:"normal",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:.1,distance:.08,rotation:45,color:"#404040"}},wordByWordAnimations:Vh("Reveal")},vg={presetId:"BUBBLEGUM",title:"Bubblegum",style:{...Ph,backgroundColor:"rgba(-255,-255,-255,0)",backgroundPadding:10,backgroundStyle:"wrap",borderRadius:15,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Shrikhand"},fontSize:36,fontStyle:"normal",fontWeight:"normal",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:0,distance:.15,rotation:45,color:"#FF4D8D"}},transition:zh},_g={presetId:"CANTELOPE",title:"Cantelope",style:{...Ph,backgroundColor:"rgba(-255,-255,-255,0)",backgroundPadding:25,backgroundStyle:"wrap",borderRadius:25,fontColor:"#FFEFEA",fontFamily:{type:"custom",fontFamily:"Raleway_Black",source:"fromAsset",url:"https://cdn-useast1.kapwing.com/static/3IP-subtitle-font.ttf",fontType:"opentype",asset_id:"6269d8a0c20873007d7ebbba"},fontSize:36,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:0,distance:.2,rotation:45,color:"#FF825A"}},transition:zh},wg={presetId:"MONOSPACE",title:"Monospace",style:{...Ph,backgroundColor:"rgba(0,0,0,0.7)",backgroundPadding:25,backgroundStyle:"wrap",borderRadius:0,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Courier New"},fontSize:24,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:0,distance:.15,rotation:45,color:"rgba(-255,-255,-255,0)"}},transition:Kh},bg={presetId:"MONOSPACE_WHITE",title:"Monospace White",style:{...Ph,backgroundColor:"rgba(255,255,255,0.7)",backgroundPadding:25,backgroundStyle:"wrap",borderRadius:0,fontColor:"#808080",fontFamily:{type:"default",fontFamily:"Source Code Pro"},fontSize:24,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:0,distance:.15,rotation:45,color:"rgba(-255,-255,-255,0)"}},wordByWordAnimations:Wh({color:"#000000"})},Tg={presetId:"FOREST",title:"Forest",style:{...Ph,backgroundColor:"#32523B",backgroundPadding:25,backgroundStyle:"wrap",borderRadius:36,fontColor:"#10290F",fontFamily:{type:"default",fontFamily:"Montserrat"},fontSize:30,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:.1,distance:.08,rotation:45,color:"rgba(-255,-255,-255,0)"}},transition:zh,wordByWordAnimations:Wh({color:"#DAECC4"})},xg={presetId:"HIGHLIGHTER",title:"Highlighter",style:{...Ph,backgroundColor:"rgba(-255,-255,-255,0)",backgroundPadding:25,backgroundStyle:"wrap",borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Jost"},fontSize:48,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"left",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:.1,distance:.08,rotation:45,color:"#404040"}},transition:$h,wordByWordAnimations:Wh({color:"#FFF731"})},Sg={presetId:"OCEAN",title:"Ocean",style:{...Ph,backgroundColor:"#2F688C",backgroundPadding:10,backgroundStyle:"wrap",borderRadius:15,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Montserrat"},fontSize:30,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1,verticalAlign:"bottom",dropShadow:{blur:.1,distance:.08,rotation:45,color:"rgba(-255,-255,-255,0)"}},transition:Kh,wordByWordAnimations:Wh({color:"#70EEFF"})},Eg=[Yh,hg,vg,xg],Ig=[Yh,hg,vg,xg,_g,Tg,fg,Sg,gg,bg,wg,yg,Jh,qh,Xh,Qh,tg,ag,ig,sg,ng,rg,lg,dg,cg,ug,mg,pg,Zh,eg,og],Cg=e=>Ig.find((t=>t.presetId===e.presetId)),kg=e=>!!Cg(e),Ag=e=>e.map((e=>{const t=Cg(e);return t?{...e,style:t.style,wordByWordAnimations:t.wordByWordAnimations,transition:t.transition}:e}));function jg(e,t,o,a){const i=a,s=e.find((e=>e[i]===t));if(!s)return console.error("moveToNdx: src not found"),e;let n=!0;const r=[];return e.forEach(((e,a)=>{e[i]!==t?a!==o?r.push(e):n?(r.push(s),r.push(e)):(r.push(e),r.push(s)):n=!1})),r}function Ng(e,t,o){return jg(e,t,o,"presetId")}function Rg(e,t,o){return Ng(e,t,o)}function Pg(e,t,o){return Ng(e,t,o)}function Dg(e,t,o){return jg(e,t,o,"templateId")}function Og(e){const[t,o]=h.useState(1);return h.useEffect((()=>{const t=setInterval((()=>{o((e=>e+1))}),e);return()=>clearInterval(t)}),[e]),t}function Lg(e,t){return e.studioLocal.layerTempValues[t]??{}}function Fg(e,t){return Lg(e,t).isEditing??!1}function Mg(e,t){const{idbAssetIds:o}=e.studioLocal;return null!==o&&o.includes(t)}function Ug(e){var t;return null==(t=e.studioLocal.layerTempValues.ghost)?void 0:t.mIGhostLayerAbsolutePosition}function Bg(e,t){const{draggedTracksOverrides:o}=e.studioLocal;return!!(o||{})[t]}const Vg=m((e=>e.studioLocal.isProjectFetched),(e=>e.studioLocal.lastSyncedWithServer),(e=>e.userPermissions.canWrite),((e,t,o)=>{const{attempted:a,firstAttemptSinceLastSuccess:i,succeeded:s}=t;if(!o)return!1;if(!e)return!1;if(!(a.websocket||a.http))return!1;const n=[s.websocket,s.http].filter(Er),r=[i.websocket,i.http].filter(Er);if(0===r.length)return!1;if(1===r.length){if(i.websocket&&i.websocket<=(s.http||0))return!1;if(i.http&&i.http<=(s.websocket||0))return!1}const l=n.length>0?Math.max(...n):0;if(Date.now()-l<122e3)return!1;const d=r.length>0?Math.max(...r):0;return Date.now()-d>122e3})),Wg="media-sidebar",Gg={audio:"Audio",elements:"Elements",emojis:"Emojis",help:"Help",images:"Images",layers:"Layers",media:"Media",more:"More",plugins:"Plugins",record:"Record",scenes:"Scenes",shapes:"Shapes",soundEffects:"Sound Effects",subtitles:"Subtitles",templates:"Templates",text:"Text",transcript:"Transcript",transitions:"Transitions",videos:"Videos"},Hg=(()=>{const e=new D.UAParser;return{browser:e.getBrowser(),device:e.getDevice(),os:e.getOS()}})();function $g(){return"chrome"in window}function Kg(){const e=Hg.browser.name;return"Chromium"===e||(null==e?void 0:e.startsWith("Chrome"))||!1}function zg(){return"mobile"===Hg.device.type}function Yg(){return"iOS"===Hg.os.name}function Jg(){var e;return null==(e=Hg.browser.name)?void 0:e.includes("Mobile Safari")}function qg(){var e;return null==(e=Hg.browser.name)?void 0:e.includes("Safari")}function Xg(){var e;return null==(e=Hg.browser.name)?void 0:e.includes("Firefox")}function Qg(){return["fullscreen","standalone","minimal-ui"].some((e=>window.matchMedia(`(display-mode: ${e})`).matches))}class Zg{static getOS(){return Hg.os}static isMac(){var e;return null==(e=Hg.os.name)?void 0:e.includes("Mac OS")}static isWindows(){var e;return null==(e=Hg.os.name)?void 0:e.includes("Windows")}static isLinux(){var e;return null==(e=Hg.os.name)?void 0:e.includes("Linux")}static isChromium(){var e;return null==(e=Hg.os.name)?void 0:e.includes("Chromium OS")}}const ef=e=>e.sessionValues.hideTimeline??!1,tf=e=>nf(e,"snapInTimeline")??!0,of=e=>{var t;const o=zg();if(!e.userPermissions.canWrite){return(null==(t=e.selectedTabs)?void 0:t["media-sidebar"])===Gg.help}return e.projectSessionSettings.mediaSidebar??!o},af=e=>nf(e,"rippleMode")??!1,sf=e=>e.projectSessionSettings.pxInSecond??null;function nf(e,t){var o,a,i;return e.currentUser.user._id?null==(a=null==(o=e.studio.userSpecificSettings)?void 0:o[e.currentUser.user._id])?void 0:a[t]:null==(i=e.studio.userSpecificSettingsAnonymous)?void 0:i[t]}function rf(e){const{selectedItem:t,groups:o,timelineGap:a,allLayers:i}=e.studio,s=(null==t?void 0:t.id)||"";return o&&o[s]?{type:"group"}:a&&a.gapId===s?{type:"gap"}:i.byId[s]}const lf=m((e=>e.studio.showCanvas),(e=>!!Object.entries(e.studio.allLayers.byId).length),((e,t)=>!e&&!t));function df(e,t=!1){return{type:"SET_EDIT_HISTORY_INDEX",historyIndex:e,usedUndo:t}}function cf(e){return{type:"SET_EDIT_HISTORY_INDEX_MINIMUM",historyIndexMinimum:e}}const uf={index:-1,actions:[],batches:[]},mf={...uf};function pf(e){return!!e.func}function hf(e,t){const{dispatch:o}=sr();e&&(t?pf(e.undo)?e.undo.func(e.undo):o(e.undo):pf(e.redo)?e.redo.func(e.redo):o(e.redo))}const gf=(e,t)=>{ff.add({undo:{func:()=>{t()}},redo:{func:()=>{e()}}})},ff={getState:()=>mf,setMinimumIndex(e=!0){const{dispatch:t}=sr();t(cf(e?mf.index:-1))},beginBatch(){const{batches:e}=mf;e.push([])},endBatch(){const{batches:e}=mf,t=e.pop();null!=t?0!==t.length&&ff.add({undo:{func(){g.batch((()=>{for(let e=t.length-1;e>=0;e-=1){hf(t[e],!0)}}))},batch:t},redo:{func(){g.batch((()=>{for(let e=0;e<t.length;e+=1){hf(t[e],!1)}}))},batch:t}}):console.error("Tried to endBatch while no batch is active.")},execInUndoBatch(e){try{this.beginBatch(),e()}catch(IGe){console.error(IGe)}finally{this.endBatch()}},withUndoBatch(e){return(...t)=>{try{return this.beginBatch(),e(...t)}finally{this.endBatch()}}},withUndoBatchAsync(e){return async(...t)=>{try{return this.beginBatch(),await e(...t)}finally{this.endBatch()}}},add(e){const{actions:t,batches:o,index:a}=mf,i=o.pop(),n=i||t;let r=(null==i?void 0:i.length)??a,l=[...n];i||(a!==n.length-1&&(l=n.slice(0,a+1)),n.length>=1e3&&(l=l.slice(1),r-=1),n.length>-1&&(r+=1)),l.push(s.cloneDeep(e)),i?o.push(l):(mf.actions=l,mf.index=r,vf())},studioStateAllowsUndoOrRedo(){const{state:e}=sr(),t=yf();return!(e.studio.overlayMounted||e.studio.disableUndo||t&&Fg(e,t.id)||"isStudio"in e&&!0!==e.isStudio)},canUndo({force:e}={}){const{state:t}=sr(),{index:o}=mf;return!!(o>=0&&t.userPermissions.canWrite&&t.studio.historyIndexMinimum!==o)&&(!!e||this.studioStateAllowsUndoOrRedo())},undo(e={}){const{dispatch:t}=sr(),{index:o,batches:a}=mf;if(a.length>0)throw Error("Tried to undo while batch exists.");if(!ff.canUndo(e))return;const i=o-1;mf.index=i;const s=mf.actions[o];s&&hf(s,!0),t(df(i,!0)),vf()},canRedo({force:e}={}){const{state:t}=sr(),{index:o,actions:a}=mf;return!(o===a.length-1||!t.userPermissions.canWrite)&&(!!e||this.studioStateAllowsUndoOrRedo())},redo(e={}){const{dispatch:t}=sr(),{index:o,batches:a}=mf;if(a.length>0)throw Error("Tried to redo while batch exists.");const i=o+1;if(!ff.canRedo(e))return;mf.index=i;const s=mf.actions[i];s&&hf(s,!1),t(df(i,!0)),vf()},reset(){const{dispatch:e}=sr();Object.assign(mf,uf),e(df(-1)),vf()}},yf=()=>{const{state:e}=sr(),t=rf(e);return t?"group"===t.type||"gap"===t.type?null:t:null},vf=()=>{setTimeout((()=>{_f.forEach((e=>e()))}),0)},_f=new Set,wf=()=>{const[e,t]=h.useState(0);h.useEffect((()=>{const e=()=>t((e=>e+1));return _f.add(e),()=>{_f.delete(e)}}),[])},bf=()=>(wf(),ff.canUndo()),Tf=()=>(wf(),ff.canRedo());"undefined"!=typeof window&&(window.editHistoryState=mf);const xf={brandkitPresets:[],customPreset:null,lastExportedPresets:[],presets:Ig,lastAssetUrlSignedAt:void 0,removedDefaultPresetIds:[]},Sf="custom";const Ef=e=>{const{removedDefaultPresetIds:t=[],lastExportedPresets:o=[],lastAssetUrlSignedAt:a}=e;let{presets:i=[]}=e;return i=Ag(i),i=((e,t)=>{const o=new Set;e.forEach((e=>{o.add(e.presetId)}));let a=!1;for(const n of Ig){const e=o.has(n.presetId),i=t.includes(n.presetId);if(!e&&!i){a=!0;break}}if(!a)return e;let i=0;const s=e.filter((e=>!kg(e)));return Ig.forEach((e=>{t.includes(e.presetId)||(s.splice(i,0,e),i+=1)})),s})(i,t),i=function(e){const t=[],o=new Set;return e.forEach((e=>{o.has(e.presetId)||(o.add(e.presetId),t.push(e))})),t}(i),{presets:i,removedDefaultPresetIds:t,lastAssetUrlSignedAt:a,lastExportedPresets:Ag(o).slice(0,20)}},If=v({name:"magicSubtitlePresets",initialState:xf,reducers:{setSubtitlePresets:(e,t)=>{const{presets:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{presets:e.presets,undoable:!1}},i={type:t.type,payload:{presets:o,undoable:!1}};ff.add({undo:a,redo:i})}e.presets=o;const i=new Set(o.map((({presetId:e})=>e)));e.lastExportedPresets=e.lastExportedPresets.filter((({presetId:e,teamId:t})=>!!t||i.has(e)))},setSubtitleBrandkitPresets:(e,t)=>{const{brandkitPresets:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{brandkitPresets:e.brandkitPresets,undoable:!1}},i={type:t.type,payload:{brandkitPresets:o,undoable:!1}};ff.add({undo:a,redo:i})}e.brandkitPresets=o},setSubtitlePresetTitle:(e,t)=>{const{presetId:o,title:a,undoable:i}=t.payload;if(i){const i=e.presets.find((e=>e.presetId===o)),s={type:t.type,payload:{presetId:o,title:(null==i?void 0:i.title)||"",undoable:!1}},n={type:t.type,payload:{presetId:o,title:a,undoable:!1}};ff.add({undo:s,redo:n})}const s=e=>e.presetId===o?{...e,title:a}:e;e.presets=e.presets.map(s),e.brandkitPresets=e.brandkitPresets.map(s),e.lastExportedPresets=e.lastExportedPresets.map(s)},addSubtitlePreset:(e,t)=>{const{preset:o,index:a,undoable:i}=t.payload;if(i){const e={type:"magicSubtitlePresets/removeSubtitlePreset",payload:{presetId:o.presetId,undoable:!1}},i={type:t.type,payload:{preset:o,index:a,undoable:!1}};ff.add({undo:e,redo:i})}void 0!==a?e.presets.splice(a,0,o):e.presets.push(o)},moveSubtitlePreset:(e,t)=>{const{srcPresetId:o,dstPresetId:a,undoable:i}=t.payload;if(i){const i={type:"magicSubtitlePresets/setSubtitlePresets",payload:{presets:e.presets,undoable:!1}},s={type:t.type,payload:{srcPresetId:o,dstPresetId:a,undoable:!1}};ff.add({undo:i,redo:s})}if(void 0===e.presets.find((({presetId:e})=>e===o)))return void console.error("Cannot moveSubtitlePreset, srcPreset is undefined");const s=e.presets.findIndex((({presetId:e})=>e===a));-1!==s?e.presets=Rg(e.presets,o,s):console.error("Cannot moveSubtitlePreset, dstPresetId is not found")},removeSubtitlePreset:(e,t)=>{const{presetId:o,undoable:a}=t.payload,i=e.presets.findIndex((e=>e.presetId===o)),s=e.presets[i];if(a&&s){const e={type:"magicSubtitlePresets/addSubtitlePreset",payload:{preset:s,index:i,undoable:!1}},a={type:t.type,payload:{presetId:o,undoable:!1}};ff.add({undo:e,redo:a})}s&&kg(s)&&(e.removedDefaultPresetIds||(e.removedDefaultPresetIds=[]),e.removedDefaultPresetIds.push(o));const n=e=>e&&e.presetId&&e.presetId!==o;e.presets=e.presets.filter(n),e.lastExportedPresets=e.lastExportedPresets.filter(n)},addSubtitleBrandkitPreset:(e,t)=>{const{preset:o,index:a}=t.payload;void 0!==a?e.brandkitPresets.splice(a,0,o):e.brandkitPresets.push(o)},moveSubtitleBrandkitPreset:(e,t)=>{const{srcPresetId:o,dstPresetId:a}=t.payload;if(void 0===e.brandkitPresets.find((({presetId:e})=>e===o)))return void console.error("Cannot moveSubtitleBrandkitPreset, srcPreset is undefined");const i=e.brandkitPresets.findIndex((({presetId:e})=>e===a));-1!==i?e.brandkitPresets=Rg(e.brandkitPresets,o,i):console.error("Cannot moveSubtitleBrandkitPreset, dstPresetId is not found")},removeSubtitleBrandkitPreset:(e,t)=>{const{presetId:o}=t.payload,a=e=>e&&e.presetId&&e.presetId!==o;e.brandkitPresets=e.brandkitPresets.filter(a),e.lastExportedPresets=e.lastExportedPresets.filter(a)},saveSubtitlePresetOnExport:(e,t)=>{const{preset:o}=t.payload,a=e=>e&&e.presetId&&e.presetId!==o.presetId;e.presets=[o,...e.presets.filter(a)],e.lastExportedPresets=[o,...e.lastExportedPresets.filter(a)]},setSubtitleCustomPreset:(e,t)=>{const o=t.payload;e.customPreset=o},setLastAssetUrlSignedAt:(e,t)=>{e.lastAssetUrlSignedAt=t.payload}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return{...xf,...Ef(e)};default:return e}}))}),{setSubtitleCustomPreset:Cf,setSubtitlePresets:kf,setSubtitleBrandkitPresets:Af,setSubtitlePresetTitle:jf,addSubtitlePreset:Nf,moveSubtitlePreset:Rf,removeSubtitlePreset:Pf,addSubtitleBrandkitPreset:Df,moveSubtitleBrandkitPreset:Of,removeSubtitleBrandkitPreset:Lf,saveSubtitlePresetOnExport:Ff,setLastAssetUrlSignedAt:Mf}=If.actions,Uf={runningExports:[],snapshots:[],snapshotsLoading:!1,pendingExport:void 0,roughCutSurvey:!1,downloadSurvey:!1},Bf=v({name:"exports",initialState:Uf,reducers:{clearExportStore:()=>Uf,startFetchRunningExports:(e,t)=>{e.runningExports=e.runningExports.filter((e=>e.videoId===t.payload))},runningExportsFetched:(e,t)=>{e.runningExports=t.payload.snapshots,t.payload.finishPendingExport&&(e.pendingExport=void 0)},snapshotsLoading:e=>{e.snapshotsLoading=!0},snapshotsFetched:(e,t)=>{e.snapshots=t.payload.snapshots,e.snapshotsLoading=!1,t.payload.finishPendingExport&&(e.pendingExport=void 0)},exportStarted:(e,t)=>{e.pendingExport={name:t.payload.name||An,clientSide:t.payload.clientSide}},finishPendingExport:e=>{e.pendingExport=void 0},showRoughCutSurvey:e=>{e.roughCutSurvey=!0},hideRoughCutSurvey:e=>{e.roughCutSurvey=!1},showDownloadSurvey:e=>{e.downloadSurvey=!0},hideDownloadSurvey:e=>{e.downloadSurvey=!1}}}),{startFetchRunningExports:Vf,runningExportsFetched:Wf,snapshotsFetched:Gf,snapshotsLoading:Hf,exportStarted:$f,finishPendingExport:Kf,showRoughCutSurvey:zf,hideRoughCutSurvey:Yf,showDownloadSurvey:Jf,hideDownloadSurvey:qf,clearExportStore:Xf}=Bf.actions,Qf=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Zf=/^rgba?\((-?\d{1,3}), ?(-?\d{1,3}), ?(-?\d{1,3})(?:(?:, ?)(\d+(?:\.\d*)?|undefined))?\)$/i,ey="rgba(-255,-255,-255,0)",ty=e=>{if("transparent"===e)return!0;const t=ay(e);return 0===(null==t?void 0:t.a)};function oy(e){const t=Zf.exec(e);if(!t)return null;return{r:parseInt(t[1]??"0",10),g:parseInt(t[2]??"0",10),b:parseInt(t[3]??"0",10),a:5===t.length?parseFloat(t[4]??"1"):1}}function ay(e){if(!e||"none"===e)return null;let t=null;return e.startsWith("#")?t=function(e){const t=Qf.exec(e);return t?{r:parseInt(t[1]??"0",16),g:parseInt(t[2]??"0",16),b:parseInt(t[3]??"0",16),a:1}:null}(e):e.startsWith("rgb")&&(t=oy(e)),t}function iy(e,t){if(!e)return e;const o=ay(e);if(!o)return e;Object.assign(o,t);const{r:a,g:i,b:s}=o;return`#${a.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}`.toLocaleUpperCase()}const sy={presetId:"DEFAULT",style:{fontFamily:"Montserrat",fontWeight:"normal",textAlign:"center",textTransform:"none",textShadow:ey,color:"#fff",backgroundColor:"black",textPadding:12.5,wrapOrFill:"wrap",borderRadius:{relative:"25%"},underline:!1,italic:!1,globalAlpha:1,lineHeight:1}},ny={presetId:"GLOW",style:{...sy.style,backgroundColor:ey,textEffect:"dropShadow",textBlur:.2,textShadowBlur:.35,textShadowDist:.07,textShadowRot:35,textEffectColor:"#FFFFFF"}},ry={presetId:"OLIVE",style:{...sy.style,fontFamily:"Source Code Pro",backgroundColor:"#6F8F72",textShadow:"#000000"}},ly={presetId:"THREE_D",style:{...sy.style,fontFamily:"Bebas Neue",backgroundColor:ey,color:"#53E4DC",textShadow:"#000000",textEffect:"dropShadow",textShadowBlur:0,textShadowDist:.11,textShadowRot:45,textEffectColor:"#FF005C",textTransform:"uppercase"}},dy={presetId:"CLASSIC",style:{...sy.style,color:"#000000",backgroundColor:"#FFFFFF"}},cy={presetId:"BLURRY",style:{...sy.style,fontFamily:"Bebas Neue",color:"#FFFFFF",backgroundColor:ey,textEffect:"textBlur",textShadowBlur:0,textShadowDist:.25,textShadowRot:69,textEffectColor:"#FFEA00",textBlur:.5,textTransform:"uppercase"}},uy={presetId:"HANDWRITING",style:{...sy.style,fontFamily:"Dancing Script",color:"#D23E3E",backgroundColor:"#FFDCDC"}},my={presetId:"MUTANT",style:{...sy.style,fontFamily:"Impact",color:"#A3FF78",backgroundColor:ey,textEffect:"dropShadow",textBlur:.2,textShadowBlur:.35,textShadowDist:.07,textShadowRot:35,textEffectColor:"#A3FF78"}},py={presetId:"ARCADE",style:{...sy.style,fontFamily:"Permanent Marker",backgroundColor:ey,color:"#FFE279",textShadow:"#000000",textEffect:"dropShadow",textShadowBlur:0,textShadowDist:.15,textShadowRot:45,textEffectColor:"#E05353",textTransform:"uppercase"}},hy={presetId:"TYPEWRITER",style:{...sy.style,fontFamily:"Courier New",color:"#000000",backgroundColor:"#FFFFFF"}},gy={presetId:"HARDCORE",style:{...sy.style,fontFamily:"New Rocker",borderRadius:{relative:"0%"}}},fy={presetId:"PLAYFUL",style:{...sy.style,fontFamily:"Amatic SC",backgroundColor:"#93518C",textTransform:"uppercase"}},yy={presetId:"BOLD",style:{...sy.style,fontFamily:"Passion One",backgroundColor:"#0047FF",borderRadius:{relative:"0%"}}},vy={presetId:"CLEAN",style:{...sy.style,fontFamily:"Quicksand",backgroundColor:"#622424",borderRadius:{relative:"0%"}}},_y={presetId:"INDIE",style:{...sy.style,fontFamily:"Indie Flower",backgroundColor:"#FFF5E9",color:"#794718"}},wy={presetId:"FORMAL",style:{...sy.style,fontFamily:"Times New Roman"}},by={presetId:"GOOFY",style:{...sy.style,fontFamily:"Luckiest Guy",backgroundColor:"#F25D37",color:"#FFFFFF",borderRadius:{relative:"0%"},textPadding:20,textTransform:"uppercase"}},Ty={presetId:"STRONG",style:{...sy.style,fontFamily:"Impact",backgroundColor:"#D23E3E",color:"#FFFFFF",borderRadius:{relative:"0%"}}},xy={presetId:"FRESH",style:{...sy.style,fontFamily:"Georgia",backgroundColor:"#E7FBFF",color:"#174560",borderRadius:{relative:"0%"}}},Sy={presetId:"BUBBLE_GUM",style:{...sy.style,fontFamily:"Georgia",backgroundColor:"#FF66A6",color:"#FFFFFF",borderRadius:{relative:"50%"},textPadding:20}},Ey={presetId:"CONSOLE",style:{...sy.style,fontFamily:"Source Code Pro",backgroundColor:"#000000",color:"#3EFF51",borderRadius:{relative:"0%"}}},Iy={presetId:"EARTH_TONED",style:{...sy.style,fontFamily:"Playfair Display",backgroundColor:"#CCDEBF",color:"#3D6422",borderRadius:{relative:"0%"}}},Cy={presetId:"MEME",style:{...sy.style,fontFamily:"Impact",backgroundColor:ey,color:"#FFFFFF",textShadow:"#000000"}},ky={presetId:"COMIC",style:{...sy.style,fontFamily:"Comic Sans MS",backgroundColor:"#FFE279",color:"#000000"}},Ay={presetId:"GRAFITTI",style:{...sy.style,fontFamily:"Permanent Marker",backgroundColor:"#C5E6FF",color:"#21A2FF",borderRadius:{relative:"0%"},textTransform:"uppercase"}},jy=[{presetId:"BASIC",style:{backgroundColor:"rgba(-255,-255,-255,0)",fontFamily:"Arial",fontWeight:"normal",textAlign:"center",textTransform:"none",textShadow:"rgba(-255,-255,-255,0)",color:"#ffffff",textPadding:12.5,wrapOrFill:"wrap",borderRadius:{relative:"25%"},underline:!1,italic:!1,globalAlpha:1,lineHeight:1}},sy,dy,{presetId:"YELLOW",style:{...sy.style,backgroundColor:"rgba(-255,-255,-255,0)",fontFamily:"Jost",hasCustomFont:!1,fontWeight:"bold",textAlign:"left",textTransform:"none",textShadow:"transparent",color:"#FFF731",textEffect:"dropShadow",textEffectColor:"#000000",textPadding:12.5,wrapOrFill:"wrap",textShadowBlur:.1,textShadowDist:.08,textShadowRot:45,borderRadius:{relative:"25%"},underline:!1,italic:!1,globalAlpha:1,lineHeight:1}},Cy,ry,fy,ly,uy,{presetId:"RETRO",style:{...sy.style,backgroundColor:"rgba(-255,-255,-255,0)",fontFamily:"Bevan",hasCustomFont:!1,fontWeight:"normal",textAlign:"left",textTransform:"none",textShadow:"transparent",color:"#FFFDF5",textEffectColor:"rgba(-255,-255,-255,0)",textPadding:18.75,wrapOrFill:"fill",textShadowBlur:.5,textShadowDist:.08,textShadowRot:45,borderRadius:{relative:"12.5%"},underline:!1,italic:!1,globalAlpha:1,lineHeight:1}},wy,cy,ny,my,py,hy,gy,yy,vy,_y,by,Ty,xy,Sy,Ey,Iy,ky,Ay];function Ny(e){return jy.find((t=>t.presetId===e.presetId))}function Ry(e){return!!Ny(e)}function Py(e){const{fontFamily:t,asset_id:o,hasCustomFont:a}=e.style;return!(a&&!o)&&!(!o&&!kh.includes(t))}const Dy=e=>e.filter(Py).map((e=>{const t=Ny(e);return t?{...e,style:t.style}:e})),Oy={brandkitPresets:[],presets:jy,lastAssetUrlSignedAt:void 0,removedDefaultPresetIds:[]};const Ly=e=>{const{removedDefaultPresetIds:t=[],lastAssetUrlSignedAt:o}=e;let{presets:a=[]}=e;return a=Dy(a),a=((e,t)=>{const o=new Set;e.forEach((e=>{o.add(e.presetId)}));let a=!1;for(const n of jy){const e=o.has(n.presetId),i=t.includes(n.presetId);if(!e&&!i){a=!0;break}}if(!a)return e;let i=0;const s=e.filter((e=>!Ry(e)));return jy.forEach((e=>{t.includes(e.presetId)||(s.splice(i,0,e),i+=1)})),s})(a,t),a=function(e){const t=[],o=new Set;return e.forEach((e=>{o.has(e.presetId)||(o.add(e.presetId),t.push(e))})),t}(a),{presets:a,removedDefaultPresetIds:t,lastAssetUrlSignedAt:o}},Fy=v({name:"textPresets",initialState:Oy,reducers:{setTextPresets:(e,t)=>{const{presets:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{presets:e.presets,undoable:!1}},i={type:t.type,payload:{presets:o,undoable:!1}};ff.add({undo:a,redo:i})}e.presets=o},setTextBrandkitPresets:(e,t)=>{const{brandkitPresets:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{brandkitPresets:e.brandkitPresets,undoable:!1}},i={type:t.type,payload:{brandkitPresets:o,undoable:!1}};ff.add({undo:a,redo:i})}e.brandkitPresets=o},addTextPreset:(e,t)=>{const{preset:o,index:a,undoable:i}=t.payload;if(i){const e={type:"textPresets/removeTextPreset",payload:{presetId:o.presetId,undoable:!1}},i={type:t.type,payload:{preset:o,index:a,undoable:!1}};ff.add({undo:e,redo:i})}void 0!==a?e.presets.splice(a,0,o):e.presets.push(o)},moveTextPreset:(e,t)=>{const{srcPresetId:o,dstPresetId:a,undoable:i}=t.payload;if(i){const i={type:"textPresets/setTextPresets",payload:{presets:e.presets,undoable:!1}},s={type:t.type,payload:{srcPresetId:o,dstPresetId:a,undoable:!1}};ff.add({undo:i,redo:s})}if(void 0===e.presets.find((({presetId:e})=>e===o)))return void console.error("Cannot moveTextPreset, srcPreset is undefined");const s=e.presets.findIndex((({presetId:e})=>e===a));-1!==s?e.presets=Pg(e.presets,o,s):console.error("Cannot moveTextPreset, dstPresetId is not found")},removeTextPreset:(e,t)=>{const{presetId:o,undoable:a}=t.payload,i=e.presets.findIndex((e=>e.presetId===o)),s=e.presets[i];if(a&&s){const e={type:"textPresets/addTextPreset",payload:{preset:s,index:i,undoable:!1}},a={type:t.type,payload:{presetId:o,undoable:!1}};ff.add({undo:e,redo:a})}s&&Ry(s)&&(e.removedDefaultPresetIds||(e.removedDefaultPresetIds=[]),e.removedDefaultPresetIds.push(o));e.presets=e.presets.filter((e=>e&&e.presetId&&e.presetId!==o))},addTextBrandkitPreset:(e,t)=>{const{preset:o,index:a}=t.payload;void 0!==a?e.brandkitPresets.splice(a,0,o):e.brandkitPresets.push(o)},moveTextBrandkitPreset:(e,t)=>{const{srcPresetId:o,dstPresetId:a}=t.payload;if(void 0===e.brandkitPresets.find((({presetId:e})=>e===o)))return void console.error("Cannot moveTextBrandkitPreset, srcPreset is undefined");const i=e.brandkitPresets.findIndex((({presetId:e})=>e===a));-1!==i?e.brandkitPresets=Pg(e.brandkitPresets,o,i):console.error("Cannot moveTextBrandkitPreset, dstPresetId is not found")},removeTextBrandkitPreset:(e,t)=>{const{presetId:o}=t.payload;e.brandkitPresets=e.brandkitPresets.filter((e=>e&&e.presetId&&e.presetId!==o))},saveTextPresetOnExport:(e,t)=>{const{preset:o}=t.payload;e.presets=[o,...e.presets.filter((e=>e&&e.presetId&&e.presetId!==o.presetId))]},setLastAssetUrlSignedAt:(e,t)=>{e.lastAssetUrlSignedAt=t.payload}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return{...Oy,...Ly(e)};default:return e}}))}),{setTextPresets:My,setTextBrandkitPresets:Uy,addTextPreset:By,moveTextPreset:Vy,removeTextPreset:Wy,addTextBrandkitPreset:Gy,moveTextBrandkitPreset:Hy,removeTextBrandkitPreset:$y,saveTextPresetOnExport:Ky,setLastAssetUrlSignedAt:zy}=Fy.actions,Yy=[{templateId:"DISCORD",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#5865F2",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/WnR-th-3020716033.webp",type:"image",isTrimmed:!0,position:{x:"14.651621515370575%",y:"38.89106632736083%",width:"12.112823443951266%",height:"22.217867345278346%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"TWITCH",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#8849F6",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/s-4-TwitchGlitchWhite-JN7ET3dtT9.webp",type:"image",isTrimmed:!0,position:{x:"15.651621515370575%",y:"38.89106632736083%",width:"10.712823443951266%",height:"22.217867345278346%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"FACEBOOK",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#1C4274",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.48448456357748%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/GYQ-facebookIcon.png",type:"image",isTrimmed:!0,position:{x:"14.817448266778765%",y:"39.1515860314291%",width:"12.204465714642247%",height:"21.696827937141776%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"TWITTER",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#1D9BF0",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/XZ7-2021_Twitter_logo_white-sggXAaIEr3.webp",type:"image",position:{x:"14.888509358032383%",y:"40.82231347916707%",width:"12.545174906414708%",height:"18.355373041665874%",rotation:0},isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074075%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"INSTAGRAM",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#5A1531",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.48448456357748%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/Ppl-zoT-instagramIcon.png",type:"image",isTrimmed:!0,position:{x:"14.796282058452114%",y:"38.63139638587815%",width:"12.789679065887087%",height:"22.737207228243715%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"YOUTUBE",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#FF0000",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/FEE-yt_logo_mono_dark-EBaKqfaZMq.webp",isTrimmed:!0,type:"image",position:{x:"15.05126627558372%",y:"41.2575640084404%",width:"14.08981081504867%",height:"17.48487198311922%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"FOLLOW_ME",ratio:[480,159],layers:[{id:"",url:"https://cdn-useast1.kapwing.com/static/H8C-source_63d461b154645c002563c781.webp",objectFit:"cover",mime:"image/gif",width:480,height:159,type:"image",position:{x:"0%",y:"0%",rotation:0,width:"100%",height:"100%"},isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"25%"},color:"#000000",fontFamily:"Montserrat",fontSize:55.23428571428571,baseWidth:1035.8490566037735,baseHeight:61,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"1.7761146832507666%",y:"32.853729665155825%",width:"96.44777063349846%",height:"17.146270334844175%",rotation:0},text:"Follow me @username",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,startTime:0,endTime:0,isTrimmed:!1,textWithLineBreaks:"Follow me @username",hasCustomFont:!1}]},{templateId:"ARROW_DOWN",ratio:[662,794],layers:[{id:"",url:"https://cdn-useast1.kapwing.com/static/bGK-source_63d46014824fa4001f93237c.webp",source:"upload",objectFit:"cover",mime:"image/gif",height:480,type:"image",width:400,position:{x:"19.733376885858352%",y:"6.8391074454402485%",rotation:180,width:"60.533246228283296%",height:"60.53324622828329%"},isTrimmed:!0},{id:"",type:"text",backgroundColor:"#137f9c",borderRadius:{relative:"50%"},color:"#000000",fontFamily:"Nunito",fontSize:54,baseWidth:346,baseHeight:60.10198974609375,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"24.146948941469486%",y:"74.09231084336724%",width:"51.70610211706103%",height:"6.724782067247821%",rotation:0},text:"CLICK HERE",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:25,startTime:0,endTime:0,isTrimmed:!1,textWithLineBreaks:"CLICK HERE",hasCustomFont:!1}]},{templateId:"LOVE",ratio:[1,1],layers:[{id:"",url:"https://cdn-useast1.kapwing.com/static/Qgu-source_63d461cec507e800180d0866.webp",objectFit:"cover",uploadId:"42441174-0950-461e-bf9e-c1a35ec98256",height:480,type:"image",width:480,position:{x:"0%",y:"0%",rotation:0,width:"100%",height:"100%"},isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"50%"},color:"#8c0f41",fontFamily:"Amatic SC",fontSize:82.59428571428572,baseWidth:516.9140625,baseHeight:176,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"17.81357020547945%",y:"39.714285714285715%",width:"64.3728595890411%",height:"20.57142857142857%",rotation:0},text:"Thanks for 100k \r\nsubscribers!",textAlign:"center",textTransform:"uppercase",textShadow:"rgba(-255,-255,-255,0)",underline:!1,wrapOrFill:"wrap",textPadding:25,startTime:0,endTime:0,isTrimmed:!1,textWithLineBreaks:"Thanks for 100k \r\nsubscribers!",hasCustomFont:!1}]},{templateId:"THANK_YOU",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#202020",fontFamily:"Impact",fontSize:190.5140186915888,baseWidth:877.2570181758513,baseHeight:219.09112149532712,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"20.885529199475123%",y:"6.314473508646749%",width:"58.09649126992392%",height:"25.79439252336449%",rotation:0},text:"THANK YOU",textAlign:"center",textTransform:"uppercase",textShadow:"#FF1744",underline:!1,wrapOrFill:"wrap",textPadding:13,isTrimmed:!1,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,startTime:0,endTime:0,textWithLineBreaks:"THANK YOU"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#FF1744",fontFamily:"Impact",fontSize:190.51401869158877,baseWidth:879.2570181758513,baseHeight:219.0911214953271,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"20.885529199475123%",y:"32.108866032011235%",width:"58.228941601049755%",height:"25.794392523364486%",rotation:0},text:"THANK YOU",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:13,isTrimmed:!1,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,startTime:0,endTime:0,textWithLineBreaks:"THANK YOU",timelineRow:1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#202020",fontFamily:"Impact",fontSize:190.5140186915888,baseWidth:881.7570181758512,baseHeight:219.09112149532712,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"20.885529199475123%",y:"57.90325855537573%",width:"58.394504514957035%",height:"25.79439252336449%",rotation:0},text:"THANK YOU",textAlign:"center",textTransform:"uppercase",textShadow:"#FF1744",underline:!1,wrapOrFill:"wrap",textPadding:13,isTrimmed:!1,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,startTime:0,endTime:0,textWithLineBreaks:"THANK YOU",timelineRow:2}]},{templateId:"LOCATION",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#000000",stroke:"rgba(-255,-255,-255,0)",position:{x:"12.283178472258854%",y:"36.42797737095318%",width:"75.43364305548229%",height:"23.88534336489991%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"21.75%"}},{id:"",type:"image",isTrimmed:!0,position:{x:"18.286542401450337%",y:"40.12380349456986%",rotation:0,width:"9.331765163585688%",height:"16.49369111766655%"},url:"https://cdn-useast1.kapwing.com/static/aM4-locationPin.png"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"23.5%"},color:"#FFFFFF",fontFamily:"Montserrat",fontSize:51,baseWidth:382.06575232597686,baseHeight:51.833433539287675,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"27.11538700428837%",y:"42.4127051281695%",width:"56.21308076714065%",height:"11.91588785046729%",rotation:0},text:"San Francisco",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"fill",textPadding:12.5,isTrimmed:!0}]},{templateId:"SPEECH",ratio:[16,9],layers:[{id:"",type:"image",isTrimmed:!0,position:{x:"11.398644755019275%",y:"35.83280704512436%",rotation:0,width:"77.20271048996145%",height:"34.57510696273633%"},url:"https://cdn-useast1.kapwing.com/static/glR-speechBubbleBackground.png"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},fontFamily:"Montserrat",fontSize:48,baseWidth:528.7088713047926,baseHeight:55.2491211968903,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"15.771028037383179%",y:"41.18452896007446%",width:"69.48568694134248%",height:"12.897196261682243%",rotation:0},text:"Let's go to the beach",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:1,isTrimmed:!0,hasCustomFont:!1,color:"#FFFFFF"}]},{templateId:"BIG_TITLE_SUBTITLE",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#1E88E5",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.682344251764397%",y:"61.99825089305037%",width:"42.68620202826241%",height:"21.774263185842386%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:201.3658438599773,color:"#FFFFFF",fontFamily:"Lato",fontSize:40,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"11.388012334851842%",y:"73.87687322539333%",width:"20.9756087354143%",height:"7.4074074074074066%",rotation:0},text:"SUB TITLE",textAlign:"left",textShadow:"transparent",baseHeight:40.57336753099969,isTrimmed:!0,textWithLineBreaks:"SUB TITLE",textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!0,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1},{id:"",type:"text",backgroundColor:"#FFFFFF",baseWidth:642.8904444655042,color:"#000000",fontFamily:"Lato",fontSize:116,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"11.388012334851842%",y:"52.2822621899652%",width:"66.96775463182335%",height:"21.48148148148148%",rotation:0},text:"BIG TITLE",textAlign:"left",textTransform:"uppercase",textShadow:"transparent",baseHeight:116.6484316516241,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill"}]},{templateId:"TOPIC",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"rgba(-255,-255,-255,0)",stroke:"#BDBDBD",position:{x:"4.529629504418395%",y:"37.99436537284588%",width:"90.94074099116322%",height:"24.011269254308246%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,animation:{animationName:Yl.Reveal,transitionDuration:1}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"25.25%"},color:"#BDBDBD",fontFamily:"Montserrat",fontSize:57,baseWidth:571.7571451788612,baseHeight:65.7268420869861,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"8.428341803375067%",y:"42.34228971962615%",width:"83.14331639324986%",height:"15.315420560747661%",rotation:0},text:"YOUR FIRST TOPIC",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"fill",textPadding:13,isTrimmed:!0,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,animation:{animationName:Yl.Drop,transitionDuration:.5}}]},{templateId:"QUOTE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:629.8381619349678,color:"#BDBDBD",fontFamily:"Bebas Neue",fontSize:60,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"13.195929065887093%",y:"40.76359041946626%",width:"73.60814186822583%",height:"11.111111111111114%",rotation:0},text:"QUOTE OF INFINITE WISDOM",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",baseHeight:60.76050077294487,isTrimmed:!0,textWithLineBreaks:"QUOTE OF INFINITE WISDOM",textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"7.25%"},wrapOrFill:"fill",underline:!1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:629.8381619349678,color:"#BDBDBD",fontFamily:"Libre Baskerville",fontSize:22,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"13.19592906588709%",y:"55.22398117489916%",width:"73.60814186822583%",height:"4.074074074074075%",rotation:0},text:"Albert Einstein",textAlign:"center",textShadow:"transparent",baseHeight:22.094727553798133,isTrimmed:!0,textWithLineBreaks:"Albert Einstein",textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!0,borderRadius:{relative:"7.25%"},wrapOrFill:"fill",underline:!1}]},{templateId:"CHAPTER_TITLE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Georgia",fontSize:60,baseWidth:116.51289582208477,baseHeight:60.47965037786101,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"42.34363272197165%",y:"26.81470499878485%",width:"15.3127345560567%",height:"14.018691588785046%",rotation:0},text:"01",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0,hasCustomFont:!1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Georgia",fontSize:55,baseWidth:354.3064660621435,baseHeight:55.91514846255075,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"26.71759495794913%",y:"43.01220183238608%",width:"46.56481008410181%",height:"12.85046728971963%",rotation:0},text:"CHAPTER 1",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0,hasCustomFont:!1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},fontFamily:"Georgia",fontSize:21,baseWidth:518.268088798585,baseHeight:24.933591712382327,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"15.943247669485515%",y:"67.50726447148135%",width:"68.11350466102898%",height:"5.64252336448598%",rotation:0},text:"Short description of what this chapter is about.",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0,hasCustomFont:!1,color:"#BDBDBD"}]},{templateId:"TITLE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Roboto Mono",fontSize:51,baseWidth:554.4835338077232,baseHeight:51.080562857726285,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"13.563436008546226%",y:"47.06723259608451%",width:"72.87312798290755%",height:"11.915887850467291%",rotation:0},text:"TITLE TEXT HERE",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Roboto Mono",fontSize:34,baseWidth:388.1442650146144,baseHeight:34.05370857181752,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"25.4407685385936%",y:"58.9762144777332%",width:"51.011950717458085%",height:"7.943925233644861%",rotation:0},text:"SUBTITLE TEXT HERE",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Roboto Mono",fontSize:30,baseWidth:299.08071951909176,baseHeight:30.124434505838575,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"30.346623279265284%",y:"79.83136568787435%",width:"39.30675344146942%",height:"7.009345794392523%",rotation:0},text:"DATES/AUTHORS",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0}]},{templateId:"OUR_TEAM",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:703.2588439740796,color:"#BDBDBD",fontFamily:"Alfa Slab One",fontSize:111,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"3.6214945728164345%",y:"19.344714856619564%",width:"60.62576241155858%",height:"17.065333238335366%",rotation:0},text:"Our team",textAlign:"left",textShadow:"transparent",baseHeight:111.35129938013827,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"7.25%"},wrapOrFill:"fill"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:1075.9813259106588,color:"#BDBDBD",fontFamily:"Montserrat",fontSize:37,fontWeight:"normal",globalAlpha:1,lineHeight:1.5,lockAspectRatio:!0,position:{x:"3.6214945728164345%",y:"37.23593532625004%",width:"92.75701085436714%",height:"43.41934981713042%",rotation:0},text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, \r\nsed do eiusmod tempor incididunt ut labore et dolore \r\nmagna aliqua. Ut enim ad minim veniam, quis nostrud \r\nexercitation ullamco laboris nisi ut aliquip ex ea \r\ncommodo consequat. ",textAlign:"left",textShadow:"transparent",baseHeight:283.31125755677596,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"7.25%"},wrapOrFill:"fill",underline:!1}]},{templateId:"QUOTE_CURSIVE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},fontFamily:"Satisfy",fontSize:58,baseWidth:621.5613293127642,baseHeight:134.04961914299054,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"7.155578535230159%",y:"34.4158878504673%",width:"85.68884292953969%",height:"31.168224299065418%",rotation:0},text:'"Quote something your \r\ncustomer says."',textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:1,isTrimmed:!0,hasCustomFont:!1,color:"#BDBDBD"}]}];function Jy(e){return Yy.find((t=>t.templateId===e.templateId))}function qy(e){return!!Jy(e)}const Xy=e=>e.map((e=>{const t=Jy(e);return t?{...e,layers:t.layers}:e})),Qy={brandkitTemplates:[],templates:Yy,lastAssetUrlSignedAt:void 0,removedDefaultTemplateIds:[]};const Zy=e=>{const{removedDefaultTemplateIds:t=[],lastAssetUrlSignedAt:o}=e;let{templates:a=[]}=e;return a=Xy(a),a=((e,t)=>{const o=new Set;e.forEach((e=>{o.add(e.templateId)}));let a=!1;for(const n of Yy){const e=o.has(n.templateId),i=t.includes(n.templateId);if(!e&&!i){a=!0;break}}if(!a)return e;let i=0;const s=e.filter((e=>!qy(e)));return Yy.forEach((e=>{t.includes(e.templateId)||(s.splice(i,0,e),i+=1)})),s})(a,t),a=function(e){const t=[],o=new Set;return e.forEach((e=>{o.has(e.templateId)||(o.add(e.templateId),t.push(e))})),t}(a),{templates:a,removedDefaultTemplateIds:t,lastAssetUrlSignedAt:o}},ev=v({name:"textTemplates",initialState:Qy,reducers:{setTextTemplates:(e,t)=>{const{templates:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{templates:e.templates,undoable:!1}},i={type:t.type,payload:{templates:o,undoable:!1}};ff.add({undo:a,redo:i})}e.templates=o},setTextBrandkitTemplates:(e,t)=>{const{brandkitTemplates:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{brandkitTemplates:e.brandkitTemplates,undoable:!1}},i={type:t.type,payload:{brandkitTemplates:o,undoable:!1}};ff.add({undo:a,redo:i})}e.brandkitTemplates=o},addTextTemplate:(e,t)=>{const{template:o,index:a,undoable:i}=t.payload;if(i){const e={type:"textTemplates/removeTextTemplate",payload:{templateId:o.templateId,undoable:!1}},i={type:t.type,payload:{template:o,index:a,undoable:!1}};ff.add({undo:e,redo:i})}void 0!==a?e.templates.splice(a,0,o):e.templates.push(o)},moveTextTemplate:(e,t)=>{const{srcTemplateId:o,dstTemplateId:a,undoable:i}=t.payload;if(i){const i={type:"textTemplates/setTextTemplates",payload:{templates:e.templates,undoable:!1}},s={type:t.type,payload:{srcTemplateId:o,dstTemplateId:a,undoable:!1}};ff.add({undo:i,redo:s})}if(void 0===e.templates.find((({templateId:e})=>e===o)))return void console.error("Cannot moveTextTemplate, srcTemplate is undefined");const s=e.templates.findIndex((({templateId:e})=>e===a));-1!==s?e.templates=Dg(e.templates,o,s):console.error("Cannot moveTextTemplate, dstTemplateId is not found")},removeTextTemplate:(e,t)=>{const{templateId:o,undoable:a}=t.payload,i=e.templates.findIndex((e=>e.templateId===o)),s=e.templates[i];if(a&&s){const e={type:"textTemplates/addTextTemplate",payload:{template:s,index:i,undoable:!1}},a={type:t.type,payload:{templateId:o,undoable:!1}};ff.add({undo:e,redo:a})}s&&qy(s)&&(e.removedDefaultTemplateIds||(e.removedDefaultTemplateIds=[]),e.removedDefaultTemplateIds.push(o));e.templates=e.templates.filter((e=>e&&e.templateId&&e.templateId!==o))},addTextBrandkitTemplate:(e,t)=>{const{template:o,index:a}=t.payload;void 0!==a?e.brandkitTemplates.splice(a,0,o):e.brandkitTemplates.push(o)},moveTextBrandkitTemplate:(e,t)=>{const{srcTemplateId:o,dstTemplateId:a}=t.payload;if(void 0===e.brandkitTemplates.find((({templateId:e})=>e===o)))return void console.error("Cannot moveTextBrandkitTemplate, srcTemplate is undefined");const i=e.brandkitTemplates.findIndex((({templateId:e})=>e===a));-1!==i?e.brandkitTemplates=Dg(e.brandkitTemplates,o,i):console.error("Cannot moveTextBrandkitTemplate, dstTemplateId is not found")},removeTextBrandkitTemplate:(e,t)=>{const{templateId:o}=t.payload;e.brandkitTemplates=e.brandkitTemplates.filter((e=>e&&e.templateId&&e.templateId!==o))},saveTextTemplateOnExport:(e,t)=>{const{template:o}=t.payload;e.templates=[o,...e.templates.filter((e=>e&&e.templateId&&e.templateId!==o.templateId))]},setLastAssetUrlSignedAt:(e,t)=>{e.lastAssetUrlSignedAt=t.payload}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return{...Qy,...Zy(e)};default:return e}}))}),{setTextTemplates:tv,setTextBrandkitTemplates:ov,addTextTemplate:av,moveTextTemplate:iv,removeTextTemplate:sv,addTextBrandkitTemplate:nv,moveTextBrandkitTemplate:rv,removeTextBrandkitTemplate:lv,saveTextTemplateOnExport:dv,setLastAssetUrlSignedAt:cv}=ev.actions,uv=v({name:"bRoll",initialState:{bRollLayerData:[],bRollAlignment:"center",hoveredBRollId:"",bRollLoadingMsg:"",bRollDragging:!1,replacingBrollLayer:""},reducers:{setHoveredBRollId:(e,t)=>{const{hoveredBRollId:o}=t.payload;e.hoveredBRollId=o},setBRollDragging:(e,t)=>{const{bRollDragging:o}=t.payload;e.bRollDragging=o},setBRollLoadingMsg:(e,t)=>{const{bRollLoadingMsg:o}=t.payload;e.bRollLoadingMsg=o},setReplacingBrollLayer:(e,t)=>{const{newBrollLayer:o}=t.payload;e.replacingBrollLayer=o},setBRollAlignment:(e,t)=>{const{bRollAlignment:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{bRollAlignment:e.bRollAlignment,undoable:!1}},i={type:t.type,payload:{bRollAlignment:o,undoable:!1}};ff.add({undo:a,redo:i})}e.bRollAlignment=o},setBRollLayerData:(e,t)=>{const{bRollLayerData:o,undoable:a}=t.payload;if(a){const a={type:t.type,payload:{bRollLayerData:e.bRollLayerData,undoable:!1}},i={type:t.type,payload:{bRollLayerData:o,undoable:!1}};ff.add({undo:a,redo:i})}e.bRollLayerData=o},addBRollLayerData:(e,t)=>{const{bRollLayerData:o,index:a,undoable:i}=t.payload;if(i){const e={type:"bRoll/removeBRollLayerData",payload:{bRollId:o.bRollId,undoable:!1}},i={type:t.type,payload:{bRollLayerData:o,index:a,undoable:!1}};ff.add({undo:e,redo:i})}void 0!==a?e.bRollLayerData.splice(a,0,o):e.bRollLayerData.push(o)},removeBRollLayerData:(e,t)=>{const{bRollId:o,undoable:a}=t.payload;if(a){const a=e.bRollLayerData.findIndex((e=>e.bRollId===o)),i=e.bRollLayerData[a];if(i){const e={type:"bRoll/addBRollLayerData",payload:{bRollLayerData:i,index:a,undoable:!1}},s={type:t.type,payload:{bRollId:o,undoable:!1}};ff.add({undo:e,redo:s})}}e.bRollLayerData=e.bRollLayerData.filter((e=>e&&e.bRollId&&e.bRollId!==o))},updateBRollLayerData:(e,t)=>{const{bRollLayerData:o,undoable:a}=t.payload;let i;const s=e.bRollLayerData.map((e=>e.bRollId===o.bRollId?(i=e,o):e));if(a&&o&&i){const e={type:t.type,payload:{bRollLayerData:i,undoable:!1}},a={type:t.type,payload:{bRollLayerData:o,undoable:!1}};ff.add({undo:e,redo:a})}e.bRollLayerData=s}}}),{setHoveredBRollId:mv,setBRollDragging:pv,setReplacingBrollLayer:hv,setBRollLoadingMsg:gv,setBRollAlignment:fv,setBRollLayerData:yv,addBRollLayerData:vv,removeBRollLayerData:_v,updateBRollLayerData:wv}=uv.actions,bv={CLOUD_FUNCTIONS_PREFIX:""};function Tv(e){return e.type===zl.Image}function xv(e){return e.type===zl.Video}var Sv=(e=>(e[e.unstarted=0]="unstarted",e[e.errored=1]="errored",e[e.inProgress=2]="inProgress",e[e.onGCSUploadFinish=3]="onGCSUploadFinish",e[e.createAsset=4]="createAsset",e[e.assetCreated=5]="assetCreated",e[e.runConversion=6]="runConversion",e[e.addPendingConversion=7]="addPendingConversion",e[e.updateCompletedUploadInIDB=8]="updateCompletedUploadInIDB",e[e.handleFinish=9]="handleFinish",e[e.done=10]="done",e))(Sv||{}),Ev=(e=>(e.trim="trim",e.smartCut="smart_cut",e.sceneSplit="scene_split",e))(Ev||{}),Iv=(e=>(e.SETTINGS="settings",e.HISTORY="history",e))(Iv||{}),Cv=(e=>(e.Command="command",e.Shift="shift",e.Control="control",e.Option="option",e.Alt="alt",e))(Cv||{}),kv=(e=>(e.background="background",e.gap="gap",e.layer="layer",e.row="row",e.track="track",e.trackpad="trackpad",e))(kv||{}),Av=(e=>(e.File="file",e.Link="link",e))(Av||{}),jv=(e=>(e.CML_FILE="CML_FILE",e.SIDEBAR_IMAGE="SIDEBAR_IMAGE",e.SIDEBAR_VIDEO="SIDEBAR_VIDEO",e.TRANSITION_TILE="TRANSITION_TILE",e.UPLOADING_LAYER="UPLOADING_LAYER",e.MAGIC_SUBTITLE_PRESET="MAGIC_SUBTITLE_PRESET",e.TEXT_PRESET="TEXT_PRESET",e.TEXT_TEMPLATE="TEXT_TEMPLATE",e))(jv||{}),Nv=(e=>(e.BROWSER_WARN="BROWSER_WARN",e))(Nv||{}),Rv=(e=>(e.EyedropperMode="eyedropperMode",e.ImageExport="imageExport",e.Thumbnail="thumbnail",e.None="none",e))(Rv||{});function Pv(e,t){return{type:"ADD_ANIMATION",animationInstance:e,undoable:t}}function Dv(e,t){return{type:"UPDATE_ANIMATION",animationId:e,layerAnim:t,undoable:!0}}function Ov(e,t){return{type:"DELETE_ANIMATION",animationId:e,undoable:t}}function Lv(e,t){return{type:"BULK_DELETE_ANIMATIONS",animationIds:e,undoable:t}}function Fv({layers:e,layerIndex:t,isUndoable:o=!1,fromUndo:a=!1}){return{type:"ADD_LAYERS",layers:e,layerIndex:t,isUndoable:o,fromUndo:a}}function Mv(e,t,o){return{type:"REMOVE_LAYER",layer:e,source:t,undoable:o}}function Uv(e,t,o,a,i,s){return{type:"RESIZE_LAYER",layer:e,x:t,y:o,width:a,height:i,undoable:s}}function Bv(e,t,o,a,i,s,n,r){return{type:"RESIZE_LINE_LAYER",layer:e,x:t,y:o,width:a,height:i,linePointStartCorner:s,lineRightAngle:n,undoable:r}}function Vv(e,t,o){return{type:"SET_SCALE",layer:e,scaleX:t,scaleY:o}}function Wv(e,t,o){return{type:"SET_STUDIO_ROTATION",layer:e,rotation:t,undoable:o}}function Gv(e,t,o){return{type:`SET_STUDIO_FLIP_${{x:"HORIZONTAL",y:"VERTICAL"}[t]}`,layer:e,axis:t,undoable:o}}function Hv(e,t){return{type:"BRING_LAYER_FORWARD",layer:e,undoable:t}}function $v(e,t){return{type:"SEND_LAYER_BACK",layer:e,undoable:t}}function Kv(e,t,o){return{type:"MOVE_LAYER_TO_INDEX",layer:e,targetIndex:t,undoable:o}}function zv(e,t){return{type:"ENHANCE_LAYER",assetId:e,enhanceJobId:t}}function Yv(e,t,o){return{type:"UPDATE_ALL_LAYERS",layers:e,sceneIndex:t,undoable:o}}function Jv(e,t,o=!1){return setTimeout((()=>{(()=>{var e,t,o;const{dispatch:a,state:i}=sr(),s=i.studio.allLayers.byId[(null==(e=i.studio.selectedItem)?void 0:e.id)??""];if(!(null==s?void 0:s.fromTextDefaults)&&s&&"text"===s.type){const e={backgroundColor:s.backgroundColor,borderRadius:s.borderRadius,color:s.color,fontFamily:s.fontFamily,fontSize:s.fontSize,baseWidth:s.baseWidth,baseHeight:s.baseHeight,fontWeight:s.fontWeight,globalAlpha:s.globalAlpha,lineHeight:s.lineHeight,lockAspectRatio:s.lockAspectRatio,italic:s.italic,textAlign:s.textAlign,textTransform:s.textTransform,textShadow:s.textShadow,width:null==(t=s.position)?void 0:t.width,height:null==(o=s.position)?void 0:o.height,underline:s.underline,wrapOrFill:s.wrapOrFill,textPadding:s.textPadding};s.hasCustomFont&&(e.font={type:"custom",asset_id:s.asset_id||"",fontType:s.fontType||"",fontFamily:s.fontFamily||"",url:s.url||"",source:s.source||"upload"}),a(nc(e))}})()}),0),{type:"UPDATE_LAYERS",srcFn:t,updates:e,undoable:o}}function qv(e){return{type:"SELECT_TRANSITION",payload:e,undoable:!1}}function Xv(e){return{type:"SHOW_SNAP_LINES",lines:e}}function Qv(e,t,o,a){return Zv([e],t,o,a)}function Zv(e,t,o,a){return{type:"ADD_LAYERS_TO_GROUP",layerIds:e,groupId:t,isTimelineGroup:o,undoable:a}}function e_(e,t,o){return function(e,t,o){return{type:"REMOVE_LAYERS_FROM_GROUP",layerIds:e,groupId:t,undoable:o}}([e],t,o)}function t_(e,t,o,a){return{type:"SET_LAYER_DESELECTION_IN_GROUP",layerId:e,groupId:t,deselect:o,undoable:a}}function o_(e,t=!0){return{type:"REMOVE_GROUP",groupId:e,undoable:t}}function a_(e,t,o){return{type:"SAVE_LAYER_GROUP",groupId:e,saved:t,undoable:o}}function i_(e){return{type:"SET_SELECTED_TIMELINE_ROWS",timelineRows:e}}function s_(e){return{type:"ADD_SELECTED_TIMELINE_ROWS",timelineRows:e}}function n_(){return{type:"UPDATE_SELECTED_TIMELINE_ROWS"}}function r_(e){return{type:"SET_LAYER_DUPLICATED",layerDuplicated:e}}function l_(e,t=!1){const{state:o}=sr();if(!o.userPermissions.canWrite)return{type:"SELECT_ITEM",item:null,undoable:!1};return{type:"SELECT_ITEM",item:"magicSubtitle"===(null==e?void 0:e.type)?{...e,frames:{allFrames:e.frames,byId:e.frames.reduce(((e,t)=>(e[t.id]=t,e)),{})}}:e,undoable:t}}var d_=(e=>(e.ADD_IDB_ASSET_IDS="ADD_IDB_ASSET_IDS",e.ADD_TEXT_LAYER_ID_ADDED_IN_SESSION="ADD_TEXT_LAYER_ID_ADDED_IN_SESSION",e.ALT_IS_BEING_PRESSED="ALT_IS_BEING_PRESSED",e.CLEAR_DRAG_PREVIEW_DISPLACEMENTS="CLEAR_DRAG_PREVIEW_DISPLACEMENTS",e.CLEAR_IDB_ASSET_IDS="CLEAR_IDB_ASSET_IDS",e.COMMAND_IS_BEING_PRESSED="COMMAND_IS_BEING_PRESSED",e.CONTROL_IS_BEING_PRESSED="CONTROL_IS_BEING_PRESSED",e.REMOVE_IDB_ASSET_ID="REMOVE_IDB_ASSET_ID",e.SET_BOX_SELECTED_IDS="SET_BOX_SELECTED_IDS",e.SET_DRAG_PREVIEW_DISPLACEMENTS="SET_DRAG_PREVIEW_DISPLACEMENTS",e.SET_DRAGGED_TRACKS_OVERRIDES="SET_DRAGGED_TRACKS_OVERRIDES",e.SET_IDB_ASSET_IDS="SET_IDB_ASSET_IDS",e.SET_INITIAL_IDB_ASSET_ID_LOAD_DONE="SET_INITIAL_IDB_ASSET_ID_LOAD_DONE",e.SET_IS_NEW_PROJECT="SET_IS_FIRST_EDIT",e.SET_LOCAL_ASSET_VALUES="SET_LOCAL_ASSET_VALUES",e.SET_LOCAL_LAYER_VALUES="SET_LOCAL_LAYER_VALUE",e.BATCHED_SET_LOCAL_LAYER_VALUES="BATCHED_SET_LOCAL_LAYER_VALUES",e.SET_IS_INLINE_CROPPING="SET_IS_INLINE_CROPPING",e.SET_MEDIA_ITEM_DRAG_OFFSET="SET_MEDIA_ITEM_DRAG_OFFSET",e.SET_MEDIA_ITEM_GHOST_TRACK="SET_MEDIA_ITEM_GHOST_TRACK",e.SET_MEDIA_ITEM_LOCATION="SET_MEDIA_ITEM_LOCATION",e.SET_MEDIA_LIBRARY_SELECTED_TAB="SET_MEDIA_LIBRARY_SELECTED_TAB",e.SET_MOUSE_DOWN="SET_MOUSE_DOWN",e.SET_PROJECT_FETCHED="SET_PROJECT_FETCHED",e.SET_SELECTED_EDITOR_PANE="SET_SELECTED_EDITOR_PANE",e.SET_SHADOW_INFOS="SET_SHADOW_INFOS",e.SET_SHOW_TRANSCRIBE="SET_SHOW_TRANSCRIBE",e.SET_SNAP_TIMELINE_TO_SEEKER="SET_SNAP_TIMELINE_TO_SEEKER",e.SET_STUDIO_DRAG_DROP_ACTIVE="SET_STUDIO_DRAG_DROP_ACTIVE",e.SET_MAIN_STUDIO_DRAG_DROP_DISABLED="SET_MAIN_STUDIO_DRAG_DROP_DISABLED",e.SET_TIMELINE_CONTAINER_HEIGHT="SET_TIMELINE_CONTAINER_HEIGHT",e.SET_TIMELINE_CONTAINER_WIDTH="SET_TIMELINE_CONTAINER_WIDTH",e.SET_TRACK_THUMBNAIL_FALLBACK="SET_TRACK_THUMBNAIL_FALLBACK",e.SET_VOLUME_SLIDER_IS_DRAGGING="SET_VOLUME_SLIDER_IS_DRAGGING",e.SHIFT_IS_BEING_PRESSED="SHIFT_IS_BEING_PRESSED",e.START_EDITING_TEXT_LAYER="START_EDITING_TEXT_LAYER",e.UPDATE_SHADOW_INFOS="UPDATE_SHADOW_INFOS",e.SET_INFO_TOAST_SHOWN_THIS_SESSION="SET_INFO_TOAST_SHOWN_THIS_SESSION",e.SET_PREVIEW_PLAYING="SET_PREVIEW_PLAYING",e.SET_MEDIA_SIDEBAR_SELECTED_TAB="SET_MEDIA_SIDEBAR_SELECTED_TAB",e.SHOW_SIGN_IN="SHOW_SIGN_IN",e.HIDE_SIGN_IN="HIDE_SIGN_IN",e.SET_AWAITING_RECORDINGS="SET_AWAITING_RECORDINGS",e.SET_PREVIEW_TRACK="SET_PREVIEW_TRACK",e.SET_PREVIEW_TIMELINE_STATE="SET_PREVIEW_TIMELINE_STATE",e.SET_ROW_UPLOAD_IN_PROGRESS="SET_ROW_UPLOAD_IN_PROGRESS",e.CLEAR_PROJECT_FETCHED="CLEAR_PROJECT_FETCHED",e.SET_GHOST_SEEKER_OFFSET="SET_GHOST_SEEKER_OFFSET",e.SET_STATIC_UPLOAD_IDS="SET_STATIC_UPLOAD_IDS",e.SET_MOBILE_TRAY_CONTENT="SET_MOBILE_TRAY_CONTENT",e.SET_GROUP_DRAG_OVERRIDES="SET_GROUP_DRAG_OVERRIDES",e.CLEAR_GROUP_DRAG_OVERRIDES="CLEAR_GROUP_DRAG_OVERRIDES",e.SYNC_ATTEMPTED="SYNC_ATTEMPTED",e.SYNC_SUCCEEDED="SYNC_SUCCEEDED",e.SET_IS_ADDING="SET_IS_ADDING",e.PLAYBACK_RATE="PLAYBACK_RATE",e.UPDATE_MAGIC_SUBTITLE_LOCAL="UPDATE_MAGIC_SUBTITLE_LOCAL",e.CLEAR_MAGIC_SUBTITLE_LOCAL="CLEAR_MAGIC_SUBTITLE_LOCAL",e.SET_MAGIC_SUBTITLE_SELECTION="SET_MAGIC_SUBTITLE_SELECTION",e.SET_MAGIC_SUBTITLE_FOCUS="SET_MAGIC_SUBTITLE_FOCUS",e.RESIZE_MEDIABAR="RESIZE_MEDIABAR",e.RESIZING_MEDIABAR="RESIZING_MEDIABAR",e.UPDATE_LAST_GENERATED_THUMBNAIL="UPDATE_LAST_GENERATED_THUMBNAIL",e.SET_SHOW_REPORT_ISSUE_MODAL="SET_SHOW_REPORT_ISSUE_MODAL",e.SET_LOCAL_MAGIC_SUBTITLE_FRAMES="SET_LOCAL_MAGIC_SUBTITLE_FRAMES",e.SET_LAYER_MOUNTED_STATE="SET_LAYER_MOUNTED_STATE",e.SET_ASSET_MONITOR_ID="SET_ASSET_MONITOR_ID",e.UPDATE_DALLE_TEMP_VALUES="UPDATE_DALLE_TEMP_VALUES",e.SET_AI_TOOLS_DATA="SET_AI_TOOLS_DATA",e.SET_ARTICLE_TO_VIDEO_DATA="SET_ARTICLE_TO_VIDEO_DATA",e.SET_ARTICLE_TO_VIDEO_OUTLINE_SLIDE="SET_ARTICLE_TO_VIDEO_OUTLINE_SLIDE",e.SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR="SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR",e.SET_MAGIC_CREATE_OVERLAY_OPEN="SET_MAGIC_CREATE_OVERLAY_OPEN",e.SET_TRACK_IS_DRAGGING="SET_TRACK_IS_DRAGGING",e))(d_||{});function c_(e,t){return{type:"SET_LOCAL_ASSET_VALUES",assetId:e,properties:t}}function u_(e,t){return{type:"SET_LOCAL_LAYER_VALUE",layerId:e,properties:t}}function m_(e){return{type:"BATCHED_SET_LOCAL_LAYER_VALUES",updates:e}}const p_=(e,t)=>({type:"SET_IS_INLINE_CROPPING",layerId:e,isInlineCropping:t});function h_(){return{type:"SET_PROJECT_FETCHED"}}function g_(){return{type:"CLEAR_PROJECT_FETCHED"}}function f_(e){const{dispatch:t}=sr();return t(qv(null)),{type:"SET_SELECTED_EDITOR_PANE",selectedEditorPane:e}}function y_(e){return{showTranscribe:e,type:"SET_SHOW_TRANSCRIBE"}}function v_(e){return{type:"SET_SNAP_TIMELINE_TO_SEEKER",snapTimelineToSeeker:e}}function __(e){return{studioDragDropActive:e,type:"SET_STUDIO_DRAG_DROP_ACTIVE"}}function w_(e){return{mainStudioDragDropDisabled:e,type:"SET_MAIN_STUDIO_DRAG_DROP_DISABLED"}}function b_(e){return{type:"SET_DRAGGED_TRACKS_OVERRIDES",overrides:e}}function T_(e,t){let o;switch(e){case Cv.Command:o="COMMAND_IS_BEING_PRESSED";break;case Cv.Shift:o="SHIFT_IS_BEING_PRESSED";break;case Cv.Control:o="CONTROL_IS_BEING_PRESSED";break;case Cv.Option:default:o="ALT_IS_BEING_PRESSED"}return{type:o,isPressed:t}}function x_(e){return{type:"ADD_IDB_ASSET_IDS",idbAssetIds:e}}function S_(e){return{type:"SET_VOLUME_SLIDER_IS_DRAGGING",isDragging:e}}function E_(e){return{type:"SET_MEDIA_ITEM_GHOST_TRACK",track:e}}function I_(e){return{type:"SET_MEDIA_ITEM_LOCATION",location:e}}function C_(e){return{type:"SET_TRACK_THUMBNAIL_FALLBACK",mediaCacheId:e}}const k_=O("SET_INITIAL_IDB_ASSET_ID_LOAD_DONE"),A_=O("SET_IS_FIRST_EDIT"),j_=O("START_EDITING_TEXT_LAYER"),N_=O("SET_MEDIA_SIDEBAR_SELECTED_TAB");const R_=O("SET_MOUSE_DOWN"),P_=O("CLEAR_DRAG_PREVIEW_DISPLACEMENTS"),D_=O("SET_DRAG_PREVIEW_DISPLACEMENTS"),O_=O("SET_INFO_TOAST_SHOWN_THIS_SESSION"),L_=O("SET_PREVIEW_PLAYING");function F_(){return{type:"SHOW_SIGN_IN"}}const M_=O("SET_AWAITING_RECORDINGS");function U_(e){return{type:"SET_PREVIEW_TIMELINE_STATE",timelineState:e}}const B_=O("SET_PREVIEW_TRACK"),V_=O("SET_ROW_UPLOAD_IN_PROGRESS"),W_=O("SET_GHOST_SEEKER_OFFSET"),G_=O("SET_STATIC_UPLOAD_IDS"),H_=O("SET_MOBILE_TRAY_CONTENT"),$_=O("SET_BOX_SELECTED_IDS"),K_=O("SET_GROUP_DRAG_OVERRIDES"),z_=O("CLEAR_GROUP_DRAG_OVERRIDES"),Y_=O("SYNC_ATTEMPTED"),J_=O("SYNC_SUCCEEDED"),q_=O("SET_IS_ADDING"),X_=O("PLAYBACK_RATE"),Q_=O("UPDATE_MAGIC_SUBTITLE_LOCAL"),Z_=O("CLEAR_MAGIC_SUBTITLE_LOCAL"),ew=O("SET_MAGIC_SUBTITLE_SELECTION"),tw=O("SET_MAGIC_SUBTITLE_FOCUS"),ow=O("RESIZE_MEDIABAR"),aw=O("RESIZING_MEDIABAR"),iw=O("SET_SHOW_REPORT_ISSUE_MODAL"),sw=O("SET_LOCAL_MAGIC_SUBTITLE_FRAMES"),nw=O("SET_LAYER_MOUNTED_STATE"),rw=O("SET_ASSET_MONITOR_ID"),lw=e=>({type:"UPDATE_DALLE_TEMP_VALUES",...e}),dw=e=>({type:"SET_MAGIC_CREATE_OVERLAY_OPEN",open:e}),cw=e=>({type:"SET_AI_TOOLS_DATA",payload:e}),uw=e=>({type:"SET_ARTICLE_TO_VIDEO_DATA",payload:e}),mw=e=>({type:"SET_ARTICLE_TO_VIDEO_OUTLINE_SLIDE",payload:e}),pw=O("SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR"),hw=O("SET_TRACK_IS_DRAGGING");function gw(e){var t;const o={};for(const a in e)if(!["scenes"].includes(a))if("allLayers"===a){const t=s.cloneDeep(e.allLayers);(null==t?void 0:t.byId)&&Object.values(t.byId).forEach((e=>{delete e.local_url})),o.allLayers=t}else o[a]=e[a];if("scenes"in e){o.scenes=[];for(const a of e.scenes)if(a){o.scenes.push(a.id),o[`scene_${a.id}`]={},o[`scene_${a.id}_layers`]=[];for(const e in a)"layers"!==e&&(o[`scene_${a.id}`][e]=a[e]);for(const e of a.layers){if(!e)continue;const i=s.cloneDeep(e);delete i.local_url,o[`layer_${e.id}`]=i,null==(t=o[`scene_${a.id}_layers`])||t.push(e.id)}}}return s.cloneDeep(o)}let fw=0,yw=0,vw=0,_w=0,ww=!1,bw=0;const Tw=()=>{yw=0},xw=e=>{ww!==e&&(ww=e,bw=performance.now())},Sw=()=>{_w=performance.now()},Ew=()=>{const e=performance.now();return{appSession:Lu,amplitudeSession:null==(o=null==(t=null==amplitude?void 0:amplitude.getInstance())?void 0:t.getSessionId)?void 0:o.call(t),sessionDuration:e,timeSinceLastOpSent:e-vw,timeSinceLastOpReceived:e-_w,globalOpCounter:fw,projectOpCounter:yw,wsConnected:ww,timeSinceWsConnectedChanged:e-bw};var t,o};let Iw=Math.random()<.15,Cw=!1,kw=null,Aw=null,jw={};const Nw=(e,t=!0)=>{if(Cw)return;if(null==Aw||void 0!==jw[e])return void console.assert(null!=Aw,`${e} finished loading before the studio started?`);if(jw[e]=t||"studio"===e?performance.now()-Aw:null,void 0===jw.canvas||void 0===jw.studio||void 0===jw.thumbnails||void 0===jw.waveforms)return;Cw=!0;const o=Math.max(...Object.values(jw).filter((e=>!!e))),a={"Remote Reedit":kw,"First Contentful Paint":o,"First Input Delay":jw.studio,"Canvas loaded (ms)":jw.canvas,"Waveforms loaded (ms)":jw.waveforms,"Thumbnails loaded (ms)":jw.thumbnails};console.debug(ym.KAPWING_STARTUP_FINISHED,a),Iw&&Fm(ym.KAPWING_STARTUP_FINISHED,a)};let Rw;function Pw(e,t){const o=function(e,t){const o={cv:"0.9",submittedAt:Date.now(),...Ew(),...t};return{...e,__md:o,__localMd:{id:P()}}}(s.cloneDeep(e),t);fw+=1,yw+=1;const{sharedDoc:a}=window;(null==a?void 0:a.opsDisabled)||(zd.push(o),null==Rw&&(Rw=setTimeout((()=>{if(Rw=void 0,window.sharedDoc){const e=zd.dequeueAll();Dw(e,"live",(()=>{for(const t of e)zd.removePending(t)}))}else kr()||console.debug("sharedDoc is unavailable. can't submit ops")}))))}function Dw(e,t,o){Ww();const{sharedDoc:a}=window;if(!a)return console.debug("sharedDoc is unavailable. can't submit ops"),!1;kr()||console.debug("submitting ",e.length,"ops");const i=Array.from(e,(e=>s.omit(e,"__localMd")));return a.submitOp(i,void 0,(a=>{a?function(e,t,o={}){var a;const i=e.message.includes("Version mismatch");i&&(window.sharedDoc.opsDisabled=!0);const s=t.slice(0,10),n=!!(null==(a=null==e?void 0:e.message)?void 0:a.includes("Permission denied"));console.error("Failed to submit op.",e,t),n||(e instanceof Error?R(e,{extra:{opsCount:t.length,ops:s},tags:{...o,versionMismatch:i}}):f("Failed to submit op",{extra:{error:e,opsCount:t.length,ops:s},tags:{...o,versionMismatch:i}}))}(a,e,{isSyncOfflineOps:"offline"===t}):(Gw(),vw=performance.now()),o()})),!0}function Ow(e=1e4){if(!window.sharedDoc)return Promise.reject(new Error("Sharedb is not connected"));const t=s.cloneDeep((null==zd?void 0:zd.getAllPendingOps())??[]);if(!zd||!t.length)return Promise.resolve([]);kr()||console.debug(`Submitting ${t.length} offline ops`);for(const a of t)a.__md.offlineOpSubmittedAt=Date.now();const o=new Promise((e=>Dw(t,"offline",(()=>e())))).then((()=>{for(const e of t)zd.removePending(e)}));return Promise.race([o,Cr(e)])}function Lw({path:e,val:t,oldVal:o,srcFn:a,skipLastUpdated:i}){(t||t!==o)&&Pw({p:e,od:o,oi:t},{srcFn:a,skipLastUpdated:i})}function Fw(e,t,o,a,i){JSON.stringify(o)!==JSON.stringify(t)&&Pw({p:[e],od:o,oi:t},{srcFn:a,skipLastUpdated:i})}function Mw(e,t,o,a,i,s){if(a===o)return;Pw({p:[e,t],od:a,oi:o},{srcFn:i,skipLastUpdated:s})}function Uw(e,t,o,a,i){return Mw(e,t,o,a,i)}function Bw(e,t,o,a){Pw({p:[e,t],od:o},{srcFn:a})}function Vw(e,t,o,a){0===Object.keys(e.presence||{}).length?Lw({path:["presence"],val:{[o]:t},oldVal:e.presence,srcFn:a,skipLastUpdated:!0}):Lw({path:["presence",o],val:t,oldVal:e.presence[o]||{},srcFn:a,skipLastUpdated:!0})}const Ww=s.throttle((()=>{setTimeout((()=>{sr().dispatch(Y_("websocket"))}))}),5e3),Gw=s.throttle((()=>{setTimeout((()=>{sr().dispatch(J_("websocket"))}))}),5e3);function Hw(e){return{type:"SET_MOUSE_POSITION_TOOLTIP",mousePosition:e}}function $w(){return{type:"CLEAR_MOUSE_POSITION_TOOLTIP"}}const Kw={user:{},token:""},zw=e=>{const t=31536e3;(new d).set("ssrSignedInCookie",e,{path:"/",expires:new Date(Date.now()+31536e6),maxAge:t,secure:!0})},Yw=e=>{L(null!=e?{id:e._id,email:e.email,segment:Jm(e)??void 0,accountType:""}:null)},Jw={currentTemplate:(e={},t)=>"SET_CURRENT_TEMPLATE"===t.type?t.currentTemplate:e,exampleVideos:(e=[],t)=>"SET_TEMPLATE_EXAMPLE_VIDEOS"===t.type?t.exampleVideos:e,parentId:(e="",t)=>{switch(t.type){case"SET_PARENT_ID":return t.parentId||"";case"RESET_EDITOR":return"";default:return e}},templateSource:(e="",t)=>"SET_TEMPLATE_SOURCE"===t.type?t.source:e,templates:(e=[],t)=>{switch(t.type){case"SET_TEMPLATES":return t.templates;case"APPEND_TEMPLATES":{const o=[],a=new Set;return[...e,...t.templates].forEach((e=>{a.has(e._id)||(a.add(e._id),o.push(e))})),o}case"RESET_EDITOR":return[];default:return e}}},qw={numPostsForCurrentCategory:(e=0,t)=>{switch(t.type){case"SET_NUM_POSTS_FOR_CURRENT_CATEGORY":return t.numPosts;case"RESET_CATEGORIES":case"RESET_EDITOR":return 0;default:return e}}},Xw={currentPost:(e={},t)=>"SET_CURRENT_POST"===t.type?t.currentPost:e,postsForCurrentCategory:(e=[],t)=>{switch(t.type){case"SET_CATEGORY_POSTS":return t.posts;case"RESET_CATEGORIES":case"RESET_EDITOR":return[];default:return e}}};var Qw=(e=>(e[e.GRID_VIEW=0]="GRID_VIEW",e[e.LIST_VIEW=1]="LIST_VIEW",e))(Qw||{}),Zw=(e=>(e[e.PROJECT_NAME=0]="PROJECT_NAME",e[e.DATE_EDITED=1]="DATE_EDITED",e[e.DATE_CREATED=2]="DATE_CREATED",e[e.LAST_EDITOR=3]="LAST_EDITOR",e))(Zw||{}),eb=(e=>(e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING",e))(eb||{}),tb=(e=>(e[e.WORKSPACE=0]="WORKSPACE",e[e.INVITE=1]="INVITE",e[e.ROLE=2]="ROLE",e))(tb||{});const ob=v({initialState:{allWorkspaces:[],workspaceMenuVisible:!1,showUploadDialog:!1,showDragUploadDialog:!1,selectedWorkspace:"",workspaceUploads:{},setSharedWorkspaceOwnerEmail:"",workspaceOwnerEmail:"",sharedWorkspaceId:"",selectionMode:!1,currentFolderSettings:{view:Qw.GRID_VIEW,sortField:Zw.DATE_CREATED,sortOrder:eb.ASCENDING},SWMFolderSettings:{view:Qw.LIST_VIEW,sortField:Zw.DATE_EDITED,sortOrder:eb.ASCENDING},suggestedWorkspaces:{isQualifiedDomain:!1,teams:[]},isFetchingFolders:!1},name:"workspaces",reducers:{setWorkspaces:(e,t)=>{e.allWorkspaces=t.payload},setCurrentFolder:(e,t)=>{e.selectedWorkspace=t.payload},removeWorkspace:(e,t)=>{e.allWorkspaces=e.allWorkspaces.filter((e=>e._id!==t.payload)),e.selectedWorkspace=e.selectedWorkspace===t.payload?"":e.selectedWorkspace},changeFolderNameLocal:(e,t)=>{const o=e.allWorkspaces.findIndex((e=>e._id===t.payload.workspaceId)),a=e.allWorkspaces[o];a&&(a.name=t.payload.newName)},setShowUploadDialog:(e,t)=>{e.showUploadDialog=t.payload},addWorkspaceUpload:(e,t)=>{const{folderId:o,uploadId:a,assetId:i}=t.payload,s=i&&{assetId:i}||a&&{uploadId:a}||null;e.workspaceUploads||(e.workspaceUploads={}),s&&(e.workspaceUploads[o]=[...e.workspaceUploads[o]??[],s])},removeWorkspaceUpload:(e,t)=>{var o;const{folderId:a,uploadId:i,assetId:s}=t.payload;e.workspaceUploads||(e.workspaceUploads={}),e.workspaceUploads[a]=(null==(o=e.workspaceUploads[a])?void 0:o.filter((e=>i&&e.uploadId!==i||s&&e.assetId!==s)))??[]},clearWorkspaceUploads:e=>{e.workspaceUploads={}},setSelectionMode:(e,t)=>{e.selectionMode=t.payload},setCurrentFolderSettings:(e,t)=>{e.currentFolderSettings=t.payload},setSWMFolderSettings:(e,t)=>{e.SWMFolderSettings=t.payload},updateWorkspaceFonts:(e,t)=>{const o=e.allWorkspaces.findIndex((e=>e._id===t.payload.workspaceId)),a=e.allWorkspaces[o];a&&(t.payload.recentlyUsedFonts&&(a.recentlyUsedFonts=[...t.payload.recentlyUsedFonts]),t.payload.customFonts&&(a.customFonts=[...t.payload.customFonts,...a.customFonts||[]]))},setSuggestedWorkspaces:(e,t)=>{e.suggestedWorkspaces=t.payload},setIsFetchingFolders:(e,t)=>{e.isFetchingFolders=t.payload}}}),{setWorkspaces:ab,setCurrentFolder:ib,removeWorkspace:sb,changeFolderNameLocal:nb,setShowUploadDialog:rb,addWorkspaceUpload:lb,removeWorkspaceUpload:db,clearWorkspaceUploads:cb,setSelectionMode:ub,setCurrentFolderSettings:mb,setSWMFolderSettings:pb,updateWorkspaceFonts:hb,setSuggestedWorkspaces:gb,setIsFetchingFolders:fb}=ob.actions;function yb(e,t,o=!1){return{type:"UPDATE_SCENE",scene:e,properties:t,undoable:o}}function vb(){const{state:e}=sr(),t=e.currentUser.user._id;return"trim"===e.studio.origin||"cut-video"===e.studio.origin?{type:"DISABLE_SNAP_IN_TIMELINE",userId:t}:{type:"ENABLE_SNAP_IN_TIMELINE",userId:t}}function _b(){const{state:e}=sr();return{type:"ENABLE_SNAP_IN_TIMELINE",userId:e.currentUser.user._id}}function wb(){const{state:e}=sr();return{type:"DISABLE_SNAP_IN_TIMELINE",userId:e.currentUser.user._id}}function bb(e){return{type:"SET_VIDEO_TYPE",videoType:e}}function Tb(e){return{type:"SET_IMAGE_TYPE",imageType:e}}function xb(e){return{type:"SET_GIF_TYPE",gifType:e}}function Sb(e){return{type:"SET_EXPORT_FRAME_TIME",exportFrameTime:e}}function Eb(e){return{type:"SET_QUALITY",quality:e}}function Ib(e,t){const{state:o}=sr();return{type:"SET_USER_SPECIFIC_SETTING",key:e,value:t,userId:o.currentUser.user._id}}M();const Cb=async e=>{const{state:t,dispatch:o}=sr();if("pending"!==t.CMLFiles.removeFromMyMediaFetchStatuses[e])try{o(Ab.actions.removeFromMyMediaUpdate({cmlFileId:e,status:"pending"})),await zr(`/api/v1/cloudMediaLibrary/myMedia/${e}`),o(Ab.actions.removeFromMyMediaUpdate({cmlFileId:e,status:"fulfilled"}))}catch(a){console.error(a),o(Ab.actions.removeFromMyMediaUpdate({cmlFileId:e,status:"rejected"}))}},kb=async()=>{const{state:e,dispatch:t}=sr();if("pending"!==e.CMLFiles.removeAllMyMediaFetchStatus)try{t(Ab.actions.removeAllMyMediaUpdate("pending")),await zr("/api/v1/cloudMediaLibrary/myMedia"),t(Ab.actions.removeAllMyMediaUpdate("fulfilled"))}catch(o){console.error(o),t(Ab.actions.removeAllMyMediaUpdate("rejected"))}},Ab=v({initialState:{byId:{},initializingCMLFromIDB:!1,myMediaIds:new Set,myMediaInitialized:!1,promptRemoveFiles:null,removeFromMyMediaFetchStatuses:{},removeAllMyMediaFetchStatus:null,toUploadId:{}},name:"CMLFiles",reducers:{addToMyMedia:(e,t)=>{e.myMediaIds=new Set([...e.myMediaIds,...t.payload]),e.myMediaInitialized=!0},filesFetched:(e,t)=>{for(const o of t.payload)e.byId[o.id]=o},linkToUploadId:(e,t)=>{e.toUploadId[t.payload.cmlFileId]=t.payload.uploadId},initializingCMLFromIDBStart:e=>{e.initializingCMLFromIDB=!0},initializingCMLFromIDBComplete:e=>{e.initializingCMLFromIDB=!1},promptRemove:(e,t)=>{e.promptRemoveFiles=t.payload},promptRemoveCompleted:e=>{e.promptRemoveFiles=null},changeCMLFileName:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].fileName=t.payload.newFileName)},updateLocalCMLFileModifiedDate:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].modified=t.payload.modified.toISOString())},removeAllMyMediaUpdate:(e,t)=>{e.removeAllMyMediaFetchStatus=t.payload,"fulfilled"===t.payload&&(e.myMediaIds=new Set)},removeFromMyMediaUpdate:(e,t)=>{e.removeFromMyMediaFetchStatuses[t.payload.cmlFileId]=t.payload.status,"fulfilled"===t.payload.status&&e.myMediaIds.delete(t.payload.cmlFileId)}}}),{addToMyMedia:jb,filesFetched:Nb,initializingCMLFromIDBComplete:Rb,initializingCMLFromIDBStart:Pb,linkToUploadId:Db,promptRemove:Ob,promptRemoveCompleted:Lb,updateLocalCMLFileModifiedDate:Fb,changeCMLFileName:Mb}=Ab.actions;function Ub(e){setTimeout((()=>{e()}))}async function Bb(){return await Yr("/api/v1/cloudMediaLibrary/myMedia")}async function Vb(e){return await Yr(`/api/v1/cloudMediaLibrary/file/${e}`)}async function Wb(e){return await Jr("/api/v1/cloudMediaLibrary/getFilesAndAssets",{body:{cmlFileIds:e}})}async function Gb(e,t){Ub((()=>Jr(`/api/v1/cloudMediaLibrary/file/${e}/linkedVideo/${t}`).catch(console.error)))}async function Hb(e,t){Ub((()=>Jr(`/api/v1/cloudMediaLibrary/linkFilesToProject/${t}`,{body:{cmlFileIds:e}}).catch(console.error)))}async function $b(e,t){return await Jr("/api/v1/cloudMediaLibrary/filesFromAssets",{body:{assetIds:e,linkToUser:t}})}async function Kb(e,t){return await Jr(`/api/v1/cloudMediaLibrary/file/${e}/conversionFinished`,{body:{convertedAssetId:t}})}async function zb(e,t){return await Xr("/api/v1/cloudMediaLibrary/updateFileName",{body:{cmlFileID:e,newFileName:t}})}const Yb={commentsLoading:!0},Jb=v({initialState:Yb,name:"comments",reducers:{setComments:(e,t)=>{e.comments=t.payload},setSelectedCommentId:(e,t)=>{e.selectedCommentId=t.payload},setCommentsOpen:(e,t)=>{e.commentsOpen=t.payload},setCommentsLoading:(e,t)=>{e.commentsLoading=t.payload},addComment:(e,t)=>{e.comments=e.comments?[...e.comments,t.payload]:[t.payload]},editComment:(e,t)=>{var o;const{commentId:a,updates:i}=t.payload,s=null==(o=e.comments)?void 0:o.map((e=>e._id===a?{...e,...i}:e));e.comments=s},deleteComment:(e,t)=>{var o;const a=t.payload,i=null==(o=e.comments)?void 0:o.filter((e=>e._id!==a));e.comments=i}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return Yb;case"SET_STUDIO":return t.projectIdChanged?Yb:e;case"SELECT_ITEM":return t.item&&(e.selectedCommentId="",e.commentsOpen=!1),e;default:return e}}))}),{setComments:qb,setSelectedCommentId:Xb,setCommentsOpen:Qb,setCommentsLoading:Zb,addComment:eT,editComment:tT,deleteComment:oT}=Jb.actions;function aT(e){var t;return(null==(t=ay(e))?void 0:t.a)??1}function iT(e,t){const o=ay(e);if(!o)return e;const{r:a,g:i,b:s}=o;let n=String(t);return n.length>5&&(n=t.toFixed(3)),`rgba(${a},${i},${s},${n})`}function sT(e){if("none"===e)return!0;if(e&&!e.startsWith("rgb"))return!1;const t=oy(e);return!t||0===t.a}function nT(e,t){if(t&&t.textShadow&&"black"!==t.textShadow&&"white"!==t.textShadow)return"transparent";const o=ay(e);if(!o)return"black";const{r:a,g:i,b:s}=o,n=[a,i,s];return Math.round((299*n[0]+587*n[1]+114*n[2])/1e3)>125?"black":"white"}const rT="background-asset",lT=e=>{var t;return null==(t=e.magicSubtitleFramesByAsset)?void 0:t["background-asset"]},dT=["hidden","local_url","removeBgPreviewUrl"],cT=["duration","startTime","endTime","videoDelay"];function uT(e,t,o,a,i,n=!0){const r=`${"scene"===a?"scene":"layer"}_${t}`;let l;return[e.map((e=>e.id!==t?e:(Object.keys(o).forEach((t=>{if(cT.includes(t)){const e=o[t];null!=e&&(o[t]=Number(e))}dT.includes(t)||!n||s.isEqual(o[t],e[t])||Mw(r,t,o[t],e[t],`${i}/editSegment`)})),l={...e,...o},l))),l]}function mT(e,t,o){const a=[];return t.layers.forEach(((i,s)=>{i.id!==e.id?a.push(i):function(e,t,o,a){Pw({p:[`scene_${o.id}_layers`,e],ld:t.id},{srcFn:a}),Pw({p:[`layer_${t.id}`],od:t},{srcFn:a})}(s,i,t,`removeLayerHelper/${o}`)})),a}function pT(e,t){const{axis:o}=t;let a=t.layer.position;for(const i of e)if(i.id===t.layer.id){"position"in i&&(a=i.position);break}return a.flip||(a.flip={x:!1,y:!1}),uT(e,t.layer.id,{position:{...a,flip:{...a.flip,[o]:!a.flip[o]}}},"layer","setFlip")}function hT(e,t,o){const a=e.layers.map((e=>e.id)).indexOf(t.id),i=a+o,s=`scene_${e.id}_layers`;if(i<=e.layers.length-1){!function(e,t,o,a){Pw({p:[e,t],lm:o},{srcFn:a})}(s,a,i,"reorderLayer");return n=e.layers,r=a,l=i,n.reduce(((e,t,o,a)=>{if(r===l&&e.push(t),o===r)return e;if(r<l&&e.push(t),o===l){const t=a[r];t&&e.push(t)}return r>l&&e.push(t),e}),[])}var n,r,l;return e.layers}function gT(e,t){return Object.values(e).findIndex((e=>e.id===t))}function fT(e,t){return t.allLayers.byId[e]}function yT(e,t){const o=t.scenes[0];if(!o)return[];const a=[],{layers:i}=o,{layers:s}=e;for(const n of s){const e=i.find((({id:e})=>e===n.id));e&&void 0!==e.timelineRow&&(a.includes(e.timelineRow)||a.push(e.timelineRow))}return a.sort()}function vT(e,t){const o=t.scenes[0];if(!o)return[];let a=[];const{layers:i}=o;if(!e)return[];if("group"===e.type){const o=t.groups[e.id];if(!o)return[];a=yT(o,t)}else if("gap"===e.type)t.timelineGap&&t.timelineGap.gapId===e.id&&a.push(t.timelineGap.timelineRow);else if("layer"===e.type){const t=i.find((({id:t})=>t===e.id));t&&void 0!==t.timelineRow&&a.push(t.timelineRow)}return a}function _T(e,t){let o=0;for(const a of e)a.duration&&(o+=Number(a.duration));if(null==t?void 0:t.byId)for(const a of Object.values(t.byId))a&&a.end>o&&(o=a.end);return o}function wT(e,t,o){if(!((e,t)=>{var o;if("gif"===e.videoType)return!0;if(0===t){for(const t of(null==(o=e.scenes[0])?void 0:o.layers)||[])if("image/gif"===t.mime||"image/gif"===t.content_type)return!1;return!0}return!1})(e,t))for(const a of o)a.background===ey&&(a.background="#FFFFFF")}function bT(e,{asset_id:t,cmlFileId:o}){e.thisProjectCMLFiles||(e.thisProjectCMLFiles={},Fw("thisProjectCMLFiles",{},void 0,"linkCMLFileToThisProject"));const a=e.thisProjectCMLFiles[o],i={addedTimestamp:Date.now(),asset_id:t,cmlFileId:o};e.thisProjectCMLFiles[o]=i,Uw("thisProjectCMLFiles",o,i,a,"linkCMLFileToThisProject")}function TT(e,t){if(!e.thisProjectCMLFiles)return;const o=e.thisProjectCMLFiles[t];delete e.thisProjectCMLFiles[t],function(e,t,o,a){Bw(e,t,o,a)}("thisProjectCMLFiles",t,o,"unlinkAssetFromThisProject")}const xT=(e,t,o,a)=>{let i,s=null;const n="FORWARDS"===a?1:-1;for(i="FORWARDS"===a?o+1:o-1;"FORWARDS"===a?i<=t.length-1:i>=0;i+=n){const o=t[i],a=Object.entries(e.groups).find((([e,t])=>t.layers.find((e=>e.id===(null==o?void 0:o.id)))));if(!a)break;{const[e]=a;if(s){if(e!==s)break}else s=e}}return s&&(i-=n),i},ST=(e,t)=>{const o={...e.groups},a=o[t];if(!a)throw Error("Group not found");const i={...a},s={...i};let n;i.layers||(i.layers=[],i.saved=!1);let r=i.layers.filter((e=>e.saved));const l=i.layers.filter((e=>!e.saved&&e.fromMergedGroup)),d=Object.keys(r.reduce(((e,t)=>t.fromMergedGroup?{...e,[t.fromMergedGroup]:!0}:e),{}));d.forEach((e=>{delete o[e]})),r=r.map((e=>({id:e.id,saved:e.saved})));const c=Object.keys(l.reduce(((e,t)=>t.fromMergedGroup?{...e,[t.fromMergedGroup]:!0}:e),{}));c.forEach((e=>{const t=o[e];t&&(o[e]={...t,layers:l.filter((t=>t.fromMergedGroup===e)).map((e=>({id:e.id,saved:!0})))})}));const u={...i,layers:r};0===d.length&&(u.rotation=i.preMergeRotation||i.rotation,delete u.preMergeRotation),o[t]=u,i.saved||(delete o[t],n={type:"UPDATE_GROUP",updates:s,groupId:t,undoable:!1});return(!i.saved||l.length>0||d.length>0||c.length>0||r.length!==i.layers.length)&&(i.saved?Mw("groups",t,u,e.groups[t],"onDeselectLayerGroup"):Bw("groups",t,e.groups[t],"onDeselectLayerGroup")),{groups:o,undo:n}};function ET(e,t,o,a,i){const s=e.scenes[0];if(!s)return;const n=a[o]||gT(s.layers,o);!function(e,t,o,a,i){Pw({p:[`layer_${o.id}`],od:o},{srcFn:i}),Pw({p:[`layer_${t.id}`],oi:t},{srcFn:i}),Pw({p:[`scene_${e.id}_layers`,a],li:t.id,ld:o.id},{srcFn:i})}(s,{...t.layer,...t.properties},t.layer,n,i)}const IT=(e,t)=>{var o,a;switch(e.type){case"REMOVE_GOOGLE_DRIVE_PENDING_UPLOAD":{let a=-1;for(let s=0;s<t.pendingGoogleDriveUploads.length;s+=1){if((null==(o=t.pendingGoogleDriveUploads[s])?void 0:o.filename)===e.filename){a=s;break}}if(-1===a)return t;const i=[...t.pendingGoogleDriveUploads];return i.splice(a,1),{...t,pendingGoogleDriveUploads:i}}case"UPDATE_GOOGLE_DRIVE_PENDING_UPLOAD":{const o=[...t.pendingGoogleDriveUploads];for(let i=0;i<t.pendingGoogleDriveUploads.length;i+=1){if((null==(a=t.pendingGoogleDriveUploads[i])?void 0:a.filename)===e.filename){o[i]={filename:e.filename,progress:e.progress};break}}return{...t,pendingGoogleDriveUploads:o}}case"ADD_GOOGLE_DRIVE_PENDING_UPLOAD":return{...t,pendingGoogleDriveUploads:[...t.pendingGoogleDriveUploads,{filename:e.filename,progress:e.progress}]};default:return t}},CT={style:{...Ph},position:Dh},kT=e=>U(e)?B(e):e;function AT(e,t){e.magicSubtitleFramesByAsset&&0!==Object.keys(e.magicSubtitleFramesByAsset).length||(Lw({path:["magicSubtitleFramesByAsset"],val:kT(e.magicSubtitleFramesByAsset),oldVal:void 0,srcFn:"initializeMagicSubtitleFrames"}),e.magicSubtitleFramesByAsset={});const o=e.magicSubtitleFramesByAsset[t];if(!o||0===Object.keys(o).length){const a={byId:{}};Lw({path:["magicSubtitleFramesByAsset",t],val:a,oldVal:kT(o),srcFn:"initializeMagicSubtitleFrames"}),e.magicSubtitleFramesByAsset[t]=a}return e.magicSubtitleFramesByAsset[t]}function jT(e,t){const{assetId:o,frameId:a,undoable:i}=e,s=AT(t,o),n=kT(s.byId[a]);if(!n)throw Error(`Could not find frame ${a}`);const r={type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:o,frame:n,undoable:!1},l={...e,undoable:!1};i&&ff.add({undo:r,redo:l}),delete s.byId[a],function({path:e,oldVal:t,srcFn:o,skipLastUpdated:a}){Pw({p:e,od:t},{srcFn:o,skipLastUpdated:a})}({path:["magicSubtitleFramesByAsset",e.assetId,"byId",a],oldVal:n,srcFn:e.type})}function NT(e,t,o){var a,i;const{assetId:s,frame:n}=e;if(((null==(i=null==(a=o.magicSubtitleFramesByAsset)?void 0:a[s])?void 0:i.byId)||{})[n.id])throw Error(`Frame with id ${n.id} already exists in asset ${s}`);AT(t,s).byId[n.id]=n,Lw({path:["magicSubtitleFramesByAsset",e.assetId,"byId",n.id],val:n,oldVal:void 0,srcFn:e.type})}const RT=["enabled","languageKey","translated","translatedLanguageCode","transcriptionSource"],PT=(e,t)=>{var o;switch(t.type){case"ADD_MAGIC_SUBTITLE":return F(e,(e=>{e.magicSubtitles&&0!==Object.keys(e.magicSubtitles).length||(e.magicSubtitles={},Fw("magicSubtitles",{},void 0,"ADD_MAGIC_SUBTITLE"));const o=s.omit(t.initialProperties,RT),a=s.pick(t.initialProperties,RT),i=e.magicSubtitles[t.assetId],n=i?{...i,...a,enabled:!0}:{...CT,...a,enabled:!0};e.magicSubtitles[t.assetId]=n,Uw("magicSubtitles",t.assetId,n,i,"ADD_MAGIC_SUBTITLE");const r=e.magicSubtitlesGlobal;e.magicSubtitlesGlobal={...r,...o},Lw({path:["magicSubtitlesGlobal"],val:e.magicSubtitlesGlobal,oldVal:r,srcFn:"ADD_MAGIC_SUBTITLE"}),t.undoable&&ff.add({undo:{...t,type:"REMOVE_MAGIC_SUBTITLE",undoable:!1},redo:{...t,undoable:!1}})}));case"REMOVE_MAGIC_SUBTITLE":return F(e,(e=>{if(!e.magicSubtitles)return;const o=e.magicSubtitles[t.assetId];if(!o)return;const a=kT(o);delete e.magicSubtitles[t.assetId],Lw({path:["magicSubtitles",t.assetId],val:void 0,oldVal:a,srcFn:"REMOVE_MAGIC_SUBTITLE"}),t.undoable&&ff.add({undo:{...t,type:"ADD_MAGIC_SUBTITLE",undoable:!1,initialProperties:a},redo:{...t,undoable:!1}})}));case"UPDATE_MAGIC_SUBTITLE":return F(e,(e=>{e.magicSubtitles||(e.magicSubtitles={},Lw({path:["magicSubtitles"],val:{},oldVal:void 0,srcFn:"UPDATE_MAGIC_SUBTITLE"}));const o=s.omit(t.updates,RT),a=s.pick(t.updates,RT),i=s.cloneDeep(e.magicSubtitlesGlobal);e.magicSubtitlesGlobal={...e.magicSubtitlesGlobal,...o},Lw({path:["magicSubtitlesGlobal"],val:e.magicSubtitlesGlobal,oldVal:i,srcFn:"UPDATE_MAGIC_SUBTITLE"});let n={...i};if(t.assetId&&Object.keys(a).length>0){const o=s.cloneDeep(e.magicSubtitles[t.assetId]);e.magicSubtitles[t.assetId]={...e.magicSubtitles[t.assetId],...a},Lw({path:["magicSubtitles",t.assetId],val:e.magicSubtitles[t.assetId],oldVal:o,srcFn:"UPDATE_MAGIC_SUBTITLE"}),n={...n,...o}}t.undoable&&(Object.keys(t.updates).forEach((e=>{e in n||(n[e]=void 0)})),ff.add({undo:{...t,undoable:!1,updates:n},redo:{...t,undoable:!1}}))}));case"SET_MAGIC_SUBTITLE_FRAMES":return F(e,(e=>{if(null===t.frames){if(!e.magicSubtitleFramesByAsset)return;const o=e.magicSubtitleFramesByAsset[t.assetId];if(!o)return;delete e.magicSubtitleFramesByAsset[t.assetId];const a=kT(o);if(Lw({path:["magicSubtitleFramesByAsset",t.assetId],val:void 0,oldVal:a,srcFn:"SET_MAGIC_SUBTITLE_FRAMES"}),t.undoable){const e={...t,frames:a.byId,undoable:!1},o={...t,undoable:!1};ff.add({undo:e,redo:o})}return}const o=AT(e,t.assetId),a=kT(o.byId);if(o.byId={},Lw({path:["magicSubtitleFramesByAsset",t.assetId,"byId"],val:{},oldVal:a,srcFn:"SET_MAGIC_SUBTITLE_FRAMES"}),o.byId=t.frames,Lw({path:["magicSubtitleFramesByAsset",t.assetId,"byId"],val:t.frames,oldVal:kT(o.byId),srcFn:"SET_MAGIC_SUBTITLE_FRAMES"}),t.undoable){const e={...t,frames:a,undoable:!1},o={...t,undoable:!1};ff.add({undo:e,redo:o})}}));case"INSERT_MAGIC_SUBTITLE_FRAME":{const{assetId:o,frame:a,undoable:i}=t,s={type:"REMOVE_MAGIC_SUBTITLE_FRAME",assetId:o,frameId:a.id,undoable:!1},n={...t,undoable:!1};return i&&ff.add({undo:s,redo:n}),F(e,(o=>{NT(t,o,e)}))}case"INSERT_MAGIC_SUBTITLE_FRAMES":if(t.undoable){const o={type:"REMOVE_MAGIC_SUBTITLE_FRAMES",frameIdPairs:t.assetIdFramePairs.map((({assetId:t,frame:o})=>{var a,i;if(((null==(i=null==(a=e.magicSubtitleFramesByAsset)?void 0:a[t])?void 0:i.byId)||{})[o.id])throw Error(`Frame with id ${o.id} already exists in asset ${t}`);return{assetId:t,frame:o}})).map((({assetId:e,frame:t})=>({assetId:e,id:t.id}))),undoable:!1},a={...t,undoable:!1};ff.add({undo:o,redo:a})}return F(e,(o=>{t.assetIdFramePairs.forEach((({assetId:t,frame:a})=>{NT({type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:t,frame:a,undoable:!1},o,e)}))}));case"REMOVE_MAGIC_SUBTITLE_FRAME":return F(e,(e=>{jT(t,e)}));case"REMOVE_MAGIC_SUBTITLE_FRAMES":return F(e,(o=>{if(t.undoable){const o={type:"INSERT_MAGIC_SUBTITLE_FRAMES",assetIdFramePairs:t.frameIdPairs.map((({assetId:t,id:o})=>{var a,i;const s=null==(i=null==(a=e.magicSubtitleFramesByAsset)?void 0:a[t])?void 0:i.byId[o];if(!s)throw Error(`Attempting to delete missing frame ${o}`);return{assetId:t,frame:s}})),undoable:!1},a={...t,undoable:!1};ff.add({undo:o,redo:a})}t.frameIdPairs.forEach((({assetId:e,id:t})=>{jT({type:"REMOVE_MAGIC_SUBTITLE_FRAME",assetId:e,frameId:t,undoable:!1},o)}))}));case"UPDATE_MAGIC_SUBTITLE_FRAME":return F(e,(e=>{const{assetId:o,frameId:a,undoable:i,update:n}=t,r=AT(e,o),l=kT(r.byId[a]);if(!l)throw Error(`Missing frame ${a}`);const d={type:"UPDATE_MAGIC_SUBTITLE_FRAME",assetId:o,frameId:a,update:s.pick(l,Object.keys(n)),undoable:!1},c={...t,undoable:!1};i&&ff.add({undo:d,redo:c}),r.byId[a]={...l,...n},Lw({path:["magicSubtitleFramesByAsset",t.assetId,"byId",a],val:kT(r.byId[a]),oldVal:l,srcFn:t.type})}));case"UPDATE_MAGIC_SUBTITLE_FRAMES":return F(e,(e=>{const{undoable:o,updates:a}=t,i=[];for(const{assetId:r,frameId:l,update:d}of a){const o=AT(e,r),a=kT(o.byId[l]);if(!a)throw Error(`Missing frame ndx ${l}`);const s=Object.keys(d).reduce(((e,t)=>(e[t]=a[t]||void 0,e)),{});i.push({assetId:r,frameId:l,update:s}),o.byId[l]={...a,...d},Lw({path:["magicSubtitleFramesByAsset",r,"byId",l],val:kT(o.byId[l]),oldVal:a,srcFn:t.type})}const s={type:"UPDATE_MAGIC_SUBTITLE_FRAMES",updates:i,undoable:!1},n={...t,undoable:!1};o&&ff.add({undo:s,redo:n})}));case"INSERT_MAGIC_SUBTITLE_FRAME_WORD":{const{assetId:o,frameId:a,wordNdx:i,undoable:s,word:n}=t,r={type:"REMOVE_MAGIC_SUBTITLE_FRAME_WORD",assetId:o,frameId:a,wordNdx:i,undoable:!1},l={...t,undoable:!1};return s&&ff.add({undo:r,redo:l}),F(e,(e=>{const o=AT(e,t.assetId).byId[a];if(!o)throw Error(`Missing frame ${a}`);o.words.splice(i,0,n),function({path:e,val:t,srcFn:o,skipLastUpdated:a}){Pw({p:e,li:t},{srcFn:o,skipLastUpdated:a})}({path:["magicSubtitleFramesByAsset",t.assetId,"byId",t.frameId,"words",i],val:n,srcFn:t.type})}))}case"REMOVE_MAGIC_SUBTITLE_FRAME_WORD":return F(e,(e=>{const{assetId:o,frameId:a,wordNdx:i,undoable:s}=t,n=AT(e,o).byId[a];if(!n)throw Error(`Missing frame ${a}`);const r=kT(n.words[i]);if(!r)return;const l={type:"INSERT_MAGIC_SUBTITLE_FRAME_WORD",assetId:o,frameId:a,wordNdx:i,word:r,undoable:!1},d={...t,undoable:!1};s&&ff.add({undo:l,redo:d}),n.words.splice(i,1),function({path:e,oldVal:t,srcFn:o,skipLastUpdated:a}){Pw({p:e,ld:t},{srcFn:o,skipLastUpdated:a})}({path:["magicSubtitleFramesByAsset",t.assetId,"byId",t.frameId,"words",i],oldVal:r,srcFn:t.type})}));case"UPDATE_MAGIC_SUBTITLE_FRAME_WORD":{const a=null==(o=e.magicSubtitleFramesByAsset)?void 0:o[t.assetId];if(!a)throw Error(`Missing frames when trying to update words for asset ${t.assetId}`);const{assetId:i,frameId:n,wordNdx:r,undoable:l,undoBeforeWord:d={},update:c}=t,u=a.byId[n];if(!u)throw Error(`Missing frame ${n}`);const m=u.words[r];if(!m)throw Error(`Missing frame ${n} word ${r}`);const p={...m,...d},h=s.pick(p,Object.keys(c)),g={type:"UPDATE_MAGIC_SUBTITLE_FRAME_WORD",assetId:i,frameId:n,wordNdx:r,update:h,shouldSync:!0,undoable:!1},f={...t,shouldSync:!0,undoable:!1};l&&ff.add({undo:g,redo:f});const y={...m,...c};return t.shouldSync&&function({path:e,val:t,oldVal:o,srcFn:a,skipLastUpdated:i,extra:s}){Pw({p:e,li:t,ld:o},{srcFn:a,skipLastUpdated:i,...s})}({path:["magicSubtitleFramesByAsset",t.assetId,"byId",t.frameId,"words",r],val:y,oldVal:p,srcFn:t.type,extra:{undoable:l,undoBeforeWord:d,update:c}}),{...e,magicSubtitleFramesByAsset:{...e.magicSubtitleFramesByAsset,[t.assetId]:{...a,byId:{...a.byId,[n]:{...u,words:u.words.map(((e,t)=>t===r?y:e))}}}}}}default:return e}},DT=(e,t,o)=>Math.min(Math.max(parseFloat(e),t),o);const OT=function(e){const{layer:t,ctx:o,frameBezValue:a}=e;let{padding:i}=function(e){if(!function(e){return"text"===e.type}(e))return{padding:0,doublePadding:0};let t=(e.lineHeight||1)*e.fontSize;"wrap"!==e.wrapOrFill&&(t=Math.min(e.position.pixel_height,e.position.pixel_width));const o=(e.textPadding||0)*t/100;return{padding:o,doublePadding:2*o}}(t);i*=2;const s=2*i;o.beginPath(),o.rect(-i,-i,(t.position.pixel_width+s)*a,t.position.pixel_height+s),o.clip()},LT=function(e){const{ctx:t,frameBezValue:o,invertedFrameBezValue:a}=e;t.globalAlpha=0,t.globalAlpha=o,t.filter=`blur(${String(12*a)}px)`},FT=function(e){const{ctx:t,frameBezValue:o}=e;t.globalAlpha=o},MT=function(e){const{ctx:t}=e;t.globalAlpha=0},UT=[.42,0,.58,1],BT=V(...UT),VT=[.25,.46,.45,.94],WT=V(...VT),GT=[.22,.19,.54,1.62],HT=V(...GT),$T={none:{bezArray:[],animationFunction:()=>{},duration:0},drop:{bezArray:[.175,.885,.32,1.275],animationFunction:function(e){const{ctx:t,frameBezValue:o}=e;t.scale(1,o)},duration:.5},"flicker-in-glow":{bezArray:[],animationFunction:function(e){const{ctx:t,framePercent:o}=e;let a;a=o>0&&o<.1?0:o>=.1&&o<.101||o>=.101&&o<.102?1:o>=.102&&o<.2?0:o>=.2&&o<.201?1:o>=.201&&o<.206?0:o>=.206&&o<.3||o>=.3&&o<.301?1:o>=.301&&o<.305?0:o>=.305&&o<.306||o>=.306&&o<.45?1:o>=.45&&o<.451?0:o>=.451&&o<.5?1:o>=.5&&o<.55?0:o>=.55&&o<.551||o>=.551&&o<.57?1:o>=.57&&o<.571?0:o>=.571&&o<.6||o>=.6&&o<.601?1:o>=.601&&o<.65||o>=.65&&o<.651?0:o>=.651&&o<.75||o>=.75&&o<.751?1:o>=.751&&o<.77?0:o>=.77&&o<.771||o>=.771&&o<.85?1:o>=.85&&o<.851?0:o>=.851&&o<.86?1:o>=.86&&o<.861?0:1,t.globalAlpha=a},duration:2},"focus-in":{bezArray:[.55,.085,.68,.53],animationFunction:function(e){const{layer:t,ctx:o,frameBezValue:a,invertedFrameBezValue:i}=e,s="number"==typeof t.globalAlpha?t.globalAlpha:1;o.globalAlpha=a*s;const n=`blur(${12*i}px)`;"none"===o.filter?o.filter=n:o.filter=`${o.filter}  ${n}`},duration:.5},"hue-rotate":{bezArray:[.25,.25,.75,.75],animationFunction:function(e){const{ctx:t,repeatingFramePercent:o}=e,a=`hue-rotate(${-360-360*o}deg)`;"none"===t.filter?t.filter=a:t.filter=`${t.filter}  ${a}`},duration:1},"pop-in-bounce":{bezArray:[.09,.54,.38,2.47],animationFunction:function(e){const{layer:t,ctx:o,frameBezValue:a,frameBezValueMinusOne:i}=e,s=t.position.pixel_width*(t.position.float_x+t.position.float_width/2)/100||0,n=t.position.pixel_height*(t.position.float_y+t.position.float_height/2)/100||0;o.translate(-s*i,-n*i),o.scale(a,a)},duration:.5},reveal:{bezArray:[.25,.1,.25,1],animationFunction:OT,duration:1},"slide-up":{bezArray:[.55,.085,.68,.53],animationFunction:function(e){const{frameBezValue:t,invertedFrameBezValue:o,ctx:a}=e;a.translate(0,20*o),a.globalAlpha=t},duration:.5},vibrate:{bezArray:[],animationFunction:function(e){const{ctx:t,fontSize:o,repeatingFramePercent:a}=e,i=.03*o,s=.2;let n=0,r=0;a>0&&a<=s?(n=-i*a/s,r=i*a/s):a>.2&&a<=.4?(n=-i,r=i-2*i*(a%s/s)):a>.4&&a<=.6?(r=2*i*(a%s/s)-i,n=2*i*(a%s/s)-i):a>.6&&a<.8?(r=i+i*(a%s/s),n=i):a>=.8&&a<1&&(r=2*i-2*i*(a%s/s),n=i-i*(a%s/s)),t.translate(n,r)},duration:.3},"wipe-rectangle":{bezArray:[.25,.1,.25,1],animationFunction:function(e){OT(e)},duration:1},"blur-in":{bezArray:[.24,.085,.72,.93],animationFunction:LT,duration:.5},"blur-out":{bezArray:[.24,.085,.72,.93],animationFunction:LT,duration:.5},"fade-in":{bezArray:[.24,.9,.72,.93],animationFunction:FT,duration:.5},"fade-out":{bezArray:[.24,.9,.72,.93],animationFunction:FT,duration:.5},"hide-in":{bezArray:[],animationFunction:MT,duration:.5},"hide-out":{bezArray:[],animationFunction:MT,duration:.5},"magic-fade":{bezArray:UT,animationFunction:function(e){const{frameTime:t,layer:o,ctx:a,animation:i}=e,{transitionDuration:s=0}=i,{startTime:n,endTime:r}=o;if(!n||!r)return;const l=t-n<r-t;let d,c,u;if(l?(d=n,c=d+s):(c=r,d=c-s),u=(t-d)/s,u=DT(u,0,1),l||(u=1-u),1===u)return;const m=BT(u),p=20-20*m;a.filter=`blur(${p}px)`,a.globalAlpha=m},duration:2},"magic-flip":{bezArray:VT,animationFunction:function(e){const{frameTime:t,layer:o,ctx:a,animation:i}=e,{transitionDuration:s=0}=i,{startTime:n,endTime:r}=o;if(!n||!r)return;const l=t-n<r-t;let d,c,u;if(l?(d=n,c=d+s):(c=r,d=c-s),u=(t-d)/s,u=DT(u,0,1),l||(u=1-u),1===u)return;const m=o.position.pixel_height*(o.position.float_y+o.position.float_height/2)/100||0,p=WT(u),h=p-1;a.translate(0,-m*h),a.scale(1,p)},duration:2},"magic-pop":{bezArray:GT,animationFunction:function(e){const{frameTime:t,layer:o,ctx:a,animation:i}=e,{transitionDuration:s=0}=i,{startTime:n,endTime:r}=o;if(!n||!r)return;if(!(t-n<r-t))return;let l=(t-n)/s;if(l=DT(l,0,1),1===l)return;const d=o.position.pixel_width*(o.position.float_x+o.position.float_width/2)/100||0,c=o.position.pixel_height*(o.position.float_y+o.position.float_height/2)/100||0,u=.7+(1-.7)*HT(l),m=u-1;a.translate(-d*m,-c*m),a.scale(u,u)},duration:2}},KT={"cross-dissolve":{intro:"fade-in",outro:"fade-out"},"cross-blur":{intro:"blur-in",outro:"blur-out"},...Object.assign({},...W.map((({name:e})=>({[e]:{intro:"hide-in",outro:"hide-out"}}))))};function zT(e){return[".","!","?","…","。","！","？","……"].some((t=>!!e.endsWith(t)||!!e.includes(`${t}\n`)))}const YT={"fade-in":Yl.FocusIn,"text-focus-in":Yl.FocusIn,"text-flicker-in-glow":Yl.FlickerInGlow,"linear-wipe":Yl.Reveal,"swing-in-top-fwd":Yl.Drop},JT=function({animation:e,layer:t,ctx:o,frameTime:a,fontSize:i=50,studioAnimations:s=null}){if(!e||!t||!e.id)return null;let{start:n,end:r}=cm(t,5);n=parseFloat(n.toFixed(2)),r=parseFloat(r.toFixed(2));const l=ex(e,s);let d=Math.max(0,Math.min((a-n)/l,1)),c=Math.max(0,(a-n)/l%1);if("outro"===e.type){const e=a-(r-l);e<0?(d=0,c=0):(d=Math.min(e/l,1),c=e/l%1)}const u={animation:e,layer:t,ctx:o,id:e.id,fontSize:i,frameTime:a,framePercent:d,repeatingFramePercent:c,frameBezValue:0,invertedFrameBezValue:1,frameBezValueMinusOne:1},m=YT[u.id];!e.transitionId&&m&&(u.id=m),KT[u.id]&&(u.id=KT[u.id][e.type]);const{bezArray:p=[],animationFunction:h=(()=>{})}=$T[u.id]||{},g=((e,t,o,a)=>{let i=t;return"outro"===e.type&&(i=a<=o?1-t:1),i})(e,d,l,r-a);if(4===p.length){const e=V(p[0],p[1],p[2],p[3]);u.frameBezValue=e(g),u.frameBezValueMinusOne=u.frameBezValue-1,u.invertedFrameBezValue=Math.max(0,1-u.frameBezValue)}return u.animationFunction=h,u},qT=(e,t)=>{if(!e.animation)return!1;if(e.animation.id&&"none"!==e.animation.id)return!0;return QT(e,t).length>0||void 0},XT=(e,t)=>{const o=QT(e,t).find((({keyframeChannels:e})=>!!e));return(null==o?void 0:o.keyframeChannels)||{}},QT=(e,t)=>{if(!e.animation)return[];if(e.animation&&e.animation.id)return"none"===e.animation.id?[]:[e.animation];const o=[];for(const a of["intro","outro","constant"]){(e.animation[a]||[]).forEach((e=>{var i;const s="string"==typeof e?null==(i=null==t?void 0:t.byId)?void 0:i[e]:null;s?o.push({...s,type:a,id:s.animationName}):"none"!==e.id&&o.push(e)}))}return o},ZT=(e,t,o,a,i)=>{if(!t.animation)return;if(t.animation.id)return void((e,t,o,a)=>{const{animation:i}=e,s=JT({animation:i,layer:e,ctx:t,frameTime:o,fontSize:a});s&&s.animationFunction&&s.animationFunction(s)})(t,o,a,i);const s=QT(t,e),n=s.find((e=>"intro"===e.type)),r=s.find((e=>"outro"===e.type)),l=s.find((e=>"constant"===e.type)),{start:d,end:c}=cm(t,5),u=a-d,m={start:0,end:n?ex(n,e):0},p={start:r?c-ex(r,e)-d:0,end:r?c-d:0};if(l){const s=JT({animation:l,layer:t,ctx:o,frameTime:a,fontSize:i,studioAnimations:e});if(!s||!s.animationFunction)return;s.animationFunction(s)}if(n&&u>=m.start&&u<m.end){const s=JT({animation:n,layer:t,ctx:o,frameTime:a,fontSize:i,studioAnimations:e});if(!s||!s.animationFunction)return;s.animationFunction(s)}else if(r&&u>=p.start&&u<=p.end){const s=JT({animation:r,layer:t,ctx:o,frameTime:a,fontSize:i,studioAnimations:e});if(!s||!s.animationFunction)return;s.animationFunction(s)}else a>c?n?o.globalAlpha=1:r&&(o.globalAlpha=0):a<d&&(n?o.globalAlpha=0:r&&(o.globalAlpha=1))},ex=(e,t)=>{var o;let a,i;if("string"==typeof e){const s=null==(o=null==t?void 0:t.byId)?void 0:o[e];if(s){if(void 0!==s.transitionDuration)return s.transitionDuration;const e=$T[s.animationName];e&&(a=e.duration,i=s.speed)}}else{if(void 0!==e.transitionDuration)return e.transitionDuration;a=e.animationName?($T[e.animationName]||{}).duration:e.duration,i=e.speed}switch(null==a&&(a=.5),i){case"slow":a*=2;break;case"fast":a*=.5}return a},tx=(e,t,o)=>{const a={prevFrame:null,nextFrame:null,isAnimating:!1};if(!o.length)return a;const i=e.videoDelay??e.startTime??0,s=o[0],n=o[o.length-1];if(!n||!s)throw Error();if(t>=n.time+i)a.prevFrame=n||null;else if(t<s.time+i)a.nextFrame=s||null,a.isAnimating=!0;else{a.isAnimating=!0;for(let e=0;e<o.length;e++){const s=o[e];if(!s)throw Error();if(!(t>=s.time+i))break;a.prevFrame=s||null,a.nextFrame=o[e+1]||null}}return a},ox=(e,t,o,a)=>{if(!e)return o.value;const i=o.value,s=a.value,n=V(...e),r=o.time;return i+(s-i)*n((t-r)/(a.time-r))},ax=(e,t,o,a)=>{if(!e)return o.value;const i=o.value,s=a.value,n=V(...e),r=G([i,s]),l=o.time;return r(n((t-l)/(a.time-l)))},ix=(e,t,o,a)=>{if(!e)return o.value;const i=V(...e),s=o.value,n=a.value,r=o.time,l=a.time-r,d=t-r,c=Math.max(s,n)-Math.min(s,n),u=360-c,m=Math.min(c,u),p=Math.sign(n-s)*Math.sign(u-c);let h=s+i(d/l)*m*p;return h<0?h+=360:h>360&&(h-=360),h},sx={position:(e,t,o,a)=>{if(!e)return o.value;const i=V(...e),s=o.value,n=a.value,r=a.time-o.time,l=i((t-o.time)/r),d=(parseFloat(n.x)-parseFloat(s.x))*l,c=(parseFloat(n.y)-parseFloat(s.y))*l;return{x:`${parseFloat(s.x)+d}%`,y:`${parseFloat(s.y)+c}%`}},zoom:ox,opacity:ox,brightness:ox,contrast:ox,saturate:ox,blurPercent:ox,background:ax,rotation:ix},nx=(e,t,o,a,i)=>{if(!t)return a.value;return(sx[e]||((e,t,o,a)=>o.value??a.value))(t,o,a,i)},rx={bezArray:null,keyframes:[]},lx=(e,t,o,a,i)=>{var s,n,r,l;let d=(null==(s=e.position)?void 0:s.adjusted_x)||0,c=(null==(n=e.position)?void 0:n.adjusted_y)||0,u=(null==(r=e.position)?void 0:r.pixel_width)||0,m=(null==(l=e.position)?void 0:l.pixel_height)||0;const p=t=>{var o,s;let n=d,r=c;const l=parseFloat((null==(o=e.position)?void 0:o.x)||"0"),u=parseFloat((null==(s=e.position)?void 0:s.y)||"0");return d&&c&&l&&u?(n=d*parseFloat(t.x)/l,r=c*parseFloat(t.y)/u):(n=parseInt(t.x)/100*a,r=parseInt(t.y)/100*i),{x:n,y:r}},h=XT(e,t.animations),g=h.position||rx,f=h.zoom||rx,y=!!g.keyframes.length,v=!!f.keyframes.length,_=(y||v)&&!e.preProcessed&&!(e=>e.isCanvasBlurLayer||!!e.originalLayerId)(e);if(_){const t=e.videoDelay??e.startTime??0,{keyframes:a}=g,{prevFrame:i,nextFrame:s}=tx(e,o,a);let n={x:d,y:c};if(s&&i){const e=i.value,a=s.value,r=p(e),l=p(a);let d=0,c=0;if(g.bezArray){const e=V(...g.bezArray),a=i.time??0,n=e((o-t-a)/((s.time??0)-a)),u=l.x-r.x,m=l.y-r.y;d=u*n,c=m*n}n={x:r.x+d,y:r.y+c}}else i?n=p(i.value):s&&(n=p(s.value));if(v){y||(n.x+=u/2,n.y+=m/2);const{bezArray:a,keyframes:i}=f,{prevFrame:s,nextFrame:r}=tx(e,o,i),l=e.zoom||100;let d=l;d=s&&r?ox(a,o-t,s,r):(null==s?void 0:s.value)||(null==r?void 0:r.value)||(null==e?void 0:e.zoom)||100;const c=d/l;u*=c,m*=c}"ellipse"!==e.shapeType&&(n.x-=u/2,n.y-=m/2),d=n.x,c=n.y,e.position&&(e.position.adjusted_x=d,e.position.adjusted_y=c,e.position.pixel_width=u,e.position.pixel_height=m)}return{xPos:d,yPos:c,width:u,height:m}},dx=(e,t,o)=>{var a,i;const s=e.background||"#000000";if(!t)return s;const n=(null==(a=t.background)?void 0:a.keyframes)||[],r=(null==(i=t.background)?void 0:i.bezArray)||null;if(!n.length)return s;const l=e.videoDelay??e.startTime??0,{prevFrame:d,nextFrame:c}=tx(e,o,n);let u=s;return u=d&&c?ax(r,o-l,d,c):(null==d?void 0:d.value)??(null==c?void 0:c.value)??s,u},cx=(e,t,o)=>{const a={...e.filters};return t?("opacity"in t&&(a.opacity=((e,t,o)=>{var a,i,s;const n=(null==(a=e.filters)?void 0:a.opacity)??100;if(!t)return n;const r=(null==(i=t.opacity)?void 0:i.keyframes)||[],l=(null==(s=t.opacity)?void 0:s.bezArray)||null;if(!r.length)return n;const d=e.videoDelay??e.startTime??0,{prevFrame:c,nextFrame:u}=tx(e,o,r);let m=n;return m=c&&u?ox(l,o-d,c,u):(null==c?void 0:c.value)??(null==u?void 0:u.value)??n,m})(e,t,o)),"brightness"in t&&(a.brightness=((e,t,o)=>{var a,i,s;const n=(null==(a=e.filters)?void 0:a.brightness)??100;if(!t)return n;const r=(null==(i=t.brightness)?void 0:i.keyframes)||[],l=(null==(s=t.brightness)?void 0:s.bezArray)||null;if(!r.length)return n;const d=e.videoDelay??e.startTime??0,{prevFrame:c,nextFrame:u}=tx(e,o,r);let m=n;return m=c&&u?ox(l,o-d,c,u):(null==c?void 0:c.value)??(null==u?void 0:u.value)??n,m})(e,t,o)),"contrast"in t&&(a.contrast=((e,t,o)=>{var a,i,s;const n=(null==(a=e.filters)?void 0:a.contrast)??100;if(!t)return n;const r=(null==(i=t.contrast)?void 0:i.keyframes)||[],l=(null==(s=t.contrast)?void 0:s.bezArray)||null;if(!r.length)return n;const d=e.videoDelay??e.startTime??0,{prevFrame:c,nextFrame:u}=tx(e,o,r);let m=n;return m=c&&u?ox(l,o-d,c,u):(null==c?void 0:c.value)??(null==u?void 0:u.value)??n,m})(e,t,o)),"saturate"in t&&(a.saturate=((e,t,o)=>{var a,i,s;const n=(null==(a=e.filters)?void 0:a.saturate)??100;if(!t)return n;const r=(null==(i=t.saturate)?void 0:i.keyframes)||[],l=(null==(s=t.saturate)?void 0:s.bezArray)||null;if(!r.length)return n;const d=e.videoDelay??e.startTime??0,{prevFrame:c,nextFrame:u}=tx(e,o,r);let m=n;return m=c&&u?ox(l,o-d,c,u):(null==c?void 0:c.value)??(null==u?void 0:u.value)??n,m})(e,t,o)),"blurPercent"in t&&!(null==e?void 0:e.originalLayerId)&&(a.blurPercent=((e,t,o)=>{var a,i,s;const n=(null==(a=e.filters)?void 0:a.blurPercent)??100;if(!t)return n;const r=(null==(i=t.blurPercent)?void 0:i.keyframes)||[],l=(null==(s=t.blurPercent)?void 0:s.bezArray)||null;if(!r.length)return n;const d=e.videoDelay??e.startTime??0,{prevFrame:c,nextFrame:u}=tx(e,o,r);let m=n;return m=c&&u?ox(l,o-d,c,u):(null==c?void 0:c.value)??(null==u?void 0:u.value)??n,m})(e,t,o)),a):a},ux=new Set(["fade","BowTieVertical","BowTieWithParameter","CircleCrop","TopBottom","LeftRight","LinearBlur","ZoomLeftWipe","ZoomRigthWipe","angular","cannabisleaf","circle","coord-from-in","fadecolor","fadegrayscale","polar_function","squareswire"]),mx=[Jl.CrossDissolve,"CrossZoom"],px=Object.assign({},...H.map((e=>({[e.name]:e})))),hx={[Jl.CrossDissolve]:{id:Jl.CrossDissolve,name:"Cross Dissolve",introAnimId:Yl.FadeIn,outroAnimId:Yl.FadeOut,isCrossTransition:!0,gltransition:!1},[Jl.CrossBlur]:{id:Jl.CrossBlur,name:"Cross Blur",introAnimId:Yl.BlurIn,outroAnimId:Yl.BlurOut,isCrossTransition:!0,gltransition:!1},...Object.assign({},...H.filter((({name:e})=>!ux.has(e))).map((({name:e,displayName:t})=>({[e]:{id:e,name:t,introAnimId:Yl.HideIn,outroAnimId:Yl.HideOut,isCrossTransition:!0,gltransition:!0}}))))},gx=e=>e in hx,fx=e=>!!_x(e),yx=[Jl.CrossDissolve,...H.filter((({name:e})=>!ux.has(e))).map((({name:e})=>e))].map((e=>({...hx[e]}))).sort(((e,t)=>{const o=mx.indexOf(e.id)+1||mx.length+1,a=mx.indexOf(t.id)+1||mx.length+1;return o===a?e.name.toLowerCase().localeCompare(t.name.toLowerCase()):o>a?1:-1}));function vx(e){return{...hx[e]}}function _x(e){return px[e]}const wx=["video","image"],bx=e=>{let t=K(`${e}`).hsl();const o=t.array()[1],a=t.array()[2];return o<25&&(t=t.saturationl(25)),a<25&&(t=t.lightness(25)),a>80&&(t=t.lightness(80)),t.hex()},Tx=e=>[e.startTime||0,e.endTime||e.duration||sr().state.studio.duration],xx=$(...$T["magic-fade"].bezArray),Sx=$(...$T["magic-flip"].bezArray),Ex=$(...$T["magic-pop"].bezArray),Ix={[Yl.None]:{id:Yl.None,name:"None",duration:$T.none.duration,speed:"default",type:"none",animationFunc:()=>({})},[Yl.MagicFade]:{id:Yl.MagicFade,name:"Fade",duration:$T["magic-fade"].duration,speed:"default",type:"constant",animationFunc:(e,t)=>{const o=t,{transitionDuration:a=0,transitionOverlapDuration:i=0}=o.transition||{},[s,n]=Tx(t),r=e-s<n-e;let l,d,c;if(r?(l=s-i,d=l+a):(d=n+i,l=d-a),c=(e-l)/a,c=Ru(c,0,1),r||(c=1-c),1===c)return{};const u=xx(c);return{WebkitFilter:`blur(${20-20*u}px)`,opacity:100*u+"%"}}},[Yl.MagicFlip]:{id:Yl.MagicFlip,name:"Flip",duration:$T["magic-flip"].duration,speed:"default",type:"none",animationFunc:(e,t)=>{const o=t,{transitionDuration:a=0,transitionOverlapDuration:i=0}=o.transition||{},[s,n]=Tx(t),r=e-s,l=n-e;if(Math.min(r,l)>a)return{};const d=r<l;let c,u,m;if(d?(c=s-i,u=c+a):(u=n+i,c=u-a),m=(e-c)/a,m=Ru(m,0,1),d||(m=1-m),1===m)return{};return{transform:`scale(1, ${Sx(m)})`,transformOrigin:"center"}}},[Yl.MagicPop]:{id:Yl.MagicPop,name:"Pop",duration:$T["magic-pop"].duration,speed:"default",type:"none",animationFunc:(e,t)=>{const o=t,{transitionDuration:a=0,transitionOverlapDuration:i=0}=o.transition||{},[s,n]=Tx(t),r=e-s,l=n-e;if(Math.min(r,l)>a)return{};if(!(r<l))return{};let d=(e-(s-i))/a;if(d=Ru(d,0,1),1===d)return{};return{transform:`scale(${.7+(1-.7)*Ex(d)})`,transformOrigin:"center"}}}},Cx={...Ix,[Yl.Drop]:{id:Yl.Drop,name:"Drop",duration:$T.drop.duration,speed:"default",layerInvolvesMovement:!0,type:"intro",animationFunc:(e,t,o)=>{const a=$(.175,.885,.32,1.275)(e);return{...eS({layer:t,transform:`${o} scaleY(${a})`})}}},[Yl.FlickerInGlow]:{id:Yl.FlickerInGlow,name:"Flicker",duration:$T["flicker-in-glow"].duration,speed:"default",type:"intro",animationFunc:(e,t)=>{const o=mm(t)||1;return e>=0&&e<.1?{opacity:0}:e>=.1&&e<.101||e>=.101&&e<.102?{opacity:o}:e>=.102&&e<.2?{opacity:0}:e>=.2&&e<.201?{opacity:o}:e>=.201&&e<.206?{opacity:0}:e>=.206&&e<.3||e>=.3&&e<.301?{opacity:o}:e>=.301&&e<.305?{opacity:0}:e>=.305&&e<.306||e>=.306&&e<.45?{opacity:o}:e>=.45&&e<.451?{opacity:0}:e>=.451&&e<.5?{opacity:o}:e>=.5&&e<.55?{opacity:0}:e>=.55&&e<.551||e>=.551&&e<.57?{opacity:o}:e>=.57&&e<.571?{opacity:0}:e>=.571&&e<.6||e>=.6&&e<.601?{opacity:o}:e>=.601&&e<.65||e>=.601&&e<.65?{opacity:0}:e>=.651&&e<.75||e>=.75&&e<.751?{opacity:o}:e>=.751&&e<.77?{opacity:0}:e>=.77&&e<.771||e>=.771&&e<.85?{opacity:o}:e>=.85&&e<.851?{opacity:0}:e>=.851&&e<.86?{opacity:o}:e>=.86&&e<.861?{opacity:0}:e>=.861&&e<=.1?{opacity:o}:{}}},[Yl.FocusIn]:{id:Yl.FocusIn,name:"Fade",duration:$T["focus-in"].duration,speed:"default",type:"intro",animationFunc:(e,t)=>{const o=mm(t)||1,a=$(.55,.085,.68,.53)(e),i=1*a;return{WebkitFilter:`blur(${12*(1-a)}px)`,opacity:i>o?o:i}}},[Yl.HueRotate]:{id:Yl.HueRotate,name:"Hue Rotate",duration:$T["hue-rotate"].duration,speed:"default",animatesForever:!0,type:"constant",animationFunc:e=>({WebkitFilter:`hue-rotate(${-360*$(.25,.25,.75,.75)(e)}deg)`}),selectionFunc:e=>{switch(e.type){case zl.Text:return{color:`${bx(e.color)}`,textShadow:"transparent",originalColor:e.color};case zl.Shape:return{background:`${bx(e.background)}`,originalColor:e.background}}return{}}},[Yl.Reveal]:{id:Yl.Reveal,name:"Reveal",duration:$T.reveal.duration,speed:"default",type:"intro",animationFunc:e=>{const t=100*(1-$(.22,1.03,.67,1)(e));return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[Yl.PopInBounce]:{id:Yl.PopInBounce,name:"Pop",duration:$T["pop-in-bounce"].duration,speed:"default",type:"intro",animationFunc:e=>({transform:`scale(${$(.09,.54,.38,2.47)(e)})`,transformOrigin:"center"})},[Yl.SlideUp]:{id:Yl.SlideUp,name:"Slide",duration:$T["slide-up"].duration,speed:"default",layerInvolvesMovement:!0,type:"intro",animationFunc:(e,t,o)=>{const a=mm(t)||1,i=$(.55,.085,.68,.53)(e);return{...Zx({yPixels:20*(1-i),layer:t,transform:o}),opacity:e*a}}},[Yl.Vibrate]:{id:Yl.Vibrate,name:"Vibrate",duration:$T.vibrate.duration,speed:"default",animatesForever:!0,layerInvolvesMovement:!0,type:"constant",animationFunc:(e,t,o)=>{const a=e%1,i=.03*parseInt(String(t.fontSize||"50")),s=.2;let n=0,r=0;return a>0&&a<=s?(n=-i*a/s,r=i*a/s):a>s&&a<=.4?(n=-i,r=i-2*i*(a%s/s)):a>.4&&a<=.6000000000000001?(r=2*i*(a%s/s)-i,n=2*i*(a%s/s)-i):a>.6000000000000001&&a<.8?(r=i+i*(a%s/s),n=i):a>=.8&&a<1&&(r=2*i-2*i*(a%s/s),n=i-i*(a%s/s)),Zx({layer:t,xPixels:n,yPixels:r,transform:o})}},[Yl.WipeRectangle]:{id:Yl.WipeRectangle,name:"Wipe",duration:$T["wipe-rectangle"].duration,speed:"default",type:"intro",animationFunc:e=>{const t=100*(1-$(.25,.1,.25,1)(e));return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[Yl.ProgressBar]:{id:Yl.ProgressBar,name:"Progress Bar",duration:1,speed:"default",type:"constant",animationFunc:e=>{const t=100*(1-e);return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[Yl.BlurIn]:{id:Yl.BlurIn,name:"Blur in",duration:$T["blur-in"].duration,speed:"default",type:"intro",animationFunc:e=>{const t=$(.24,.085,.72,.93)(e);return{WebkitFilter:`blur(${12*(1-t)}px)`,opacity:t}}},[Yl.BlurOut]:{id:Yl.BlurOut,name:"Blur Out",duration:$T["blur-out"].duration,speed:"default",type:"outro",animationFunc:e=>{const t=$(.24,.085,.72,.93)(e);return{WebkitFilter:`blur(${12*t}px)`,opacity:t}}},[Yl.FadeIn]:{id:Yl.FadeIn,name:"Fade in",duration:$T["fade-in"].duration,speed:"default",type:"intro",animationFunc:e=>({opacity:$(.24,.9,.72,.93)(e)})},[Yl.FadeOut]:{id:Yl.FadeOut,name:"Fade Out",duration:$T["fade-out"].duration,speed:"default",type:"outro",animationFunc:e=>({opacity:$(.24,.9,.72,.93)(e)})},[Yl.HideIn]:{id:Yl.HideIn,name:"Hide In",duration:$T["hide-in"].duration,speed:"default",type:"intro",animationFunc:()=>({display:"none"})},[Yl.HideOut]:{id:Yl.HideOut,name:"Hide Out",duration:$T["hide-out"].duration,speed:"default",type:"outro",animationFunc:()=>({display:"none"})}};function kx(e){return{...e}}const Ax=["id","name","animationFunc","duration","speed"];function jx(e){if(!e)return!1;if(!e.id)return!1;if(e.duration<=0)return!1;for(const t of Ax)if(!e[t])return!1;return!e.layerInvolvesMovement||"boolean"==typeof e.layerInvolvesMovement}function Nx(e){let t=Cx[Yl.None],o=e;return e?(!(e in Cx)&&e in YT&&(o=YT[e]),t=Cx[o],jx(t)?kx(t):kx(Cx[Yl.None])):kx(t)}function Rx(e,t=sr().state.studio.animations){if(null==t?void 0:t.byId[e])return null==t?void 0:t.byId[e]}function Px(e,t){const o=e.intro||[],a=e.outro||[],i=e.constant||[],s=[],n=[],r=[];return o.forEach((e=>{const o=Rx(e,t);o&&s.push(o)})),a.forEach((e=>{const o=Rx(e,t);o&&n.push(o)})),i.forEach((e=>{const o=Rx(e,t);o&&r.push(o)})),{intro:s,outro:n,constant:r}}function Dx(e,t){let o,a=!0;if(gx(e.animationName)){const{introAnimId:a,outroAnimId:i}=vx(e.animationName);o="intro"===t?a:i}else e.animationName===Yl.None?o=Yl.None:(a=!1,o=e.animationName);const i=o in Cx?Cx[o]:void 0;if(jx(i)){if(e.isCrossTransition){return{...i,transitionDuration:e.transitionDuration,transitionId:a?e.animationName:void 0,animationStateMapId:e.id,type:t,isCrossTransition:!0,introLayerId:e.introLayerId,outroLayerId:e.outroLayerId}}return{...i,transitionDuration:e.transitionDuration,isCrossTransition:e.isCrossTransition,animationStateMapId:e.id,type:t,layerId:e.layerId}}return null}function Ox(e){const t=e.intro||[],o=e.outro||[],a=e.constant||[],i=[],s=[],n=[];t.forEach((e=>{const t=Dx(e,"intro");t&&i.push(t)})),o.forEach((e=>{const t=Dx(e,"outro");t&&s.push(t)})),a.forEach((e=>{const t=Dx(e,"constant");t&&n.push(t)}));return{intro:i,outro:s,constant:n}}function Lx(e){const t={intro:[],constant:[],outro:[]};if(!e.animation)return t;const o=Ox(Px(e.animation));return o||t}function Fx(e){var t,o;const a=Cx[Yl.None];if(!e.animation)return kx(a);if((null==(t=e.animation.constant)?void 0:t[0])===Yl.ProgressBar)return kx(Cx[Yl.ProgressBar]);const i=Ox(Px(e.animation));if(!i)return kx(a);let s=null;for(const r of Object.keys(i))if(i[r]&&(null==(o=i[r][0])?void 0:o.id)){const e=i[r][0];e&&(s=e)}if(!s||s.id===Yl.None)return kx(Cx[Yl.None]);const n=Nx(s.id);return n.transitionDuration=s.transitionDuration||.5,kx(n)}function Mx(e){var t;const o=Cx[Yl.None];if(!e.animation)return[kx(o)];if((null==(t=e.animation.constant)?void 0:t[0])===Yl.ProgressBar)return[kx(Cx[Yl.ProgressBar])];const a=Ox(Px(e.animation));if(!a)return[kx(o)];let i=[];for(const s of Object.keys(a)){if(!s)return[kx(o)];a[s]&&(i=[...i,a[s][0]])}return i.map((e=>{if(!e)return kx(o);const t=Nx(e.id);return t.type=e.type,t.transitionDuration=e.transitionDuration,kx(t)}))}function Ux(e,t,o){var a,i;if(!e.animation)return null;const s=Ox(Px(e.animation,o));if(!s)return null;let n=null;if(null==(a=null==s?void 0:s[t])?void 0:a[0]){const e=null==(i=null==s?void 0:s[t])?void 0:i[0];e&&(n=e)}if(!n||n.id===Yl.None)return null;return{...Nx(n.id),...n}}function Bx(e){if(!e.animation)return{introTransition:null,outroTransition:null};const t=Ox(Px(e.animation));if(!t)return{introTransition:null,outroTransition:null};let o=null,a=null;for(const n of Object.keys(t)){const e=t[n][0];e&&e.isCrossTransition&&("intro"===n&&(o=e),"outro"===n&&(a=e))}if(!o&&!a)return{introTransition:null,outroTransition:null};let i=null,s=null;return o&&(i=kx({...Nx(o.id),...o})),a&&(s=kx({...Nx(a.id),...a})),{introTransition:i,outroTransition:s}}function Vx(e){const t=Xx.find((t=>t.id===e.introAnimId)),o=Xx.find((t=>t.id===e.outroAnimId));if(!t||!o)throw Error(`Missing intro or outro animation for transition ${e.id}`);return{introAnimation:kx(t),outroAnimation:kx(o)}}const Wx=e=>e.map((e=>({...Cx[e]}))),Gx=Wx([Yl.None,Yl.Drop,Yl.FlickerInGlow,Yl.FocusIn,Yl.Reveal,Yl.PopInBounce,Yl.SlideUp,Yl.WipeRectangle]),Hx=Wx([Yl.None,Yl.Vibrate]),$x=Wx([Yl.None,Yl.Drop,Yl.FlickerInGlow,Yl.FocusIn,Yl.Reveal,Yl.PopInBounce,Yl.SlideUp]),Kx=Wx([Yl.None,Yl.HueRotate,Yl.Vibrate]),zx=Wx([Yl.None,Yl.FlickerInGlow,Yl.FocusIn,Yl.Reveal,Yl.SlideUp]),Yx=Wx([Yl.None,Yl.HueRotate,Yl.Vibrate]),Jx=Wx([Yl.None,Yl.HueRotate]),qx=Wx([Yl.None,Yl.Drop,Yl.FocusIn,Yl.FlickerInGlow,Yl.Reveal,Yl.PopInBounce,Yl.SlideUp]),Xx=Wx([Yl.FadeIn,Yl.FadeOut,Yl.BlurIn,Yl.BlurOut,Yl.HideIn,Yl.HideOut]),Qx=Wx([Yl.FocusIn,Yl.Drop,Yl.FlickerInGlow,Yl.Reveal,Yl.PopInBounce,Yl.SlideUp]),Zx=({layer:e,xPixels:t=0,yPixels:o=0,transform:a=""})=>{switch(e.type){case zl.Audio:case zl.Video:case zl.Image:case zl.Shape:return{x:t,y:o,transform:a};case zl.Text:return{transform:`${a} translate(${t}px, ${o}px)`};default:return{}}},eS=({layer:e,transform:t=""})=>{switch(e.type){case zl.Audio:case zl.Video:case zl.Image:case zl.Shape:case zl.Text:return{transform:t};default:return{}}};function tS(e){const t=Fx(e);return!e.animation||"none"===t.id}var oS=(e=>(e.exportAsImage="exportAsImage",e.studio="studio",e))(oS||{});const aS=v({initialState:{byElementPoolId:{[oS.studio]:{paused:!0,userManualSeekTime:null}}},name:"elementPool",reducers:{initialize(e,t){const{elementPoolId:o}=t.payload;e.byElementPoolId[o]||(e.byElementPoolId[o]={paused:!0,userManualSeekTime:null})},setUserManualSeek(e,t){const{elementPoolId:o,time:a}=t.payload,i=o||oS.studio;e.byElementPoolId[i]={...e.byElementPoolId[i],userManualSeekTime:a}},setPaused(e,t){const{elementPoolId:o,paused:a}=t.payload,i=o||oS.studio;e.byElementPoolId[i]={...e.byElementPoolId[i],paused:a}},togglePaused(e,t){var o;const{elementPoolId:a}=t.payload,i=a||oS.studio;e.byElementPoolId[i]={...e.byElementPoolId[i],paused:!(null==(o=e.byElementPoolId[i])?void 0:o.paused)}}}}),iS=()=>aS.actions.setPaused({paused:!0}),sS=()=>aS.actions.setPaused({paused:!1}),nS=aS.actions.setUserManualSeek,rS=aS.actions;function lS(e,t){return{type:"SET_STUDIO_RATIO",ratio:e,undoable:t}}function dS(e,t,o,a){return{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:e,customOutputWidth:t,customOutputHeight:o,undoable:a}}function cS(e){return{type:"SET_RESIZING",isResizing:e}}function uS(e){return{type:"SET_ROTATING",isRotating:e}}function mS(e){return{type:"SET_PLAY_CANVAS_PREVIEW_ON_MOUNT",playCanvasPreviewOnMount:e}}function pS(e){return{type:"SET_ORIGIN",origin:e}}function hS(e){return{type:"SET_OVERLAY_MOUNTED",overlayMounted:e}}function gS(){return{type:"UPDATE_LAST_SAVED"}}function fS(e){return{type:"SHOW_TOOL_TIP",toolTip:e}}function yS(e){return{type:"SET_EYEDROPPER_MODE",status:e}}function vS(e){const{state:t}=sr();return{type:"SET_RIPPLE_MODE",rippleMode:e,userId:t.currentUser.user._id}}function _S(e){return{type:"SET_DRAGGING",isDragging:e}}const wS=e=>e?Math.floor(1e3*e)/1e3:e,bS=(e,t)=>{if(t<1){const o=1/t;return Math.round(e*o)/o}return Math.round(e/t)*t},TS=(e,t=0)=>{if(Ql(e)||ql(e)){const o=t+(e.videoDelay||0),a=o+nl(e);return[wS(o),wS(a)]}return[t+(e.startTime||0),t+(e.endTime||e.duration||sr().state.studio.duration)]};var xS=(e=>(e[e.Track=1]="Track",e[e.Trimmer=4]="Trimmer",e[e.DraggedTrack=5]="DraggedTrack",e[e.TimelineRowColumn=6]="TimelineRowColumn",e[e.TimeLabel=10]="TimeLabel",e[e.Comment=10]="Comment",e[e.SelectedComment=11]="SelectedComment",e[e.Seeker=12]="Seeker",e[e.DraggedSeeker=13]="DraggedSeeker",e[e.DraggedTrackTrimmer=13]="DraggedTrackTrimmer",e[e.InvisibleTrimmerHandle=14]="InvisibleTrimmerHandle",e[e.RowHighlight=22]="RowHighlight",e))(xS||{});const SS=30,ES=60,IS=30,CS=25,kS=10,AS=20,jS=30,NS=30,RS=5,PS=.001,DS=25,OS=20;var LS=(e=>(e.TrimEnd="TrimEnd",e.TrimStart="TrimStart",e.Drag="Drag",e.None="None",e))(LS||{});const FS=(e,t)=>t/e,MS=(e,t)=>t*e,US=(e,t)=>{let o=(t-25)/e;return o<0&&(o=0),o},BS=(e,t)=>{let o=t*e+25;return o<0&&(o=25),o};function VS(e,t){if(!t)return[];const o=[];return e.every((e=>(e.timelineRow===t.timelineRow&&o.push(e),!0))),o}const WS=e=>{const t=new Map;return e.forEach((e=>{const{timelineRow:o}=e;if(void 0!==o){const a=t.get(o);a?(a.push(e),t.set(o,a)):t.set(o,[e])}})),t},GS=e=>{const t=WS(e);for(const[o,a]of t){const e=a.sort(((e,t)=>TS(e,0)[0]-TS(t,0)[0]));for(let t=0;t<e.length-1;t+=1){const o=e[t],a=e[t+1];if(!o||!a)continue;if(!om(o)&&!em(o)||!om(a)&&!em(a))continue;if(TS(o,0)[1]+.01>=TS(a,0)[0])return!0}}return!1},HS=e=>e.some((e=>om(e)||em(e))),$S=(e,t,o)=>{var a;if(o)return!0;const{timelineContainerWidth:i}=e.timeline,s=(null==(a=e.projectSessionSettings.timelinePosition)?void 0:a.timelineScrollLeft)??0,n=sf(e);if(!n)return!0;const[r,l]=TS(t,0),d=BS(n,r);return BS(n,l)>s-.25*i&&d<s+i+.25*i},KS=m((e=>e.studio.allLayers.byId),(e=>e.timeline.timelineContainerWidth),(e=>{var t;return(null==(t=e.projectSessionSettings.timelinePosition)?void 0:t.timelineScrollLeft)??0}),(e=>sf(e)),((e,t,o,a)=>{if(!a)return[];return Object.values(e).filter((e=>{const[i,s]=TS(e,0),n=BS(a,i),r=BS(a,s),l=o+t;return o<=n&&n<=l||o<=r&&r<=l}))})),zS=new Map([["linear",{displayName:"Linear",x1:0,y1:0,x2:1,y2:1}],["ease-in",{displayName:"Ease In",x1:.42,y1:0,x2:1,y2:1}],["ease-out",{displayName:"Ease Out",x1:0,y1:0,x2:.58,y2:1}],["ease-in-out",{displayName:"Ease In & Out",x1:.25,y1:.1,x2:.25,y2:1}]]),YS=(e,t)=>{if(!e)return null;const{startValues:o,endValues:a}=e,{topLeft:{x:i,y:s},bottomRight:{x:n}}=o,{topLeft:{x:r,y:l},bottomRight:{x:d}}=a,c=((e,t)=>{const{startTime:o,duration:a}=e,i=t-o,s=Math.min(i/a,1),n=zS.get(e.easingFuncID),{x1:r,y1:l,x2:d,y2:c}=n;return V(r,l,d,c)(s)})(e,t),u=[r-i,l-s].map((e=>e*c)),[m,p]=u;if(void 0===m||void 0===p)throw Error();const h={x:m+i,y:p+s},g=Math.abs(n-i),f=(Math.abs(d-r)-g)*c+g;return{topLeft:h,bottomRight:{x:h.x+f,y:h.y+f}}},JS=(e,t)=>{let o=e?{...e}:void 0;if(t){const{topLeft:{x:e,y:a},bottomRight:{x:i,y:s}}=t,n=100*(i-e),r=100*(s-a),l=100*e,d=100*a;if(o){const{x:e,y:t,width:a,height:i}=o;o={x:e+l/100*a,y:t+d/100*i,width:a*(n/100),height:i*(r/100)}}else o={x:l,y:d,width:n,height:r}}return o},qS=e=>!(!e||!e.keyframeAnimation)&&"moving-zoom"===e.keyframeAnimation.id,XS=e=>{var t;if(!qS(e))return null;const o=null==(t=e.keyframeAnimation)?void 0:t.transitions[0];return o?{...o}:null},QS=e=>e&&e.replace(/.*\/studio/,"/studio"),ZS=e=>{const{state:t}=sr();let o="";t&&t.isStudio&&t.studio&&t.studio._id&&iE()&&(o=t.studio._id);const a=QS(e);return o?`/${o}${a}`:a},eE=(e,t={})=>{const o=ZS(e);o!==ir.location.pathname&&ir.push(o,{properties:t})},tE=()=>{ir.goBack()},oE=(e,t="")=>{const o=ZS(e);o!==ir.location.pathname&&ir.replace(`${o}${t}`)},aE=()=>window.location.pathname.includes("/studio/editor/export-as-image"),iE=()=>window.location.pathname.includes("/studio/editor"),sE=()=>iE()&&!aE(),nE=()=>window.location.pathname.includes("/studio");function rE(){eE("/studio/editor")}function lE(){oE("/studio/editor")}function dE(){const{dispatch:e}=sr();rE(),e(ic(!1))}function cE(e){const t=function(e){const t=h.useRef(e);return t.current=e,t}(e);return h.useCallback((function(...e){return t.current(...e)}),[])}const uE=h.createContext({elementPool:null,getEPTime:()=>{throw new Error("getStudioTime not implemented")},setEPTime:()=>{throw new Error("setStudioTime not implemented")},selectElementPoolLayers:()=>{throw new Error("selectElementPoolLayers not implemented")},selectPossibleReferenceLayers:()=>{throw new Error("selectPossibleReferenceLayers not implemented")}}),mE=()=>h.useContext(uE),pE=h.createContext(0);const hE=new Set;let gE=0;function fE(e){gE=e,window.studioTime=e;for(const t of hE)t(e)}let yE=fE;const vE=_.memo((({children:e})=>{const[t,o]=h.useState(gE),a=e=>{fE(e),o(e)};yE=a;const i=tl((e=>e.studio.duration>0));return h.useEffect((function(){if(!iE()&&!window.location.pathname.includes("/signin-redirect"))return;const e=sh.get("VIDEO_TIME_BEFORE_SIGN_IN",{disabled:0});e&&(a(e),sh.remove("VIDEO_TIME_BEFORE_SIGN_IN"))}),[]),h.useEffect((function(){i||a(0)}),[i]),h.useEffect((function(){return()=>{yE=fE}}),[]),w.jsx(pE.Provider,{value:t,children:e})})),_E=()=>{const e=h.useContext(pE);if(void 0===e)throw new Error("useStudioTime must be used within an EPTimeContext");return e};function wE(e){return t=>w.jsx(pE.Consumer,{children:o=>w.jsx(e,{...t,studioTime:o})})}const bE=()=>gE,TE=e=>{yE(e)},xE=e=>(hE.add(e),()=>{hE.delete(e)}),SE=e=>{const t=cE(e);h.useEffect((()=>xE(t)),[])},EE=(e,t,o,a,i=!0)=>({type:"UPSERT_KEYFRAME",undoable:i,layerId:e,channel:t,time:o,value:a}),IE=(e,t,o,a=!0)=>({type:"REMOVE_KEYFRAME",undoable:a,layerId:e,channel:t,time:o}),CE=(e,t=!1,o=!0)=>({type:"TRIM_START_KEYFRAMES",maintainInterpolation:t,undoable:o,layerIdsToTimeChanges:e}),kE=(e,t=!1,o=!0)=>({type:"TRIM_END_KEYFRAMES",undoable:o,maintainInterpolation:t,layerIdsToMaxTimes:e}),AE=(e,t,o=!0)=>({type:"SET_KEYFRAMES",undoable:o,keyframesForChannels:t,layerId:e}),jE=(e,t,o,a=!0)=>({type:"SPLIT_KEYFRAMES",undoable:a,leftLayerId:e,rightLayerId:t,studioTime:o}),NE=(e,t,o,a)=>({type:"UNDO_SPLIT_KEYFRAMES",leftLayerId:e,rightLayerId:t,timeCorrection:o,insertedFrames:a}),RE=(e,t=!0)=>({type:"DELETE_LAYER_KEYFRAMES",undoable:t,layerId:e}),PE=(e,t,o=!0)=>({type:"SET_LAYER_CHANNELS",undoable:o,layerId:e,layerChannels:t}),DE=(e,t,o,a=!0)=>({type:"SHIFT_KEYFRAME_PLAYBACK_SPEED",undoable:a,layerId:e,oldPlaybackRate:t,newPlaybackRate:o}),OE=(e,t,o=!0)=>({type:"COPY_LAYER_KEYFRAMES",undoable:o,fromLayerId:e,toLayerId:t});function LE(e,t){const{dispatch:o,state:a}=sr(),i=a.studioLocal.layerTempValues[e];if(i){for(const[s,n]of Object.entries(t))if(n!==i[s]){o(u_(e,t));break}}else o(u_(e,t))}function FE(e){if(0===Object.keys(e).length)return;const{dispatch:t}=sr();t(m_(e))}function ME(e,t,o){return Math.abs(t-e)<o}function UE(e,t=8){return+`${Math.round(`${parseFloat(e).toFixed(t)}e+${t}`)}e-${t}`}function BE(){const{state:e}=sr();return{height:e.studio.height,width:e.studio.width,x:e.studio.canvasX,y:e.studio.canvasY}}function VE(e,t,o){return{x:parseFloat(e)/100*o.width+o.x,y:parseFloat(t)/100*o.height+o.y}}function WE(e,t,o=BE()){return VE(e,t,{x:o.x,y:o.y,width:o.width||0,height:o.height||0})}function GE(e,t,o){return{width:parseFloat(e)/100*o.width,height:parseFloat(t)/100*o.height}}function HE(e,t,o=BE()){return GE(e,t,{width:o.width,height:o.height})}function $E(e,t,o){let a=50,i=50;return o.width&&o.height?(a=e/o.width*100,i=t/o.height*100,{widthPercent:a,heightPercent:i}):{widthPercent:a,heightPercent:i}}function KE(e,t,o){const{heightPercent:a,widthPercent:i}=$E(e,t,o);return{heightPercent:`${a}%`,widthPercent:`${i}%`}}function zE(e,t){const{state:o}=sr();return KE(e,t,{width:o.studio.width,height:o.studio.height})}function YE(e,t,o){let a=0,i=0;return void 0!==o.x&&void 0!==o.y&&o.width&&o.height?(a=(e-o.x)/o.width*100,i=(t-o.y)/o.height*100,{xPercent:a,yPercent:i}):{xPercent:a,yPercent:i}}function JE(e,t,o){const{xPercent:a,yPercent:i}=YE(e,t,o);return{xPercent:`${a}%`,yPercent:`${i}%`}}function qE(e,t){const{state:o}=sr(),{canvasX:a,canvasY:i}=o.studio;return JE(e,t,{x:a,y:i,width:o.studio.width,height:o.studio.height})}const XE=(e,t,o,a)=>{const{dispatch:i}=sr(),s=qE(t.x,t.y),n=zE(t.width,t.height);o?LE(e.id,{positionTemp:{x:s.xPercent,y:s.yPercent,width:n.widthPercent,height:n.heightPercent,rotation:t.rotation}}):(LE(e.id,{positionTemp:null}),i(Uv(e,s.xPercent,s.yPercent,n.widthPercent,n.heightPercent,a)),i(Wv(e,t.rotation,a)))},QE=e=>{const{state:t}=sr();let{canvasX:o,canvasY:a}=t.studio;const i=t.studio.width,s=t.studio.height;if(void 0===o||void 0===a||void 0===i||void 0===s)return null;aE()&&(o=0,a=0);const n=eI(e,{x:o,y:a,width:i,height:s});return e.position||XE(e,n),n},ZE=e=>{var t,o;const{state:a}=sr(),{canvasX:i,canvasY:s}=a.studio,n=a.studio.width,r=a.studio.height;if(void 0===i||void 0===s||void 0===n||void 0===r)return null;const l=eI(e,{x:i,y:s,width:n,height:r}),d=qE(l.x,l.y),c=zE(l.width,l.height);return{x:d.xPercent,y:d.yPercent,rotation:null==(t=null==e?void 0:e.position)?void 0:t.rotation,width:c.widthPercent,height:c.heightPercent,flip:null==(o=null==e?void 0:e.position)?void 0:o.flip}},eI=(e,t)=>{var o;const{state:{studioLocal:{layerTempValues:a}}}=sr();let{x:i,y:s,width:n,height:r}=t;const l=r,{lineWidth:d}=e,c=(null==(o=a[e.id])?void 0:o.positionTemp)||e.position,u=parseFloat(String(d))/100*l;if(c){const e=VE(c.x,c.y,t);i=e.x,s=e.y;const o=GE(c.width,c.height,t);n=o.width,r=o.height}else if(e.width&&e.height){const o=t.width/t.height,a=e.width/e.height;let l=t.width,d=t.height;a>=o?(d=e.height*t.width/e.width,s=(t.height-d)/2+t.y):(l=e.width*t.height/e.height,i=(t.width-l)/2+t.x),n=l,r=d}let m=0;if(e.position&&e.position.rotation&&(m=e.position.rotation),l)switch(e.lineRightAngle){case"horizontal":r=u;break;case"vertical":n=u}return{x:i,y:s,width:n,height:r,rotation:m}};function tI(e){const{state:t}=sr(),o=t.studio.width||0,a=t.studio.height||0;if(o>a){const t=zE(HE(e.width,e.height).height,0);e.width=t.widthPercent}else if(o<a){const t=zE(0,HE(e.width,e.height).width);e.height=t.heightPercent}return e}function oI(e,t,o,a){const{x:i,y:s,width:n,height:r}=a,l=VE(e.x,e.y,a);let d=l.x,c=l.y;if(function({x:e,y:t,width:o,height:a}){return 50===Math.round(parseFloat(e)+parseFloat(o)/2)||50===Math.round(parseFloat(t)+parseFloat(a)/2)}(e)){const{x:a,y:l,width:u,height:m}=e,p=d+t/2,h=c+o/2,g=i+n/2,f=s+r/2;50===Math.round(parseFloat(a)+parseFloat(u)/2)&&p!==g&&(d+=g-p),50===Math.round(parseFloat(l)+parseFloat(m)/2)&&h!==f&&(c+=f-h)}return{layerX:d,layerY:c}}function aI(e,t,o){var a,i;const{state:s}=sr(),{canvasX:n,canvasY:r}=s.studio,l={x:n,y:r,width:s.studio.width,height:s.studio.height,prevWidth:t,prevHeight:o};let d;if(!e.position)throw Error("Layer position missing");if(e.isAudiogram)d=(parseFloat(e.position.width)||parseFloat("100%"))/(parseFloat(e.position.height)||parseFloat("40%"));else if((null==(a=null==e?void 0:e.crop)?void 0:a.width)&&(null==(i=null==e?void 0:e.crop)?void 0:i.height)){d=e.width*e.crop.width/(e.height*e.crop.height)}else d=e.width/e.height;const{layerWidth:c,layerHeight:u}=function(e,t,o){const{width:a,height:i,prevWidth:s,prevHeight:n}=o;let r,l;const d=GE(e.width,e.height,o),c=a/i,u=s/n,m=Math.max(parseFloat(e.height)/100,parseFloat(e.width)/100);return t<=1?(l=d.height,r=l*t,r>a?(r=m*a,l=r/t):c>u&&(l=m*i,r=l*t)):(r=d.width,l=r/t,l>i?(l=m*i,r=l*t):c<u&&(r=m*a,l=r/t)),{layerWidth:r,layerHeight:l}}(e.position,d,l),{layerX:m,layerY:p}=oI(e.position,c,u,l);return{x:m,y:p,width:c,height:u}}function iI(e){const{state:{studio:{width:t=100,height:o=100}}}=sr(),{crop:a,position:i,lockAspectRatio:s,width:n=100,height:r=100}=e,l=n/r/(t/o);if(s)return!1;const{width:d,height:c}=i||{x:"0%",y:"0%",height:"100%",width:"100%",rotation:0},u=parseFloat(d),m=parseFloat(c);if(!a){if(!ME(u/m,l,.01))return!0}const{width:p,height:h}=a||{height:100,width:100,x:0,y:0,presetIndex:0};return!ME(u/(p/100)/(m/(h/100)),l,.01)}const sI=e=>{const{xPercent:t,yPercent:o}=qE(e.x,e.y),{widthPercent:a,heightPercent:i}=zE(e.width,e.height);return{x:t,y:o,width:a,height:i,rotation:e.rotation??0}},nI=(e,t,o)=>{if(!e.position)return{x:"0%",y:"0%"};if("ellipse"===e.shapeType)return s.pick(e.position,["x","y"]);const a=parseFloat(e.position.x)/100*t,i=parseFloat(e.position.y)/100*o;return{x:`${(a+parseFloat(e.position.width)/100*t/2)/t*100}%`,y:`${(i+parseFloat(e.position.height)/100*o/2)/o*100}%`}},rI=(e,t,o)=>{if(!e.position)return{x:"0%",y:"0%"};const a=nI(e,t,o),i=2*(parseFloat(a.x)-50),s=2*-(parseFloat(a.y)-50);return{x:`${+i.toFixed(2)}%`,y:`${+s.toFixed(2)}%`}},lI={name:"Moving Zoom",id:"moving-zoom",transitions:[{id:"moving-zoom-transition",easingFuncID:"linear",startValues:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},endValues:{topLeft:{x:.15,y:.15},bottomRight:{x:.85,y:.85}}}]},dI=[lI],cI=(e,t,o)=>{const a=XS(e),i=YS(a,t);if(o)return e.crop;return JS(e.crop,i)},uI=(e,t)=>{const{keyframeAnimation:o}=e,a=null==o?void 0:o.transitions[0];if(!o||!a)return null;const i={...a,...t};return{keyframeAnimation:{...e.keyframeAnimation,transitions:[i]}}},mI=vd,pI=[mI.OPACITY,mI.BRIGHTNESS,mI.CONTRAST,mI.SATURATION,mI.BLUR],hI={[zl.Audio]:[],[zl.Image]:[mI.POSITION,mI.ZOOM,mI.ROTATION,...pI],[zl.Shape]:[mI.POSITION,mI.BACKGROUND,mI.OPACITY],[zl.Text]:[mI.POSITION,mI.OPACITY],[zl.Video]:[mI.POSITION,mI.ZOOM,mI.ROTATION,...pI],[zl.Placeholder]:[]},gI=(e,t)=>{if(!(hI[e.type]||[]).includes(t))return!1;const[o,a]=TS(e);return!!(a-o)&&!e.keyframeAnimation},fI=e=>{var t;const{state:o}=sr(),a=Object.values((null==(t=o.studio.keyframing)?void 0:t[e])||{});for(const i of a)if(i.keyframes.length>0)return!0;return!1},yI=(e,t,o=sr().state.studio.keyframing)=>{var a,i;return!!((null==(i=null==(a=null==o?void 0:o[e])?void 0:a[t])?void 0:i.keyframes)||[]).length},vI=e=>yI(e,vd.POSITION)||yI(e,vd.ZOOM)||yI(e,vd.ROTATION),_I=e=>{if(!gI(e,vd.POSITION))return;if(!e.position)return;const{dispatch:t,state:o}=sr(),{x:a,y:i}=nI(e,o.studio.width||0,o.studio.height||0),[s]=TS(e),n=bE()-s;RI(e.id,n,vd.POSITION),t(EE(e.id,vd.POSITION,n,{x:a,y:i}))},wI=e=>{if(!gI(e,vd.ZOOM))return;const t=e.zoom||100,{dispatch:o}=sr(),[a]=TS(e),i=bE()-a;RI(e.id,i,vd.ZOOM),o(EE(e.id,vd.ZOOM,i,t))},bI=e=>{var t;if(!gI(e,vd.OPACITY))return;let o=(null==(t=e.filters)?void 0:t.opacity)??100;"shape"!==e.type&&"text"!==e.type||(o=100*(e.globalAlpha??1));const{dispatch:a}=sr(),[i]=TS(e),s=bE()-i;RI(e.id,s,vd.OPACITY),a(EE(e.id,vd.OPACITY,s,o))},TI=e=>{var t;if(!gI(e,vd.BRIGHTNESS))return;const o=(null==(t=e.filters)?void 0:t.brightness)??100,{dispatch:a}=sr(),[i]=TS(e),s=bE()-i;RI(e.id,s,vd.BRIGHTNESS),a(EE(e.id,vd.BRIGHTNESS,s,o))},xI=e=>{var t;if(!gI(e,vd.CONTRAST))return;const o=(null==(t=e.filters)?void 0:t.contrast)??100,{dispatch:a}=sr(),[i]=TS(e),s=bE()-i;RI(e.id,s,vd.CONTRAST),a(EE(e.id,vd.CONTRAST,s,o))},SI=e=>{var t;if(!gI(e,vd.SATURATION))return;const o=(null==(t=e.filters)?void 0:t.saturate)??100,{dispatch:a}=sr(),[i]=TS(e),s=bE()-i;RI(e.id,s,vd.SATURATION),a(EE(e.id,vd.SATURATION,s,o))},EI=e=>{var t;if(!gI(e,vd.BLUR))return;const o=(null==(t=e.filters)?void 0:t.blurPercent)??0,{dispatch:a}=sr(),[i]=TS(e),s=bE()-i;RI(e.id,s,vd.BLUR),a(EE(e.id,vd.BLUR,s,o))},II=e=>{if(!gI(e,vd.BACKGROUND))return;const t=e.background??"#000000",{dispatch:o}=sr(),[a]=TS(e),i=bE()-a;RI(e.id,i,vd.BACKGROUND),o(EE(e.id,vd.BACKGROUND,i,t))},CI=(e,t,o,a,i)=>{var s,n,r,l;if(!e.position)return{x:"0%",y:"0%",height:"0%",width:"0%",rotation:0};if(!t)return e.position;const d=(null==(s=t[vd.POSITION])?void 0:s.keyframes)||[],c=(null==(n=t[vd.ZOOM])?void 0:n.keyframes)||[],u=(null==(r=t[vd.ROTATION])?void 0:r.keyframes)||[],m=!!d.length,p=!!c.length,h=!!u.length;if(!m&&!p&&!h)return e.position;const[g]=TS(e);let f,y=!1;if(m){y=!0;const a=(null==(l=t[vd.POSITION])?void 0:l.bezArray)||null,{prevFrame:i,nextFrame:s}=tx(e,o,d);if(s&&i){const t={...e.position,...i.value},n={...e.position,...s.value};let r=0,l=0;if(a){const e=$(...a),d=i.time,c=e((o-g-d)/(s.time-d)),u=parseFloat(n.x)-parseFloat(t.x),m=parseFloat(n.y)-parseFloat(t.y);r=u*c,l=m*c}f={...t,x:`${parseFloat(t.x)+r}%`,y:`${parseFloat(t.y)+l}%`}}else{const t=(null==s?void 0:s.value)||{},o=(null==i?void 0:i.value)||{};f={...e.position,...t,...o}}}return y||(f=nI(e,a,i)),f={...e.position,...f,...AI(e,t,o),...jI(e,t,o)},((e,t,o)=>{if(!e.position)return{x:"0%",y:"0%",height:"0%",width:"0%",rotation:0};if("ellipse"===e.shapeType)return e.position;const a=parseFloat(e.position.x)/100*t,i=parseFloat(e.position.y)/100*o,s=(a-parseFloat(e.position.width)/100*t/2)/t*100,n=(i-parseFloat(e.position.height)/100*o/2)/o*100;return{...e.position,x:`${s}%`,y:`${n}%`}})({...e,position:f},a,i)},kI=(e,t,o)=>{var a,i;const s=e.zoom||100;if(!t)return s;const n=(null==(a=t[vd.ZOOM])?void 0:a.keyframes)||[],r=(null==(i=t[vd.ZOOM])?void 0:i.bezArray)||null;if(!n.length)return s;const[l]=TS(e),{prevFrame:d,nextFrame:c}=tx(e,o,n);let u=s;return u=d&&c?ox(r,o-l,d,c):(null==d?void 0:d.value)||(null==c?void 0:c.value)||(null==e?void 0:e.zoom)||100,u},AI=(e,t,o)=>{var a;const i=s.pick(e.position,["width","height"]);if(!t)return i;if(!((null==(a=t[vd.ZOOM])?void 0:a.keyframes)||[]).length||!e.position)return i;const n=e.zoom||100,r=kI(e,t,o)/n;return{width:`${parseFloat(e.position.width)*r}%`,height:`${parseFloat(e.position.height)*r}%`}},jI=(e,t,o)=>{var a,i,s;const n={rotation:(null==(a=e.position)?void 0:a.rotation)??0};if(!t)return n;const r=(null==(i=t[vd.ROTATION])?void 0:i.keyframes)||[];if(!r.length||!e.position)return n;const l=(null==(s=t[vd.ROTATION])?void 0:s.bezArray)||null,[d]=TS(e),{prevFrame:c,nextFrame:u}=tx(e,o,r);return n.rotation=c&&u?ix(l,o-d,c,u):(null==c?void 0:c.value)??(null==u?void 0:u.value)??n.rotation,n},NI=e=>{var t;return Object.values((null==(t=sr().state.studio.keyframing)?void 0:t[e])||{}).reduce(((e,t)=>e.concat(t.keyframes)),[]).sort(((e,t)=>e.time-t.time))},RI=(e,t,o)=>{var a,i,s;const{state:n}=sr();((null==(s=null==(i=null==(a=n.studio.keyframing)?void 0:a[e])?void 0:i[o])?void 0:s.keyframes)||[]).find((({time:e})=>t===e))||Fm(ym.ADDED_KEYFRAME,{channel:o})},PI={[vd.OPACITY]:bI,[vd.BRIGHTNESS]:TI,[vd.CONTRAST]:xI,[vd.SATURATION]:SI,[vd.BLUR]:EI,[vd.POSITION]:_I,[vd.ZOOM]:wI,[vd.BACKGROUND]:II,[vd.ROTATION]:e=>{var t;if(!gI(e,vd.ROTATION))return;const o=(null==(t=e.position)?void 0:t.rotation)??0,{dispatch:a}=sr(),[i]=TS(e),s=bE()-i;RI(e.id,s,vd.ROTATION),a(EE(e.id,vd.ROTATION,s,o))}};function DI(e,t,o=[0,0]){const[a,i]=e,[s,n]=o,r=t*Math.PI/180,l=Math.cos(r),d=Math.sin(r);return[s+(a-s)*l-(i-n)*d,n+(a-s)*d+(i-n)*l]}const OI=(e,t,o=!1)=>{if(0===Object.keys(e).length)return;const{dispatch:a}=sr();o?ff.execInUndoBatch((()=>{a(Jv(e,t,o))})):a(Jv(e,t,o))};function LI(e){var t,o;const{state:a}=sr(),i=(null==(t=a.studioLocal.layerTempValues[e.id])?void 0:t.positionTemp)||CI(e,null==(o=a.studio.keyframing)?void 0:o[e.id],bE(),a.studio.width||0,a.studio.height||0);if(!i)return null;const{canvasX:s,canvasY:n}=a.studio,r=a.studio.width,l=a.studio.height;if(void 0===s||void 0===n||void 0===r||void 0===l)return null;const{x:d,y:c,width:u,height:m,rotation:p=0}=i;let h=parseFloat(d),g=parseFloat(c),f=parseFloat(u),y=parseFloat(m);if(e.crop){const t=Math.sin(p*Math.PI/180),o=Math.cos(p*Math.PI/180),{width:a,height:i,x:s,y:n}=e.crop,d=100-s-a,c=100-n-i;f/=a/100,y/=i/100;const u=f*r/100,m=y*l/100,v=s*u/100,_=d*u/100,w=n*m/100,b=c*m/100,T={topLeft:{x:h*r/100,y:g*l/100},topRight:{x:h*r/100+u*a/100,y:g*l/100},bottomLeft:{x:h*r/100,y:g*l/100+m*i/100},bottomRight:{x:h*r/100+u*a/100,y:g*l/100+m*i/100},center:{x:h*r/100+u*a/200,y:g*l/100+m*i/200}};if(Object.keys(T).forEach((e=>{const t=e;if("center"===t)return;const[o,a]=DI(Object.values(T[t]),p,[T.center.x,T.center.y]);T[t].x=o,T[t].y=a})),0===p)h-=u*s/r,g-=m*n/l;else if(p<90){T.topLeft.y-=v*t+w*o,T.topLeft.x+=w*t-v*o,T.topRight.y+=_*t-w*o,T.topRight.x+=w*t+_*o,T.bottomLeft.y-=v*t-b*o,T.bottomLeft.x-=b*t+v*o,T.bottomRight.y+=_*t+b*o,T.bottomRight.x-=b*t-_*o,T.center.x=(T.topLeft.x+T.bottomLeft.x+T.bottomRight.x+T.topRight.x)/4,T.center.y=(T.topLeft.y+T.bottomLeft.y+T.bottomRight.y+T.topRight.y)/4;const e=[T.center.x,T.center.y],a=DI([T.topLeft.x,T.topLeft.y],-p,e);h=100*a[0]/r,g=100*a[1]/l}else if(90===p){T.topLeft.y-=s*u/100,T.topLeft.x+=n*m/100,T.topRight.y+=d*u/100,T.topRight.x+=n*m/100,T.bottomLeft.y-=s*u/100,T.bottomLeft.x-=c*m/100,T.bottomRight.y+=d*u/100,T.bottomRight.x-=c*m/100,T.center.x=(T.topLeft.x+T.bottomLeft.x+T.bottomRight.x+T.topRight.x)/4,T.center.y=(T.topLeft.y+T.bottomLeft.y+T.bottomRight.y+T.topRight.y)/4;const e=[T.center.x,T.center.y],t=DI([T.topLeft.x,T.topLeft.y],-p,e);h=100*t[0]/r,g=100*t[1]/l}else if(p<180){T.topLeft.y+=-v*t-w*o,T.topLeft.x+=w*t-v*o,T.topRight.y+=_*t-w*o,T.topRight.x+=w*t+_*o,T.bottomLeft.y+=-v*t+b*o,T.bottomLeft.x+=-b*t-v*o,T.bottomRight.y+=_*t+b*o,T.bottomRight.x+=-b*t+_*o,T.center.x=(T.topLeft.x+T.bottomLeft.x+T.bottomRight.x+T.topRight.x)/4,T.center.y=(T.topLeft.y+T.bottomLeft.y+T.bottomRight.y+T.topRight.y)/4;const e=[T.center.x,T.center.y],a=DI([T.topLeft.x,T.topLeft.y],-p,e);h=100*a[0]/r,g=100*a[1]/l}else if(180===p)h-=u*d/r,g-=m*c/l;else if(p<270){T.topLeft.y-=v*t+w*o,T.topLeft.x+=w*t-v*o,T.topRight.y+=_*t-w*o,T.topRight.x+=w*t+_*o,T.bottomLeft.y-=v*t-b*o,T.bottomLeft.x-=b*t+v*o,T.bottomRight.y+=_*t+b*o,T.bottomRight.x-=b*t-_*o,T.center.x=(T.topLeft.x+T.bottomLeft.x+T.bottomRight.x+T.topRight.x)/4,T.center.y=(T.topLeft.y+T.bottomLeft.y+T.bottomRight.y+T.topRight.y)/4;const e=[T.center.x,T.center.y],a=DI([T.topLeft.x,T.topLeft.y],-p,e);h=100*a[0]/r,g=100*a[1]/l}else if(270===p){T.topLeft.y+=s*u/100,T.topLeft.x-=n*m/100,T.topRight.y-=d*u/100,T.topRight.x-=n*m/100,T.bottomLeft.y+=s*u/100,T.bottomLeft.x+=c*m/100,T.bottomRight.y-=d*u/100,T.bottomRight.x+=c*m/100,T.center.x=(T.topLeft.x+T.bottomLeft.x+T.bottomRight.x+T.topRight.x)/4,T.center.y=(T.topLeft.y+T.bottomLeft.y+T.bottomRight.y+T.topRight.y)/4;const e=[T.center.x,T.center.y],t=DI([T.topLeft.x,T.topLeft.y],-p,e);h=100*t[0]/r,g=100*t[1]/l}else{T.topLeft.y+=-v*t-w*o,T.topLeft.x+=w*t-v*o,T.topRight.y+=_*t-w*o,T.topRight.x+=w*t+_*o,T.bottomLeft.y+=-v*t+b*o,T.bottomLeft.x+=-b*t-v*o,T.bottomRight.y+=_*t+b*o,T.bottomRight.x+=-b*t+_*o,T.center.x=(T.topLeft.x+T.bottomLeft.x+T.bottomRight.x+T.topRight.x)/4,T.center.y=(T.topLeft.y+T.bottomLeft.y+T.bottomRight.y+T.topRight.y)/4;const e=[T.center.x,T.center.y],a=DI([T.topLeft.x,T.topLeft.y],-p,e);h=100*a[0]/r,g=100*a[1]/l}}const{x:v,y:_}=VE(h,g,{height:l,width:r,x:s,y:n}),{width:w,height:b}=GE(f.toString(),y.toString(),{height:l,width:r,x:s,y:n});return{x:v,y:_,width:w,height:b}}function FI(e){const t=MI(e);OI({[e.id]:{crop:t}},"commitLayerImplicitCropToExplicitCrop",!0)}const MI=e=>{let t={width:100,height:100,x:0,y:0};const{crop:o,position:a,width:i=100,height:s=100}=e;o&&(t=o);const n={...t};if(!a)return;const r=QE(e),l=LI(e);if(!r)return;if(!l)return;const{width:d,height:c}=r,{width:u,height:m}=l,p=i/s;if(d/c<i*t.width/(s*t.height)){const e=m*p,t=n.width;n.width*=u/e;const o=t-n.width;n.x+=o/2}else{const e=u/p,t=n.height;n.height*=m/e;const o=t-n.height;n.y+=o/2}return n},UI=()=>"undefined"!=typeof MediaSource,BI=({isCanvas:e=!1,mediaPipe:t=!1}={})=>{var o;if(!UI())return!1;const a=(new D.UAParser).getBrowser();if(!(null==(o=a.name)?void 0:o.includes("Safari")))return!0;if(t)return!1;const i=(()=>{if(null==a.version)return!1;return parseInt(a.version)<16||("16.0"===a.version||"16.2"===a.version)})();return!e||!i};function VI(e){return null!=sr().state.studio.allLayers.byId[e]}function WI(e){return`${e}%`}function GI(e){return parseInt(e,10)}function HI(e){var t;return!!(UI()&&(null==(t=e.preview)?void 0:t.fragmented)||e.local_url)}function $I(e="30%",t="30%"){const o=GI(e),a=GI(t),i=10*Math.random()-5,s=(100-a)/2;return{x:WI((100-o)/2+i),y:WI(s+i),width:e,height:t,rotation:0}}function KI(e,t,o){return(e.x-t.x)*Math.sin(o)+(e.y-t.y)*Math.cos(o)+t.y}function zI(e,t,o){return(e.x-t.x)*Math.cos(o)-(e.y-t.y)*Math.sin(o)+t.x}function YI(e,t,o){return{x:zI(e,t,o),y:KI(e,t,o)}}const JI=e=>e*Math.PI/180;function qI(e){let t,o,a,i;if("percent"===e.positionType){const{position:s}=e,n=s.x,r=s.y,l=s.width,d=s.height;({width:t,height:o}=HE(l,d)),({x:a,y:i}=WE(n,r))}else{const{position:s}=e;({width:t,height:o,x:a,y:i}=s)}const s=e.position.rotation||0;"ellipse"===e.shapeType&&(a-=t/2,i-=o/2);const n={x:a+t/2,y:i+o/2},r=YI({x:a,y:i},n,JI(s)),l=YI({x:a+t,y:i},n,JI(s)),d=YI({x:a,y:i+o},n,JI(s));return{tl:r,tr:l,br:YI({x:a+t,y:i+o},n,JI(s)),bl:d}}function XI(e){let t={top:window.screen.height,right:0,bottom:0,left:window.screen.width};for(const i of e){if("audio"===i.type)continue;if(!i.position)continue;const{tl:e,tr:o,bl:a,br:s}=qI({position:i.position,shapeType:i.shapeType,positionType:"percent"}),n=[e,o,a,s];t={top:Math.min(t.top,...n.map((e=>e.y))),right:Math.max(t.right,...n.map((e=>e.x))),bottom:Math.max(t.bottom,...n.map((e=>e.y))),left:Math.min(t.left,...n.map((e=>e.x)))}}const o=t.right-t.left,a=t.bottom-t.top;return{x:t.left+o/2,y:t.top+a/2}}function QI(e){return!(e.filters&&0!==Object.keys(e.filters).length||e.presetFilter&&0!==Object.keys(e.presetFilter).length)}function ZI(e){return!e.chromaKey&&!e.removeBg&&!e.blurBg}function eC(e,t){if(!e.height||!e.width||!e.position)return!1;const{position:o}=e,a=.01,i=e.width/e.height,s=Math.abs(t-i)<=a,n=Math.abs(100-parseFloat(o.width))<=a,r=Math.abs(100-parseFloat(o.height))<=a,l=Math.abs(0-parseFloat(o.x))<=a,d=Math.abs(0-parseFloat(o.y))<=a,c=o.flip&&(o.flip.x||o.flip.y);return n&&r&&l&&d&&!c&&0===o.rotation&&s}function tC(e,t){const o=[];for(const a of e)for(const e of a.layers)t.includes(e.id)&&o.push(e);return o}function oC(e){return"image/webp"===e.mime?"static"===e.webpType:"audio"!==e.type&&"video"!==e.type}const aC={startTime:0,endTime:Number.MAX_VALUE};function iC(e,t){if(!t)return e;const{diff:o,type:a,leftMost:i}=t,{startTime:s=0,endTime:n=0,videoDelay:r=0}=e,l=oC(e);let d;return d="drag"===a?l?i?aC:{startTime:s+o,endTime:n+o}:{videoDelay:r+o}:"trim-start"===a?l?aC:{videoDelay:r+o,startTime:s+o}:l?aC:{endTime:n+o},{...e,...d}}function sC(e,t){const o=sr().state.studio.scenes[0];if(!o)throw new Error("Scene not found");const a=o.duration,i={...e,isTrimmed:!0},s=!oC(e);if(!oC(t)){const o=dm(t),a=(o.endTime-o.startTime)/o.playbackRate;if(s){const t=Math.min(a,e.duration??0);i.videoDelay=o.videoDelay,i.startTime=0,i.endTime=t}else{const{videoDelay:e=0}=t;i.startTime=e,i.endTime=e+a}}else if(s)if(0===t.startTime&&0===t.endTime)i.videoDelay=0,i.startTime=0,i.endTime=Math.max(a,e.duration??0);else{const o=(t.endTime??3)-(t.startTime??0);i.videoDelay=t.startTime,i.startTime=0,i.endTime=Math.min(o,e.duration??0)}else i.startTime=t.startTime,i.endTime=t.endTime;return t.position&&("text"===i.type&&i.position?(i.position.x=t.position.x,i.position.y=t.position.y):i.position=t.position),t.filters&&(i.filters=t.filters),t.presetFilter&&(i.presetFilter=t.presetFilter),i.converted_type=void 0,i}function nC(e){return!(e.requireConversion||"gif-to-webm"===e.conversion_type)}function rC(e){return!(!e.isReversed&&!e.isAudiogram)||!!om(e)&&!!(e.removeBg||e.blurBg||e.chromaKey||!tS(e)||e.audioEffect)}function lC(e){return!(rC(e)||!nC(e)||Zu(e)&&!e.isAudiogram||!e.width||!e.height)}function dC(e){return!!lC(e)||!(!om(e)&&!Zu(e))&&!(rC(e)||!nC(e))}const cC=1/30,uC=(e,t)=>{let o=0,a="",i=!1;const{isImageVideo:s}=e,{layers:n}=e;for(const l of n){const e=!(Zu(l)||om(l));if(!l.isTrimmed&&e)continue;if(l.isTrimmed&&(i=!0),e){const e=Number(l.endTime||0);e>o&&(o=e,a=l.id);continue}if(om(l)&&!l.converted_gif&&(i=!0),om(l)&&l.converted_gif)continue;const t=Number(l.videoDelay||0);let s=um(l);s+=t,s>o&&(o=s,a=l.id)}const r=e.userSelectedDuration||0;if(o||(o=0),0===o&&s&&(o=e.duration||r||5),i||(o=Math.max(o,r)),null==t?void 0:t.byId)for(const l of Object.values(null==t?void 0:t.byId))l&&l.end>o&&(o=l.end);return o=wS(o),{duration:o,maxLayerId:a}};function mC(e,t=!0){return{type:"SET_CANVAS_BLUR",value:e,undoable:t}}function pC(e){return{type:"SET_SNAP_TO_GRID",value:e}}function hC(e){return{type:"SELECT_SAFEZONE",value:e}}function gC(e,t){return{color:e,type:"SET_STUDIO_BACKGROUND",undoable:t}}function fC(){return{type:"SHOW_STUDIO_CANVAS"}}function yC(e=!1){return{type:"SET_IMAGE_VIDEO",isImageVideo:e}}function vC(e=0,t=!1){return{type:"SET_STUDIO_DURATION",duration:e,undoable:t}}const _C=(e,t)=>({type:"ADD_MAGIC_SUBTITLE",assetId:e,initialProperties:t,undoable:!0}),wC=e=>({type:"REMOVE_MAGIC_SUBTITLE",assetId:e,undoable:!0}),bC=({updates:e,assetId:t,undoable:o=!0})=>({type:"UPDATE_MAGIC_SUBTITLE",assetId:t,updates:e,undoable:o}),TC=/[\uFFE5\u3000-\u303F!.,:?;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]$/,xC=e=>TC.test(e),SC=[".","!","?"];const EC=(e,t)=>!!t&&(!!function(e){return!!e.startsWith("en")||"es"===e||"fr"===e}(t)&&SC.some((t=>e.endsWith(t)))),IC=!(!Intl||!Intl.Segmenter);function CC(e){let t=0,o=0;for(const a of e)AC(a)||(a.includes(" ")?t+=1:o+=1);return t/(t+o)>.1?" ":""}function kC(e){const t=pn.get(e);if(!t)return" ";const{noSpaces:o}=t;return o?"":" "}const AC=e=>/^[^\S\n]*$/.test(e);function jC({cursorIndex:e=0,locale:t,text:o}){if(!t||!IC)return function({text:e,cursorIndex:t}){const o=e.split(/(\s)/g).filter((e=>""!==e)),a=[];for(const r of o){const e=a[a.length-1];"\n"===r&&(e?a[a.length-1]+="\n":a.push("\n")),NC(r)||(e&&Array.from(e).every((e=>"\n"===e))?a[a.length-1]+=r:a.push(r))}let i=0===t?-1:0;const s=a[0];if(void 0===s)return{segments:[],cursorSegmentIndex:i};let n=s.length+1;for(;n<t&&!(i>=a.length-1);){i+=1;const e=a[i];if(void 0===e||NC(e))break;n+=e.length+1}return{segments:a,cursorSegmentIndex:i}}({cursorIndex:e,text:o});const a=function({locale:e,text:t}){const o=new Intl.Segmenter(e,{granularity:"word"}).segment(t),a=[];let i="",s=!1;function n(){for(let e=a.length-1;e>=0;e--){const t=a[e];if(t&&!AC(t))return e}return-1}function r(){if(i.length>0){if(Array.from(i).every((e=>"\n"===e))){const e=n(),t=a[e];if(!t)return;a[e]=t+i}else a.push(i);i=""}}for(const{segment:l,isWordLike:d}of o){if(!d&&AC(l)){r(),a.push(l);continue}const e=d&&!s||i.endsWith("\n")&&"\n"!==l,t=!Array.from(i).every((e=>"\n"===e));e&&t&&r(),i+=l,s=!d&&"\n"!==l}return r(),a}({locale:t,text:o}),i=[],s=[];for(const d of a)if(AC(d)){void 0!==s[s.length-1]&&(s[s.length-1]+=d)}else i.push(d),s.push(d);let n=0===e?-1:0;const r=s[0];let l=(null==r?void 0:r.length)??0;for(;l<e&&!(n>=s.length-1);){n+=1;const e=s[n];if(void 0===e)break;l+=e.length}return{segments:i,cursorSegmentIndex:n}}const NC=e=>null!==e.match(/\s/);const RC=16,PC=e=>e?xC(e.word)?.5:1:.5;function DC({languageCode:e,maxCharsPerSubtitle:t,separator:o,words:a}){const i=[];function n(a){const s=a[0];if(!s)return;let n=[a];const r=i[i.length-1],l=r?r.flat():[],d=l[l.length-1];if(r&&d){const c=xC(d.word),u=l.length>1,m=s.start_time-d.end_time>PC(d);if(u&&!c&&!m){const s=r.flat(),l=a.flat();for(let e=s.length-1;e>=0;e-=1){const t=s[e];if(!t)throw Error("Missing left word");if(xC(t.word))break;s.splice(e,1);if(s.map((e=>e.word)).join(o).length<=[t,...l].map((e=>e.word)).join(o).length){s.push(t);break}l.unshift(t)}const[d]=DC({languageCode:e,words:s,maxCharsPerSubtitle:t,separator:o});d&&(i[i.length-1]=d);n=DC({languageCode:e,words:l,maxCharsPerSubtitle:t,separator:o})}}i.push(...n)}let r=[];const l=[...a],d=l.length;for(;l.length>0;){if(l.length>d)throw Error();const a=l.shift();if(!a)throw Error();const i=r.flat(),c=i[i.length-1],u=c?c.end_time:0;let m=!1;const p=a.start_time-u>PC(c),h=i.length>4&&c&&EC(c.word,e);(p||h)&&(m=!0);[...r,a].map((e=>e.word)).join(o).length>t&&(m=!0);let g=!0;if(m&&r.length){let d=r;if(!(!!c&&xC(c.word))){if(i.some((e=>xC(e.word)))){const n=s.findLastIndex(i,(e=>xC(e.word))),r=i.slice(0,n+1),c=[...i.slice(n+1),a],[u]=DC({languageCode:e,words:r,maxCharsPerSubtitle:t,separator:o});u&&(d=u),l.unshift(...c),g=!1}}n(d),r=[]}g&&r.push(a)}return r.length>0&&n(r),i}function OC(e,t){const{id:o,duration:a}=t;if(void 0===a)throw Error("Cannot transcribe asset with no duration");const i={id:o,asset_id:t.asset_id,type:"video",videoDelay:0,startTime:0,endTime:a,duration:a,url:t.url};return{_id:e,isStudio:!0,scenes:[{background:"#ffffff",duration:a,id:P(),layers:[i],userSelectedDuration:0,userSetDuration:!1}],duration:a}}function LC(e,t,o){const{fontSize:a,lineHeight:i}=e,s=t.reduce(((e,t)=>Math.max(e,t.width)),0),n=t.length,r=a*n+(i-1)*a*n;let{y:l}=o;const d=Math.max(s-o.width,0);let c=o.x-d/2,u=Math.max(s,o.width);u+=.5,c+=.25;let m=0;return"bottom"===e.verticalAlign?m=-r:"middle"===e.verticalAlign&&(m=-r/2),l+=m,{x:c,y:l,width:u,height:r,rotation:o.rotation,yOffset:m,xDiff:d}}const FC=1.5;function MC({distributed:e,removeGaps:t,type:o}){let a="";return e.reduce(((e,i)=>{const s=i[0],n=i[i.length-1];if(!s||!n)throw Error("Empty frame");const r=P();let l=s.start_time;const d=n.end_time;if(t){const t=e[a];if(t){const e=l-t.end;if(e<1.5){const o=e/2;t.end+=o,l-=o}}}a=r;const{newFrameProperties:c}=i.find((e=>e.newFrameProperties))||{};return e[r]={id:r,words:i.flat(1).map((e=>{const t="simple"===o?{text:e.word}:{end:e.end_time,start:e.start_time,text:e.word};return e.styles&&(t.styles=e.styles),t})),start:l,end:d,...c},e}),{})}function UC(e){const t=CC(e.map((e=>e.text)));return e.reduce(((e,o)=>{const a=o.text.split(t).map((e=>({text:e}))),i=P();return e[i]={id:i,start:o.start,end:o.end,words:a},e}),{})}function BC(e){const{heightPercent:t,widthPercent:o}=function(e,t){const{state:o}=sr();return $E(e,t,{width:o.studio.width,height:o.studio.height})}(e.width,e.height),{xPercent:a,yPercent:i}=function(e,t){const{state:o}=sr(),{canvasX:a,canvasY:i}=o.studio;return YE(e,t,{x:a,y:i,width:o.studio.width,height:o.studio.height})}(e.x,e.y);return{heightPct:t,widthPct:o,xPct:a,yPct:i,rotation:e.rotation}}const VC=e=>{if("text"===e.type){const{fontFamily:t,asset_id:o,url:a}=e;if(t)return a&&o?{type:"custom",fontFamily:t,url:a,asset_id:o}:{type:"default",fontFamily:t}}return null};function WC(e){return`"${e}", Noto Sans, Apple Color Emoji, Noto Color Emoji`}function GC(e,t=e.fallbackFonts||[]){let o=WC(e.fontFamily);return t.length&&(o+=`, ${t.join(", ")}`),o}function HC(e,t,o){const a=[];e.italic&&a.push("italic"),e.fontWeight&&a.push(e.fontWeight);const i=`${t}px/${null!=e.lineHeight?e.lineHeight:1}`;a.push(i),a.push(GC(e,o));return a.join(" ")}const $C=.1,KC=.08,zC=45,YC="rtl",JC="ltr",qC={};function XC(e,t,o,a){const i=`${e}_${o}_${a}_${(e=>JSON.stringify(e))(t)}`;if(!qC[i]){if(Object.keys(qC).length>=5){const e=Object.entries(qC).sort(((e,t)=>e[1].lastUpdated-t[1].lastUpdated))[0];if(e){const[t]=e;delete qC[t]}}qC[i]={lastUpdated:Date.now(),wordSizer:new QC(t,o)}}const s=qC[i];if(!s)throw Error("Missing cached");return s.lastUpdated=Date.now(),s.wordSizer}class QC{constructor(e,t){i(this,"widths",new Map),i(this,"useCachedWidth",!1),i(this,"useCachedWidthTimeout"),i(this,"contexts",new Map),i(this,"textHeight"),this.style=e,this.scaledFontSize=t,this.textHeight=this.scaledFontSize*this.style.lineHeight}initalizeCtx(e){const t=document.createElement("canvas");t.width=800,t.height=500;const o=t.getContext("2d");if(!o)throw Error("Missing ctx");const a=[e,`${this.scaledFontSize}px`,WC(this.style.fontFamily.fontFamily)].filter((e=>!!e)).join(" ");return o.font=a,o}getCtx(e){const t=this.getWordStyleKey(e);if(!this.contexts.has(t)){const e="bold"===t?"bold":"normal";this.contexts.set(t,this.initalizeCtx(e))}const o=this.contexts.get(t);if(!o)throw Error("Missing ctx");return o}measureWord(e){return this.getCtx(e).measureText(this.getWordText(e)).width}getWordStyleKey({text:e,styles:t}){var o;if(Object.values(t||{}).some((e=>"bold"===e.fontWeight)))return"bold";if(t){let a=!0;for(let i=0;i<e.length;i++)"\n"!==e[i]&&(a=a&&"normal"===(null==(o=t[i])?void 0:o.fontWeight));if(a)return"normal"}return this.style.fontWeight}getWordText(e){return" "===e.text?" ":e.text.trim()}getWidth(e){const t=`${this.getWordText(e)} ${this.getWordStyleKey(e)}`;let o=e;return"uppercase"===this.style.textTransform?o={...e,text:e.text.toUpperCase()}:"lowercase"===this.style.textTransform&&(o={...e,text:e.text.toLowerCase()}),this.widths.has(t)&&this.useCachedWidth||this.widths.set(t,this.measureWord(o)),this.useCachedWidth||this.useCachedWidthTimeout||(this.useCachedWidthTimeout=setTimeout((()=>{this.useCachedWidth=!0,this.useCachedWidthTimeout=null}),50)),this.widths.get(t)??0}}const ZC="/assets/waveform-86d6820a.png";function ek({asset:e,fallback:t,timelineLayer:o,uploadingLayer:a,cmlFile:i}){return i&&i.fileName?i.fileName:e&&e.name?e.name:a&&a.name?a.name:(null==o?void 0:o.name)?o.name:e&&e.blob_name?e.blob_name:t}function tk({asset:e,uploadingLayer:t}){return e&&e.metadata_stage&&"number"==typeof e.duration?e.duration:t&&"image"!==t.type?t.duration??null:null}function ok({asset:e,framePercentage:t=0,idbAsset:o,timelineLayer:a}){var i,s,n,r,l;if(e&&(null==(i=e.content_type)?void 0:i.startsWith("audio")))return"/assets/waveform-86d6820a.png";if((null==(s=null==e?void 0:e.content_type)?void 0:s.startsWith("image"))&&(null==(n=null==e?void 0:e.preview)?void 0:n.url))return null==(r=e.preview)?void 0:r.url;const d=null==a?void 0:a.type;if(e&&e.url&&((null==(l=e.content_type)?void 0:l.startsWith("image"))||"image"===d)&&!e.conversion_id)return e.url;if(e&&e.metadata_stage&&e.thumbnails){const o=Math.round(t*(e.thumbnails.length-1)),a=e.thumbnails[o];if(a)return function(e,t={}){const{bucket:o=hn}=t;return o===hn?`${yn}/${e}`:`https://cdn.kapwing.com/${e}`}(a,{bucket:e.bucket_name})}return o&&"thumbnail"in o&&o.thumbnail?URL.createObjectURL(o.thumbnail):e&&e.pasted_link_thumbnail?e.pasted_link_thumbnail:null}function ak(e){var t;return(null==(t=e.original_asset)?void 0:t.asset_id)||e.asset_id}const ik=(e,t)=>{const{hasMagicSubtitle:o,shortRowCount:a,tallRowCount:i}=e;return 30*a+60*i+30*(o?1:0)+(t?25:0)+10},sk=(e,t,o)=>{if(-1===e)return{hasMagicSubtitle:o,shortRowCount:0,tallRowCount:0};const a=new Set;for(const s of t){const t=s.timelineRow??0;e>t&&lk(s)&&a.add(t)}const i=a.size;return{hasMagicSubtitle:o,shortRowCount:e-i,tallRowCount:i}},nk=({yPos:e,tracks:t,hasComments:o,hasMagicSubtitle:a,gutter:i=!1})=>{const s=[];for(const{isTall:d,timelineRow:c}of t){const e=ck(d);s[c]=Math.max(e,s[c]??0)}let n=ik({hasMagicSubtitle:a,shortRowCount:0,tallRowCount:0},o);const r=Math.max(n,e);for(let d=0;d<s.length;d+=1){const e=n+(s[d]??30);if(n<=r&&r<e){if(i){return(r-n)/(e-n)<.5?d:d+1}return d}n=e}const l=Math.ceil((r-n)/30);return s.length-1+l},rk=(e,t,o)=>{let{previewIsTall:a}=t,{previewTop:i}=t;const s=[];let n=!1;return Object.values(o).forEach((t=>{const{shrunkTimelineRow:o,expandedTimelineRow:r,newTimelineRow:l,newIsTall:d}=t;s.includes(l)||(d&&l===e&&(a=!0,n=!0),null!==o&&(o!==e||n||(a=!1),o<e&&(i-=30)),null!==r&&(r!==e||n||(a=!0),r<e&&(i+=30)),s.push(l))})),{previewIsTall:a,previewTop:i}};function lk(e){return e.type===zl.Video||e.type===zl.Audio}const dk=(e,t,o)=>!!t.some((t=>{const a=lk(t);let i=!0;return o&&(i=!o.includes(t.id)),a&&i&&t.timelineRow===e})),ck=e=>e?60:30,uk=e=>60===e,mk=e=>ck(lk(e)),pk=-1,hk=[],gk=m((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),(e=>e||hk));function fk(e){const t=e.sort(((e,t)=>e.start-t.start)),o=[];let a=null;for(const i of t)null!==a?i.start<a.end?a.end=i.end:(o.push(a),a=i):a=i;return a&&o.push(a),o}const yk=2,vk=120,_k=(...e)=>e.join("|"),wk=e=>{return(e=>om(e)||Zu(e))(e)&&!((t=e).detachedAudioId&&"video"===t.type);var t},bk=m((e=>e.studio.allLayers.byId),(e=>s.uniq(Object.values(e).filter(wk).map(ak).filter(Ir)))),Tk=m((e=>e.uploadStatuses),((e={})=>Object.values(e).filter((e=>e.stage!==Sv.errored&&e.stage!==Sv.done)).map((e=>{var t;const o=null==(t=e.uploadManager)?void 0:t.layer;return o&&wk(o)?o:null})).filter(Ir))),xk=s.memoize((e=>m(gk,(t=>t.filter(wk).filter((t=>e.includes(ak(t)??""))))))),Sk=s.memoize(((e,t)=>m((o=>{var a;return(null==(a=o.assetTranscriptions.byId[e])?void 0:a[t])||null}),xk(e),((e,t)=>"completed"!==(null==e?void 0:e.state)||t.some((t=>{const o=t.startTime??0,a=t.endTime??t.duration??0;return e.words.some((e=>Sr(e.start_time,e.end_time,o,a)))}))))),_k),Ek=s.memoize(((e,t=["hasAudio","hasVolume","hasWords"])=>{const o=new Set(t);return m(bk,(e=>e.studio.allLayers.byId),(e=>e.assetTranscriptions.byId),(e=>dl((t=>bk(t).map((o=>[o,Sk(o,e)(t)]))),(e=>{const t={};for(const[o,a]of e)t[o]=a;return t})))(e),((t,a,i,s)=>{const n=new Map;for(const e of Object.values(a)){const t=ak(e);if(!t)continue;const[o]=TS(e),a=n.get(t);(void 0===a||o<a)&&n.set(t,o)}return t.map((t=>{var n;const r=Object.values(a).filter((e=>ak(e)===t));if(o.has("findHighlightsMinDuration")){if(fk(r.map((e=>{const{startTime:t,endTime:o}=dm(e);return{start:t,end:o}}))).reduce(((e,t)=>e+(t.end-t.start)),0)<120)return{assetId:t,canBeEnabled:!1,defaultEnabled:!1,reason:"Asset must be at least 2 minutes"}}if(!r.some((e=>e.hasAudio))&&o.has("hasAudio"))return{assetId:t,canBeEnabled:!1,defaultEnabled:!1,reason:"Asset has no audio"};const l=null==(n=i[t])?void 0:n[e];if("completed"===(null==l?void 0:l.state)&&0===l.words.length&&o.has("hasWords"))return{assetId:t,canBeEnabled:!1,defaultEnabled:!1,reason:"No speech detected"};if(!s[t]&&o.has("hasWords"))return{assetId:t,canBeEnabled:!0,defaultEnabled:!1,reason:"No speech detected"};if(!r.some((e=>0!==e.volume))&&o.has("hasVolume"))return{assetId:t,canBeEnabled:!0,defaultEnabled:!1,reason:"Asset is muted"};if(o.has("filterTextToSpeech")){if(r.some((e=>e.ttsText)))return{assetId:t,canBeEnabled:!1,defaultEnabled:!1,reason:"Cannot use text-to-speech assets"}}return{assetId:t,canBeEnabled:!0,defaultEnabled:!0,reason:""}})).sort(((e,t)=>{if(e.canBeEnabled&&!t.canBeEnabled)return-1;if(!e.canBeEnabled&&t.canBeEnabled)return 1;return(n.get(e.assetId)??Number.MAX_SAFE_INTEGER)-(n.get(t.assetId)??Number.MAX_SAFE_INTEGER)}))}))}),((e,t)=>`${e}-${null==t?void 0:t.join(",")}`)),Ik=s.memoize(((e,t)=>m((t=>t.assetTranscriptions.byId[e]),(e=>t&&e?e[t]:null))),_k),Ck=e=>[...new Set(e.getBlocksAsArray().flatMap((e=>e.getCharacterList().toArray().flatMap((e=>e.getStyle().toArray())))))],kk=e=>{if(""===e.getPlainText())return[];const t=e.getBlocksAsArray();if(0===t.length)return[];const o=t.flatMap((e=>e.getCharacterList().toArray().flatMap((e=>e.getStyle())))),a=o[0];return a?a.intersect(...o).toArray():[]},Ak=(e,t)=>{const o=e=>e.hasChildNodes()?Array.from(e.childNodes,o).flat(1):e instanceof Element?"BR"===e.tagName?[{text:"",css:{},position:Y(e.getBoundingClientRect(),"top","left","right","bottom","width","height")}]:[]:e.nodeType===Node.TEXT_NODE?(e=>{const t=e.textContent||"";if(e.nodeType!==Node.TEXT_NODE||null==e.parentElement||["\r\n","\n"].includes(t))return[];let o=e.parentElement;for(;!o.getAttribute("data-offset-key");){if(null==o.parentElement){o=e.parentElement;break}o=o.parentElement}const a=getComputedStyle(o),i={fontWeight:a.fontWeight,fontStyle:a.fontStyle,textDecoration:a.textDecoration,color:a.color},s=[],n=document.createRange();n.setStart(e,0),n.setEnd(e,1);let r,l=n.getBoundingClientRect();for(let c=2;c<=t.length;c+=1){n.setEnd(e,c);const t=n.getBoundingClientRect();if(l.bottom!==t.bottom){n.setEnd(e,c-1);const t={...Y(n.getBoundingClientRect(),"top","left","right","bottom","width","height")};r=r||t.height,t.top=t.bottom-r,t.height=r,s.push({text:n.toString(),css:i,position:t}),n.setStart(e,c-1),n.setEnd(e,c),l=n.getBoundingClientRect()}}n.setEnd(e,t.length);const d={...Y(n.getBoundingClientRect(),"top","left","right","bottom","width","height")};return r=r||d.height,d.top=d.bottom-r,d.height=r,s.push({text:n.toString(),css:i,position:d}),s})(e)??[]:[],a=o(t),i=e.getBoundingClientRect();return a.map((({position:e,...t})=>{const o={top:(e.top-i.top)/i.height,bottom:(e.bottom-i.top)/i.height,height:e.height/i.height,left:(e.left-i.left)/i.width,right:(e.right-i.left)/i.width,width:e.width/i.width};return{...t,text:t.text.replace(/\r\n/g,"").replace(/\n/g,""),position:z(o,(e=>bS(e,1e-4)))}}))},jk=e=>e.startsWith("COLOR");function Nk(e){if(e.startsWith("COLOR"))return{color:e.slice("COLOR".length+1)}}const Rk=(e,t,o)=>{var a,i,s;const n=(e=>{const t=document.createElement("div"),o=e.getCurrentContent().getBlocksAsArray(),a={...J.DefaultDraftInlineStyle},i=Ck(e.getCurrentContent());for(const s of i)jk(s)&&(a[s]=Nk(s));for(const s of o){const o=document.createElement("div");o.style.whiteSpace="pre-wrap";const i=s.getKey(),n=s.getText(),r=e.getBlockTree(i);for(const e of r.toArray()){const t=e.get("leaves");for(const e of t){const t=e.get("start"),i=e.get("end"),r=document.createElement("span");r.setAttribute("data-offset-key",String(t));for(const e of s.getInlineStyleAt(t).toArray())Object.assign(r.style,a[e]);r.textContent=n.slice(t,i).replace(/\r\n/g,""),o.appendChild(r)}}t.appendChild(o)}return t})(J.EditorState.createWithContent(J.convertFromRaw(t)));Object.assign(n.style,{font:HC(e,o,e.fallbackFonts),fontSize:o,width:`${null==(a=e.position)?void 0:a.pixel_width}px`,height:`${null==(i=e.position)?void 0:i.pixel_height}px`,textAlign:e.textAlign??"initial",textTransform:e.textTransform??"none",color:e.color,textDecoration:e.underline?"underline":"none",alignItems:"center"});const r=null==(s=e.textAlign)?void 0:s.toLowerCase();"left"===r?n.style.justifyContent="flex-start":"right"===r&&(n.style.justifyContent="flex-end");const l=document.createElement("div");l.style.display="flex",l.style.position="absolute",l.style.left="10000px",l.appendChild(n),document.body.appendChild(l);try{return Ak(n,n)}finally{l.remove()}};const Pk=(e,t,o,a)=>{const i=t.borderRadius?parseFloat(t.borderRadius.relative):0;if(Lk(t.position.pixel_width,t.position.pixel_height,i))Ok(e,t.position.pixel_width/2,t.position.pixel_height/2,t.position.pixel_width/2,o,a);else{const s=i/100*(t.position.pixel_width<t.position.pixel_height?t.position.pixel_width:t.position.pixel_height);Dk(e,t,t.position.pixel_width,t.position.pixel_height,s,o,a)}e.clip()},Dk=(e,t,o,a,i,s,n)=>{e.beginPath(),s&&(e.lineWidth=s,e.strokeStyle=n),e.moveTo(i,0),e.lineTo(o-i,0),e.arcTo(o,0,o,i,i),e.lineTo(o,a-i),e.arcTo(o,a,o-i,a,i),e.lineTo(i,a),e.arcTo(0,a,0,a-i,i),e.lineTo(0,i),e.arcTo(0,0,i,0,i),"dropShadow"===t.imageEffect&&(!function(e,t){const o=t.imageShadowDist||0,a=(t.imageShadowRot||0)*Math.PI/180,i=100*o*Math.cos(a),s=100*o*Math.sin(a);e.shadowOffsetX=i,e.shadowOffsetY=s,e.shadowColor=t.imageEffectColor,e.shadowBlur=50*t.imageShadowBlur}(e,t),e.fill()),e.closePath(),s&&e.stroke()},Ok=(e,t,o,a,i,s)=>{e.beginPath(),i&&(e.lineWidth=i,e.strokeStyle=s),e.arc(t,o,a,0,2*Math.PI),e.closePath(),i&&e.stroke()},Lk=(e,t,o)=>e/t>=.98&&e/t<=1.02&&o>=49;function Fk(e,t,o,a,i,s){const n=t+a,r=o+i;e.moveTo(t+s,o),e.lineTo(n-s,o),e.arcTo(n,o,n,o+s,s),e.lineTo(n,r-s),e.arcTo(n,r,n-s,r,s),e.lineTo(t+s,r),e.arcTo(t,r,t,r-s,s),e.lineTo(t,o+s),e.arcTo(t,o,t+s,o,s)}function Mk(e,t,o,a,i){a&&(e.moveTo(t,o+a),e.arcTo(t,o,t-a,o,a),e.lineTo(t,o),e.lineTo(t,o+a)),i&&(e.moveTo(t,o+i),e.arcTo(t,o,t+i,o,i),e.lineTo(t,o),e.lineTo(t,o+i))}function Uk(e,t,o,a,i){a&&(e.moveTo(t,o-a),e.arcTo(t,o,t-a,o,a),e.lineTo(t,o),e.lineTo(t,o-a)),i&&(e.moveTo(t,o-i),e.arcTo(t,o,t+i,o,i),e.lineTo(t,o),e.lineTo(t,o-i))}function Bk(e,t){if(!e.textOutline)return 0;return.3*t*(.01*e.textOutline.width)}function Vk(e,t,o){const a=document.createElement("span"),i=document.createElement("div"),s=document.createElement("div");i.style.display="inline-block",i.style.width="1px",i.style.height="0",i.style.verticalAlign="baseline",s.style.visibility="hidden",s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.whiteSpace="nowrap",a.style.whiteSpace="nowrap",a.style.font=HC(e,t,e.fallbackFonts),o&&(a.style.lineHeight=`${o}px`),a.textContent=e.text.replace(/\s/g,String.fromCharCode(160)),s.appendChild(a),s.appendChild(i),document.body.appendChild(s);const{offsetTop:n}=i,{height:r}=a.getBoundingClientRect();return s.remove(),{baseline:n,height:r}}function Wk(e,t,o,a){const i=[];let s=0;Zk(e,t,o,a,(({text:e,y:o})=>{if(o!==s||0===i.length)i.push([e,t.measureText(e).width]);else{const o=i.pop();i.push([`${o[0]} ${e}`,o[1]+t.measureText(e).width])}s=o}));const n=o.text.split("\n");if(n.length>i.length)for(let r=0;r<n.length;r+=1)""===n[r]&&i.splice(r,0,["",0]);return i}function Gk(e,t,o,a,i,s,n){let r;switch(s.textEffect){case"dropShadow":{if(n.color&&ty(n.color))return;e.save();const l=s.textShadowDist*i,d=s.textShadowRot*(Math.PI/180),c=l*Math.cos(d),u=l*Math.sin(d);return r=`blur(${s.textShadowBlur*i/2}px)`,e.filter="none"===e.filter?r:r+e.filter,e.fillStyle=s.textEffectColor,e.fillText(t,o+c,a+u),s.underline&&Hk(e,t,o+c,a+u,i,s),void e.restore()}case"textBlur":{const{textBlurTemp:t,textBlur:o}=s;return r=`blur(${.2*+i*+(t||o||.2)}px)`,void(e.filter=e.filter&&"none"!==e.filter?r+e.filter:r)}}}function Hk(e,t,o,a,i,s,n=0){e.save();const r=e.measureText(t).width+n,l=.004*(e.canvas.clientHeight||e.canvas.height);switch(e.textAlign){case"center":o-=r/2;break;case"right":o-=r}e.beginPath(),e.strokeStyle=s.textShadow,e.lineWidth=Math.max(2,l),e.lineJoin="round";const d=.05*i;e.strokeRect(o,a+d,r,i/10),e.rect(o,a+d,r,i/10),e.fill(),e.restore()}function $k(e,t,o,a,i,s,n){var r;if(null==n?void 0:n.backgroundColor){const l=t.strokeStyle;t.fillStyle=n.backgroundColor,t.strokeStyle="transparent";const d=Object.values(o.styles||{}).some((e=>"bold"===e.fontWeight));t.save(),d&&(t.font=HC({...e,fontWeight:"bold"},s));const{width:c}=t.measureText(o.text),u=t.measureText(e.wordSeparator).width/2;t.restore();const m=s*e.lineHeight,p=m/5,h=30,g=Math.min(1,Math.floor(e.fontSize/h));!function(e,t,o,a,i,s){const n=Math.min(a,i)/2*.95,r=Math.min(s,n);e.beginPath(),Fk(e,t,o,a,i,r),e.stroke(),e.fill()}(t,Math.floor(a-u)-g,i-m+p-parseFloat((n.bottom||0).toString())*s,Math.ceil(c+2*u)+g,m,parseFloat((null==(r=n.borderRadius)?void 0:r.toString())||"0")*s),t.strokeStyle=l}const l=a;let d=i;return(null==n?void 0:n.bottom)&&(d-=parseFloat(n.bottom.toString())*s),t.fillStyle=(null==n?void 0:n.color)||e.color,"none"===n.textShadow?t.strokeStyle="transparent":t.strokeStyle=n.textShadow||e.textShadow,{...n,x:l,y:d}}const Kk=Intl&&Intl.Segmenter,zk=q.memoize((e=>{if(Kk)try{return[...(new Intl.Segmenter).segment(e)].map((e=>e.segment))}catch(IGe){console.error("safeSplitText error",IGe)}return[...e]}));const Yk=(e,t,o,a)=>{const i=zk(e.text),s=[];let n,r,l=t||0;return i.forEach(((i,d)=>{var c;let u=null==(c=e.styles)?void 0:c[d];!(null==u?void 0:u.color)&&a&&(u={...u||{},index:d,color:a});const m=!!(o&&void 0!==t&&o.cleanSelectionStart<=l&&o.cleanSelectionEnd>l);if(m||0===d||!function(e,t){if(!e||!t)return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const o of Object.keys(e)){if("index"===o)continue;const a=o;if(e[a]!==t[a])return!1}return!0}(u,n)||r!==m)s.push({isSelected:m,text:i,styles:u});else{const e=s[s.length-1];e&&(e.text+=i)}n=u,r=m,l+=i.length})),s},Jk=(e,t,o)=>{let a={index:-1};return!!t&&!!o&&(Object.keys(o).forEach((e=>{const i=e;i in o&&o[i]===t[i]&&(a={...a,[i]:o[i]})})),!e.underline||"none"!==o.textDecoration&&"none"!==t.textDecoration||(a.textDecoration="none")),e.underline&&"none"!==a.textDecoration&&(a.textDecoration="underline"),a};function qk(e,t){const o={...e};return"italic"===(null==t?void 0:t.fontStyle)?o.italic=!0:"normal"===(null==t?void 0:t.fontStyle)&&(o.italic=!1),"bold"===(null==t?void 0:t.fontWeight)?o.fontWeight="bold":"normal"===(null==t?void 0:t.fontWeight)&&(o.fontWeight="normal"),o}function Xk(e,t,o,a,i,s,n){const{textOutline:r}=i;if(r&&!ty(r.color)&&"none"!==n.textShadow&&(!n.color||!ty(n.color))){const n=Bk(i,s);if(n){const i=e.strokeStyle,s=e.lineWidth,l=e.lineJoin;e.strokeStyle=r.color,e.lineWidth=n,e.lineJoin="miter",e.strokeText(t,o,a),e.strokeStyle=i,e.lineWidth=s,e.lineJoin=l}}e.strokeText(t,o,a),e.fillText(t,o,a)}function Qk(e,t,o,a,i,s){const{frame:n}=o;if(!n)return;let r=n;o.isRTL&&(r={...n,lines:n.lines.map((e=>function(e){const t=e.words,o=[];let a=[],i=[];return t.forEach((e=>{iA(e.text)?(i.length&&(o.unshift(...i),i=[]),a.push(e)):(a.length&&(o.unshift(...a.reverse()),a=[]),i.push(e))})),i.length&&o.unshift(...i),a.length&&o.unshift(...a.reverse()),{...e,words:o}}(e)))}),t.font=HC(o,a);const l=o.position.pixel_width,d=o.position.pixel_height,c=(o.lineHeight||1)*a,u=d/2-c*e.length/2;if(l<=0||d<=0)return;const{wordByWordStyles:m,animationName:p}=s||{},{active:h,spoken:g,unspoken:f,inactive:y}=m||{};r.lines.forEach(((s,n)=>{const r=e[n];if(!r)return;const[d,m]=r,v=[];let _=0,w=0;switch(o.textAlign){case"center":_=(l-m)/2;break;case"right":_=l-m;break;default:_=0}const b=_;w=u+c*n+Vk(o,a,c).baseline;let T=_;s.words.forEach(((e,n)=>{var r,l,d;const c=i<e.start,u=i>=e.start,m=p&&i>=e.start&&i<e.end;let x={};!m&&(x={...x,...y}),c&&(x={...x,...f}),u&&(x={...x,...g}),m&&(x={...x,...h});const{y:S}=$k(o,t,e,T,w,a,x),E=n+1===s.words.length;let I="";const C=Yk(e);if(o.isRTL&&C.reverse(),C.forEach((e=>{t.save();const i=e.styles,s=qk(o,i);(null==i?void 0:i.color)&&((!m||m&&!(null==h?void 0:h.color))&&(t.fillStyle=i.color),c&&"transparent"===(null==f?void 0:f.color)&&(t.fillStyle="transparent")),t.font=HC(s,a),o.textEffect&&Gk(t,e.text,T,S,a,s,x);if(o.underline&&"none"!==(null==i?void 0:i.textDecoration)||"underline"===(null==i?void 0:i.textDecoration)){const i=.5;Hk(t,e.text,T,S,a,o,i)}Xk(t,e.text,T,S,o,a,x),I+=e.text,T+=t.measureText(e.text).width,t.restore()})),!E&&o.wordSeparator){t.save();const i=n+1,u=s.words[i],p=o.isRTL?((null==(r=null==u?void 0:u.text)?void 0:r.length)??1)-1:0,h=null==(l=null==u?void 0:u.styles)?void 0:l[p],g=o.isRTL?0:e.text.length-1,y=null==(d=e.styles)?void 0:d[g],v=Jk(o,y,h),_=qk(o,v);t.font=HC(_,a),m&&(t.fillStyle=v.color||o.color),(null==v?void 0:v.color)&&(t.fillStyle=v.color),c&&"transparent"===(null==f?void 0:f.color)&&(t.fillStyle="transparent");if("underline"===(null==v?void 0:v.textDecoration)){const e=.5;Hk(t,o.wordSeparator,T,w,a,o,e)}t.strokeText(o.wordSeparator,T,S),t.fillText(o.wordSeparator,T,S),I+=o.wordSeparator,T+=t.measureText(o.wordSeparator).width,t.restore()}v.push(I);const k=v.join("");_=b+t.measureText(k).width}))}))}function Zk(e,t,o,a,i){var s;const n=o.position.pixel_width,r=o.position.pixel_height;t.textBaseline="alphabetic",t.textAlign="left";for(const{text:l,css:d,position:c}of e){const e=!!(null==(s=d.textDecoration)?void 0:s.toString().includes("underline")),u={...o,text:l,textWithLineBreaks:l,fontSize:a,lineHeight:1,underline:e,italic:"italic"===d.fontStyle,fontWeight:d.fontWeight},m=HC(u,a,o.fallbackFonts);t.font=m,t.fillStyle=d.color;const p=c.left*n,h=c.height*r,{baseline:g}=Vk({...u,lineHeight:"normal"},a,h);i({text:l,x:p,y:c.bottom*r-(h-g),correctedLayer:u,hasUnderline:e})}}const eA=e=>{let t=[];t=e.replace(/\r?\n|\r/g,"\n").split(/(\n)/);return t.filter((function(e){return""!==e})).filter((function(e,t,o){return 0===t||!("\n"===e&&"\n"!==o[t-1])}))};function tA(e,t,o=null,a=null,i=null,s=null){const n=o||t.position.pixel_width,r=a||t.position.pixel_height;if(n<=0||r<=0)return;let l="0%";i?l=i:t.borderRadius&&t.borderRadius.relative&&(l=t.borderRadius.relative);const d=parseFloat(l)/100*Math.min(n,r),c=(s||t.textPadding||0)*Math.min(n,r)/100,u=2*c,m=document.createElement("canvas");m.width=n+u,m.height=r+u;const p=m.getContext("2d");p.beginPath(),p.rect(0,0,m.width,m.height),p.clip(),p.beginPath(),Fk(p,0,0,m.width,m.height,d),p.lineWidth=1,p.strokeStyle=t.backgroundColor,p.stroke(),p.fillStyle=t.backgroundColor,p.fill(),m.width>0&&m.height>0&&e.drawImage(m,-c,-c,m.width,m.height)}function oA(e,t,o){return Math.max(e,Math.min(o,t))}function aA(e,t,o,a,i=null,s=null,n=null,r=null,l=null,d=null){const c=i||a.position.pixel_width,u=s||a.position.pixel_height;if(c<=0||u<=0)return;const m=a.textAlign,p="left"===m,h="right"===m,g=a.lineHeight??1,f=n||g*o,y=d??a.textPadding??0,v=y*f/100,_=2*v;let w=r||Math.max(0,(u-f*t.length)/2);const b=document.createElement("canvas");b.width=c+_,b.height=u+_;const T=b.getContext("2d");T.beginPath(),T.rect(0,0,b.width,b.height),T.clip();let x=0;null!==l?x=parseFloat(l)/100:void 0!==a.borderRadius&&a.borderRadius.relative&&(x=parseFloat(a.borderRadius.relative)/100);const S=x*f,E=S+S;let I=t;const C=(e,t)=>{const o=I[t-1]??0;let a=e;if(t>0){Math.abs(o-e)<E&&(a=Math.max(o,e))}return a};function k(e){const t=I[e]??c-2,o=Math.min(c-2,t);let a=0;switch(m){case"right":a=c-o-1;break;case"center":a=(c-o)/2}return{x:a,w:o}}let A;I=t.map(C).reverse(),I=I.map(C).reverse();let j=1;const N=ay(a.backgroundColor);function R(){T.lineWidth=1,T.strokeStyle=A,T.stroke(),T.fillStyle=A,T.fill(),T.beginPath()}N?(j=N.a,A=`rgb(${N.r}, ${N.g}, ${N.b})`):A=a.backgroundColor,T.beginPath();const P=x+y/100;let D=S;P>.5&&(D=S-f*(P-.5));for(let O=0;O<t.length;O++){const{x:e,w:o}=k(O);if(Fk(T,e,w,o+_,f+_,S),R(),O>0){const{x:t,w:a}=k(O-1);let i=a>o+S+S;(h||p)&&(i=a>o+S),Mk(T,e,w+_-(p||a===o?v:0),p?0:oA(0,e-(t+S),D),p||i||a===o?S:0),R(),Mk(T,e+o+_,w+_-("right"===m||a===o?v:0),h||i||a===o?S:0,h?0:oA(0,t+a-S-(e+o),D)),R()}if(O<t.length-1){const{x:t,w:a}=k(O+1);let i=a>o+S+S;(h||p)&&(i=a>o+S),Uk(T,e,w+f+("left"===m||a===o?v:0),p?0:oA(0,e-(t+S),D),p||i||a===o?S:0),R(),Uk(T,e+o+_,w+f+("right"===m||a===o?v:0),h||i||a===o?S:0,h?0:oA(0,t+a-S-(e+o),D)),R()}R(),w+=f}if(b.width>0&&b.height>0){const t=e.globalAlpha;e.globalAlpha=j*e.globalAlpha,e.drawImage(b,-v,-v,b.width,b.height),e.globalAlpha=t}}function iA(e){return/[\u0600-\u06FF]/.test(e)||/[\u0590-\u05FF]/.test(e)}function sA(e,t,o,a,i){var s,n,r;if(!t.text)return;e.save();const l=Number(t.fontSize||0)*a;e.font=HC(t,l),document.fonts.check(e.font)||console.error(`Font '${e.font}' not loaded, output may not have correct fidelity`),e.textAlign="left",e.textBaseline="alphabetic";const d=t.position.pixel_width,c=.004*(e.canvas.clientHeight||e.canvas.height);e.strokeStyle=t.textShadow||"transparent",e.lineWidth=Math.max(2,c),e.lineJoin="round";const{xPos:u,yPos:m}=lx(t,{animations:i},o,e.canvas.clientWidth||e.canvas.width,e.canvas.clientHeight||e.canvas.height),p=u+t.position.pixel_width/2,h=m+t.position.pixel_height/2;e.translate(p,h),(null==(s=t.position)?void 0:s.rotation)&&e.rotate(t.position.rotation*Math.PI/180),e.translate(-p,-h),e.translate(u,m),e.globalAlpha=t.globalAlpha;const g=XT(t,i);g&&g.opacity&&(e.globalAlpha=cx(t,g,o).opacity/100);let f=null;qT(t,i)&&(f=((e,t)=>QT(e,t).find((({animationName:e,wordByWordStyles:t})=>!!t&&e!==Yl.None))||null)(t,i),ZT(i,t,e,o,l)),e.fillStyle=t.color;const y="uppercase"===t.textTransform?e=>e.toLocaleUpperCase():"lowercase"===t.textTransform?e=>e.toLocaleLowerCase():e=>e;t.text=y(t.text),t.textWithLineBreaks&&(t.textWithLineBreaks=y(t.textWithLineBreaks)),t.textBlocks=null==(n=t.textBlocks)?void 0:n.map((e=>({...e,text:y(e.text)}))),"frame"in t&&t.frame&&(t.frame.lines=null==(r=t.frame.lines)?void 0:r.map((e=>({...e,words:e.words.map((e=>({...e,text:y(e.text)})))}))));const v=e=>e.replace(/\r\n/g,"\n"),_=v(t.text||""),w=v(t.textWithLineBreaks||""),b=!!w&&function(e,t){return e.replace(/[\s\n]/g,"")===t.replace(/[\s\n]/g,"")}(_,w);let T,x=[];try{t.textBlocks?(T=t.textBlocks,x=Wk(t.textBlocks,e,t,l)):t.draftJSTextTree&&(t.draftJSTextTree.blocks.forEach((e=>{e.text=y(e.text)})),T=Rk(t,t.draftJSTextTree,l),x=Wk(T,e,t,l))}catch(IGe){console.error("failed to getPhrasesFromTextBlocks",IGe)}"frame"in t&&t.frame&&(x=function(e,t,o){const a=[],{frame:i}=t;return null==i||i.lines.forEach((i=>{let s=0,n="";const r=e.measureText(t.wordSeparator).width;i.words.forEach(((a,l)=>{const d=Object.values(a.styles||{}).some((e=>"bold"===e.fontWeight));e.save(),d&&(e.font=HC({...t,fontWeight:"bold"},o)),n+=a.text,s+=e.measureText(a.text).width,e.restore(),i.words.length-1!==l&&(s+=r,n+=t.wordSeparator)})),a.push([n,s])})),a}(e,t,l)),0===x.length&&(x=function({ctx:e,lines:t,pxCap:o}){let a=[];const i=" ",s=e.measureText(i).width;let n,r;return t.filter((e=>e&&e.length)).forEach((t=>{n="",r=0,t.split(i).forEach((t=>{let{width:l}=e.measureText(t);if(l>o){r&&a.push([n,r]);const i=((e,t,o)=>{const a=t.split(""),i=[];let s="",n=0;return a.forEach((t=>{const{width:a}=e.measureText(t);n+a>o?(n&&i.push([s,n]),s=t,n=a):(s+=t,n+=a)})),n&&i.push([s,n]),i})(e,t,o),s=i.pop();return[n,r]=s,void(a=[...a,...i])}r+s+l>o?(r&&a.push([n,r]),n="",r=0):r&&""!==t&&(n+=i,r+=s),""===t&&(t=i,l=s),n+=t,r+=l})),r&&a.push([n,r])})),a}({ctx:e,lines:eA(b?w:_)||[],pxCap:b?Number.MAX_SAFE_INTEGER:d}));if(t.backgroundColor&&"rgba(-255,-255,-255,0)"!==t.backgroundColor)if("wrap"===t.wrapOrFill){aA(e,x.map((([e,t])=>t)),l,t)}else tA(e,t);("isRTL"in t&&t.isRTL||!t.isMagicSubtitle&&iA(_))&&(e.direction="rtl"),T?function(e,t,o,a){Zk(e,t,o,a,(({text:e,x:i,y:s,correctedLayer:n,hasUnderline:r})=>{t.save(),o.textEffect&&Gk(t,e,i,s,a,n,{}),r&&Hk(t,e,i,s,a,n),Xk(t,e,i,s,n,a,{}),t.restore()}))}(T,e,t,l):"frame"in t&&t.frame?Qk(x,e,t,l,o,f):function(e,t,o,a,i=null,s=null){var n,r;const l=i||o.position.pixel_width,d=s||o.position.pixel_height;if(l<=0||d<=0)return;const c=(o.lineHeight||1)*a,u=d/2-c*e.length/2;for(let m=0;m<e.length;m++){const i=(null==(n=e[m])?void 0:n[0])??"",s=(null==(r=e[m])?void 0:r[1])??0;let d;switch(o.textAlign){case"center":d=(l-s)/2;break;case"right":d=l-s;break;default:d=0}const p=u+c*m+Vk(o,a,c).baseline;o.textEffect&&Gk(t,i,d,p,a,o,{}),o.underline&&Hk(t,i,d,p,a,o),Xk(t,i,d,p,o,a,{})}}(x,e,t,l),e.restore()}const nA=(e,t)=>{if(e)return e[t%e.length]||void 0},rA=e=>{let t="",o=0;return e.forEach(((e,a)=>{e.length>t.length&&(t=e,o=a)})),o};function lA(e){var t,o;const a=(null==(t=e.match(/^\n+/))?void 0:t[0].length)??0,i=(null==(o=e.match(/\n+$/))?void 0:o[0].length)??0;return{leadingNewlineCount:a,trailingNewlineCount:i,trimmedWordText:e.slice(a,e.length-i)}}function dA({words:e,verticalAlign:t}){const o=[];if("top"===t)e.forEach(((e,t)=>{o.push({originalNdx:t,side:"front",word:e})}));else if("bottom"===t)[...e].reverse().forEach(((t,a)=>{const i=e.length-1-a;o.push({originalNdx:i,side:"back",word:t})}));else{let t=Math.floor(e.length/2),a=t;for(;t>=0||a<e.length;){const i=e[t];if(i&&o.push({originalNdx:t,side:"back",word:i}),t!==a){const i=e[a];i&&o.push({originalNdx:t,side:"front",word:i})}t--,a++}}return o}function cA({maxWidth:e,orderedWords:t,separator:o,wordSizer:a}){const i=[];function s(e,t,o){"front"===o?i.push({words:[e],width:t}):i.unshift({words:[e],width:t})}const n=" "===o?a.getWidth({text:" "}):0;return t.forEach((t=>{const{side:o,word:r}=t,l=a.getWidth(r),d=i["front"===o?i.length-1:0];if(d){const a=d.width,i=(a?a+n:0)+l;a>0&&i>e?s(t,l,o):("front"===o?d.words.push(t):d.words.unshift(t),d.width=i)}else s(t,l,o)})),i}const uA=e=>{const{languageCode:t,enabledAssetIds:o,assetTranscriptions:a,assetsById:i}=tl((e=>{var t,o;return{languageCode:null==(t=e.projectSessionSettings.trimWithTranscriptEnabledAssets)?void 0:t.languageCode,enabledAssetIds:null==(o=e.projectSessionSettings.trimWithTranscriptEnabledAssets)?void 0:o.assetIds,assetTranscriptions:e.assetTranscriptions,assetsById:e.assets.byId}}),ol),s=h.useCallback((()=>(o??[]).every((e=>{const t=a.byId[e];if(!t)return!1;return Object.keys(t).some((e=>{var o;const a="completed"===(null==(o=t[e])?void 0:o.state);return e.startsWith("en")&&a}))}))),[a,o]),n=h.useCallback((()=>(o??[]).some((e=>{const t=i[e];return!!t&&"tts"!==t.source}))),[i,o]),r=e??t,l=h.useMemo((()=>Object.keys(a.byId).length>0),[a]);return{enableRemoveFillerWords:h.useMemo((()=>l&&(null==r?void 0:r.startsWith("en"))&&s()&&n()),[l,r,s,n]),removeFillerWordTooltip:h.useMemo((()=>l?r&&!r.startsWith("en")?"Filler word removal is only available for English":s()?n()?"":"At least one asset must not be text-to-speech":"All assets must have an English transcription":"Generate an English transcription to remove filler words"),[l,s,n,r])}},mA=e=>{var t;const{state:o}=sr(),a=e??(null==(t=o.projectSessionSettings.trimWithTranscriptEnabledAssets)?void 0:t.languageCode);return null==a?void 0:a.startsWith("en")},pA=e=>/\p{P}/u.test(e),hA=(e,t,o)=>{if(!e)return"";let a="";for(const i of e.toString().replace(/\s+/g," ").trim())pA(i)?o&&(a+=i):a+=i;return t?a:a.toLowerCase()},gA=(e,t,o=!1,a=!1)=>hA(e,o,a)===hA(t,o,a),fA=(e,t,o)=>{let a=e.toLowerCase().replace(t.toLowerCase(),o);var i;return o[0]&&e[0]&&(i=e[0],/[\p{Alphabetic}]/u.test(i))&&e.startsWith(e[0].toUpperCase())&&(a=o[0].toUpperCase()+a.slice(1)),a},yA=(e,t,o)=>{const a=[...t];return a.forEach(((t,i)=>{o.forEach((o=>{const s=o.from.split(/\s+/);if(s[0]&&!gA(s[0],t.word,!1))return;if(!((e,t)=>{if(t.length>e.length)return!1;for(let o=0;o<e.length;++o)if(!gA(t[o],e[o],!1))return!1;return!0})(s,e.slice(i,i+s.length)))return;const n=o.to.split(/\s+/),r=[];let l=0;for(l=0;l<s.length;l++){const e=i+l;if(s[l]&&n[l]){if(!a[e])continue;l===s.length-1?a[e].word=fA(a[e].word,s[l],n.slice(l).join(" ")):a[e].word=fA(a[e].word,s[l],n[l])}else s[l]&&!n[l]&&r.push(e)}const d=r[0];if(d&&r.length>0){const t=d+r.length-1;a[d-1].end_time=a[t].end_time,e.splice(d,r.length),a.splice(d,r.length)}}))})),a},vA=(e,t)=>{try{const o=e.map((e=>e.text)),a=e.map((e=>"start"in e&&"end"in e?{word:e.text,start_time:e.start,end_time:e.end}:{word:e.text}));return yA(o,a,t).map((e=>"start_time"in e&&"end_time"in e?{text:e.word,start:e.start_time,end:e.end_time}:{text:e.word}))}catch(IGe){return console.error(IGe),e}};function _A(e){return JSON.stringify(e)}window.orderedMagicSubtitleFrames=()=>{const{state:e}=sr();return Object.keys(e.studio.magicSubtitleFramesByAsset||{}).reduce(((t,o)=>{const a=DA(o)(e);return t[o]=a,t}),{})};const wA=(...e)=>e.join("|"),bA=p(y,ol),TA=m((e=>e.studio.magicSubtitles),gk,(e=>!!(DA("background-asset")(e)||[]).length),((e,t,o)=>{const a=new Set(t.map(ak)),i=Object.entries(e||{}).filter((([e,t])=>"background-asset"===e||!!t&&(!!t.enabled&&("background-asset"===e||a.has(e))))).map((e=>e[0]));return o&&!i.includes("background-asset")&&i.push("background-asset"),i})),xA=s.memoize((e=>m((t=>{var o;return null==(o=t.studio.magicSubtitleFramesByAsset)?void 0:o[e]}),(t=>t.studioLocal.magicSubtitleFramesByAsset[e]),((e,t)=>t||e)))),SA=(e,t,o)=>{var a,i,s,n,r,l;return(null==(a=e.studioLocal.magicSubtitlesGlobal.position)?void 0:a[o])??(null==(s=null==(i=e.studio.magicSubtitlesGlobal)?void 0:i.position)?void 0:s[o])??(null==(l=null==(r=null==(n=e.studio.magicSubtitles)?void 0:n[t])?void 0:r.position)?void 0:l[o])??0},EA=s.memoize((({assetId:e,canvasWidth:t,canvasHeight:o})=>m((t=>SA(t,e,"widthPct")),(t=>SA(t,e,"heightPct")),((e,a)=>{const i={height:o,width:t},{width:s,height:n}=HE(e,a,i);return{width:s,height:n}}))),_A),IA=s.memoize((e=>m((t=>{var o;const a=Object.keys(t.studio.magicSubtitles||{})[0];if(!a)return null;const i=e||a,s=null==(o=t.studio.magicSubtitles)?void 0:o[i];return s||"background-asset"!==e?s:CT}),(e=>e.studio.magicSubtitlesGlobal),(e=>e.studioLocal.magicSubtitlesGlobal),((e,t,o)=>(e&&e.style&&!e.style.verticalAlign&&(e.style={...e.style,verticalAlign:"top"}),t&&t.style&&!t.style.verticalAlign&&(t.style={...t.style,verticalAlign:"top"}),s.merge({},CT,e,t,o)))))),CA=({assetId:e,canvasHeight:t,canvasWidth:o,canvasX:a,canvasY:i})=>m((t=>IA(e)(t).position),(e=>{const s={height:t,width:o,x:a,y:i},{x:n,y:r}=WE(e.xPct,e.yPct,s),{width:l,height:d}=HE(e.widthPct,e.heightPct,s);return{x:n,y:r,width:l,height:d,rotation:e.rotation??0}})),kA=s.memoize((e=>m(IA(e),(e=>e.style)))),AA=s.memoize((e=>m((t=>{const o=IA(e)(t).languageKey;return o?Ik(e,o)(t):null}),(e=>e)))),jA=s.memoize((e=>m(gk,(t=>{const o=t.filter(wk).filter((t=>e.includes(ak(t)??"")));return e.includes("background-asset")&&o.push({type:zl.Video,id:"123",asset_id:"background-asset",startTime:0,duration:1e5,name:"bg"}),o}))),(e=>e.join("_"))),NA=bA((e=>bk(e).map((t=>[t,AA(t)(e)]))),(e=>{const t={};for(const[o,a]of e)t[o]=a||null;return t})),RA=s.memoize((({assetId:e,canvasWidth:t=1,fontSizeOverride:o})=>{const a=kA(e);return m(a,(e=>{const t=a(e).fontFamily;return e.loadedFonts[t.fontFamily]}),(function(a,i){return function({assetId:e,canvasWidth:t,fontStatus:o,fontSizeOverride:a,style:i}){const s=t/700;return XC(e,i,(a??i.fontSize)*s,o)}({assetId:e,style:a,canvasWidth:t,fontStatus:i,fontSizeOverride:o})}))}),_A),PA=e=>{if(nd(e))return e;if(0===e.words.length)return{...e,words:[]};const t=(e.end-e.start)/e.words.length;return{...e,words:e.words.map(((o,a)=>({text:o.text,start:e.start+a*t,end:e.start+(a+1)*t,styles:o.styles})))}},DA=s.memoize((e=>bA((t=>{var o;const a=null==(o=xA(e)(t))?void 0:o.byId;if(!a)return null;return Object.keys(a).map((o=>LA(e,o)(t)))}),(e=>e?e.sort(((e,t)=>e.start-t.start)):null)))),OA=s.memoize(((e,t)=>m((o=>{var a;return null==(a=xA(e)(o))?void 0:a.byId[t]}),(e=>e))),wA),LA=s.memoize(((e,t)=>m((o=>{var a;return null==(a=xA(e)(o))?void 0:a.byId[t]}),(e=>{if(!e)throw Error(`No frame with id ${t}`);return e}))),wA),FA=s.memoize(((e,t)=>m(LA(e,t),(e=>PA(e)))),wA),MA=s.memoize((e=>bA((t=>{var o;const a=null==(o=xA(e)(t))?void 0:o.byId;if(!a)return null;return Object.keys(a).map((o=>FA(e,o)(t)))}),(e=>e?e.sort(((e,t)=>e.start-t.start)):null))));function UA(e){return()=>{const t=new WeakMap;return o=>{const a=t.get(o.frame);if(a&&ol(a.params,o))return a.result;const i=e(o);return t.set(o.frame,{params:o,result:i}),i}}}function BA(e){const t=[],o=[],a=[];if(!e.wasTimedFrame)return{clippedLeft:o,clippedRight:a,keptWords:e.words};for(const i of e.words){const s=i.layerAlignedEnd-e.layerAlignedStart,n=e.layerAlignedEnd-i.layerAlignedStart,r=Math.min(s,n),l=i.layerAlignedEnd-i.layerAlignedStart,d=0===l?100:r/l,c=s<n;c&&d>.5||!c&&d>=.5?t.push(i):s<n?o.push(i):a.push(i)}return{keptWords:t,clippedLeft:o,clippedRight:a}}const VA=UA((({assetId:e,filterEmpty:t,filterInvalid:o,frame:a,subtitleableLayers:i})=>{const s=nd(a),n=PA(a);if(!i.length)return[];const r=[];for(const d of i){const{startTime:a,endTime:i,playbackRate:l,videoDelay:c}=dm(d),u=1/l,m=c-a*u,p=c,h=c+(i-a)*u;if(!Sr(n.start,n.end,a,i))continue;const g=n.start*u+m,f=n.end*u+m,y=Math.max(g,p),v=Math.min(f,h);if(o){if(n.start===n.end)continue;if(n.start>n.end)continue;if(v-y<=.01)continue}if(t){if(0===n.words.length)continue;if(!n.words.filter((({text:e})=>!!e)).length)continue}const _={assetId:e,id:n.id,layerAlignedStart:y,layerAlignedEnd:v,containingLayerIds:new Set([d.id]),containingLayerStartTime:p,containingLayerEndTime:h,containingLayerPlaybackRate:l,startTimeOffset:m,endTimeOffset:m,wasTimedFrame:s,words:n.words.map((e=>({text:e.text,layerAlignedStart:e.start*u+m,layerAlignedEnd:e.end*u+m,styles:e.styles})))},{clippedLeft:w,clippedRight:b,keptWords:T}=BA(_),x={..._,wordIsClippedList:[...w.map((()=>!0)),...T.map((()=>!1)),...b.map((()=>!0))],words:_.words};r.push(x)}r.sort(((e,t)=>e.layerAlignedStart-t.layerAlignedStart));const l=function(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];if(!s)continue;const n=t[t.length-1];if(!n){t.push(s);continue}if(n.id!==s.id){t.push(s);continue}const r=(o=n.layerAlignedEnd,a=s.layerAlignedStart,Math.abs(o-a)<.001);if(n.endTimeOffset<s.startTimeOffset-.001||!r){t.push(s);continue}let l=n.wordIsClippedList.lastIndexOf(!1);-1===l&&(l=n.words.length-1);let d=s.wordIsClippedList.indexOf(!1);if(-1===d&&(d=s.words.length-1),l>d&&!n.wordIsClippedList.every((e=>!e))&&!s.wordIsClippedList.every((e=>!e))){t.push(s);continue}const c=n.wordIsClippedList.map(((e,t)=>{const o=s.wordIsClippedList[t];return e&&!!o})),u=[];for(let e=0;e<c.length;e++){const t=n.wordIsClippedList[e],o=s.wordIsClippedList[e],a=n.words[e],i=s.words[e];a&&i&&(t?o?u.push(a):u.push(i):u.push(a))}t[t.length-1]={...n,layerAlignedEnd:s.layerAlignedEnd,endTimeOffset:s.endTimeOffset,containingLayerEndTime:s.containingLayerEndTime,containingLayerIds:new Set([...n.containingLayerIds,...s.containingLayerIds]),wordIsClippedList:c,words:u}}var o,a;return t.map((e=>({...e,words:e.words.filter(((t,o)=>!e.wordIsClippedList[o]))})))}(r);return l.filter((e=>!(e.wordIsClippedList.length>0&&0===e.words.length)))})),WA=s.memoize((({assetId:e,filterEmpty:t,filterInvalid:o})=>{const a=VA();return m(DA(e),jA([e]),(function(i,s){return(i||[]).map((i=>a({assetId:e,filterEmpty:t,filterInvalid:o,frame:i,subtitleableLayers:s}))).flat().sort(((e,t)=>e.layerAlignedStart-t.layerAlignedStart))}))}),_A),GA=({assetId:e,ignoreCorrections:t,languageCode:o,maxCharsPerSubtitle:a})=>m(AA(e),YA(e),MA(e),(function(e,i,s){let n;if((null==s?void 0:s.length)&&!t)n=s.flatMap((e=>e.words.map((t=>({...t,position:e.position}))))).map((e=>({start_time:e.start,end_time:e.end,word:e.text,styles:e.styles,newFrameProperties:{position:e.position}})));else{if(!e||"completed"!==e.state)return[];n=mA(o)?function(e){const t=[];return e.forEach((e=>{const o=e.word;let a=!1;for(const t of Jn)if(gA(o,t,!1,!1)){a=!0;break}if(a){const e=t[t.length-1];e&&(t[t.length-1]={...e,word:(i=e.word,i.endsWith(",")?i.slice(0,-1):i)})}else t.push(e);var i})),t}(e.words):e.words}return DC({languageCode:o,words:n,maxCharsPerSubtitle:a,separator:i})})),HA=m(TA,(e=>e.length>0)),$A=e=>{const[t,o]=e.split("_");return{languageCode:t||e,translateCode:o}},KA=s.memoize((e=>{const t=IA(e);return m((e=>t(e).languageKey),(e=>t(e).translatedLanguageCode),((e,t)=>{if(t)return t;if(!e)return null;const{languageCode:o,translateCode:a}=$A(e);return a??o}))})),zA=s.memoize((e=>{const t=IA(e);return m((e=>t(e).languageKey),(e=>t(e).translatedLanguageCode),((e,t)=>{if(!e)return null;const{languageCode:o,translateCode:a}=$A(e);return{languageCode:o,translateCode:t||a}}))})),YA=s.memoize((e=>{const t=IA(e);return m(KA(e),AA(e),(t=>{var o,a;return null==(a=null==(o=t.studio.assetUploadedSubtitles)?void 0:o[e])?void 0:a.subtitles}),(e=>t(e).transcriptionSource),((e,t,o,a)=>"upload"===a||"manual"===a?o?CC(o.map((e=>e.text))):" ":e&&"completed"===(null==t?void 0:t.state)?kC(e):" "))})),JA=s.memoize((({assetId:e,filterEmpty:t,filterInvalid:o})=>{const a=XA();return m(DA(e),jA([e]),kA(e),YA(e),((i,s,n,r)=>(i||[]).map((i=>a({assetId:e,filterEmpty:t,filterInvalid:o,frame:i,style:n,subtitleableLayers:s,wordSeparator:r}))).flat()))}),_A);function qA(e){const t={backgroundColor:e.backgroundColor,borderRadius:{relative:`${e.borderRadius}%`},color:e.fontColor,fontFamily:e.fontFamily.fontFamily,fontWeight:e.fontWeight,globalAlpha:1,isTrimmed:!0,italic:e.italic,lineHeight:e.lineHeight,textAlign:e.textAlign,textTransform:e.textTransform,textShadow:"none"!==e.textShadow?e.textShadow:"transparent",textOutline:e.textOutline,textPadding:e.backgroundPadding,type:zl.Text,wrapOrFill:e.backgroundStyle,underline:e.underline,isMagicSubtitle:!0,verticalAlign:e.verticalAlign};return"custom"===e.fontFamily.type&&(t.asset_id=e.fontFamily.asset_id,t.url=e.fontFamily.url,t.fontType=e.fontFamily.fontType,t.hasCustomFont=!0),e.dropShadow&&(t.textEffect="dropShadow",t.textEffectColor=e.dropShadow.color,t.textShadowBlur=e.dropShadow.blur,t.textShadowDist=e.dropShadow.distance,t.textShadowRot=e.dropShadow.rotation),t}const XA=UA((function({assetId:e,filterEmpty:t,filterInvalid:o,frame:a,style:i,subtitleableLayers:s,wordSeparator:n}){const r=VA()({assetId:e,filterEmpty:t,filterInvalid:o,frame:a,subtitleableLayers:s}),l=qA(i);return r.map((function(t){const o=t.words.map((e=>e.text)).join(n),a=[...t.containingLayerIds.keys(),t.id].join("-");return{...l,id:a,assetId:e,wordSeparator:n,text:o,startTime:t.layerAlignedStart,endTime:t.layerAlignedEnd,frame:{id:t.id,start:t.layerAlignedStart,end:t.layerAlignedEnd,containingLayerEndTime:t.containingLayerEndTime,containingLayerIds:t.containingLayerIds,containingLayerPlaybackRate:t.containingLayerPlaybackRate,containingLayerStartTime:t.containingLayerStartTime,endTimeOffset:t.endTimeOffset,startTimeOffset:t.startTimeOffset,wordIsClippedList:t.wordIsClippedList,words:t.words.map((e=>({text:e.text,start:e.layerAlignedStart,end:e.layerAlignedEnd,styles:e.styles})))},fontSize:1,textWithLineBreaks:o}}))}));function QA({assetId:e,canvasHeight:t,canvasWidth:o,canvasX:a,canvasY:i,filterEmpty:s,filterInvalid:n,fontSizeOverride:r,frame:l,frameIndex:d,isRTL:c,selection:u,style:m,subtitleableLayers:p,transformerPosition:h,transformerSize:g,transition:f,wordByWordAnimations:y,wordSeparator:v,wordSizer:_,tempConfigPosition:w}){const b=XA(),T=(o??1)/700;const x=b({assetId:e,filterEmpty:s,filterInvalid:n,frame:l,style:m,subtitleableLayers:p,wordSeparator:v}),S=(r??m.fontSize)*T;return x.map((s=>{let n=h;const r=w||l.position;r&&(n={x:r.xPct/100*(o||0)+(a||0),y:r.yPct/100*(t||0)+(i||0),width:r.widthPct/100*(o||0),height:r.heightPct/100*(t||0),rotation:r.rotation||0});const p=function({assetId:e,frame:t,frameIndex:o,subtitleStyles:a,maxWidth:i,selection:s,separator:n,verticalAlign:r,wordSizer:l}){const d=[];for(const f of t.words){const{leadingNewlineCount:e,trailingNewlineCount:t,trimmedWordText:o}=lA(f.text);for(let i=0;i<e;i++)d.push([]);0===d.length&&d.push([]);const a=d[d.length-1];if(!a)throw new Error("latestPhrase is undefined");a.push({...f,text:o});for(let i=0;i<t;i++)d.push([])}const c=[];for(const f of d){if(0===f.length){c.push({words:[],width:0});continue}let e=cA({maxWidth:i,orderedWords:dA({words:f,verticalAlign:r}),separator:n,wordSizer:l});if("middle"===r){const t=cA({maxWidth:i,orderedWords:dA({words:f,verticalAlign:"bottom"}),separator:n,wordSizer:l});t.length<e.length&&(e=t)}c.push(...e)}const u=rA(t.words.map((e=>e.text))),m=nA(a.colorHighlights,o),p=" "===n?1:0,h=[];let g=0;for(const{width:f,words:y}of c){const o={width:f,words:[]};for(let a=0;a<y.length;a++){const i=y[a];if(!i)continue;const{originalNdx:n,word:r}=i;if(n===u&&m){const e=zk(r.text).map(((e,t)=>{var o;const a=null==(o=r.styles)?void 0:o[t];return a?a&&void 0===a.color?{...a,color:m}:a:{index:t,color:m}}));r.styles=e}o.words.push({...r,splitTextByStyle:Yk(r,g,(null==s?void 0:s.assetId)===e&&s.frameId===t.id?s:null),charOffset:g}),g+=r.text.length,a!==y.length-1&&(g+=p)}h.push(o),g++}return h}({assetId:e,frame:s.frame,frameIndex:d,subtitleStyles:m,maxWidth:l.position?n.width:g.width,selection:u,separator:v,verticalAlign:s.verticalAlign??"top",wordSizer:_}),{x:b,y:T,width:x,height:E,rotation:I}=LC({...s,fontSize:S},p,n),{xPercent:C,yPercent:k}=JE(b,T,{x:a,y:i,width:o,height:t}),{widthPercent:A,heightPercent:j}=KE(x,E,{width:o,height:t}),N=((e,t)=>e&&e[t%e.length]||0)(m.rotationOffsets,d);return{...s,brokenLines:p,frame:{...s.frame,lines:p},isRTL:c,position:{height:j,width:A,x:C,y:k,rotation:(I||0)+N},fontSize:S,textWithLineBreaks:p.map((e=>e.words.map((e=>e.text)).join(v))).join("\n"),transition:f,wordByWordAnimations:y}}))}const ZA=UA(QA),ej=s.memoize((({filterEmpty:e,filterInvalid:t,canvasHeight:o,canvasWidth:a,canvasX:i,canvasY:s,fontSizeOverride:n})=>bA((r=>TA(r).map((r=>tj({assetId:r,filterEmpty:e,filterInvalid:t,canvasHeight:o,canvasWidth:a,canvasX:i,canvasY:s,fontSizeOverride:n??null}))).map((e=>e(r)))),(e=>e.flat()))),_A),tj=s.memoize((({assetId:e,filterEmpty:t,filterInvalid:o,canvasHeight:a,canvasWidth:i,canvasX:s,canvasY:n,fontSizeOverride:r})=>m(DA(e),CA({assetId:e,canvasHeight:a,canvasWidth:i,canvasX:s,canvasY:n}),nj(e),(e=>e.studioLocal.magicSubtitleSelection),kA(e),jA([e]),EA({assetId:e,canvasHeight:a,canvasWidth:i}),cj(e),dj(e),YA(e),RA({assetId:e,canvasWidth:i,fontSizeOverride:r}),(e=>e.studioLocal.magicSubtitlesGlobal.position),((l,d,c,u,m,p,h,g,f,y,v,_)=>{const w=ZA();return(l||[]).map(((l,b)=>w({assetId:e,canvasHeight:a,canvasWidth:i,canvasX:s,canvasY:n,filterEmpty:t,filterInvalid:o,frame:l,frameIndex:b,fontSizeOverride:r,isRTL:c,selection:u,style:m,subtitleableLayers:p,transformerPosition:d,transformerSize:h,transition:g,wordByWordAnimations:f,wordSeparator:y,wordSizer:v,tempConfigPosition:_}))).flat()}))),_A),oj=({assetId:e,canvasHeight:t,canvasWidth:o,canvasX:a,canvasY:i,fontSizeOverride:s})=>{const n=XA();return r=>m(DA(e),CA({assetId:e,canvasHeight:t,canvasWidth:o,canvasX:a,canvasY:i}),nj(e),(e=>e.studioLocal.magicSubtitleSelection),kA(e),jA([e]),EA({assetId:e,canvasHeight:t,canvasWidth:o}),cj(e),dj(e),YA(e),RA({assetId:e,canvasWidth:o,fontSizeOverride:s??null}),(e=>e.studioLocal.magicSubtitlesGlobal.position),(function(l,d,c,u,m,p,h,g,f,y,v,_){if(!l)return null;const w=l.map((t=>n({assetId:e,filterEmpty:!0,filterInvalid:!0,frame:t,style:m,subtitleableLayers:p,wordSeparator:y}))).flat().filter((function(e){return e.startTime<=r&&e.endTime>r})),[b]=w.sort(((e,t)=>t.startTime-e.startTime));if(!b)return null;const T=l.findIndex((e=>e.id===b.frame.id)),x=l[T];if(!x)return null;return QA({assetId:e,canvasHeight:t,canvasWidth:o,canvasX:a,canvasY:i,filterEmpty:!0,filterInvalid:!0,frame:x,frameIndex:T,fontSizeOverride:s??null,isRTL:c,selection:u,style:m,subtitleableLayers:p,transformerPosition:d,transformerSize:h,transition:g,wordByWordAnimations:f,wordSeparator:y,wordSizer:v,tempConfigPosition:_}).find((function(e){return e.startTime<=r&&e.endTime>r}))||null}))},aj=bA((e=>TA(e).map((e=>WA({assetId:e,filterEmpty:!1,filterInvalid:!1}))).map((t=>t(e)))),(e=>e.flat().sort(((e,t)=>{const o=e.layerAlignedStart-t.layerAlignedStart;return 0!==o?o:e.layerAlignedEnd-t.layerAlignedEnd})))),ij=e=>{const t=TA(e),o={},a={allIds:[],byId:{}};if(t.length>0)for(const i of t){const t=s.cloneDeep(tj({assetId:i,filterEmpty:!0,filterInvalid:!0,canvasHeight:e.studio.height??1,canvasWidth:e.studio.width??1,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY,fontSizeOverride:null})(e));t.sort(((e,t)=>e.startTime-t.startTime));const n=t[0];if(!t.length||!n)continue;const r=IA(i)(e),{transitionId:l,transitionDuration:d,transitionOverlapDuration:c=0,wordByWordAnimations:u}=r;let m="";if(l&&l!==Yl.None){const e=n.id;m=P(),a.allIds.push(m),a.byId[m]={animationName:l,id:m,isCrossTransition:!1,layerId:e,speed:"default",transitionDuration:d||.5}}let p="";if((null==u?void 0:u.animationId)&&u.animationId!==Yl.None){const e=n.id,{animationId:t,animationName:o="",wordByWordStyles:i={}}=u;p=P();const s={animationName:t,id:p,isCrossTransition:!1,layerId:e,transitionDuration:.5,wordByWordStyles:i[o]};a.allIds.push(p),a.byId[p]=s}o[i]=t.map((e=>{const t=[];m&&t.push(m),p&&t.push(p);const o=m?-c:0,a=m?c:0;return{...e,fallbackFonts:Q(e.text),startTime:e.startTime+o,endTime:e.endTime+a,animation:{constant:t}}}))}return{animations:a,magicSubtitlesOnExport:o}},sj=/[\u0591-\u07FF]/,nj=s.memoize((e=>m(KA(e),DA(e),YA(e),((e,t,o)=>{if(e)return X.isRtlLang(e);const a=(t||[]).slice(0,4).map((e=>e.words.map((e=>e.text)).join(o))).join(o);return sj.test(a)})))),rj=s.memoize((({filterEmpty:e,filterInvalid:t})=>bA((o=>TA(o).map((o=>JA({assetId:o,filterEmpty:e,filterInvalid:t}))).map((e=>e(o)))),(e=>e.flat()))),_A),lj=rj({filterEmpty:!1,filterInvalid:!0}),dj=s.memoize((e=>m(IA(e),(e=>e.wordByWordAnimations)))),cj=s.memoize((e=>m(IA(e),(e=>{const{transitionId:t,transitionDuration:o,transitionOverlapDuration:a,transitionSpeed:i}=e;return{transitionId:t,transitionDuration:o,transitionOverlapDuration:a,transitionSpeed:i}})))),uj=m((e=>lj(e)),(e=>sf(e)??1),(e=>{var t;return!!(null==(t=e.comments.comments)?void 0:t.length)}),(e=>{var t;const{timelineContainerWidth:o}=e.timeline;return((null==(t=e.projectSessionSettings.timelinePosition)?void 0:t.timelineScrollLeft)??0)-.25*o}),(e=>{var t;const{timelineContainerWidth:o}=e.timeline;return((null==(t=e.projectSessionSettings.timelinePosition)?void 0:t.timelineScrollLeft)??0)+o+.25*o}),(e=>e.studio.selectedItem),((e,t,o,a,i,s)=>{const n=ck(!1),r=ik({hasMagicSubtitle:!1,shortRowCount:0,tallRowCount:0},o),l=[];let d=null,c=0;const u=5/t,m=25/t,p=200/t;e.sort(((e,t)=>e.startTime-t.startTime));const h="magicSubtitle"===(null==s?void 0:s.type)?s.frames.byId:{};for(const y of e){if(!d){d={...y,containedFrames:[{assetId:y.assetId,containingLayerPlaybackRate:y.frame.containingLayerPlaybackRate,id:y.frame.id,wordIsClippedList:y.frame.wordIsClippedList}],containedFramesStartOffset:y.frame.startTimeOffset,containedFramesEndOffset:y.frame.endTimeOffset},c=1;continue}const e=y.endTime-y.startTime;if(y.startTime-d.endTime<u&&e<m)d.endTime=y.endTime,d.text+=` ${y.text}`,d.containedFrames.push({assetId:y.assetId,containingLayerPlaybackRate:y.frame.containingLayerPlaybackRate,id:y.frame.id,wordIsClippedList:y.frame.wordIsClippedList}),d.containedFramesEndOffset=y.frame.endTimeOffset,c+=1;else{c>1&&(d.text=`${c} subtitles (${d.text})`),l.push(d);e<p&&!h[y.frame.id]?(d={...y,containedFrames:[{assetId:y.assetId,containingLayerPlaybackRate:y.frame.containingLayerPlaybackRate,id:y.frame.id,wordIsClippedList:y.frame.wordIsClippedList}],containedFramesStartOffset:y.frame.startTimeOffset,containedFramesEndOffset:y.frame.endTimeOffset},c=1):(l.push({...y,containedFrames:[{assetId:y.assetId,containingLayerPlaybackRate:y.frame.containingLayerPlaybackRate,id:y.frame.id,wordIsClippedList:y.frame.wordIsClippedList}],containedFramesStartOffset:y.frame.startTimeOffset,containedFramesEndOffset:y.frame.endTimeOffset}),d=null,c=0)}}d&&(c>1&&(d.text=`${c} subtitles (${d.text})`),l.push(d));const g=l.map((e=>{const o=BS(t,e.endTime)-BS(t,e.startTime);return{...e,asset_id:e.assetId,isTall:!1,timelinePosition:{left:BS(t,e.startTime),width:o,height:n,top:r},text:e.text,timelineRow:-1,type:zl.Text,containedFrames:e.containedFrames,containedFramesStartOffset:e.containedFramesStartOffset,containedFramesEndOffset:e.containedFramesEndOffset}})),f=[];for(const y of g){const[e,o]=TS(y,0),s=BS(t,e);!(BS(t,o)<=a||i<=s)&&f.push(y)}return f})),mj=m((e=>e.studio.magicSubtitles),((e={})=>{var t,o;return Object.values(e).some((e=>"transcription"===(null==e?void 0:e.transcriptionSource)||!(null==e?void 0:e.transcriptionSource)))?"transcription":"upload"===(null==(t=e["background-asset"])?void 0:t.transcriptionSource)?"upload":"manual"===(null==(o=e["background-asset"])?void 0:o.transcriptionSource)?"manual":null})),pj=m((e=>{var t;return null==(t=e.studio.magicSubtitlesGlobal)?void 0:t.languageKey}),(e=>e.studio.magicSubtitles),TA,((e,t,o)=>{let a="en-US";if(e)a=e;else for(const[i,s]of Object.entries(t||{}))if(o.includes(i)&&(null==s?void 0:s.languageKey))return s.languageKey;return a})),hj=m((e=>e.translation.translationMethod),(e=>e)),gj=(e,t)=>{const o=e[0]/e[1],a=t.width/t.height;let i=t.width,s=t.height;return o>=a?s=e[1]*t.width/e[0]:i=e[0]*t.height/e[1],{width:i,height:s}},fj=(e,t,o,a,i,s)=>({x:(e-i)/2+o,y:(t-s)/2+a}),yj=(e,t)=>{if(!e||!t||0===t.width||0===t.height)return;const o=vj(e,t),a=_j(e,t);return{x:o.x,y:o.y,width:a.width,height:a.height}},vj=(e,t)=>({x:e.x/100*t.width+t.x,y:e.y/100*t.height+t.y}),_j=(e,t)=>({width:e.width/100*t.width,height:e.height/100*t.height}),wj={x:0,y:0,width:100,height:100,presetIndex:-1},bj=e=>{let t=e.split(":");2!==t.length&&(t=["1","1"]);const o=t.map((e=>{const t=parseFloat(e);return t?t<0?1:t:1}));return{ratioWidth:o[0],ratioHeight:o[1]}},Tj=(e,t,o)=>{const a=(e=>e||aE()?0:30)(o||!1),i=t.width-2*a,s=t.height-2*a,{ratioWidth:n,ratioHeight:r}=bj(e),l=gj([n,r],{width:i,height:s}),d=fj(t.width,t.height,0,0,l.width,l.height);return{width:l.width,height:l.height,canvasX:d.x,canvasY:d.y,containerX:t.x||0,containerY:t.y||0,containerWidth:t.width,containerHeight:t.height}},xj=(e,t=0,o,a={})=>{var i;let s={top:window.screen.height,right:0,bottom:0,left:window.screen.width,rotation:t};const n=o?WE(o.xPercent,o.yPercent):XI(e);for(const r of e){if("audio"===r.type&&!r.isAudiogram||!r.position)continue;const e=CI(r,null==(i=a.keyframing)?void 0:i[r.id],a.studioTime||0,a.canvasWidth||0,a.canvasHeight||0);let{x:o,y:l}=WE(e.x,e.y);const{width:d,height:c}=HE(e.width,e.height);"ellipse"===r.shapeType&&(o-=d/2,l-=c/2);const u=[{x:o,y:l},{x:o+d,y:l},{x:o,y:l+c},{x:o+d,y:l+c}],m=XI([r]),p=u.map((t=>YI(t,m,JI(e.rotation||0)))).map((e=>YI(e,n,JI(-1*t))));s={top:Math.min(s.top,...p.map((e=>e.y))),right:Math.max(s.right,...p.map((e=>e.x))),bottom:Math.max(s.bottom,...p.map((e=>e.y))),left:Math.min(s.left,...p.map((e=>e.x))),rotation:s.rotation}}return s},Sj=(e,t,o,a={})=>{const i=xj(e,t,o,a);return{x:i.left,y:i.top,width:i.right-i.left,height:i.bottom-i.top,rotation:i.rotation}},Ej=e=>{const t=xj(e),o=qE(t.left,t.top),a=qE(t.right,t.bottom);return{top:Ru(parseFloat(o.yPercent),0,100),right:Ru(parseFloat(a.xPercent),0,100),bottom:Ru(parseFloat(a.yPercent),0,100),left:Ru(parseFloat(o.xPercent),0,100)}},Ij=()=>{const{state:e}=sr(),{overlayWithHeader:t}=e.studio;return t&&""!==t?t:void 0},Cj=e=>{const{dispatch:t}=sr();t(lc({key:Ev.trim,params:e}))},kj=e=>{const{dispatch:t,state:o}=sr(),a=o.exports.runningExports.length||o.exports.pendingExport;Fm(ym.STUDIO_EXPORT_PANEL_OPENED),t(lc({key:"exportPanel",params:{panel:e||a?Iv.HISTORY:Iv.SETTINGS}}))},Aj=()=>{const{dispatch:e}=sr();e(Xd())},jj=e=>{Fm(ym.SMART_CUT_OPENED,{layerType:e.previewLayer.type});const{dispatch:t}=sr();t(lc({key:Ev.smartCut,params:e}))},Nj=e=>{Fm(ym.SCENE_SPLIT_OPENED);const{dispatch:t}=sr();t(lc({key:Ev.sceneSplit,params:e}))},Rj=()=>{const{dispatch:e}=sr();e({type:"HIDE_SIGN_IN"})},Pj=()=>{const{dispatch:e}=sr();e(hS(!0))},Dj=()=>{const{dispatch:e}=sr();e(hS(!1))};function Oj(e){let t=null,o=null;for(const[a,i]of Object.entries(e))if(a.includes("person"))if(t){const e=(i.x2-i.x1)*(i.y2-i.y1);(t.x2-t.x1)*(t.y2-t.y1)<e&&(t=i,o=a)}else t=i;return{object:o,box:t}}const Lj=e=>{var t;let o=0;return"person"!==e.name?o:(o+=e.conf,(null==(t=e.face_features)?void 0:t.jawOpen)?(o+=100*e.face_features.jawOpen,o):o)};const Fj=e=>{const t={x:100,y:100,width:0,height:0};let o=0,a=0;const i=(e.x1+e.x2)/2,n=(e.y1+e.y2)/2,r=e.x2-e.x1,l=e.y2-e.y1;o+=i,a+=n,t.width=Math.max(t.width,100*r),t.height=Math.max(t.height,100*l);const d=100*o/1,c=100*a/1;return t.x=s.clamp(d-t.width/2,0,100-t.width),t.y=s.clamp(c-t.height/2,0,100-t.height),t},Mj=(e,t)=>{const o=(e.x1+ +e.x2)/2,a=(e.y1+e.y2)/2,i=t.x2-t.x1,s=t.y2-t.y1,n={x1:o-i/2,x2:o+i/2,y1:a-s/2,y2:a+s/2},r=e=>Math.max(0,Math.min(1,e));return{x1:r(n.x1),x2:r(n.x2),y1:r(n.y1),y2:r(n.y2)}},Uj=(e,t)=>e.width/100*(t.width||0)*(e.height/100*(t.height||0));function Bj(e){const{state:t}=sr(),[o]=t.studio.scenes;if(!o)return 0;const a=o.layers.findIndex((t=>t.id===e.id));return-1===a?o.layers.length-1:a}const Vj=m((e=>e.studio.allLayers.byId),(e=>{const t=[],o=[];return Object.values(e).forEach((e=>{e&&(e.type===zl.Video?t.push(e):e.type===zl.Image&&o.push(e))})),{videoLayers:t,imageLayers:o}}));function Wj(){const{state:e}=sr();return Vj(e)}const Gj=m((e=>e.studio.allLayers.byId),(e=>{const t=new Set;return Object.values(e).forEach((e=>{if(!e)return;if(!Xl(e)&&!Ql(e))return;const o=e.asset_id;o&&t.add(o)})),t})),Hj=()=>tl(Kj),$j=e=>e.sort(((e,t)=>e-t));const Kj=m(Gj,(e=>e.assets.byId),(e=>e.vision.byAssetId),((e,t,o)=>{let a=0;return e.forEach((e=>{var i,s;if("success"===(null==(s=null==(i=o[e])?void 0:i[ld.ObjectTrackingV2])?void 0:s.status))return;const n=t[e];(null==n?void 0:n.duration)&&(a+=.2*n.duration+10.5)})),a}));function zj(){const{videoLayers:e,imageLayers:t}=Wj(),o=e.some((({fromSmartReframe:e})=>e));Fm(ym.CLICKED_SMART_REFRAME_BUTTON,{hasSmartReframeLayers:o,imageLayerCount:t.length,videoLayerCount:e.length})}const Yj=(e,t)=>{if(e.job_type===ld.ObjectTrackingV2)Jj(e,t)},Jj=(e,t)=>{var o,a,i,s,n,r,l;Fm(ym.VISION_JOB_COMPLETED,{duration:t,jobType:e.job_type,status:e.status,jobDuration:e.total_duration||0,assetDuration:e.asset_duration,assetDownloadDuration:null==(o=e.job_result)?void 0:o.asset_download_duration,assetTranscriptionDuration:null==(a=e.job_result)?void 0:a.transcription_duration,sceneSplitDuration:null==(i=e.job_result)?void 0:i.scene_split_duration,frameExtractionDuration:null==(s=e.job_result)?void 0:s.frame_extraction_duration,objectDetectionDuration:null==(n=e.job_result)?void 0:n.yolo_duration,faceLandmarkDetectionDuration:null==(r=e.job_result)?void 0:r.mp_duration,postProcessDuration:null==(l=e.job_result)?void 0:l.post_process_duration})};function qj(e){return!!e.position}function Xj(e){return`${e}%`}function Qj({layer:e,newRatio:t,prevRatio:o,resizeMethod:a}){const{position:i,type:s}=e;if(!("fit"===a||"shape"===s||"text"===s))return i;const n=function({position:e,newRatio:t,prevRatio:o}){const{xFactor:a,yFactor:i}=function({newRatio:e,prevRatio:t}){const o=e.height/e.width,a=t.height/t.width;return o>a?{yFactor:a/o,xFactor:1}:{xFactor:o/a,yFactor:1}}({newRatio:t,prevRatio:o}),{width:s,height:n,x:r,y:l}=function(e){return{width:parseFloat(e.width),height:parseFloat(e.height),x:parseFloat(e.x),y:parseFloat(e.y)}}(e);if(1!==i){const t=n*i,o=l-(t-n)/2;return{...e,height:Xj(t),y:Xj(o)}}const d=s*a,c=r-(d-s)/2;return{...e,width:Xj(d),x:Xj(c)}}({position:i,newRatio:t,prevRatio:o});return n}const Zj=v({name:"vision",initialState:{byAssetId:{},progressByVisionJobId:{}},reducers:{setAssetVisionJob:(e,t)=>{const{assetId:o,visionJob:a}=t.payload;e.byAssetId[o]={...e.byAssetId[o],[a.job_type]:a}},deleteAssetVisionJob:(e,t)=>{const{assetId:o}=t.payload;delete e.byAssetId[o]},setVisionJobProgress:(e,t)=>{const{jobId:o,visionJob:a}=t.payload;e.progressByVisionJobId[o]=a},deleteVisionJobProgress:(e,t)=>{const{jobId:o}=t.payload;delete e.progressByVisionJobId[o]}}}),{setAssetVisionJob:eN,deleteAssetVisionJob:tN,setVisionJobProgress:oN,deleteVisionJobProgress:aN}=Zj.actions,iN=v({initialState:{byId:{}},name:"assets",reducers:{assetTranscriptionFailed:(e,t)=>{const{assetId:o,languageKey:a}=t.payload,i=e.byId[o]||{},s={assetId:o,state:"failed"};i[a]=s,e.byId[o]=i},assetTranscriptionFetched:(e,t)=>{t.payload.forEach((({assetId:t,languageKey:o,status:a})=>{const i=e.byId[t]||{};i[o]=a,e.byId[t]=i}))},assetTranscriptionCancelled:(e,t)=>{const{assetId:o,languageKey:a}=t.payload,i=e.byId[o]||{};i[a]=void 0,e.byId[o]=i}}}),{assetTranscriptionFailed:sN,assetTranscriptionFetched:nN,assetTranscriptionCancelled:rN}=iN.actions;const lN=Z("2023-10-05"),dN=Z("2023-10-21");function cN(e,t,o){const a=Z(new Date(1e3*parseInt(t.substring(0,8),16)));return!(e&&"google"===e.provider_id&&!1===e.speaker_labels&&a.isAfter(lN)&&a.isBefore(dN))&&(!(null==o?void 0:o.needsSpeakerID)||(null==e?void 0:e.keep_whole)&&(null==e?void 0:e.speaker_labels))}async function uN({assetId:e,assetDuration:t,languageCode:o,languageKey:a,requestingFeature:i,timelineLayer:s,translateCode:n,videoId:r,speakerLabels:l=!1}){var d,c,u;const{dispatch:m,state:p}=sr(),h=l||Bu("speakerTranscription")||Bu("speakerTranscriptionBatchTwo"),g=mA(o);wp({languageCode:o,translateCode:n}).catch((e=>{console.error(e)}));const f=p.assets.byId[e],y=f&&!Zr.forceNewAssets?f.transcriptionIds:null,v=null==y?void 0:y[a];if(v){const{result:t}=v;let o=!1;if(t){const i=null==(d=p.assetTranscriptions.byId[e])?void 0:d[a];if(i&&"completed"===i.state&&i.words.length>0&&cN(i.job_params,i.assetTranscriptionId,{needsSpeakerID:h})&&!(null==(c=p.teams.activeBrandkit)?void 0:c.customSpelling))return null;try{const{asset_transcription:i}=await Yr(`/api/v2/transcriptions/result/${t}`,{params:{videoId:r}});i&&i.words.length>0&&cN(i.job_params,i._id,{needsSpeakerID:h})&&(o=!0,m(nN([{assetId:e,languageKey:a,status:{assetTranscriptionId:t,state:"completed",languageKey:a,words:i.words,job_params:i.job_params}}])))}catch(x){m(sN({assetId:e,languageKey:a})),mh({description:"Failed to transcribe asset",error:x}),o=!0}if(o)return null}}const _=h,w=h,b=g,T={Origin:"Studio","Translated Language":n,"Source Language":o,Location:i,asset_id:s.asset_id,"Duration (sec)":t,keep_whole:_,speaker_labels:w,disfluencies:b};try{const i=s;Fm(ym.AUTO_GENERATE_SUBTITLES,T);const l=(null==(u=mn.find((e=>e.transcriptionVariants.some((e=>e.code===o)))))?void 0:u.translateCode)??"",d={sourceVideo:OC(r,i),selectedSceneIndex:0,full:!0,languageCode:o,translate:!!n,translateLanguageCode:n,translateSourceLanguageCode:l,inHouse:!1,keep_whole:_,speaker_labels:w,disfluencies:b},c=await Jr("/api/v2/transcriptions",{body:d});if(!c.success)throw Error("Starting transcription failed");return m(nN([{assetId:e,languageKey:a,status:{assetDuration:t,assetId:e,state:"pending",languageKey:a,progress:{conformed:!1,trimmed:!1,done:!1,downloaded:!1,extracted:!1,speech:0},transcriptionId:c.transcriptionId}}])),c.transcriptionId}catch(x){m(sN({assetId:e,languageKey:a})),mh({description:"Failed to transcribe asset",error:x}),Fm(ym.AUTO_GENERATE_SUBTITLES_FAILS,{...T,failureMessage:"Job failed"})}return null}const mN=async e=>{try{const t=await Yr(`/api/v2/vision/vision-job/${e}`);if(t.visionJob)return t.visionJob}catch(IGe){console.error(IGe)}return null},pN=async(e,t,o="success")=>{try{const a=await Yr("/api/v2/vision/vision-jobs",{params:{asset_ids:e,job_type:t,job_status:o}});if(a.visionJobs)return a.visionJobs}catch(IGe){console.error(IGe)}return null},hN=async(e,t,o="success")=>(async(e,t,o="success")=>{const a=await pN([e],t,o);return(null==a?void 0:a.length)?a[0]:null})(e,t,o),gN=async(e,t,o,a)=>{const i=Date.now(),{dispatch:s}=sr();(null==a?void 0:a.languageCode)&&t===ld.ObjectTrackingV2&&await uN({...a});const n=await(async(e,t,o)=>{try{const a={asset_id:e,job_type:t,job_params:o},i=await Jr("/api/v2/vision/vision-job",{body:a});if(i.vision_job_id)return i.vision_job_id}catch(IGe){console.error(IGe),hh({description:"Speaker Focus failed to start. Please try again.",sentryMessage:"Speaker Focus: failed to start vision job",extra:{asset_id:e,job_type:t}})}return null})(e,t,{existingVisionJobId:null==a?void 0:a.existingVisionJobId,languageCode:null==a?void 0:a.languageCode,version:1});if(!n)return hh({description:"Error starting speaker focus. Please try again.",sentryMessage:"Speaker Focus: timed out",extra:{asset_id:e,job_type:t}}),null;let r=0;for(;!o.cancelled;){if(r>1e3)return hh({description:"Speaker Focus timed out. Please try again.",sentryMessage:"Speaker Focus: timed out",extra:{asset_id:e,job_type:t}}),null;const o=await mN(n);if(o)switch(o.status){case"queued":case"running":s(oN({jobId:n,visionJob:o}));break;case"success":{s(aN({jobId:n}));const e=Date.now();return Yj(o,e-i),o}case"error":{s(aN({jobId:n})),hh({description:"There was an error processing your video. Please try again."});const e=Date.now();return Yj(o,e-i),null}}r+=1,await new Promise((e=>setTimeout(e,3e3)))}return s(aN({jobId:n})),null};let fN;async function yN(e){const{url:t}=e,o=await(async(e="IMAGE")=>{if(fN)return await fN.setOptions({runningMode:e}),fN;const t=await ee.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/wasm"),o=await te.createFromOptions(t,{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/object_detector/efficientdet_lite0/float16/1/efficientdet_lite0.tflite",delegate:"GPU"},scoreThreshold:.5,runningMode:e});return fN=o,o})("IMAGE"),a=await(e=>new Promise(((t,o)=>{const a=new Image;a.onload=()=>t(a),a.onerror=o,a.src=e,a.crossOrigin="anonymous"})))(t),i=function({results:e,width:t,height:o}){const a={},i={};return e.detections.forEach((e=>{const s=e.categories[0],n=s.categoryName,r=s.score,{originX:l,originY:d,width:c,height:u}=e.boundingBox,m={x1:l/t,y1:d/o,x2:(l+c)/t,y2:(d+u)/o,name:n,conf:r},p=(i[n]||0)+1;i[n]=p,a[`${n}-${p}`]=m})),a}({results:o.detect(a),width:a.width,height:a.height});return i}function vN({defaultCrops:e,layerUpdates:t,speakerBoundingBoxes:o,speakerTimes:a,sourceLayer:i,timestampNdx:s}){t.fromSmartReframe=!0;const n=a[s];if(!n)throw new Error(`Invalid index: no timestamp at index ${s} in speaker times array`);const r=o[(e=>{const t=e.toString();return t.includes(".")?t:t+".0"})(n)];if(!r)throw new Error(`Invalid timestamp key: no bounding boxes found for timestamp ${n}`);const{box:l,object:d}=(e=>{let t=null,o=0;for(const[a,i]of Object.entries(e)){const e=Lj(i);e>o&&(o=e,t=a)}return{object:t,box:t?e[t]:null}})(r);!function({box:e,layer:t,layerUpdates:o,defaultCrops:a}){let i=null;if(e){const o=e.face_box?Fj(e.face_box):null,a=e.face_box?Fj(Mj(e.face_box,e)):Fj(e);o&&Uj(o,t)>9e4&&(i=o),Uj(a,t)>9e4&&(i=a)}i?o.crop=i:(null==a?void 0:a.fitToCenterPosition)?o.position={...t.position,...a.fitToCenterPosition}:(null==a?void 0:a.fillAndCropPosition)&&(o.position={...t.position,...a.fillAndCropPosition})}({box:d?l:null,layer:i,layerUpdates:t,defaultCrops:e})}const _N=({boundingBoxes:e,splitTimes:t,sourceLayer:o,fillAndCropPosition:a,fitToCenterPosition:i})=>{const s={fillAndCropPosition:a,fitToCenterPosition:i},{sourceLayerUpdates:n,newLayers:r}=(({sourceLayer:e,timestampsToSplit:t,speakerBoundingBoxes:o,defaultCrops:a})=>{const{start:i,end:s}=cm(e),{startTime:n,videoDelay:r,playbackRate:l}=dm(e),d=n+(s-i)*l,c=$j(Object.keys(o).map((e=>Number(e)))),u={},m=[];let p=!1;for(let h=0;h<t.length;h++){const i=t[h];if(void 0===i)continue;if(i>=d)break;if(i<=n)continue;let s=!1;if(n===(t[h-1]??0))for(let e=h;e<t.length;e++){const o=t[e];if(o===d&&(s=!0),o>d)break}if(s)break;!p&&i<d&&(u.endTime=i,u.startTime=n,u.isTrimmed=!0,vN({defaultCrops:a,layerUpdates:u,speakerBoundingBoxes:o,sourceLayer:e,speakerTimes:c,timestampNdx:h}),p=!0);const g=i,f=t[h+1]&&t[h+1]<d?t[h+1]:d,y=r+(g-n)/l,v={...e,id:oe.v4(),startTime:g,endTime:f,videoDelay:y,isTrimmed:!0,fromSmartReframe:!0},_={};vN({defaultCrops:a,layerUpdates:_,speakerBoundingBoxes:o,sourceLayer:v,speakerTimes:c,timestampNdx:h+1}),m.push({...v,..._})}if(!p){let i=0;for(let e=0;e<t.length;e++){i=e;const o=t[e];if(void 0!==o&&o>n)break}if(!c[i])throw new Error(`Invalid index: no timestamp at index ${i} in speaker times array`);vN({defaultCrops:a,layerUpdates:u,speakerBoundingBoxes:o,speakerTimes:c,sourceLayer:e,timestampNdx:i})}return{sourceLayerUpdates:u,newLayers:m}})({sourceLayer:o,timestampsToSplit:$j(t),speakerBoundingBoxes:e,defaultCrops:s});if(!r.length)return{layerUpdates:n,layersToAdd:r};const l={...o,...n},d=[];return r.forEach((e=>{const t=d[d.length-1]??l;if(!t)return;((e,t)=>{if(e.crop&&t.crop){const o=e.crop.x-t.crop.x,a=e.crop.y-t.crop.y,i=e.crop.width-t.crop.width,s=e.crop.height-t.crop.height;return 1-Math.sqrt(o*o+a*a+i*i+s*s)/Math.sqrt(e.crop.width**2+t.crop.height**2)}return e.position&&t.position&&e.position.x===t.position.x&&e.position.y===t.position.y&&e.position.width===t.position.width&&e.position.height===t.position.height&&e.position.rotation===t.position.rotation?1:0})(e,t)<.8?d.push(e):t.endTime=e.endTime})),{layerUpdates:l,layersToAdd:d}},wN=async()=>{const{dispatch:e}=sr(),t=(()=>{const{state:e}=sr();return Gj(e)})();if(!t.size)return;const o=[...t],a=await(async(e,t,o="success")=>pN(e,t,o))(o,ld.ObjectTrackingV2);g.batch((()=>{null==a||a.forEach((t=>{if(!(null==t?void 0:t.asset_id))return;const o=`${t.asset_id}`;e(eN({assetId:o,visionJob:t}))}))}))},bN=async(e,t,o)=>{var a,i,s,n,r;const{state:l,dispatch:d}=sr(),c=e.asset_id;if(!c)return null;let u=null;"success"===(null==(i=null==(a=l.vision.byAssetId[c])?void 0:a[ld.ObjectTrackingV2])?void 0:i.status)&&(u=null==(s=l.vision.byAssetId[c])?void 0:s[ld.ObjectTrackingV2]),u||(u=await hN(c,ld.ObjectTrackingV2,"success"));const m=(null==o?void 0:o.languageCode)&&u&&dd(u)&&(null==(n=null==u?void 0:u.job_params)?void 0:n.languageCode)!==o.languageCode,p=u&&dd(u)&&1!==(null==(r=u.job_params)?void 0:r.version),h=m||p;if("success"===(null==u?void 0:u.status)&&!h)return d(eN({assetId:c,visionJob:u})),u;if(!l.studio._id)throw new Error("No studio id found. Please login to use Speaker Focus.");const g=await(async(e,t,o,a)=>gN(e,t,o,a))(c,ld.ObjectTrackingV2,t,(null==o?void 0:o.languageCode)?{assetId:c,assetDuration:e.duration,languageCode:o.languageCode,languageKey:o.languageCode,translateCode:void 0,requestingFeature:"speaker-focus",timelineLayer:e,videoId:l.studio._id,speakerLabels:!0,existingVisionJobId:null==u?void 0:u._id,version:1}:void 0);return g?(d(eN({assetId:c,visionJob:g})),g):null},TN=async(e,t)=>{const o=Date.now();let a=!0;const{videoLayers:i,imageLayers:s}=Wj(),n=new Set,r=i.filter((e=>{const t=e.asset_id;return!!t&&(!n.has(t)&&(n.add(t),!0))})),l=new Set,d=s.filter((e=>{const t=e.asset_id;return!!t&&(!l.has(t)&&(l.add(t),!0))}));try{const o=r.map((o=>bN(o,e,t))),a=d.map((e=>(async e=>{const{state:t,dispatch:o}=sr(),a=e.asset_id;if(!a)return null;if(t.vision.byAssetId[a])return t.vision.byAssetId[a];const i=await yN(e),{box:s}=Oj(i);if(!s)return null;const n={_id:oe.v4(),asset_id:a,created:(new Date).toISOString(),job_type:ld.ImageObjectDetection,result:s?{0:{[s.name]:s}}:{},status:"success",startedAt:(new Date).toISOString()};return o(eN({assetId:a,visionJob:n})),n})(e)));await Promise.all([...o,...a])}catch(IGe){a=!1,mh({description:"Something went wrong while running Speaker Focus",error:IGe})}const c=Date.now();Fm(ym.RUN_VISION_JOBS_FOR_ALL_LAYERS_RESULT,{duration:c-o,imageAssetIds:l.size,videoAssetIds:n.size,cancelled:e.cancelled,withTranscription:!!(null==t?void 0:t.languageCode),success:a})},xN=({boundingBoxes:e,layer:t,fillAndCropPosition:o,fitToCenterPosition:a})=>{const i=e[0];if(!i)return;const{box:s}=Oj(i);if(!s){if(a){return{position:{...t.position,...a}}}return{}}const n={crop:{x:100*s.x1,y:100*s.y1,width:100*(s.x2-s.x1),height:100*(s.y2-s.y1)}};return o&&(n.position={...t.position,...o}),n},SN=()=>{const{dispatch:e}=sr();e(dS(!1,void 0,void 0))};function EN(e,t,o,a){const i=(o.width-t.width)/t.width,s=(o.height-t.height)/t.height;let n=e.xPct*t.width/o.width,r=e.yPct*t.height/o.height;const l=e.widthPct/(1+i),d=e.heightPct/(1+s);if(a.left){const a=t.width-e.xPct/100*t.width;n=100*(o.width-a)/o.width}if(a.top){const a=t.height-e.yPct/100*t.height;r=100*(o.height-a)/o.height}return{xPct:n,yPct:r,widthPct:l,heightPct:d}}const IN=ff.withUndoBatch(((e,t,o)=>{const{dispatch:a,state:i}=sr(),{scenes:s,hasCustomOutput:n}=i.studio,r=i.studio.width,l=i.studio.height,d=(e-r)/r,c=(t-l)/l,u={};for(const w of s)for(const a of w.layers){const i=a.position,s=parseFloat(i.x),n=parseFloat(i.y),d=parseFloat(i.width),c=EN({heightPct:parseFloat(i.height),widthPct:d,xPct:s,yPct:n},{height:l,width:r},{height:t,width:e},o);u[a.id]={position:{...a.position,x:`${c.xPct}%`,y:`${c.yPct}%`,width:`${c.widthPct}%`,height:`${c.heightPct}%`}}}OI(u,"canvas.ts",!0);for(const w of Object.keys(i.studio.magicSubtitles||{})){const s=IA(w)(i);if(!s.position)continue;const n=EN(s.position,{height:l,width:r},{height:t,width:e},o);a(bC({assetId:w,updates:{position:{...s.position,...n}}}))}const m=i.studio.customOutputWidth,p=i.studio.customOutputHeight,h=(e,t)=>0===t?e:h(t,e<t?e%t:t%e),g=h(e,t),f=t/g,y=e=>{const t=e.toString().substring(0,4);return["1.76","1.77","1.78"].includes(t)?"1.7":UE(e,2)},v=`${y(e/g)}:${y(f)}`,_={"1:1":"1:1","1:1.7":"9:16","1.7:1":"16:9","1.25:1":"5:4","1:1.25":"4:5"}[v]||v;if(n){let o=Math.min(d*m+m,3840),i=Math.min(c*p+p,3840);if(3840===o&&3840===i)SN(),a(lS(_,!0));else{if(3840===o&&i<3840){i-=e/t/100*i}if(3840===i&&o<3840){o-=t/e/100*o}CN(o,i),a(lS(`${o}:${i}`,!0))}}else a(lS(_,!0))})),CN=(e,t)=>{const{dispatch:o}=sr();o(dS(!0,Number(e),Number(t),!0))},kN=()=>{const{state:e}=sr(),{customOutputWidth:t}=e.studio,{customOutputHeight:o}=e.studio;(t>3840||o>3840)&&SN()},AN=ff.withUndoBatch((()=>{const{dispatch:e,state:t}=sr(),{ratio:o}=t.studio,a=t.studio.scenes[0];if(!a)return[];const{layers:i}=a,{hasCustomOutput:s}=t.studio,n=t.studio.customOutputWidth,r=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:d}=bj(o),c=Ej(i),u=c.right-c.left,m=c.bottom-c.top,p=u*n/100,h=m*r/100;e(lS(`${u*l}:${m*d}`,!0)),s&&CN(p,h);const g=[];for(const f of i){const e=f.position,t={position:{...e,x:100*(parseFloat(e.x)-c.left)/u+"%",y:100*(parseFloat(e.y)-c.top)/m+"%",width:100*parseFloat(e.width)/u+"%",height:100*parseFloat(e.height)/m+"%"}},o={...f,...t};g.push(o)}return e(Yv(g,0,!0)),g})),jN=ff.withUndoBatch((()=>{const{dispatch:e,state:t}=sr(),{ratio:o}=t.studio,a=t.studio.scenes[0];if(!a)return;const{layers:i}=a,{hasCustomOutput:s}=t.studio,n=t.studio.customOutputWidth,r=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:d}=bj(o),c=1.1*d;if(c/l>=100)return;if(e(lS(`${l}:${c}`,!0)),s){const e=Math.min(1.1*r,3840);if(3840===e){const t=(e-r)/r;CN(0===t?.9*n:n-n*t,e)}else CN(n,e)}const u=[];for(const m of i){const e=m.position,t={position:{...e,y:parseFloat(e.y)/1.1+"%",height:parseFloat(e.height)/1.1+"%"}},o={...m,...t};u.push(o)}e(Yv(u,0,!0))})),NN=ff.withUndoBatch((()=>{const{dispatch:e,state:t}=sr(),{ratio:o}=t.studio,a=t.studio.scenes[0];if(!a)return;const{layers:i}=a,{hasCustomOutput:s}=t.studio,n=t.studio.customOutputWidth,r=t.studio.customOutputHeight,l=t.studio.height,{ratioWidth:d,ratioHeight:c}=bj(o);if(1.1*c/d>=100)return;if(e(lS(`${d}:${1.1*c}`,!0)),s){const e=Math.min(1.1*r,3840);if(3840===e){const t=(e-r)/r;CN(0===t?.9*n:n-n*t,e)}else CN(n,e)}const u=[];for(const m of i){const e=m.position,t=1.1*l,o=100*(t-(l-parseFloat(e.y)/100*l))/t,a=parseFloat(e.height)/1.1,i={position:{...e,y:`${o}%`,height:`${a}%`}},s={...m,...i};u.push(s)}e(Yv(u,0,!0))})),RN=ff.withUndoBatch((()=>{const{dispatch:e,state:t}=sr(),{ratio:o}=t.studio,a=t.studio.scenes[0];if(!a)return;const{layers:i}=a,{hasCustomOutput:s}=t.studio,n=t.studio.customOutputWidth,r=t.studio.customOutputHeight,l=t.studio.width,{ratioWidth:d,ratioHeight:c}=bj(o),u=1.1*d;if(u/c>=100)return;e(lS(`${u}:${c}`,!0));let m=!1;if(s){const e=Math.min(1.1*n,3840);if(3840===e){m=!0;const t=(e-n)/n;CN(e,0===t?.9*r:r-r*t)}else CN(e,r)}const p=[];for(const h of i){const e=h.position,t=parseFloat(e.x),o=parseFloat(e.width),a=1.1*l,i=100*(a-(l-t/100*l))/a,s=m?o:o/1.1,n={position:{...e,x:`${i}%`,width:`${s}%`}},r={...h,...n};p.push(r)}e(Yv(p,0,!0))})),PN=ff.withUndoBatch((()=>{const{dispatch:e,state:t}=sr(),{ratio:o}=t.studio,a=t.studio.scenes[0];if(!a)return;const{layers:i}=a,{hasCustomOutput:s}=t.studio,n=t.studio.customOutputWidth,r=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:d}=bj(o),c=1.1*l;if(c/d>=100)return;let u=!1;if(s){const e=Math.min(1.1*n,3840);if(3840===e){u=!0;const t=(e-n)/n;CN(e,0===t?.9*r:r-r*t)}else CN(e,r)}const m=[];for(const p of i){const e=p.position,t=parseFloat(e.width),o=u?t:t/1.1,a={position:{...e,x:parseFloat(e.x)/1.1+"%",width:`${o}%`}},i={...p,...a};m.push(i)}e(lS(`${c}:${d}`,!0)),e(Yv(m,0,!0))})),DN=(e,t,o)=>{switch(e.job_type){case ld.ObjectTrackingV2:if(e.job_result&&"error"!==e.status)return _N({boundingBoxes:e.job_result.result,splitTimes:[...e.job_result.transcript_speaker_switch_timestamps,...e.job_result.scene_split_timestamps],sourceLayer:t,fillAndCropPosition:o.fillAndCropPosition,fitToCenterPosition:o.fitToCenterPosition});throw new Error("Error processing video. Please try again.");case ld.ObjectTracking:case ld.ImageObjectDetection:default:throw new Error("Vision job type not supported.")}};function ON({aspectRatioHeight:e,aspectRatioWidth:t,resizeMethod:o,layers:a,prevCanvasHeight:i,prevCanvasWidth:s,shouldSmartReframe:n,visionJobByAssetId:r}){let l=!1,d=!1;const c={},u=[];for(const m of a){if(!qj(m))continue;const a=Qj({layer:m,newRatio:{width:t,height:e},prevRatio:{width:s,height:i},resizeMethod:o});if(c[m.id]={position:a},n&&m.asset_id){const o=Qj({layer:m,newRatio:{width:t,height:e},prevRatio:{width:s,height:i},resizeMethod:"fit"}),n=a;if(Ql(m)){const e=r[m.asset_id],t=null==e?void 0:e[ld.ObjectTrackingV2];if(t)try{const e=DN(t,m,{fitToCenterPosition:o,fillAndCropPosition:n});if(Object.keys(e.layerUpdates).length>0&&(c[m.id]=e.layerUpdates,l=!0),e.layersToAdd.length>0){const t=Bj(m);u.push({layerIndex:t,layersToAdd:e.layersToAdd})}d=!0}catch(IGe){console.error(IGe),hh({description:"Error finding speakers. Please try again."})}}else if(Xl(m)){const e=r[m.asset_id],t=null==e?void 0:e[ld.ImageObjectDetection];if(t&&"image_object_detection"===t.job_type){const e=xN({boundingBoxes:t.result,layer:m,fillAndCropPosition:n,fitToCenterPosition:o});e&&Object.keys(e).length>0&&(c[m.id]=e,l=!0)}}}}return{didSmartReframe:l,resizeLayerUpdates:c,resizeLayersToAdd:u,showSmartReframeToast:d}}function LN({currentFontSize:e,newRatio:t,prevRatio:o}){const a=o.width/o.height;let i=t.width/t.height/a-1;i/=2;const s=1+i;return Math.max(1,Math.round(e/s))}const FN=({aspectRatioWidth:e,aspectRatioHeight:t,resizeMethod:o,resizeCanvasBlur:a,backgroundColorChanged:i,resizeOptionName:s,shouldSmartReframe:n})=>{const{state:r,dispatch:l}=sr(),{scenes:d,width:c,height:u}=r.studio,m=d[0];if(!m)return;const{layers:p}=m,h=c,g=u;if(!h||!g)return;CN(e,t),UN({ratioWidth:e,ratioHeight:t,undoable:!0,sendAmplitudeEvent:!0,newSizeSelected:s||void 0,fitOrFill:"fill"===o?"Fill and Crop":"Fit to Center",smartReframe:n,canvasBlur:a,backgroundColorChanged:i});const{didSmartReframe:f,resizeLayerUpdates:y,resizeLayersToAdd:v,showSmartReframeToast:_}=ON({aspectRatioHeight:t,aspectRatioWidth:e,resizeMethod:o,layers:p,prevCanvasHeight:g,prevCanvasWidth:h,shouldSmartReframe:n,visionJobByAssetId:r.vision.byAssetId});f&&l(Tp({usedSmartReframe:!0})),Object.keys(y).length>0&&OI(y,"resizeCanvas",!0),v.forEach((({layerIndex:e,layersToAdd:t})=>{l(Fv({layers:t,isUndoable:!0,layerIndex:e}))})),_&&l(wl({description:"Want to adjust the speaker position? Double click the video to adjust the positioning",type:"info"}));for(const w of Object.keys(r.studio.magicSubtitles||{})){const o=IA(w)(r);if(o.style){const a={style:{...o.style,fontSize:LN({currentFontSize:o.style.fontSize,newRatio:{width:e,height:t},prevRatio:{width:h,height:g}})}};l(bC({assetId:w,updates:a}))}}"fill"===o&&SN()},MN=(e,t,o,a)=>e/t==o/a,UN=({ratioWidth:e,ratioHeight:t,undoable:o=!1,sendAmplitudeEvent:a=!1,newSizeSelected:i,fitOrFill:s,canvasBlur:n,backgroundColorChanged:r,smartReframe:l})=>{const{dispatch:d,state:c}=sr(),u=c.studio.ratio,m=`${e}:${t}`;d(lS(m,o));const p=c.studio.scenes[0];if(p){if(a){const e=new Set;for(const i of p.layers){const t=Tu(i,c.mediaCache);i.type===zl.Video&&t&&e.add(t)}const t={};for(const i of p.layers)if("number"==typeof i.timelineRow){const e=`${p.id}_${i.timelineRow}`;t[e]=(t[e]||0)+1}const o=bE();let a=p.layers;p.duration>0&&(a=a.filter((e=>{const t=TS(e,0);return o>=t[0]&&o<t[1]}))),d(Tp({usedCanvasResize:!0})),Fm(ym.CANVAS_RESIZE,i&&s&&void 0!==n&&void 0!==r?{"Previous Aspect Ratio":u,"New Aspect Ratio":m,"New Size Selected":i,"Fit or Fill":s,"Smart Reframe":l,"Canvas Blur Applied":n,"Background Color Changed":r,"Number of Video Splits":xu(c.studio),"Number of Layers":p.layers.length,"Number of Layers Shown in Preview":a.length,"Number of Tracks Used":Object.keys(t).length,"Number of Video Input Files":e.size}:{"Previous Aspect Ratio":u,"New Aspect Ratio":m,"Number of Video Splits":xu(c.studio),"Number of Layers":p.layers.length,"Number of Layers Shown in Preview":a.length,"Number of Tracks Used":Object.keys(t).length,"Number of Video Input Files":e.size})}"Scenes"===Ij()&&BN(m,{x:0,y:0,width:c.studio.containerWidth||1500,height:c.studio.containerHeight||1500},!1)}},BN=(e,t,o)=>{const{dispatch:a}=sr(),i=Tj(e,t,o);a({type:"SET_STUDIO_DIMENSIONS",dimensions:i}),a({canvasDimensions:(e=>{const{canvasWidth:t,canvasHeight:o,maxHeight:a=350}=e;let i=320,s=i*o/t;const n=zg()?Math.min(a,300):a;return n&&n<=s&&(s=n,i=t*n/o),{canvasWidth:i,canvasHeight:s}})({canvasWidth:i.width,canvasHeight:i.height}),type:"SET_CANVAS_DIMENSIONS"})},VN=e=>{const{dispatch:t}=sr();t(Xv(e))},WN=()=>{const{state:e}=sr();return e.studio.snapToGrid&&!e.studioLocal.commandIsBeingPressed&&!e.studioLocal.controlIsBeingPressed},GN=e=>{const t=["/studio/editor/scenes","/studio/editor/scenes/duration","/studio/editor/scenes/drag-upload","/studio/edtior/scenes/output-resize",/\/studio\/editor\/export-as-image.*/,"/studio/editor/audio",/\/studio\/editor\/subtitle-overlay(.*)/,"/studio/editor/trimmer","/studio/editor/animate","/studio/editor/adjust","/studio/editor/volume-adjust","/studio/editor/animate/colors","/studio/editor/animate/animation-background-color","/studio/editor/remove-background"];let o=!1;for(let a=0;a<t.length;a+=1){const i=t[a];if("string"==typeof i){if(QS(e)===i){o=!0;break}}else if(i instanceof RegExp&&i.test(e)){o=!0;break}}return!o},HN=()=>{const e=sr().state.studio.scenes[0];if(!e)throw Error();return e};function $N(e){const{state:t}=sr(),{scenes:o}=t.studio;for(const a of o){const{duration:o}=YN(a,lT(t.studio));KN(a,o,e)}}function KN(e,t,o){const a=t>0,i={};for(const s of e.layers)oC(s)&&(null==s.endTime&&a||null==s.startTime&&a||s.isTrimmed!==a)&&(s.pluginSource?i[s.id]={startTime:t,endTime:t+3,isTrimmed:a}:i[s.id]={startTime:0,endTime:t,isTrimmed:a});OI(i,"updateStaticLayerDurationToSceneDuration",o)}const zN=m((e=>e.studio.scenes[0]),(e=>lT(e.studio)),((e,t)=>YN(e,t).duration)),YN=(e=HN(),t)=>uC(e,t),JN=ff.withUndoBatch((({scene:e,newDuration:t,userSetDuration:o,hasCustomOutput:a,isImageVideo:i})=>{var s;const{state:n,dispatch:r}=sr(),{videoTypeSetting:l}=n.studio;t&&KN(e,t,!0),(null==(s=e.layers)?void 0:s.length)&&t||(r(vC(t,!0)),r(yC(i))),r(yb(e,{userSelectedDuration:t,userSetDuration:o,duration:t},!0)),(!l||l&&"gif"!==l)&&r(bb(Kn.MP4)),a&&kN()})),qN=(e=!0)=>{const{state:t}=sr(),{hasCustomOutput:o}=t.studio,a=((e=!1)=>{const{state:t}=sr();let{duration:o}=t.studio;o=o||0;const a=o.toString();if(a.match(/^(\d*\.*\d+|\.\d)$/))return parseFloat(a);if(a.match(/^(\d+):(\d+)$/)){const e=a.match(/^(\d+):(\d+)$/);if(e&&parseInt(e[2]??"",10)<60)return 60*Number(e[1])+parseInt(e[2]??"",10)}return-1})(),i=t.studio.scenes[0];i&&JN({scene:i,newDuration:a,userSetDuration:e,hasCustomOutput:o,isImageVideo:!1})},XN=m((e=>{var t;return!!(null==(t=e.elementPool.byElementPoolId[oS.studio])?void 0:t.paused)}),(e=>e)),QN=(e,t)=>{var o;return!!(null==(o=e.elementPool.byElementPoolId[t])?void 0:o.paused)};function ZN(){const{state:e}=sr(),t=e.studio.scenes[0];if(!t)return;const o=t.duration;bE()>o&&aR(o)}function eR(){const{dispatch:e}=sr();e(aS.actions.togglePaused({}))}function tR(){const{state:e}=sr();XN(e)||eR()}function oR(){const{state:e}=sr();XN(e)&&eR()}function aR(e,t=null){const o=(null==t?void 0:t.id)||oS.studio,{state:a}=sr();QN(a,o)?rR({elementPoolId:o,time:e}):t?t.setEPTime(e):TE(e)}const iR=e=>{const{state:t,dispatch:o}=sr(),a=t.studio.scenes[0];if(!a)return;const{start:i}=cm(e,a.duration),s=i;aR(s),setTimeout((()=>{o(sS())}),20),o(nS({time:s}))},sR=e=>{const{state:t}=sr(),{scenes:o}=t.studio,a=o[0],i=YN(a,lT(t.studio)).duration,s=bE(),[n,r]=TS(e),l=n<=s&&s<=r,d=wS(i)<=s&&ME(r,i,.03333333333333333);return l||d},nR=()=>{const{state:e,dispatch:t}=sr();t(L_(!e.studioLocal.previewPlaying))},rR=({elementPoolId:e=oS.studio,time:t})=>{const{dispatch:o}=sr();g.batch((()=>{"number"!=typeof t?o(nS({elementPoolId:e,time:bE()})):(o(nS({elementPoolId:e,time:t})),TE(t))}))},lR=e=>{var t;const o=gk(e),{selectedItem:a}=e.studio;return o.length<=1||(null==(t=o[0])?void 0:t.id)===(null==a?void 0:a.id)},dR=e=>{var t;const o=gk(e),{selectedItem:a}=e.studio,i=o[o.length-1];return o.length<=1||(null==(t=o[o.length-1])?void 0:t.id)===(null==a?void 0:a.id)||(null==i?void 0:i.id)===(null==a?void 0:a.id)};let cR=Number.MAX_SAFE_INTEGER,uR=Number.MIN_SAFE_INTEGER,mR=0;const pR=m(gk,(e=>e.studioLocal.draggedTracksOverrides),(e=>zN(e)>0),(e=>e.studio.groups),((e,t)=>cR<=t&&t<uR?mR:(mR=t,t)),((e,t,o,a,i)=>{const s=new Map,n=new Map;for(const[u,m]of Object.entries(a)){n.set(u,!1);for(const{id:e}of m.layers)s.has(e)?s.get(e).push(u):s.set(e,[u])}const r=e.map((e=>iC(e,null==t?void 0:t[e.id]))),l=[],d=[];for(const u of r){const[e,t]=TS(u);e<=i&&l.push(e),e>=i&&d.push(e),t<=i&&l.push(t),t>=i&&d.push(t)}cR=Math.max(...l),uR=Math.min(...d);const c=[];for(const u of r)if(!u.isHidden){if(s.has(u.id))for(const e of s.get(u.id))n.get(e)||(n.set(e,!0),c.push(`group_${e}`));o?(Zu(u)||em(u)||tm(u)||om(u)||sR(u)||(null==t?void 0:t[u.id]))&&c.push(u.id):c.push(u.id)}return c})),hR=m((e=>e.studio.allLayers.byId),(e=>{var t;return(null==(t=e.studio.selectedItem)?void 0:t.id)??""}),((e,t)=>e[t])),gR=m((e=>e.studio.selectedItem),(e=>e.studio.groups),(e=>{var t;return null==(t=e.studio.allLayers)?void 0:t.byId}),((e,t,o)=>{if(!e)return[];if("group"===e.type){const a=t[e.id];return a?a.layers.map((e=>o[e.id])).filter(Ir):[]}if("layer"===e.type){const t=o[e.id];return t?[t]:[]}return[]})),fR=(e,t,o,a)=>{var i;const{state:s}=sr(),n=s.studio.allLayers.byId[e];if(!n)return;const r=(null==(i=s.studioLocal.layerTempValues[n.id])?void 0:i.inlineCropAspectRatio)||null;ff.withUndoBatch((()=>{ff.add({undo:u_(n.id,{inlineCropAspectRatio:a}),redo:u_(n.id,{inlineCropAspectRatio:r})}),ff.add({undo:Jv({[n.id]:{crop:t,position:o}},"commitUndoInlineCropHistory/undo"),redo:Jv({[n.id]:{crop:n.crop,position:n.position}},"commitUndoInlineCropHistory/redo")})}))()},yR=(e=null)=>{var t,o,a;const{state:i}=sr(),s=gR(i)[0],n=e||s,r=null==(t=i.studioLocal.layerTempValues[n.id])?void 0:t.crop,l=n.width,d=n.height;return+(((null==r?void 0:r.width)??(null==(o=n.crop)?void 0:o.width)??100)*l/100/(((null==r?void 0:r.height)??(null==(a=n.crop)?void 0:a.height)??100)*d/100)).toFixed(2)},vR=e=>{const{state:t}=sr(),o=gR(t)[0];if(!e||!o)return;const a=LI(o);if(!a)return;const{width:i,height:s}=a,n=o.width||i,r=o.height||s;if(yR(o)===e)return;let l,d;const c=e>1||1===e&&n<=r;c?(l=n,d=l/e):(d=r,l=d*e),l>n&&!c&&(l=n,d=l/e),d>r&&c&&(d=r,l=d*e);const u=d/r*100,m=l/n*100;let p=0,h=0;if(u<100){h=(r-d)/2}if(m<100){p=(n-l)/2}const g={x:p/n*100,y:h/r*100,height:u,width:m};LE(o.id,{crop:g}),_R()},_R=(e=!1)=>{var t,o,a;const{state:i}=sr(),s=gR(i)[0];if(!s)return;const n=null==(t=i.studioLocal.layerTempValues[s.id])?void 0:t.crop,r=null==(o=i.studioLocal.layerTempValues[s.id])?void 0:o.positionTemp,l=i.studio.width||100,d=i.studio.height||100,c=r||s.position,u=n;if(!u||!c)return;const{crop:m}=s,{height:p,width:h,x:g,y:f}=m||{height:100,width:100,x:0,y:0},y=LI(s);if(!y)return;const{height:v,width:_}=y,w=u.height/p,b=p-u.height,T=u.width/h,x=u.width-h,S=_/l,E=v/d,I=_*h/200+g*_/100-l/2,C=v*p/200+f/100*v-d/2,k={x:_*u.width/200+_*u.x/100-l/2-I,y:v*u.height/200+v*u.y/100-d/2-C},{x:A,y:j}=k,[N,R]=((e,t)=>{const{state:o}=sr(),a=gR(o)[0];if(!a)return[e,t];const i=QE(a);if(!i)return[e,t];const{rotation:s=0}=i,n=(s+90)*Math.PI/180,r=e*Math.cos(n)-t*Math.sin(n);return[-(e*Math.sin(n)+t*Math.cos(n)),r]})(A,j),P=parseFloat(c.x),D=parseFloat(c.y),O={crop:u},L={...c};L.height=parseFloat(c.height)*w+"%",L.width=parseFloat(c.width)*T+"%",L.x=P-100*N/l-x*S/2+"%",L.y=D-100*R/d+b*E/2+"%",O.position=L,(null==(a=s.keyframeAnimation)?void 0:a.id)===lI.id&&(s.keyframeAnimation=null),OI({[s.id]:O},"utils.ts",e),LE(s.id,{crop:void 0,positionTemp:null})},wR=ff.withUndoBatch(((e,t)=>{var o,a;const i=!0,{dispatch:s,state:n}=sr(),r=t.type;if("none"===r)return;const l=fT(e,n.studio);if(!l)return;const d=P(),c={...l.animation,[r]:[d]},u=jR([l]);if(!u)return;const m=Math.min(t.transitionDuration||(null==(o=$T[t.id])?void 0:o.duration)||.5,u),p={animationName:t.id,id:d,layerId:l.id,isCrossTransition:!1,transitionDuration:m};((null==(a=l.animation)?void 0:a[r])||[]).forEach((e=>s(Ov(e,i)))),s(Pv(p,i));const h={animation:c};"constant"===r&&(h.keyframeAnimation=null),OI({[l.id]:h},"animation.ts",i)})),bR=ff.withUndoBatch(((e,t)=>{var o;const{dispatch:a,state:i}=sr(),s=fT(e,i.studio);if(!s)return;const n={...s.animation,[t]:[]};OI({[s.id]:{animation:n}},"animation.ts",true);((null==(o=s.animation)?void 0:o[t])||[]).forEach((e=>a(Ov(e,true))))}));function TR(e){return m((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),((t=[])=>{var o;const a={};for(const i of t){const t=null==(o=i.animation)?void 0:o[e];if(t)for(const e of t)a[e]=i}return a}))}const xR=TR("intro"),SR=TR("outro"),ER=ff.withUndoBatch(((e,t,o)=>{const{dispatch:a,state:i}=sr(),s=!0;let n,r;if(o||t?(n=t,r=o):(n=SR(i)[e],r=xR(i)[e]),n){const{animation:t}=n;if(!t)return;const o={...t};o.outro=(o.outro||[]).filter((t=>t!==e)),OI({[n.id]:{animation:o}},"animation.ts",s)}if(r){const{animation:t}=r;if(!t)return;const o={...t};o.intro=(o.intro||[]).filter((t=>t!==e)),OI({[r.id]:{animation:o}},"animation.ts",s)}if(n&&r){const e=Ux(r,"intro");CR({introLayer:r,newAnimation:null,oldAnimation:e})}a(Ov(e,s))})),IR=()=>{sr().dispatch(qv(null))},CR=({introLayer:e,oldAnimation:t,newAnimation:o})=>{const a=kR({introLayer:e,oldAnimation:t,newAnimation:o});a&&OI(a,"animation.ts",!0)},kR=({introLayer:e,oldAnimation:t,newAnimation:o,studioState:a=sr().state.studio})=>{const i=a.scenes[0];if(!i)return;const{layers:s}=i,n=VS(s,e),r=(t&&0!==t.duration?ex(t,a.animations):0)-(o?ex(o,a.animations):0);if(!r)return;const{start:l}=cm(e),d={};return n.forEach((e=>{const{start:t}=cm(e);if(!(t>=l))return;const o=oC(e)?{startTime:(e.startTime||0)+r,endTime:(e.endTime||0)+r}:{videoDelay:(e.videoDelay||0)+r};d[e.id]=o})),d},AR=ff.withUndoBatch(((e,t,o)=>{const{state:a,dispatch:i}=sr(),s=fT(e,a.studio);if(!s)return void console.error("Could not find layer to add cross transition to");const n=Bx(s),r="intro"===t?n.introTransition:n.outroTransition;if((null==r?void 0:r.transitionId)===o.id)return;const{introAnimation:l,outroAnimation:d}=Vx(o),c="intro"===t?l:d;let u,m;if(r){let e;e=s.id===r.introLayerId?fT(r.outroLayerId,a.studio):fT(r.introLayerId,a.studio),e&&([u,m]="intro"===t?[s,e]:[e,s])}if(!u||!m){const e=a.studio.scenes[0];if(!e)return;const{layers:o}=e,i=e.duration,{nextLayer:n,prevLayer:r}=FR(s,o,i);[u,m]="intro"===t?[s,r]:[n,s]}if(!u||!m)return;if(u.keyframeAnimation||m.keyframeAnimation)return void i(wl({type:"error",description:"Transitions are incompatible with elements that have the Moving Zoom effect already applied."}));const p=KT[o.id],h=jR([u,m]);if(!h)return;const g=Math.min($T[null==p?void 0:p.intro].duration||.5,h),f=Math.min($T[null==p?void 0:p.outro].duration||.5,h);l.transitionDuration=g,d.transitionDuration=f,CR({introLayer:u,newAnimation:c,oldAnimation:r}),(({introLayer:e,outroLayer:t,newAnimation:o,newTransitionId:a,undoable:i=!0})=>{var s,n;const{dispatch:r}=sr(),l=P(),d=[...(null==(s=e.animation)?void 0:s.intro)||[],...(null==(n=t.animation)?void 0:n.outro)||[]];OI({[e.id]:{animation:{...e.animation,intro:[l]}},[t.id]:{animation:{...t.animation,outro:[l]}}},"animation.ts",i),r(Pv({id:l,animationName:a,isCrossTransition:!0,introLayerId:e.id,outroLayerId:t.id,transitionDuration:o.transitionDuration||.5},i));for(const c of d)r(Ov(c,i))})({introLayer:u,outroLayer:m,newAnimation:c,newTransitionId:o.id})})),jR=e=>{const t=(o=e.reduce(((e,t)=>{if(!t)return e;const{start:o,end:a}=cm(t),i=a-o;return Math.min(e,i)}),8)/2,Math.round(10*o)/10);var o;return t<.1?null:t},NR=ff.withUndoBatch(((e,t)=>{const{dispatch:o}=sr();o(Dv(e,{transitionDuration:t}))})),RR=ff.withUndoBatch(((e,t)=>{const{dispatch:o,state:a}=sr(),i=Rx(e);if(!i)return void console.error("Could not find animation to change transition duration on");if(!i.isCrossTransition)return void console.error("Cannot change transition duration on non transition");const s=fT(i.introLayerId,a.studio);if(!s)return void console.error("Could not find intro layer for transition");const n=vx(i.animationName),{introAnimation:r}=Vx(n),l={...r,transitionDuration:i.transitionDuration},d={...r,transitionDuration:t};CR({introLayer:s,newAnimation:d,oldAnimation:l}),o(Dv(e,{transitionDuration:t}))})),PR=ff.withUndoBatch(((e,t,o)=>{const{dispatch:a}=sr(),i=e.animation,s=null==i?void 0:i[t];if(!s)return;const n=s[0];n&&a(Dv(n,{animationName:o}))})),DR=ff.withUndoBatch(((e,t)=>{const{dispatch:o,state:a}=sr(),i=a.studio.scenes[0];if(!i)return;const s=fT(e,a.studio);if(!s)return void console.error("Could not find layer to add cross transition to");const{duration:n}=i,r=Ux(s,"constant",a.studio.animations);r&&(r.transitionId?r.animationStateMapId&&ER(r.animationStateMapId):bR(s.id,"constant"));const l={},d={...t.transitions[0]};if(oC(s)&&!n)l.isTrimmed=!0,l.startTime=0,l.endTime=5,d.startTime=0,d.duration=5;else{const{start:e,end:t}=cm(s),o=t-e;d.startTime=e,d.duration=o}l.keyframeAnimation={...t,transitions:[d]},lI.id===t.id&&(LE(s.id,{crop:{x:0,y:0,width:100,height:100},positionTemp:null}),_R()),OI({[s.id]:l},"animation.ts");const c=HN(),{duration:u}=YN(c,lT(a.studio));KN(c,u,!0),iR(s),o(mS(!0))})),OR=e=>{const{dispatch:t,state:o}=sr(),a=o.studio.scenes[0];if(!a)return;const i=a.duration,s=[];if(e.forEach((e=>{const t=fT(e,o.studio);if(!t)return;const a=Mx(t),{start:n,end:r}=cm(t,i);a.forEach((e=>{if(e.id!==Yl.None)if("intro"===e.type||"constant"===e.type)s.push(n);else if("outro"===e.type){const t=ex(e,o.studio.animations);s.push(r-t)}})),t.keyframeAnimation&&s.push(n)})),0===s.length)return;s.sort(((e,t)=>e-t));const n=s[0];rR({time:n}),t(sS())},LR=(e,t)=>{const{dispatch:o,state:a}=sr(),i=a.studio.scenes[0];if(!i)return;const s=i.duration,n=fT(e,a.studio);if(!n)return;let r;const{start:l,end:d}=cm(n,s);if("intro"===t||"constant"===t)r=l;else{const e=Ux(n,t);r=d-(e?ex(e,a.studio.animations):.5)}aR(r),o(sS())},FR=(e,t,o)=>{if(!e)return{};let{start:a,end:i}=cm(e,o);const{introTransition:s,outroTransition:n}=Bx(e),r=null==s?void 0:s.introLayerId,l=null==n?void 0:n.outroLayerId;let d,c;const u=VS(t,e);for(const m of u){let{start:e,end:t}=cm(m,o);a=parseFloat(a.toFixed(2)),i=parseFloat(i.toFixed(2)),e=parseFloat(e.toFixed(2)),t=parseFloat(t.toFixed(2));const s=wx.includes(m.type);if((s&&e===i||l===m.id)&&(c=m,d))break;if((s&&t===a||r===m.id)&&(d=m,c))break}return{prevLayer:d,nextLayer:c}};function MR(e,t,o){if(!t||!o)return!0;const a=e.studio.scenes[0];if(!a)return!0;const i=a.duration,{start:s,end:n}=cm(t,i),{start:r,end:l}=cm(o,i);return null==t.timelineRow||t.timelineRow!==o.timelineRow||(s>=l||r>=n)}const UR=ff.withUndoBatch((e=>{const{state:t}=sr(),o=t.studio.scenes[0];if(!o)return;const a=e?[e]:o.layers;for(const i of a){const{animation:e}=i;if(e){if(e.intro)for(const o of e.intro){const e=Rx(o,t.studio.animations);if(!e||!e.isCrossTransition)continue;const a=SR(t)[o];MR(t,a,i)&&ER(o,a,i)}if(e.outro)for(const o of e.outro){const e=Rx(o,t.studio.animations);if(!e||!e.isCrossTransition)continue;const a=xR(t)[o];MR(t,i,a)&&ER(o,i,a)}}}})),BR=e=>!!e&&e.id!==Yl.None,VR=(e,t)=>{const o=BR(e),a=BR(t);return o&&a?"both":o?"intro":a?"outro":null},WR=e=>{switch(e){case"both":return["intro","outro"];case"intro":return["intro"];case"outro":return["outro"];default:return[]}},GR=["intro","outro"],HR=ff.withUndoBatch(((e,t)=>{const{state:o,dispatch:a}=sr(),i=o.studio.animations,n=o.studio.scenes[0].layers,r=o.studio.scenes[0].duration;o.studio.duration||(a(vC(10,!0)),qN(),a({type:"SHOW_STUDIO_CANVAS"}));let l=!0;return e.forEach((o=>{if(t.id===Yl.None)return void GR.forEach((e=>{const t=Ux(o,e,i);t&&t.transitionId&&t.animationStateMapId?ER(t.animationStateMapId):bR(o.id,e)}));const a=!(e=>!!e.isCrossTransition)(t);let d=!0;e.forEach((e=>{const{prevLayer:t}=FR(e,n,r);t&&wx.includes(t.type)&&$R(e,t,r)||(d=!1)}));const c=a?["intro"]:[d?"intro":"outro"],u=e.map((e=>{const[t,o]=GR.map((t=>Ux(e,t,i)));return{intro:t,outro:o}})),m=s.uniq(u.reduce(((e,{intro:t,outro:o})=>[...e,VR(t,o)]),[])),p=1===m.length&&m[0]||null,h=WR(p),g=0===h.length?c:h;GR.filter((e=>!g.includes(e))).forEach((e=>bR(o.id,e))),g.forEach((e=>{const s=Ux(o,e,i);if(s&&(l=!1),a){s&&s.transitionId&&s.animationStateMapId&&ER(s.animationStateMapId);const a={...t};return s&&(a.transitionDuration=s.transitionDuration),a.type=e,void wR(o.id,a)}s&&s.id!==Yl.None?s.transitionId?PR(o,e,t.id):(bR(o.id,e),AR(o.id,e,t)):AR(o.id,e,t)}))})),l})),$R=(e,t,o)=>{if(!t)return!1;const{start:a,end:i}=cm(e,o),{start:s,end:n}=cm(t,o);return i-a>=.5&&n-s>=.5},KR=(e,t,o)=>{const a=((e,t,o)=>{let a=t;if(void 0===a){const t=e.layers.length-1;a=null===t?0:t+1}return((e,t,o)=>{e.layers.splice(o,0,t)})(e,o,a),a})(e,t,o),i={...o};delete i.local_url,function(e,t,o,a){Pw({p:[`layer_${t.id}`],oi:t},{srcFn:a}),Pw({p:[`scene_${e.id}_layers`,o],li:t.id},{srcFn:a})}(e,i,a,"insertLayer")};function zR(e,t){var o;e.isUndoable&&ff.add({undo:{type:"REMOVE_LAYERS",layers:e.layers,source:"addLayersUndo",undoable:!1},redo:{...e,isRedo:!0,isUndoable:!1}});const{scenes:a}=t,i=(null==(o=t.scenes[0])?void 0:o.id)||"",s=a[0],n=t._id;let r=!1;e.layers.forEach(((o,a)=>{const i=void 0!==e.layerIndex?e.layerIndex+a:void 0;let l=o;const{deletedLayerDict:d}=t,c=d[o.id];(e.isRedo||e.fromUndo)&&c&&(l=c,delete d[o.id],r=!0),KR(s,i,l),t.allLayers.byId[o.id]=l,l.asset_id&&l.cmlFileId&&bT(t,{asset_id:l.asset_id,cmlFileId:l.cmlFileId});const u=t.scenes.some((e=>e.layers.some((e=>e.cmlFileId===l.cmlFileId&&e.id!==l.id))));n&&l.cmlFileId&&!u&&Gb(l.cmlFileId,n)}));const l=!r||e.isRedo||e.fromUndo,{duration:d}=YN(s,lT(t)),[c,u]=uT(a,i,{duration:d},"scene","handleAddLayersAction");t.scenes=c;const m=_T(c,lT(t));Fw("duration",m,t.duration,"handleAddLayersAction"),t.duration=m,wT(t,m,c),Fw("showCanvas",!0,t.showCanvas,"handleAddLayersAction"),t.showCanvas=l||t.showCanvas,t.updateKey=oe.v4()}function YR(e,t){if(e.undoable){const o=e.layers.map((e=>{const o=t.scenes[0];if(!o)throw Error("No scene");const a=o.layers.findIndex((t=>t.id===e.id));if(-1===a)throw Error("Layer not found");return{layer:e,layerIndex:a}}));ff.add({undo:{type:"ADD_LAYERS_AT_INDEXES",layerIndexPairs:o,isUndo:!0},redo:{type:"REMOVE_LAYERS",layers:e.layers,source:e.source,undoable:!1}})}const o=`removeLayer/${e.source}`,{scenes:a}=t,i=a[0];if(!i)throw Error("Missing scene");const s={...i};e.layers.forEach((a=>{if(!t.allLayers.byId[a.id])throw Error("Layer to delete is missing from state");s.layers=mT(a,s,e.source),a&&t.allLayers.byId[a.id]&&delete t.allLayers.byId[a.id];if(0===s.layers.length){s.isImageVideo=!1,s.duration=0,s.userSelectedDuration=0;const e=`scene_${s.id}`;Mw(e,"isImageVideo",!1,s.isImageVideo,o),Mw(e,"duration",0,s.duration,o)}a.local_url&&(t.deletedLayerLocalBlobDict[a.id]=a.local_url),t.deletedLayerDict={...t.deletedLayerDict,[a.id]:{...a}}}));const n=_T([s],lT(t));s.layers.length<=0&&(Fw("showCanvas",!1,t.showCanvas,o),t.showCanvas=!1,t.width=void 0,t.height=void 0);const r=oe.v4();t.duration=n,t.scenes=[s],t.updateKey=r}function JR(e,t){const{deletedLayerDict:o,deletedLayerLocalBlobDict:a}=t;return F(t,(t=>{if(a[e.layer.id]){const i=o[e.layer.id],s=a[e.layer.id];i&&(i.source="upload",i.url=e.layer.url),s&&e.layer.url&&qR(t,e.layer,s)}const i=function(e,t){const o={};XR.forEach((t=>{t in e&&(o[t]=e[t])}));const a=[];return t.forEach((t=>{t.layers.every(((i,s)=>{if(i.local_url&&i.local_url===e.local_url||i.uploadId&&i.uploadId===e.uploadId){const e={...i,...o};Fw(`layer_${i.id}`,e,i,"modifyUploadedLayer"),t.layers[s]=e,a.push(e)}return!0}))})),a}(e.layer,t.scenes);if(i)for(const o of i){const a={...o,...e.properties};t.allLayers.byId[a.id]=a}const s=t.scenes[0];if(s){const[o,a]=uT(s.layers,e.layer.id,e.properties,"layer","updateUploadedLayer",!e.properties.id);s.layers=o,t.allLayers.byId[e.layer.id]&&(t.allLayers.byId[e.layer.id]={...t.allLayers.byId[e.layer.id],...e.properties})}}))}const qR=(e,t,o)=>{for(const a of e.scenes)for(const i of a.layers)if(i.local_url===o){const o=`layer_${i.id}`;Mw(o,"source","upload",i.source,"updateLayersWithLocalBlob"),i.source="upload",Mw(o,"url",t.url,i.url,"updateLayersWithLocalBlob"),i.url=t.url,e.allLayers.byId[i.id]&&(e.allLayers.byId[i.id].source="upload",e.allLayers.byId[i.id].url=t.url)}},XR=["url","local_url","asset_id","source","ffprobeData","duration","conversion_type","conversion_id","conversion_failed","uploadConfirmed","uploadPending","pastedUrl","cmlFileId","videoConvertedState","lowerQualityPreviewUrl"];function QR(e,t){const{...o}=t.allLayers.byId;if(e.undoable){const t=Object.entries(e.updates).reduce(((e,[t,a])=>{const i=o[t];if(i){const o=Object.keys(a),s={};o.forEach((e=>{s[e]=i[e]})),e[t]=s}return e}),{});ff.add({undo:{type:"UPDATE_LAYERS",updates:t},redo:{...e,undoable:void 0}})}const a=[...t.scenes],i=a[0];let s=null;i&&(s={...i});const n={};i&&i.layers.forEach(((e,t)=>{n[e.id]=t})),Object.entries(e.updates).forEach((([a,i])=>{var r,l;const d=t.deletedLayerDict[a];if(!o[a]&&!d)return;if(d)return void(t.deletedLayerDict={...t.deletedLayerDict,[a]:{...d,...i}});const c={type:"UPDATE_LAYER",layer:o[a],properties:i};if(ET(t,c,a,n,`updateLayer/${e.srcFn}`),s){const[e,o]=uT(s.layers,a,i,"layer","UPDATE_LAYER",!a);s.layers=e,t.allLayers.byId[o.id]=o}let{selectedTimelineRows:u}=t;(null==(r=t.selectedItem)?void 0:r.id)===a&&!(null==(l=o[a])?void 0:l.timelineRow)&&i.timelineRow&&(u=[],u.push(i.timelineRow)),t.selectedTimelineRows=u})),t.duration=_T(a,lT(t)),t.scenes=s?[s]:a,t.updateKey=P()}const ZR=(e,t,o)=>{var a,i;const s=(null==(a=t.animations)?void 0:a.allIds)||[];s.push(e.animationInstance.id),t.animations.allIds=s;const n=(null==(i=t.animations)?void 0:i.byId)||{};if(n[e.animationInstance.id]=e.animationInstance,t.animations.byId=n,e.undoable){const t={type:"DELETE_ANIMATION",animationId:e.animationInstance.id},o={type:"ADD_ANIMATION",animationInstance:e.animationInstance};ff.add({undo:t,redo:o})}Mw("animations","byId",n,o.animations.byId,"ADD_ANIMATION_BY_ID"),Mw("animations","allIds",s,o.animations.allIds,"ADD_ANIMATION_ALL_IDS")},eP=(e,t)=>{var o,a;const i=t.animations.byId[e.animationId];if(!i)return;if(e.undoable){const t={type:"ADD_ANIMATION",animationInstance:i},o={type:"DELETE_ANIMATION",animationId:e.animationId};ff.add({undo:t,redo:o})}const s=(null==(o=t.animations)?void 0:o.allIds)||[],n=s.filter((t=>t!==e.animationId));t.animations.allIds=n;const r=(null==(a=t.animations)?void 0:a.byId)||{};delete r[e.animationId],t.animations.byId=r,Mw("animations","byId",r,t.animations.byId,"DELETE_ANIMATION_BY_ID"),Mw("animations","allIds",s,t.animations.allIds,"DELETE_ANIMATION_ALL_IDS")};function tP(e,t){const o=t.groups[e.groupId],a={saved:!1,rotation:0,layers:[],...o,...e.updates};if(a.layers&&0!==a.layers.length){if(Mw("groups",e.groupId,a,o,"UPDATE_GROUP"),e.undoable){const t={...o},a=Object.keys(e.updates).reduce(((e,o)=>(e[o]=t[o],e)),{});ff.add({undo:{type:"UPDATE_GROUP",groupId:e.groupId,updates:a},redo:{type:"UPDATE_GROUP",groupId:e.groupId,updates:e.updates}})}t.selectedTimelineRows=yT(a,t),t.groups={...t.groups,[e.groupId]:a},t.selectedItem={type:"group",id:e.groupId},t.updateKey=P()}}const oP=(e,t)=>{var o,a,i,s,n,r,l,d,c,m,p,h,g,y,v,_,w,b,T;const x=[...e.scenes];let S=0;switch(t.type){case"ADD_ANIMATION":return F(e,(o=>{ZR(t,o,e)}));case"ADD_GROUP_TO_GROUP":{t.undoable&&ff.add({undo:{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId},redo:{type:"ADD_GROUP_TO_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId}});const o=e.groups[t.srcGroupId],a=e.groups[t.destGroupId];if(!o)throw Error("Missing source group");let i;if(a){const e=[...a.layers,...o.layers.map((e=>({...e,fromMergedGroup:t.srcGroupId,saved:!1})))];i={...a,layers:e,rotation:0,preMergeRotation:a.preMergeRotation||a.rotation}}else{i={layers:[...o.layers.map((e=>({...e,fromMergedGroup:t.srcGroupId,saved:!1})))],saved:!1,rotation:0}}const s=yT(i,e),n={...e.groups,[t.destGroupId]:i,[t.srcGroupId]:{...o,layers:[]}};return Fw("groups",n,e.groups,"ADD_GROUP_TO_GROUP"),{...e,groups:n,selectedTimelineRows:s,updateKey:P()}}case"ADD_LAYER":return e.allLayers.byId[t.layer.id]?(console.error("Refusing to add a layer that exists. Updating the layer instead","\nOld layer: ",e.allLayers.byId[t.layer.id],"\nNew layer: ",t.layer),f("Creating a layer with a duplicate ID",{extra:{oldLayer:e.allLayers.byId[t.layer.id],action:t}}),F(e,(o=>{const a=e.allLayers.byId[t.layer.id];return a?QR({type:"UPDATE_LAYERS",srcFn:"ADD_LAYER",updates:{[a.id]:t.layer},undoable:!1},o):o}))):F(e,(e=>{const{layer:o,undoable:a,isUndo:i,isRedo:s,layerIndex:n}=t;return zR({type:"ADD_LAYERS",layers:[o],isUndoable:a,fromUndo:i,isRedo:s,layerIndex:n},e)}));case"ADD_LAYERS":return F(e,(e=>{zR(t,e)}));case"ADD_LAYERS_AT_INDEXES":return F(e,(e=>{!function(e,t){var o;const{scenes:a}=t,i=(null==(o=t.scenes[0])?void 0:o.id)||"",s=a[0],n=t._id;let r=!1;e.layerIndexPairs.forEach((({layer:o,layerIndex:a})=>{let i=o;const{deletedLayerDict:l}=t,d=l[o.id];(e.isRedo||e.isUndo)&&d&&(i=d,delete l[o.id],r=!0),KR(s,a,i),t.allLayers.byId[o.id]=i,i.asset_id&&i.cmlFileId&&bT(t,{asset_id:i.asset_id,cmlFileId:i.cmlFileId});const c=t.scenes.some((e=>e.layers.some((e=>e.cmlFileId===i.cmlFileId&&e.id!==o.id))));n&&i.cmlFileId&&!c&&Gb(i.cmlFileId,n)}));const l=!r||e.isRedo||e.isUndo,{duration:d}=YN(s,lT(t)),[c,u]=uT(a,i,{duration:d},"scene","handleAddLayersAtIndexesAction");t.scenes=c;const m=_T(c,lT(t));Fw("duration",m,t.duration,"handleAddLayersAtIndexesAction"),t.duration=m,wT(t,m,c),Fw("showCanvas",!0,t.showCanvas,"handleAddLayersAtIndexesAction"),t.showCanvas=l||t.showCanvas,t.updateKey=oe.v4()}(t,e)}));case"ADD_LAYERS_TO_GROUP":{if(!(null==(o=t.layerIds)?void 0:o.length))return e;t.undoable&&ff.add({undo:{type:"REMOVE_LAYERS_FROM_GROUP",layerIds:t.layerIds,groupId:t.groupId,undoable:!1},redo:{type:"ADD_LAYERS_TO_GROUP",layerIds:t.layerIds,groupId:t.groupId,isTimelineGroup:t.isTimelineGroup,undoable:!1}});const a=e.groups[t.groupId];if(!a){const o={layers:t.layerIds.map((e=>({id:e,saved:t.isUndoFromRemoveLayerFromGroup||!1}))),saved:t.isUndoFromRemoveLayerFromGroup||!1,rotation:0,isTimelineGroup:t.isTimelineGroup};Mw("groups",t.groupId,o,a,"ADD_LAYERS_TO_GROUP");const i=yT(o,e);return{...e,groups:{...e.groups,[t.groupId]:o},selectedTimelineRows:i,selectedItem:{id:t.groupId,type:"group"},updateKey:P()}}const i=a.layers.map((e=>e.id)),s=[...a.layers,...t.layerIds.filter((e=>!i.includes(e))).map((e=>({id:e,saved:t.isUndoFromRemoveLayerFromGroup||!1})))],n={...a,layers:s,rotation:0,preMergeRotation:a.preMergeRotation||a.rotation},r=yT(n,e);if(Mw("groups",t.groupId,n,a,"ADD_LAYERS_TO_GROUP"),e.presence&&e.presentUserId){const o=e.presentUserId,a=e.presence[o];if(a){const i={...a,selectedLayerId:t.groupId};Vw(e,i,o,"ADD_LAYER_TO_GROUP")}}return{...e,groups:{...e.groups,[t.groupId]:n},selectedTimelineRows:r,selectedItem:{id:t.groupId,type:"group"},updateKey:P()}}case"REMOVE_ALL_UNSAVED_GROUPS":return F(e,(o=>{const a=[];for(const[t,i]of Object.entries(e.groups))i.saved||a.push(t);if(t.undoable){const t={};for(const o of a)t[o]=e.groups[o];ff.add({undo:{type:"UPDATE_GROUPS",updates:t,undoable:!1},redo:{type:"REMOVE_ALL_UNSAVED_GROUPS",undoable:!1}})}a.forEach((e=>{delete o.groups[e]}))}));case"ADD_SELECTED_TIMELINE_ROWS":{const o=[...e.selectedTimelineRows];for(const e of t.timelineRows)o.includes(e)||o.push(e);return{...e,selectedTimelineRows:o}}case"BRING_LAYER_FORWARD":{const o=x[0];if(!o)throw Error("No scene");const{layers:a}=o,i=a.findIndex((e=>e.id===t.layer.id));if(i===a.length-1)return e;const s=xT(e,a,i,"FORWARDS")-i;if(o.layers=hT(o,t.layer,s),t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"SEND_LAYER_BACK",layer:o},redo:{type:"BRING_LAYER_FORWARD",layer:t.layer}})}return{...e,scenes:[o],updateKey:P()}}case"DELETE_ANIMATION":return F(e,(o=>{e.animations.byId[t.animationId]&&eP(t,o)}));case"BULK_DELETE_ANIMATIONS":return F(e,(o=>{const a={},i={};if(t.animationIds.forEach((t=>{const s=e.animations.byId[t];if(s){if(a[t]=s,s.isCrossTransition){const a=e.allLayers.byId[s.introLayerId],n=e.allLayers.byId[s.outroLayerId];if(null==a?void 0:a.animation){const e={...a.animation};e.intro=(e.intro||[]).filter((e=>e!==t)),i[a.id]={...i[a.id],animation:a.animation},QR({type:"UPDATE_LAYERS",srcFn:"BULK_DELETE_ANIMATIONS",updates:{[a.id]:{animation:e}},undoable:!1},o)}if(null==n?void 0:n.animation){const e={...n.animation};e.outro=(e.outro||[]).filter((e=>e!==t)),i[n.id]={...i[n.id],animation:n.animation},QR({type:"UPDATE_LAYERS",srcFn:"BULK_DELETE_ANIMATIONS",updates:{[n.id]:{animation:e}},undoable:!1},o)}if(a&&n){const t=Ux(a,"intro",o.animations),s=kR({introLayer:a,newAnimation:null,oldAnimation:t,studioState:o});if(!s)return;Object.entries(s).forEach((([t,a])=>{const s=e.allLayers.byId[t];s&&(i[t]={...i[t],startTime:s.startTime,endTime:s.endTime,videoDelay:s.videoDelay},QR({type:"UPDATE_LAYERS",srcFn:"BULK_DELETE_ANIMATIONS",updates:{[s.id]:a},undoable:!1},o))}))}}eP({animationId:t,undoable:!1,type:"DELETE_ANIMATION"},o)}})),t.undoable){for(const o of t.animationIds)e.animations.byId[o];ff.add({undo:{type:"ADD_BACK_ANIMATIONS",layerUpdates:i,animations:a,undoable:!1},redo:{type:"BULK_DELETE_ANIMATIONS",animationIds:t.animationIds,undoable:!1}})}}));case"ADD_BACK_ANIMATIONS":return F(e,(o=>{Object.entries(t.layerUpdates).forEach((([e,t])=>{const a=o.allLayers.byId[e];a&&QR({type:"UPDATE_LAYERS",srcFn:"ADD_BACK_ANIMATIONS",updates:{[a.id]:t},undoable:!1},o)})),Object.entries(t.animations).forEach((([t,a])=>{ZR({type:"ADD_ANIMATION",animationInstance:{...a,id:t},undoable:!1},o,e)}))}));case"ENHANCE_LAYER":{const{assetId:o,enhanceJobId:a}=t;if(!o)return e;const i={...e.enhanceJobIds||{}};return a?(i[o]=a,Mw("enhanceJobIds",o,a,e.enhanceJobIds[o],"update enhanceJobIds")):(delete i[o],Bw("enhanceJobIds",o,e.enhanceJobIds[o],"update enhanceJobIds")),{...e,enhanceJobIds:i}}case"MOVE_LAYER_TO_INDEX":{const o=x[0];if(!o)throw Error("No scene");const a=o.layers.findIndex((e=>e.id===t.layer.id));t.undoable&&ff.add({undo:{type:"MOVE_LAYER_TO_INDEX",layer:t.layer,targetIndex:a},redo:{type:"MOVE_LAYER_TO_INDEX",layer:t.layer,targetIndex:t.targetIndex}});const i=t.targetIndex-a;return o.layers=hT(o,t.layer,i),{...e,scenes:[o],updateKey:P()}}case"REMOVE_GROUP":{const o=e.groups[t.groupId],a={...e.groups};return delete a[t.groupId],t.undoable&&ff.add({undo:{type:"UPDATE_GROUP",groupId:t.groupId,updates:{...o}},redo:{type:"REMOVE_GROUP",groupId:t.groupId}}),{...e,groups:a}}case"REMOVE_GROUP_FROM_GROUP":{t.undoable&&ff.add({undo:{type:"ADD_GROUP_TO_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId},redo:{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId}});const o=e.groups[t.destGroupId];if(!o)throw Error("No dest group");const a=e.groups[t.srcGroupId];if(!a)throw Error("No src group");const i=o.layers.filter((e=>e.fromMergedGroup!==t.srcGroupId)),s=o.layers.filter((e=>e.fromMergedGroup===t.srcGroupId)).map((e=>({id:e.id,saved:!0}))),n={...o,layers:i};i.every((e=>e.saved))&&void 0!==n.preMergeRotation&&(n.rotation=n.preMergeRotation,n.preMergeRotation=void 0);const r={...a,layers:s},l={...e.groups,[t.destGroupId]:n,[t.srcGroupId]:r};return Fw("groups",l,e.groups,"REMOVE_GROUP_FROM_GROUP"),{...e,groups:l,updateKey:P()}}case"REMOVE_LAYER":return F(e,(e=>{YR({type:"REMOVE_LAYERS",layers:[t.layer],source:t.source,undoable:t.undoable},e)}));case"REMOVE_LAYERS":return F(e,(e=>{YR(t,e)}));case"REMOVE_LAYERS_FROM_GROUP":{const o=e.groups[t.groupId];if(!o)return e;if(t.undoable){const e=o.layers.map((e=>e.id));ff.add({undo:{type:"ADD_LAYERS_TO_GROUP",layerIds:e,groupId:t.groupId,isUndoFromRemoveLayerFromGroup:!0,isTimelineGroup:!!o.isTimelineGroup,undoable:!1},redo:{type:"REMOVE_LAYERS_FROM_GROUP",layerIds:t.layerIds,groupId:t.groupId,undoable:!1}})}const a=new Set(t.layerIds),i=o?o.layers.filter((e=>!a.has(e.id))):[];if(i.length<=1){const o={...e.groups};delete o[t.groupId];const a=i[0]?i[0].id:null;return Mw("groups",t.groupId,void 0,e.groups[t.groupId],"REMOVE_LAYERS_FROM_GROUP"),{...e,groups:o,selectedItem:a?{id:a,type:"layer"}:null,updateKey:P()}}const s={...o,layers:i};return i.every((e=>e.saved))&&void 0!==s.preMergeRotation&&(s.rotation=s.preMergeRotation,s.preMergeRotation=void 0),Mw("groups",t.groupId,s,e.groups[t.groupId],"REMOVE_LAYERS_FROM_GROUP"),{...e,groups:{...e.groups,[t.groupId]:s},updateKey:P()}}case"REPOSITION_LAYER":{const o=x[0];if(!o)throw Error("No scene");if(t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"REPOSITION_LAYER",layer:o,x:null==(a=o.position)?void 0:a.x,y:null==(i=o.position)?void 0:i.y},redo:{type:"REPOSITION_LAYER",layer:t.layer,x:t.x,y:t.y}})}u({category:"Studio Reposition Layer",message:`Layer: ${t.layer.id}, New X: ${t.x}, New Y: ${t.y}`});const{...s}=e.allLayers.byId,[n,r]=function(e,t){const{x:o,y:a}=t,i=o,s=a;let n=t.layer.position;for(const r of e)if(r.id===t.layer.id){"position"in r&&(n=r.position);break}return uT(e,t.layer.id,{position:{...n,x:i,y:s}},"layer","repositionLayer")}(o.layers,t);return o.layers=n,s[r.id]=r,{...e,scenes:[o],updateKey:P(),allLayers:{byId:s}}}case"RESIZE_LAYER":{if(!e.allLayers.byId[t.layer.id])return e;const o=x[0];if(!o)throw Error("No scene");if(t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"RESIZE_LAYER",layer:o,x:null==(s=o.position)?void 0:s.x,y:null==(n=o.position)?void 0:n.y,width:null==(r=o.position)?void 0:r.width,height:null==(l=o.position)?void 0:l.height},redo:{type:"RESIZE_LAYER",layer:t.layer,x:t.x,y:t.y,width:t.width,height:t.height}})}u({category:"Studio Resize Layer",message:`Layer: ${t.layer.id}, New X Percent: ${t.x}, New Y Percent: ${t.y}, New Width Percent: ${t.width}, New Height Percent: ${t.height}`});const{...a}=e.allLayers.byId;if(o){const[e,i]=function(e,t){const{x:o,y:a,width:i,height:s}=t,n=o,r=a,l=i,d=s;let c=t.layer.position;for(const u of e)if(u.id===t.layer.id){"position"in u&&(c=u.position);break}return uT(e,t.layer.id,{position:{...c,x:n,y:r,width:l,height:d}},"layer","resizeLayer")}(o.layers,t);o.layers=e,a[t.layer.id]=i}return{...e,scenes:[o],updateKey:P(),allLayers:{byId:a}}}case"RESIZE_LINE_LAYER":{const o=x[0];if(!o)throw Error("No scene");if(t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"RESIZE_LINE_LAYER",layer:o,x:null==(d=o.position)?void 0:d.x,y:null==(c=o.position)?void 0:c.y,width:null==(m=o.position)?void 0:m.width,height:null==(p=o.position)?void 0:p.height,linePointStartCorner:o.linePointStartCorner,lineRightAngle:o.lineRightAngle},redo:{type:"RESIZE_LINE_LAYER",layer:t.layer,x:t.x,y:t.y,width:t.width,height:t.height,linePointStartCorner:t.linePointStartCorner,lineRightAngle:t.lineRightAngle}})}u({category:"Studio Resize Layer",message:`Line Layer: ${t.layer.id}, New X Percent: ${t.x}, New Y Percent: ${t.y}, New Width Percent: ${t.width}, New Height Percent: ${t.height}`});const{...a}=e.allLayers.byId;if(o){const[e,i]=function(e,t){const{x:o,y:a,width:i,height:s,linePointStartCorner:n,lineRightAngle:r}=t,l=o,d=a,c=i,u=s;let m=t.layer.position,p=null;n&&(p={linePointStartCorner:n,lineRightAngle:r});for(const h of e)if(h.id===t.layer.id){"position"in h&&(m=h.position);break}return uT(e,t.layer.id,{position:{...m,x:l,y:d,width:c,height:u},...p},"layer","resizeLineLayer")}(o.layers,t);o.layers=e,a[t.layer.id]=i}return{...e,scenes:[o],updateKey:P(),allLayers:{byId:a}}}case"SAVE_LAYER_GROUP":{let o=1;const a=Object.values(e.groups).map((e=>e.name?Number(e.name.split(" ")[1]):0)).sort(((e,t)=>t-e))[0];a&&(o=a+1);const i=`Group ${o}`,s=e.groups[t.groupId];if(!s)throw Error("No group found to save");const n={...s},r=t.saved?n.layers.filter((e=>!e.deselected)).map((e=>({...e,saved:!0}))):n.layers.map((e=>({...e,saved:!1}))),l={...n,layers:r,saved:t.saved,name:n.name?n.name:i},d=x[0];if(!d)throw Error("No scene");let c=d.layers.reduce(((e,t,o)=>l.layers.map((e=>e.id)).includes(t.id)?o:e),0);const u=[...d.layers].reverse(),m=[];for(const e of u){if(!l.layers.map((e=>e.id)).includes(e.id))continue;const t=d.layers.map((e=>e.id)).indexOf(e.id);0!==c-t&&m.push([t,c]),c-=1}const p=[...d.layers];for(const[e,t]of m){const o=t-e,a=p[e];a&&(d.layers=hT(d,a,o))}return t.undoable&&ff.add({undo:{func(){const{dispatch:e,state:o}=sr();e({type:"UPDATE_GROUP",groupId:t.groupId,updates:{...n}});const a=o.studio.scenes[0];if(!a)throw Error("No scene");const i=[...m].reverse();for(const[t,s]of i)e({type:"MOVE_LAYER_TO_INDEX",layer:a.layers[s],targetIndex:t})}},redo:{type:"SAVE_LAYER_GROUP",groupId:t.groupId,saved:t.saved}}),Mw("groups",t.groupId,l,e.groups[t.groupId],"SAVE_LAYER_GROUP"),{...e,groups:{...e.groups,[t.groupId]:l},selectedItem:{type:"group",id:t.groupId},scenes:[d],updateKey:P()}}case"SELECT_ITEM":{if(t.undoable&&ff.add({undo:{type:"SELECT_ITEM",item:e.selectedItem},redo:{type:"SELECT_ITEM",item:t.item}}),e.presence&&e.presentUserId){const o=e.presentUserId,a=t.item&&"layer"===t.item.type?t.item.id:"",i=e.presence[o];if(i){const t={...i,selectedLayerId:a};Vw(e,t,o,"SELECT_LAYER")}}let o=e;const a=t.item?vT(t.item,e):[];if(("group"===(null==(h=e.selectedItem)?void 0:h.type)?e.groups[e.selectedItem.id]:null)&&(null==(g=t.item)?void 0:g.id)!==(null==(y=e.selectedItem)?void 0:y.id)){const{groups:a,undo:i}=ST(e,(null==(v=e.selectedItem)?void 0:v.id)||"");o={...o,groups:a,updateKey:P()};const s=ff.getState(),n=s.actions[s.index];i&&n&&"STUDIO_DELETE_GROUP"!==n.type&&!1!==t.undoable&&ff.add({undo:i,redo:{type:"SELECT_ITEM",item:t.item}})}return"gap"===(null==(_=e.selectedItem)?void 0:_.type)&&e.timelineGap&&e.timelineGap.gapId===e.selectedItem.id&&(null==(w=t.item)?void 0:w.id)!==e.selectedItem.id&&(o={...o,timelineGap:null,updateKey:P()}),{...o,selectedItem:t.item,selectedTimelineRows:a}}case"SELECT_TRANSITION":if(t.undoable){const o={type:"SELECT_TRANSITION",payload:(null==(b=e.selectedTransition)?void 0:b.id)||null},a={type:"SELECT_TRANSITION",payload:t.payload};ff.add({undo:o,redo:a})}return{...e,selectedTransition:t.payload?{id:t.payload}:null};case"SEND_LAYER_BACK":{const o=e.scenes[0];if(!o)throw Error("No scene");const{layers:a}=o,i=a.findIndex((e=>e.id===t.layer.id));if(0===i)return e;const s=xT(e,a,i,"BACKWARDS")-i;if(o.layers=hT(o,t.layer,s),t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"BRING_LAYER_FORWARD",layer:o},redo:{type:"SEND_LAYER_BACK",layer:t.layer}})}return{...e,scenes:[o],updateKey:P()}}case"SET_LAYER_DUPLICATED":return{...e,layerDuplicated:t.layerDuplicated};case"SET_LAYER_DESELECTION_IN_GROUP":{const{groupId:o,layerId:a,deselect:i,undoable:s}=t;if(s){e.groups[o]&&ff.add({undo:{type:"SET_LAYER_DESELECTION_IN_GROUP",groupId:o,layerId:a,deselect:!i,undoable:!1},redo:{type:"SET_LAYER_DESELECTION_IN_GROUP",groupId:o,layerId:a,deselect:i,undoable:!1}})}const n=e.groups[o];if(!n)throw Error("No group");const r=n.layers.findIndex((e=>e.id===a));if(-1===r)return n.layers.push({id:a,saved:!1}),{...e,groups:{...e.groups,[o]:n}};const l=n.layers[r];if(!l)throw Error("No group layer");return l.saved?l.deselected=i:n.layers.splice(r,1),{...e,groups:{...e.groups,[o]:n}}}case"SET_SCALE":{const o=e.scenes[0];if(!o)throw Error("No scene");const{...a}=e.allLayers.byId,[i,s]=function(e,t){const{scaleX:o,scaleY:a}=t;let i=t.layer.position;for(const s of e)if(s.id===t.layer.id){"position"in s&&(i=s.position);break}return uT(e,t.layer.id,{position:{...i,scaleX:o,scaleY:a}},"layer","setScale")}(o.layers,t);return o.layers=i,a[s.id]=s,{...e,scenes:[o],allLayers:{byId:a},updateKey:P()}}case"SET_SELECTED_TIMELINE_ROWS":return{...e,selectedTimelineRows:t.timelineRows};case"SET_STUDIO_FLIP_HORIZONTAL":{const o=e.scenes[0];if(!o)throw Error("No scene");if(t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"SET_STUDIO_FLIP_HORIZONTAL",layer:o,axis:t.axis},redo:{type:"SET_STUDIO_FLIP_HORIZONTAL",layer:t.layer,axis:t.axis}})}u({category:"Studio Set Layer Flipped",message:`Layer: ${t.layer.id}, Flipped Axis: ${t.axis}`});const{...a}=e.allLayers.byId,[i,s]=pT(o.layers,t);return o.layers=i,a[s.id]=s,{...e,scenes:[o],updateKey:P(),allLayers:{byId:a}}}case"SET_STUDIO_FLIP_VERTICAL":{const o=e.scenes[0];if(!o)throw Error("No scene");if(t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"SET_STUDIO_FLIP_VERTICAL",layer:o,axis:t.axis},redo:{type:"SET_STUDIO_FLIP_VERTICAL",layer:t.layer,axis:t.axis}})}u({category:"Studio Set Layer Flipped",message:`Layer: ${t.layer.id}, Flipped Axis: ${t.axis}`});const{...a}=e.allLayers.byId,[i,s]=pT(o.layers,t);return o.layers=i,a[s.id]=s,{...e,scenes:[o],updateKey:P(),allLayers:{byId:a}}}case"SET_STUDIO_ROTATION":{const o=e.scenes[0];if(!o)throw Error("No scene");if(t.undoable){const o=e.allLayers.byId[t.layer.id];o&&ff.add({undo:{type:"SET_STUDIO_ROTATION",layer:o,rotation:null==(T=o.position)?void 0:T.rotation},redo:{type:"SET_STUDIO_ROTATION",layer:t.layer,rotation:t.rotation}})}u({category:"Studio Set Layer Rotation",message:`Layer: ${t.layer.id}, New Rotation: ${t.rotation}`});const{...a}=e.allLayers.byId,[i,s]=function(e,t){let{rotation:o}=t;o=o<0?360+o:o;let a=t.layer.position;for(const i of e)if(i.id===t.layer.id){"position"in i&&(a=i.position);break}return uT(e,t.layer.id,{position:{...a,rotation:o}},"layer","setRotation")}(o.layers,t);return o.layers=i,s&&(a[s.id]=s),{...e,scenes:[o],updateKey:P(),allLayers:{byId:a}}}case"SET_TIMELINE_GAP":{const{gapId:o,startTime:a,duration:i,timelineRow:s}=t,n={gapId:o,startTime:a,duration:i,timelineRow:s};return{...e,timelineGap:n}}case"SHOW_SNAP_LINES":return{...e,snapLines:t.lines};case"UPDATE_ANIMATION":return F(e,(o=>{var a;const i=(null==(a=o.animations)?void 0:a.byId)||{};if(i[t.animationId]={...i[t.animationId],...t.layerAnim},o.animations.byId=i,t.undoable){const o={type:"UPDATE_ANIMATION",animationId:t.animationId,layerAnim:e.animations.byId[t.animationId],undoable:!1},a={type:"UPDATE_ANIMATION",animationId:t.animationId,layerAnim:t.layerAnim,undoable:!1};ff.add({undo:o,redo:a})}Mw("animations","byId",i,e.animations.byId,"UPDATE_ANIMATION_BY_ID")}));case"UPDATE_GROUP":return F(e,(e=>tP(t,e)));case"UPDATE_GROUPS":return F(e,(o=>{if(t.undoable){const o=Object.entries(t.updates).reduce(((t,[o,a])=>{const i=e.groups[o];if(i){const e=Object.keys(a),s={};e.forEach((e=>{s[e]=i[e]})),t[o]=s}return t}),{});ff.add({undo:{type:"UPDATE_GROUPS",updates:o},redo:{type:"UPDATE_GROUPS",updates:t.updates}})}Object.entries(t.updates).forEach((([e,t])=>{tP({undoable:!1,groupId:e,updates:t,type:"UPDATE_GROUP"},o)}))}));case"UPDATE_LAYER":return F(e,(e=>{const{layer:o,properties:a,undoable:i}=t;return QR({type:"UPDATE_LAYERS",srcFn:"UPDATE_LAYER",updates:{[o.id]:a},undoable:i},e)}));case"UPDATE_LAYERS":return F(e,(e=>{QR(t,e)}));case"UPDATE_ALL_LAYERS":{const o=e.scenes[0];if(!o)throw Error("No scene");return F(e,(a=>{t.undoable&&ff.add({undo:{type:"UPDATE_ALL_LAYERS",layers:o.layers,sceneIndex:t.sceneIndex},redo:{type:"UPDATE_ALL_LAYERS",layers:t.layers,sceneIndex:t.sceneIndex}}),t.layers.forEach(((e,t)=>{e&&(Fw(`layer_${e.id}`,e,o.layers[t],"UPDATE_ALL_LAYERS"),a.scenes[0].layers[t]=e,a.allLayers.byId[e.id]=e)})),a.duration=_T(null==a?void 0:a.scenes,lT(e)),Fw("duration",a.duration,e.duration,"UPDATE_ALL_LAYERS"),wT(e,a.duration,a.scenes)}))}case"UPDATE_LAYERS_NO_SYNC":{const o=x[0];if(!o)throw Error("No scene");const{...a}=e.allLayers.byId,{updates:i}=t;return Object.keys(i).forEach((e=>{const t=a[e];t&&(a[e]={...t,...i[e]})})),o.layers.forEach(((e,t)=>{i[e.id]&&(o.layers[t]={...e,...i[e.id]})})),S=_T(x,lT(e)),{...e,duration:S,scenes:[o],updateKey:P(),allLayers:{byId:a}}}case"UPDATE_SELECTED_TIMELINE_ROWS":{const t=e.selectedItem?vT(e.selectedItem,e):e.selectedTimelineRows;return{...e,selectedTimelineRows:t}}case"UPDATE_UPLOADED_LAYER":return JR(t,e);default:return e}},aP=(e,t)=>{e.keyframing||(e.keyframing={},Lw({path:["keyframing"],val:e.keyframing,oldVal:void 0,srcFn:"safelyGetChannels"}));let o=e.keyframing[t];return o||(o={},e.keyframing[t]=o,Lw({path:["keyframing",t],val:o,oldVal:{},srcFn:"safelyGetChannels"})),o},iP=(e,t,o)=>{const a=aP(e,t);let i=a[o];return i||(a[o]={bezArray:[0,0,1,1],keyframes:[]},i=a[o],Lw({path:["keyframing",t,o],val:i,oldVal:void 0,srcFn:"safelyGetChannelMeta"})),i},sP=(e,t,o)=>{const{layerId:a,undoable:i}=e,n=aP(t,a);delete t.keyframing[a],i&&ff.add({undo:PE(a,n,!1),redo:RE(a)}),Lw({path:["keyframing"],val:s.get(t,["keyframing"]),oldVal:s.get(o,["keyframing"]),srcFn:"DELETE_LAYER_KEYFRAMES"})},nP=(e,t,o)=>{var a;const{layerId:i,layerChannels:n,undoable:r}=e;if(!n)return;const l=null==(a=t.keyframing)?void 0:a[i];aP(t,i),t.keyframing[i]=n,r&&ff.add({undo:PE(i,l,!1),redo:PE(i,n,!1)}),Lw({path:["keyframing",i],val:s.get(t,["keyframing",i]),oldVal:s.get(o,["keyframing",i]),srcFn:"SET_LAYER_CHANNELS"})},rP=(e,t)=>{switch(t.type){case"UPSERT_KEYFRAME":{const{layerId:o,time:a,channel:i,value:n,undoable:r}=t;return F(e,(l=>{const d=iP(l,o,i),c=d.keyframes.find((e=>e.time===a));if(c){const e=c.value;c.value=n,r&&ff.add({undo:EE(o,i,a,e,!1),redo:EE(o,i,a,n,!1)})}else d.keyframes.push({channel:i,time:a,value:n}),d.keyframes=d.keyframes.sort(((e,t)=>e.time-t.time)),r&&ff.add({undo:IE(o,i,a,!1),redo:{...t,undoable:!1}});return Lw({path:["keyframing",o,i,"keyframes"],val:s.get(l,["keyframing",o,i,"keyframes"]),oldVal:s.get(e,["keyframing",o,i,"keyframes"]),srcFn:"UPSERT_KEYFRAME"}),l}))}case"REMOVE_KEYFRAME":{const{layerId:o,time:a,channel:i,undoable:n}=t;return F(e,(t=>{const r=iP(t,o,i),l=r.keyframes.find((e=>e.time===a))||null;if(r.keyframes=r.keyframes.filter((e=>e.time!==a)),!r.keyframes.length&&l){const e=t.allLayers.byId[o];if(!e)throw Error("Layer not found");const a=((e,t,o,a)=>{var i;const n=e.allLayers.byId[t];if(!n)return{};const r=s.cloneDeep((null==(i=e.keyframing)?void 0:i[n.id])||{});if(!r[o])return{};r[o].keyframes=[a];const l=bE(),d=e.width||0,c=e.height||0,u=cx(n,r,l),m=kI(n,r,l),p=CI(n,r,l,d,c);return{zoom:m,position:{...n.position,...p},filters:u}})(t,o,i,l);QR({type:"UPDATE_LAYERS",srcFn:"REMOVE_KEYFRAME",updates:{[e.id]:a}},t)}return n&&(null==l?void 0:l.value)&&ff.add({undo:EE(o,i,a,l.value,!1),redo:IE(o,i,a,!1)}),Lw({path:["keyframing",o,i,"keyframes"],val:s.get(t,["keyframing",o,i,"keyframes"]),oldVal:s.get(e,["keyframing",o,i,"keyframes"]),srcFn:"REMOVE_KEYFRAME"}),t}))}case"TRIM_START_KEYFRAMES":{const{layerIdsToTimeChanges:o,undoable:a,maintainInterpolation:i}=t;return F(e,(t=>{ff.execInUndoBatch((()=>{Object.entries(o).forEach((([o,n])=>{(({layerId:e,timeChange:t,undoable:o,maintainInterpolation:a,state:i,draft:n})=>{const r=Object.entries(aP(n,e));if(!r.length)return;const l={};r.forEach((([e,o])=>{const{keyframes:i,bezArray:n}=o,r=s.cloneDeep(i),d=r.length;i.forEach((e=>{e.time+=t})),l[e]=r,o.keyframes=i.filter((e=>e.time>=0));const c=o.keyframes.length;if(a&&d!==c){const a=d-c,i=r[a-1],s=r[a];if(!i||!s)return;const l=nx(e,n,i.time-(i.time+t),i,s);o.keyframes.unshift({channel:e,time:0,value:l})}})),o&&ff.add({undo:AE(e,l,!1),redo:CE({[e]:t},a,!1)}),Lw({path:["keyframing",e],val:s.get(n,["keyframing",e]),oldVal:s.get(i,["keyframing",e]),srcFn:"TRIM_START_KEYFRAMES"})})({layerId:o,timeChange:n,undoable:a,maintainInterpolation:i,state:e,draft:t})}))}))}))}case"TRIM_END_KEYFRAMES":{const{layerIdsToMaxTimes:o,maintainInterpolation:a,undoable:i}=t;return F(e,(t=>{ff.execInUndoBatch((()=>{Object.entries(o).forEach((([o,n])=>{(({layerId:e,maxTime:t,undoable:o,maintainInterpolation:a,state:i,draft:n})=>{const r=Object.entries(aP(n,e));if(!r.length)return;const l={};r.forEach((([e,o])=>{var i,n;const{bezArray:r,keyframes:d}=o;l[e]=s.cloneDeep(d);const c=o.keyframes.length;o.keyframes=d.filter((e=>e.time<=t));const u=o.keyframes.length;if(a&&c!==u){const a=null==(i=l[e])?void 0:i[u-1],s=null==(n=l[e])?void 0:n[u];if(a&&s){const i=nx(e,r,t,a,s);o.keyframes.push({channel:e,time:t,value:i})}}})),o&&ff.add({undo:AE(e,l,!1),redo:kE({[e]:t},a,!1)}),Lw({path:["keyframing",e],val:s.get(n,["keyframing",e]),oldVal:s.get(i,["keyframing",e]),srcFn:"TRIM_END_KEYFRAMES"})})({layerId:o,maxTime:n,undoable:i,maintainInterpolation:a,state:e,draft:t})}))}))}))}case"SET_KEYFRAMES":{const{layerId:o,keyframesForChannels:a,undoable:i}=t;return F(e,(t=>{const n={};return Object.entries(a).forEach((([e,a])=>{const i=iP(t,o,e),r=s.cloneDeep(i.keyframes);n[e]=r,i.keyframes=a})),i&&ff.add({undo:AE(o,n,!1),redo:AE(o,a,!1)}),Lw({path:["keyframing",o],val:s.get(t,["keyframing",o]),oldVal:s.get(e,["keyframing",o]),srcFn:"SET_KEYFRAMES"}),t}))}case"SPLIT_KEYFRAMES":return F(e,(o=>{const{leftLayerId:a,rightLayerId:i,studioTime:n,undoable:r}=t,l=o.allLayers.byId[a],d=o.allLayers.byId[i];if(!l||!d)return o;const[c]=TS(l),[u]=TS(d),m=aP(o,a),p={};return Object.entries(m).forEach((([e,t])=>{const a=iP(o,i,e),{keyframes:s,bezArray:r}=t,l=[],d=[];s.forEach((e=>{e.time<=n-c?l.push(e):(e.time-=u-c,d.push(e))}));const m=s.find((({time:e})=>e===n-c));if(p[e]=[],m){const t={channel:e,time:0,value:m.value};p[e].push(t),d.unshift(t)}else{const t=l[l.length-1],o=d[0];if(t&&o){const a=nx(e,r,n-c,t,{...o,time:o.time+u-c}),i={channel:e,time:n-c,value:a},s={channel:e,time:0,value:a};p[e].push(i),p[e].push(s),l.push(i),d.unshift(s)}}t.keyframes=l,a.keyframes=d})),Lw({path:["keyframing"],val:s.get(o,["keyframing"]),oldVal:s.get(e,["keyframing"]),srcFn:"SPLIT_KEYFRAMES"}),r&&ff.add({undo:NE(a,i,u-c,p),redo:jE(a,i,n,!1)}),o}));case"UNDO_SPLIT_KEYFRAMES":return F(e,(o=>{const{leftLayerId:a,rightLayerId:i,timeCorrection:n,insertedFrames:r}=t,l=aP(o,i);return Object.entries(l).forEach((([e,t])=>{const i=r[e]||[],s=iP(o,a,e),l=t.keyframes;i.length>0&&l.shift(),2===i.length&&s.keyframes.pop(),l.forEach((e=>{e.time+=n,s.keyframes.push(e)})),s.keyframes=s.keyframes.sort(((e,t)=>e.time-t.time))})),delete o.keyframing[i],Lw({path:["keyframing"],val:s.get(o,["keyframing"]),oldVal:s.get(e,["keyframing"]),srcFn:"UNDO_SPLIT_KEYFRAMES"}),o}));case"DELETE_LAYER_KEYFRAMES":return F(e,(o=>{sP(t,o,e)}));case"DELETE_MULTIPLE_LAYERS_KEYFRAMES":return F(e,(o=>{if(t.undoable){const e={};t.layerIds.forEach((t=>{const a=aP(o,t);e[t]=a})),ff.add({undo:{type:"SET_MULTIPLE_LAYERS_CHANNELS",channelUpdates:e,undoable:!1},redo:{type:"DELETE_MULTIPLE_LAYERS_KEYFRAMES",layerIds:t.layerIds,undoable:!1}})}t.layerIds.forEach((t=>{sP({type:"DELETE_LAYER_KEYFRAMES",layerId:t,undoable:!1},o,e)}))}));case"SET_LAYER_CHANNELS":return F(e,(o=>{nP(t,o,e)}));case"SET_MULTIPLE_LAYERS_CHANNELS":return F(e,(o=>{Object.entries(t.channelUpdates).forEach((([t,a])=>{nP({type:"SET_LAYER_CHANNELS",layerId:t,layerChannels:a,undoable:!1},o,e)}))}));case"SHIFT_KEYFRAME_PLAYBACK_SPEED":return F(e,(o=>{const{layerId:a,oldPlaybackRate:i,newPlaybackRate:n,undoable:r}=t,l=+(i/n).toFixed(3);return Object.values(aP(o,a)).forEach((({keyframes:e})=>{e.forEach((e=>{e.time*=l}))})),r&&ff.add({undo:DE(a,n,i),redo:DE(a,i,n)}),Lw({path:["keyframing",a],val:s.get(o,["keyframing",a]),oldVal:s.get(e,["keyframing",a]),srcFn:"SHIFT_KEYFRAME_PLAYBACK_SPEED"}),o}));case"COPY_LAYER_KEYFRAMES":return F(e,(o=>{const{fromLayerId:a,toLayerId:i,undoable:n}=t,r=aP(o,a);return o.keyframing[i]=s.cloneDeep(r),n&&ff.add({undo:RE(i,!1),redo:OE(a,i,!1)}),Lw({path:["keyframing"],val:s.get(o,["keyframing"]),oldVal:s.get(e,["keyframing"]),srcFn:"COPY_LAYER_KEYFRAMES"}),o}));default:return e}},lP=new Set(["fullPath","image_url","blob_name","thumbnail_blob_name"]),dP=new Set(["analytics","appliedHighlight","projectName","projectVersion","ratio","hasCustomOutput","customOutputWidth","customOutputHeight","topFontsLoaded","overlayMounted","isDragging","scenes","animations","allLayers","localId","deletedLayerLocalBlobDict","deletedLayerDict","selectedTimelineRows","groups","pendingGoogleDriveUploads","timelineGap","safeZoneChosen","snapToGrid","privacy","showCanvas","background","canvasBlur","duration","toolTip","videoType","imageType","gifType","exportFrameTime","quality","addedOptimizedLayer","draft","done","createdAt","fullPath","image_url","blob_name","thumbnail_blob_name","updateKey","refreshKey","lastSaved","dimensions","canvasDimensions","name","canvasX","canvasY","containerX","containerY","containerWidth","containerHeight","workspaceId","projectId","creatorId","creatorEmail","copiedProjectId","teamId","canvasPreviewSeekerTimestampId","contextMenuUsed","customFontsFetched","playCanvasPreviewOnMount","usedEyedropper","watermark","layerDuplicated","thisProjectCMLFiles","enhanceJobIds","userSpecificSettings","userSpecificSettingsAnonymous","selectedTransition","magicSubtitles","magicSubtitlesGlobal","magicSubtitleFramesByAsset","assetUploadedSubtitles","isCollaborating","presence","presentUserId","readonly","exportQuality","exportResolution","isBrandKitTemplate","fromBrandKitTemplate","keyframing","transcriptionEditCounts","workflowId"]),cP=oe.v4(),uP=()=>({analytics:{},appliedHighlight:null,projectName:"",projectVersion:"0.9",ratio:"1:1",hasCustomOutput:!1,customOutputWidth:void 0,customOutputHeight:void 0,topFontsLoaded:!1,origin:"",overlayMounted:!1,isDragging:!1,scenes:[{id:cP,layers:[],background:"#ffffff",duration:0,userSelectedDuration:0,userSetDuration:!1}],animations:{byId:{},allIds:[]},allLayers:{byId:{}},localId:oe.v4(),deletedLayerLocalBlobDict:{},deletedLayerDict:{},selectedTimelineRows:[0],groups:{},pendingGoogleDriveUploads:[],timelineGap:null,safeZoneChosen:"none",snapToGrid:!0,privacy:Ln.unlisted,showCanvas:!1,background:"#ffffff",canvasBlur:!1,duration:0,toolTip:"",videoType:"mp4",imageType:"png",gifType:"gif",exportFrameTime:-1,quality:"standard",addedOptimizedLayer:!1,draft:!1,done:!1,createdAt:"",fullPath:"",image_url:"",updateKey:0,refreshKey:0,lastSaved:"",dimensions:{screenWidth:0,screenHeight:0},canvasDimensions:{canvasWidth:0,canvasHeight:0},name:"",canvasX:0,canvasY:0,containerX:0,containerY:0,containerWidth:0,containerHeight:0,workspaceId:null,projectId:null,creatorId:void 0,creatorEmail:void 0,copiedProjectId:void 0,teamId:void 0,canvasPreviewSeekerTimestampId:oe.v4(),contextMenuUsed:0,customFontsFetched:!1,playCanvasPreviewOnMount:!1,usedEyedropper:!1,watermark:!1,layerDuplicated:!1,thisProjectCMLFiles:void 0,enhanceJobIds:{},userSpecificSettings:{},userSpecificSettingsAnonymous:{},selectedTransition:null,magicSubtitles:{},magicSubtitlesGlobal:{},magicSubtitleFramesByAsset:{},assetUploadedSubtitles:{},isCollaborating:!1,presence:{},presentUserId:"",readonly:!1,exportQuality:"Standard",exportResolution:"AUTO",isBrandKitTemplate:null,fromBrandKitTemplate:null,keyframing:void 0,transcriptionEditCounts:{}});const mP=e=>{const{groups:t}=(e=>{let t={...e.groups||{}};if(!e.selectedItem)for(const o of Object.keys(t)){const{groups:a}=ST({...e,groups:t},o);t=a}return{groups:t}})(e),{scenes:o}=(e=>{const t=new Set,o=e.scenes[0];if(!o)throw Error("No scene");return o.layers.forEach(((e,a)=>{t.has(e.id)&&o.layers.splice(a,1),t.add(e.id)})),{scenes:[o]}})(e);return{groups:t,scenes:o}},pP=(e,t)=>{const o=s.cloneDeep(uP()),{source:a}=t;((e,t)=>{if(Object.entries(t.studio).forEach((([o,a])=>{dP.has(o)&&(lP.has(o)?t.preserveId&&(e[o]=a):e[o]=a)})),!t.studio.scenes)for(const o of["layers","background","duration","isImageVideo"])e.scenes[0][o]=t.studio[o]})(o,t),((e,t,o)=>{e.origin=t.origin,e.overlayWithHeader=t.overlayWithHeader,e.snapToGrid=t.snapToGrid,e.overlayMounted=t.overlayMounted,e.canvasDimensions=t.canvasDimensions||{canvasWidth:0,canvasHeight:0},t.width&&t.height&&(e.width=t.width,e.height=t.height,e.canvasX=t.canvasX,e.canvasY=t.canvasY,e.containerX=t.containerX,e.containerY=t.containerY,e.containerWidth=t.containerWidth,e.containerHeight=t.containerHeight);for(const a of e.scenes)a.layers.every((e=>{const o=fT(e.id,t);return["video","image","audio"].includes(e.type)&&(e.local_url=(null==o?void 0:o.local_url)||""),!0}));e.duration=_T(e.scenes,lT(t)),o.preserveId&&(e._id=o.studio._id,e.projectId=o.studio.projectId);for(const a of e.scenes)a.layers.every((e=>{if("local"!==e.source)return!0;const o=fT(e.id,t);return"local"!==(null==o?void 0:o.source)&&Object.assign(e,o),!0}));e.presentUserId=t.presentUserId,e.selectedItem=t.selectedItem})(o,e,t);const i=t.isFirstVideoLoad||"onGetSharedDoc"===t.source?mP(o):{},n=(e=>{const t={};for(const o of e.scenes)for(const e of o.layers)t[e.id]=e;return t})(o);return o.refreshKey=oe.v4(),"onOp"!==a&&(o.pendingGoogleDriveUploads=[]),{...o,...i,allLayers:{byId:n}}},hP=(e=uP(),t)=>{let o=e,a=[...o.scenes],i=0;switch(o.allLayers||(o.allLayers={byId:{}}),o=PT(o,t),o=rP(o,t),o=((e,t)=>{switch(t.type){case"DELTA_ASSET_TRANSCRIPTION_EDIT_COUNT":return F(e,(o=>{const{delta:a,assetIds:i}=t;i.forEach((e=>{var t;const{transcriptionSource:i}=(null==(t=o.magicSubtitles)?void 0:t[e])||{};"transcription"===i&&(o.transcriptionEditCounts[e]||(o.transcriptionEditCounts[e]=0),o.transcriptionEditCounts[e]+=a)})),Lw({path:["transcriptionEditCounts"],val:s.get(o,["transcriptionEditCounts"]),oldVal:s.get(e,["transcriptionEditCounts"]),srcFn:"DELTA_ASSET_TRANSCRIPTION_EDIT_COUNT"})}));case"RESET_ASSET_TRANSCRIPTION_EDIT_COUNT":return F(e,(o=>{const{assetIds:a}=t;a.forEach((e=>delete o.transcriptionEditCounts[e])),Lw({path:["transcriptionEditCounts"],val:s.get(o,["transcriptionEditCounts"]),oldVal:s.get(e,["transcriptionEditCounts"]),srcFn:"DELTA_ASSET_TRANSCRIPTION_EDIT_COUNT"})}));default:return e}})(o,t),o=oP(o,t),o=((e,t)=>"SET_ASSET_PARSED_SUBTITLE"===t.type?F(e,(o=>{var a,i;o.assetUploadedSubtitles&&0!==Object.keys(o.assetUploadedSubtitles).length||(o.assetUploadedSubtitles={},Lw({path:["assetUploadedSubtitles"],oldVal:void 0,val:{},srcFn:"SET_ASSET_PARSED_SUBTITLE"}));const s=o.assetUploadedSubtitles[t.assetId];o.assetUploadedSubtitles[t.assetId]=t.subtitles?{subtitles:t.subtitles}:void 0,Lw({path:["assetUploadedSubtitles",t.assetId],oldVal:s,val:o.assetUploadedSubtitles[t.assetId],srcFn:"SET_ASSET_PARSED_SUBTITLE"}),t.undoable&&ff.add({undo:{...t,undoable:!1,subtitles:null==(i=null==(a=e.assetUploadedSubtitles)?void 0:a[t.assetId])?void 0:i.subtitles},redo:{...t,undoable:!1}})})):e)(o,t),t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":Tw();return s.cloneDeep(uP());case"SET_VIDEO_ID":return F(o,(e=>{const a=t._id;e._id=a;const i=[];for(const t of o.scenes)for(const o of t.layers){const{asset_id:t,cmlFileId:s}=o;a&&o.cmlFileId&&i.push(o.cmlFileId),t&&s&&bT(e,{asset_id:t,cmlFileId:s})}a&&Hb(i,a),e.readonly=!1}));case"SET_IMAGE_URL":return{...o,image_url:t.image_url};case"SET_FULL_PATH":return Lw({path:["fullPath"],oldVal:o.fullPath,val:t.fullPath,srcFn:"client-side"}),{...o,fullPath:t.fullPath};case"SET_VIDEO_DRAFT_INFO":return Fw("draft",t.draft,o.draft,"SET_VIDEO_DRAFT_INFO"),{...o,draft:t.draft,done:t.done,createdAt:t.createdAt,lastSaved:t.lastSaved};case"SET_STUDIO":return t.undoable&&ff.add({undo:{...t,studio:o,undoable:!1},redo:{...t,undoable:!1}}),o.projectId!==t.studio.projectId&&Tw(),t.sync&&window.sharedDoc&&function(e,t){const o=gw(t);Object.entries(o).forEach((([o,a])=>{o&&a&&e.submitOp({p:[o],oi:a,od:e.data[o],__md:{srcFn:"client/syncVideoToSharedDoc",submittedAt:Date.now(),cv:t.projectVersion}})})),Object.entries(e.data).forEach((([a,i])=>{a&&i&&(o[a]||e.submitOp({p:[a],od:i,_md:{srcFn:"removeKeyFromSharedDoc",submittedAt:Date.now(),cv:t.projectVersion}}))}))}(window.sharedDoc,t.studio),pP(o,t);case"KAPWING_INIT":{if("scenes"in o){const e=mP(o);return i=_T(o.scenes,lT(o)),Fw("duration",i,o.duration,"KAPWING_INIT"),function(e){for(const t of Object.values(e.allLayers.byId))delete t.local_url,delete t.base64_img;e.scenes.forEach((e=>{e.layers.every((e=>!e||(delete e.local_url,delete e.base64_img,!0)))}))}(o),{...o,...e,duration:i}}!function(e){e.scenes=[{id:cP,layers:e.layers,duration:e.duration,isImageVideo:!1,background:e.background}],e.selectedItem=null,e.duration=_T(e.scenes,lT(e))}(o);const e=mP(o);return{...o,...e,deletedLayerLocalBlobDict:{},deletedLayerDict:{}}}case"SET_STUDIO_DIMENSIONS":return u({category:"Studio Update Dimensions",message:`Dimensions: ${JSON.stringify(t.dimensions)}`}),{...o,...t.dimensions,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_STUDIO_RATIO":return t.undoable&&ff.add({undo:{type:"SET_STUDIO_RATIO",ratio:o.ratio},redo:{type:"SET_STUDIO_RATIO",ratio:t.ratio}}),Fw("ratio",t.ratio,o.ratio,"SET_STUDIO_RATIO"),{...o,ratio:t.ratio,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_CUSTOM_OUTPUT_SIZE":return t.undoable&&ff.add({undo:{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:o.hasCustomOutput,customOutputWidth:o.customOutputWidth,customOutputHeight:o.customOutputHeight},redo:{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:t.hasCustomOutput,customOutputWidth:t.customOutputWidth,customOutputHeight:t.customOutputHeight}}),Fw("hasCustomOutput",t.hasCustomOutput,o.hasCustomOutput,"SET_CUSTOM_OUTPUT_SIZE"),Fw("customOutputWidth",t.customOutputWidth,o.customOutputWidth,"SET_CUSTOM_OUTPUT_SIZE"),Fw("customOutputHeight",t.customOutputHeight,o.customOutputHeight,"SET_CUSTOM_OUTPUT_SIZE"),{...o,hasCustomOutput:t.hasCustomOutput,customOutputWidth:t.customOutputWidth,customOutputHeight:t.customOutputHeight};case"SET_VIDEO_TYPE":return Fw("videoType",t.videoType,o.videoType,"SET_VIDEO_TYPE"),wT({...o,videoType:t.videoType},i,a),{...o,videoType:t.videoType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_IMAGE_TYPE":return Fw("imageType",t.imageType,o.imageType,"SET_IMAGE_TYPE"),{...o,imageType:t.imageType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_GIF_TYPE":return Fw("gifType",t.gifType,o.gifType,"SET_GIF_TYPE"),{...o,gifType:t.gifType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_EXPORT_FRAME_TIME":return Fw("exportFrameTime",t.exportFrameTime,o.exportFrameTime,"SET_EXPORT_FRAME_TIME"),{...o,exportFrameTime:t.exportFrameTime,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_QUALITY":return Fw("quality",t.quality,o.quality,"SET_QUALITY"),{...o,quality:t.quality,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_EXPORT_QUALITY":return Fw("exportQuality",t.exportQuality,o.exportQuality,"SET_EXPORT_QUALITY"),{...o,exportQuality:t.exportQuality,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_EXPORT_RESOLUTION":return Fw("exportResolution",t.exportResolution,o.exportResolution,"SET_EXPORT_RESOLUTION"),{...o,exportResolution:t.exportResolution,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_ADDED_OPTIMIZED_LAYER":return Fw("addedOptimizedLayer",!0,o.addedOptimizedLayer,"SET_ADDED_OPTIMIZED_LAYER"),{...o,addedOptimizedLayer:!0,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_DRAGGING":return{...o,isDragging:t.isDragging};case"SET_RESIZING":return{...o,isResizing:t.isResizing};case"SET_ROTATING":return{...o,isRotating:t.isRotating};case"SET_ORIGIN":return{...o,origin:t.origin};case"SET_PLAY_CANVAS_PREVIEW_ON_MOUNT":return{...o,playCanvasPreviewOnMount:!0};case"SET_OVERLAY_MOUNTED":return{...o,overlayMounted:t.overlayMounted};case"UPDATE_SCENE":{if(t.undoable){const{scene:e}=t,o={};Object.keys(t.properties).forEach((t=>{const a=t;o[a]=e[a]}));const a=t.initialProperties||o;ff.add({undo:{type:"UPDATE_SCENE",scene:e,properties:{...a}},redo:{type:"UPDATE_SCENE",scene:e,properties:{...t.properties}}})}const[e]=uT(a,t.scene.id,t.properties,"scene","UPDATE_SCENE");return a=[e[0]],i=_T(a,lT(o)),Fw("duration",i,o.duration,"UPDATE_SCENE"),wT(o,i,a),{...o,duration:i,scenes:a,updateKey:oe.v4()}}case"SELECT_SAFEZONE":return{...o,safeZoneChosen:t.value,updateKey:oe.v4()};case"SET_SNAP_TO_GRID":return{...o,snapToGrid:t.value,updateKey:oe.v4()};case"ENABLE_SNAP_IN_TIMELINE":return gP("snapInTimeline",!0,t.userId,o);case"DISABLE_SNAP_IN_TIMELINE":return gP("snapInTimeline",!1,t.userId,o);case"SET_CANVAS_BLUR":return t.undoable&&ff.add({undo:{type:"SET_CANVAS_BLUR",value:!t.value},redo:{type:"SET_CANVAS_BLUR",value:t.value}}),Fw("canvasBlur",t.value,o.canvasBlur,"SET_CANVAS_BLUR"),{...o,canvasBlur:t.value,updateKey:oe.v4()};case"SET_USER_SPECIFIC_SETTING":return gP(t.key,t.value,t.userId,o);case"SHOW_STUDIO_CANVAS":return Fw("showCanvas",!0,o.showCanvas,"SHOW_STUDIO_CANVAS"),{...o,showCanvas:!0,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey};case"SET_STUDIO_BACKGROUND":{const e=a[0];if(!e)throw Error("No scene found");return t.undoable&&ff.add({undo:{type:"SET_STUDIO_BACKGROUND",color:e.background},redo:{type:"SET_STUDIO_BACKGROUND",color:t.color}}),Mw(`scene_${e.id}`,"background",t.color,e.background,"SET_STUDIO_BACKGROUND"),e.background=t.color,Fw("background",t.color,o.background,"SET_STUDIO_BACKGROUND"),{...o,scenes:a,background:t.color,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?oe.v4():o.updateKey}}case"SET_IMAGE_VIDEO":{const e=o.scenes[0];if(!e)throw Error("No scene found");return Mw(`scene_${e.id}`,"isImageVideo",t.isImageVideo,e.isImageVideo,"SET_IMAGE_VIDEO"),e.isImageVideo=t.isImageVideo,i=_T(a,lT(o)),Fw("duration",i,o.duration,"SET_IMAGE_VIDEO"),wT(o,i,a),{...o,duration:i,scenes:a,updateKey:oe.v4()}}case"SET_STUDIO_DURATION":{const e=o.scenes[0];return t.undoable&&ff.add({undo:{type:"SET_STUDIO_DURATION",duration:o.duration},redo:{type:"SET_STUDIO_DURATION",duration:t.duration}}),e?(Mw(`scene_${e.id}`,"duration",t.duration,e.duration,"SET_STUDIO_DURATION"),e.duration=t.duration,i=function(e,t){const o=_T(t,lT(e));return Fw("duration",o,e.duration,"updateStudioDurationFromScenes"),wT(e,o,t),o}(o,a),{...o,scenes:a,duration:i,updateKey:oe.v4()}):{...o,duration:t.duration,updateKey:oe.v4()}}case"UPDATE_LAST_SAVED":{const e=new Date;return Fw("lastSaved",e,o.lastSaved,"UPDATE_LAST_SAVED"),{...o,lastSaved:e}}case"SET_CANVAS_DIMENSIONS":return{...o,canvasDimensions:t.canvasDimensions};case"FORCE_UPDATE_CANVAS_PREVIEW_SEEKER_TIMESTAMP":return{...o,canvasPreviewSeekerTimestampId:oe.v4()};case"SET_EDIT_HISTORY_INDEX":return{...o,historyIndex:t.historyIndex,usedUndo:t.usedUndo,lastUndoTimestamp:t.usedUndo?Date.now():o.lastUndoTimestamp};case"SET_EDIT_HISTORY_INDEX_MINIMUM":return{...o,historyIndexMinimum:t.historyIndexMinimum};case"DISABLE_STUDIO_UNDO":return{...o,disableUndo:t.disableUndo};case"SET_EYEDROPPER_MODE":return{...o,eyedropperMode:t.status,usedEyedropper:!0};case bp.UPDATE_ANALYTICS:{const e={...t.updates};return Fw("analytics",{...o.analytics,...e},o.analytics,"UPDATE_ANALYTICS"),{...o,analytics:{...o.analytics,...e}}}case"ADD_CONTEXT_MENU_ANALYTICS":return{...o,contextMenuUsed:o.contextMenuUsed?o.contextMenuUsed+1:1};case"SET_RIPPLE_MODE":return gP("rippleMode",t.rippleMode,t.userId,o);case"SET_COLLABORATING":return o.readonly?o:(Fw("isCollaborating",t.isCollaborating,o.isCollaborating,"SET_COLLABORATING",!0),{...o,isCollaborating:t.isCollaborating});case"INIT_PRESENCE":{const{presenceInfo:e,userId:a}=t;return Vw(o,e,a,"INIT_PRESENCE"),{...o,presence:{...o.presence,[a]:e}}}case"REMOVE_PRESENCE":{const{presenceInfo:e,userId:a}=t;!function(e,t,o){Pw({p:["presence",t],od:e},{srcFn:o,skipLastUpdated:!0})}(e,a,"REMOVE_PRESENCE");const i={...o.presence};return delete i[a],{...o,presence:i}}case"UPDATE_PRESENCE":{const{presenceInfo:e,userId:a}=t;return Vw(o,e,a,"UPDATE_PRESENCE"),{...o,presence:{...o.presence,[a]:{...e}}}}case"SET_PRESENT_USER":return{...o,presentUserId:t.userId};case"ADD_GOOGLE_DRIVE_PENDING_UPLOAD":case"REMOVE_GOOGLE_DRIVE_PENDING_UPLOAD":case"UPDATE_GOOGLE_DRIVE_PENDING_UPLOAD":return IT(t,o);case"LINK_CML_FILE_TO_PROJECT":{const{assetId:e,cmlFileId:a,videoId:i}=t;return i&&Gb(a,i),F(o,(t=>{bT(t,{asset_id:e,cmlFileId:a})}))}case"LINK_CML_FILES_TO_PROJECT":return F(o,(e=>{const o=[];t.cmlFiles.forEach((t=>{const{asset_id:a,id:i}=t;bT(e,{asset_id:a,cmlFileId:i}),o.push(i)})),t.videoId&&Hb(o,t.videoId)}));case"UNLINK_CML_FILE_FROM_PROJECT":{const{cmlFileId:e,videoId:a}=t;return a&&async function(e,t){Ub((()=>zr(`/api/v1/cloudMediaLibrary/file/${e}/linkedVideo/${t}`).catch(console.error)))}(e,a),F(o,(t=>{TT(t,e)}))}case"SET_PROJECT_ID":return o.projectId!==t.projectId&&Tw(),{...o,projectId:t.projectId};case eT.type:case tT.type:case oT.type:{const e=Date.now();return Fw("commentsLastUpdated",e,o.commentsLastUpdated,t.type),{...o,commentsLastUpdated:e}}case"SET_STUDIO_ID":return{...o,_id:t.id};case"SET_IS_BRANDKIT_TEMPLATE":return Fw("isBrandKitTemplate",t.isBrandKitTemplate,o.isBrandKitTemplate,t.type),{...o,isBrandKitTemplate:t.isBrandKitTemplate};case"TEST_ONLY_UPDATE_STUDIO":return{...o,...t.studio};case"SET_APPLIED_HIGHLIGHT":return t.undoable&&ff.add({undo:{...t,payload:o.appliedHighlight,undoable:!1},redo:{...t,undoable:!1}}),Lw({path:["appliedHighlight"],oldVal:o.appliedHighlight,val:t.payload,srcFn:"SET_APPLIED_HIGHLIGHT"}),{...o,appliedHighlight:t.payload};default:return o}};function gP(e,t,o,a){var i;if(o){const s={...a.userSpecificSettings,[o]:{...null==(i=a.userSpecificSettings)?void 0:i[o],[e]:t}};return Fw("userSpecificSettings",s,a.userSpecificSettings,"updateUserSpecificSettings"),{...a,userSpecificSettings:s}}const s={...a.userSpecificSettingsAnonymous,[e]:t};return{...a,userSpecificSettingsAnonymous:s}}function fP(e){let t=function(e){let t=ie(e);return t=t.replace(/[^a-z0-9.]/gi,"_"),t=t.replace(/_{2,}/g,"_"),t}(e);const o=t.split(".").pop();t=t.replace(/\..+$/,"");return t=`${t}-${ae.generate()}`,t=`${t}.${o}`,t}function yP({files:e,isPrivate:t=!0,useNameDirectly:o}){return Qr("create_resumable_upload",{body:{files:e.map((({file:e})=>({fileName:o?e.name:fP(e.name||""),fileType:e.type,private:t})))},retries:5})}const vP=()=>Promise.resolve(),_P=e=>new Promise((t=>setTimeout((()=>t()),e)));class wP{constructor({file:e,layer:t,bucket:o=hn,isPrivate:a=!1,onProgress:s=vP,onFinish:n=vP,onError:r=vP,onCancel:l=vP,onRetry:d=vP,origin:c="unknown",uploadSourceComponent:m,useNameDirectly:p=!1,analyticsUploadSource:h}){i(this,"file"),i(this,"layer"),i(this,"bucket"),i(this,"isPrivate"),i(this,"onProgress"),i(this,"onFinish"),i(this,"onError"),i(this,"onCancel"),i(this,"onRetry"),i(this,"origin"),i(this,"upload_uri",""),i(this,"read_uri",""),i(this,"uploadSourceComponent"),i(this,"xhr",null),i(this,"offlineRetries",0),i(this,"otherRetries",0),i(this,"useNameDirectly"),i(this,"analyticsUploadSource"),i(this,"logError",((e,t,o=!0)=>{u({category:"Upload Fails",message:`Orign: ${this.origin} stage: ${t}, file: ${JSON.stringify(this.file)}`}),o&&R(e),Fm(ym.UPLOAD_FAILS,{Origin:this.origin,Message:"string"==typeof e?e:e.message,FailStage:t,FileType:this.file.type,"File Size (MB)":this.file.size/1e6})})),i(this,"logProgress",(e=>{u({category:"Upload Progress",message:e})})),i(this,"upload",(async()=>{for(let t=0;t<=5;t+=1){try{this.logProgress("Upload Begins");const e=await yP({files:[{file:this.file}],isPrivate:this.isPrivate,useNameDirectly:this.useNameDirectly}),{read_uri:t,upload_uri:o}=e.uris[0];this.upload_uri=o,this.read_uri=t,this.uploadToGCS()}catch(e){if(t<5){await _P(2**t*1e3);continue}const{message:o}=ph(e);this.logError(e instanceof Error?e:o,"upload"),this.onError(o,this.file,this.layer,"upload",!1)}break}})),i(this,"uploadToGCS",(async({retry:e=0,startByte:t=0}={})=>{let o=null,a=null;const i=setInterval((()=>{if(null!==o&&null!==a&&1!==a){0===Math.abs(a-o)&&(Fm(ym.UPLOAD_STALLED,{"File Type":this.file.type,"Size (MB)":this.file.size/1e6,"Upload Location":this.analyticsUploadSource}),clearInterval(i))}o=a}),6e4);let s=this.file;const n={};if(t){const e=this.file.size-1;n["Content-Range"]=`bytes ${t}-${e}/${this.file.size}`,s=new File([this.file.slice(t,e+1)],this.file.name,{type:this.file.type})}const r=new XMLHttpRequest;r.open("PUT",this.upload_uri,!0),r.onerror=t=>{clearInterval(i),t&&console.error("upload error",t),this.handleUploadRetry(r.status,e)},r.onabort=()=>{clearInterval(i)},r.onload=async()=>{if(clearInterval(i),200!==r.status)return console.error(`xhr returned status ${r.status}, `,r),void this.handleUploadRetry(r.status,e);if(this.logProgress("Upload Finish Begins"),Array.isArray(this.onFinish)){for(const t of this.onFinish)await this.runInRetryLoop((async()=>await t(r,this.read_uri,this.file,this.layer,{retries:e})),7,"onFinish");this.logProgress("Upload Flow Succeeds")}else this.runInRetryLoop((()=>this.onFinish(r,this.read_uri,this.file,this.layer,{retries:e})),7,"onFinish",(()=>this.logProgress("Upload Flow Succeeds")))},r.upload.onprogress=e=>{const o=(t+e.loaded)/this.file.size;this.onProgress(o,this.file,this.layer),a=o},r.setRequestHeader("Content-Type",s.type),Object.entries(n).forEach((([e,t])=>{r.setRequestHeader(e,t)})),r.send(s),this.xhr=r})),i(this,"runInRetryLoop",(async(e,t,o,a)=>{let i="";for(let n=0;n<t;n+=1)try{return await e(),a&&a(),void(i="")}catch(s){console.error(s),i=s instanceof Error?s:ph(s).message;const e=2**Math.max(n,5)*1e3;await _P(e),console.debug(`Retrying (${n+1}) UploadManager stage ${o}`)}i&&this.logError(i,o)})),i(this,"waitForUserToBeOnline",(()=>new Promise((e=>{let t;const o=()=>{e(),clearTimeout(t)};window.addEventListener("online",o,{once:!0}),t=window.setTimeout((()=>{e(),window.removeEventListener("online",o)}),12e5)})))),i(this,"waitForNextUploadRetry",(async e=>{await _P(1e3);let t;if(navigator.onLine){const o=2**e,a=1e3*Math.max(15,Math.min(200,o));t=_P(a),this.otherRetries+=1}else this.logProgress("User is offline, waiting for network to reconnect"),t=this.waitForUserToBeOnline(),this.offlineRetries+=1;this.onRetry(this.layer,{retries:e+1,offlineRetries:this.offlineRetries,otherRetries:this.otherRetries}),await t;const o=5e3*Math.random();await _P(o)})),i(this,"handleUploadRetry",(async(e,t=0)=>{if(t<=1e3)return this.logProgress(`Upload Retry ${t}`),await this.waitForNextUploadRetry(t),void(0===e||503===e?this.resumeUploadToGCS(t+1):this.uploadToGCS({retry:t+1}));const o="An error occurred during upload. Please try again later.",a=new Error(o);this.logError(a,"handleUploadRetry"),this.onError(o,this.file,this.layer,"handleUploadRetry",!1)})),i(this,"resumeUploadToGCS",(e=>{const{upload_uri:t,read_uri:o}=this,a=new XMLHttpRequest;a.open("PUT",t,!0),a.onload=async t=>{if(308===t.target.status){this.logProgress("Upload Resumes"),console.debug("gcs returned 308, try resuming upload");const t=a.getResponseHeader("Range");if(!t)return console.debug("no range returned, try again"),void this.uploadToGCS({retry:e});const o=parseInt(t.split("-").pop(),10);if(o<0)return console.debug("Last uploaded byte < 0, try again from beginning"),void this.uploadToGCS({retry:e});const i=o+1;console.debug("Resuming upload, starting at byte ",o),this.uploadToGCS({startByte:i,retry:e})}else if(this.logProgress("Resumed Upload Finishes"),Array.isArray(this.onFinish)){for(const t of this.onFinish)await this.runInRetryLoop((async()=>await t(a,o,this.file,this.layer,{retries:e})),7,"onFinish");this.logProgress("Upload Flow Succeeds")}else this.runInRetryLoop((()=>this.onFinish(a,o,this.file,this.layer,{retries:e})),7,"onFinish/resumed",(()=>this.logProgress("Upload Flow Resumes and Succeeds")))},a.onerror=()=>{this.handleUploadRetry(a.status,e)},a.setRequestHeader("Content-Range",`bytes */${this.file.size}`),a.send(),this.xhr=a})),i(this,"cancel",(()=>{const{xhr:e}=this;e&&(e.abort(),this.onCancel())})),this.file=e,this.layer=t,this.bucket=o,this.isPrivate=a,this.onProgress=s,this.onFinish=n,this.onError=r,this.onCancel=l,this.onRetry=d,this.origin=c,this.uploadSourceComponent=m,this.useNameDirectly=p,this.analyticsUploadSource=h}}function bP(e){return e===Cl.Business}function TP(e,t){const o={};for(const[a,i]of Object.entries(Lc)){const s=a,{limit:n,dbKey:r}=i,l=n[e];if(void 0===l)continue;const d=(null==t?void 0:t[r])||0;if("number"!=typeof d)throw new Error("Invalid dbKey used in USAGE_LIMITS");const c=Math.max(l-d,0),u=c<=0,m=!u&&c/l<=.1,p=!u&&!m&&c/l<=.5;o[s]={is50PercentConsumed:p,is90PercentConsumed:m,hasConsumedLimit:u,usage:d,remainingUsage:c,limitForPlan:l}}return o}const xP=(e,t)=>e.filter((e=>e.teamId===t&&e.type===kn.team&&!e.sharedAt));function SP(e){var t;const{teams:o}=sr().state,{selectedTeamId:a}=o,i=_c(a);return null==(t=null==i?void 0:i.users)?void 0:t.find((t=>t.userId===e))}const EP=(e,t,o)=>{if(t&&o){const e=se.parse(o);if(!e.error&&e.sld){return`${e.sld.charAt(0).toLocaleUpperCase()+e.sld.toLocaleLowerCase().slice(1)} Team Workspace`}}return e?`${e}'s Team Workspace`:"Untitled Team Workspace"};function IP(e){return!!e&&e===kl.Admin}const CP=async(e,t)=>{const o=await(e=>new Promise((t=>{new wP({file:e,onFinish:async(e,o)=>{t(o)},onError:()=>t(null),layer:{},useNameDirectly:!0,analyticsUploadSource:"Team creation modal",uploadSourceComponent:"CreateNewTeamModal"}).upload()})))(e);return Jr(`/api/v2/teams/${t}/logo`,{body:{picture:o}})};function kP(e,t,o){const{config:a,currentUser:i,teams:s}=sr().state,{token:n,user:r}=i||{},{_id:l}=r||{},{selectedTeamId:d}=s;return Jr("/api/v1/invites/teams",{body:{emails:[e],token:n,userId:l,teamId:d,v3CaptchaToken:t,v2CaptchaToken:o,recaptchaKeyV3:a.RECAPTCHA_V3_SITEKEY,recaptchaKeyV2:a.RECAPTCHA_V2_SITEKEY}})}async function AP(e,t){await Jr(`/api/v2/teams/${e}/settings/invite-link`,{body:{enabled:t}}),Lp()}async function jP(e){return Jr(`/api/v1/team-invite-links/${e}/reset`)}const NP=async e=>{const{dispatch:t}=sr(),o={teamId:e},a=await Yr("/api/v1/invites/teams",{params:o});return t({type:"SET_ACTIVE_TEAM_INVITES",invites:a.invites}),a};async function RP(e){const{state:t,dispatch:o}=sr(),{currentUser:a,teams:i,workspaces:s}=t,{token:n,user:r}=a||{},{_id:l}=r||{},{allTeams:d}=i,c=e||EP(r.name);try{const{team:e,folder:t}=await Jr("/api/v1/teams/create",{body:{token:n,userId:l,name:c}});return o(kp([e,...d])),o(Ip(e._id)),o(ab([t,...s.allWorkspaces])),o(ib(t._id)),Fm(ym.CREATE_TEAM,{"Team ID":e._id,Email:a.user.email,"Name of Team":e.name}),e._id}catch(u){mh({description:"There was a problem creating your team. Please try again.",error:u})}return""}async function PP(e){const{state:t,dispatch:o}=sr(),a=Hu(t),i=null==a?void 0:a.limits;if((null==a?void 0:a._id)===vc._id||!a)return;const s=await Jr(`/api/v2/teams/${a._id}/limits/update`,{body:{updates:e}});o(jp(a._id,{...a,limits:s})),i&&function(e,t,o,a,i){var s,n,r;if(!bP(t))return;const l=TP(t,o),d=TP(t,a),c=[Oc.AI_GENERATE,Oc.TRANSCRIBE,Oc.TRANSLATE,Oc.TTS];for(const u of c){const t=d[u];t&&(!(null==(s=l[u])?void 0:s.hasConsumedLimit)&&t.hasConsumedLimit&&e(i?ym.TEAM_ENTERPRISE_USAGE_OUT:ym.ENTERPRISE_USAGE_OUT,{"Usage Category":u,"Usage Used":t.usage,"Usage Left":t.remainingUsage,"Percent of Limit Reached":100*t.usage/t.limitForPlan}),!(null==(n=l[u])?void 0:n.is90PercentConsumed)&&t.is90PercentConsumed&&e(i?ym.TEAM_ENTERPRISE_USAGE_CLOSE:ym.ENTERPRISE_USAGE_CLOSE,{"Usage Category":u,"Usage Used":t.usage,"Usage Left":t.remainingUsage,"Percent of Limit Reached":100*t.usage/t.limitForPlan}),!(null==(r=l[u])?void 0:r.is50PercentConsumed)&&t.is50PercentConsumed&&e(i?ym.TEAM_ENTERPRISE_USAGE_HALF:ym.ENTERPRISE_USAGE_HALF,{"Usage Category":u,"Usage Used":t.usage,"Usage Left":t.remainingUsage,"Percent of Limit Reached":100*t.usage/t.limitForPlan}))}}(Fm,a.planTier,i,s,!1)}function DP(e){const{state:t}=sr(),{allWorkspaces:o}=t.workspaces;for(const a of o)if(e===a._id)return a;return null}function OP(e){const{state:t}=sr(),{allWorkspaces:o}=t.workspaces;for(const a of o)if(a._id===e)return!0;return!1}async function LP(e){const{state:t}=sr(),{currentUser:o}=t,{token:a,user:i}=o||{},{_id:s}=i||{};if(!e)return console.error("No folder id passed to getCurrentUsersRole"),{};if(e===Vn)return{role:Bn.owner};const n=DP(e),r={token:a,userId:s,teamId:"",type:(null==n?void 0:n.type)??kn.personal,folderId:e};(null==n?void 0:n.teamId)&&"personal"!==n.teamId&&(r.teamId=n.teamId);try{return await Yr(`/api/v1/workspaces/${e}/getUser`,{params:r})}catch(IGe){return console.error(IGe),IGe}}function FP(e){const{dispatch:t}=sr();t(sb(e))}function MP(e){if(e===Vn)return"Shared with Me";const t=DP(e);return null==t?"":t.name||""}function UP(){const{dispatch:e}=sr();e(wl({description:"Your folder has been successfully deleted.",type:"success"}))}function BP(){var e,t;const{state:o}=sr(),{allWorkspaces:a}=o.workspaces,{allTeams:i}=o.teams,s=(null==(e=i[0])?void 0:e._id)||null;return(null==(t=xP(a,s)[0])?void 0:t._id)||""}function VP(e){var t;const{allWorkspaces:o}=sr().state.workspaces;return(null==(t=xP(o,e)[0])?void 0:t._id)||""}function WP(e){return e.teamId&&"personal"!==e.teamId&&e.type===kn.team}async function GP(e,t,o=""){const{dispatch:a,state:i}=sr(),{currentUser:n,teams:r,workspaces:l}=i,{allWorkspaces:d}=l,{selectedTeamId:c}=r,{token:u,user:m}=n||{},{_id:p}=m||{},h={token:u,userId:p,name:e||"Untitled Folder",type:t,teamId:o||c},{workspace:g}=await Jr("/api/v1/createWorkspace",{body:h});return a(ab([g,...d])),a(ib(g._id)),Fm(ym.CREATE_FOLDER,{Email:Ic(n),"Folder ID":g._id,"Team ID":o||c,"Folder Type":s.capitalize(kn[t])}),g}async function HP(e){return(await Yr(`/api/v1/workspaces/type/${e}`)).folderType}const $P=(e,t,o)=>{const a=e.assetIdByLayerId[o];if(e.assetIdByLayerId[o]=t,a&&e.layerIdsByAssetId[a]){const t=e.layerIdsByAssetId[a]||[];e.layerIdsByAssetId[a]=t.filter((e=>e!==o))}const i=e.layerIdsByAssetId[t];i?i.push(o):e.layerIdsByAssetId[t]=[o]},KP=(e,t,o)=>{if(t.asset_id){const a=t.asset_id;$P(e,a,o)}},zP=(e,t,o)=>{if(o&&(e.assetIdByLayerId[t]&&delete e.assetIdByLayerId[t],e.layerIdsByAssetId[o])){const a=e.layerIdsByAssetId[o]||[];e.layerIdsByAssetId[o]=a.filter((e=>e!==t))}},YP=v({initialState:{byId:{},estimatedDurationsById:{},layerIdsByAssetId:{},assetIdByLayerId:{},assetWaveformData:{}},name:"assets",reducers:{addEstimatedDuration:(e,t)=>{e.estimatedDurationsById[t.payload.assetId]=t.payload.duration},assetsFetched:(e,t)=>{for(const o of t.payload)e.byId[o._id]=o},updateAsset:(e,t)=>{const o=e.byId[t.payload.assetId];o&&(e.byId[t.payload.assetId]={...o,...t.payload.update})},updateAssetWaveformData:(e,t)=>{e.assetWaveformData[t.payload.assetId]={...e.assetWaveformData[t.payload.assetId],...t.payload.update}},updateAssetIdOnLayers:(e,t)=>{const{assetId:o,layerIds:a}=t.payload;a.forEach((t=>{$P(e,o,t)}))}},extraReducers:e=>{e.addCase(nN,((e,t)=>{t.payload.forEach((t=>{const o=e.byId[t.assetId];if(o){o.transcriptionIds||(o.transcriptionIds={});const e=o.transcriptionIds[t.languageKey];if("pending"===t.status.state)o.transcriptionIds[t.languageKey]={job:t.status.transcriptionId};else if("completed"===t.status.state){if(!e)throw new Error("Completed transcription without pending transcription");e.result=t.status.assetTranscriptionId}}}))})),e.addCase("SET_STUDIO",((e,t)=>{if(!t.studio.scenes||!t.studio.scenes[0])return;const{layers:o}=t.studio.scenes[0],a={},i={};for(const s of o)s.asset_id&&(a[s.id]=s.asset_id,i[s.asset_id]||(i[s.asset_id]=[]),i[s.asset_id].push(s.id));e.assetIdByLayerId=a,e.layerIdsByAssetId=i})),e.addCase("ADD_LAYERS",((e,t)=>{t.layers.forEach((t=>{if(!t.asset_id)return;e.assetIdByLayerId[t.id]=t.asset_id;const o=e.layerIdsByAssetId[t.asset_id];o?o.includes(t.id)||o.push(t.id):e.layerIdsByAssetId[t.asset_id]=[t.id]}))})),e.addCase("ADD_LAYERS_AT_INDEXES",((e,t)=>{t.layerIndexPairs.forEach((({layer:t})=>{if(!t.asset_id)return;e.assetIdByLayerId[t.id]=t.asset_id;const o=e.layerIdsByAssetId[t.asset_id];o?o.includes(t.id)||o.push(t.id):e.layerIdsByAssetId[t.asset_id]=[t.id]}))})),e.addCase("REMOVE_LAYER",((e,t)=>{zP(e,t.layer.id,t.layer.asset_id)})),e.addCase("REMOVE_LAYERS",((e,t)=>{t.layers.forEach((t=>{zP(e,t.id,t.asset_id)}))})),e.addCase("UPDATE_LAYER",((e,t)=>{KP(e,t.properties,t.layer.id)})),e.addCase("UPDATE_LAYERS",((e,t)=>{Object.entries(t.updates).forEach((([t,o])=>{KP(e,o,t)}))}))}}),{assetsFetched:JP,updateAsset:qP,updateAssetWaveformData:XP,updateAssetIdOnLayers:QP}=YP.actions,ZP=YP.actions;function eD(e,t={}){if(e.layers)return e;const o={...t,scenes:[]};for(const a in e)if(!a.startsWith("scene_")&&!a.startsWith("layer_")&&!["scenes","layers"].includes(a)&&"lastUpdatedByPOST"!==a)if("allLayers"===a){const t=s.cloneDeep(e.allLayers);(null==t?void 0:t.byId)&&Object.values(t.byId).forEach((e=>{delete e.local_url})),o.allLayers=t}else o[a]=e[a];return"scenes"in e&&(o.scenes=e.scenes.map((t=>{const o=[...new Set(e[`scene_${t}_layers`]||[])];return{...e[`scene_${t}`],layers:o.filter((t=>null!=e[`layer_${t}`])).map((t=>e[`layer_${t}`])).map((e=>(delete e.local_url,e)))}}))),s.cloneDeep(o)}function tD(){const{teams:e}=sr().state,{allTeams:t,selectedTeamId:o}=e;return!(0===t.length||!o)&&t.some((e=>e._id===o))}async function oD(e,t){const o={teamId:e,fromVideoId:t};try{await Jr("/api/v1/requests/teams",{body:o})}catch(IGe){mh({description:"Failed to request to join team",error:IGe})}}var aD=(e=>(e.ACCEPT="accept",e.REJECT="reject",e))(aD||{});async function iD(e,t,o){try{return await qr(`/api/v1/requests/teams/${o}/${e}`,{body:{teamId:t}})}catch(IGe){mh({description:`Failed to ${o} team request`,error:IGe})}}async function sD(e){try{const{name:t,_id:o}=await Yr(`/api/v2/teams/teamIdAndName/${e}`);return{name:t,teamId:o}}catch(IGe){console.error(IGe)}return{}}async function nD(){const{state:e}=sr();if(!wc(e.currentUser))return[];let t;try{t=(await Yr(`/api/v1/requests/userId/pending/${e.currentUser.user._id}`)).requests}catch(IGe){console.error(IGe)}return t}const rD=(e,t)=>{if(!$c(e.planTier).isPaid)return 0;const o=e.users.length;return Math.max(0,t.quantity-o)};const lD=e=>{const{state:t}=sr(),{workspaces:{allWorkspaces:o}}=t;return o.find((t=>t._id===e))};async function dD(){const{dispatch:e}=sr(),t=km();if(t)if(["gmail.com","hotmail.com","yahoo.com"].includes(t))e(gb({teams:[],isQualifiedDomain:!1}));else try{const t=await Jr("/api/v2/teams/suggested");t&&e(gb(t))}catch(IGe){console.error(IGe,"There was an error while fetching suggested workspaces.")}}function cD({video:e,source:t,preserveId:o=!1,preserveStudioTime:a=!1,origin:i=!1,undoable:s=!1,sync:n=!1,isFirstVideoLoad:r}){const{state:{studio:{_id:l}}}=sr();return{type:"SET_STUDIO",source:t,studio:e,preserveId:o,preserveStudioTime:a,projectIdChanged:!!l&&l!==e._id,origin:i,undoable:s,sync:n,isFirstVideoLoad:r}}function uD(){return{type:"RESET_STUDIO"}}const mD=(e,t)=>({type:"LINK_CML_FILE_TO_PROJECT",assetId:e.asset_id,cmlFileId:e.id,videoId:t}),pD=(e,t)=>({type:"UNLINK_CML_FILE_FROM_PROJECT",cmlFileId:e,videoId:t});class hD{constructor(){i(this,"first",!0),i(this,"amIFirst",(()=>!!this.first&&(this.first=!1,!0)))}}function gD(){return{type:"KAPWING_INIT"}}function fD(e){return{type:"SET_CURRENT_VIDEO",video:e}}function yD(e){return{type:"UPDATE_CURRENT_VIDEO",videoUpdates:e}}function vD(e){return{type:"SET_VIDEO_JUST_SAVED",justSaved:e}}function _D(e){return{type:e?"SET_VIDEO_SAVING":"CLEAR_VIDEO_SAVING"}}function wD(){return{type:"RESET_CURRENT_VIDEO"}}async function bD(e){try{return await Yr("/api/v1/teamFolders",{params:e})}catch(IGe){return console.error(IGe),[]}}async function TD(e){return await Yr("/api/v1/workspaces",{params:e})}async function xD(e="",t=!1){var o;const{dispatch:a,state:i}=sr(),{currentUser:s,teams:n,workspaces:r}=i,{allTeams:l,selectedTeamId:d}=n,{allWorkspaces:c}=r,{token:u,user:m}=s||{};let p,h=e;if(t)p=t;else if(e===Vn)a(ib(Vn));else if(e&&function(e,t,o){if(!o.length||!t.length)return!1;const a=o.find((t=>t._id===e));if(!a)return!1;const i=a.teamId;return!!i&&!!t.find((e=>e._id===i))}(e,l,c)){p=d;const t=lD(e);(null==t?void 0:t.type)===kn.personal&&(null==t?void 0:t.creatorId)!==m._id&&(h="")}else p=(null==(o=l[0])?void 0:o._id)??"",h="";"personal"===p&&(p="");const g={token:u,teamId:p},[f,y]=await Promise.all([bD(g),TD(g)]);if(h!==Vn&&f.length>0){const e=[...f,...y];if(a(ab(e)),!h&&f[0]){const e=VP(p||f[0].teamId);return a(Ip(p||f[0].teamId)),a(ib(e)),e}a(ib(h));const t=lD(h);return t&&a(Ip(t.teamId)),h}const v=[...f||[],...y];if(a(ab(v)),!h){const e=BP();return a(ib(e)),e}return h}function SD(e){const{token:t,user:o}=sr().state.currentUser||{};return Jr(`/api/v1/admin/${e}/operations`,{params:{token:t,userId:o&&o._id}})}function ED(e){return{id:e.id,type:e.type}}function ID(e,t,o,a){var i,s,n,r;try{if(!(e._id&&t._id&&String(e._id)===String(t._id)))return;const l=(null==(s=null==(i=e.scenes)?void 0:i[0])?void 0:s.layers)||[],d=(null==(r=null==(n=t.scenes)?void 0:n[0])?void 0:r.layers)||[],c=l.length,u=d.length,m=u-c;0!==c&&c!==u&&Math.abs(m)>=a&&(f("Potential mongodb/sharedb conflict",{extra:{currentLayerLen:c,newLayerLen:u,currentLayers:JSON.stringify(l.map(ED)),newLayers:JSON.stringify(d.map(ED)),currentVideo:e,newVideo:t,source:o,__FORCE_SAMPLE:!0},tags:{overwriteSource:o}}),pu("Potential lost work",{currentLayerLen:c,newLayerLen:u}),Fm(ym.POTENTIAL_LOST_WORK,{currentLayerLen:c,newLayerLen:u,diff:m,overwriteSource:o}))}catch(l){console.error(l),R(l)}}function CD({video:e,source:t,dispatch:o,preserveId:a,preserveStudioTime:i=!1,sync:s=!1,isFirstVideoLoad:n,undoable:r=!1}){if(e.isCreator||e.isStudio){const{state:l}=sr();o(cD({video:e,source:t,preserveId:a,preserveStudioTime:i,sync:s,origin:l.studio.origin,undoable:r,isFirstVideoLoad:n}))}return a||(delete e._id,e.studio&&delete e.studio._id),o(fD(e)),n&&e.scenes&&(async function(e){const t=new Set;if(e.scenes.forEach((e=>{e.layers.every((e=>{var o;return"text"===e.type||(null==(o=e.usedProFeatures)?void 0:o.includes("text-to-speech"))||e.asset_id&&!e.cmlFileId&&t.add(e.asset_id),!0}))})),!t.size)return;const o=Array.from(t.values()),{assets:a,cml_files:i}=await $b(o,!1),{dispatch:s,state:n}=sr();g.batch((()=>{s(JP(a)),s(Nb(i));const t=gk(n),o={};var r;i.forEach((e=>{for(const a of t)a.asset_id===e.asset_id&&(o[a.id]={cmlFileId:e.id})})),s((r=e._id,{type:"LINK_CML_FILES_TO_PROJECT",cmlFiles:i,videoId:r})),OI(o,"initializeCMLFilesForOldProjectIfNeeded",!1)}))}(e),function(e){const{dispatch:t,state:{mediaCache:o}}=sr();g.batch((()=>{const a=[],i=[];e.scenes.forEach((e=>{e.layers.every((e=>{if(!e.asset_id)return!0;if(o.assetIdToMediaCacheId[e.asset_id])return!0;const t=P();return a.push({assetId:e.asset_id,mediaCacheId:t}),e.uploadId&&i.push({uploadId:e.uploadId,mediaCacheId:t}),!0}))})),t(vu(a)),t(wu(i))}))}(e)),e}async function kD(e){return(await Yr(`/api/v1/videoname/${e}`)).projectName}async function AD({id:e,preserveId:t=!1,preservePreviousId:o=!1,forEditing:a=!1,fetchDraft:i=!1,forDebugPage:s=!1,forTemplate:n=!1,undoable:r=!1,sync:l=!1,fromBrandTemplate:d="",projectIsBrandTemplate:c=!1}){const{dispatch:u}=sr(),m=await jD({dispatch:u,id:e,forDebugPage:s,restoreAndReturnAssets:a,forTemplate:n,fetchDraft:i,forEditing:a});if(!m)throw new Error("Video object undefined while fetching video");d&&(m.isBrandKitTemplate=null,m.fromBrandKitTemplate=d),c&&(m.isBrandKitTemplate="published");return RD({dispatch:u,video:m,fetchDraft:i,forTemplate:n,preserveId:t,preservePreviousId:o,sync:l,firstTracker:new hD,undoable:r})}async function jD({dispatch:e,id:t,forDebugPage:o,restoreAndReturnAssets:a,forEditing:i,forTemplate:s,fetchDraft:n,cancellationSource:r}){const{state:l}=sr(),{token:d,user:c}=l.currentUser||{},u={restoreAndReturnAssets:a,editing:i,fetchCMLFiles:!0,fetchDraft:n,id:t,supportedVersion:"0.9",token:d,userId:c&&c._id};s&&(u.forTemplate=!0),o&&(u.forDebugPage=!0);const{assets:m,assetTranscriptions:p,cmlFiles:h,video:g}=await Yr("/api/v1/videos/getVideo_v2",{params:u,retries:3});if(r&&r.cancelled)return null;if(g.creatorId&&!g.creatorEmail&&d){const e={id:g.creatorId};try{const{user:t}=await Yr("/api/v1/users/getUserById",{params:e});g.creatorEmail=t.email}catch(f){console.error("Could not get user by id",f)}}if(m&&e(JP(m)),h&&e(Nb(h)),p){const t=[];for(const e of p)"asset_transcription"===e.type?t.push({assetId:e.assetId,languageKey:e.languageKey,status:{assetTranscriptionId:e.assetTranscription._id,state:"completed",languageKey:e.languageKey,words:e.assetTranscription.words,job_params:e.assetTranscription.job_params}}):t.push({assetId:e.assetId,languageKey:e.languageKey,status:{assetDuration:e.assetDuration,assetId:e.assetId,transcriptionId:e.transcriptionJob._id,progress:e.transcriptionJob.progress,languageKey:e.languageKey,state:"pending"}});e(nN(t))}return g}async function ND(e,t){if(e)try{const o=await Yr(`/api/v1/videos/${e}/comments`);o&&t(qb(o))}catch(IGe){mh({description:"Failed to load comments",error:IGe})}t(Zb(!1))}function RD({dispatch:e,video:t,fetchDraft:o,forTemplate:a,preserveId:i,preservePreviousId:s,sync:n=!1,firstTracker:r,undoable:l}){var d,c,u,m;const{state:p}=sr();if(s&&(t._id=p.studio._id,t.projectId=p.studio.projectId),o){const o=eD(t,{_id:t._id});return a||ID(p.studio,o,"Get Video Sync",1),CD({video:o,source:"getVideoSharedDoc",dispatch:e,preserveId:i||s,sync:n,isFirstVideoLoad:r.amIFirst(),undoable:l})}return a?(t.workspaceId=p.workspaces.selectedWorkspace,t.creatorId=null==(c=null==(d=p.currentUser)?void 0:d.user)?void 0:c._id,t.creatorEmail=null==(m=null==(u=p.currentUser)?void 0:u.user)?void 0:m.email,t.name&&(t.projectName=t.name),t.teamId=p.teams.selectedTeamId):ID(p.studio,t,"Get Video No Sync",1),CD({video:t,source:"getVideo",dispatch:e,preserveId:i||s,sync:n,isFirstVideoLoad:r.amIFirst(),undoable:l})}class PD{constructor(e){i(this,"frame"),i(this,"fps"),i(this,"q"),i(this,"size"),i(this,"time"),i(this,"bitrate"),i(this,"speed");const t=e.match(/frame=\s*([0-9]*)\s*fps=\s*([0-9.]*)\s*q=([0-9.]*)\s*size=\s*([0-9]*).*time=([0-9:.]*).*bitrate=\s*([0-9.]*)kbits\/s\s*(.*)speed=([0-9.]*)/);if(!t)return;const[o,a,s,n,r,l,d,c]=t;this.frame=parseInt(a??""),this.fps=parseInt(s??""),this.q=parseInt(n??""),this.size=parseInt(r??"");const[u=0,m=0,p=0]=(l??"").split(":").map((e=>parseInt(e)));this.time={hours:u,minutes:m,seconds:p},this.bitrate=parseFloat(d??""),this.speed=parseFloat(c??"")}}function DD(e,t){const o=e._malloc(t.length*Uint32Array.BYTES_PER_ELEMENT);return t.forEach(((t,a)=>{const i=function(e,t){const o=e._malloc((t.length+1)*Uint8Array.BYTES_PER_ELEMENT);for(let a=0;a<t.length;a+=1)e.setValue(o+a,t.charCodeAt(a),"i8");return e.setValue(o+t.length,0,"i8"),o}(e,t);e.setValue(o+4*a,i,"i32")})),o}function OD(e){const t=[];let o=0,a=0;for(;(o=e.indexOf(" ",a))>=0;){let i=e.substring(a,o),s=i.indexOf("'"),n=i.indexOf('"');if(0===s||0===n){const s=i[0];if(!s)throw Error("Missing delimiter");const n=e.indexOf(s,a+1);if(n<0)throw new Error(`Bad command escape sequence ${s} near ${o}`);i=e.substring(a+1,n),a=n+2,t.push(i)}else if(s>0||n>0){-1===s&&(s=1/0),-1===n&&(n=1/0);const r=s<n?"'":'"',l=Math.min(s,n),d=e.indexOf(r,a+l+1);if(d<0)throw new Error(`Bad command escape sequence ${r} near ${o}`);i=e.substring(a,d+1),a=d+2,t.push(i)}else""!==i?(t.push(i),a=o+1):a=o+1}return a!==e.length&&t.push(e.substring(a)),t}class LD{constructor(){if(i(this,"moduleFactory"),i(this,"instance"),i(this,"ffmpegMain"),i(this,"FS"),i(this,"duration"),i(this,"defaultArgs",["./ffmpeg","-nostdin","-hide_banner"]),i(this,"currLog"),i(this,"currLogProxy"),i(this,"logs",[]),i(this,"logsProxy",[]),i(this,"allMessages",[]),i(this,"lastFFmpegStdout"),!window||!window.createModule)throw new Error("createModule does not exist on window. Ensure that ffmpeg-core.js      is included via a script tag, and that it exports a createModule function.");this.moduleFactory=window.createModule()}logInDev(e){(window.location.href.includes("kapwing-dev")||window.location.href.includes("localhost"))&&console.debug(e)}abort(){}isSupportedByClient(){const e=(new D.UAParser).getBrowser();return!!(navigator.hardwareConcurrency>=4&&e.name.startsWith("Chrome")&&parseFloat(e.version)>=74)}modulePromise(){return new Promise((e=>this.moduleFactory.then((t=>{delete t.then,e(t)}))))}async initialize(e){try{this.instance||(this.instance=await this.modulePromise())}catch(IGe){if(IGe instanceof Error)throw IGe;const{message:t}=ph(IGe);throw new Error(t)}this.ffmpegMain=this.instance.cwrap("proxy_main","number",["number","number"]),this.FS=this.instance.FS,this.instance.setLogger((t=>{let o;if(!this.duration){const e=/Duration:\s*([0-9][0-9]:[0-9][0-9]:[0-9][0-9]\.[0-9][0-9])/,o=t.message.match(e);o&&o[1]&&(this.duration=o[1])}if(new PD(t.message).frame){if(this.allMessages.length>0){const e=t.message.replace(this.lastFFmpegStdout,"");this.allMessages.push(e),o=e}else this.allMessages.push(t.message),o=t.message;this.lastFFmpegStdout=t.message}const a=()=>{const{dispatch:e}=sr();e(yD({progressText:this.allMessages.join("\n")}))};function i(e){const[t,o,a]=e.split(":");return 60*parseFloat(t??"0")*60+60*parseFloat(o??"0")+parseFloat(a??"0")}if(this.allMessages.length>0&&this.allMessages.length%5==0&&a(),this.logsProxy.push(t),this.currLog=t,this.currLogProxy&&(this.currLogProxy.currLog=t),o&&o.startsWith("frame")){const t=i(o.split("time=")[1].split(" ")[0]??""),a=i(this.duration);this.logInDev({progress:t/a}),e&&e(t/a)}else o&&o.startsWith("video:")&&(this.logInDev({progress:1}),e&&e(1))}))}async runCommandOnFile(e,t,o,a="output.mp4"){this.logInDev(e),o=o.replaceAll(" ","");try{void 0===this.instance&&await this.initialize(),await this.writeFile(o,t);const e=this.readVideoFile(a);return this.logInDev(URL.createObjectURL(e)),this.FS.unlink(o),this.FS.unlink(a),e}catch(IGe){if(IGe instanceof Error)throw IGe;const{message:t}=ph(IGe);throw new Error(t)}}async run(e){const t=Date.now(),o=[...this.defaultArgs,...OD(e)].filter((e=>0!==e.length)),a=DD(this.instance,o);return new Promise(((e,i)=>{const s={set(o,a,s){if(o[a]=s,"ffmpeg-stdout"===s.type&&"FFMPEG_END"===s.message){if("Conversion failed!"===o[o.length-2].message){const e=()=>{let e="";return e+=`1)${o[o.length-5].message}\n2)${o[o.length-4].message}\n3)${o[o.length-3].message}`,e},a={timeToError:(Date.now()-t)/1e3,message:o.length>=5?e():"Unable to get error messages."};i(a)}else e((Date.now()-t)/1e3)}return!0}};this.logsProxy=new Proxy(this.logs,s),this.ffmpegMain(o.length,a)}))}readVideoFile(e){const t=this.FS.readFile(e);return new File([t.buffer],e,{type:"video/mp4"})}async writeFile(e,t){if(t instanceof File||t instanceof Blob){const o=await t.arrayBuffer(),a=new Uint8Array(o);this.FS.writeFile(e,a)}else if(t.startsWith("blob:")){const o=await fetch(t).then((e=>e.blob())),a=await o.arrayBuffer(),i=new Uint8Array(a);this.FS.writeFile(e,i)}else{const o=await fetch(t),a=await o.arrayBuffer(),i=new Uint8Array(a);this.FS.writeFile(e,i)}}}const FD={ffmpegStatus:void 0,outputFile:void 0,outputFileUrl:void 0,progress:void 0},MD=O("updateProgress"),UD=O("resetState"),BD=v({name:"ffmpegProcessor",initialState:FD,reducers:{updateTranscodeStatus:(e,t)=>{e.ffmpegStatus=t.payload.status,"FULFILLED"===t.payload.status&&(e.outputFile=t.payload.outputFile,e.outputFileUrl=URL.createObjectURL(t.payload.outputFile))}},extraReducers:e=>{e.addCase(MD,((e,t)=>{e.progress=t.payload})),e.addCase(UD,(()=>FD))}}),{reducer:VD}=BD;var WD=(e=>(e.SHOW_CONTEXT_MENU="SHOW_CONTEXT_MENU",e.HIDE_CONTEXT_MENU="HIDE_CONTEXT_MENU",e))(WD||{});function GD(){return{type:"HIDE_CONTEXT_MENU"}}const HD={collections:(e=[],t)=>{switch(t.type){case"SET_COLLECTIONS":return t.collections;case"RESET_EDITOR":return[];default:return e}},currentCollection:(e={},t)=>"SET_CURRENT_COLLECTION"===t.type?t.currentCollection:e,infoForSelectedCollectionLetter:(e={letter:"",count:0},t)=>"SET_NUM_COLLECTIONS_FOR_LETTER"===t.type?{letter:t.letter,count:t.count}:e},$D="controls";var KD=(e=>(e.Project="project",e.Timing="timing",e.Versions="versions",e))(KD||{});const zD=v({initialState:{},name:"selectedTabs",reducers:{selectTab:(e,t)=>{t.payload.tabId?e[t.payload.tabContainerId]=t.payload.tabId:delete e[t.payload.tabContainerId]}},extraReducers:e=>e.addCase("SELECT_ITEM",((e,t)=>{t.item&&(e.controls=KD.Project)}))}),{selectTab:YD}=zD.actions,JD={attempted:{http:null,websocket:null},firstAttemptSinceLastSuccess:{http:null,websocket:null},succeeded:{http:null,websocket:null}},qD=()=>({assetMonitorId:"",assetTempValues:{},boxSelectedIds:{},commandIsBeingPressed:!1,controlIsBeingPressed:!1,dragPreviewDisplacements:{},trackIsDragging:!1,ghostTimeOffsets:null,idbAssetIds:null,initialIDBAssetIdLoadDone:!1,isNewProject:!1,isProjectFetched:!1,layerTempValues:{},localProjectId:oe.v4(),mediaItemDropLocation:null,mediaItemGhostTrack:null,mediaSidebarSelectedTab:"thisProject",mouseState:null,selectedEditorPane:"timeline",shiftIsBeingPressed:!1,showSignIn:!1,showTranscribe:!1,studioDragDropActive:!1,mainStudioDragDropDisabled:!1,textLayerIDsAddedInSession:[],thumbnailTrackFallbacks:{},volumeSliderIsDragging:!1,infoToastShownThisSession:!1,trimPreviewPlaying:!1,rowUploadInProgress:!1,awaitingRecordings:null,staticUploadIds:[],groupDragOverrides:{},lastSyncedWithServer:JD,lastSyncedUserFacing:null,isLayerMountedByLayerId:{},isAdding:{},playbackRate:1,magicSubtitlesGlobal:{},magicSubtitleSelection:null,magicSubtitleFocusedNdx:void 0,mediaBarWidth:390,isResizingMediaBar:!1,lastThumbnailGenerated:null,showReportIssueModal:!1,magicSubtitleFramesByAsset:{},ai:{},articleToVideo:{url:"",ogTags:{},markdown:"",markdownImages:[],outline:[],originalOutline:[]}});function XD(e){for(const t in e)delete e[t];Object.assign(e,qD())}function QD(e,t,o){e.layerTempValues[t]||(e.layerTempValues[t]={readyForTrackComponentRender:!1});const a=e.layerTempValues[t];if(a)for(const[i,s]of Object.entries(o))if(s!==a[i])return void Object.assign(a,o)}const ZD=ne(qD(),{SET_STUDIO:(e,t)=>{t.isFirstVideoLoad&&(e.initialProjectLoadAt=Date.now()),e.lastSyncedWithServer=JD},RESET_STUDIO:e=>{XD(e)},RESET_STATE_PRESERVE_USER:e=>{XD(e)},[d_.SET_LOCAL_LAYER_VALUES]:(e,t)=>{QD(e,t.layerId,t.properties)},[d_.BATCHED_SET_LOCAL_LAYER_VALUES]:(e,t)=>{Object.entries(t.updates).forEach((([t,o])=>{QD(e,t,o)}))},[d_.SET_IS_INLINE_CROPPING]:(e,t)=>{const{layerTempValues:o}=e;Object.keys(o).forEach((e=>{o[e]||(o[e]={});const a=o[e];a&&(a.isBeingInlineCropped=null,e===t.layerId&&(a.isBeingInlineCropped=t.isInlineCropping))}))},[d_.SET_PROJECT_FETCHED]:e=>{e.isProjectFetched=!0},[d_.CLEAR_PROJECT_FETCHED]:e=>{e.isProjectFetched=!1},[d_.SET_SHOW_TRANSCRIBE]:(e,t)=>{e.showTranscribe=t.showTranscribe},[d_.SET_SNAP_TIMELINE_TO_SEEKER]:(e,t)=>{e.snapTimelineToSeeker=t.snapTimelineToSeeker},[d_.SET_STUDIO_DRAG_DROP_ACTIVE]:(e,t)=>{e.studioDragDropActive=t.studioDragDropActive},[d_.SET_MAIN_STUDIO_DRAG_DROP_DISABLED]:(e,t)=>{e.mainStudioDragDropDisabled=t.mainStudioDragDropDisabled},[d_.SET_SELECTED_EDITOR_PANE]:(e,t)=>{e.selectedEditorPane=t.selectedEditorPane},[d_.SET_VOLUME_SLIDER_IS_DRAGGING]:(e,t)=>{e.volumeSliderIsDragging=t.isDragging},[d_.SET_MEDIA_ITEM_GHOST_TRACK]:(e,t)=>{e.mediaItemGhostTrack=t.track},[d_.SET_MEDIA_ITEM_LOCATION]:(e,t)=>{e.mediaItemDropLocation=t.location},[d_.ADD_IDB_ASSET_IDS]:(e,t)=>{const o=new Set(t.idbAssetIds),a=new Set(e.idbAssetIds),i=new Set([...o,...a]);e.idbAssetIds=Array.from(i)},[d_.REMOVE_IDB_ASSET_ID]:(e,t)=>{const o=(e.idbAssetIds||[]).filter((e=>e!==t.idbAssetId));e.idbAssetIds=o},[d_.CLEAR_IDB_ASSET_IDS]:e=>{e.idbAssetIds=[]},[d_.SET_DRAGGED_TRACKS_OVERRIDES]:(e,t)=>{s.isEmpty(t.overrides)&&s.isEmpty(e.draggedTracksOverrides)||(e.draggedTracksOverrides=t.overrides)},[d_.COMMAND_IS_BEING_PRESSED]:(e,t)=>{e.commandIsBeingPressed=t.isPressed},[d_.CONTROL_IS_BEING_PRESSED]:(e,t)=>{e.controlIsBeingPressed=t.isPressed},[d_.SHIFT_IS_BEING_PRESSED]:(e,t)=>{e.shiftIsBeingPressed=t.isPressed},[d_.SET_TRACK_THUMBNAIL_FALLBACK]:(e,t)=>{e.thumbnailTrackFallbacks[t.mediaCacheId]=!0},[d_.SET_INITIAL_IDB_ASSET_ID_LOAD_DONE]:e=>{e.initialIDBAssetIdLoadDone=!0},[d_.SET_IS_NEW_PROJECT]:e=>{e.isNewProject=!0},[d_.START_EDITING_TEXT_LAYER]:(e,t)=>{QD(e,t.payload.id,{isEditing:!0,textTemp:t.payload.text})},[d_.SET_MEDIA_SIDEBAR_SELECTED_TAB]:(e,t)=>{e.mediaSidebarSelectedTab=t.payload},[d_.ADD_TEXT_LAYER_ID_ADDED_IN_SESSION]:(e,t)=>{const o=new Set([...e.textLayerIDsAddedInSession,t.id]);e.textLayerIDsAddedInSession=Array.from(o)},[d_.SET_MOUSE_DOWN]:(e,t)=>{e.mouseState=t.payload},[d_.CLEAR_DRAG_PREVIEW_DISPLACEMENTS]:e=>{e.dragPreviewDisplacements={}},[d_.SET_DRAG_PREVIEW_DISPLACEMENTS]:(e,t)=>{e.dragPreviewDisplacements={...e.dragPreviewDisplacements,...t.payload}},[d_.SET_INFO_TOAST_SHOWN_THIS_SESSION]:(e,t)=>{e.infoToastShownThisSession=t.payload},[d_.SET_PREVIEW_PLAYING]:(e,t)=>{e.previewPlaying=t.payload},[d_.SHOW_SIGN_IN]:e=>{e.showSignIn=!0},[d_.HIDE_SIGN_IN]:e=>{e.showSignIn=!1},[d_.SET_ROW_UPLOAD_IN_PROGRESS]:(e,t)=>{e.rowUploadInProgress=t.payload},[d_.SET_AWAITING_RECORDINGS]:(e,t)=>{e.awaitingRecordings={...e.awaitingRecordings,...t.payload},"string"==typeof e.awaitingRecordings.screen&&"string"==typeof e.awaitingRecordings.video&&(e.awaitingRecordings=null)},[d_.SET_PREVIEW_TRACK]:(e,t)=>{e.previewTrack=t.payload},[d_.SET_PREVIEW_TIMELINE_STATE]:(e,t)=>{t.timelineState?e.previewTimelineState?e.previewTimelineState={...e.previewTimelineState,...t.timelineState}:e.previewTimelineState={pxInSecond:0,timelineWidth:0,scrollLeft:0,...t.timelineState}:e.previewTimelineState=void 0},[d_.SET_GHOST_SEEKER_OFFSET]:(e,t)=>{e.ghostTimeOffsets=t.payload},[d_.SET_STATIC_UPLOAD_IDS]:(e,t)=>{e.staticUploadIds=t.payload},[d_.SET_MOBILE_TRAY_CONTENT]:(e,t)=>{e.mobileTrayContent=t.payload},[d_.SET_BOX_SELECTED_IDS]:(e,t)=>{e.boxSelectedIds=t.payload},[d_.SET_GROUP_DRAG_OVERRIDES]:(e,t)=>{e.groupDragOverrides[t.payload.groupId]=t.payload.overrides},[d_.CLEAR_GROUP_DRAG_OVERRIDES]:(e,t)=>{delete e.groupDragOverrides[t.payload]},[d_.SYNC_ATTEMPTED]:(e,t)=>{const o=Date.now();e.lastSyncedWithServer.attempted[t.payload]=o;const a=e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload],i=e.lastSyncedWithServer.succeeded[t.payload];(!a||i&&i>a)&&(e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload]=o)},[d_.SYNC_SUCCEEDED]:(e,t)=>{const o=Date.now();e.lastSyncedWithServer.succeeded[t.payload]=o,e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload]=null,e.lastSyncedUserFacing=o},[d_.SET_IS_ADDING]:(e,t)=>{Object.prototype.hasOwnProperty.call(e.isAdding,t.payload)?e.isAdding[t.payload]=!e.isAdding[t.payload]:e.isAdding[t.payload]=!0},[d_.PLAYBACK_RATE]:(e,t)=>{e.playbackRate=t.payload},[d_.CLEAR_MAGIC_SUBTITLE_LOCAL]:e=>{e.magicSubtitlesGlobal={}},[d_.UPDATE_MAGIC_SUBTITLE_LOCAL]:(e,t)=>{const{updates:o}=t.payload,a=e.magicSubtitlesGlobal;o.position&&(a.position={...a.position,...o.position}),o.style&&(a.style={...a.style,...o.style}),o.preset&&(""===o.preset.presetId?a.preset=void 0:a.preset=o.preset),o.wordByWordAnimations&&(a.wordByWordAnimations={...a.wordByWordAnimations,...o.wordByWordAnimations}),o.transitionDuration&&(a.transitionDuration=o.transitionDuration),o.transitionOverlapDuration&&(a.transitionOverlapDuration=o.transitionOverlapDuration),o.transitionSpeed&&(a.transitionSpeed=o.transitionSpeed)},[d_.SET_MAGIC_SUBTITLE_SELECTION]:(e,t)=>{e.magicSubtitleSelection=t.payload},[d_.SET_MAGIC_SUBTITLE_FOCUS]:(e,t)=>{e.magicSubtitleFocusedNdx=t.payload},UPDATE_MAGIC_SUBTITLE:(e,{updates:t})=>{const o=e.magicSubtitlesGlobal;o&&(t.position&&delete o.position,t.style&&delete o.style,t.preset&&delete o.preset,t.wordByWordAnimations&&delete o.wordByWordAnimations,t.transitionDuration&&delete o.transitionDuration,t.transitionOverlapDuration&&delete o.transitionOverlapDuration,t.transitionSpeed&&delete o.transitionSpeed)},[d_.SET_LOCAL_MAGIC_SUBTITLE_FRAMES]:(e,t)=>{null!==t.payload.frames?e.magicSubtitleFramesByAsset[t.payload.assetId]={byId:t.payload.frames}:e.magicSubtitleFramesByAsset[t.payload.assetId]=void 0},[d_.RESIZE_MEDIABAR]:(e,t)=>{e.mediaBarWidth=t.payload},[d_.RESIZING_MEDIABAR]:(e,t)=>{e.isResizingMediaBar=t.payload},[d_.UPDATE_LAST_GENERATED_THUMBNAIL]:e=>{e.lastThumbnailGenerated=Date.now()},[d_.SET_SHOW_REPORT_ISSUE_MODAL]:(e,t)=>{e.showReportIssueModal=t.payload},[d_.SET_LAYER_MOUNTED_STATE]:(e,t)=>{e.isLayerMountedByLayerId[t.payload.layerId]=t.payload.mounted},[d_.SET_ASSET_MONITOR_ID]:(e,t)=>{e.assetMonitorId=t.payload},[d_.UPDATE_DALLE_TEMP_VALUES]:(e,t)=>{e.dallePrompt=t.dallePrompt||e.dallePrompt,e.dalleLastGeneratedPrompt=t.dalleLastGeneratedPrompt||e.dalleLastGeneratedPrompt,e.dalleResults=t.dalleResults||e.dalleResults},[d_.SET_MAGIC_CREATE_OVERLAY_OPEN]:(e,t)=>{e.magicCreateOverlayOpen=t.open},[d_.SET_AI_TOOLS_DATA]:(e,t)=>{e.ai={...e.ai,...t.payload}},[d_.SET_ARTICLE_TO_VIDEO_DATA]:(e,t)=>{e.articleToVideo={...e.articleToVideo,...t.payload}},[d_.SET_ARTICLE_TO_VIDEO_OUTLINE_SLIDE]:(e,t)=>{const{slideIndex:o,newSlide:a}=t.payload;e.articleToVideo.outline[o]=a},[d_.SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR]:(e,t)=>{e.clickedTTSButtonFromRightSidebar=t.payload},[d_.SET_TRACK_IS_DRAGGING]:(e,t)=>{e.trackIsDragging=t.payload},[d_.SET_LOCAL_ASSET_VALUES]:(e,t)=>{const o=e.assetTempValues[t.assetId];e.assetTempValues[t.assetId]=o?{...o,...t.properties}:t.properties}}),eO=v({initialState:{idb:!0},name:"assets",reducers:{setIdbIsSupported:(e,t)=>{e.idb=t.payload}}}),{actions:tO}=eO,oO=v({initialState:oe.v4(),name:"sessionId",reducers:{}}),aO=v({initialState:{},name:"notifications",reducers:{setNotifications:(e,t)=>{e.notifications=t.payload},addNotifications:(e,t)=>{e.notifications=[...t.payload,...e.notifications||[]]},setNotificationsRead:(e,t)=>{e.notifications=e.notifications?e.notifications.map((e=>t.payload.includes(e._id.toString())?{...e,state:Sl.read}:e)):void 0}}}),{setNotifications:iO,addNotifications:sO,setNotificationsRead:nO}=aO.actions,rO={byId:{},projectIdsByFolderId:{}},lO=v({initialState:rO,name:"projects",reducers:{moveProjectsSuccess:(e,{payload:{movedProjects:t,destinationFolder:o}})=>{Object.keys(e.projectIdsByFolderId).forEach((a=>{if(a!==o._id){const o=(e.projectIdsByFolderId[a]||[]).filter((e=>!t.map((e=>e._id)).includes(e)));e.projectIdsByFolderId[a]=o}}))},projectsFetched:(e,{payload:{projects:t,folderId:o}})=>{t.forEach((t=>{e.byId[t._id]=t}));const a=e.projectIdsByFolderId[o],i=t.map((e=>e._id)),s=a?[...new Set([...i,...a])]:i;e.projectIdsByFolderId[o]=s.sort()},removeProject:(e,{payload:{projectId:t,folderId:o}})=>{delete e.byId[t];const a=e.projectIdsByFolderId[o];a&&(e.projectIdsByFolderId[o]=a.filter((e=>e!==t)))},clearAllProjects:e=>rO,updateProjectName:(e,{payload:{projectId:t,name:o}})=>{const a=e.byId[t];a&&(a.name=o)},updateProjectVideo:(e,{payload:{projectId:t,updateDict:o}})=>{const a=e.byId[t];a&&(a.content={...a.content,...o})}}}),{projectsFetched:dO,removeProject:cO,clearAllProjects:uO,moveProjectsSuccess:mO,updateProjectVideo:pO,updateProjectName:hO}=lO.actions,gO=v({initialState:{recordSet:!1},name:"recordAudio",reducers:{setRecord:e=>{e.recordSet=!0},unsetRecord:e=>{e.recordSet=!1}}}),{setRecord:fO,unsetRecord:yO}=gO.actions,vO=v({initialState:{loadingSubscription:!0,associatedTeamId:null,subscription:null},name:"subscription",reducers:{setSubscription:(e,t)=>{e.subscription=t.payload},setAssociatedTeamId:(e,t)=>{e.associatedTeamId=t.payload},setLoadingSubscription:(e,t)=>{e.loadingSubscription=t.payload}}}),{setLoadingSubscription:_O,setSubscription:wO,setAssociatedTeamId:bO}=vO.actions;function TO(e,t){let o=t.getStartKey();const a=t.getEndKey();let i=t.getStartOffset(),s=e.getBlockForKey(o).getCharacterList().slice(i);const n=[];for(;o!==a;){for(const e of s.toArray())n.push(e);const t=e.getBlockAfter(o);o=t.getKey(),s=t.getCharacterList(),i=0}s=s.slice(0,t.getEndOffset()-i);for(const r of s.toArray())n.push(r);return n}const xO=e=>{const t=e.getFirstBlock().getKey();return re.SelectionState.createEmpty(t).merge({anchorKey:t,anchorOffset:0,focusKey:e.getLastBlock().getKey(),focusOffset:e.getLastBlock().getLength()})},SO=e=>{const t=e.getCurrentContent(),o=t.getFirstBlock().getKey(),a=t.getLastBlock().getKey(),i=t.getLastBlock().getLength(),s=e.getSelection();return s.getStartKey()===o&&0===s.getStartOffset()&&s.getEndKey()===a&&s.getEndOffset()===i},EO=e=>{const t=e.getCurrentContent().getBlocksAsArray(),o=e.getSelection(),a=o.getStartKey(),i=o.getStartOffset(),s=o.getEndKey(),n=o.getEndOffset(),r=t.map((e=>[e.getKey(),e.getLength()]));let l=0;for(const[c,u]of r){if(c===a){l+=i;break}l+=u+1}let d=0;for(const[c,u]of r){if(c===s){d+=n;break}d+=u+1}return[l,d]},IO=(e,t)=>{let o=0,a=null,i=0;const s=e.getCurrentContent().getBlocksAsArray().map((e=>[e.getKey(),e.getLength()]));if(t>-1)for(const[n,r]of s){const e=o;if(o+=r+1,o>t){a=n,i=t-e;break}}else{const t=e.getCurrentContent().getBlockMap().toList();a=t.last().get("key"),i=t.last().getLength()}if(a){const t=re.SelectionState.createEmpty(a).merge({anchorKey:a,anchorOffset:i,focusKey:a,focusOffset:i});return re.EditorState.forceSelection(e,t)}return e},CO=(e,t,o)=>{const a=e.getBlocksAsArray().map((e=>[e.getKey(),e.getLength()]));let i=0,s=null,n=0;for(const[d,c]of a){const e=i;if(i+=c+1,i>t){s=d,n=t-e;break}}i=0;let r=null,l=0;for(const[d,c]of a){const e=i;if(i+=c+1,i>o){r=d,l=o-e;break}}if(s&&r){return re.SelectionState.createEmpty(s).merge({anchorKey:s,anchorOffset:n,focusKey:r,focusOffset:l})}return null},kO=e=>e.getCurrentContent().getPlainText(),AO=(e,t)=>{let o=e;const a=TO(o,xO(o));for(let i=0;i<a.length;i+=1){0===a[i].getStyle().toArray().length&&(o=jO(o,i,t))}return o},jO=(e,t,o)=>{const a=CO(e,t,t+1);return a?re.Modifier.applyInlineStyle(e,a,o):e};var NO=(e=>(e.MOUNT_ACTIVE_EDITORS="MOUNT_ACTIVE_EDITORS",e.UNMOUNT_ACTIVE_EDITORS="UNMOUNT_ACTIVE_EDITORS",e.UPDATE_ACTIVE_EDITOR="UPDATE_ACTIVE_EDITOR",e.SET_TEXT_BOLD="SET_EDITOR_TEXT_BOLD",e.SET_TEXT_ITALICS="SET_EDITOR_TEXT_ITALICS",e.SET_TEXT_UNDERLINE="SET_EDITOR_TEXT_UNDERLINE",e.SET_TEXT_COLOR="SET_EDITOR_TEXT_COLOR",e))(NO||{});const RO=O("MOUNT_ACTIVE_EDITORS"),PO=O("UNMOUNT_ACTIVE_EDITORS"),DO=O("UPDATE_ACTIVE_EDITOR"),OO=O("SET_EDITOR_TEXT_BOLD"),LO=O("SET_EDITOR_TEXT_ITALICS"),FO=O("SET_EDITOR_TEXT_UNDERLINE"),MO=O("SET_EDITOR_TEXT_COLOR"),UO=(e,t,o)=>{const a=e.getSelection(),i=e.getCurrentContent(),s=a.isCollapsed()?xO(i):a,n=o?re.Modifier.applyInlineStyle(i,s,t):re.Modifier.removeInlineStyle(i,s,t),r=re.EditorState.push(e,n,"change-inline-style");return re.EditorState.acceptSelection(r,a)},BO=(e,t,o)=>{const a=e.getSelection(),i=e.getCurrentContent(),s=a.isCollapsed()?xO(i):a;let n=Ck(i).filter((e=>e.startsWith(t))).reduce(((e,t)=>re.Modifier.removeInlineStyle(e,s,t)),i);n=re.Modifier.applyInlineStyle(n,s,`${t}_${o}`),n=AO(n,`${t}_${o}`);const r=re.EditorState.push(e,n,"change-inline-style");return re.EditorState.acceptSelection(r,a)},VO=ne({},{[NO.MOUNT_ACTIVE_EDITORS]:(e,{payload:t})=>{for(const{id:o,editor:a}of t)e[o]?e[o].mountCounter+=1:e[o]={editor:a,syncCounter:0,mountCounter:1}},[NO.UPDATE_ACTIVE_EDITOR]:(e,{payload:t})=>{e[t.id]?e[t.id].editor=t.editor:e[t.id]={editor:t.editor,syncCounter:0,mountCounter:1}},[NO.UNMOUNT_ACTIVE_EDITORS]:(e,{payload:t})=>{for(const o of t)e[o]&&(e[o].mountCounter-=1,e[o].mountCounter<=0&&(e[o]=void 0))},[NO.SET_TEXT_BOLD]:(e,{payload:t})=>{for(const o of t.ids)e[o]&&(e[o].editor=UO(e[o].editor,"BOLD",t.value),e[o].syncCounter=e[o].syncCounter+1)},[NO.SET_TEXT_ITALICS]:(e,{payload:t})=>{for(const o of t.ids)e[o]&&(e[o].editor=UO(e[o].editor,"ITALIC",t.value),e[o].syncCounter=e[o].syncCounter+1)},[NO.SET_TEXT_UNDERLINE]:(e,{payload:t})=>{for(const o of t.ids)e[o]&&(e[o].editor=UO(e[o].editor,"UNDERLINE",t.value),e[o].syncCounter=e[o].syncCounter+1)},[NO.SET_TEXT_COLOR]:(e,{payload:t})=>{for(const o of t.ids)e[o]&&(e[o].editor=BO(e[o].editor,"COLOR",t.value),e[o].syncCounter=e[o].syncCounter+1)}}),WO={};async function GO(e){const{dispatch:t}=sr(),o=await async function(e){if(!e)return{canWrite:!0,canRead:!0};{const{state:t}=sr();if(!wc(t.currentUser))return{canWrite:!1};try{return await Yr("/api/v1/videos/userPermissions",{params:{videoId:e},retries:2})}catch(IGe){const t=IGe&&"object"==typeof IGe&&"error"in IGe?IGe.error:IGe;return console.error(`Error getting video permissions: ${t}`),{canWrite:!1,canRead:!1}}}}(e);return t($O(o)),o}const HO=v({initialState:WO,name:"userPermissions",reducers:{setUserPermissions:(e,t)=>{e.canWrite=t.payload.canWrite,e.canRead=t.payload.canRead},clearUserPermissions:()=>WO}}),{setUserPermissions:$O,clearUserPermissions:KO}=HO.actions,zO=v({name:"clipboard",initialState:{contents:null,originalProject:null,plainText:null},reducers:{setClipboardContents:(e,t)=>{Object.assign(e,t.payload)}}}),{setClipboardContents:YO}=zO.actions,JO=v({initialState:()=>{const e=window.matchMedia("(max-width: 768px)");return e.addEventListener("change",(e=>{sr().dispatch(JO.actions.setIsMobile(e.matches))})),e.matches},name:"isMobile",reducers:{setIsMobile:(e,t)=>t.payload}}),qO=v({name:"trimWithTranscript",initialState:{activeSearchResultNdx:0,scrollTarget:null,selection:null,searchText:"",searchOpen:!1,showDeleted:!0},reducers:{scrollToTarget:(e,t)=>{e.scrollTarget=t.payload},setSelection:(e,t)=>{e.selection=t.payload},setSearchOpen:(e,t)=>{e.searchOpen=t.payload},setSearchText:(e,t)=>{e.searchText=t.payload},setActiveSearchResultNdx:(e,t)=>{e.activeSearchResultNdx=t.payload},setShowDeleted:(e,t)=>{e.showDeleted=t.payload}}}),{scrollToTarget:XO,setSelection:QO,setSearchOpen:ZO,setActiveSearchResultNdx:eL,setSearchText:tL,setShowDeleted:oL}=qO.actions,aL=async()=>{const{dispatch:e,state:t}=sr(),o=t.studio.workspaceId||t.workspaces.selectedWorkspace;if(!o)return;const a=await Yr(`/api/v1/folders/limitedDTO/${o}`);e(sL({_id:a._id,name:a.name,teamId:a.teamId})),e(ib(o)),a.teamId&&e(Ip(a.teamId))},iL=v({initialState:{_id:Vn,name:"Shared with Me",teamId:void 0},name:"videoFolder",reducers:{setVideoFolder:(e,t)=>{e._id=t.payload._id,e.name=t.payload.name,e.teamId=t.payload.teamId}}}),{setVideoFolder:sL}=iL.actions,nL=v({initialState:{},name:"eyedropper",reducers:{clearOnColorSelected:e=>{delete e.onColorSelected},setOnColorSelected:(e,t)=>{e.onColorSelected=t.payload}}}),{setOnColorSelected:rL,clearOnColorSelected:lL}=nL.actions,dL=v({initialState:{},name:"singleTimePopups",reducers:{hidePopup:(e,t)=>{e[t.payload]=!1},showPopup:(e,t)=>{e[t.payload]=!0}}}),{hidePopup:cL,showPopup:uL}=dL.actions,mL=v({name:"translation",initialState:{progress:0,translationMethod:void 0},reducers:{setTranslationProgress:(e,t)=>{e.progress=t.payload},setTranslationMethod:e=>{e.translationMethod="google"}}}),{setTranslationProgress:pL,setTranslationMethod:hL}=mL.actions;var gL=(e=>(e.SAMPLE="sample",e.SPLIT="split",e.TRIM_WITH_TRANSCRIPT="trim with transcript",e.SUBTITLES="subtitles",e.EXPORT="export",e.REPURPOSE_SAMPLE="repurpose sample",e.REPURPOSE_EDIT_HIGHLIGHT="repurpose edit highlight",e.REPURPOSE_REEDIT_CLIPS="repurpose re-edit clips",e.REPURPOSE_REVIST_PROJECTS="repurpose revisit projects",e))(gL||{}),fL=(e=>(e.Onboarding="Onboarding",e.RepurposeOnboarding="RepurposeOnboarding",e.RepurposeSample="RepurposeSample",e))(fL||{});const yL={Onboarding:["split","trim with transcript","subtitles","export"],RepurposeOnboarding:["repurpose edit highlight","trim with transcript","repurpose re-edit clips","repurpose revisit projects"],RepurposeSample:["repurpose sample","repurpose edit highlight","trim with transcript","subtitles","export"]},vL={isOpen:!1,tour:fL.Onboarding,currentStep:0,userBeganTour:!1,source:ad.Onboarding},_L=v({initialState:vL,name:"studioTour",reducers:{setCurrentStep:(e,t)=>{e.currentStep=t.payload},setIsOpen:(e,t)=>{e.isOpen=t.payload},setTour:(e,t)=>{e.tour=t.payload},setUserBeganTour:(e,t)=>{e.userBeganTour=t.payload},setSource:(e,t)=>{e.source=t.payload},reset:()=>vL}}),{setCurrentStep:wL,setIsOpen:bL,setUserBeganTour:TL,setTour:xL,setSource:SL,reset:EL}=_L.actions,IL=v({name:"findHighlights",initialState:{fetchStatusByAssetId:{},highlightsByAssetId:{},loadingInfoByAssetId:{},popoverOpen:!1},reducers:{addHighlights:(e,t)=>{e.highlightsByAssetId={...e.highlightsByAssetId,...t.payload}},setPopoverOpen:(e,t)=>{e.popoverOpen=t.payload},updateFetchStatus:(e,t)=>{s.merge(e.fetchStatusByAssetId,t.payload)},updateLoadingInfo:(e,t)=>{s.merge(e.loadingInfoByAssetId,t.payload)}}}),CL=IL.actions,kL=(e,t)=>!!e.findHighlights.highlightsByAssetId[t],AL=m((e=>e.findHighlights.highlightsByAssetId),bk,((e,t)=>s.pick(e,t))),jL=m(AL,(e=>Object.values(e).flatMap((e=>{const t=e.result.highlights.map(((t,o)=>({jobId:e.jobId,highlight:t,jobProperties:e.jobProperties,originalOrder:o+1,aiOrder:null})));return t.every((({highlight:e})=>null!==e.aiReviewScore))&&(t.sort(((e,t)=>t.highlight.aiReviewScore-e.highlight.aiReviewScore)),t.forEach(((e,t)=>e.aiOrder=t+1))),t})))),NL=m(AL,(e=>Object.values(e))),RL=v({name:"timeline",initialState:{shouldScrollToStart:!1,timelineContainerWidth:0,timelineContainerHeight:0,useCSSTransitions:!1},reducers:{setScrollTimelineToStart:(e,t)=>{e.shouldScrollToStart=t.payload},setTimelineContainerSize:(e,t)=>{e.timelineContainerWidth=t.payload.width,e.timelineContainerHeight=t.payload.height},setUseCSSTransitions:(e,t)=>{e.useCSSTransitions=t.payload}}}),PL=RL.actions,DL=()=>{const e=sh.get("state",{disabled:null}),t=sh.get("featureFlags2",{disabled:null});if(!t||!e)return{};const o=e.currentUser.user._id,{flags:a,userId:i}=t;return i!==o?{}:a},OL=v({initialState:()=>({flags:DL(),loading:!0,flagSource:"local",fetchErrMsg:null}),name:"featureFlags",reducers:{setFlags:(e,t)=>{const o=t.payload;e.flags=o,e.loading=!1,e.flagSource="fetch",Ub((()=>{const e=sr().state.currentUser.user._id;sh.set("featureFlags2",{flags:o,userId:e})}))},setErrorMessage:(e,t)=>{e.loading=!1,e.fetchErrMsg=t.payload}}}),LL=m((e=>e.featureFlags.flags),(e=>e)),FL=m((e=>e.featureFlags.loading),(e=>e)),ML=OL.actions,UL=v({initialState:{},name:"teamBlueprints",reducers:{set:(e,t)=>{const{blueprints:o,teamId:a}=t.payload;e[a]={all:o,byId:o.reduce(((e,t)=>(e[t._id]=t,e)),{})}},upsert:(e,t)=>{const o=t.payload,{teamId:a}=o;e[a]||(e[a]={byId:{},all:[]}),e[a].byId[o._id]=o,e[a].all.unshift(o)}}}),BL=UL.actions,VL=v({name:"transcriptTab",initialState:{intent:null},reducers:{setIntent:(e,t)=>{e.intent=t.payload}},extraReducers:e=>e.addCase("SHOW_TOOL_TIP",((e,t)=>{"trimWithTranscript"===t.toolTip&&(e.intent="trim")}))}),WL=VL.actions,GL=v({name:"workspaceSearch",initialState:{query:""},reducers:{setSearch:(e,t)=>{e.query=t.payload}}}),HL=v({name:"workflows",initialState:{exportProgressByVideoId:{},folderWorkflowsById:{},settingsByFolderId:{},workflowIdsByFolderId:{},workflowById:{}},reducers:{exportProgressCleared:(e,t)=>{delete e.exportProgressByVideoId[t.payload]},exportProgressUpdated:(e,t)=>{e.exportProgressByVideoId[t.payload.videoId]={progress:t.payload.progress,processVideoJobId:t.payload.processVideoJobId}},folderWorkflowsFetched:(e,t)=>{e.workflowIdsByFolderId[t.payload.folderId]={status:"success",data:t.payload.workflows.map((e=>e._id))},t.payload.workflows.forEach((t=>{e.folderWorkflowsById[t._id]={status:"success",data:t}}))},folderWorkflowsFetchStarted:(e,t)=>{e.folderWorkflowsById[t.payload]={status:"fetching"}},folderWorkflowsFetchError:(e,t)=>{e.folderWorkflowsById[t.payload.folderId]={status:"error",error:t.payload.error}},removeWorkflow:(e,t)=>{e.workflowById[t.payload]&&delete e.workflowById[t.payload];const o=Object.entries(e.workflowIdsByFolderId);for(const[a,i]of o)"success"===i.status&&(i.data=i.data.filter((e=>e!==t.payload)),0===i.data.length&&delete e.workflowIdsByFolderId[a])},updateWorkflow:(e,t)=>{const o=e.workflowById[t.payload.workflowId];"success"===(null==o?void 0:o.status)&&o.data.status===gd.COMPLETE&&(o.data={...o.data,...t.payload.updates})},workflowFetchStarted:(e,t)=>{e.workflowById[t.payload]={status:"fetching"}},workflowFetchError:(e,t)=>{e.workflowById[t.payload.workflowId]={status:"error",error:t.payload.error}},workflowFetched:(e,t)=>{e.workflowById[t.payload.workflowId]={status:"success",data:t.payload.workflow},e.settingsByFolderId[t.payload.workflow.folderId]=t.payload.settings},updateFolderSettings:(e,t)=>{e.settingsByFolderId[t.payload.folderId]=t.payload.settings}}}),$L=HL.actions,KL=le({ffmpegReducer:VD,config:(e=bv,t)=>"SET_CONFIG"===t.type?{...e,...t.config||{}}:e,sourceVideo:(e={},t)=>{switch(t.type){case"KAPWING_INIT":return"local"===e.source?{}:{...e,local_url:null};case"SET_SOURCE_VIDEO":return t.updateSharedDoc&&Fw("sourceVideo",t.video,e,"SET_SOURCE_VIDEO"),t.video;case"SET_UPLOAD_PROGRESS_TEXT":return"sourceVideo"!==t.id?e:{...e,uploadProgressText:t.text};default:return e}},uploadStatuses:(e={},t)=>{var o;switch(t.type){case"RESET_EDITOR":return{};case"ADD_UPLOAD_STATUS":{if(e[t.id])return e;const o={id:t.id,beganAt:performance.now(),beganAtTimestamp:Date.now(),fileName:t.fileName,stage:Sv.unstarted,stageStarted:performance.now(),retryInfo:{offlineRetries:0,otherRetries:0,retries:0}};return{...e,[t.id]:o}}case"DELETE_UPLOAD_STATUS":{const o={...e};return delete o[t.id],o}case"UPDATE_UPLOAD_STATUS":{const a=e[t.id];if(!a)return e;const i="stage"in t.updates&&t.updates.stage!==a.stage?{stageStarted:performance.now()}:{};if(100===(null==(o=t.updates.conversionProgress)?void 0:o.uploading_converted)){const o={...e};return delete o[t.id],o}return{...e,[t.id]:{...a,...t.updates,...i}}}default:return e}},toolTip:(e="",t)=>{switch(t.type){case"SHOW_TOOL_TIP":return t.toolTip;case"RESET_EDITOR":return"";default:return e}},mousePositionToolTip:(e=null,t)=>{switch(t.type){case"SET_MOUSE_POSITION_TOOLTIP":return t.mousePosition;case"CLEAR_MOUSE_POSITION_TOOLTIP":return null;default:return e}},privacy:(e=null,t)=>{let o;switch(t.type){case"SET_CURRENT_VIDEO":o=(t.video||{}).privacy,o=null==o?null:o;break;case"SET_PRIVACY":o=t.privacy;break;case"RESET_EDITOR":case"RESET_PRIVACY":case"RESET_STUDIO":o=null;break;default:o=e}return o},startTime:(e=0,t)=>{switch(t.type){case"SET_START_TIME":return t.startTime;case"RESET_EDITOR":return 0;default:return e}},endTime:(e=0,t)=>{switch(t.type){case"SET_END_TIME":return t.endTime;case"RESET_EDITOR":return 0;default:return e}},editorPath:(e="/",t)=>{switch(t.type){case"SET_EDITOR_PATH":return t.path;case"RESET_EDITOR":return"/";default:return e}},currentVideo:(e={},t)=>{switch(t.type){case"SET_CURRENT_VIDEO":return t.video;case"UPDATE_CURRENT_VIDEO":return{...e,...t.videoUpdates};case"RESET_STUDIO":case"RESET_CURRENT_VIDEO":return{};default:return e}},recentVideos:(e=[],t)=>"SET_RECENT_VIDEOS"===t.type?t.videos:e,videoJustSaved:(e=!1,t)=>"SET_VIDEO_JUST_SAVED"===t.type?t.justSaved:e,videoSaving:(e=!1,t)=>{switch(t.type){case"SET_VIDEO_SAVING":return!0;case"CLEAR_VIDEO_SAVING":return!1;default:return e}},currentUser:(e=(()=>"object"==typeof Cypress&&"env"in Cypress?"team"===Cypress.env("isSignedIn")?(zw(Cypress.env("teamsUserToken")),{user:Cypress.env("teamsUserDict"),token:Cypress.env("teamsUserToken")}):"individual"===Cypress.env("isSignedIn")?(zw(Cypress.env("userToken")),{user:Cypress.env("userDict"),token:Cypress.env("userToken")}):Kw:Kw)(),t)=>{var o;switch(t.type){case"REQUEST_USER":return{...e,user:{},token:e.token};case"RECEIVE_USER_AND_SET_TOKEN":{const{user:o,token:a,impersonatingAdminEmail:i}=t;return Yw(o),{...e,user:o,token:a,impersonatingAdminEmail:i}}case"SET_TOKEN":return{...e,token:t.token};case"MOCK_SIGN_IN":return{...e,token:Cypress.env("teamsSignIn")?Cypress.env("teamsUserToken"):Cypress.env("userToken"),user:Cypress.env("teamsSignIn")?Cypress.env("teamsUserDict"):Cypress.env("userDict")};case"SIGN_OUT":return Yw(null),Kw;case"SET_USER":return Yw(t.user),{...e,user:t.user};case"UPDATE_USER_NOTIF_SETTING":{if(!(null==(o=e.user)?void 0:o._id))return e;const{notifType:a,on:i,location:s}=t,n=s===Tl.Email?"optOutEmails":"optOutNotifs",r=e.user[n];if(!i&&!(null==r?void 0:r.includes(a))){const t=r?[...r,a]:[a];return{...e,user:{...e.user,[n]:t}}}if(i&&(null==r?void 0:r.includes(a))){const t=r.filter((e=>e!==a));return{...e,user:{...e.user,[n]:t}}}return e}default:return e}},isStopMotionVideo:(e=!1,t)=>{switch(t.type){case"MARK_AS_STOP_MOTION":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},stopMotionClipRate:(e=.6,t)=>{switch(t.type){case"SET_STOP_MOTION_CLIP_RATE":return t.clipRate;case"RESET_EDITOR":return.6;default:return e}},stopMotionSpeed:(e=.2,t)=>{switch(t.type){case"SET_STOP_MOTION_SPEED":return t.speed;case"RESET_EDITOR":return.2;default:return e}},reverseStopMotion:(e=!1,t)=>{switch(t.type){case"TOGGLE_REVERSE_STOP_MOTION":return!e;case"RESET_EDITOR":return!1;default:return e}},isLooped:(e=!1,t)=>{switch(t.type){case"MARK_AS_LOOPED":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},numLoops:(e=2,t)=>{switch(t.type){case"SET_NUM_LOOPS":return t.numLoops;case"RESET_EDITOR":return 2;default:return e}},isStudio:(e=!1,t)=>{switch(t.type){case"MARK_AS_STUDIO":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},seekInProgress:(e=!1,t)=>{switch(t.type){case"SET_SEEK_IN_PROGRESS":return!0;case"CLEAR_SEEK_IN_PROGRESS":return!1;default:return e}},...Jw,...qw,...Xw,...uh,...HD,studio:(e=uP(),t)=>{var o,a,i;const s=hP(e,t);if(e.allLayers&&e.allLayers.byId===s.allLayers.byId&&(null==(o=e.scenes[0])?void 0:o.layers)!==(null==(a=s.scenes[0])?void 0:a.layers)&&"BRING_LAYER_FORWARD"!==t.type&&"MOVE_LAYER_TO_INDEX"!==t.type&&"SEND_LAYER_BACK"!==t.type&&"UPDATE_UPLOADED_LAYER"!==t.type){const e={};for(const t of(null==(i=s.scenes[0])?void 0:i.layers)||[])e[t.id]=t;return f("Layer updates not propagating correctly.",{extra:{action:t}}),console.error("Layer updated without updating studio.layers.byId!",t.type),{...s,allLayers:{byId:e}}}return s},workspaces:ob.reducer,previewVideo:(e=null,t)=>{switch(t.type){case"SET_PREVIEW_VIDEO":return t.video;case"RESET_EDITOR":return null;default:return e}},projectName:(e="",t)=>"SET_PROJECT_NAME"===t.type?t.projectName||"":e,teams:(e={activeTeamInvites:[],allTeams:[],userTeamInvites:[],selectedTeamId:"",sharedTeamId:"",sharedTeamOwnerEmail:"",activeBrandkit:{fonts:[],colors:[],clonedVoices:[],cmlIds:[]},brandkitTemplates:[],isFetchingTeams:!1},t)=>{switch(t.type){case"SET_CURRENT_TEAM":{const{_id:o}=t;return{...e,selectedTeamId:o}}case"SET_TEAMS":return{...e,allTeams:t.teams};case"SET_ACTIVE_TEAM_INVITES":return{...e,activeTeamInvites:t.invites};case"SET_USER_TEAM_INVITES":return{...e,userTeamInvites:t.invites};case"UPDATE_TEAM":return F(e,(o=>{const{id:a,updateDict:i}=t,s=(n=e.allTeams,r=a,n.findIndex((e=>e._id===r)));var n,r;const l=e.allTeams[s];if(!l)return;const d={...l,...i};o.allTeams[s]=d}));case"UPDATE_TEAM_NAME":return F(e,(e=>{for(const o of e.allTeams)o._id===t.id&&(o.name=t.name)}));case"UPDATE_TEAM_LOGO":return F(e,(e=>{for(const o of e.allTeams)o._id===t.id&&(o.picture=t.picture)}));case"SET_SHARED_TEAM_OWNER_EMAIL":return{...e,sharedTeamOwnerEmail:t.sharedTeamOwnerEmail};case"SET_SHARED_TEAM_ID":return{...e,teamOwnerEmail:t.sharedTeamId};case"MOCK_SIGN_IN":return{...e,..."object"==typeof Cypress&&"env"in Cypress?"individual"===Cypress.env("isSignedIn")?{allTeams:Cypress.env("userAllTeams"),selectedTeamId:Cypress.env("userSelectedTeamId")}:"team"===Cypress.env("isSignedIn")?{allTeams:Cypress.env("teamsUserAllTeams"),selectedTeamId:Cypress.env("teamsUserSelectedTeamId")}:{allTeams:Cypress.env("userAllTeams"),selectedTeamId:Cypress.env("userSelectedTeamId")}:{}};case"SIGN_OUT":return{allTeams:[],selectedTeamId:""};case"SET_ACTIVE_BRANDKIT":{const{activeBrandkit:o}=e,{update:a}=t;return"function"==typeof a&&o?{...e,activeBrandkit:a(o)}:{...e,activeBrandkit:a}}case"SET_BRANDKIT_TEMPLATES":{const{templates:o}=t;return{...e,brandkitTemplates:o}}case"INCREMENT_AI_USAGE":{const{feature:o}=t,a=e.allTeams.find((t=>t._id===e.selectedTeamId));if(!a)return e;const i=a.limits,s=i[o]||0;if("number"!=typeof s)return e;const n={...i,[o]:s+1};return{...e,allTeams:e.allTeams.map((t=>t._id===e.selectedTeamId?{...t,limits:n}:t))}}case"SET_IS_FETCHING_TEAMS":return{...e,isFetchingTeams:t.isFetching};default:return e}},groupSidebarOpen:(e={},t)=>"TOGGLE_SIDEBAR"===t.type?{...e,[t.groupId]:!e[t.groupId]}:e,selectedTabs:zD.reducer,mediaLibrary:(e={})=>e,contextMenu:(e=null,t)=>{switch(t.type){case WD.SHOW_CONTEXT_MENU:return t.contextMenu;case WD.HIDE_CONTEXT_MENU:return null;default:return e}},studioLocal:ZD,featureSupport:eO.reducer,projectSessionSettings:Jd.reducer,sessionId:oO.reducer,sessionValues:cl.reducer,CMLFiles:Ab.reducer,assets:YP.reducer,mediaCache:fu.reducer,comments:Jb.reducer,recordAudio:gO.reducer,assetTranscriptions:iN.reducer,loadedFonts:Nh.reducer,activeEditors:VO,notifications:aO.reducer,projects:lO.reducer,modal:fh.reducer,exports:Bf.reducer,explorer:wh.reducer,subscription:vO.reducer,magicSubtitlePresets:If.reducer,textPresets:Fy.reducer,textTemplates:ev.reducer,toasts:fl.reducer,userPermissions:HO.reducer,clipboard:zO.reducer,isMobile:JO.reducer,trimWithTranscript:qO.reducer,bRoll:uv.reducer,videoFolder:iL.reducer,eyedropper:nL.reducer,vision:Zj.reducer,singleTimePopups:dL.reducer,translation:mL.reducer,studioTour:_L.reducer,findHighlights:IL.reducer,featureFlags:OL.reducer,teamBlueprints:UL.reducer,workspaceSearch:GL.reducer,timeline:RL.reducer,transcriptTab:VL.reducer,elementPool:aS.reducer,workflows:HL.reducer}),zL="undefined"!=typeof window;let YL=0;const JL=(e,t)=>{const o=((e,t)=>{if(!Ps)return()=>{};const o=performance.now();return()=>{const a=performance.now();Fs.push({category:e,labels:t,time:a-o,hits:1})}})("reducer",[t.type]);let a={...e};const i=performance.now();switch(t.type){case"RESET_STATE_PRESERVE_USER":case"RESET_STUDIO":a={config:a.config,currentUser:a.currentUser,toasts:a.toasts,workspaces:a.workspaces,teams:a.teams,templates:a.templates,featureSupport:a.featureSupport,mediaCache:a.mediaCache,sessionId:a.sessionId,sessionValues:a.sessionValues,CMLFiles:a.CMLFiles,assets:a.assets,comments:a.comments,notifications:a.notifications,projects:a.projects,loadedFonts:a.loadedFonts,magicSubtitlePresets:a.magicSubtitlePresets,textPresets:a.textPresets,textTemplates:a.textTemplates,explorer:a.explorer,subscription:a.subscription,clipboard:a.clipboard,videoFolder:a.videoFolder,studioTour:a.studioTour};break;case"UPDATE_ENTIRE_STATE":Object.assign(a,t.newStateProperties);break;case"JEST_CLEAR_STORE":a=KL(void 0,t),a.isStudio=!0}const s=KL(a,t);if(zL){window.state=s;const e=s.studio.scenes[0];e&&(window.scene=e)}o();const n=performance.now();return YL+=n-i,s};class qL extends Error{constructor(e){super(),this.name="BulkActionsError",this.message=e}}let XL={},QL={};const ZL={versionNumber:"0.1",migrate:e=>{if(!e.scenes)return[];for(const t of e.scenes){for(const e of t.layers)for(const t of["duration","startTime","endTime","videoDelay"]){const o=e[t];o&&"number"==typeof o&&(e[t]=wS(o))}const{duration:o,maxLayerId:a}=uC(t,lT(e));t.duration=o,t.maxLayerId=a}return e.duration&&(e.duration=e.scenes.reduce(((e,t)=>t.duration+e),0)),["scenes","duration"]}},eF=["intro","outro","constant"],tF=["id",...eF],oF=e=>{let t=e.duration;return"slow"===e.speed&&(t*=2),"fast"===e.speed&&(t/=2),t},aF={versionNumber:"0.6",migrate:e=>{if(!e.scenes)return[];const t=e.scenes.map((e=>e.layers.map((e=>e.id)))).flat(),o=new Set(t);if(t.length!==o.size){const t=new Set;return e.scenes=e.scenes.map((e=>({...e,layers:e.layers.filter((e=>!t.has(e.id)&&(t.add(e.id),!0)))}))),e.allLayers={byId:Object.fromEntries(e.scenes.map((e=>e.layers)).flat().map((e=>[e.id,e])))},["scenes","allLayers"]}return[]}},iF=(sF=[ZL,{versionNumber:"0.2",migrate:e=>{e.animations={allIds:[],byId:{}};const t=["animations"];return e.scenes?(t.push("scenes"),e.scenes.forEach((t=>{t.layers.forEach((t=>{if(!t.animation)return;if("progress-bar"===t.animation.id)return void(t.animation={constant:["progress-bar"]});if(tF.every((e=>!(e in t.animation))))return void delete t.animation;if("id"in t.animation){const e=t.animation,o=e.animatesForever?"constant":"intro";t.animation={[o]:[e]}}eF.forEach((o=>{const a=t.animation[o];if(!a)return;const i=a.map((a=>{const i=de();if(a.transitionId){const[s,n]="intro"===o?[t.id,a.transitionLayerId]:[a.transitionLayerId,t.id],r=Object.values(e.animations.byId).find((e=>{if(!e.isCrossTransition)return!1;return("intro"===o?e.introLayerId:e.outroLayerId)===t.id}));if(r)return r.id;e.animations.allIds.push(i),e.animations.byId[i]={animationName:a.transitionId,id:i,isCrossTransition:!0,transitionDuration:oF(a),introLayerId:s,outroLayerId:n}}else e.animations.allIds.push(i),e.animations.byId[i]={animationName:a.id,id:i,isCrossTransition:!1,layerId:t.id,transitionDuration:oF(a)};return i}));t.animation[o]=i}))}))})),t):t}},{versionNumber:"0.3",migrate:e=>{var t,o,a;const i=[];if(!e.scenes||1===e.scenes.length&&0===Object.keys(e.audio??{}).length)return i;i.push("scenes","duration");const s=[],n={background:(null==(t=e.scenes[0])?void 0:t.background)||"",duration:0,id:(null==(o=e.scenes[0])?void 0:o.id)||"",isImageVideo:!1,layers:[],subtitle:(null==(a=e.scenes[0])?void 0:a.subtitle)||{},userSelectedDuration:0,userSetDuration:!1};let r=0,l=-1;if(e.scenes.forEach((e=>{!n.isImageVideo&&e.isImageVideo&&(n.isImageVideo=!0),!n.background&&e.background&&(n.background=e.background),!n.id&&e.id&&(n.id=e.id),!n.subtitle&&e.subtitle&&(n.subtitle=e.subtitle),n.duration+=e.duration;let t=0;e.layers.forEach(((o,a)=>{l=Math.max(l,o.timelineRow||-1);let i=0;const{start:n,end:d}=cm(o);"video"===o.type||"audio"===o.type?(o.videoDelay||(o.videoDelay=0),i=o.videoDelay+((d||0)-(n||0)),o.videoDelay=r+(o.videoDelay||0)):(o.isTrimmed||(o.isTrimmed=!0),i=d||0,o.startTime=r+(n||0),o.endTime=r+(d||0)),t=Math.max(t,i),a===e.layers.length-1&&(r+=t),s.push(o)}))})),e.audio&&0!==Object.keys(e.audio).length){const t=e.audio,o={asset_id:t.asset_id,cmlFileId:t.cmlFileId,duration:t.duration,hasAudio:t.hasAudio,height:t.height,id:t.id,mime:t.mime,name:t.name,objectFit:t.objectFit,timelineRow:l+1,videoDelay:t.videoDelay,url:t.url,source:t.source,type:"audio",position:{height:"100%",rotation:0,width:"100%",x:"0%",y:"0%"},startTime:0,endTime:t.duration>n.duration?n.duration:t.duration,volume:1};e.audio={},i.push("audio"),s.push(o)}return n.layers=s,n.duration=wS(n.duration),e.duration=n.duration,e.scenes=[n],i}},{versionNumber:"0.4",migrate:e=>{if(!e.scenes)return[];return e.scenes[0]&&e.scenes[0].layers.forEach((e=>{if("string"==typeof e.fontSize){const t=e.fontSize;e.fontSize=t.includes("px")?parseFloat(t.slice(0,t.length-2)):parseFloat(t)}})),["scenes"]}},{versionNumber:"0.5",migrate:e=>{if(!e.scenes)return[];let t=!1;for(const o of e.scenes)for(const e of o.layers)"text"===e.type&&""===e.textShadow&&(e.textShadow="transparent",t=!0);return t?["scenes"]:[]}},aF,{versionNumber:"0.7",migrate:e=>{if(e.magicSubtitleFrames){const t={};for(const[o,a]of Object.entries(e.magicSubtitleFrames||{})){if(null===a)continue;const e={byId:{},orderedFrames:[]},i=a.filter(Boolean);for(const t of i)e.byId[t.id]=t,e.orderedFrames.push(t.id);t[o]=e}return e.magicSubtitleFramesByAsset=t,delete e.magicSubtitleFrames,["magicSubtitleFramesByAsset","magicSubtitleFrames"]}return[]}},{versionNumber:"0.8",migrate:e=>{if(!e.scenes||!e.scenes[0])return[];if(!e.scenes[0].layers.find((e=>"subtitle"===e.type)))return[];const t=["scenes"],o=[];if(e.scenes[0].layers.forEach((e=>{"subtitle"===e.type&&e.text&&void 0!==e.startTime&&void 0!==e.endTime&&o.push({text:e.text,start:e.startTime,end:e.endTime})})),0===o.length)return t;const a=e.scenes[0].layers.filter((e=>"subtitle"!==e.type));e.scenes=[{...e.scenes[0],layers:a}],delete e.scenes[0].subtitle;if(Object.keys(e.magicSubtitles||{}).length>0||Object.values(e.magicSubtitleFramesByAsset||{}).length>0)return t;t.push("magicSubtitles"),e.magicSubtitles={"background-asset":{enabled:!0,transcriptionSource:"manual",position:{heightPct:0,widthPct:80,xPct:10,yPct:80,rotation:0},languageKey:null}};const i={};for(const s of o){const e=de();i[e]={id:e,words:s.text.split(" ").map((e=>({text:e}))),start:s.start,end:s.end}}return t.push("magicSubtitleFramesByAsset"),e.magicSubtitleFramesByAsset={"background-asset":{byId:i}},t}},{versionNumber:"0.9",migrate:e=>{if(!e.scenes)return[];let t=!1;return e.scenes[0]&&e.scenes[0].layers.forEach((e=>{e.usedProFeature&&(e.usedProFeatures=[e.usedProFeature],delete e.usedProFeature,t=!0)})),t?["scenes"]:[]}}],function(e,t){const o=[];for(const a of sF){const i=nF(a.versionNumber),s="Older"===dF(e,i),n="Newer"!==dF(i,t);s&&n&&o.push(a)}return o});var sF;function nF(e){return e?e.split(".").map((e=>parseInt(e))):[0,0]}var rF=(e=>(e.Equal="Equal",e.Newer="Newer",e.Older="Older",e))(rF||{});function lF(e,t){return e[0]<t[0]||e[0]===t[0]&&e[1]<t[1]}function dF(e,t){return lF(e,t)?"Older":lF(t,e)?"Newer":"Equal"}const cF=e=>({mediaCacheId:e,loadMetadataMs:0,seekStallCounts:0,seekStallsMs:0,bytesFetched:0,bytesFetchedOriginal:0,bytesFetchedPreview:0,bytesFetchedTrack:0,bytesFetchedSegmented:0});class uF{constructor(e){this.map=e}getUsage(e){return Xs(this.map,e,{insert:()=>cF(e)})}attachEvents(e,t){let o;const a=performance.now();e.addEventListener("seeking",(()=>{o=performance.now()}),{passive:!0}),e.addEventListener("seeked",(e=>{if(null==o)return;const a=(e=>e.target instanceof HTMLVideoElement?e.target:null)(e);if(!a)return;if(a.dataset.mse||!a.src.startsWith("blob:")){const e=this.getUsage(t);e.seekStallCounts+=1,e.seekStallsMs+=performance.now()-o}}),{passive:!0}),e.addEventListener("loadedmetadata",(()=>{this.getUsage(t).loadMetadataMs+=performance.now()-a}),{passive:!0,once:!0})}getMetrics(){if(0===this.map.size)return null;let e=0,t=0,o=0,a=0,i=0,s=0,n=0,r=0;for(const l of this.map.values())e+=l.loadMetadataMs,t+=l.seekStallCounts,o+=l.seekStallsMs,a+=l.bytesFetched,i+=l.bytesFetchedOriginal,n+=l.bytesFetchedTrack,r+=l.bytesFetchedSegmented,s+=l.bytesFetchedPreview;return{"Average Seek stalls (ms)":o/t,"Average metadata loading (ms)":e/this.map.size,"Bytes fetched":a,"Bytes fetched (original)":i,"Bytes fetched (preview)":s,"Bytes fetched (tracks)":n,"Bytes fetched (segments)":r}}}const mF=new uF(new Map),pF=new uF(new Map);function hF(e,t,o){const a=mF.getUsage(t),i=pF.getUsage(t);switch(a.bytesFetched+=o,i.bytesFetched+=o,e){case"original":a.bytesFetchedOriginal+=o,i.bytesFetchedOriginal+=o;break;case"preview":a.bytesFetchedPreview+=o,i.bytesFetchedPreview+=o;break;case"segmented":a.bytesFetchedSegmented+=o,i.bytesFetchedSegmented+=o;break;case"track":a.bytesFetchedTrack+=o,i.bytesFetchedTrack+=o}}const gF=ce();gF.startListening({predicate:(e,t,o)=>"KAPWING_INIT"===e.type||t.studio.localId!==o.studio.localId,effect:async function(e,t){const o=t.getState().studio.localId;if(!o)return;const a=sh.get(`session_${o}`,{disabled:null});a&&t.dispatch(rc(a));(e=>{if(mF.map.clear(),pF.map.clear(),null==e)return;const{records:t}=e,o=cF("");for(const[a,i]of Object.entries(t)){const e={...o,mediaCacheId:a,...s.pick(i,Object.keys(o))};mF.map.set(a,e)}})(sh.get(`video_usage_${o}`,{disabled:null}))}}),ue(!1);const fF=function(){var e,t;if("undefined"!=typeof window)try{const o=sh.get("state",{disabled:null});if(null===o)return;if(!o)return;const a=window.location.href,i=null==(e=o.studio)?void 0:e._id;if(i&&!a.includes(i)&&(o.studio=void 0),o.studio){const e=nF(o.studio.projectVersion),a=nF("0.9"),i=iF(e,a);!function(e,t){if(!t.length)return e;for(const a of t)try{a.migrate(e),e.projectVersion=a.versionNumber}catch(o){return console.error(o),R(o,{extra:{__FORCE_SAMPLE:!0},tags:{migrationFailure:!0}}),e}}(o.studio,i),function(e){var t;(null==(t=null==e?void 0:e.allLayers)?void 0:t.byId)&&Object.values(e.allLayers.byId).forEach((e=>{delete e.local_url}));(null==e?void 0:e.scenes)&&e.scenes.forEach((e=>{e.layers.forEach((e=>{delete e.local_url}))}))}(o.studio);const s=(o.studio,null);s&&R(s,{tags:{migrationDryRunFailure:!0,videoId:String(null==(t=o.studio)?void 0:t._id)}})}return o}catch(o){return void console.error(o)}}(),yF="object"==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({actionsDenylist:["SET_STUDIO_TIME"]}):me,vF=[e=>e=>t=>Ps?Us("redux",[t.type],(()=>e(t))):e(t),e=>e=>{let t={},o=0;return a=>{if(o+=1,t[a.type]=(t[a.type]||0)+1,QL[a.type]=(QL[a.type]||0)+1,e(a),1===o){const e=new qL("Large group of actions dispatched");setTimeout((()=>{if(o>50){const a={actionCount:o,actionCountMap:t};kr()||console.warn("Large group of actions dispatched",a,e.stack),R(e,{extra:{...a}}),Fm(ym.BULK_ACTIONS_ERROR,{actionCount:o})}XL=t,t={},o=0}))}}},gF.middleware],_F=pe({actionTransformer:e=>"MOUNT_ACTIVE_EDITOR"===e.type||"UNMOUNT_ACTIVE_EDITOR"===e.type?null:e,stateTransformer:e=>({...e,activeEditors:"Removed to reduce size",assets:"Removed to reduce size",CMLFiles:"Removed to reduce size",ffmpegReducer:"Removed to reduce size",mediaCache:"Removed to reduce size",magicSubtitlePresets:"Removed to reduce size",textPresets:"Removed to reduce size",textTemplates:"Removed to reduce size",studioLocal:"Removed to reduce size",bRoll:"Removed to reduce size"})});let wF=0;const bF=globalThis.globalStore||(()=>{const e=he(JL,fF,yF(ge(...vF),_F)),t=new Set;if(!kr()){let o=!1;const a=()=>{o=!1,Us("redux",["subscribers"],(()=>{const e=performance.now();g.batch((()=>{for(const e of t)e()}));const o=performance.now();wF+=o-e}))};return e.subscribe((()=>{const e=window.event;if(e&&["change","input","keydown"].includes(e.type)&&(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement))return a(),void(o=!1);o||(o=!0,queueMicrotask((()=>{o&&a()})))})),e.subscribe=e=>(t.add(e),()=>{t.delete(e)}),Object.assign(e,{flush(){o&&a()}})}return Object.assign(e,{flush(){}})})();globalThis.globalStore=bF,bF.flush;const TF={loading:"loading",apiLoading:{}},xF=(e,t)=>{switch(t.type){case"UPDATE_GAPI_LOADING":return{...e,loading:t.loadingState};case"UPDATE_GAPI_API_LOADING":return{...e,apiLoading:{...e.apiLoading,[t.api]:t.loadingState}};default:return e}},SF=h.createContext({state:TF,requestAPI:()=>{}}),EF=_.memo((({children:e})=>{const[t,o]=h.useState([]),[a,i]=h.useReducer(xF,TF),s="loaded"===a.loading;h.useEffect((function(){fe(IF,(e=>{i(e?{type:"UPDATE_GAPI_LOADING",loadingState:"error"}:{type:"UPDATE_GAPI_LOADING",loadingState:"loaded"})}))}),[]),h.useEffect((function(){if(s)for(const e of t){a.apiLoading[e]||(i({type:"UPDATE_GAPI_API_LOADING",api:e,loadingState:"loading"}),gapi.load(e,(()=>{"client"===e&&gapi.client.load("photoslibrary","v1"),i({type:"UPDATE_GAPI_API_LOADING",api:e,loadingState:"loaded"})})))}}),[s,a.apiLoading,t]);const n=h.useCallback((e=>{o((t=>t.includes(e)?t:[...t,e]))}),[]),r=h.useMemo((()=>({state:a,requestAPI:n})),[a,n]);return w.jsx(SF.Provider,{value:r,children:e})})),IF="https://apis.google.com/js/api.js";function CF(e){const{requestAPI:t,state:o}=h.useContext(SF),a="error"===o.loading,i=!a&&("loaded"!==o.loading||"loaded"!==o.apiLoading[e]);return h.useEffect((()=>{t(e)}),[e,t]),{loading:i,error:a}}const kF=h.createContext({signIn:async(e,t)=>({}),signOut:()=>{},wrapGAPICall:(e,t)=>e(),getUserinfo:async()=>null,email:"",requestAdditionalAccessForScope:()=>{}}),AF=_.memo((({children:e})=>{const t=CF("client"),{client_id:o}=tl((e=>({client_id:e.config.GOOGLE_PLUGINS_CLIENT_ID})),ol),[a,i]=h.useState(sh.get("gisEmailHint",{disabled:""})||""),[n,r]=h.useState(sh.get("gapiAccessToken",{disabled:""})||"");h.useEffect((function(){fe("https://accounts.google.com/gsi/client",(e=>{e&&console.error(e)}))}),[]);const l=h.useCallback((async(e,a)=>{if(t.error||t.loading)return{};const s=await new Promise(((t,i)=>{window.google.accounts.oauth2.initTokenClient({client_id:o,scope:`email ${e}`,hint:a,prompt:"",callback:e=>{void 0!==e.error&&i(e),t(e)}}).requestAccessToken()})),n=gapi.client.getToken().access_token;sh.set("gapiAccessToken",n),r(n);try{const{result:{email:e}}=await gapi.client.request({path:"https://www.googleapis.com/oauth2/v3/userinfo",method:"GET"});sh.set("gisEmailHint",e),i(e)}catch(IGe){console.error("Attempt to set email hint failed unexpectedly:",IGe)}return s}),[o,t.error,t.loading]),d=h.useCallback((()=>{sh.remove("gisEmailHint"),sh.remove("gapiAccessToken"),i("")}),[]),c=h.useCallback((async function(e,o){var i;if(t.error||t.loading)return e();if(null==(i=gapi.client.getToken())?void 0:i.access_token)try{return await e()}catch(IGe){if(s.isObject(IGe)&&"status"in IGe&&401!==IGe.status)throw Error("Unexpected error from GAPI encountered:",{cause:IGe})}if(n)try{return gapi.client.setToken({access_token:n}),await e()}catch(IGe){if(s.isObject(IGe)&&"status"in IGe&&401!==IGe.status)throw Error("Unexpected error from GAPI encountered:",{cause:IGe})}return await l(o,a),e()}),[l,a,t.error,t.loading,n]),u=h.useCallback((()=>c((async()=>await new Promise((e=>gapi.client.oauth2.userinfo.get().execute((({result:t})=>e(t)))))),"https://www.googleapis.com/auth/userinfo.profile")),[c]),m=h.useCallback(((e,t)=>{google.accounts.oauth2.initTokenClient({callback:t,client_id:o,scope:e}).requestAccessToken({prompt:""})}),[o]),p=h.useMemo((()=>({email:a,getUserinfo:u,requestAdditionalAccessForScope:m,signIn:l,signOut:d,wrapGAPICall:c})),[l,d,c,u,a,m]);return w.jsx(kF.Provider,{value:p,children:e})}));function jF(){const{email:e,getUserinfo:t,requestAdditionalAccessForScope:o,signIn:a,signOut:i,wrapGAPICall:s}=h.useContext(kF);return{email:e,getUserinfo:t,requestAdditionalAccessForScope:o,signIn:a,signOut:i,wrapGAPICall:s}}window.clearEmailHint=()=>{localStorage.removeItem("gisEmailHint")},window.clearAccessToken=()=>{localStorage.removeItem("gapiAccessToken")};const NF={studioLoader:"SmallLoader-module_studioLoader_-HgeE",blueLoader:"SmallLoader-module_blueLoader_6-LRn",workspaceLoader:"SmallLoader-module_workspaceLoader_IcLy3",load8:"SmallLoader-module_load8_OwwiR"};var RF=(e=>(e.Workspace="workspace",e.Studio="studio",e.Blue="blue",e))(RF||{});const PF=_.memo((({theme:e=RF.Workspace})=>w.jsx("div",{className:NF[`${e}Loader`]}))),DF="ModalConfirmButtons-module_disabled_fcnTC",OF="ModalConfirmButtons-module_primaryButton_61ELD",LF="ModalConfirmButtons-module_loading_8AeVe",FF="ModalConfirmButtons-module_secondaryAction_7nwCf",MF="ModalConfirmButtons-module_secondaryActionNoTransparency_dTMhw",UF="ModalConfirmButtons-module_innerWrapper_4HFB8",BF="ModalConfirmButtons-module_leftOnMobile_DeJ03",VF="ModalConfirmButtons-module_loadingContainer_nFj75",WF="ModalConfirmButtons-module_loadingMsg_YAJzN",GF=_.memo((({cancelFn:e,confirmFn:t,loadingMsg:o,disabled:a,confirmText:i,cancelText:s,cancelStyle:n,cancelButtonNoTransparency:r,stayRightOnMobile:l,stopClickPropogation:d=!1,confirmButtonClassName:c})=>{const u=e=>{d&&e.stopPropagation(),a||null==t||t()},m=t=>{d&&t.stopPropagation(),null==e||e()};return zg()&&!l?w.jsxs("div",{className:UF,children:[" ",w.jsx("div",{className:`${OF} ${a?DF:""} ${c}`,onClick:u,"data-cy":"workspace-next-button","data-testid":"workspace-modal-confirm-button",children:i||"Confirm"}),e&&w.jsx("div",{onClick:m,className:FF,"data-testid":"workspace-modal-cancel-button",children:s||"Never mind"})]}):w.jsxs("div",{className:UF,children:[e&&w.jsx("div",{onClick:m,className:`${FF} ${r?MF:""} ${l?"":BF}`,"data-testid":"workspace-modal-cancel-button",style:n,children:s||"Never mind"}),w.jsx("div",{className:`${OF} ${a?DF:""} ${l?"":BF} ${c} ${o?LF:""}`,onClick:u,"data-cy":"workspace-next-button","data-testid":"workspace-modal-confirm-button",children:w.jsx("div",{className:VF,children:o?w.jsxs(w.Fragment,{children:[o," ",w.jsx(PF,{marginLeft:10})]}):w.jsx("span",{className:WF,children:i||"Confirm"})})})]})})),HF="OverlayWrapper-module_noScrollBar_X1p-e",$F="OverlayWrapper-module_overlayBackground_yJQ-2",KF="OverlayWrapper-module_overlayContainer_-eKQr",zF="OverlayWrapper-module_noWidth_q1ep7",YF="OverlayWrapper-module_overlayContainerPadding_YKOn9",JF="OverlayWrapper-module_overlayContainerSmall_F4IKo",qF="OverlayWrapper-module_overlayContainerSmaller_-TigE",XF="OverlayWrapper-module_exit_huBkG",QF="OverlayWrapper-module_overlayContent_o-zKg",ZF="OverlayWrapper-module_header_Eoz17",eM="OverlayWrapper-module_buttonsContainer_9lDny",tM="OverlayWrapper-module_dark_Buyxp",oM="OverlayWrapper-module_noPadding_kYio9",aM="OverlayWrapper-module_noScroll_ECgWD",iM="OverlayWrapper-module_description_R2zq4",sM=()=>document.querySelector(".app-container")??document.body;const nM=g.connect((e=>({overlay:e.projectSessionSettings.overlay})),(e=>ye({hideOverlay:Xd},e)))((e=class extends h.Component{constructor(){super(...arguments),i(this,"escFunction",(e=>{const{unsetCancelModal:t}=this.props;"Escape"===e.key&&t&&t()})),i(this,"hide",(()=>{const{unsetCancelModal:e,overlay:t,hideOverlay:o}=this.props;e?e():t&&t.key&&o()}))}componentDidMount(){document.addEventListener("keydown",this.escFunction,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.escFunction,!1)}getContainerStyle(){return this.props.biggerPadding?YF:this.props.overlayContainerSmall?JF:this.props.overlayContainerSmaller?qF:KF}get showCloseButton(){const{noCloseButton:e,unsetCancelModal:t,overlay:o}=this.props;return!e&&(t||(null==o?void 0:o.key))}renderContent(){const{afterElement:e,children:t,confirmButtonOptions:o,className:a,dark:i,id:s,onClick:n,style:r,onDrop:l,onDragOver:d,onDragEnter:c,cypressName:u,noScrollBar:m,noPadding:p,noWidth:h,backgroundStyle:g,noScroll:f}=this.props;return w.jsxs("div",{id:s,onClick:e=>null==n?void 0:n(e),children:[w.jsx("div",{className:$F,onClick:this.hide,"data-cy":`${u||"overlay"}-background`,onDrop:l,onDragOver:d,onDragEnter:c,style:g}),w.jsxs("div",{className:`${this.getContainerStyle()} ${i?tM:""} ${a||""} ${m?HF:""} ${h?zF:""}`,style:r,onDrop:l,onDragOver:d,onDragEnter:c,children:[w.jsxs("div",{className:`${QF}\n            ${p?oM:""} ${f?aM:""}`,children:[t,o&&w.jsx("div",{className:eM,children:w.jsx(GF,{cancelFn:this.hide,loadingMsg:this.props.loadingMsg,...o})})]}),this.showCloseButton&&w.jsx("div",{className:XF,onClick:this.hide,"data-cy":`${u||"overlay"}-close`,children:w.jsx(ve,{})})]}),w.jsx("span",{children:e})]})}render(){const{usePortal:e}=this.props;return e?_e.createPortal(this.renderContent(),sM()):this.renderContent()}},i(e,"Header",(({children:e})=>w.jsx("div",{className:ZF,children:e}))),i(e,"Description",(({children:e})=>w.jsx("div",{className:iM,children:e}))),e)),rM="TypeformProvider-module_typeformWidget_8Ycv3",lM=h.createContext({showTypeform:e=>{throw new Error("Attempted to use typeform context without provider")}}),dM={backgroundColor:"transparent",maxWidth:"none"},cM=_.memo((({children:e})=>{const[t,o]=h.useState(void 0),[a,i]=h.useState((async e=>{})),s=h.useCallback(((e,t)=>{o(e),i((()=>t))}),[]),n=_.useRef(null);h.useEffect((function(){var e;const t=null==(e=n.current)?void 0:e.querySelector("iframe");if(t){const e=()=>{var e;return null==(e=t.contentWindow)?void 0:e.postMessage("embed-focus","*")};return e(),t.addEventListener("load",e),()=>t.removeEventListener("load",e)}}),[t]);const r=h.useCallback((()=>{o(void 0),i((async()=>{}))}),[]),l=h.useCallback((async e=>{const{responseId:t}=e;await a(t)}),[a]),d=h.useMemo((()=>({showTypeform:s})),[s]);return w.jsxs(lM.Provider,{value:d,children:[e,t&&w.jsx(nM,{unsetCancelModal:r,noPadding:!0,noScroll:!0,style:dM,noWidth:!0,children:w.jsx("div",{ref:n,children:w.jsx(we.Widget,{id:t,onSubmit:l,className:rM,inlineOnMobile:!0})})})]})}));let uM=null;function mM(e,t,o){return t?uM||(uM=async function(){try{o(_O(!0));const{subscription:t}=await Jr("/api/v1/stripe/getTeamSubscription",{body:{teamId:e}});return al((()=>{o(bO(e)),o(wO(t)),o(_O(!1))})),uM=null,t}catch(IGe){throw o(_O(!1)),uM=null,IGe}}(),uM):(al((()=>{o(bO(e)),o(wO(null)),o(_O(!1))})),null)}const pM=()=>{const e=il(),t=tl((e=>e.teams.selectedTeamId)),o=(a=t,tl((e=>e.teams.allTeams.find((e=>e._id===a))))||vc);var a;const{loadingSubscription:i,subscription:s,associatedTeamId:n}=tl((e=>e.subscription));h.useEffect((()=>{t!==n&&n&&(e(_O(!0)),e(wO(null)))}),[t,n,e]);const r=h.useCallback((async()=>{mM(o._id,o.stripeId,e)}),[o._id,o.stripeId,e]);return h.useEffect((()=>{r()}),[r,o.planTier]),{subscription:s,loadingSubscription:i,refetchSubscription:r}},hM=async()=>{const{state:e,dispatch:t}=sr(),{teams:o}=e,{selectedTeamId:a,allTeams:i}=o,s=i.find((e=>e._id===a));if(void 0===s)return;const n=function(){const{state:{teams:{selectedTeamId:e},subscription:{subscription:t,associatedTeamId:o}}}=sr();if(e===o)return t}()||await mM(s._id,s.stripeId,t);return n},gM=async()=>{const e=await hM();return Ju(e)},fM=e=>{const t=tl((e=>e.currentUser)),[o,a]=h.useState(!0),[i,s]=h.useState(),n=h.useCallback((async()=>{a(!0);try{const{subscription:o}=await Jr("/api/v1/admin/getStripeSubscriptionFromTeamId",{body:{teamId:e,userId:t.user._id}});s(o),a(!1)}catch(IGe){mh({description:"Failed to retrive subscription",error:IGe}),a(!1)}}),[t.user._id,e]);return h.useEffect((()=>{n()}),[n]),{subscription:i,loadingSubscription:o,refetch:n}},yM=async e=>{const t=await TM(e);if(!t)return;const{status:o,interval:a}=await gM(),i=iu(e),s={"Team ID":e,"Number of Workspace Members":t.totalTeamMembers,"Brandkit is set up":t.isBrandkitSetup,"Current Plan":i.type,"Monthly/Annual":a,"Subscription Status":o,"Brand Kit Pre-Populated":Nm()};window.sessionStorage.setItem("TEAM_WORKSPACE_ACCESS_LOGGED","TRUE"),Fm(ym.TEAM_WORKSPACE_ACCESSED,s)},vM=async e=>{const{workspaceId:t}=e,{state:o}=sr(),a=o.workspaces.allWorkspaces.find((e=>e._id===t)),i=await TM((null==a?void 0:a.teamId)||"");if(!i)return;const{team:s}=i,{_id:n}=s||{},r=!!s,l=null==a?void 0:a.type;if(r){const{currentUser:{user:{_id:t}}}=o,a=e.creatorId&&e.creatorId===t;let s;l===kn.team?s="Team Folder":l===kn.personal&&(s="My Folder");const{status:r,interval:d}=await gM(),c=iu(n),u={"Project Location":s,"Is Project Owner":a,"Team ID":n,"Number of Workspace Members":i.totalTeamMembers,"Brandkit is set up":i.isBrandkitSetup,"Current Plan":c.type,"Monthly/Annual":d,"Subscription Status":r};Fm(ym.TEAM_PROJECT_ACCESSED,u)}},_M=async(e,t,o,a)=>{const{status:i,interval:s}=await gM(),n={"Team ID":e,"Removed Email":t,"Removed Role":o,"Number of Workspace Members":a,"Current Plan":iu(e).type,"Monthly/Annual":s,"Subscription Status":i};amplitude.getInstance().logEvent("Team Member Removed",n)},wM=async({teamId:e,inviterEmail:t,shareType:o,origin:a})=>{const{status:i,interval:s}=await gM(),n=iu(e);Fm(ym.TEAM_MEMBERS_INVITED,{"Team ID":e,"Team Inviter Email":t,"Share Type":o,Origin:a,"Current Plan":n.type,"Monthly/Annual":s,"Subscription Status":i,"Quantity Legacy Members":0})},bM=async()=>{const{state:e}=sr(),t=Hu(e),{status:o,interval:a}=await gM();Fm(ym.MAKE_EDITOR_SHARE_DIALOG,{"Current Plan":null==t?void 0:t.planTier,"Subscription Status":o,"Monthly/Annual":a,"Team ID":null==t?void 0:t._id,"Number of Workspace Members":null==t?void 0:t.users.length})},TM=async e=>{var t;try{const{state:o}=sr(),a=_c(e);if(!a)throw new Error("Unable to get team");const i=null==(t=null==o?void 0:o.teams)?void 0:t.activeBrandkit,s=!!i&&await(async e=>{if(!e.colors||!e.fonts||!e.cmlIds)return!1;const t=e.colors.some((e=>!Am(e))),o=e.fonts.some((e=>{return!("custom"===(t=e).type&&"62962eab0af119277ab7c9c3"===t.asset_id);var t}));let a=!0;const i=e.cmlIds[0];if(i||(a=!1),i)try{const{cml_file:e}=await Vb(i);e&&jm(e.asset_id)&&(a=!1)}catch(IGe){console.error(IGe)}return t||o||a})(i);return{totalTeamMembers:a.users.length,isBrandkitSetup:s,team:a}}catch(IGe){console.error(IGe)}},xM=e=>{Fm(ym.ADDED_WORKSPACE_NAME,{Origin:e})},SM=async e=>{const{interval:t,status:o}=await gM(),a={"Current Plan":e.planTier,"Subscription Status":o,"Monthly/Annual":t,"Team ID":e._id,"Number of Workspace Members":e.users.length};Fm(ym.INITIATED_CANCELLATION,a)},EM=async()=>{const e=Hu();if(e){const{interval:t,status:o}=await gM(),a={"Current Plan":e.planTier,"Subscription Status":o,"Monthly/Annual":t,"Team ID":e._id,"Number of Workspace Members":e.users.length};Fm(ym.CONTINUE_TO_SURVEY,a)}},IM=async e=>{const{status:t,interval:o}=await gM(),a={"Current Plan":e.planTier,"Subscription Status":t,"Monthly/Annual":o,"Team ID":e._id,"Number of Workspace Members":e.users.length};Fm(ym.DOWNGRADE_WORKSPACE,a)},CM=()=>{const{state:e}=sr(),t=Hu(e),o=au();Fm(ym.INITIATE_DELETE_WORKSPACE,{"Team ID":null==t?void 0:t._id,"Number of Workspace Members":null==t?void 0:t.users.length,"Current Plan":o.type})},kM=async e=>{const{status:t,interval:o}=await gM();Fm(ym.DELETE_TEAM_WORKSPACE,{"Current Plan":e.planTier,"Subscription Status":t,"Monthly/Annual":o,"Team ID":e._id,"Number of Workspace Members":e.users.length})},AM=async(e,t)=>{const{interval:o,status:a}=await gM(),i=Hu();if(!i)return;const s=su(i),n=t.fromVideoId?"Edit Request":"Suggested Workspaces",r="Accepted"===e?ym.JOIN_REQUEST_ACCEPTED:ym.JOIN_REQUEST_DECLINED;Fm(r,{"Team ID":i._id,"Current Plan":s.type,"Monthly/Annual":o,"Subscription Status":a,"Quantity Legacy Members":0,"Number of Workspace Members":"Accepted"===e?i.users.length+1:i.users.length,"Request Scenario":n})},jM=e=>{Fm(ym.VISIT_FROM_JOIN_REQUEST_EMAIL,{"Email Scenario":(()=>{switch(e){case Wn.RequestToEditEmail:return"Edit Request";case Wn.RequestToJoinEmail:return"Suggested Workspace Join Request";default:return"Unknown"}})()})};async function NM(e,t){const{interval:o}=await gM();Fm(ym.OPEN_SEAT_ADDED,{"Number of Paid Seats Added":e-t,"New Paid Seats":t,"Monthly/Annual":o})}async function RM(e,t){const{interval:o}=await gM();Fm(ym.OPEN_SEAT_REMOVED,{"Number of Paid Seats Removed":e-t,"New Paid Seats":t,"Monthly/Annual":o})}async function PM(){const{interval:e,numPaidSeats:t}=await gM(),o=Hu();Fm(ym.LEFT_TEAM,{numMembers:((null==o?void 0:o.users.length)||2)-1,"Monthly/Annual":e,"New Paid Seats":t})}async function DM(){const{numPaidSeats:e}=await gM();Fm(ym.UPGRADE_MONTHLY_TO_ANNUAL,{"New Paid Seats":e,"Monthly/Annual":"Annual","Brand Kit Pre-Populated":Nm()})}const OM=async(e,t)=>{const{status:o,interval:a}=await gM();Fm(ym.UPDATE_TEAM_JOIN_LINK,{"Current Plan":e.planTier,"Subscription Status":o,"Monthly/Annual":a,"Team ID":e._id,"Number of Workspace Members":e.users.length,Action:t})},LM=async e=>{const{state:t}=sr(),{status:o,interval:a}=await gM(),i=Hu(t);i&&Fm(ym.ADD_BRANDKIT_MEDIA_TO_PROJECT,{"Current Plan":i.planTier,"Subscription Status":o,"Monthly/Annual":a,"Team ID":i._id,"Number of Workspace Members":i.users.length,"Video ID":e,"Brand Kit Pre-Populated":Nm()})},FM=async()=>{const{state:e}=sr(),{status:t,interval:o}=await gM(),a=Hu(e);a&&Fm(ym.SHOWN_BRANDKIT_PREPOPULATED_TOOLTIP,{"Current Plan":a.planTier,"Subscription Status":t,"Monthly/Annual":o,"Team ID":a._id,"Number of Workspace Members":a.users.length,"Brand Kit Pre-Populated":Nm()})},MM=async({source:e,workspaceId:t,isProjectOwner:o,state:a=sr().state,workspaceHasCollaborators:i,workflowId:s})=>{const n=a.workspaces.allWorkspaces.find((e=>e._id===t)),r=await TM((null==n?void 0:n.teamId)||"");if(!r)return;const{team:l}=r,{_id:d}=l||{},c=!!l,u=null==n?void 0:n.type;let m;m=c?u===kn.team?"Team Folder":"My Folder":i?"Shared Folder":"Personal Workspace";const{interval:p,status:h}=await gM(),g=au(),f={"Project Location":m,Source:e,"Number of Workspace Members":r.totalTeamMembers,"Brandkit is set up":r.isBrandkitSetup,"Current Plan":g.type,"Monthly/Annual":p,"Subscription Status":h,"Quantity Legacy Members":0};d&&(f["Team ID"]=d),o&&(f["Is Original Project Owner"]=o);const{activeFindHighlightsJobInfo:y}=a.studio.analytics;y&&(f["Find Highlights Job ID"]=y.jobId,f["Find Highlights Asset Duration"]=y.assetDuration),s&&(f["Find Highlights Workflow ID"]=s),Fm(ym.NEW_PROJECT_IN_WORKSPACE,f)},UM=new Set;const BM=async()=>{const{state:e}=sr(),t=await TM(e.teams.selectedTeamId||"");if(!t)return;const o={"Number of Workspace Members":t.totalTeamMembers,"Brandkit is set up":t.isBrandkitSetup,"Team ID":e.teams.selectedTeamId};Fm(ym.BEGIN_WORKSPACE_SHARE,o)},VM=({numPendingInvites:e,suggestedWorkspaces:t,entryPoint:o,isQualifiedDomain:a})=>{var i;const{numAskToJoin:s,numOpenToJoin:n}=(e=>{let t=0,o=0;return e.teams.forEach((e=>{var a;switch(null==(a=e.settings)?void 0:a.discoverability){case cd.AnyoneCanJoin:t+=1;break;case cd.RequestToJoin:default:o+=1}})),{numOpenToJoin:t,numAskToJoin:o}})(t);Fm(ym.BEGIN_SUGGESTED_WORKSPACES,{Domain:t.teams.length>0?null==(i=t.teams[0])?void 0:i.emailDomain:"","Number Invite Workspaces":e,"Number Suggested Workspaces - Ask to Join":s,"Number Suggested Workspaces - Open to Join":n,"Entry Point":o}),amplitude.getInstance().setUserProperties({Domain:km()}),a&&lu(a)};var WM=(e=>(e.Onboarding="New User Onboarding",e.Sidebar="Sidebar",e))(WM||{});async function GM({newFolderId:e,projectId:t,source:o,stateBeforeCopy:a,workflowId:i}){let s;try{s=(await Yr(`/api/v1/workspaces/${e}/getUsers`)).keys.length>1}catch(IGe){s=void 0}const{state:n}=sr(),{user:r}=n.currentUser,l=t?n.projects.byId[t]:void 0,d=!!l&&r._id===l.creatorId;MM({workspaceId:e,source:o||"Copied",workspaceHasCollaborators:s,isProjectOwner:d,state:a,workflowId:i})}const HM="Switch-module_switch_GQQ33",$M="Switch-module_vertical_0vB47",KM="Switch-module_slider_lr-uK",zM="Switch-module_sliderVertical_--vRf",YM="Switch-module_icon_-cd-T",JM="Switch-module_disabledOption_bpP2R",qM=_.memo((({toggled:e=!1,onChange:t=(()=>null),disabled:o=!1,vertical:a=!1,IconComponent:i=null,iconColor:s="black",backgroundColor:n,sliderColor:r="#101010",...l})=>{const[d,c]=h.useState(e);h.useEffect((()=>{c(e)}),[e]);const u=h.useMemo((()=>{const e={marginLeft:3,marginTop:4};return d||(a?e.marginTop=24:e.marginLeft=24),e}),[d,a]);return w.jsxs("label",{...l,className:`\n        ${HM} \n        ${o?JM:""}\n        ${a?$M:""}    \n      `,children:[w.jsx("input",{type:"checkbox",checked:d,onChange:e=>{c(e.target.checked),t&&t(!!e.target.checked)},disabled:o}),w.jsx("span",{className:a?zM:KM,style:{backgroundColor:n,"--sliderColor":r}}),!!i&&w.jsx(i,{className:YM,style:u,color:s,size:12})]})})),XM=["/","/about","/ai-video-generator","/animated-text-video-maker","/careers","/cartoonify","/contact-us","/creators-fund","/demo","/explore","/explore/directory/A","/explore/directory/B","/explore/directory/C","/explore/directory/D","/explore/directory/E","/explore/directory/F","/explore/directory/G","/explore/directory/H","/explore/directory/I","/explore/directory/J","/explore/directory/K","/explore/directory/L","/explore/directory/more","/explore/directory/M","/explore/directory/N","/explore/directory/O","/explore/directory/P","/explore/directory/Q","/explore/directory/R","/explore/directory/S","/explore/directory/T","/explore/directory/U","/explore/directory/V","/explore/directory/W","/explore/directory/X","/explore/directory/Y","/explore/directory/Z","/how-much-twitch-streamers-make","/logo-redesigns","/meme-maker","/meme-templates","/mobile-mockup","/motion","/museum-of-websites","/netflix-wrapped","/new-tab-stretches","/partnerships","/plugins","/policies/privacy","/policies/refund","/policies/terms-of-service","/pricing","/rick-roller","/sidedoor","/sonoma-county-fire-map","/sound-effects","/startup-demo-videos","/templates","/templates/ad","/templates/collage","/templates/edu","/templates/popular","/templates/tiktok","/templates/youtube","/templates/discord","/templates/facebook","/templates/holiday","/templates/instagram","/templates/twitch","/templates/animation","/templates/zoom","/tools","/404-illustrations"];function QM(){return tl((e=>void 0!==e.currentUser.user.darkModePreference&&e.currentUser.user.darkModePreference))}const ZM=_.createContext({darkMode:!1,toggleDarkMode:()=>null}),eU=_.memo((({children:e})=>{const t=be(),o=tl((e=>e.currentUser.user._id)),a=QM();h.useEffect((()=>{var e;const o=a&&!(e=>{const t=[...XM.filter((e=>!["/"].includes(e))),"/explore","/studio","/templates","/admin","/videos"];for(const o of t)if(e.includes(o))return!0;return!1})(t.pathname);null==(e=document.querySelector("body"))||e.setAttribute("data-theme",o?"dark":"light")}),[a,t.pathname]);const i=h.useCallback((()=>{!function(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};o(rp({...a,darkModePreference:e})),a._id&&Jr("/api/v1/users/updateProfile/darkModePreference",{body:{darkModePreference:e},parseJSON:!1}).catch((e=>console.error(e)))}(!a),((e,t)=>{amplitude.getInstance().setUserId(e),amplitude.getInstance().setUserProperties({toggledDarkMode:t})})(o,!a)}),[o,a]),s=h.useMemo((()=>({darkMode:a,toggleDarkMode:i})),[a,i]);return w.jsx(ZM.Provider,{value:s,children:e})})),tU=_.memo((({vertical:e,darkColorsOnly:t})=>{const{darkMode:o,toggleDarkMode:a}=_.useContext(ZM);return w.jsx(qM,{"data-cy":"theme-switch",toggled:o,onChange:a,vertical:e,IconComponent:o?Te:xe,iconColor:o?"#ebf6ff":"#ffe899",backgroundColor:o||t?"#606060":"#e0e0e0",sliderColor:o||t?"#101010":"white"})})),oU=100,aU="Tooltip-module_TooltipContent_vYu0u",iU="Tooltip-module_TooltipArrow_2X2gO",sU=_.memo((({children:e,delayDuration:t=500,message:o,wrapWithDiv:a,open:i,setOpen:s,style:n,side:r="top"})=>{const l=h.useCallback((e=>{null==s||s(e)}),[s]);return w.jsx(Se,{children:w.jsxs(T,{delayDuration:t,onOpenChange:l,...s?{open:i}:{},children:[w.jsx(C,{asChild:!0,children:a?w.jsx("div",{children:e}):e}),w.jsx(S,{children:w.jsxs(E,{className:aU,sideOffset:5,style:n,side:r,children:[o,w.jsx(I,{className:iU})]})})]})})}));function nU(e,t){const o={Action:"","Brand Asset Changed":""};switch(e){case"remove":o.Action="Removed";break;case"add":o.Action="Added";break;case"update":o.Action="Updated"}switch(t){case"color":o["Brand Asset Changed"]="Color";break;case"customSpelling":o["Brand Asset Changed"]="Custom Spelling";break;case"font":o["Brand Asset Changed"]="Font";break;case"media":o["Brand Asset Changed"]="Media";break;case"template":o["Brand Asset Changed"]="Brand Template";break;case"voices":o["Brand Asset Changed"]="Cloned Voices";break;case"subtitles":o["Brand Asset Changed"]="Subtitle Styles";break;case"textPreset":o["Brand Asset Changed"]="Text Styles";break;case"textTemplate":o["Brand Asset Changed"]="Text Templates"}Fm(ym.TEAM_BRANDKIT_UPDATE,o)}function rU(){const e=h.useRef(!1);return h.useEffect((()=>(e.current=!0,()=>{e.current=!1})),[]),e}const lU="/api/v2/presets/magicSubtitlePresets",dU=async e=>{await qr(lU,{body:{preset:e}})},cU=async e=>{const t=await Jr("/api/v2/presets/getSignedAssetUrls",{body:{assetIds:e}}),{signedAssetUrls:o}=t;return o||{}},uU=async e=>{const{dispatch:t}=sr(),o=await(async e=>{const t=`${lU}/${e}`,{presets:o}=await Yr(t);return o})(e);o&&t(Af({brandkitPresets:o}))},mU=async(e,t)=>{const{dispatch:o,state:a}=sr();try{const i={...e,teamId:a.teams.selectedTeamId,timestampCreated:Date.now()};if("custom"===e.presetId){i.presetId=`preset-${P()}`;let e=1;a.magicSubtitlePresets.brandkitPresets.forEach((({title:t})=>{if(t.includes("Brand Style")){const o=Number(t.split(" ")[2]);o>=e&&(e=o+1)}})),i.title=`Brand Style ${e}`,vU(i),bU()}o(Df({preset:i,index:t})),await(async e=>{await Jr(lU,{body:{preset:e}})})(i),"custom"===e.presetId&&o(Pf({presetId:"custom"}));o(wl({description:"Your subtitle style is now accessible to everyone on your team!",type:"success"})),nU("add","subtitles")}catch(IGe){mh({description:"Failed to save subtitle style.",error:IGe})}},pU=async e=>{if("custom"!==e.presetId)try{await dU(e)}catch(IGe){mh({description:"Failed to update subtitle style.",error:IGe})}},hU=async e=>{const{dispatch:t,state:o}=sr(),a=o.teams.selectedTeamId;if(!a)return;const{preset:i}=yU(o);if((null==i?void 0:i.presetId)===e){const{presets:a}=o.magicSubtitlePresets;a.some((t=>t.presetId===e))||t(bC({updates:{preset:null},undoable:!1}))}try{t(Lf({presetId:e})),await(async(e,t)=>{const o=`${lU}/${e}/${t}`;await zr(o)})(a,e),nU("remove","subtitles")}catch(IGe){mh({description:"Failed to remove subtitle style.",error:IGe})}},gU=(e,t={})=>{var o,a,i,s;const n={style:e.style,wordByWordAnimations:e.wordByWordAnimations,transitionId:null==(o=e.transition)?void 0:o.transitionId,transitionDuration:null==(a=e.transition)?void 0:a.transitionDuration,transitionOverlapDuration:null==(i=e.transition)?void 0:i.transitionOverlapDuration,transitionSpeed:null==(s=e.transition)?void 0:s.transitionSpeed,preset:e};let r=Lh;e.isSafezoneAware?r=Fh:"bottom"===e.style.verticalAlign?r=Dh:"middle"===e.style.verticalAlign&&(r=Oh);let l=n.style.fontSize;if(kg(e)){const{state:o}=sr(),a=e.presetId===hg.presetId?{height:16,width:9}:{height:9,width:16};l=LN({currentFontSize:l,newRatio:t.aspectRatio||{height:o.studio.height??1,width:o.studio.width??1},prevRatio:a})}return{...n,...t.skipPosition?{}:{position:r},style:{...n.style,fontSize:l}}},fU=e=>{const{magicSubtitlesGlobal:t}=sr().state.studio;return(null==t?void 0:t.style)||(null==t?void 0:t.position)?{}:gU(e||(()=>{const{state:e}=sr(),t=e.teams.selectedTeamId,{lastExportedPresets:o}=e.magicSubtitlePresets;for(const a of o)if([t,void 0].includes(a.teamId))return a;return Yh})())},yU=m(IA(),(e=>({preset:null==e?void 0:e.preset,style:null==e?void 0:e.style,wordByWordAnimations:null==e?void 0:e.wordByWordAnimations,transition:(null==e?void 0:e.transitionId)?{transitionId:null==e?void 0:e.transitionId,transitionDuration:null==e?void 0:e.transitionDuration,transitionOverlapDuration:null==e?void 0:e.transitionOverlapDuration,transitionSpeed:null==e?void 0:e.transitionSpeed}:void 0}))),vU=(e,t,o=!0)=>{const{dispatch:a}=sr();o&&function(){const{dispatch:e,state:t}=sr(),{preset:o,style:a,wordByWordAnimations:i,transition:s}=yU(t),n=_U(a,i,s);o||e(Cf(n))}(),a(bC({updates:gU(e,{skipPosition:!0}),undoable:t}))};function _U(e,t,o,a="custom",i="Custom"){return{presetId:a,title:i,style:e||Ph,wordByWordAnimations:t,transition:o}}function wU(){const{preset:e,style:t,wordByWordAnimations:o,transition:a}=tl(yU,ol);return e||_U(t,o,a)}function bU(){const{dispatch:e}=sr();e(Cf({...Yh,presetId:""}))}function TU(){return tl((e=>e.magicSubtitlePresets.customPreset))}function xU(){const e=rU(),t=tl((e=>e.teams.selectedTeamId)),{brandkitPresets:o,presets:a}=tl((e=>e.magicSubtitlePresets)),[i,s]=h.useState(!1);if(h.useEffect((()=>{uU(t)}),[t]),h.useEffect((()=>{!async function(){await(async()=>{const{dispatch:e,state:t}=sr(),{presets:o,lastAssetUrlSignedAt:a}=t.magicSubtitlePresets;if(!(Date.now()-(a||0)<144e5))try{const t=(e=>{const t=[];return e.forEach((({style:{fontFamily:e}})=>{"custom"===e.type&&t.push(e.asset_id)})),t})(o);if(!t.length)return;const a=await cU(t),i=o.map((e=>((e,t)=>{const{style:{fontFamily:o}}=e;return"custom"===o.type?{...e,style:{...e.style,fontFamily:{...o,url:t[o.asset_id]}}}:e})(e,a)));e(kf({presets:i})),e(Mf(Date.now()))}catch(i){console.error("refreshSubtitlePresetAssetUrls err",i)}})(),e.current&&s(!0)}()}),[e]),!i)return{presets:[],brandkitPresets:[]};const n=new Set(o.map((e=>e.presetId)));return{presets:a.filter((e=>e&&e.presetId&&!n.has(e.presetId))),brandkitPresets:o}}function SU(){const{state:e}=sr(),{preset:t,style:o,wordByWordAnimations:a,transition:i}=yU(e);return t||_U(o,a,i)}const EU="PresetPreview-module_container_034hO",IU="PresetPreview-module_preview_YpGeo",CU="PresetPreview-module_selectedPreview_aHLgI",kU="PresetPreview-module_brandkit_nBjDi",AU="PresetPreview-module_more_s2xSx",jU="PresetPreview-module_brandkitIcon_NBr2f",NU=e=>ou().hasPermission(e),RU=e=>au().hasPermission(e);const PU=()=>{var e;if("undefined"!=typeof window)try{const t=sr().state,{localId:o}=t.studio,a=(()=>{const{state:e}=sr(),t=!e.studio._id,o={...e.studio,topFontsLoaded:!1},a={...e.workspaces,showUploadDialog:!1},{activeBrandkit:i,...s}=e.teams;return{teams:s,workspaces:a,sourceVideo:e.sourceVideo,currentUser:{user:e.currentUser.user,token:e.currentUser.token,impersonatingAdminEmail:e.currentUser.impersonatingAdminEmail},currentVideo:e.currentVideo,duration:e.duration,resizeTemplate:e.resizeTemplate,resizeBackground:e.resizeBackground,startTime:e.startTime,endTime:e.endTime,editorPath:e.editorPath,magicSubtitlePresets:e.magicSubtitlePresets,textPresets:e.textPresets,textTemplates:e.textTemplates,isLooped:e.isLooped,numLoops:e.numLoops,watermarkText:e.watermarkText,watermarkPos:e.watermarkPos,watermarkFont:e.watermarkFont,watermarkColor:e.watermarkColor,withCustomWatermark:e.withCustomWatermark,watermarkImg:e.watermarkImg,filter:e.filter,contrast:e.contrast,saturation:e.saturation,brightness:e.brightness,vignette:e.vignette,opacity:e.opacity,isStudio:e.isStudio,studio:t?o:void 0,projectSessionSettings:e.projectSessionSettings,sessionId:e.sessionId,sessionValues:e.sessionValues,mediaCache:e.mediaCache,bRoll:e.bRoll}})();if(o&&Object.keys(a.projectSessionSettings).length>0){const e=`session_${o}`,t={...a.projectSessionSettings};t.offlineOps=zd.getAllPendingOps(),sh.set(e,t),delete a.projectSessionSettings}else a.projectSessionSettings={...a.projectSessionSettings,offlineOps:zd.getAllPendingOps()};if(sh.set("state",function(e){var t;if(!e.studio)return e;delete e.studio.sharedDoc;const{scenes:o}=e.studio,a=s.cloneDeep(o[0].layers);for(const s of a)delete s.base64_img,delete s.file,delete s.framesAndTimes,delete s.waveformData,delete s.optimizedPreviewFile,delete s.local_url;const i={...o[0],layers:a};let n={};return(null==(t=e.studio.allLayers)?void 0:t.byId)&&(n=s.cloneDeep(e.studio.allLayers.byId),Object.values(n).forEach((e=>{delete e.local_url}))),{...e,studio:{...e.studio,allLayers:{byId:n},scenes:[i]}}}(a)),null==(e=a.studio)?void 0:e.localId){const e=`video_usage_${a.studio.localId}`;sh.set(e,{records:Object.fromEntries(mF.map.entries()),lastUpdated:Date.now()})}}catch(t){console.error(t)}};const DU="Loading-module_loader_-f6I0",OU="Loading-module_loading-wrapper_-mT3i",LU="Loading-module_loading-description_Oh1HH",FU="Loading-module_loading-secondary_5AM-p",MU=_.memo((({loaderStyles:e,secondaryText:t,text:o,textOnly:a=!1,textStyles:i,wrapperStyles:s})=>{let n="Loading ...";return null!=o&&(n=o),w.jsxs("div",{className:OU,"data-cy":"loading-container","data-testid":"loading-container",style:s,children:[!a&&w.jsx("div",{className:DU,style:e}),w.jsxs("div",{children:[w.jsx("div",{className:LU,style:i,children:n}),t&&w.jsx("div",{className:FU,style:i,children:t})]})]})})),UU="SignInButtons-module_resetContainer_-J8T0",BU="SignInButtons-module_resetButtonContainer_k7B-5",VU="SignInButtons-module_resetButton_Ga7Z0",WU="SignInButtons-module_googleIcon_KLAsx",GU="SignInButtons-module_orText_fLjgk",HU="SignInButtons-module_wrapper_is7L9",$U="SignInButtons-module_ssoButtonWrapper_wB7ZC",KU=["/upload/loop","/upload/stop-motion","/editor/loop-video","/editor/stop-motion"],zU={"/studio/editor":An,"/editor/subtitles":"Subtitles Project","/editor/resize":"Resized Project","/editor/add-audio-to-video":"Add Audio Project","/editor/image-to-video":"Image to Video Project","/editor/loop-video":"Looped Video Project","/editor/filters":"Filtered Video Project","/editor/convert":"Converted Video Project","/":An,"/editor/mute-video":"Muted Video Project","/editor/reverse":"Reversed Video Project","/editor/rotate":"Rotated Video Project","/editor/stop-motion":"Stop Motion Project","/editor/trimmer":"Trimmed Audio Project","/editor/video-speed":"Changed Speed Project"},YU={"3gp":!0,avi:!0,flv:!0,gif:!0,hls:!0,jpeg:!0,jpg:!0,mov:!0,mp3:!0,mp4:!0,png:!0,wmv:!0,webp:!0,webm:!0};class JU extends Error{constructor(e){super(e),this.name="ExtractValidationError"}}const qU="ErrorBoundary-module_errorText_G7zgY";let XU=!1;class QU extends _.Component{static getDerivedStateFromError(){return{hasError:!0}}constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){console.error(e,t);const o=ZU(e);if(XU||(Fm(ym.ERROR_BOUNDARY,{Error:o,"Full Refresh":this.props.refreshOnError}),function(e,t){const o={__FORCE_SAMPLE:!0,errorInfo:t};try{let a="Unknown";try{a=e.constructor.name}catch{a="Unknown "+typeof e}o.errorClassName=a;const{componentStack:i}=t||{};!eB(e.stack)&&eB(i)&&(o.originalStack=e.stack,e.stack=i)}catch(a){console.error(a)}R(e,{extra:o,tags:{errorBoundary:!0}})}(e,t),XU=!0),!this.props.refreshOnError)return;const a=new URLSearchParams(window.location.search);a.get("refresh")||(a.set("refresh","true"),window.location.search=a.toString())}render(){return this.state.hasError?this.props.refreshOnError?null:w.jsx("div",{className:qU,children:"Something went wrong while loading Kapwing. Please try refreshing the page or trying again later."}):this.props.children}}function ZU(e){var t;const o="object"==typeof e;let a=e.toString();if(null==(t=a.startsWith)?void 0:t.call(a,"[")){o&&"message"in e&&(a=e.message);const t=o&&e.constructor?e.constructor.name:"";t&&(a=`${t}: ${a}`)}return a}function eB(e){if("string"!=typeof e)return!1;return e.split("\n").filter((e=>e.includes("at ")&&e.includes("/assets/"))).some((e=>{const t=e.match(/\/assets\/(?!vendor).*\..*\.js/);return t&&t.length>0}))}class tB extends Error{constructor(e){super(),this.name="GetMediaInfoError",this.message=e}}const oB={ellipse:"Ellipse",progressBar:"Progress Bar",rectangle:"Rectangle",line:"Line",arrow:"Line",svg:"Shape"},aB=e=>"pastedLink"!==(null==e?void 0:e.source)||(!!(null==e?void 0:e.local_url)||!!(null==e?void 0:e.preview)),iB=e=>{const{emojiDescription:t,name:o,originalName:a,projectName:i,searchQuery:s,shapeType:n,text:r,type:l,userSetName:d}=e,c=!a&&o?o.replace(/\s*-.*?\.\s*/gi,"."):a;let u="";switch(l){case"video":u=d||i||s||c||"Video";break;case"audio":u=d||i||s||c||"Audio";break;case"image":u=d||t||i||s||c||"Image";break;case"text":u=d||r||"Text";break;case"shape":u=d||oB[n??""]||"Shape";break;default:u=d||oB[n??""]||"Placeholder"}return u},sB=yc((()=>import("./index-52b3a306.js").then((e=>e.i))),["assets/index-52b3a306.js","assets/vendor-3b0a39e0.js"]),nB=Math.random()<.01,rB=()=>{};function lB(e){let t="";const o=e.byteLength;for(let a=0;a<o;a+=1)t+=String.fromCharCode(e.getUint8(a));return`data:image/jpeg;base64,${window.btoa(t)}`}function dB(e,t){let o=e;return e.includes(t)&&(o=e.substring(0,e.indexOf(t)+t.length)),o}function cB(e=""){return e?e.includes("youtube")||e.includes("youtu.be")?"youtube":e.includes("kapwing")||e.includes("kapwi.ng")?"kapwing":e.includes("tiktok")?"tiktok":e.includes("instagram")?"instagram":e.includes("twitter")?"twitter":e.includes("twitch")?"twitch":e.includes("vimeo")?"vimeo":e.includes("pinterest")?"pinterest":e.includes("dropbox")?"dropbox":e.includes("drive.google.com")?"google-drive":null:null}async function uB(e){const t=await(async e=>await Jr("/api/v1/tiktokextract/tiktokurl",{body:{url:e}}))(e);return t.url}async function mB({url:e,excludedMimes:t=[],analyticsCallback:o=rB,doDuplicateHandling:a=!1}){let i=function(e){if(!e)return"";let t=e.trim();if(e.length>2e3)return;const o=[".jpeg",".jpg",".png",".gif",".mp4"];for(const a of o)t=dB(t,a);return t}(e);const s=cB(i);s&&o({platform:s}),Math.random()<.1&&Fm(ym.EXTRACT_VIDEO_BEGINS,{url:i,platform:s});try{let e=null;try{e=await Qr("extract",{body:{url:i,doDuplicateHandling:a},timeout:6e4})}catch(n){if((null==i?void 0:i.includes("tiktok"))&&!(null==i?void 0:i.includes("tiktokcdn"))){i=await uB(i),e=await Qr("extract",{body:{url:i,doDuplicateHandling:a},timeout:6e4})}}if(e)return o({isDirectLink:e.isDirectLink,mimeType:e.mime,fileType:e.ext,stage:wd.ExtractionValidation}),function(e,t){let o="";if(e.hasUploadedAssetDuplicate)return e;if(e.url?e.duration&&e.duration>10800?o="Videos from a link must be shorter than 3 hours.":e.mime&&(t||[]).length&&t.includes(e.mime)?o=`Format ${e.mime} currently unsupported.`:e.url&&e.url.includes("accounts.google.com/Captcha")&&(o="Content is not supported"):o="No content found for this URL.",o)throw new JU(o)}(e,t),e;throw new JU("Something went wrong when extracting the video from this link. This platform or format might not be supported yet. Please try a different URL.")}catch(n){if(n instanceof Error){const e=n.name||"ExtractError",{message:t}=ph(n);Fm(ym.EXTRACT_VIDEO_FAILS,{url:i,name:e,platform:s,message:t})}throw n}}function pB(e){const t=new Promise(((t,o)=>{const a=new FileReader;a.readAsText(e),a.onload=()=>{a.result?t(a.result.includes("ANMF")?"animated":"static"):o(new Error("Reader result was empty"))},a.onerror=e=>o(e)})),o=new Promise((e=>{setTimeout((()=>{console.error("Failed to load webp within timeout, defaulting to static"),e("static")}),1e4)}));return Promise.race([t,o])}function hB(e,t){const o=function(e){var t;const[o="",a=""]=e.split(","),i=o.includes("base64")?atob(a):unescape(a),s=null==(t=o.split(":")[1])?void 0:t.split(";")[0],n=new Uint8Array(i.length);for(let r=0;r<i.length;r+=1)n[r]=i.charCodeAt(r);return new Blob([n],{type:s})}(t);return new File([o],e.name||"",{type:o.type})}const gB=async(e,t,o)=>{try{const{orientation:a,stripped:i}=await function(e){return new Promise(((t,o)=>{const a=new FileReader;a.onload=e=>{var o;const a=new DataView(null==(o=e.target)?void 0:o.result);if(65496!==a.getUint16(0,!1))return t({orientation:null});const i=a.byteLength;let s=2;for(;s<i;){if(a.getUint16(s+2,!1)<=8)return t({orientation:null});const e=a.getUint16(s,!1);if(s+=2,65505===e){if(1165519206!==a.getUint32(s+=2,!1))return t({orientation:null});const e=18761===a.getUint16(s+=6,!1);s+=a.getUint32(s+4,e);const o=a.getUint16(s,e);s+=2;for(let i=0;i<o;i+=1)if(274===a.getUint16(s+12*i,e)){const o=a.getUint16(s+12*i+8,e);return a.setUint16(s+12*i+8,0,e),t({orientation:o,stripped:lB(a)})}}else{if(65280!=(65280&e))break;s+=a.getUint16(s,!1)}}return t({orientation:null})},a.addEventListener("error",(e=>{o(e)})),a.readAsArrayBuffer(e)}))}(e);return a?(t&&t("Processing content ..."),function(e,t,o,a){return new Promise((i=>{const s=new Image;s.onerror=()=>{a("Something went wrong. Please make sure your media is a compatible format.",e,"cleanUpImage")},s.onload=()=>{const{width:t}=s,{height:n}=s,r=document.createElement("canvas"),l=r.getContext("2d");if(l){switch(o>4&&o<9?(r.width=n,r.height=t):(r.width=t,r.height=n),o){case 2:l.transform(-1,0,0,1,t,0);break;case 3:l.transform(-1,0,0,-1,t,n);break;case 4:l.transform(1,0,0,-1,0,n);break;case 5:l.transform(0,1,1,0,0,0);break;case 6:l.transform(0,1,-1,0,n,0);break;case 7:l.transform(0,-1,-1,0,n,t);break;case 8:l.transform(0,-1,1,0,0,t)}l.drawImage(s,0,0),i(hB(e,r.toDataURL("image/jpeg")))}else a("No ctx",e,"cleanUpImage")},s.src=t||""}))}(e,i,a,o)):e}catch(IGe){return e}};function fB(e=""){const t=e.split(".").pop();return t?t.split("?").shift():e}function yB(e,t){const o=e&&fB(e);return"m3u8"===o?"hls-to-mp4":"3gp"===o||"video/3gpp"===t?"3gp-to-mp4":"mov"===o||"video/quicktime"===t?"mov-to-mp4":"mp4"===o||"video/mp4"===t?"mp4-to-mp4":"avi"===o||["video/avi","video/x-msvideo"].includes(t)?"avi-to-mp4":"flv"===o||"video/x-flv"===t?"flv-to-mp4":"wmv"===o||"video/x-ms-wmv"===t?"wmv-to-mp4":"m4a"===o||"audio/x-m4a"===t?"m4a-to-mp3":"mp3"===o||"audio/mpeg"===t?"mp3-to-mp3":"heic"===o||"image/heic"===t?"heic-to-jpeg":"heif"===o||"image/heif"===t?"heif-to-jpeg":"none"}function vB(e){var t;const{name:o,type:a}=e,i=o?o.split("?")[0]:o;if(a)return a;switch(i?(null==(t=i.split(".").pop())?void 0:t.toLowerCase())||"":void 0){case"mkv":return"video/x-matroska";case"ttf":return"font/ttf";case"otf":return"font/otf";default:return null}}function _B(e){return"mpd"===e.split(".").pop()}function wB(e){return["image/gif","image/jpg","image/jpeg","image/png","image/heic","image/heif","image/svg+xml","image/webp"].includes(e)}function bB(e,t=null){const o=["video/mp4","video/quicktime","video/webm","video/mpeg","video/ogg","video/3gpp","video/avi","video/x-ms-wmv","video/x-flv","video/x-matroska","video/x-msvideo","video"];return t&&o.push(...t),o.includes(e)}const TB=e=>new Promise((t=>setTimeout((()=>t()),e))),xB=async(e,t)=>(await(Yg()||qg()?TB(10):TB(0)),new Promise((o=>{const a=document.createElement("video");a.preload="auto",a.src=e,(Yg()||qg())&&(a.volume=0,a.muted=!0,a.autoplay=!0,a.pause());let i=null,s=null;const n=()=>{i&&s&&o({success:!0,properties:{...i,...s}})};a.onerror=i=>{o({success:!1,properties:{type:zl.Video},errorInfo:{fileType:t,mediaType:"video",url:e,htmlVideoFailureEvent:"string"==typeof i?i:i.type,htmlVideoError:a.error&&ZU(a.error),htmlVideoErrorCode:a.error instanceof MediaError?a.error.code:0},errorEvent:i})},a.addEventListener("durationchange",(()=>{a.duration!==1/0?(s=EB(a,t),n()):(console.error("getVideoInfo returned Infinity duration"),o({success:!1,properties:{type:zl.Video},errorEvent:"Infinite duration",errorInfo:{fileType:t,mediaType:"video",url:e,htmlVideoFailureEvent:"Infinite duration",htmlVideoError:a.error&&ZU(a.error),htmlVideoErrorCode:a.error instanceof MediaError?a.error.code:0}}))})),SB(a).then((e=>{i={hasAudio:e},n()}))}))),SB=e=>new Promise((t=>{const o=()=>t(!0),a=Yg()||qg()?"canplay":"loadeddata",i=()=>e.mozHasAudio||(e.audioTracks||[]).length>0||e.webkitAudioDecodedByteCount>0;e.readyState>1?t(i()):e.error?o():(e.addEventListener("error",(()=>{o()}),{once:!0}),e.addEventListener(a,(()=>t(i())),{once:!0}))})),EB=(e,t)=>{const o=IB(t,e.videoHeight,e.videoWidth);return{duration:e.duration,height:e.videoHeight,type:o,width:e.videoWidth}},IB=(e,t,o)=>!e.includes("/webm")&&!e.includes("/mpeg")||t||o?e.includes("audio")?zl.Audio:zl.Video:zl.Audio;function CB(e,t,o){return new Promise((a=>{const i=new Image;i.onload=()=>{a({success:!0,properties:{height:i.height,type:zl.Image,width:i.width,...o&&{webpType:o}}})},i.onerror=o=>{a({success:!1,properties:{type:zl.Image},errorInfo:{fileType:t,mediaType:"image",url:e,htmlImageFailureEvent:"string"==typeof o?o:o.type}})},i.src=e}))}const kB=[{mime:"audio/x-m4a",type:zl.Audio}];async function AB(e,t){nB&&Fm(ym.GETMEDIAINFO_STARTED);const o=(t?vB(t):"")||vB({name:e})||"",a=bB(o),i=wB(o),s=Ee(e),n=!a&&(i||s);if(!n&&!a){const[a,i]=await Promise.all([CB(e,o),xB(e,o)]);if(i.success)return i.properties;if(a.success)return a.properties;let s,n;if("size"in t){if([s,n]=await Promise.all([NB(t),jB(t)]),s.success)return s.properties;if(n.success)return n.properties}console.debug("Failed to load unclear media type",i.errorInfo,a.errorInfo),PB({imageResErrorInfo:a.errorInfo,videoResErrorInfo:i.errorInfo,imageWasmRes:s,videoWasmRes:n,fileType:o,src:e});const r=kB.find((e=>e.mime===o));return r?(r.type,zl.Image,{type:r.type}):null}if(n){let a;try{a=await pB(t)}catch(IGe){}const i=await CB(e,o,a);let s;if(!i.success){if("size"in t&&a&&(s=await NB(t,a),s.success))return s.properties;kr()||console.debug("Failed to image video info",i.errorInfo),PB({imageResErrorInfo:i.errorInfo,imageWasmRes:s,fileType:o,src:e,layerType:zl.Image})}return i.properties}const r=await xB(e,o);if("duration"in r.properties){const{duration:e}=r.properties;if(Number.isNaN(e)||e>43200)throw Error("Asset has invalid duration")}if(!r.success){let a;if("size"in t&&(a=await jB(t),a.success))return a.properties;const i=(null==a?void 0:a.properties.type)||zl.Video;kr()||console.debug("Failed to load video info",r.errorInfo),PB({videoResErrorInfo:r.errorInfo,videoWasmRes:a,fileType:o,src:e,layerType:i})}return r.properties}async function jB(e){const t=await RB(e),o={hasAudio:!1};for(const a of t.media.track)"General"===a["@type"]?o.duration=parseFloat(a.Duration):"Video"===a["@type"]?(o.type=zl.Video,o.width=parseFloat(a.Width),o.height=parseFloat(a.Height)):"Audio"===a["@type"]&&(o.hasAudio=!0);return!o.type&&o.hasAudio&&(o.type=zl.Audio,o.height=0,o.width=0),o.duration&&o.type===zl.Audio&&o.hasAudio||o.duration&&o.type&&o.height&&o.width&&o.type===zl.Video?(o.didFailHtmlMediaCheck=!0,{success:!0,properties:o}):{success:!1,properties:{type:o.type}}}async function NB(e,t){const o=await RB(e),a={};a.webpType=t||await pB(e);for(const i of o.media.track)"Image"===i["@type"]&&(a.type=zl.Image,a.width=parseFloat(i.Width),a.height=parseFloat(i.Height));return a.type&&a.height&&a.width&&a.webpType?(a.didFailHtmlMediaCheck=!0,{success:!0,properties:a}):{success:!1,properties:{type:a.type}}}async function RB(e){const t=await Ie({format:"JSON",locateFile:()=>"/MediaInfoModule.wasm"});return JSON.parse(await t.analyzeData((()=>e.size),((t,o)=>new Promise(((a,i)=>{const s=new FileReader;s.onload=e=>{var t;(null==(t=e.target)?void 0:t.error)&&i(e.target.error),e.target&&e.target.result&&a(new Uint8Array(e.target.result)),i()},s.readAsArrayBuffer(e.slice(o,o+t))})))))}function PB({imageResErrorInfo:e,videoResErrorInfo:t,imageWasmRes:o,videoWasmRes:a,fileType:i,src:s,layerType:n}){const r=n||(null==o?void 0:o.properties.type)||(null==a?void 0:a.properties.type)||"unclear",l=!!o||!!a;nB&&(R(new tB("getMediaInfo failure"),{extra:{__FORCE_SAMPLE:!0,src:s},tags:{isFile:l,mediaType:r}}),Fm(ym.GETMEDIAINFO_FAILURE,{fileType:i,mediaType:r,url:s,htmlImageFailureEvent:null==e?void 0:e.htmlImageFailureEvent,htmlVideoFailureEvent:null==t?void 0:t.htmlVideoFailureEvent,htmlVideoError:null==t?void 0:t.htmlVideoError,htmlVideoErrorCode:null==t?void 0:t.htmlVideoErrorCode,isFile:l}))}const DB=["video/3gpp","video/avi","video/x-flv","video/x-ms-wmv","video/x-msvideo","audio/x-m4a","image/heif","image/heic"],OB=["m3u8","3gp","3gpp","mov","avi","flv","wmv","heic","heif"];async function LB(e,t){if(null==t?void 0:t.conversion_id)return!0;const o=e.type;if(DB.includes(o))return!0;if(!["audio/mpeg","video/quicktime","video/mp4"].includes(o))return!1;try{if(t&&(t.width||t.height)&&!t.didFailHtmlMediaCheck)return!1;if("video/quicktime"===o)return!0;if("audio/mpeg"===o){const t=await async function(e){var t;const o=await RB(e),a=null==(t=null==o?void 0:o.media)?void 0:t.track;for(const i of a)if("OverallBitRate_Mode"in i)return i.OverallBitRate_Mode;return"Unknown"}(e);return"VBR"===t}const a=await e.arrayBuffer(),i=new Uint8Array(a),s=await(await sB).mp4.probe.tracks(i);if(!s.length)return!0;for(let e=0;e<s.length;e+=1)if("video"===s[e].type)return!0;return!1}catch(a){return console.error(a),!0}}function MB(e,t=null){const o=["audio/aac","audio/m4a","audio/mp3","audio/mp4","audio/mpeg","audio/ogg","audio/wav","audio/webm","audio/x-m4a","audio/x-wav","audio/flac"];return t&&o.push(...t),o.includes(e)}const UB=new Set([zl.Text,zl.Shape]);function BB(e){if(UB.has(e.type))return!1;const{type:t,source:o,url:a,asset_id:i,uploadPending:s}=e;return s&&!e.preemptiveDownloadError?"uploadPending":!i&&("local"===o?"localSource":!(!["image","video"].includes(t)||o||a)&&"noSourceOrURL")}function VB(e){return e.requireConversion||e.videoConvertedState&&"complete"!==e.videoConvertedState}function WB(e){const t=[];for(const o of e)if(o.layers)for(const e of o.layers)(BB(e)||VB(e))&&t.push(e);return t}function GB(e){const t="trim"===e.studio.origin;if(e.sourceVideo&&!e.isStudio&&"local"===e.sourceVideo.source)return{reason:"SOURCE_VIDEO"};if((e.isStudio||t)&&e.studio.scenes){const t=function(e){const t=[];for(const o of e)if(o.layers)for(const e of o.layers)BB(e)&&t.push(e);return t}(e.studio.scenes);if(t.length>0)return{reason:"LAYERS",layerInfo:t.map((e=>{const[t,o]=TS(e);return{name:iB(e),start:t,end:o}}))}}return null}function HB(e){return!!GB(e)}const $B=(e={})=>{const t="image/*,image/heic,image/heif",o="audio/mpeg,audio/wav,audio/aac,audio/ogg,audio/x-wav,audio/aac,audio/mp4,audio/x-m4a,audio/*",a="video/mp4,video/webm,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv";return e.audiogramUpload?o:e.audioUpload?[o,a].join(","):e.disallowVideo?t:e.fontUpload?".ttf,.otf":e.logoUpload?"image/jpg,image/jpeg,image/png,image/heic,image/heif,image/svg+xml,image/webp":[t,o,a].join(",")},KB="EmailSiginIn-module_emailSignInContainer_WB8HJ",zB="EmailSiginIn-module_input_NtVRB",YB="EmailSiginIn-module_submit_4HPJx",JB="EmailSiginIn-module_codeContainer_-q-Zo",qB="EmailSiginIn-module_codeSentNote_AhxL7",XB="EmailSiginIn-module_receivedNoCode_LdDMS",QB="EmailSiginIn-module_agreement_CX3m4",ZB="EmailSiginIn-module_underlineLink_SnNj5",eV="EmailSiginIn-module_ssoLink_iiplu",tV=_.memo((({email:e,handleSuccess:t,onSSOSignIn:o})=>{const a=il(),[i,s]=h.useState(!1),[n,r]=h.useState(!1),[l,d]=h.useState(!1),[c,u]=h.useState(""),[m,p]=h.useState(""),{executeRecaptcha:g}=Ce(),f=ke(),y=h.useRef(null),v=tl((e=>e.sessionValues.onboarding)),_=tl((e=>e.config.RECAPTCHA_V3_SITEKEY)),b=tl((e=>e.config.RECAPTCHA_V2_SITEKEY));return h.useEffect((()=>{u(e||"")}),[e]),w.jsxs("form",{className:KB,onSubmit:e=>{e.preventDefault(),(async()=>{var e;if(n){try{s(!0);const e=await Jr("/api/v1/users/email/findUser",{body:{email:c,code:m}});e.newUser&&(a(ul({...v,newUser:!0})),a(kp([e.team])),a(ab([e.workspace]))),e.emailInvitedUser&&a(ul({...v,newUser:!0})),a(sp(e.user,e.token)),await Op(),Wm(e.user,e.newUser,"Email"),Zm(e.user,e.newUser,"Email",f.path),null==t||t()}catch(o){console.error(o),mh({description:"Failed to sign in with code.",error:o})}s(!1)}else if(Yp(c)){try{if(!g)throw new Error("Recaptcha loading ... please try again in a few seconds.");const t=await g("emailSignIn"),o=null==(e=y.current)?void 0:e.getValue();s(!0),await Jr("/api/v1/users/email/signin",{body:{email:c,v3CaptchaToken:t,v2CaptchaToken:o,recaptchaKeyV3:_,recaptchaKeyV2:b}}),r(!0)}catch(o){console.error(o),mh({description:"Failed to generate code for sign in.",error:o}),oh(o)&&d(!0)}s(!1)}else a(wl({description:"Please input a valid email address.",type:"error"}))})()},children:[w.jsx("input",{className:zB,disabled:n,placeholder:"Enter your email",readOnly:n,type:"email",value:c,"data-testid":"email-input",onChange:e=>u(e.target.value)}),!n&&l&&w.jsx("div",{style:{marginBottom:"10px"},children:w.jsx(Ae,{sitekey:b,ref:y})}),!n&&w.jsxs(w.Fragment,{children:[w.jsx("button",{className:YB,disabled:i,type:"submit","data-testid":"submit-email-button",children:i?"Loading...":"Continue with email"}),!!o&&w.jsx("div",{className:eV,children:w.jsx("div",{onClick:o,className:ZB,children:"Sign in with Single Sign-On (SSO) instead"})}),w.jsxs("div",{className:QB,children:["By using Kapwing, you agree to our"," ",w.jsx("a",{href:"/policies/terms-of-service",target:"_blank",className:ZB,children:"Terms of Service"})," ","and"," ",w.jsx("a",{href:"/policies/privacy",target:"_blank",className:ZB,children:"Privacy Policy"}),"."]})]}),n&&w.jsxs("div",{className:JB,children:[w.jsxs("div",{className:qB,children:[w.jsx("span",{children:"Code sent!"})," Check your email for a login code from Kapwing."]}),w.jsx("input",{className:zB,placeholder:"Paste Sign In Code",type:"text",value:m,onChange:e=>{return t=e.target.value,void p(t.toUpperCase());var t}}),w.jsx("button",{className:YB,disabled:i,type:"submit","data-testid":"submit-code-button",children:i?"Loading...":"Continue with login code"}),w.jsx("div",{className:XB,children:"If you didn't receive an email, please check your spam folder or try a different sign in option."}),!!o&&w.jsx("div",{className:eV,children:w.jsx("div",{onClick:o,className:ZB,children:"Sign in with Single Sign-On (SSO) instead"})})]})]})})),oV="SSOSignIn-module_errorMessage_ly7D9",aV="SSOSignIn-module_input_XySdJ",iV="SSOSignIn-module_loginLink_fcG5J",sV="SSOSignIn-module_underlineLink_lA1EV",nV="SSOSignIn-module_submitButton_2FR9C",rV="SSOSignIn-module_disabled_rg4wU",lV=_.memo((({onEmailSignIn:e})=>{const[t,o]=h.useState(!1),[a,i]=h.useState(""),[s,n]=h.useState(""),[r,l]=h.useState(!1);h.useEffect((()=>{if(a&&a.length>3){const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a);l(e)}else l(!1)}),[a]);const d=async()=>{if(a&&r){o(!0);try{const{success:e}=await Yr("/api/v1/sso/saml",{params:{email:a}});e&&(window.location.href=`/api/v1/sso/login?email=${encodeURIComponent(a)}`)}catch(IGe){404===IGe.status?n(IGe.message||"This account is not configured for SSO.  Please sign in with Google or with another email."):n(IGe.message||"Something went wrong. Please try again later."),console.error(IGe)}o(!1)}else n("Please enter a valid email")};return w.jsxs("div",{children:[w.jsx("input",{name:"email",className:aV,disabled:t,placeholder:"Enter your email",type:"email",value:a,"data-testid":"email-input",onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&r&&d()}}),s&&w.jsx("div",{className:oV,children:s}),w.jsx("button",{className:`${nV} ${!r||t?rV:""}`,disabled:!r||t,onClick:d,children:"Log In"}),w.jsx("div",{className:iV,children:w.jsx("div",{onClick:e,className:sV,children:"Sign in with Google or email a code"})})]})}));class dV extends h.Component{constructor(e){super(e),i(this,"loadFB",(()=>{const{facebookAppId:e}=this.props;"undefined"!=typeof FB?(FB.init({appId:e,cookie:!0,xfbml:!0,version:"v5.0"}),this.setState({fbInitialized:!0})):setTimeout(this.loadFB,200)})),i(this,"handleError",((e,t="signIn",o="Sign In")=>{const{showToast:a}=this.props;let i=e;e||(i="An error occurred during sign in. Please try again later."),Fm(ym.SIGN_IN_ERROR_OCCURRED,{"Error Type":t,Details:o}),a({description:i,type:"error"}),this.setState({loading:!1})})),i(this,"handleSignInWithFacebook",(async()=>{const{fbInitialized:e}=this.state;e?(this.setState({loading:!0}),FB.getLoginStatus((e=>{"connected"===e.status?this.handleFacebookResponse(e.authResponse):FB.login((e=>{if("connected"===e.status)this.handleFacebookResponse(e.authResponse);else{const t="Couldn't log in with Facebook right now. Please try again later.";console.error("Fb error:",e),this.handleError(t,"facebookResponse",e.error)}}),{scope:"public_profile,email"})}))):Fm(ym.SIGN_IN_ERROR_OCCURRED,{"Error Type":"signIn",Details:"Facebook Not Initialized"})})),i(this,"handleFacebookResponse",(e=>{const{match:t,onSuccess:o,setOnboarding:a,onboarding:i}=this.props;(async function(e){const{dispatch:t}=sr();t({type:"REQUEST_USER"});const o=await Jr("/api/v1/users/facebook/findUser",{body:{user:e}}),{user:a,token:i,newUser:s}=o;if(t(sp(a,i)),Wm(a,s,"Facebook"),s){const{team:e,workspace:a}=o;t(ab([a])),t(kp([e]))}return o})(e).then((e=>{Zm(e.user,e.newUser,"Facebook",t.path),o&&o(),e.newUser&&a({...i,newUser:!0})})).catch((e=>{this.handleError(e.message,"fetchFacebookUser",e.message)}))})),i(this,"signInWithGoogle",(async()=>{const{location:e,uploadPending:t,showToast:o,redirectToPathname:a,immediateRedirectPathname:i,mockSignIn:s,forceNavigationTo:n,onSuccess:r}=this.props;if(window.Cypress)return setTimeout((()=>{s(),PU(),null==r||r()}),1e3),void this.setState({loading:!0});if(t)return void o({description:"There is an in-progress upload in your project. Please wait until it completes to sign in.",type:"warning"});this.setState({loading:!0});let l={pathname:i||e.pathname,goToNext:a||""};n&&(l={pathname:n,goToNext:""});const d=await Yr("/api/v1/users/google/getOAuthURL",{params:l});PU();const{url:c}=d;window.location.assign(c)})),i(this,"handleSSOSignIn",(()=>{this.props.setSSOSignIn&&this.props.setSSOSignIn(!this.props.ssoSignIn)})),i(this,"renderResponseLoading",(()=>w.jsxs("div",{className:HU,children:[w.jsx(MU,{text:""}),w.jsxs("div",{className:UU,children:[w.jsx("span",{children:"Use the OAuth dialog window to finish signing in."}),w.jsx("div",{children:"Having trouble signing in?"}),w.jsx("div",{className:BU,children:w.jsx("div",{className:VU,onClick:()=>{this.setState({loading:!1})},children:"Click here to try again"})})]})]}))),this.state={fbInitialized:!1,loading:!1}}componentDidMount(){this.loadFB()}renderButtons(){const{email:e,smallTheme:t}=this.props;return this.props.ssoSignIn?w.jsx("div",{className:$U,children:w.jsx(lV,{onEmailSignIn:this.handleSSOSignIn})}):w.jsxs("div",{className:t?"small-theme":HU,children:[w.jsxs("button",{type:"button",className:"sign-in-dialog-google-button",onClick:this.signInWithGoogle,"data-cy":"signin-google-button",children:[w.jsx("div",{className:WU,children:w.jsx(Ne,{})}),w.jsx("span",{children:"Continue with Google"})]}),w.jsxs("div",{className:"sign-in-dialog-facebook-button",onClick:this.handleSignInWithFacebook,"data-cy":"signin-facebook-button",children:[w.jsx("div",{className:"sign-in-dialog-button-icon",children:w.jsx(Re,{})}),w.jsx("span",{children:"Continue with Facebook"})]}),w.jsx("div",{className:GU,children:"or"}),w.jsx(tV,{email:e,handleSuccess:this.props.onSuccess,onSSOSignIn:this.props.setSSOSignIn?this.handleSSOSignIn:void 0})]})}render(){const{loading:e}=this.state;return e?this.renderResponseLoading():this.renderButtons()}}const cV=je(g.connect((e=>({currentUser:e.currentUser,facebookAppId:e.config.FACEBOOK_APP_ID,uploadPending:HB(e),onboarding:e.sessionValues.onboarding})),(e=>ye({requestUser:br,mockSignIn:zp,setOnboarding:ul,showToast:wl},e)))(dV)),uV="SignInDialog-module_dialogBackground_cjx59",mV="SignInDialog-module_dialogContainer_oIPd3",pV="SignInDialog-module_dialogHeader_3ttx-",hV="SignInDialog-module_description_LESgO",gV="SignInDialog-module_closeContainer_W-zyQ",fV="SignInDialog-module_left_R2euZ",yV="SignInDialog-module_right_YD0O5",vV="SignInDialog-module_rightImage_2Fe65";function _V(e){Fm(e)}const wV={fontSize:24},bV=_.memo((({description:e,email:t,hideSignIn:o,immediateRedirectPathname:a,onSuccess:i,redirectToPathname:s,customTitle:n,customImage:r})=>{const[l,d]=h.useState(!1),c=l?"Sign in with SSO":"Sign in to continue",u=l?"Kapwing works better if you sign in. Sign in to access your projects, save content to your workspace, preview beta features, and much more.":"Kapwing works better when you're signed in. Sign in to save content to a workspace, comment, and more.";h.useEffect((()=>{Fm(ym.INITIATE_SIGN_IN)}),[]);const m=async()=>{i&&i(),o()},p=e||u,g=n||c,f=document.querySelector(".app-container");if(!f){const e="Couldn't find .app-container to mount SignInDialog to.";return kr()?console.error(`${e} ${Ar}`):console.error(e),null}return _e.createPortal(w.jsxs(w.Fragment,{children:[w.jsx("div",{className:uV,onClick:o}),w.jsx("div",{className:mV,"data-cy":"signin-dialog","data-testid":"signin-dialog",children:w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:fV,children:[w.jsx("div",{className:pV,children:g}),w.jsx("div",{className:gV,onClick:o,children:w.jsx(ve,{style:wV})}),w.jsx("div",{className:hV,"data-cy":"signin-dialog-description",children:p}),w.jsx(cV,{ssoSignIn:l,setSSOSignIn:d,email:t,immediateRedirectPathname:a,onSuccess:m,redirectToPathname:s})]}),w.jsx("div",{className:yV,children:w.jsx("img",{src:r||"https://cdn-useast1.kapwing.com/static/fQJ-signin-dialog=right-default.webp",alt:"Sign in to Kapwing",className:vV})})]})})]}),f)})),TV="OverlayWrapper-module_overlayHeader_14EqT",xV="OverlayWrapper-module_noOverlayBackground_FHvwb",SV="OverlayWrapper-module_overlayBackground_tYQaR",EV="OverlayWrapper-module_overlayInput_pNrjg",IV="OverlayWrapper-module_overlayFullContainer_rNCOK",CV="OverlayWrapper-module_signInOverlayContainer_ZMa78",kV="OverlayWrapper-module_uploadOverlayResultsContainer_9PTJo",AV="OverlayWrapper-module_fontOverlayContainer_o0-nD",jV="OverlayWrapper-module_replaceOverlayContainer_g1EYo",NV="OverlayWrapper-module_uploadOverlayContainer_49dxN",RV="OverlayWrapper-module_smallLightThemeOverlayContainer_eCk5q",PV="OverlayWrapper-module_lightThemeOverlayContainer_u9XTJ",DV="OverlayWrapper-module_versionHistoryOverlayContainer_Wjnrx",OV="OverlayWrapper-module_miniLightOverlayContainer_Vjyth",LV="OverlayWrapper-module_miniOverlayContainer_y8m-s",FV="OverlayWrapper-module_smallOverlayContainer_N3-vX",MV="OverlayWrapper-module_studioOverlayContainer_-P7jS",UV="OverlayWrapper-module_videoPreviewOverlayContainer_DzSZ1",BV="OverlayWrapper-module_overlayContainerNoPadding_pO7Nr",VV="OverlayWrapper-module_overlayContainerNoScrollbar_KZ1yE",WV="OverlayWrapper-module_exit_IbZ9z",GV="OverlayWrapper-module_darkExit_eBe8W",HV="OverlayWrapper-module_exportPanelOverlayContainer_GhIQF",$V="OverlayWrapper-module_overlayContent_IyJac",KV="OverlayWrapper-module_overlayContentNoFlex_yhAX8",zV="OverlayWrapper-module_description_tB4Y9",YV="OverlayWrapper-module_buttonRow_02CMd",JV="OverlayWrapper-module_primaryButton_cMla-";let qV=class extends h.Component{constructor(e){super(e),i(this,"uploaderMounted",(()=>{const{location:e}=this.props;return e.pathname.includes("drag-upload")})),i(this,"setFiles",(e=>{var t,o;this.setState({uploadInProgress:!0}),null==(o=(t=this.props).onFilesChanged)||o.call(t,e)})),i(this,"handleDragUpload",(e=>{var t,o;this.setState({uploadInProgress:!0}),null==(o=(t=this.props).onFilesChanged)||o.call(t,e.target.files)})),i(this,"handleClick",(()=>{const{history:e,goBackToSelectedLayer:t,goBackToEditor:o=!0,editorPath:a,selectedLayerId:i,overlay:s,hideOverlay:n,onClose:r}=this.props;r?r():s&&s.key?n():t&&i?e.goBack():o?eE(a):e.goBack()})),i(this,"handleFileDrop",(e=>{this.setFiles(e.dataTransfer.files),e.preventDefault(),e.stopPropagation()})),i(this,"handleDragOver",(e=>{e.preventDefault(),e.stopPropagation()})),i(this,"handleDragEnter",(e=>{e.preventDefault(),e.stopPropagation()})),i(this,"renderDragInput",(()=>this.uploaderMounted()&&!this.state.uploadInProgress&&w.jsx("input",{"data-cy":"upload-input",className:EV,accept:this.props.accept||"image/*,video/mp4,video/*",onChange:this.handleDragUpload,type:"file",multiple:!0,onDragLeave:tE}))),this.state={videoPlayingOnMount:!1}}componentDidMount(){const{previewVideo:e}=this.props;this.setState({videoPlayingOnMount:!this.props.studioPaused}),this.props.pauseStudio(),e&&e.pause(),Pj()}componentDidUpdate(){this.props.studioPaused||this.props.pauseStudio()}componentWillUnmount(){this.state.videoPlayingOnMount&&oR(),Dj()}render(){const{children:e,keepScrollbar:t,noBackground:o}=this.props;let a=MV,i=WV;this.props.small?a=FV:this.props.lightTheme?(a=PV,i+=` ${GV}`):this.props.smallLightTheme?(a=RV,i+=` ${GV}`):this.props.uploadOverlayResultsTheme?a=kV:this.props.replace?a=jV:this.props.uploadOverlayTheme?a=NV:this.props.fontOverlayTheme?a=AV:this.props.signInDialog?(a=CV,i+=` ${GV}`):this.props.mini?a=LV:this.props.miniLight?a=OV:this.props.versionHistory?a=DV:this.props.useExportPanelStyle?a=HV:this.props.noPadding?a=BV:this.props.videoPreview&&(a=UV),t||(a=`${a} ${VV}`);const s=document.querySelector(".app-container");if(!s){const e="Couldn't find .app-container to mount OverlayWrapper to.";return kr()?console.error(`${e} ${Ar}`):console.error(e),null}return _e.createPortal(w.jsxs("div",{onDrop:this.handleFileDrop,onDragOver:this.handleDragOver,onDragEnter:this.handleDragEnter,children:[w.jsx("div",{className:o?xV:SV,onClick:this.handleClick,"data-cy":"overlay-background"}),this.renderDragInput(),w.jsx("div",{className:IV,children:w.jsxs("div",{className:a,"data-cy":"overlay-container",style:(()=>{const{width:e,backgroundColor:t,noMaxWidth:o,maxWidth:a,containerStyles:i}=this.props;let s={};return i&&(s={...i}),e&&(s={...s,width:e}),t&&(s={...s,backgroundColor:t}),a?s={...s,maxWidth:a}:o||a||(s={...s,maxWidth:800}),s})(),children:[!this.props.hideClose&&w.jsx("div",{"data-cy":"overlay-close",className:i,onClick:this.handleClick,children:w.jsx(ve,{})}),w.jsx("div",{className:(()=>this.props.overlayContentNoFlex?KV:$V)(),children:e})]})})]}),s)}};const XV=je(g.connect((e=>{var t;return{editorPath:e.editorPath,overlay:e.projectSessionSettings.overlay,previewVideo:e.previewVideo,selectedLayerId:(null==(t=e.studio.selectedItem)?void 0:t.id)||"",studioPaused:XN(e)}}),(e=>ye({hideOverlay:Xd,pauseStudio:iS},e)))(qV)),QV="Disclaimer-module_disclaimer_5eE9b",ZV="Disclaimer-module_underlineLink_v-1C8",eW=_.memo((()=>w.jsxs("div",{className:QV,children:["By upgrading, you understand the subscription will auto-renew until cancelled. You agree to Kapwing's"," ",w.jsx("a",{href:"/policies/terms-of-service",target:"_blank",rel:"noopener",className:ZV,children:"Terms of Service"})," ","and"," ",w.jsx("a",{href:"/policies/refund",target:"_blank",rel:"noopener",className:ZV,children:"Refund Policy"}),". Learn more about our"," ",w.jsx("a",{href:"/pricing",target:"_blank",rel:"noopener",className:ZV,children:"pricing here"}),"."]}))),tW={bold:"UpgradeModal-module_bold_caR1e",modalBackground:"UpgradeModal-module_modalBackground_Ow9-8",paywallHead:"UpgradeModal-module_paywallHead_ICRkE",paywallTitle:"UpgradeModal-module_paywallTitle_zsuH0",seatSelections:"UpgradeModal-module_seatSelections_WL8Eg",paywallSelections:"UpgradeModal-module_paywallSelections_e8yUA",seatSelectionDropdown:"UpgradeModal-module_seatSelectionDropdown_o1XBz",billingCycleSelection:"UpgradeModal-module_billingCycleSelection_uITwK",selection:"UpgradeModal-module_selection_qyZSv",monthly:"UpgradeModal-module_monthly_Vrdw2",yearly:"UpgradeModal-module_yearly_FxOLd",period:"UpgradeModal-module_period_zLCFv",seatSelectionUnit:"UpgradeModal-module_seatSelectionUnit_kP2vM",plans:"UpgradeModal-module_plans_Qh31h",plan:"UpgradeModal-module_plan_J3rGM",planName:"UpgradeModal-module_planName_jjuaU",planDescription:"UpgradeModal-module_planDescription_doPFt",billingConfigDetails:"UpgradeModal-module_billingConfigDetails_EThUv",pricingInfo:"UpgradeModal-module_pricingInfo_t2WQd",recommendedPlan:"UpgradeModal-module_recommendedPlan_vwcwT",pricingDetailsContainer:"UpgradeModal-module_pricingDetailsContainer_XO1Wh",calculation:"UpgradeModal-module_calculation_D673f",totalPrice:"UpgradeModal-module_totalPrice_roMjR",priceBreakdown:"UpgradeModal-module_priceBreakdown_cFg63",planFeatures:"UpgradeModal-module_planFeatures_-pYdL",upgradeButton:"UpgradeModal-module_upgradeButton_BXyEL",isRecommended:"UpgradeModal-module_isRecommended_GDV81",planPricingInfoContainer:"UpgradeModal-module_planPricingInfoContainer_1G18G",planFeaturesCTA:"UpgradeModal-module_planFeaturesCTA_u0zQH",planFeature:"UpgradeModal-module_planFeature_ieXTX",paywallContainer:"UpgradeModal-module_paywallContainer_66aIt",returnLink:"UpgradeModal-module_returnLink_jTS-W",isCurrent:"UpgradeModal-module_isCurrent_U4lTr",gapRight:"UpgradeModal-module_gapRight_BEnNK",alertOverlay:"UpgradeModal-module_alertOverlay_20XYs",overlayShow:"UpgradeModal-module_overlayShow_zZlQD",alertDialog:"UpgradeModal-module_alertDialog_HM8PQ",contentShow:"UpgradeModal-module_contentShow_bJLGO",alertTitle:"UpgradeModal-module_alertTitle_TFjgt",alertDescription:"UpgradeModal-module_alertDescription_zb2Mj",noScroll:"UpgradeModal-module_noScroll_7e257",loading:"UpgradeModal-module_loading_UfJ7F",shimmer:"UpgradeModal-module_shimmer_4NWlI",alertButtonContainer:"UpgradeModal-module_alertButtonContainer_PtO4n",alertButton:"UpgradeModal-module_alertButton_DPaLb",cancel:"UpgradeModal-module_cancel_9iWeV",confirm:"UpgradeModal-module_confirm_NUekN",dollarSign:"UpgradeModal-module_dollarSign_Uob9F",buildingsIcon:"UpgradeModal-module_buildingsIcon_ebLMQ",totalDueContainer:"UpgradeModal-module_totalDueContainer_k-lV4",bottom:"UpgradeModal-module_bottom_qDd67"},oW=e=>{const t=new URLSearchParams(e).get("upgrade");if(!t)return;const o=JSON.parse(decodeURIComponent(t)),{t:a,a:i,e:s,c:n,n:r,ii:l,o:d,irp:c}=o;return{teamId:a,action:i,extraAmplitudeEventProperties:s,closeable:n,numSeatsInit:r,intervalInit:l,overrideRecommendedUpgrade:d,immediateRedirectPathname:decodeURIComponent(c)}},aW=(e,t)=>{const{teamId:o,action:a,extraAmplitudeEventProperties:i,if:s,closeable:n,numSeatsInit:r,intervalInit:l,overrideRecommendedUpgrade:d,immediateRedirectPathname:c}=e,u={t:o,a:a,e:i,i:s,c:n,n:r,ii:l,o:d,irp:encodeURIComponent(String(c))},m=new URLSearchParams(t),p=encodeURIComponent(JSON.stringify(u));return m.set("upgrade",p),m.toString()},iW=e=>{const t=new URLSearchParams(e);return t.delete("upgrade"),t.toString()},sW=()=>{const e=Ac(),{showTypeform:t}=(()=>{const{showTypeform:e}=h.useContext(lM);return{showTypeform:e}})(),o=h.useCallback((async t=>{const{surveyCompleted:o}=await Jr(`/api/v2/teams/${e._id}/enterprise-form-response`,{parseJSON:!1,body:{responseId:t,formId:"pwHBPoOI"}});o&&Fm(ym.ENTERPRISE_FORM_SUBMITTED)}),[e._id]);return{openEnterpriseTypeform:h.useCallback((()=>t("pwHBPoOI",o)),[o,t])}};async function nW(){const{dispatch:e,state:t}=sr(),{teams:o}=t,{selectedTeamId:a}=o,i=await Yr(`/api/v2/teams/${a}`);e(jp(i._id,i))}function rW(e,t,o){return`${e} ${1===e||-1===e?t:o||`${t}s`}`}const lW=_.memo((function({onConfirm:e,plan:t,interval:o,seats:a,isOpen:i,setIsOpen:n}){const r=rU(),[l,d]=h.useState(null),[c,u]=h.useState(!1),m=Ac(),p=ou();h.useEffect((function(){t.type!==Cl.Enterprise&&m.stripeId&&Yr(`/api/v2/payment/upgrade/${m._id}/to/${t.type}`,{params:{interval:o,numSeats:a}}).then((e=>{r.current&&d(e.price)})).catch((()=>{u(!0)}))}),[m._id,m.stripeId,o,r,t,a]);const g=h.useCallback((()=>n(!1)),[n]),f=h.useMemo((()=>{const e=o===Il.Year?"annual":"monthly";return 0===l||c?`Click ‘Confirm’ to authorize the upgrade to the ${t.name} Plan. Your remaining ${p.name} credit will be applied towards the ${e} subscription fee until it’s spent. Afterward, your default payment method will be charged for the ${e} subscription fee.`:w.jsxs(w.Fragment,{children:["Click ‘Confirm’ to authorize a payment of $",w.jsx("span",{className:s.isNull(l)?tW.loading:"",children:s.isNull(l)?"":(l/100).toFixed(2)})," ","USD with your current payment method. After payment, your workspace will be upgraded to the ",t.name," Plan."]})}),[c,p.name,o,t.name,l]);return w.jsx(Pe,{open:i,onOpenChange:n,children:w.jsxs(De,{children:[w.jsx(Oe,{className:tW.alertOverlay,onClick:g}),w.jsxs(Le,{className:tW.alertDialog,children:[w.jsx(Fe,{className:tW.alertTitle,children:"Please Confirm Your Upgrade"}),w.jsx(Me,{className:tW.alertDescription,children:f}),w.jsxs("div",{className:tW.alertButtonContainer,children:[w.jsx(Ue,{asChild:!0,children:w.jsx("button",{type:"button",className:[tW.alertButton,tW.cancel].join(" "),children:"Cancel"})}),w.jsx(Be,{asChild:!0,children:w.jsx("button",{className:[tW.alertButton,tW.confirm].join(" "),onClick:e,children:"Confirm"})})]})]})]})})})),dW=w.jsx("div",{className:tW.returnLink,children:w.jsx("a",{href:"/",children:"No thanks, return to Kapwing home"})});const cW=_.memo((function({numSeats:e,setNumSeats:t,interval:o,setInterval:a}){var i;const s=Ac(),{subscription:n}=pM(),r=Math.max((null==(i=null==s?void 0:s.users)?void 0:i.length)||0,(null==n?void 0:n.quantity)||0,1);r>e&&t(r);const l=((e,t)=>{const o=t-e+2,a=new Array(o);for(let i=1;i<o;i++)a[i]=e+i;return a})(r,200);return w.jsxs("div",{className:tW.paywallSelections,children:[w.jsxs("div",{className:tW.seatSelections,children:[w.jsxs("select",{value:e,onChange:e=>{t(parseInt(e.target.value))},className:tW.seatSelectionDropdown,children:[w.jsx("option",{value:r,children:r}),l.map((e=>w.jsx("option",{value:e,children:e},e)))]}),w.jsx("span",{className:tW.seatSelectionUnit,children:Nc("member","members",e)})]}),w.jsxs("div",{className:tW.billingCycleSelection,children:[w.jsx("div",{className:[tW.selection,o===Il.Month?tW.monthly:tW.yearly].join(" ")}),w.jsx("div",{className:tW.period,onClick:()=>a(Il.Month),children:"Monthly Plan"}),w.jsx("div",{className:tW.period,onClick:()=>a(Il.Year),children:"Annual Plan"})]})]})}));const uW=_.memo((function({plan:e,seats:t,interval:o,metadata:a={},setLoadingCheckout:i,isRecommendedPlan:s=!1,isCurrentPlan:n=!1,closeModal:r,action:l=Vl.UNKNOWN,immediateRedirectPathname:d}){const c=il(),u=ku(),m=Ac(),p=be(),g=e instanceof Qc,[f,y]=h.useState(!1),v=ou(),[_,b]=h.useState(!1),T=h.useCallback((e=>{i(e),y(e)}),[i]),x=Ve(),S=$c(e.upgradesFrom||Cl.Free),{openEnterpriseTypeform:E}=sW(),I=cE((function(){Gm({interval:o,planTier:e.type,upgradeSource:l,teamId:m._id,quantity:t,extraAmplitudeEventProperties:{}})})),C=h.useMemo((()=>{if(g)return null;let a=e.planData.basePrice.year*t;return o===Il.Month&&(a=e.planData.basePrice.month*t),w.jsxs("div",{className:tW.totalDueContainer,children:[w.jsx("span",{children:"Total Due Today:"}),w.jsxs("div",{className:tW.bold,children:["$",a," USD"]})]})}),[e,t,o,g]),k=v.isPaid,A=h.useCallback((async function(){T(!0),b(!1);try{const a=await Jr(`/api/v2/payment/upgrade/${e.type}`,{body:{teamId:m._id,interval:o,numSeats:t}});if(!a.success)throw new Error(a.error);await nW(),r(),d&&x.push(d),c(wl({type:"success",description:"Your plan has been upgraded and your card has been charged."})),I()}catch(IGe){mh({error:IGe,description:"An error occurred while upgrading your plan."})}T(!1)}),[r,c,x,d,o,I,e.type,t,T,m._id]);async function j(){return v.isPaid?A():async function(){T(!0);const i=d&&"undefined"!==d?d:p.pathname,s=new URL(window.location.href),n=oW(p.search);n&&(n.numSeatsInit=t,n.intervalInit=o,s.search=aW(n,p.search));const r={originUrl:s.href,onSuccessPath:i,planTier:e.type,interval:o,numSeats:t,metadata:{name:m.name,teamId:m._id,seats:t,...a},teamId:m._id};try{const e=await Jr("/api/v1/stripe/createCheckoutSession",{body:r}),{checkoutUrl:t}=e;window.location.href=t}catch(l){T(!1),mh({description:"An error occurred while redirecting to checkout. Please try again later.",error:l})}}()}const N=h.useMemo((()=>n?"Current Plan":g?"Contact Sales":`Upgrade to ${e.name}`),[n,g,e.name]),R=Il.Month===o?e.planData.basePrice.month:e.planData.basePrice.year/12;return u&&n?null:w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:[tW.plan,s?tW.recommendedPlan:""].join(" "),children:[w.jsxs("div",{className:tW.planPricingInfoContainer,children:[w.jsx("div",{className:tW.planName,children:e.name}),w.jsx("div",{className:tW.planDescription,children:e.planDescription}),w.jsx("div",{className:tW.pricingInfo,children:g?w.jsx(We,{size:56,className:tW.buildingsIcon}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:tW.calculation,children:[rW(t,"member")," × $",R," per month ="]}),w.jsxs("div",{className:tW.pricingDetailsContainer,children:[w.jsxs("div",{className:tW.totalPrice,children:[w.jsx("span",{className:tW.dollarSign,children:"$"}),R*t]}),w.jsx("div",{className:tW.priceBreakdown,children:w.jsxs("div",{children:["USD per month"," ",Il.Month===o?null:w.jsx("span",{children:"paid annually"})]})})]})]})})]}),w.jsxs("div",{className:tW.planFeatures,children:[w.jsxs("div",{className:tW.planFeaturesCTA,children:["Everything in ",S.name,", plus:"]}),e.planData.modalReasons.map((e=>w.jsxs("div",{className:tW.planFeature,children:[w.jsx(Ge,{}),w.jsx("div",{children:e})]},e)))]}),w.jsxs("div",{className:tW.bottom,children:[C,w.jsxs("button",{type:"button",className:[tW.upgradeButton,s?tW.isRecommended:"",n?tW.isCurrent:""].join(" "),disabled:f||n,onClick:()=>{g?E():k?b(!0):n||j()},children:[n&&w.jsx(Ge,{className:tW.gapRight}),w.jsx("div",{children:f?"Loading...":N})]})]})]}),w.jsx(lW,{onConfirm:A,plan:e,interval:o,seats:t,isOpen:_,setIsOpen:b})]})})),mW={zIndex:1e3},pW={zIndex:1001},hW=_.memo((({onClose:e=(()=>tE()),closeable:t=!0,action:o=Vl.UNKNOWN,extraAmplitudeEventProperties:a={},numSeatsInit:i=1,intervalInit:s=Il.Year,overrideRecommendedUpgrade:n,immediateRedirectPathname:r})=>{var l;const d=ou(),c=il(),u=Ac(),[m,p]=h.useState(Math.max(i,(null==(l=null==u?void 0:u.users)?void 0:l.length)||1)),[g,f]=h.useState(s),{currentUser:y}=tl((e=>({currentUser:e.currentUser})),ol),v=be(),[_,b]=h.useState(!1),T=h.useMemo((()=>[$c(Cl.Pro),$c(Cl.Business),$c(Cl.Enterprise)]),[]);h.useEffect((function(){return document.body.classList.add(tW.noScroll),()=>{document.body.classList.remove(tW.noScroll)}}),[]);const x=(v.pathname.includes("/studio/editor")||v.pathname.includes("/videos/"))&&!(()=>{const{state:e}=sr();return!e.studio.teamId||e.teams.allTeams.some((t=>t._id===e.studio.teamId))})(),S=wc(y);h.useEffect((function(){S&&Op()}),[c,S]),h.useEffect((function(){!function(e,t={}){const{dripDiscount:o,extraProperties:a={}}=t,{state:i}=sr(),{currentUser:s}=i,n=$m(e),r=Hu(),l={"Upgrade Source":n,"Signed In":wc(s),"Team ID":r?r._id:"","Number of Workspace Members":r?r.users.length:1,"Brand Kit Pre-Populated":Nm()};o&&(l["Discount Value"]=o),Fm(ym.VISIT_CHECKOUT,{...l,...a})}(o||Vl.UNKNOWN,{extraProperties:a})}),[]);const E=h.useCallback((e=>e.stopPropagation()),[]),I=h.useCallback((()=>{t&&!_&&e()}),[t,_,e]),C=h.useMemo((()=>({extraAmplitudeEventProperties:JSON.stringify(a),paywallModalAction:o})),[o,a]);return x?w.jsxs(XV,{keepScrollbar:!0,onClose:e,children:[w.jsx("div",{className:TV,children:"You don't have access to manage this workspace subscription"}),w.jsx("div",{className:zV,children:"Contact the project owner to add you to this workspace."}),w.jsx("div",{className:YV,children:w.jsx("div",{onClick:e,className:JV,children:"Got It"})})]}):w.jsx(nM,{afterElement:!t&&dW,className:tW.modalBackground,backgroundStyle:mW,style:pW,id:"paywall-id",onClick:E,noCloseButton:!1===t,unsetCancelModal:I,cypressName:"paywall-modal",noPadding:!0,children:w.jsxs("div",{"data-testid":"studio-paywall-modal","data-cy":"studio-paywall-modal",className:tW.paywallContainer,children:[w.jsxs("div",{className:tW.paywallHead,children:[w.jsxs("h3",{className:tW.paywallTitle,"data-cy":"paywall-title",children:["Upgrade ",w.jsx("span",{children:(null==u?void 0:u.name)?u.name:" "})]}),w.jsx(cW,{interval:g,setInterval:f,numSeats:m,setNumSeats:p})]}),w.jsx("div",{className:tW.plans,children:T.map((t=>w.jsx(uW,{plan:t,seats:m,interval:g,metadata:C,setLoadingCheckout:b,isRecommendedPlan:n?n===t.type:d.upgradesTo===t.type,isCurrentPlan:d.type===t.type,closeModal:e,action:o,immediateRedirectPathname:r},t.className)))}),w.jsx(eW,{})]})})})),gW=_.memo((e=>{var t,o;const a=wc(tl((e=>e.currentUser))),i=be(),s=ou(),n=il(),[r,l]=h.useState(!1),d=h.useCallback((()=>{l(!0)}),[]);if(s.hasPermission(Wc(e.action||Vl.DEFAULT)))return null==(t=e.onClose)||t.call(e),n(wl({description:"Thanks for signing in. Kapwing Pro features are already available in your current team workspace.",type:"success"})),null;const c={action:e.action,onClose:e.onClose,onSuccess:e.onSuccess,closeable:e.closeable,extraAmplitudeEventProperties:e.extraAmplitudeEventProperties,numSeatsInit:e.numSeatsInit,intervalInit:e.intervalInit,overrideRecommendedUpgrade:e.overrideRecommendedUpgrade,immediateRedirectPathname:e.immediateRedirectPathname};return a?_e.createPortal(w.jsx(hW,{...c}),sM()):(r&&(null==(o=c.onClose)||o.call(c)),w.jsx(bV,{customTitle:"Sign in to upgrade to Pro",hideSignIn:d,immediateRedirectPathname:`${i.pathname}${i.search}`}))})),fW=e=>{try{const{user:t}=sr().state.currentUser,o=SP(t._id);if(!o)return!1;const{role:a}=o;return!!Kl[a].has(e)}catch(t){return console.error(t),!1}},yW=_.memo((()=>{const e=Ve(),t=oW(e.location.search),{if:o,...a}={...t};if(!t)return null;const i={...a,onClose:()=>{e.replace({search:iW(e.location.search)})}};return w.jsx(gW,{...i})})),vW=e=>{const{history:t,state:{currentUser:o}}=sr();if(wc(o)&&!fW(Gl.Update))return void hh({description:"Only team workspace admins can manage workspace subscriptions. Contact your admin to upgrade this workspace."});const a=aW(e,t.location.search);t.replace({search:a})},_W=(e,t)=>{const{teamId:o,action:a=Vl.DEFAULT}=e,i=o&&_c(o)||t;if(!i)throw Error("No team found");const s=$c(i.planTier),n=Wc(a);return s.hasPermission(n)},wW=(e,t,o)=>(...a)=>{const{if:i=!0}=e,s=_W(e,o);!i||s?t(...a):vW(e)},bW=()=>{const e=Ac();return h.useCallback(((t,o)=>wW(o,t,e)),[e])},TW=(e,t)=>{const o=Hu();if(!o)throw new Error("Paywall used without a team");return wW(t,e,o)},xW=async(e,t)=>{const o=Hu();if(!o)throw new Error("Paywall used without a team");return((e,t,o)=>async(...a)=>{const{if:i=!0}=e,s=_W(e,o);!i||s?await t(...a):vW(e)})(t,e,o)},SW="ProSparkle-module_proSparkle_I0j5q",EW=_.memo((({className:e=""})=>w.jsx("svg",{viewBox:"0 0 13 13",className:`${SW} ${e}`,children:w.jsxs("g",{children:[w.jsx("path",{d:"M4.63007 7.7206C4.63007 7.7206 6.69155 7.47571 7.37872 6.74119C8.06586 6.00663 8.2949 3.80298 8.2949 3.80298C8.2949 3.80298 8.52399 6.00663 9.21112 6.74119C9.8983 7.47571 11.9598 7.7206 11.9598 7.7206C11.9598 7.7206 9.8983 7.96544 9.21112 8.69996C8.52399 9.43453 8.2949 11.6382 8.2949 11.6382C8.2949 11.6382 8.06586 9.43453 7.37872 8.69996C6.69155 7.96544 4.63007 7.7206 4.63007 7.7206Z"}),w.jsx("path",{d:"M1.89838 3.53465C1.89838 3.53465 3.2938 3.36891 3.75894 2.87169C4.22409 2.37447 4.37912 0.882812 4.37912 0.882812C4.37912 0.882812 4.53415 2.37447 4.99933 2.87169C5.46446 3.36891 6.85987 3.53465 6.85987 3.53465C6.85987 3.53465 5.46446 3.70039 4.99933 4.19761C4.53415 4.69482 4.37912 6.18649 4.37912 6.18649C4.37912 6.18649 4.22409 4.69482 3.75894 4.19761C3.2938 3.70039 1.89838 3.53465 1.89838 3.53465Z"}),w.jsx("path",{d:"M0.278259 10.1277C0.278259 10.1277 1.67368 9.9619 2.13882 9.46469C2.60396 8.96747 2.75901 7.47583 2.75901 7.47583C2.75901 7.47583 2.91406 8.96747 3.37919 9.46469C3.84433 9.9619 5.23976 10.1277 5.23976 10.1277C5.23976 10.1277 3.84433 10.2934 3.37919 10.7906C2.91406 11.2878 2.75901 12.7795 2.75901 12.7795C2.75901 12.7795 2.60396 11.2878 2.13882 10.7906C1.67368 10.2934 0.278259 10.1277 0.278259 10.1277Z"})]})}))),IW="MoreDropdown-module_DropdownMenuContent_MdLQW",CW="MoreDropdown-module_DropdownMenuItem_53tXR",kW="MoreDropdown-module_DropdownMenuArrow_lbY2e",AW="MoreDropdown-module_IconButton_cws-h",jW="MoreDropdown-module_DropdownMenuSeparator_cyNtN",NW=_.memo((({content:e,options:t,buttonStyle:o})=>w.jsxs(He,{children:[w.jsx($e,{asChild:!0,children:w.jsx("button",{className:AW,"aria-label":"options",type:"button",style:o,children:e})}),w.jsx(Ke,{children:w.jsxs(ze,{className:IW,sideOffset:5,children:[t.map(((e,o)=>w.jsxs(_.Fragment,{children:[w.jsx(Ye,{className:CW,children:e}),o!==t.length-1&&w.jsx(Je,{className:jW})]},o))),w.jsx(qe,{className:kW})]})})]}))),RW="MoreOptions-module_optionTextStyle_LwmMb",PW=w.jsx(Xe,{color:"white",size:14}),DW=_.memo((({preset:e,isBrandkit:t,isSelected:o})=>{const a=il(),i=NU(Bl.SUBTITLE_PRESETS),s=bW(),n=()=>{const o=()=>{t?hU(e.presetId):mU(e)};if(i)o();else{s(o,{action:Vl.SUBTITLE_PRESETS})()}},r=async()=>{if("custom"===e.presetId)return void bU();const n=async()=>{a(Pf({presetId:e.presetId,undoable:!t})),o&&(e=>{const{dispatch:t}=sr();t(bC({updates:{preset:null},undoable:e}))})(!t),t&&await hU(e.presetId)};if(i||!t)await n();else{s(n,{action:Vl.SUBTITLE_PRESETS})()}};let l=!t||i;"custom"===e.presetId&&(l=!o);const d=h.useMemo((()=>{const e=[];return e.push(w.jsxs("div",{className:RW,onClick:n,children:[w.jsx("span",{style:{marginRight:4},children:t?"Remove from Brand Kit":"Add to Brand Kit"}),!i&&w.jsx(EW,{})]})),l&&e.push(w.jsx("div",{className:RW,onClick:r,children:"Remove style"})),e}),[l,i,t]);return w.jsx(NW,{content:PW,options:d})})),OW={home:"common-module_home_dwxJm",homeHowBackgroundWhite:"common-module_homeHowBackgroundWhite_vmec3",largeButton:"common-module_largeButton_ZMjCV",sectionContent:"common-module_sectionContent_RXf2a",sectionHeader:"common-module_sectionHeader_Wp-GR",spacer:"common-module_spacer_dKAl-",chevron:"common-module_chevron_kc7ia",splashText:"common-module_splashText_si5Bf",splashSubtext:"common-module_splashSubtext_hi-6Y",aboutSection:"common-module_aboutSection_gbps9",mobile:"common-module_mobile_zBvYh",desktop:"common-module_desktop_TC-Uw",screenReaderOnlyLabel:"common-module_screenReaderOnlyLabel_K9b41",disabled:"common-module_disabled_UJAXz",noScrollBar:"common-module_noScrollBar_fcjeZ",textOverflowEllipsis:"common-module_textOverflowEllipsis_XXKqM",disableTextHighlight:"common-module_disableTextHighlight_5v4tn",genericButtonBlue:"common-module_genericButtonBlue_AEzLO",button:"common-module_button_xffcT",buttonDisabled:"common-module_buttonDisabled_IFyWt",buttonSelected:"common-module_buttonSelected_Ynozr",buttonOk:"common-module_buttonOk_Mxmkv",buttonStacked:"common-module_buttonStacked_J-0Fc",doneButton:"common-module_doneButton_rJmqx",desktopNoWrap:"common-module_desktopNoWrap_RFpGQ",mobileNoWrap:"common-module_mobileNoWrap_Yzb8i",controlSectionContainer:"common-module_controlSectionContainer_7gwIs",section:"common-module_section_tLwa-",input:"common-module_input_YbU5B",cyanDoneButton:"common-module_cyanDoneButton_pVp-o",cyanDoneButton__disabled:"common-module_cyanDoneButton__disabled_dV8Rs",cyanDoneButtonContainer:"common-module_cyanDoneButtonContainer_gG-ju",genericButton:"common-module_genericButton_bMQdF",genericButtonSelected:"common-module_genericButtonSelected_neH99",groupControlContainer:"common-module_groupControlContainer_Ey5GV",controlSectionRows:"common-module_controlSectionRows_JRA98",controlSectionRowsTimeline:"common-module_controlSectionRowsTimeline_IfCRi",controlSectionRowsTwoPerRow:"common-module_controlSectionRowsTwoPerRow_uBMyX",controlSectionRowsExpandChildren:"common-module_controlSectionRowsExpandChildren_3U8le",controlSectionRowsFullWidth:"common-module_controlSectionRowsFullWidth_eQl5U",controlSectionRowsNoWrap:"common-module_controlSectionRowsNoWrap_qtGru",controlSectionRowsNoPadding:"common-module_controlSectionRowsNoPadding_eyQne",controlSectionRowsIconAndControl:"common-module_controlSectionRowsIconAndControl_WfBUs",controlSectionWrapColumns:"common-module_controlSectionWrapColumns_RbiTX",controlSectionScrollableColumn:"common-module_controlSectionScrollableColumn_Ggc8c",controlSectionTitle:"common-module_controlSectionTitle_eK-7P",controlSectionTitleNoPadding:"common-module_controlSectionTitleNoPadding_wYK6s",controlSectionDescription:"common-module_controlSectionDescription_g3zFo",smallControlButton:"common-module_smallControlButton_66vuT",smallControlButtonDisabled:"common-module_smallControlButtonDisabled_y37ZO",smallControlButtonSelected:"common-module_smallControlButtonSelected_Ljg8h",smallControlButtonLabel:"common-module_smallControlButtonLabel_snP0-",controlSectionRow:"common-module_controlSectionRow_u6iL8",controlButtonIcon:"common-module_controlButtonIcon_M-TfZ",controlButtonOnlyIcon:"common-module_controlButtonOnlyIcon_fPWdJ",controlButtonOnlyIconRoundedSmallTheme:"common-module_controlButtonOnlyIconRoundedSmallTheme_CWvZU",bigOverlayButton:"common-module_bigOverlayButton_xX5iR",glimmer:"common-module_glimmer_22uLC",pulse:"common-module_pulse_A-vPk",bigOverlayButtonSelected:"common-module_bigOverlayButtonSelected_-Wj3h",bigOverlayButtonDisabled:"common-module_bigOverlayButtonDisabled_l7MKa",bigOverlayButtonIcon:"common-module_bigOverlayButtonIcon_eIKka",incrementDecrementControl:"common-module_incrementDecrementControl_2Gekm",incrementDecrementControlLightTheme:"common-module_incrementDecrementControlLightTheme_jDQCZ",incrementDecrementControlSmallTheme:"common-module_incrementDecrementControlSmallTheme_J08Hq",incrementDecrementControlExtraSmallTheme:"common-module_incrementDecrementControlExtraSmallTheme_y-tuh",incrementDecrementButton:"common-module_incrementDecrementButton_gr5Cg",incrementDecrementButtonLightTheme:"common-module_incrementDecrementButtonLightTheme_4A7Ux",incrementDecrementButtonSmallTheme:"common-module_incrementDecrementButtonSmallTheme_o--rH",incrementDecrementControlValue:"common-module_incrementDecrementControlValue_GbQCR",incrementDecrementControlValueSmallTheme:"common-module_incrementDecrementControlValueSmallTheme_vk7eF",incrementControl:"common-module_incrementControl_nJorQ",decrementControl:"common-module_decrementControl_m0KqN",disabledIncrementDecrementButton:"common-module_disabledIncrementDecrementButton_R3Vsm",tooltip:"common-module_tooltip_IEcJR",selectDropDownContainer:"common-module_selectDropDownContainer_NlKZJ",selectDropDownDisplay:"common-module_selectDropDownDisplay_HFrQe",selectDropDownDisabled:"common-module_selectDropDownDisabled_X9Zmn",selectDropDownLabel:"common-module_selectDropDownLabel_gFBNq",selectDropDownLabelContainer:"common-module_selectDropDownLabelContainer_vZAcx",selectDropDownFlag:"common-module_selectDropDownFlag_RnEUc",proSparkle:"common-module_proSparkle_EJlfv",selectDropDownLink:"common-module_selectDropDownLink_Yjwua",selectDropDownList:"common-module_selectDropDownList_7W4-g",selectDropDownListScrollContainer:"common-module_selectDropDownListScrollContainer_3TxFJ",selectDropDownItem:"common-module_selectDropDownItem_KByJA",selectDropDownItemLeft:"common-module_selectDropDownItemLeft_--WW9",selectDropDownItemBottomStatic:"common-module_selectDropDownItemBottomStatic_-IweV",voiceCloneIcon:"common-module_voiceCloneIcon_DZNhc",bottomDivider:"common-module_bottomDivider_mOCEg",selectDropDownItemSelected:"common-module_selectDropDownItemSelected_77MOH",selectDropDownShowing:"common-module_selectDropDownShowing_5vpeC",dropDownButtonIcon:"common-module_dropDownButtonIcon_9RNVn",selectOptionIcon:"common-module_selectOptionIcon_XBQgr",dropDownAddIcon:"common-module_dropDownAddIcon_z-IDK",selectDropdownItemPreview:"common-module_selectDropdownItemPreview_BL8Jq",selectDropDownItemPlayIcon:"common-module_selectDropDownItemPlayIcon_vEUWr",transparentSelectInput:"common-module_transparentSelectInput_KUrCa",selectOptionContainer:"common-module_selectOptionContainer_6qHq3",dropDownHeader:"common-module_dropDownHeader_Gmc9r",noMargin:"common-module_noMargin_JdSFY",halfWidth:"common-module_halfWidth_y05xy",fullWidth:"common-module_fullWidth_X1atg",selectDropDownIcon:"common-module_selectDropDownIcon_TQcn4",controlButtonsContainer:"common-module_controlButtonsContainer_6EXgl",loadingIcon:"common-module_loadingIcon_Rj4Hi",spin:"common-module_spin_YSTXy",iconAndLabelRow:"common-module_iconAndLabelRow_tMdJT",dropdownDirectInput:"common-module_dropdownDirectInput_m4-FD"},LW=_.memo((e=>{const{children:t,style:o,noPadding:a}=e;return w.jsx("div",{className:a?OW.controlSectionTitleNoPadding:OW.controlSectionTitle,style:o,children:t})})),FW={width:17,height:17,cursor:"pointer"},MW={width:17,height:17,cursor:"pointer",marginLeft:10,marginBottom:2},UW=_.forwardRef(((e,t)=>{const{children:o,column:a,controlButtonRowStyle:i,customDataCy:s,fullWidthButtons:n,growButtons:r,iconAndControl:l,noWrap:d,noPadding:c,scrollable:u,style:m,timelineButtons:p,title:g,titleInvisible:f,twoButtonsPerRow:y,desktopNoWrap:v,mobileNoWrap:_,helpSlug:b,showHelpOverlay:T,description:x,hasSparkle:S,className:E,icon:I}=e;let C,k=OW.controlSectionRows;a&&u?k=OW.controlSectionScrollableColumn:a&&(k=OW.controlSectionWrapColumns),n?k=OW.controlSectionRowsFullWidth:y?k=OW.controlSectionRowsTwoPerRow:p?k=OW.controlSectionRowsTimeline:l?k=OW.controlSectionRowsIconAndControl:d?k=OW.controlSectionRowsNoWrap:c?k=OW.controlSectionRowsNoPadding:r&&(k=OW.controlSectionRowsExpandChildren),v&&(k+=` ${OW.desktopNoWrap}`),_&&(k+=` ${OW.mobileNoWrap}`),E&&(k+=` ${E}`),C=s||(g?`${g.replace(/ /g,"-").replace(/:/g,"")}-control`:"control");const A=h.useCallback((()=>{eE(`/studio/editor/${b}`)}),[b]);return w.jsxs("div",{id:`${C}-section`,"data-cy":`${C}-section`,className:OW.controlSectionContainer,ref:t,children:[g&&!f&&w.jsxs(LW,{noPadding:c,style:m,children:[w.jsxs("div",{children:[g," ",S&&w.jsx(EW,{}),w.jsx("span",{children:I})]}),b&&w.jsx(Qe,{style:FW,onClick:A}),T&&w.jsx(Qe,{style:MW,onClick:T})]}),x&&w.jsx("div",{className:OW.controlSectionDescription,children:x}),w.jsx("div",{"data-cy":`${C}-buttons`,className:k,style:i,children:o})]})})),BW=e=>h.createElement("svg",{width:20,height:20,viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},h.createElement("path",{d:"M5 9C7.20914 9 9 7.20914 9 5C9 2.79086 7.20914 1 5 1C2.79086 1 1 2.79086 1 5",stroke:"white"})),VW="BigOverlayButton-module_sparkleContainer_TiqaB",WW=_.memo((({style:e={},children:t})=>w.jsx("div",{className:OW.smallControlButtonLabel,style:e,"data-testid":"small-control-button-label",children:t}))),GW=_.forwardRef((({icon:e,title:t,label:o,children:a,handleClick:i,disabled:s=!1,selected:n,tooltip:r,hasSparkle:l,showGlimmer:d,iconStyles:c={},buttonStyles:u={},buttonCSSClassStyles:m="",showLoadingIcon:p=!1},g)=>{const f={[m]:m,[OW.bigOverlayButton]:!0,[OW.bigOverlayButtonDisabled]:s,[OW.bigOverlayButtonSelected]:n,[OW.glimmer]:d,[Td.tooltip]:r};let y=`big-overlay-button-${t}`;y=y.replace(/ +/g,"-");const v=h.useMemo((()=>({...c,height:17})),[c]);return w.jsxs("div",{className:Object.keys(f).filter((e=>f[e])).join(" "),onClick:e=>{i(),e.stopPropagation()},style:u,"data-cy":y,"data-testid":"big-overlay-button__button","data-selected":n,ref:g,children:[p?w.jsx(BW,{style:v,className:OW.loadingIcon,"data-testid":"big-overlay-button__loading-icon","data-cy":`${y}-loading-icon`}):"string"==typeof e?w.jsx("img",{src:e,alt:t,style:c,className:OW.bigOverlayButtonIcon,"data-testid":"big-overlay-button__image-icon"}):"function"==typeof e?w.jsx("div",{style:c,className:OW.bigOverlayButtonIcon,children:e({})}):null,o&&w.jsx(WW,{children:o}),a,l&&w.jsx("div",{className:VW,children:w.jsx(EW,{})}),w.jsx("div",{className:Td.tooltipTextBottomAlignLeft,"data-testid":"big-overlay-button__tooltip",children:r})]})})),HW=()=>{const e=h.useRef(null),t=e.current;if(null!==t)return t;const o=new Audio;return o.preload="none",e.current=o,o},$W=_.memo((({item:e,value:t,setMouseUp:o,handleConfirm:a,setClickingPreview:i,previewCurrentlyPlaying:s,setPreviewCurrentlyPlaying:n,alignItemsLeft:r})=>{const[l,d]=h.useState(!1),c=HW();return c.onended=function(){d(!1)},h.useEffect((function(){l&&s!==e.audioPreview&&(d(!1),c.pause())}),[l,e.audioPreview,c,s]),w.jsxs("button",{type:"button",className:`${r?OW.selectDropDownItemLeft:OW.selectDropDownItem} ${e.value.toString()===t.toString()?OW.selectDropDownItemSelected:""}`,onMouseDown:()=>o(!1),onMouseUp:t=>{0===t.button&&(o(!0),a(e.value))},children:[e.iconUrl&&("string"==typeof e.iconUrl?w.jsx("img",{className:OW.selectDropDownIcon,src:e.iconUrl,alt:`${e.value} icon item`}):w.jsx(e.iconUrl,{})),w.jsxs("div",{className:OW.selectDropDownLabelContainer,children:[e.flagUrl&&w.jsx("img",{className:OW.selectDropDownFlag,src:e.flagUrl,alt:"flag icon"}),w.jsx("span",{className:OW.selectDropDownLabel,children:e.label}),(null==e?void 0:e.isVoiceClone)&&w.jsx("div",{className:OW.voiceCloneIcon,children:w.jsx(Ze,{})})]}),e.audioPreview&&w.jsx("div",{className:OW.selectDropdownItemPreview,onMouseDown:t=>{t.stopPropagation(),i(!0),e.audioPreview&&(l?(d(!1),c.pause()):(c.src=e.audioPreview,d(!0),n(e.audioPreview),c.play(),Fm(ym.TEXT_TO_SPEECH_AUDIO_PREVIEW,{Voice:e.label,Source:"Media Sidebar"})))},onMouseUp:e=>{e.stopPropagation(),i(!1)},children:w.jsx("img",{className:OW.selectDropDownItemPlayIcon,src:l?"https://cdn-useast1.kapwing.com/static/RBD-PauseButtonGray.webp":"https://cdn-useast1.kapwing.com/static/QXm-playButtonGray.webp",alt:"play preview"})})]})})),KW="VoiceCloningOverlay-module_wrapper_GSGaa",zW="VoiceCloningOverlay-module_input_hH-wV",YW="VoiceCloningOverlay-module_lightInput_JwZV-",JW="VoiceCloningOverlay-module_background_AmHCl",qW="VoiceCloningOverlay-module_modal_H531O",XW="VoiceCloningOverlay-module_lightModal_JL4E8",QW="VoiceCloningOverlay-module_recordModal_oTMyA",ZW="VoiceCloningOverlay-module_lightRecordModal_QxG9v",eG="VoiceCloningOverlay-module_form_wLm-g",tG="VoiceCloningOverlay-module_container_7s9YL",oG="VoiceCloningOverlay-module_contentContainer_j-0P-",aG="VoiceCloningOverlay-module_header_LdrI0",iG="VoiceCloningOverlay-module_headerText_sec8P",sG="VoiceCloningOverlay-module_lightHeaderText_6tXIQ",nG="VoiceCloningOverlay-module_text_CarFD",rG="VoiceCloningOverlay-module_lightText_T1sJW",lG="VoiceCloningOverlay-module_sectionTitle_92EJc",dG="VoiceCloningOverlay-module_lightSectionTitle_v0VFR",cG="VoiceCloningOverlay-module_upload_5Ov6w",uG="VoiceCloningOverlay-module_lightUpload_y6UaT",mG="VoiceCloningOverlay-module_uploadIconRow_wKE5l",pG="VoiceCloningOverlay-module_lightUploadIconRow_n6UzG",hG="VoiceCloningOverlay-module_uploadText_p6VRV",gG="VoiceCloningOverlay-module_lightUploadText_-GxIi",fG="VoiceCloningOverlay-module_record_hCV6E",yG="VoiceCloningOverlay-module_lightRecord_Cg1GV",vG="VoiceCloningOverlay-module_fileInput_BUA6r",_G="VoiceCloningOverlay-module_close_ZGp1t",wG="VoiceCloningOverlay-module_lightClose_zaAjd",bG="VoiceCloningOverlay-module_filesContainer_WCuaE",TG="VoiceCloningOverlay-module_fileItem_DHjmd",xG="VoiceCloningOverlay-module_lightFileItem_14JCs",SG="VoiceCloningOverlay-module_uploadCompleteText_7N0R8",EG="VoiceCloningOverlay-module_lightUploadCompleteText_jowCO",IG="VoiceCloningOverlay-module_checkIcon_aGf7f",CG="VoiceCloningOverlay-module_fileDelete_uvvWw",kG="VoiceCloningOverlay-module_lightFileDelete_SNo-D",AG="VoiceCloningOverlay-module_bottomContainer_7XISR",jG="VoiceCloningOverlay-module_checkRow_iwUf5",NG="VoiceCloningOverlay-module_check_Dtnmk",RG="VoiceCloningOverlay-module_lightCheck_9JSpd",PG="VoiceCloningOverlay-module_cloneSubmit_rt-x5";let DG,OG;async function LG(e,t,o,a){let i,s;Fm(ym.FINISHED_RECORDING,{"Recording Duration":a});try{const e=await t.getInternalRecorder();if(i=await new Promise((t=>e.stop(t))),$g()&&(i=await et(i,a)),!i||!i.size)throw new Error("Screen recording failed. Please try again.")}catch(IGe){return void console.error(IGe)}e.getTracks().forEach((e=>e.stop())),t.reset(),s="screen"===o||"screen-video"===o||"video"===o?"video/webm":"audio/webm";const n=new File([i],`${o}-recording.webm`,{type:s});return n.recordType=o,n}function FG(e){const t=e.getTracks().some((e=>"video"===e.kind)),o=function(e,t){if("audio"===t)return new OG(e,{type:"audio",mimeType:"audio/webm",disableLogs:!1,timeSlice:3e4,recorderType:DG});return new OG(e,{videoBitsPerSecond:MG(e),type:"video",mimeType:"video/webm",disableLogs:!1,timeSlice:3e4,recorderType:DG})}(e,t?"video":"audio");return o.startRecording(),o}function MG(e){const t=e.getVideoTracks()[0];if(null==t)return;const o=t.getSettings();if("number"!=typeof o.width||"number"!=typeof o.height)return 8e6;const a=o.width>o.height?o.height:o.width;return"number"!=typeof o.frameRate||o.frameRate<=30?a<=360?1e6:a<=480?25e5:a<=720?5e6:8e6:a<=360?15e5:a<=480?4e6:a<=720?75e5:12e6}async function UG(e){let t;try{t=navigator.mediaDevices.getDisplayMedia?await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always",frameRate:24},audio:e}):await navigator.getDisplayMedia({video:{cursor:"always",frameRate:24},audio:e})}catch(o){if(o instanceof Error&&"NotAllowedError"===o.name)return"permissionError"}return t}async function BG(e,t,o){let a;try{a=await navigator.mediaDevices.getUserMedia({video:{deviceId:t},audio:!!e&&{deviceId:o}})}catch(i){if(i instanceof Error&&"NotAllowedError"===i.name)return"permissionError"}return a}async function VG(e){let t;try{t=await navigator.mediaDevices.getUserMedia({audio:{deviceId:e}})}catch{}return t}function WG(){let e=!1,t=!1,o=!1;return qg()||Yg()||(navigator.mediaDevices&&"getUserMedia"in navigator.mediaDevices&&(e=!0,t=!0),(navigator.mediaDevices&&"getDisplayMedia"in navigator.mediaDevices||"getDisplayMedia"in navigator)&&(o=!0)),{supportsAudio:e,supportsVideo:t,supportsScreenRecord:o}}"undefined"!=typeof window&&yc((()=>import("./RecordRTC-0e08eeb7.js").then((e=>e.R))),["assets/RecordRTC-0e08eeb7.js","assets/vendor-3b0a39e0.js"]).then((e=>{OG=e.RecordRTCPromisesHandler,DG=e.MediaStreamRecorder}));const GG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAABACAYAAABcIPRGAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKISURBVHgB7ZrRUeMwEIbXzL0fVHC+Co4Ozh2QDshVcKGCpAPoINcBuQoMFQAV2B04VPCzGjnAgKSVJQX5Qd/MjmciWdpfWiu2VkSFvFR0BACc8qVmO2fbj/ZYVdWe5gw73rC1bAPM3Ko6NDfUiI+O+7Jlq2kOKEfYOkynyy5iHPkO4XTQz0s2AdeI55oiCF6FoKe/ozScha5QJxTOgtKxokBiBFxQOn5TIDEhNPAl1QO45xA6owBiBIASwgKCfIkJoVlQBOSmCMhNEZCbIiA3RUBuioDcFAG5KQJyUwTk5tu4v9MYyu74M7WnGeDyURUuLTtmS6HRAekYhL5sPl6oEOot90lbJin3+h+Fcpsvzy4BNbn5T+l4Espry+/7kzHOTaP5i9zsKB1SW0Zf2Hc9c7AnJ5xhhGlJDRu3Qh+nlvtaVX5YRu8t9y/JzR+KexbUvVdCHdsm8lvYQee2rCpdwL5C+CDucMM+y83Hig9eFc2dLDAtUzNMaNdEZ6q88q5s7kzlyv5BdnwDz7SSY1AuD3Wqd5VVo8pZU+M3/MRLsfoqhHR+uGH7Pv78THqt3/lmYridNV82hqKe2/hpu2nlGL1L+iK4r7/BfsC9NB5dhOrD0b8cztCx7HrPCc5nefTtGnnlU+3b0AJutkiYpIb+s9oKfU6bfejVwkWHyJAaHV9DfrPdUAgeIg5CtmznE9ptPB0XnRcTa2MDa/KjJ71cPtHnt9ya7QfpVwPf7OYVL5k3FIsaXcSdiZhKh9THcuD3T5sCdaboeAdAoGejRXpafOVhKOgHMcWMtDGOR5+Zw9uOgTL15SStRj2p3QT9DbKb3Tk6uL8PlpSYsjOXmyIgN0VAboqA3LwAYEgiVSwvXnwAAAAASUVORK5CYII=",HG="DeviceSelectionDropdown-module_container_cJZbF",$G="DeviceSelectionDropdown-module_iconContainer_xsWRv",KG="DeviceSelectionDropdown-module_icon_QpfgX",zG="DeviceSelectionDropdown-module_select_F4C-0",YG=_.memo((({isDeviceToggled:e,devices:t,setSelectedDevice:o,selectedDevice:a,icon:i,lightTheme:s})=>{const n=h.useCallback((e=>{e&&o(e)}),[o]);return w.jsxs("div",{className:HG,children:[w.jsx("div",{className:$G,style:{opacity:e?"1.0":"0.4"},children:w.jsx("img",{className:KG,src:i,alt:"record icon"})}),w.jsx("div",{className:zG,children:w.jsx(tt,{onChange:n,isSearchable:!1,value:a,isDisabled:!e,options:t,placeholder:"",menuPortalTarget:document.body,styles:{control:(e,t)=>({...e,background:s?"white":"#202020",minHeight:"30px",height:"30px",border:s?"1px solid #404040":"none",cursor:"pointer",opacity:t.isDisabled?"0.4":"1.0"}),menuPortal:e=>({...e,zIndex:9999}),valueContainer:e=>({...e,height:"30px",padding:"0 6px"}),singleValue:e=>({...e,fontFamily:"Open Sans",fontStyle:"normal",fontWeight:"normal",fontSize:"12px",color:s?"#202020":"white"}),indicatorsContainer:e=>({...e,height:"30px"}),indicatorSeparator:()=>({display:"none"}),menu:e=>({...e,backgroundColor:s?"white":"#202020"}),menuList:e=>({...e,zIndex:1e3}),option:(e,{isFocused:t})=>({...e,fontFamily:"Open Sans",fontStyle:"normal",fontWeight:"normal",fontSize:"12px",color:s?"#202020":"white",backgroundColor:t?"#0083e2":""})}})})]})}));function JG(){return/^((?!chrome|android).)*safari/i.test(window&&window.navigator&&window.navigator.userAgent||"")}let qG;const XG=()=>(qG||(qG=new AudioContext,qG.addEventListener("statechange",(function(){switch(this.state){case"closed":console.error("Error: audioContext should never be closed"),f("AudioContext for some reason was closed."),qG=void 0;break;case"suspended":console.warn("warning: I don't think audiocontext should ever be suspended after it gets enabled??"),ZG()}})),Object.assign(window,{audioContextInstance:qG})),qG),QG=()=>{null!=qG&&"running"!==qG.state&&qG.resume(),window.removeEventListener("pointerdown",QG),window.removeEventListener("keydown",QG)},ZG=()=>{window.addEventListener("pointerdown",QG),window.addEventListener("keydown",QG)};"undefined"!=typeof window&&ZG();const eH=new WeakMap,tH=e=>{const t=eH.get(e);t&&(t.source.disconnect(),t.gainNode.disconnect())},oH=e=>Xs(eH,e,{insert(){const t=XG(),o=t.createMediaElementSource(e),a=t.createGain();return o.connect(a),a.connect(t.destination),{source:o,gainNode:a}}}),aH=new WeakMap,iH=e=>{e.paused&&(e.muted=!0),e.addEventListener("pause",(function(){this.muted=!0})),e.addEventListener("play",(function(){const t=aH.get(this),o=null!=t&&0===t;o!==e.muted&&(e.muted=o)}))},sH=(e,t)=>{if(aH.set(e,t),e.paused||(e.muted=0===t),null==e.crossOrigin||"Safari"===Hg.browser.name){const o=Ru(t,0,1);if(ME(e.volume,o,.01))return;e.volume=o}else{1!==e.volume&&(e.volume=1);const{gainNode:o}=oH(e);if(ME(o.gain.value,t,.01))return;console.debug("Setting volume: ",e.id,t),o.gain.value=t}},nH="AudioComponents-module_toolsButton_rwlyA",rH="AudioComponents-module_toolsIcon_nG7fg",lH="AudioComponents-module_toolCompact_-DoWL",dH="AudioComponents-module_audioPlayerAnimation_-7vkc",cH="AudioComponents-module_equalizer_7kd-2",uH="AudioComponents-module_equalizerBar_Fy3-t",mH="AudioComponents-module_equalizerBarPaused_odaYH",pH=e=>{const{state:t}=sr(),{recordWithOverlay:o,displayCompact:a}=e,{recordSet:i}=t.recordAudio;if(JG())return null;let s=()=>{i?(()=>{const{dispatch:e}=sr();e(yO())})():(()=>{const{dispatch:e}=sr();e(fO())})()};return o&&(s=()=>{eE("/studio/editor/overlay/record/audio")}),w.jsxs("button",{type:"button",className:`${nH} ${a&&lH}`,onClick:s,children:[w.jsx("img",{className:rH,src:"https://cdn-useast1.kapwing.com/static/Sle-recordButtonIcon.webp",alt:"record button icon"}),"Record"]})},hH=e=>{const{audioPlaying:t}=e;return t?w.jsx("div",{className:dH,children:w.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:cH,viewBox:"0 0 128 128",children:w.jsxs("g",{children:[w.jsx("title",{children:"Audio Equilizer"}),w.jsx("rect",{className:uH,transform:"translate(0,0)",y:"15"}),w.jsx("rect",{className:uH,transform:"translate(25,0)",y:"15"}),w.jsx("rect",{className:uH,transform:"translate(50,0)",y:"15"}),w.jsx("rect",{className:uH,transform:"translate(75,0)",y:"15"}),w.jsx("rect",{className:uH,transform:"translate(100,0)",y:"15"})]})})}):w.jsx("div",{className:dH,children:w.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:cH,viewBox:"0 0 128 128",children:w.jsxs("g",{children:[w.jsx("title",{children:"Audio Equilizer"}),w.jsx("rect",{className:mH,transform:"translate(0,0)",y:"15"}),w.jsx("rect",{className:mH,transform:"translate(25,0)",y:"15"}),w.jsx("rect",{className:mH,transform:"translate(50,0)",y:"15"}),w.jsx("rect",{className:mH,transform:"translate(75,0)",y:"15"}),w.jsx("rect",{className:mH,transform:"translate(100,0)",y:"15"})]})})})};async function gH(e){const t=document.createElement("video"),o=new Promise((e=>{t.addEventListener("loadedmetadata",(()=>{t.duration===1/0?(t.currentTime=Number.MAX_SAFE_INTEGER,t.ontimeupdate=()=>{t.ontimeupdate=null,e(t.duration),t.currentTime=0}):e(t.duration)})),t.addEventListener("error",(()=>{console.error("Failed to get blob duration"),e(void 0)}))}));return t.src="string"==typeof e||e instanceof String?e:window.URL.createObjectURL(e),o}class fH extends Error{}async function yH({actionDescription:e,fallbackValue:t,promise:o,timeoutMs:a}){let i;const s=new Promise((e=>{i=setTimeout((()=>{e({winner:"timeout"})}),a)})),n=new Promise((e=>{o.then((()=>{e({winner:"result"})})).catch((()=>{e({winner:"result"})}))})),{winner:r}=await Promise.race([s,n]);if("result"===r)return clearTimeout(i),o;if(t)return t;throw new fH(`${e} timed out in ${a} ms.`)}let vH={};let _H={};let wH={};function bH(){const e={..._H};for(const[o,a]of Object.entries(wH))e[o]?e[o]+=a:e[o]=a;const t=Object.values(e).reduce(((e,t)=>e+t),0);return{lastUsed:vH,assetSizes:e,totalAssetSize:t,segmentSizes:wH}}async function TH(e){const t=sh.get("asset_last_used",{disabled:null});t&&"object"==typeof t&&(vH=t);const o=sh.get("asset_sizes",{disabled:null});o&&"object"==typeof o&&(_H=o);const a=sh.get("asset_segment_sizes",{disabled:null});a&&"object"==typeof a&&(wH=a),Object.keys(_H).forEach((t=>{e.has(t)||delete _H[t]})),Object.keys(vH).forEach((t=>{e.has(t)||delete vH[t]})),Object.keys(wH).forEach((t=>{e.has(t)||delete wH[t]})),e.forEach((e=>{_H[e]=_H[e]||0})),sh.set("asset_sizes",_H)}function xH(e){const t=Date.now();for(const o of e)vH[o]=t;sh.set("asset_last_used",vH)}function SH(e,t){const o=t?function(e){try{return xv(e)?function(e){var t,o,a,i;return((null==(t=e.file_v2)?void 0:t.file.size)||0)+((null==(o=e.optimizedPreviewFile_v2)?void 0:o.file.size)||0)+((null==(a=e.waveformData_v5)?void 0:a.file.size)||0)+((null==(i=e.thumbnail)?void 0:i.size)||0)}(e):function(e){return e.type===zl.Audio}(e)?function(e){var t,o;return((null==(t=e.file)?void 0:t.size)||0)+((null==(o=e.waveformData_v5)?void 0:o.file.size)||0)}(e):Tv(e)?function(e){var t,o,a;return((null==(t=e.file_v2)?void 0:t.file.size)||0)+((null==(o=e.optimizedPreviewFile_v2)?void 0:o.file.size)||0)+((null==(a=e.trackOptimizedPreviewFile_v2)?void 0:a.file.size)||0)}(e):0}catch(t){return console.error(t),R(t),0}}(t):0;o?_H[e]=o:delete _H[e],sh.set("asset_sizes",_H)}"undefined"!=typeof window&&(window.getMediaCache=()=>({assetSizes:_H,lastUsed:vH}));const EH=s.throttle(sh.set.bind(sh),100,{leading:!1,trailing:!0});function IH(e,t){const{state:o,dispatch:a}=sr();!!o.studioLocal.isLayerMountedByLayerId[e]!==t&&a(nw({layerId:e,mounted:t}))}class CH{constructor(){i(this,"_cancelled",!1),i(this,"cancelledPromise"),i(this,"resolveCancelled"),this.cancelledPromise=new Promise((e=>{this.resolveCancelled=e}))}cancel(){var e;this._cancelled||(this._cancelled=!0,null==(e=this.resolveCancelled)||e.call(this))}reset(){this._cancelled=!1,this.cancelledPromise=new Promise((e=>{this.resolveCancelled=e}))}waitForCancelled(){return this.cancelledPromise}get cancelled(){return this._cancelled}createChild(){const e=new CH;return this.waitForCancelled().then((()=>{e.cancel()})),e}}const kH=e=>{const t=new AbortController,o=new Set(e);function a(){t.abort(),function(){for(const e of o)e.removeEventListener("abort",a)}()}for(const i of o){if(i.aborted){a();break}i.addEventListener("abort",a)}return t.signal};function AH(e){if(e.throwIfAborted)return e.throwIfAborted();if(e.aborted)throw e.reason?e.reason:new DOMException("signal is aborted without reason","AbortError")}function jH(e){if(AbortSignal.timeout)return AbortSignal.timeout(e);const t=new AbortController;return setTimeout((()=>t.abort()),e),t.signal}class NH extends Error{constructor(e,t,o){super(t),i(this,"name","Mp4FileError"),this.mediaCacheId=e,this.extra=o}}class RH{constructor({elementPool:e,getEPTime:t,setEPTime:o}){i(this,"elementPool"),i(this,"playOrSeekCancellationSource",null),i(this,"isPlayOrSeekingStatus","Idle"),i(this,"currentReferenceLayerId"),i(this,"getEPTime"),i(this,"setEPTime"),i(this,"setEPLayerAsMounted",((e,t)=>{IH(e,!0);const o=this.elementPool.layerIdsByElementId.get(t);null==o||o.forEach((t=>{t!==e&&IH(t,!1)}))})),i(this,"setAllElementLayersAsUnmounted",(e=>{var t;null==(t=this.elementPool.layerIdsByElementId.get(e))||t.forEach((e=>{IH(e,!1)}))})),i(this,"retryableMountVideo",((e,t,o)=>{const a=t=>{if(o.cancelled)return!1;if(!t.contains(e)){for(const e of t.children)"VIDEO"===e.tagName&&t.removeChild(e);return t.appendChild(e),!0}return!1};return new Promise((e=>{const i=this.getDomNodeForEPLayer(t);if(i){const t=a(i);return void e(t)}if(document.getElementById("stop-prop"))new MutationObserver(((i,s)=>{o.cancelled&&(e(!1),s.disconnect());for(const o of i)if("childList"===o.type)for(const i of o.addedNodes)if(i instanceof HTMLElement&&i.id===this.getDomNodeIDForEPLayer(t)){const t=a(i);s.disconnect(),e(t)}}));else{const i=setInterval((()=>{const s=this.getDomNodeForEPLayer(t);if(s){const t=a(s);clearInterval(i),e(t)}o.cancelled&&(clearInterval(i),e(!1))}),25)}}))})),this.elementPool=e,this.getEPTime=t,this.setEPTime=o}pause(){this.cancelPreviousPlayOrSeek();for(const[e,t]of this.elementPool.domElementByLayerId)t.pause()}async seek(e,t=!1){this.cancelPreviousPlayOrSeek();const o=new CH;this.playOrSeekCancellationSource=o,this.isPlayOrSeekingStatus="Seeking";try{if(t){const{state:t}=sr(),a=t.studioLocal.playbackRate;this.currentReferenceLayerId="seeked",await this.seekElementsIfStudioIsPlaying(e,o,a)}else this.currentReferenceLayerId=void 0,await this.seekElementsIfStudioIsPaused(e,o)}finally{this.isPlayOrSeekingStatus="Idle"}}async seekElementsIfStudioIsPaused(e,t){const o=[],a=[];for(const[s,n]of this.elementPool.layerIdsByElementId){const t=this.elementPool.domElementByDomId.get(s),i=this.findLayerThatShouldBePlaying(n,e);i?o.push([i,t]):a.push(t)}const i=[];await Promise.race([Promise.all(o.map((async([o,a])=>{const s=OH(e,o.startEndTimes[0],o.relativeStartEndTimes[0],o.playbackRate);if(await FH(a,s),!t.cancelled){await this.retryableMountVideo(a,o,t)&&i.push([o.layerId,a.id])}}))),t.waitForCancelled()]),t.cancelled||(i.forEach((([e,t])=>{this.setEPLayerAsMounted(e,t)})),setTimeout((()=>{a.forEach((e=>{e.remove(),this.setAllElementLayersAsUnmounted(e.id)}))}),0))}async seekElementsIfStudioIsPlaying(e,t,o){const a=[],i=[];for(const[n,r]of this.elementPool.layerIdsByElementId){const t=this.findLayerThatShouldBePlaying(r,e);t?a.push(t):i.push(n)}for(const n of i){const e=this.elementPool.domElementByDomId.get(n);e.paused||e.pause()}try{await Promise.race([Promise.all(a.map((async a=>{const i=this.elementPool.domElementByLayerId.get(a.layerId),s=OH(e,a.startEndTimes[0],a.relativeStartEndTimes[0],a.playbackRate);await FH(i,s),t.cancelled||await this.playElementAtStudioTime(i,a,e,o,t)}))),t.waitForCancelled()])}catch(s){console.error("playOrSeekElementsWhileStudioIsPlaying - playing elements failed to resolve",s)}if(!t.cancelled)for(const n of i){const e=this.elementPool.domElementByDomId.get(n);document.body.contains(e)&&(e.remove(),this.setAllElementLayersAsUnmounted(n));const t=this.elementPool.layerIdsByElementId.get(n);this.seekAhead(e,t,this.getEPTime())}}cancelPreviousPlayOrSeek(){var e;null==(e=this.playOrSeekCancellationSource)||e.cancel(),this.playOrSeekCancellationSource=null}async _playOrPreseekElementsWhileStudioIsPlaying(e,t){var o,a,i;let s=this.getEPTime();this.cancelPreviousPlayOrSeek();const n=new CH;if(this.playOrSeekCancellationSource=n,this.currentReferenceLayerId&&"seeked"!==this.currentReferenceLayerId){const t=this.elementPool.layerByLayerId.get(this.currentReferenceLayerId);if(t&&this.elementPool.domElementByLayerId.get(t.layerId)){const i=(null==(o=this.elementPool.domElementByLayerId.get(t.layerId))?void 0:o.currentTime)??0,[n,r]=t.startEndTimes,[l,d]=t.relativeStartEndTimes;if(DH(n,s,r)&&i>=d){const t=(null==(a=function(e,t){let o=null;for(const a of t){if("ep"!==a.whichElementPool)continue;DH(e,a.startEndTimes[0],e+.03333333333333333)&&(!o||a.startEndTimes[0]<o.startEndTimes[0])&&(o=a)}return o}(r,e))?void 0:a.startEndTimes[0])||r;s=t,this.setEPTime(t)}}}const r=[],l=[];for(const[m,p]of this.elementPool.layerIdsByElementId){const e=this.findLayerThatShouldBePlaying(p,s);e?r.push(e):l.push(m)}for(const m of l){const e=this.elementPool.domElementByDomId.get(m);e.paused||e.pause()}const d=(null==(i=r.find((t=>PH(t.startEndTimes,s,e))))?void 0:i.layerId)||void 0,c=d&&"seeked"!==this.currentReferenceLayerId&&this.currentReferenceLayerId!==d;this.currentReferenceLayerId=d;try{await Promise.race([Promise.all(r.map((e=>{let o=s;const a=this.elementPool.domElementByLayerId.get(e.layerId);if(this.currentReferenceLayerId===e.layerId&&a){let t=a.currentTime;const i=s===e.startEndTimes[0]&&t===e.relativeStartEndTimes[0];(!DH(e.relativeStartEndTimes[0],a.currentTime,e.relativeStartEndTimes[1])||c&&!i)&&(t=OH(s,e.startEndTimes[0],e.relativeStartEndTimes[0],e.playbackRate),async function(e,t,o=1/30){const a=ME(e.currentTime,t,o),i=e.readyState>HTMLMediaElement.HAVE_METADATA,s="seeking"===e.dataset.seekStatus;if(a&&i&&0!==t&&!s)return;e.currentTime=t}(a,t)),o=a.dataset.waitingSince&&ME(t,e.relativeStartEndTimes[1],.5)?e.startEndTimes[1]+1/60:bS(LH(t,e.startEndTimes[0],e.relativeStartEndTimes[0],e.playbackRate),.001),this.setEPTime(o)}return this.playElementAtStudioTime(a,e,o,t,n)}))),n.waitForCancelled()])}catch(u){console.error("playOrSeekElementsWhileStudioIsPlaying - playing elements failed to resolve",u)}if(!n.cancelled)for(const m of l){const e=this.elementPool.domElementByDomId.get(m);document.body.contains(e)&&(e.remove(),this.setAllElementLayersAsUnmounted(m));const t=this.elementPool.layerIdsByElementId.get(m);this.seekAhead(e,t,s)}}async playOrPreseekElementsWhileStudioIsPlaying(e,t){if("Idle"===this.isPlayOrSeekingStatus){this.isPlayOrSeekingStatus="Playing";try{await this._playOrPreseekElementsWhileStudioIsPlaying(e,t)}finally{this.isPlayOrSeekingStatus="Idle"}}}seekAhead(e,t,o){const a=this.findLayerClosestToStudioTime(t,o);ME(e.currentTime,a.relativeStartEndTimes[0],.15)||(this.elementPool.streamsByElementId.has(e.id)&&this.elementPool.streamsByElementId.get(e.id).prebuffer(a.relativeStartEndTimes[0]),setTimeout((()=>{e.currentTime=a.relativeStartEndTimes[0]}),0))}shouldBindNonReferenceLayer(e,t,o){const a=e.getAttribute("data-lastBindTimestamp");a||e.setAttribute("data-lastBindTimestamp",String(Date.now()));const i=Date.now()-Number(a);return null==a||!ME(e.currentTime,t,.5*o)&&i>5e3}async playElementAtStudioTime(e,t,o,a,i){const s=a*t.playbackRate;e.playbackRate!==s&&(e.playbackRate=s),this.setElementVolume(e,t.volume);const n=OH(o,t.startEndTimes[0],t.relativeStartEndTimes[0],t.playbackRate);let r;this.shouldBindNonReferenceLayer(e,n,t.playbackRate)&&(e.setAttribute("data-lastBindTimestamp",String(Date.now())),r=FH(e,n));let l=!1;this.isVideoMounted(e,t)||(l=await this.retryableMountVideo(e,t,i)),i.cancelled||(e.paused&&e.currentTime!==e.duration&&await e.play().catch(BH),await r,l&&this.setEPLayerAsMounted(t.layerId,e.id))}findLayerClosestToStudioTime(e,t){for(const o of e){const e=this.elementPool.layerByLayerId.get(o);if(e.startEndTimes[0]-t>0)return e}return this.elementPool.layerByLayerId.get(e[0])}findLayerThatShouldBePlaying(e,t){for(const o of e){const e=this.elementPool.layerByLayerId.get(o);if(DH(e.startEndTimes[0],t,e.startEndTimes[1],e.isAtEnd)||e.shouldBePlayingOverride)return e}}setElementVolume(e,t){sH(e,t)}getDomNodeIDForEPLayer(e){return this.elementPool.getDomIdFromLayerId(e.layerId)}getDomNodeForEPLayer(e){return document.getElementById(this.getDomNodeIDForEPLayer(e))}isVideoMounted(e,t){const o=this.getDomNodeForEPLayer(t);return!!(null==o?void 0:o.contains(e))}}function PH(e,t,o){const a=e[1]-e[0];for(const i of o)if(DH(i.startEndTimes[0],t,i.startEndTimes[1])){const t=i.startEndTimes[1]-i.startEndTimes[0];if(t>a)return!1;if(t===a&&i.startEndTimes[0]<e[0])return!1}return!0}function DH(e,t,o,a=!1){return a?e<=t&&t<=o:e<=t&&t<o}function OH(e,t,o,a){return o+(e-t)*a}function LH(e,t,o,a){return(e-o)/a+t}function FH(e,t,o=1/30){const a=ME(e.currentTime,t,o),i=e.readyState>HTMLMediaElement.HAVE_METADATA,s="seeking"===e.dataset.seekStatus;return a&&i&&0!==t&&!s?Promise.resolve():UH(e,t)}const MH=new WeakMap;function UH(e,t){const o=Xs(MH,e,{insert:()=>new AbortController,update:e=>(e.abort(),new AbortController)}),{signal:a}=o;return new Promise(((i,s)=>{function n(){a.removeEventListener("abort",l),e.removeEventListener("seeking",d),e.removeEventListener("seeked",c),e.removeEventListener("error",r),e.removeEventListener("loadedmetadata",u)}function r(t){n(),console.error(e.id,"failed loading with: ",t),s()}function l(){n(),s(a.reason)}function d(e){e.target instanceof HTMLVideoElement&&(ME(t,e.target.currentTime,1/30)||o.abort())}function c(){n(),i()}function u(){e.currentTime=t}AH(a),a.addEventListener("abort",l),e.addEventListener("error",r),e.addEventListener("seeking",d),e.addEventListener("seeked",c),e.addEventListener("loadedmetadata",u),e.currentTime=t})).catch((()=>{}))}const BH=e=>{throw"NotAllowedError"===e.name&&(tR(),Fm(ym.AUTOPLAY_BLOCKED)),e};async function VH(e,t,o){await UH(e,o),t.getContext("2d").drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,t.width,t.height);const a=await async function(e){return new Promise((t=>{e.toBlob((e=>t(e)),"image/jpeg",.6)}))}(t);return a}const WH=e=>new Promise((t=>{const o=new Image;o.onload=()=>{URL.revokeObjectURL(o.src),t({width:o.width,height:o.height})},o.src=URL.createObjectURL(e)})),GH=e=>yH({actionDescription:"get image dimensions",promise:WH(e),timeoutMs:3e3});async function HH(e,t,o){const[a,i,s]=await Promise.all([e,t,o].map((e=>e?async function(e){return new Promise((t=>{const o=document.createElement("video");o.crossOrigin="anonymous",o.preload="auto",o.addEventListener("loadeddata",(async()=>{const{duration:e}=o,a=document.createElement("canvas"),i=o.videoHeight,s=o.videoWidth,n=i/s;a.width=200,a.height=200*n;const[r,l]=await Promise.all([await SB(o),await VH(o,a,0)]);t({duration:e,height:i,width:s,thumbnail:l,hasAudio:r})})),o.src=e,o.load()}))}(URL.createObjectURL(e)):Promise.resolve(void 0))));return{...a&&{file_v2:{file:e,duration:a.duration,width:a.width,height:a.height,hasAudio:a.hasAudio}},...i&&{optimizedPreviewFile_v2:{file:t,duration:i.duration,width:i.width,height:i.height,hasAudio:i.hasAudio}},...s&&{trackOptimizedPreviewFile_v2:{file:o,duration:s.duration,width:s.width,height:s.height,hasAudio:s.hasAudio}},thumbnail:(null==a?void 0:a.thumbnail)||(null==i?void 0:i.thumbnail)||(null==s?void 0:s.thumbnail)||void 0,thumbnailSource:(!(null==a?void 0:a.thumbnail)?!!(null==i?void 0:i.thumbnail)&&"preview":"original")||!!(null==s?void 0:s.thumbnail)&&"thumbnail"}}async function $H(e,t,o){const[a,i,s]=await Promise.all([e,t,o].map((e=>e?GH(e):Promise.resolve(void 0))));return{...a&&{file_v2:{file:e,width:a.width,height:a.height}},...i&&{optimizedPreviewFile_v2:{file:t,width:i.width,height:i.height}},...s&&{trackOptimizedPreviewFile_v2:{file:o,width:s.width,height:s.height}}}}function KH({asset:e,error:t,extra:o,fn:a}){console.error(t,e),Math.random()<.1&&R(t,{extra:{asset:e,...o},tags:{fn:a}})}"undefined"!=typeof window&&(window.idbCache||(window.idbCache={}));const zH=new Map;let YH=1e3;const JH={};function qH(e,t){Object.values(JH[e]||{}).forEach((e=>e(t)))}function XH(e,t){JH[e]||(JH[e]={});const o=JH[e];if(!o)throw Error();const a=(YH+=1,YH);o[a]=t;const i=window.idbCache[e];return i?"complete"===i.status?t(i.asset):i.subscribers.push(t):d$(e).then((e=>{e&&t(e)})),()=>{var t;null==(t=JH[e])||delete t[a]}}function QH(e,t){let o=zH.get(e);return o||(o=new st,zH.set(e,o)),o.runExclusive(t)}async function ZH(e){const{mediaLibraryID:t}=e,o=window.idbCache[t];o?(o.status="complete",o.asset=e,qH(t,e)):window.idbCache[t]={subscribers:[],asset:e,status:"complete"},sr().dispatch(x_([t]));try{await(await C$).add("assets",e),SH(t,e)}catch(a){return KH({error:a,asset:e,fn:"addNewAssetToIDB"}),!1}return!0}async function e$(e,t,o){try{const a={...e,...t};if("video"===e.type&&o){const t=e=>{switch(e){case"original":return 3;case"preview":return 2;case"track":return 1;default:return 0}},i=await HH(o.original,o.preview,o.track),s={file_v2:e.file_v2,optimizedPreviewFile_v2:e.optimizedPreviewFile_v2,trackOptimizedPreviewFile_v2:e.trackOptimizedPreviewFile_v2,thumbnail:e.thumbnail,thumbnailSource:e.thumbnailSource},n={...s,...i};if(t(s.thumbnailSource)>t(i.thumbnailSource)&&(n.thumbnail=s.thumbnail,n.thumbnailSource=s.thumbnailSource),o.thumbnailSheet){const{width:e,height:t}=await GH(o.thumbnailSheet.file);n.thumbnailSheet={file:o.thumbnailSheet.file,thumbnail_width:o.thumbnailSheet.thumbnail_width,thumbnail_height:o.thumbnailSheet.thumbnail_height,fps:o.thumbnailSheet.fps,width:e,height:t}}Object.assign(a,n)}const i=window.idbCache[e.mediaLibraryID];return i&&(i.status="complete",i.asset=a),qH(e.mediaLibraryID,a),await(await C$).put("assets",a),SH(a.mediaLibraryID,a),!0}catch(a){KH({error:a,asset:e,fn:"updateAssetInIDB"})}return!1}async function t$(e){try{await(await C$).delete("pendingConversions",e)}catch(t){KH({error:t,fn:"deletePendingConversion"})}}async function o$(){let e=[];try{e=await(await C$).getAll("pendingConversions")}catch(t){KH({error:t,fn:"getPendingConversions"})}return e}async function a$(e,t,o,a,i){try{await(await C$).add("pendingConversions",{name:o,mediaLibraryID:P(),conversion_id:e,id:t,uploadId:a,cmlFileId:i})}catch(s){KH({error:s,fn:"addPendingConversion"})}}async function i$(e,t,o){return QH(e,(async()=>{const{state:a}=sr(),i=a.currentUser.user._id??"anonymous",s={mediaLibraryID:e,timestamp:new Date,user_id:i,type:o,waveformData_v5:t,duration:t.duration};try{const o=await c$(e);return o?e$(o,{waveformData_v5:t}):ZH(s)}catch(n){return console.error("Error trying to add asset waveform into idb",n),KH({error:n,asset:s,fn:"addAssetWaveform"}),!1}}))}async function s$(e,t,o){return QH(e,(async()=>{try{const a=await c$(e);return a?await e$(a,t,o):(console.error(`Could not find asset ${e}`),!1)}catch(a){KH({error:a,fn:"updateAsset"})}}))}async function n$({mediaCacheId:e,type:t,file:o,optimizedPreviewFile:a,trackOptimizedPreviewFile:i,thumbnailSheet:s}){if(!(t!==zl.Video||o||a||i||s))throw Error("No files provided for video asset");return QH(e,(async()=>{const{state:n}=sr(),r=n.currentUser.user._id??"anonymous";try{const n=await c$(e);if(n){if(n.type===zl.Video){const e={};if(o&&!n.file_v2&&(e.original=o),a&&!n.optimizedPreviewFile_v2&&(e.preview=a),i&&!n.trackOptimizedPreviewFile_v2&&(e.track=i),s&&!n.thumbnailSheet&&(e.thumbnailSheet=s),0===Object.keys(e).length)return!1;return e$(n,await HH(o,a,i),e)}if(n.type===zl.Image){return e$(n,await $H(o,a,i))}if(n.file)return!1;const e={file:o};if(t===zl.Audio){const t=await gH(o);t&&(e.duration=t)}return e$(n,e)}let l;if(t===zl.Video){const t=await HH(o,a,i);if(l={mediaLibraryID:e,timestamp:new Date,user_id:r,type:zl.Video,...t},s){const{width:e,height:t}=await GH(s.file);l.thumbnailSheet={file:s.file,thumbnail_width:s.thumbnail_width,thumbnail_height:s.thumbnail_height,fps:s.fps,width:e,height:t}}}else if(t===zl.Image){const t=await $H(o,a,i);l={mediaLibraryID:e,timestamp:new Date,user_id:r,type:zl.Image,...t}}else{if(t!==zl.Audio){const a=window.idbCache[e];throw a&&(a.status="failed"),qH(e,null),new Error(`IDB.addAsset. File type not supported: ${null==o?void 0:o.type} (layer type was ${t})`)}{const t=await gH(o);if(void 0===t)throw new Error("Unable to get audio duration");l={file:o,mediaLibraryID:e,timestamp:new Date,user_id:r,duration:t,type:zl.Audio}}}return ZH(l)}catch(l){return console.error("Error adding asset files",l),KH({error:l,fn:"addAssetFile"}),!1}}))}async function r$(e){return QH(e,(async()=>{try{const{idbCache:t}=window;delete t[e];const o=await C$,a=[];a.push(o.delete("assets",e)),a.push(o.delete("mp4Headers",e)),a.push(o.getAllKeysFromIndex("mp4Segments","mediaCacheId",e).then((async e=>{const t=[];for(const a of e)t.push(o.delete("mp4Segments",a));await Promise.all(t)}))),await Promise.all(a),SH(e,null),function(e,t){wH[e]=t}(e,0);const{state:i,dispatch:s}=sr(),{idbAssetIds:n}=i.studioLocal;if(null===n)return;s({type:"REMOVE_IDB_ASSET_ID",idbAssetId:e})}catch(t){KH({error:t,fn:"deleteAsset"})}}))}async function l$(){try{window.idbCache={},await(await C$).clear("assets"),_H={},sh.set("asset_sizes",_H);const{dispatch:e}=sr();e({type:"CLEAR_IDB_ASSET_IDS"})}catch(e){KH({error:e,fn:"clearAssets"})}}async function d$(e){let t;const{idbCache:o}=window,a=o[e];if(a&&"complete"===a.status)t=a.asset;else if(a&&"pending"===a.status)t=await new Promise((e=>{a.subscribers.push(e)}));else{o[e]={subscribers:[],status:"pending"};try{t=await yH({actionDescription:"IDB getAsset",timeoutMs:7e3,promise:(await C$).get("assets",e)});const a=o[e];a&&(t?(a.status="complete",a.asset=t):a.status="failed")}catch(i){const t=o[e];t&&(t.status="failed"),KH({error:i,fn:"getAsset"})}finally{const a=o[e];a&&(a.subscribers.forEach((e=>{e(t)})),a.subscribers=[])}}return t}async function c$(e){if(window.indexedDB){const t=await(await C$).get("assets",e);if(null!=t)return t}const{idbCache:t}=window,o=t[e];if(o)switch(o.status){case"complete":return o.asset;case"failed":return;case"pending":return new Promise((e=>{o.subscribers.push(e)}))}}function u$(e){const{idbCache:t}=window,o=t[e];if(o&&"complete"===o.status)return o.asset}async function m$(){try{const e=[];e.push((await C$).getAllKeys("assets")),e.push((await C$).getAllKeys("mp4Headers"));const t=(await Promise.all(e)).flat();return[...new Set(t)]}catch(e){KH({error:e,fn:"getAllAssetIds"})}return[]}async function p$(){let e=[];try{e=await(await C$).getAll("assets")}catch(t){KH({error:t,fn:"getAllAssets"})}return e}async function h$(e,t,o){try{await(await C$).add("thumbnails",{mediaLibraryID:e,frameTime:t,imageData:o})}catch(a){throw KH({error:a,fn:"addThumbnail"}),a}}async function g$(e,t,o){let a;const i=IDBKeyRange.bound([e,t],[e,o]);try{const e=await(await C$).getAllFromIndex("thumbnails","mediaLibraryID+frameTime",i);if(!e.length)return;let s=0,n=e.length-1;const r=(o+t)/2;for(;s<n-1;){const t=Math.floor((n+s)/2),o=e[t];if(!o)throw Error("Missing asset");r<=o.frameTime?n=t:s=t}const l=e[s],d=e[n];if(a=d||l,l&&d){const e=Math.abs(l.frameTime-r);a=Math.abs(d.frameTime-r)<e?d:l}}catch(s){KH({error:s,extra:{frameTimeStart:t,frameTimeEnd:o},fn:"getThumbnail"})}return a}function f$(e){const[t,o]=h.useState(null);return h.useEffect((()=>{if(!e)return o(null),()=>{};return XH(e,(e=>{e&&o(e)}))}),[e]),(null==t?void 0:t.mediaLibraryID)!==e?null:t}function y$(e,t){var o,a;if("audio"===e.type)return e.file;if(!t)return(null==(o=e.file_v2)?void 0:o.file)||(null==(a=e.optimizedPreviewFile_v2)?void 0:a.file);const[i]=t.map((t=>{var o,a,i,s;switch(t){case"original":return null==(o=e.file_v2)?void 0:o.file;case"preview":return null==(a=e.optimizedPreviewFile_v2)?void 0:a.file;case"track":return null==(i=e.trackOptimizedPreviewFile_v2)?void 0:i.file;case"thumbnail_sheet":if("video"!==e.type)throw Error("Can't get the thumbnail sheet of a non-video asset");return null==(s=e.thumbnailSheet)?void 0:s.file;default:return null}})).filter((e=>!!e));return i}const v$=["original","preview","track"];function _$(e,t){if("video"!==e.type)return{file:e.file,hasAudio:!0,assetQuality:"original",assetDuration:e.duration};let o,a;for(const i of t||v$)switch(i){case"original":if(e.file_v2){o=e.file_v2,a="original";break}continue;case"preview":if(e.optimizedPreviewFile_v2){o=e.optimizedPreviewFile_v2,a="preview";break}continue;case"track":if(e.trackOptimizedPreviewFile_v2){o=e.trackOptimizedPreviewFile_v2,a="track";break}continue;default:continue}return{file:null==o?void 0:o.file,hasAudio:null==o?void 0:o.hasAudio,assetQuality:a,assetDuration:null==o?void 0:o.duration}}function w$({idbAsset:e,includeHasAudio:t,fileSelectionOrder:o}){if("audio"===e.type)return{duration:e.duration};let a=null;o?[a]=o.map((t=>{switch(t){case"original":return e.file_v2;case"preview":return e.optimizedPreviewFile_v2;case"track":return e.trackOptimizedPreviewFile_v2;default:return null}})).filter((e=>!!e)):a=e.file_v2||e.optimizedPreviewFile_v2;const i={height:null==a?void 0:a.height,width:null==a?void 0:a.width};if("image"===e.type)return i;const s=a;return i.duration=null==s?void 0:s.duration,t&&(i.hasAudio=null==s?void 0:s.hasAudio),i}async function b$(e){try{return(await C$).get("mp4Headers",e)}catch(t){throw KH({error:t,fn:"getIdbParsedMp4Headers"}),t}}async function T$(e){try{(await C$).add("mp4Headers",e)}catch(t){KH({error:t,extra:{mediaCacheId:e.mediaCacheId,assetId:e.assetId},fn:"setIdbParsedMp4Headers"})}}async function x$(e){try{(await C$).delete("mp4Headers",e)}catch(t){throw KH({error:t,fn:"deleteIdbParsedMp4Headers"}),t}}async function S$(e,t){var o;try{return null==(o=await(await C$).getFromIndex("mp4Segments","assetId+idx",[e,t]))?void 0:o.segment}catch(a){throw KH({error:a,fn:"getIdbFileSegmentData"}),a}}async function E$(e,t,o,a){try{await(await C$).add("mp4Segments",{mediaCacheId:e,assetId:t,idx:o,segment:a})}catch(i){KH({error:i,extra:{mediaCacheId:e,assetId:t,idx:o},fn:"setIdbFileSegmentData"})}}function I$(e){console.error(e);const{dispatch:t}=sr();t(tO.setIdbIsSupported(!1))}let C$;async function k$(){C$=yH({actionDescription:"Open IDB",timeoutMs:5e3,promise:(async()=>{try{await ot();const e=await at("kapwing",7,{upgrade(e,t){if(t<=0&&e.createObjectStore("assets",{keyPath:"pathname"}),t<=1&&(e.objectStoreNames.contains("assets")&&e.deleteObjectStore("assets"),e.createObjectStore("assets",{keyPath:"mediaLibraryID"}),e.createObjectStore("pendingConversions",{keyPath:"mediaLibraryID"}),e.createObjectStore("pendingUploads",{keyPath:"mediaLibraryID"})),t<=2&&e.createObjectStore("thumbnails",{autoIncrement:!0}).createIndex("mediaLibraryID+frameTime",["mediaLibraryID","frameTime"]),t<=3&&e.createObjectStore("pendingDownloads",{keyPath:"mediaLibraryID"}),t<=4&&e.objectStoreNames.contains("pendingUploads")&&e.deleteObjectStore("pendingUploads"),t<=5&&e.objectStoreNames.contains("pendingDownloads")&&e.deleteObjectStore("pendingDownloads"),t<=6){e.createObjectStore("mp4Headers",{keyPath:"mediaCacheId"});const t=e.createObjectStore("mp4Segments",{autoIncrement:!0});t.createIndex("assetId+idx",["assetId","idx"]),t.createIndex("mediaCacheId","mediaCacheId")}},async blocked(){await it("kapwing")},async blocking(){await it("kapwing")}});if(Zr.clearDbOnLoad)for(const t of e.objectStoreNames)console.debug("Clearing ",t),e.clear(t);return sr().dispatch(tO.setIdbIsSupported(!0)),e}catch(e){throw e instanceof Error&&"InvalidStateError"===e.name&&"string"==typeof e.message&&e.message.includes("A mutation operation was attempted on a database that did not allow mutations")&&(e.__SKIP_SENTRY=!0),e}})()}),C$.catch(I$)}if("undefined"!=typeof window){const e=15;k$(),setInterval((async function(){console.debug("Refreshing IDB connection");try{const e=await C$;e&&e.close()}catch(IGe){}k$()}),6e4*e)}const A$=async()=>{window.idbCache={},await(await C$).clear("assets")};function j$({id:e,fileName:t}){return{type:"ADD_UPLOAD_STATUS",id:e,fileName:t}}function N$(e,t){return{type:"UPDATE_UPLOAD_STATUS",id:e,updates:t}}const R$=["library","resources","samples","static","team_assets","assets","conversions"],P$=["%252F","%2F"];function D$(e){if(null==e)return;let t=e;for(const o of P$)for(const e of R$)t.startsWith(`${e}${o}`)&&(t=decodeURIComponent(t));return t}function O$(e){if(null==e)return[void 0,void 0];if(!e||"string"!=typeof e)return[void 0,void 0];const t=e.split("?",1)[0];if(!t)return[void 0,void 0];let o,a;if(t.startsWith(gn)){const e=t.slice(gn.length).split("/");[,o]=e,a=e.slice(2).join("/")}else if(t.startsWith("https://cdn.kapwing.com"))o="kapwing",a=t.slice("https://cdn.kapwing.com".length+1);else if(t.startsWith(yn))o=hn,a=t.slice(yn.length+1);else{o=hn;try{a=new URL(t).pathname}catch(IGe){}}return"undefined"===o&&(o=hn),[o,D$(a)]}function L$(e){return lc({key:"pastedLinkError",params:{layerIds:e.map((e=>e.id))}})}function F$(e,t={}){return Jr("/api/v2/assets/create",{body:e,params:t,retries:5})}function M$(e){return Jr("/api/v1/assets/createFromVideo_v2",{params:{id:e},retries:5})}const U$=s.memoize(B$,(e=>e));function B$(e,t,o){return Jr("/api/v1/assets/createFromLink_v3",{body:{extract_info:o,url:e,...t},retries:5})}const V$=new Map;function W$(e,t){const o=`/api/v1/assets/${e}`,a=V$.get(o);if(a)return a;const i=Yr(`${o}/${t||""}`,{retries:5}).then((e=>(V$.delete(o),e)));return V$.set(o,i),i}function G$(e,t=5){return 0===e.length?Promise.resolve([]):Jr("/api/v1/assets/bulk",{retries:t,body:{assetIds:e}})}function H$(e,t){return Xr(`/api/v1/assets/${e}`,{body:t})}function $$(e){return Yr(`/api/v1/assets/${e}/split-scenes`,{timeout:75e3})}function K$(e,t){return Jr(`/api/v1/assets/${e}/split-scenes`,{body:t})}function z$(e){if(!e)return void console.error("No Pasted URL provided.");const{scenes:t}=sr().state.studio,o=[];for(const a of t)for(const t of a.layers)t.pastedUrl===e&&o.push(t);Y$(o,!0)}function Y$(e,t){if(0===e.length)return;const{dispatch:o}=sr();let a=null;const[i]=e;if(i&&i.url){const e=new URL(i.url).hostname.split(".");a=e.slice(Math.max(0,e.length-2)).join(".")}const s=cB(null==i?void 0:i.pastedUrl);Fm(ym.FAILED_PREEMPTIVE_DOWNLOAD_MODAL_SHOWN,{url:null==i?void 0:i.pastedUrl,pathname:window.location.pathname,extractedHost:a,platform:s,fromPreemptiveDownload:t}),g.batch((()=>{const t={};for(const o of e)t[o.id]={preemptiveDownloadError:!0};OI(t,"reportAssetExtractError"),o(L$(e))}))}function J$(e){return Jr(`/api/v1/assets/${e}/initialize_metadata`)}function q$(e){return e.content_type?e.content_type.startsWith("image")?zl.Image:e.content_type.startsWith("video")?zl.Video:e.content_type.startsWith("audio")?zl.Audio:null:null}async function X$(e,t){const{state:o,dispatch:a}=sr(),i=o.assets.byId[e],s=o.assets.assetWaveformData[e];if(!(null==s?void 0:s.postingWaveformData)&&!(null==i?void 0:i.waveformInfo)){a(XP({assetId:e,update:{postingWaveformData:!0}}));try{const o=new FormData;o.append("waveform",t.file),o.append("duration",String(t.duration)),o.append("sampleRate",String(t.sampleRate)),o.append("isFfmpeg",String(t.isFfmpeg)),o.append("scalingFactor",void 0===t.scalingFactor?"":String(t.scalingFactor));const i=await Jr(`/api/v1/assets/${e}/waveform`,{body:o,headers:{enctype:"multipart/form-data"}});if(i.success)return void a(qP({assetId:e,update:{waveformInfo:i.waveformInfo}}))}catch(IGe){console.error(IGe.message)}a(XP({assetId:e,update:{postingWaveformData:!1}}))}}const Q$=(e,t)=>sr().dispatch(qP({assetId:e,update:t})),Z$=(e,t)=>{if(!e)return;const{dispatch:o,state:a}=sr();if(t){const t=(a.assets.layerIdsByAssetId[e]||[]).map((e=>[e,{readyForTrackRender:!0}]));FE(Object.fromEntries(t))}o(XP({assetId:e,update:{waveformDataFetchSucceeded:t}}))},eK=async e=>{const{dispatch:t}=sr(),o=await W$(e);if(!o)throw new Error("Asset not found");return t(JP([o])),o};function tK(e){var t;const o=new Date,a=Hu();return{projectName:e.projectName,dimensions:e.dimensions,done:!1,duration:e.duration,editorPath:e.editorPath,isGif:e.sourceVideo&&e.sourceVideo.isGif,isImage:e.sourceVideo&&e.sourceVideo.isImage,lastSeen:o,parentId:e.parentId,pastedUrl:e.sourceVideo&&e.sourceVideo.pastedUrl?e.sourceVideo.pastedUrl:void 0,privacy:(null==(t=null==a?void 0:a.settings)?void 0:t.defaultPrivacy)??Ln.unlisted,progressText:"Saved ...",sourceVideo:e.sourceVideo,submittedAt:o}}function oK(e,t){return qr(`/api/v1/videos/${e}/privacy`,{params:{privacy:t}})}function aK(e){return{type:"SET_PREVIEW_VIDEO",video:e}}function iK(){return{type:"MARK_AS_STUDIO"}}function sK(e){var t,o,a,i,n;let r=e||{};if((e.scenes||(null==(t=e.allLayers)?void 0:t.byId))&&(r=s.cloneDeep(e),(null==(o=null==r?void 0:r.allLayers)?void 0:o.byId)&&Object.values(r.allLayers.byId).forEach((e=>{delete e.local_url})),e.scenes))for(const s in(null==(a=r.scenes[0])?void 0:a.layers)||[])null==(n=null==(i=r.scenes[0])?void 0:i.layers[s])||delete n.local_url;return{...r,layersPendingUpload:{},deletedLayerLocalBlobDict:{},deletedLayerDict:{}}}function nK(e,t){const o={...e.studio.scenes[0]};o.layers=o.layers.map((e=>({...e}))),e.studio.scenes=[o];const a=_T(e.studio.scenes,lT(e.studio)),{currentUser:{user:i},currentUser:s}=e||{},n=rK(a),r=wc(s)?null==i?void 0:i._id:void 0,l=wc(s)?null==i?void 0:i.email:void 0,d={isCreator:!0,isStudio:!0,...sK(e.studio),...tK(e),duration:a,creatorId:r,creatorEmail:l,watermark:n,sessionSettings:void 0,..."Cypress"in window&&{isCypress:!0}};return t&&(d.projectName=e.projectName||An),d}const rK=e=>{const t=au();return!t.hasPermission(Bl.EXPORT_ALL_WITHOUT_WATERMARK)&&!(e<=30&&t.hasPermission(Bl.EXPORT_30_SEC_WITHOUT_WATERMARK))};const lK=e=>{const{snapshotCreatedOn:t,video_id:o,id:a,...i}=e;return{version_number:0,created_on:t,snapshot_type:"legacy",export:!0,id:a,content:i,video_id:o}};async function dK(e){try{return(e=>{if(0===e.length)return[];const t=[];for(let o=0;o<e.length;o+=1){const a=e[o];if("full_video"===(null==a?void 0:a.snapshot_type)||(null==a?void 0:a.export))t.push({...a});else if("patch"===(null==a?void 0:a.snapshot_type)){const e=t[t.length-1];if(e){if(nt(a.diff,e.content))continue;t.push({...a,content:rt(lt(e.content),a.diff).newDocument})}}else t.push(lK(e[o]))}return t})(await Yr(`/api/v1/snapshots/${e}`))}catch(IGe){throw console.error(IGe),IGe}}async function cK({migrateToVersion:e,snapshot_id:t,video_id:o}){try{const a=e?{migrateToVersion:e}:{};return await Yr(`/api/v1/snapshots/${o}/${t}`,{params:a})}catch(IGe){throw console.error(IGe),IGe}}async function uK(e,t=!1){if(!e._id)throw Error("No video id present");const o=await Jr(`/api/v1/snapshots/${e._id}`,{body:{video:e,exportSnapshot:t}});if(o.error)throw o;return o}async function mK(){var e;const{state:t}=sr();if((null==t?void 0:t.currentVideo)&&(null==(e=null==t?void 0:t.currentUser)?void 0:e.user)){const e=nK(t,!!t.currentVideo);if(!e)throw Error("No video present");const o=await Jr("/api/file-size-estimate",{body:{video:e}});if(o.error)throw o;return o.estimate}throw Error()}async function pK(e){const{state:t,dispatch:o}=sr(),a=t.studio._id,{asset_id:i,conversion_type:s,pastedUrl:n,resource:r,type:l,layer:d}=e,c={asset_id:i,resource:r,type:l,conversion_type:s,layer:d,video_id:a,fragment:UI()};n&&(c.pastedUrl=n);const u={asset_id:i,resource:r,type:l,conversion_type:s,video_id:a};Fm(ym.CONVERSION_BEGINS,u);try{const e=await Jr("/api/v1/conversions",{body:c}),{conversion_id:t,asset:a}=e;return a&&o(JP([a])),t}catch(m){console.error(m);const{message:e}=ph(m);throw Fm(ym.CONVERSION_FAILS,{...u,failureMessage:e}),m}}async function hK(e){if(!e)throw new Error("No conversion id present");const t=await Yr(`/api/v1/conversions/${e}`).catch((e=>{throw console.error(e),e}));if(t.status===qn.failed){const o={asset_id:t.asset_id,conversion_id:e,failureMessage:"conversion status === failed"};Fm(ym.CONVERSION_FAILS,o)}return t}function gK(){const{state:e}=sr(),t=(e.isStudio?e.studio.duration:e.duration)>7200,o=RU(Bl.UNLIMITED_EXPORT_DURATION_LIMIT);return t&&o}function fK(){var e;const{state:t}=sr(),o=Hu(t),a=t.isStudio?t.studio.duration:t.duration,i=(null==(e=null==o?void 0:o.limits)?void 0:e.cumulativeExportDuration)||0;let s;s=t.isStudio?yK(t)||a>240||i+a>10800:t.sourceVideo.size>262144e3||a>240||i+a>10800;const n=RU(Bl.UNLIMITED_EXPORT_DURATION_LIMIT);return s&&!n}function yK(e){for(const t of e.studio.scenes[0].layers)if(_K(t,e))return!0;return!1}function vK(e){const t=[];for(const o of e.studio.scenes[0].layers)_K(o,e)&&t.push(o);return t}function _K(e,t){const{assets:o,studio:{analytics:a}}=t,i=o.byId[e.asset_id||""],s=e.size||(null==i?void 0:i.size)||(null==i?void 0:i.file_size)||0;let n=262144e3;return a.activeFindHighlightsJobInfo&&(n=6442450944),s>n&&!("recordType"in e&&null!=e.recordType)}async function wK(e,t){const{state:o}=sr(),a=await Jr(`/api/v2/project/${e}/copy`,{body:t});if(a.destinationFolder&&a.destinationFolder._id){GM({newFolderId:a.destinationFolder._id,projectId:e,source:t.source,stateBeforeCopy:o}).catch(console.error)}return a}function bK(e,t){const{token:o,user:a}=t||{};return zr(`/api/v1/projects/${e}`,{parseJSON:!1,params:{token:o,userId:a&&a._id}})}async function TK(e,t,o){if(!e)return;const{token:a,user:i}=o||{};try{await qr(`/api/v1/projects/${e}`,{body:{token:a,userId:i&&i._id,project:t},parseJSON:!1})}catch(IGe){console.warn(IGe)}}function xK(e,t){return qr(`/api/v1/workspaces/${e}`,{body:{workspaceFields:t},parseJSON:!1})}function SK(e){return{type:"SET_PROJECT_NAME",projectName:e}}function EK(e){return{type:"SET_EXPORT_RESOLUTION",exportResolution:e}}function IK(e){return{type:"SET_EXPORT_QUALITY",exportQuality:e}}function CK(){return{type:"SET_ADDED_OPTIMIZED_LAYER"}}function kK(e){return{type:"SET_IS_BRANDKIT_TEMPLATE",isBrandKitTemplate:e}}const AK="other (please specify below)",jK=[...jr([{value:"hr",label:"HR"},{value:"marketing",label:"Marketing"},{value:"communications",label:"Communications"},{value:"media production",label:"Media Production"},{value:"creative agency",label:"Creative Agency"},{value:"sales",label:"Sales"},{value:"self-employed/freelance video creator",label:"Self-employed/Freelance Video Creator"}]),{value:"other (please specify below)",label:"Other (please specify below)"}],NK=[{value:"student",label:"Student"},{value:"teacher",label:"Teacher"},{value:"admin or district leader",label:"Admin or District Leader"}];jr([{value:"I want to learn how to edit videos",label:"I want to learn how to edit videos"},{value:"I need an easier way to create content faster",label:"I need an easier way to create content faster"},{value:"I need to make content to sell more of my products/services",label:"I need to make content to sell more of my products/services"},{value:"I need my content and posts to be more engaging",label:"I need my content and posts to be more engaging"}]);const RK=[...jr([{value:"I'm creating videos from scratch",label:"I'm creating videos from scratch"},{value:"I'm repurposing my existing videos for other social media platforms",label:"I'm repurposing my existing videos for other social media platforms"},{value:"I'm creating images or GIFs",label:"I'm creating images or GIFs"}]),{value:"other (please specify below)",label:"Other (please specify below)"}],PK=[{value:"Blog post or article",label:"Blog post or article"},{value:"Email",label:"Email"},{value:"Friend or co-worker",label:"Friend or co-worker"},{value:"LinkedIn",label:"LinkedIn"},{value:"Saw the watermark",label:"Saw the watermark"},{value:"Search engine (Google, Bing, etc.)",label:"Search engine (Google, Bing, etc.)"},{value:"TikTok",label:"TikTok"},{value:"Twitter",label:"Twitter"},{value:"YouTube",label:"YouTube"},{value:"other (please specify below)",label:"Other (please specify below)"}],DK={control:e=>({...e,background:"white",cursor:"pointer"}),singleValue:e=>({...e,fontFamily:"Open Sans",fontStyle:"normal",fontWeight:"normal",fontSize:"14px",color:"black"}),indicatorSeparator:()=>({display:"none"}),option:(e,{isFocused:t})=>({...e,fontFamily:"Open Sans",fontStyle:"normal",fontWeight:"normal",fontSize:"14px",color:t?"white":"black",textAlign:"left",backgroundColor:t?"#0083e2":""}),menuPortal:e=>({...e,zIndex:100})},OK=e=>({...e,colors:{...e.colors,primary:"#1fa2ff",primary50:"#1fa2ff"}}),LK=async(e,t,o,a,i)=>{const s=t.toLowerCase(),n=o.toLowerCase();((e,t,o,a,i)=>{const{state:s}=sr(),{currentUser:n}=s||{},{user:r}=n||{},{_id:l}=r||{},d={Usage:e,Occupation:t,"Project Usage":o,"Occupation Custom Response":a,"Project Usage Custom Response":i};Fm(ym.COMPLETED_ONBOARDING_SURVEY,d),l&&amplitude.getInstance().setUserId(l),amplitude.getInstance().setUserProperties(d)})(e,s,n,a,i),await FK({survey:{usage:e,occupation:s,projectUsage:n,date:new Date}}),np()};async function FK(e){await Jr("/api/v1/users/updateProfile/onboarding",{body:{onboarding:e},parseJSON:!1})}const MK=["audio","smart-cut","repurpose","reverse","remove-background","remove-image-background","green-screen","subtitles","add-audio","waveform","text-to-speech","default"];function UK(e){return MK.includes(e)}var BK=(e=>(e.AI_ARTICLE_TO_VIDEO="/ai/article-to-video",e.AI_AUDIO_ENHANCER="/ai/audio-enhancer",e.AI_AUTO_SPEAKER_FOCUS="/ai/auto-speaker-focus",e.AI_BLOG_TO_VIDEO="/ai/blog-to-video",e.AI_CLIP_MAKER="/ai/clip-maker",e.AI_CLIP_MAKER_PODCAST="/ai/clip-maker/podcast",e.AI_CLIP_MAKER_TIKTOK="/ai/clip-maker/tiktok",e.AI_DUBBING="/ai/dubbing",e.AI_IMAGE_ENHANCER="/ai/image-enhancer",e.AI_IMAGE_GENERATOR="/ai/image-generator",e.AI_MAGIC_FILL="/ai/image-extender",e.AI_OVERVIEW="/ai/overview",e.AI_TEXT_TO_VIDEO="/ai/text-to-video",e.AI_VIDEO_GENERATOR="/ai-video-generator",e.AI_VIDEO_SCRIPT_GENERATOR="/ai/video-script-generator",e.AI_VIDEO_SCRIPT_GENERATOR_PODCAST="/ai/video-script-generator/podcast",e.AI_VOICE_CLONING="/ai/voice-cloning",e.AI_VOICE_OVER_GENERATOR="/ai/voice-over-generator",e.AI_VOICE_OVER_GENERATOR_FEMALE="/ai/voice-over-generator/female",e.AI_VOICE_OVER_GENERATOR_MALE="/ai/voice-over-generator/male",e.B_ROLL_GENERATOR="/ai/b-roll-generator",e.GIF_MAKER="/tools/make/gif",e.MUTE_VIDEO="/tools/mute",e.SUBTITLES="/subtitles",e.SUBTITLES_ADD_SUBTITLES="/subtitles/add-subtitles",e.SUBTITLES_AUTO_GENERATOR="/subtitles/auto-generator",e.SUBTITLES_TRANSLATOR="/subtitles/translator",e.TEAMS_TRAINING="/teams/training",e.TEAMS_CREATIVE_AGENCIES="/teams/creative-agencies",e.TEAMS_MARKETING="/teams/marketing",e.TOOLS_ADD_AUDIO="/tools/add-audio",e.TOOLS_ADD_AUDIO_SOUND_EFFECTS="/tools/add-audio/sound-effects",e.TOOLS_ADD_EFFECTS_WAVEFORM="/tools/add-effects/waveform",e.TOOLS_ADD_IMAGE="/tools/add-image",e.TOOLS_ADD_TEXT="/tools/add-text",e.TOOLS_AUDIIO_EDITOR_EXTRACT="/tools/audio-editor/extract",e.TOOLS_AUDIO_EDITOR_AUDIO_ENHANCER="tools/audio-editor/audio-enhancer",e.TOOLS_COMPRESS="/tools/compress",e.TOOLS_COMPRESS_GIF="/tools/compress/gif",e.TOOLS_CONVERT="/tools/convert",e.TOOLS_CROP="/tools/crop",e.TOOLS_MAKE_VIDEO_CLIP="/tools/make/video-clip",e.TOOLS_MAKE_VIDEO_MONTAGE="/tools/make/video/montage",e.TOOLS_MAKE_VOICE_OVER="/tools/make/voice-over",e.TOOLS_MERGE_IMAGE="/tools/merge/image",e.TOOLS_REMOVE_BACKGROUND="/tools/remove-background",e.TOOLS_REMOVE_BACKGROUND_NOISE="/tools/remove-background/noise",e.TOOLS_RESIZE="/tools/resize",e.TOOLS_RESIZE_IMAGE="/tools/resize/image",e.TOOLS_RESIZE_TIKTOK="/tools/resize/tiktok",e.TOOLS_SMART_CUT_FILLER_WORDS="/tools/smart-cut/filler-words",e.TOOLS_TRANSCRIBE="/tools/transcribe",e.TOOLS_TRANSCRIBE_MP4_TO_TEXT="/tools/transcribe/mp4-to-text",e.TOOLS_TEXT_TO_SPEECH="/tools/text-to-speech",e.TOOLS_TRANSCRIPTION="/tools/transcription",e.TOOLS_TRANSLATE="/tools/translate",e.TOOLS_TRIM="/tools/trim",e.VIDEO_EDITOR="/video-editor",e))(BK||{}),VK=(e=>(e.REDIRECT_SOURCE="redirect_source",e.SAMPLE="sample",e.SAMPLE_TYPE="sample_type",e.STUDIO_TOUR_STEP="studio_tour_step",e.STUDIO_TOUR_SOURCE="studio_tour_source",e.STUDIO_TOUR="studio_tour",e))(VK||{});function WK(){const{landingPageSource:e,withSample:t,sampleType:o}=$K();return{landingPageSource:e,withSample:t,sampleType:o}}const GK=e=>Object.values(BK).includes(e)?e:null,HK=e=>"true"===e,$K=()=>{const e=new URLSearchParams(window.location.search),t=e.get("redirect_source"),o=e.get("sample")??"",a=e.get("sample_type")??"";return{landingPageSource:GK(t),withSample:HK(o),sampleType:UK(a)?a:"default"}},KK=()=>{const{dispatch:e}=sr();e(EL())},zK=()=>{KK()},YK=()=>{const{state:e}=sr(),{studioTour:t,currentUser:o}=e,{onboarding:a}=o.user,{currentStep:i,tour:n,source:r}=t;switch(KK(),r){case ad.RepurposeOnboarding:FK({...a,[ad.RepurposeOnboarding]:{...null==a?void 0:a[ad.RepurposeOnboarding],dateDismissed:new Date}});break;case ad.Onboarding:Fm(ym.STUDIO_TOUR_DISMISS,{"Step Dismissed":s.capitalize(yL[n][i])}),FK({...a,studioTour:{...null==a?void 0:a.studioTour,dateDismissed:new Date}});break;case ad.LandingPage:Fm(ym.STUDIO_TOUR_DISMISS,{"Step Dismissed":s.capitalize(yL[n][i])}),window.history.replaceState({},"",qK())}},JK=()=>{const{state:e}=sr(),{source:t}=e.studioTour,o=e.currentUser.user.onboarding;switch(KK(),t){case ad.RepurposeOnboarding:FK({...o,[ad.RepurposeOnboarding]:{...null==o?void 0:o[ad.RepurposeOnboarding],dateComplete:new Date}});break;case ad.Onboarding:Fm(ym.STUDIO_TOUR_COMPLETE),FK({...o,studioTour:{...null==o?void 0:o.studioTour,dateComplete:new Date}});break;case ad.LandingPage:Fm(ym.STUDIO_TOUR_COMPLETE),window.history.replaceState({},"",qK())}},qK=()=>{const e=new URLSearchParams(window.location.search);for(const o of Object.values(VK))e.delete(o);const t=e.toString()?`?${e.toString()}`:"";return`${window.location.pathname}${t}`},XK=()=>{const{dispatch:e}=sr();e(TL(!0))},QK=()=>{const{state:e}=sr();switch(e.studioTour.tour){case fL.Onboarding:e.studioTour.userBeganTour?YK():KK();break;case fL.RepurposeOnboarding:ez(gL.TRIM_WITH_TRANSCRIPT)}},ZK=()=>{const{state:e,dispatch:t}=sr(),{studioTour:o}=e,{currentStep:a,tour:i,isOpen:s}=o;s&&(a<yL[i].length-1?t(wL(a+1)):JK())},ez=async(e,t={numSteps:1})=>{const{state:o}=sr(),{isOpen:a,tour:i,currentStep:s,source:n}=o.studioTour;if(n!==ad.LandingPage&&(await np(),!oz(n)))return void KK();a&&yL[i][s]===e&&g.batch((()=>{for(let e=0;e<t.numSteps;e++)ZK()}))},tz=()=>{const{state:e,dispatch:t}=sr(),{studioTour:o}=e,{currentStep:a}=o;a>0&&t(wL(a-1))},oz=e=>{const{state:t}=sr(),{isMobile:o}=t;if(o)return!1;switch(e){case ad.RepurposeOnboarding:{const{currentUser:e}=t,{onboarding:o}=e.user,{dateDismissed:a,dateComplete:i}=(null==o?void 0:o[ad.RepurposeOnboarding])||{},s=nu(t);return!(a||i||!s)}case ad.Onboarding:{const{currentUser:e}=t,{onboarding:o}=e.user,{date:a}=(null==o?void 0:o.survey)||{},{dateDismissed:i,dateComplete:s}=(null==o?void 0:o.studioTour)||{},n=new Date("Tue Jul 25 2023 00:08:21 GMT-0700 (Pacific Daylight Time)")>(a?new Date(a):new Date),r=nu(t);return!(i||s||n||!r)}case ad.LandingPage:case ad.Unknown:return!0;default:return!1}},az=({startTour:e,startStep:t,source:o,tour:a})=>{const{dispatch:i}=sr();if(!oz(o))return;const s=a??iz(o);if(s){if((e=>{const{dispatch:t}=sr();t(xL(e))})(s),(e=>{const{dispatch:t}=sr();t(SL(e))})(o),o===ad.LandingPage){const{withSample:e}=$K();(e||s===fL.RepurposeSample||s===fL.RepurposeOnboarding)&&XK()}else if(e&&XK(),t){const e=yL[s].findIndex((e=>e===t));0!==e&&XK(),-1!==e&&i(wL(e))}(()=>{var e,t;const{state:o,dispatch:a}=sr(),{source:i}=o.studioTour,s=o.currentUser.user.onboarding;if(!o.studioTour.isOpen)switch(a(bL(!0)),i){case ad.RepurposeOnboarding:FK({...s,[ad.RepurposeOnboarding]:{...null==s?void 0:s[ad.RepurposeOnboarding],firstShown:(null==(e=null==s?void 0:s[ad.RepurposeOnboarding])?void 0:e.firstShown)??new Date,lastShown:new Date}});break;case ad.Onboarding:FK({...s,studioTour:{...null==s?void 0:s.studioTour,firstShown:(null==(t=null==s?void 0:s.studioTour)?void 0:t.firstShown)??new Date,lastShown:new Date}})}})(),window.history.replaceState({},"",qK())}},iz=e=>{switch(e){case ad.Onboarding:return fL.Onboarding;case ad.RepurposeOnboarding:return fL.RepurposeOnboarding;case ad.LandingPage:{const{landingPageSource:e}=$K();return e?sz(e):null}case ad.Unknown:default:return null}},sz=e=>{switch(e){case BK.TEAMS_CREATIVE_AGENCIES:case BK.TEAMS_MARKETING:case BK.TEAMS_TRAINING:case BK.VIDEO_EDITOR:return fL.Onboarding;case BK.AI_CLIP_MAKER:case BK.AI_CLIP_MAKER_PODCAST:case BK.AI_CLIP_MAKER_TIKTOK:return fL.RepurposeSample;default:return null}},nz=()=>{const{state:e,dispatch:t}=sr();e.studioTour.isOpen&&e.studioTour.tour===fL.RepurposeSample&&t(cD({video:e.currentVideo,source:"studioTour",isFirstVideoLoad:!0}))},rz=()=>{const e=new URLSearchParams(window.location.search),t=e.get(VK.STUDIO_TOUR_STEP),o=e.get(VK.STUDIO_TOUR_SOURCE),a=e.get(VK.STUDIO_TOUR);az({source:o,startStep:t,startTour:!!t,tour:a}),window.history.replaceState({},"",qK())},lz=(e,t=!1)=>{const{state:o}=sr(),{scenes:a,allLayers:i}=o.studio,s=a[0];if(!s)return;const n=bE();if(ef(o))return;if(i.byId[e.id]&&!t)return;const{duration:r}=s;if(n>r||!r)return;const{type:l,isTrimmed:d,startTime:c=0,endTime:u=0}=e;switch(l){case"video":case"audio":e.videoDelay=n;break;case"image":case"shape":case"text":case"placeholder":{const a=sf(o),i=Math.max(a?128/a:3,2);e.isTrimmed=!0,e.startTime=n,e.endTime=n+i,t&&(d?e.endTime=n+u-c:n===r&&(e.endTime=2*r));break}}},dz=e=>{const{state:{studio:t}}=sr(),o=fT(e,t);return(null==o?void 0:o.type)?o:null},cz=()=>{const{state:{studio:e}}=sr(),{byId:t}=e.allLayers;return Object.values(t)},uz=(e,t)=>{const o=TS(e,0);return t>=o[0]&&t<=o[1]},mz=e=>{const{state:{studio:t}}=sr(),o=t.scenes[0];if(!o)return[];let a=o.layers;return o.duration>0&&(a=a.filter((t=>uz(t,e)))),a},pz=(e,t)=>{const o=Zu(e)||om(e),a=Zu(t)||om(t),i=o&&a,s=e.type===t.type;return i||s};function hz(e){const{start:t}=cm(e),o=new Set;for(const a of function*(e){const{state:t}=sr(),{selectedTimelineRows:o,scenes:a}=t.studio,i=a[0];if(!i)return;const{layers:s}=i;for(const d of o)yield d;const n=new Set,r=new Set;for(const d of s)null!=d.timelineRow&&d.timelineRow>=0&&!isNaN(d.timelineRow)&&(pz(d,e)&&n.add(d.timelineRow),r.add(d.timelineRow));for(const d of[...n].sort())yield d;const l=[...r].sort();if(r.size>0){l.length===l[l.length-1]+1&&(yield l.length);for(let e=0;e<l.length;e+=1)l[e]!==e&&(yield e>0?l[e-1]+1:0)}yield l.length}(e))if(!o.has(a)){if(bz(e,t,a))return a;o.add(a)}console.error("couldn't determine timeline row, this should never happen")}function gz(e,{undoable:t=!1,layerIndex:o,isReplacing:a=!1,isUndo:i=!1,knownTimelineRow:s=!1,newTimeline:n=!1}={}){t&&ff.beginBatch();try{const{dispatch:r,state:l}=sr(),{projectId:d,duration:c,hasCustomOutput:u,showCanvas:m}=l.studio,p=l.studio.scenes[0];if(!p)return;const{isAdding:h}=l.studioLocal,{projectName:f}=l,y=Zu(e)||om(e);(y?void 0===e.videoDelay:!e.startTime&&0!==e.startTime)&&lz(e);if(["video","audio","image"].includes(e.type)&&(["pastedLink","local"].includes(e.source??"")||!e.local_url||!e.metadataGathered||Cz(e))){if(!m&&"width"in e&&e.width&&!a){let t=`${e.width}:${e.height}`;"resize"===e.uploadLocation&&(t="400:400"),e.isMediaLibraryUpload||g.batch((()=>{r(lS(t)),r({type:"SHOW_STUDIO_CANVAS"})}))}n&&Tz(e),"resize"===e.uploadLocation&&(e.lockAspectRatio=!0),(a&&!e.position||!a)&&(e.position=ZE(e)),e.position&&!e.position.rotation&&(e.position.rotation=0),e.metadataGathered=!0,u&&Ez(e);const{currentUser:t}=l;d&&e.name&&0===p.layers.length&&!f&&(r(SK(function(e){let t=e;const o=e.split(".");return(o.pop()||"")in YU&&(t=o.join(".")),t}(e.name))),TK(d,{name:e.name},t))}0===c&&!Zu(e)&&!om(e)||s&&null!=e.timelineRow||(e.timelineRow=hz(e)),l.studioTour.isOpen&&!e.isSample&&(zK(),l.studioTour.userBeganTour&&YK()),r(Fv({layers:[e],isUndoable:t,layerIndex:o,fromUndo:i})),e.asset_id&&h[e.asset_id]&&r(q_(e.asset_id));const{scenes:v,videoType:_,videoTypeSetting:w}=sr().state.studio,b=v[0];if(!b)return;const{duration:T}=YN(b,lT(l.studio));b.layers.some((e=>!oC(e)&&!vz(e)))||!(e.mime&&(e.mime.includes("gif")||e.mime.includes("webp"))||e.url&&("gif"===bm(e.url)||"webp"===bm(e.url)))||w||r(bb(Kn.GIF)),"gif"!==_||oC(e)||w||e.conversion_type&&e.conversion_type.includes("gif")||r(bb(Kn.MP4)),KN(b,T,t)}catch(IGe){console.error(IGe)}finally{t&&ff.endBatch()}}const fz=(e,t,{knownTimelineRow:o,newTimeline:a,sceneId:i,undoable:s=!1})=>{((e=!1)=>{Fm(ym.REPLACE_LAYER,{"Replaced Placeholder":e})})(t.type===zl.Placeholder);try{s&&ff.beginBatch();const{state:{studio:n},dispatch:r}=sr(),l=n.scenes[0];if(!l)return;const{layers:d}=l,c=d.findIndex((e=>e.id===t.id)),{groups:u}=n,m=Object.entries(u).filter((e=>e[1].layers.some((e=>e.id===t.id))))[0];if(m){const o=m[0];r(Qv(e.id,o,!0,s)),r(e_(t.id,o,s)),r(a_(o,!0,s))}Az({layerIds:[t.id]}),gz(e,{sceneId:i,undoable:s,knownTimelineRow:o,layerIndex:c>=0?c:void 0,isReplacing:!0,newTimeline:a})}catch(IGe){console.error(IGe)}finally{s&&ff.endBatch()}},yz=({newLayer:e,options:t,idOfLayerToReplace:o})=>{if(o){const{allLayers:a}=sr().state.studio;let i=a.byId[o];if(i){if(i.animation){const e=kz(i);if(e.length){sr().dispatch(Lv(e,t.undoable));const{allLayers:a}=sr().state.studio,s=a.byId[o];s&&(i=s)}}const a=sC(e,i);return fz(a,i,t),a}}return gz(e,t),e},vz=e=>e.conversion_type&&e.conversion_type.includes("gif-to"),_z=m((e=>{var t,o;return null==(o=null==(t=e.studio.scenes)?void 0:t[0])?void 0:o.layers}),((e=[])=>e.filter((e=>!(e.requireConversion&&!e.preview&&null==e.duration))))),wz=m(_z,((e,t)=>t),((e,t)=>{const o=[];for(const a of e)a.timelineRow===t&&o.push(a);return o}));function bz(e,t,o){const{state:a}=sr(),i=wz(a,o),[s,n]=TS(e,0),r=t+(n-s);for(const l of i){const[e,o]=TS(l,0);if(!(o<=t)&&!(e>=r))return!1}return!0}const Tz=e=>{const{state:t}=sr(),{width:o,height:a}=xz(e.width,e.height),{x:i,y:s}=fj(t.studio.width,t.studio.height,t.studio.canvasX,t.studio.canvasY,o,a);Sz(e,{x:i,y:s,width:o,height:a,rotation:0,flip:{x:!1,y:!1}})},xz=(e,t)=>{const{state:o}=sr(),a=[e,t],{width:i,height:s}=gj(a,{width:o.studio.width,height:o.studio.height});return{width:i,height:s}},Sz=(e,t,o=!1)=>{const{dispatch:a}=sr(),i=qE(t.x,t.y),s=zE(t.width,t.height);LE(e.id,{positionTemp:null}),a(Uv(e,i.xPercent,i.yPercent,s.widthPercent,s.heightPercent,o)),a(Wv(e,t.rotation,o))},Ez=e=>{const{state:t}=sr(),{customOutputWidth:o}=t.studio,{customOutputHeight:a}=t.studio;(o>3840||a>3840)&&("video"===e.type||e.mime&&"gif"===e.mime.split("/")[1])&&SN()},Iz=ff.withUndoBatch(((e,t,o)=>{const{dispatch:a,state:i}=sr(),{ratio:s}=i.studio,{ratioWidth:n,ratioHeight:r}=bj(s),{scenes:l,width:d,height:c}=i.studio,u=l[0];if(!u)return;const m={w:UE(100*n/r),h:UE(100*r/n)},p={x:UE((d-c)/2/c*-100),y:UE((c-d)/2/d*-100)},h=1===u.layers.length;o.forEach((o=>{var i,s,l,d;const c={x:UE(null==(i=o.position)?void 0:i.x),y:UE(null==(s=o.position)?void 0:s.y),width:UE(null==(l=o.position)?void 0:l.width),height:UE(null==(d=o.position)?void 0:d.height),x90:UE(p.x),y90:UE(p.y),width90:UE(m.w),height90:UE(m.h)};h&&o.position.rotation%90==0&&(100===Math.round(c.width)&&100===Math.round(c.height)&&0===Math.round(c.x)&&0===Math.round(c.y)||c.width===c.height90&&c.height===c.width90&&c.x===c.y90&&c.y===c.x90)&&e%90==0&&(UN({ratioWidth:r,ratioHeight:n}),SN(),90!==e&&270!==e||(LE(o.id,{positionTemp:null}),a(Uv(o,`${c.x90}%`,`${c.y90}%`,`${c.width90}%`,`${c.height90}%`))),0!==e&&180!==e||(LE(o.id,{positionTemp:null}),a(Uv(o,"0%","0%","100%","100%")))),a(Wv(o,e,t))}))})),Cz=e=>{const{state:t}=sr(),o=fT(e.id,t.studio);return null==o||!o.position||Object.keys(o.position).some((e=>{const t=e,a=o.position[t];return"string"==typeof a&&a.includes("NaN")}))},kz=e=>{var t,o,a;return[...(null==(t=e.animation)?void 0:t.intro)||[],...(null==(o=e.animation)?void 0:o.outro)||[],...(null==(a=e.animation)?void 0:a.constant)||[]]},Az=ff.withUndoBatch((({layerIds:e,groupId:t,undoable:o=!0,logEvent:a=!1})=>{const{dispatch:i,state:s}=sr(),{byId:n}=s.studio.allLayers,r=[],l=[],d=[];let c=!1;e.forEach((e=>{const t=n[e];t&&(r.push(...kz(t)),l.push(t),fI(e)&&d.push(e),!c&&(e=>{var t;return(null==(t=e.mime)?void 0:t.includes("gif"))||e.url&&"gif"===bm(e.url)})(t)&&(c=!0))})),g.batch((()=>{c||i(bb(Kn.MP4)),r.length&&i(Lv(r,o)),d.length&&i(((e,t=!0)=>({type:"DELETE_MULTIPLE_LAYERS_KEYFRAMES",undoable:t,layerIds:e}))(d,o)),i(function(e,t,o){return{type:"REMOVE_LAYERS",layers:e,source:t,undoable:o}}(l,"studioDeleteLayersById",o)),t&&i(o_(t,o)),i(l_(null,o))}))})),jz=e=>{const{dispatch:t}=sr();t(q_(e))},Nz=ff.withUndoBatch((e=>{const{dispatch:t}=sr();e.forEach((e=>t(Gv(e,"x",!0))))})),Rz=ff.withUndoBatch((e=>{const{dispatch:t}=sr();e.forEach((e=>t(Gv(e,"y",!0))))})),Pz=ff.withUndoBatch(((e,t,o)=>{const a={},i={};e.forEach((e=>{const s={relative:`${t}%`};o?(i[e.id]={borderRadiusTemp:null},a[e.id]={borderRadius:s}):i[e.id]={borderRadiusTemp:s}})),g.batch((()=>{OI(a,"layers.ts",!0),FE(i)}))})),Dz=ff.withUndoBatch(((e,t,o)=>{const a={},i={};e.forEach((e=>{o?(i[e.id]={textPaddingTemp:null},a[e.id]={textPadding:t}):i[e.id]={textPaddingTemp:t}})),g.batch((()=>{OI(a,"layers.ts",!0),FE(i)}))})),Oz=(e,t,o=0,a=0)=>{const{relative:i=0}=e||t.borderRadius||{};return o<a?parseFloat(i)/100*o:parseFloat(i)/100*a},Lz=e=>{const{dispatch:t}=sr(),o=dz(e);OI({[o.id]:{locked:!o.locked}},"layers.ts",!0),o.locked||t(l_(null))},Fz=(e,t)=>{var o;const{dispatch:a,state:i}=sr(),s=[];Object.keys(null==(o=i.studio.allLayers)?void 0:o.byId).forEach((t=>{var o;const a=null==(o=i.studio.allLayers)?void 0:o.byId[t];a&&Tu(a)===e&&s.push(a.id)}));const{localUrl:n,trackPreviewLocalUrl:r,thumbnailSheetLocalInfo:l}=t;if(r){const e={};s.forEach((t=>{e[t]={trackPreviewLocalUrl:r}})),FE(e)}l&&a(c_(e,{thumbnailSheetLocalInfo:l}));const d={};s.forEach((e=>{d[e]={local_url:n}})),a({type:"UPDATE_LAYERS_NO_SYNC",updates:d})};function Mz(e,t,o){const{dispatch:a,state:{mediaCache:{uploadIdToMediaCacheId:i},studio:{_id:s,thisProjectCMLFiles:n}}}=sr();g.batch((()=>{if(a(JP([e])),t&&(a(Nb([t])),t.teamId?a(Rp((e=>({...e,cmlIds:[...e.cmlIds,t.id]})))):(a(jb([t.id])),(null==n?void 0:n[t.id])||a(mD(t,s))),t.duplicate&&a(Fb({id:t.id,modified:new Date(t.modified)})),o&&a(Db({cmlFileId:t.id,uploadId:o}))),o){const t=i[o];t&&a(yu({assetId:e._id,mediaCacheId:t}))}}))}const Uz=e=>{if(!e.position)return-1;const t=parseFloat(e.position.x),o=parseFloat(e.position.y),a=parseFloat(e.position.width),i=parseFloat(e.position.height),s=Ru(t,0,100),n=Ru(o,0,100);return(Ru(t+a,0,100)-s)*(Ru(o+i,0,100)-n)/100},Bz=(e,t,o)=>{const a={...e,id:`blurred-layer-${oe.v4()}`,originalLayerId:e.id,filters:{...e.filters,blurPercent:5},position:{x:"-5%",y:"-5%",width:"110%",height:"110%",rotation:0},crop:void 0,borderRadius:{relative:"0%"},isTrimmed:!0,animation:void 0,isCanvasBlurLayer:!0,blurBg:!1,removeBg:!1};if("video"===e.type){a.isMuted=!0;const i=e.playbackRate??1,s=e.startTime??0,n=(e.endTime??e.duration??0)-s,r=(t-(e.videoDelay??0))/(n/i),l=(o-(e.videoDelay??0))/(n/i);a.startTime=s+r*n,a.endTime=s+l*n,a.videoDelay=t}else a.startTime=t,a.endTime=o;return a},Vz=e=>{const t=[];return e.forEach((e=>{const{layer:o,percent:a}=(e=>{let t=null,o=0;for(const a of e)if(!a.isHidden&&$z(a)){const e=Uz(a);e>=o&&(t=a,o=e)}return{layer:t,percent:o}})(e.layers);a>=99||null!==o&&t.push({layer:Bz(o,e.startTime,e.endTime),startTime:e.startTime,endTime:e.endTime})})),t},Wz=e=>{const t=(e=>{const t=[];return e.forEach((e=>{if(e&&!1!==e.canvasBlurValid&&$z(e)){const[o,a]=TS(e,0);let i=null,s=null;if([...Array(t.length).keys()].forEach((n=>{const r=t[n];o>r.startTime&&o<r.endTime&&(i=n),a>r.startTime&&a<r.endTime&&(s=n),r.startTime>=o&&r.endTime<=a&&r.layers.push(e)})),0===t.length){if(o>0){const e={layers:[],startTime:0,endTime:o};t.push(e)}const i={layers:[e],startTime:o,endTime:a};t.push(i)}else if(a<t[0].startTime){const i=t[0].startTime,s={layers:[e],startTime:o,endTime:a},n={layers:[],startTime:a,endTime:i};t.push(s),t.push(n)}else if(o>t[t.length-1].endTime){const i={layers:[],startTime:t[t.length-1].endTime,endTime:o},s={layers:[e],startTime:o,endTime:a};t.push(i),t.push(s)}else{if(a>t[t.length-1].endTime){const o={layers:[e],startTime:t[t.length-1].endTime,endTime:a};t.splice(t.length,0,o)}if(null!==s&&null!==i&&i===s){const s=t[i],n=s.startTime;s.startTime=a;const r={layers:[...s.layers],startTime:n,endTime:o},l={layers:[...s.layers],startTime:o,endTime:a};l.layers.push(e),t.splice(i,0,l),t.splice(i,0,r)}else{if(null!==s){const o=t[s],i=o.startTime,n=a;o.startTime=n;const r={layers:[...o.layers],startTime:i,endTime:n};r.layers.push(e),t.splice(s,0,r)}if(null!==i){const a=t[i],s=o,n=a.endTime;a.endTime=s;const r={layers:[...a.layers],startTime:s,endTime:n};r.layers.push(e),t.splice(i+1,0,r)}}if(o<t[0].startTime){const a={layers:[e],startTime:o,endTime:t[0].startTime};t.splice(0,0,a)}}}})),t})(e);return Vz(t)},Gz=[],Hz=m((e=>e),(e=>0===e.length?Gz:Wz(e))),$z=e=>("video"===e.type||"image"===e.type)&&void 0===e.canvasBlurValid||e.canvasBlurValid,Kz=()=>{var e;const{state:t}=sr();return!(null==(e=t.studio.scenes[0])?void 0:e.layers.every((e=>!$z(e))))},zz=(e,t,o=!1)=>{const a=Yg()||qg();return(!o||!Yg())&&(!(0!==t&&!o)&&(!!e.scenes&&(!(a&&e.canvasBlur&&Kz())&&e.scenes.every((e=>e.layers.every((e=>(!a||null==e.filters&&!e.presetFilter)&&("image/gif"!==e.mime&&"gif"!==bm(e.url)&&(("image/webp"!==e.mime||"static"===e.webpType)&&("pastedLink"!==e.source&&(!e.removeBg&&!e.blurBg&&("placeholder"!==e.type&&(!e.uploadPending||(console.error("Layer still uploading:",e),!1))))))))))))))};class Yz extends Error{constructor(e){super(),this.name="AudioIDBError",this.message=e}}function Jz(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let o=0;o<8;o+=1)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function qz(){const{history:e}=sr(),{pathname:t}=e.location;return t.match(/studio\/editor$/)||t.includes("upload")||t.includes("replace")||t.includes("mediaLibrary")||t.includes("search")||t.includes("emoji")||t.includes("remove-background")||t.includes("plugins")}const Xz=e=>{const t=RU(Bl.UNLIMITED_UPLOAD_SIZE_LIMIT),o=RU(Bl.UNLIMITED_EXPORT_DURATION_LIMIT);!_K(e,sr().state)||t||VI(e.id)?"duration"in e&&e.duration&&e.duration>240&&!o&&!VI(e.id)&&Fm(ym.PAYWALLED_UPLOAD,{"Upload Type":e.type,Duration:e.duration}):Fm(ym.PAYWALLED_UPLOAD,{"Upload Type":e.type,"File Size":e.size})},Qz=()=>({id:P()}),Zz=async(e,t,o)=>{const{state:a}=sr(),{currentUser:{user:{_id:i}}}=a;let s;const{name:n,size:r,type:l,recordType:d}=e;if(d){s=`Recorded ${d} ${a.studio.scenes[0].layers.reduce(((e,t)=>t.recordType?e+1:e),0)+1}`}const c=URL.createObjectURL(e),u=await AB(c,e),m=u?u.type:t.type;if(!m)throw Error("Could not identify media type");const p={videoDelay:0};(null==o?void 0:o.addAtSeeker)&&(p.videoDelay=bE());const h={...Qz(),name:s||n,size:r,mime:l,...d&&{recordType:d},local_url:c,source:"local",objectFit:"cover",...t,...u,type:m,...(null==o?void 0:o.addAtSeeker)&&p,uploaderId:i};return"video"===(null==u?void 0:u.type)&&(h.startTime=t.startTime??0,h.endTime=t.endTime??u.duration),h},eY=async(e,t,o)=>{const a=bu(t),i=await d$(a);let s;if(i&&"video"===i.type){const e=i.optimizedPreviewFile_v2??i.file_v2;e&&(s={duration:e.duration,hasAudio:e.hasAudio,width:t.width||e.width,height:t.height||e.height,type:i.type})}if(i&&"image"===i.type){const e=i.optimizedPreviewFile_v2??i.file_v2;e&&(s={width:t.width||e.width,height:t.height||e.height,type:i.type})}if(!s){const a={name:t.name,type:t.mime??void 0};s=(null==o?void 0:o.mediaInfo)?o.mediaInfo:await AB(e,a)}const n=(null==o?void 0:o.overwriteLayerType)||(null==s?void 0:s.type)||t.type;if(!n)throw Error("Could not identify media type");return{...Qz(),url:e,name:Jz(),source:"upload",objectFit:"cover",...t,...s,type:n}},tY=e=>{var t,o,a,i;const s=e,n=oY(s);if(n)return n===zl.Image&&(null==(t=s.dimensions)?void 0:t.width)&&(null==(o=s.dimensions)?void 0:o.height)?{width:s.dimensions.width,height:s.dimensions.height,type:n}:n===zl.Audio&&s.duration?{duration:s.duration,hasAudio:!0,type:n}:n===zl.Video&&s.duration&&(null==(a=s.dimensions)?void 0:a.width)&&(null==(i=s.dimensions)?void 0:i.height)&&"hasAudio"in s?{width:s.dimensions.width,height:s.dimensions.height,duration:s.duration,hasAudio:s.hasAudio,type:n}:void 0},oY=e=>{var t,o;if(e.content_type){if(MB(e.content_type))return zl.Audio;if(wB(e.content_type))return zl.Image;if(bB(e.content_type)){if(!(null==(t=e.dimensions)?void 0:t.width)||!(null==(o=e.dimensions)?void 0:o.height))return;return IB(e.content_type,e.dimensions.width,e.dimensions.height)}}},aY=(e,t)=>(al((()=>{var o;const{selectLayerInCreator:a=!1,sceneId:i="",layerToReplace:s,newTimeline:n=!1,knownTimelineRow:r=!1,multiRowUploadForRecording:l=!1,singleFileUpload:d=!1,selectedGroupId:c="",skipStudioAddLayer:u=!1,useCustomVideoDelay:m}=t||{},{state:p}=sr(),h=!0;if(!(null==(o=null==p?void 0:p.currentUser)?void 0:o.token)&&(e.wasUploadedAnonymously=!0),!e.originalName&&e.name&&(e.originalName=e.name),e.requireConversion)return((e,t,o,a)=>{const{dispatch:i}=sr(),s={position:null,...e};Xz(s);const n=o;return s.position=ZE(s),lz(s),["convert","resize"].includes(e.origin)||i(l_({id:s.id,type:"layer"})),e.isMediaLibraryUpload||(a&&i(Mv(a,"handleUploadRequiringConversion")),gz(s,{sceneId:n})),"resize"===e.uploadLocation&&(s.lockAspectRatio=!0),t&&qz()&&["pastedLink","local"].includes(e.source)&&"oneoff-landing-page"!==e.origin&&rE(),s})(e,a,i,s);!["pastedLink","local"].includes(e.source??"")&&e.local_url&&e.metadataGathered&&!uY(e)||Xz(e);const g=l||d;m||s||e.isMediaLibraryUpload||!g||lz(e),m&&(e.type===zl.Image?e.startTime=m:e.videoDelay=m),s?fz(e,s,{knownTimelineRow:r,newTimeline:n,sceneId:i,undoable:h}):e.isMediaLibraryUpload||u||gz(e,{knownTimelineRow:r,newTimeline:n,sceneId:i,undoable:h}),((e,t,o)=>{const{dispatch:a,history:i}=sr(),{pathname:s}=i.location;s.includes("/upgrade")||(t&&qz()||"oneoff-landing-page"===e.origin?(a(l_(o?{id:o,type:"group"}:{id:e.id,type:"layer"})),"oneoff-landing-page"===e.origin||s.includes("/studio/editor")?(s.includes("/overlay/upload")||s.includes("/overlay/library")||s.includes("/overlay/search")||s.includes("/overlay/projects")||s.includes("/overlay/emojis")||s.includes("/plugins")||s.includes("/drag-upload")||s.includes("/replace")||s.includes("/mediaLibraryUpload"))&&rE():rE()):"resize"!==e.uploadLocation&&"convert"!==e.uploadLocation||rE())})(e,a,c)})),e),iY=e=>{const{dispatch:t,state:o}=sr(),a={};if(XR.forEach((t=>{t in e&&(a[t]=e[t])})),t(function(e,t){return{type:"UPDATE_UPLOADED_LAYER",layer:e,properties:t}}(e,a)),a.asset_id){const e=[];Object.values(o.studio.allLayers.byId).forEach((t=>{t.uploadId==t.uploadId&&e.push(t.id)})),t(QP({assetId:a.asset_id,layerIds:e}))}return e},sY=e=>`${(e/1e6).toFixed(1)}MB`;function nY(e){if(!e)return null;const{progress:t=0,conversionProgress:{conversion:o=101,gather_assets:a=101,uploading_converted:i=101}={}}=e;let s=null;if(t<100)s=`Uploading ... ${t}%`;else if(a<100)s="Getting Assets ... ";else if(o<100)s=`Converting ... ${o}%`;else if(i<100)s="Uploading ... ";else if(e.uploadManager&&VB(e.uploadManager.layer))return"Converting ... ";return s}function rY(e){if(!e)return null;const{progress:t=0,conversionProgress:{conversion:o=101,gather_assets:a=101,uploading_converted:i=101}={}}=e;let s=null;return t<100?s=t:a<100?s=a:o<100?s=o:i<100&&(s=i),s}function lY(){return function(){const{state:e}=sr(),{scenes:t,background:o}=e.studio;return!(o!==ey&&!t.find((e=>e.background===ey)))}()?"png":"jpeg"}function dY(){const{state:e}=sr(),{studio:t}=e,o=zz(t,t.duration,!1),a=lY();return o?a:"png"}const cY=(e,t,o)=>{const a=e=>{const t=e.toString(16);return 1===t.length?`0${t}`:t};return`#${a(e)}${a(t)}${a(o)}`.toUpperCase()},uY=e=>{const{state:t}=sr(),o=fT(e.id,t.studio);return!(null==o?void 0:o.position)||Object.keys(o.position).some((e=>{const t=e,a=o.position[t];return"string"==typeof a&&a.includes("NaN")}))},mY=["topLeft","topRight","bottomLeft","bottomRight"],pY=["middleLeft","middleRight"],hY=[...mY,...pY],gY=["top","left","bottom","right"],fY=(e,t)=>Math.sqrt(e*e+t*t),yY=({x:e,y:t},{x:o,y:a})=>180*Math.atan2(a-t,o-e)/Math.PI,vY=e=>e*Math.PI/180,_Y=e=>Math.cos(vY(e)),wY=e=>Math.sin(vY(e)),bY=(e,t,o)=>{let a=t,i=e+t;return i<=o&&(a=o-e,i=o),{deltaW:a,width:i}},TY=(e,t,o)=>{let a=t,i=e+t;return i<=o&&(a=o-e,i=o),{deltaH:a,height:i}},xY=(e,t,o,a,i,s,n)=>{const{rotateAngle:r}=t;let l,d,{width:c,height:u,centerX:m,centerY:p}=t,h=a,g=o;switch(e){case"topRight":if(i){const e=c+o,t=u-a,s=1/i+i;g=(e*i+t)/s-c,h=u-(e+t/i)/s}h=-h,d=bY(c,g,s),l=TY(u,h,n),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m+=g/2*_Y(r)+h/2*wY(r),p+=g/2*wY(r)-h/2*_Y(r);break;case"topLeft":if(i){const e=c-o,t=u-a,s=1/i+i;g=c-(e*i+t)/s,h=u-(e+t/i)/s}g=-g,h=-h,d=bY(c,g,s),l=TY(u,h,n),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m-=g/2*_Y(r)-h/2*wY(r),p-=g/2*wY(r)+h/2*_Y(r);break;case"bottomRight":if(i){const e=c+o,t=u+a,s=1/i+i;g=(e*i+t)/s-c,h=(e+t/i)/s-u}d=bY(c,g,s),l=TY(u,h,n),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m+=g/2*_Y(r)-h/2*wY(r),p+=g/2*wY(r)+h/2*_Y(r);break;case"bottomLeft":if(i){const e=c-o,t=u+a,s=1/i+i;g=c-(e*i+t)/s,h=(e+t/i)/s-u}g=-g,d=bY(c,g,s),l=TY(u,h,n),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,i&&(u=c/i,h=g/i),m-=g/2*_Y(r)+h/2*wY(r),p-=g/2*wY(r)-h/2*_Y(r);break;case"middleRight":h=0,d=bY(c,g,s),l=TY(u,h,n),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m+=g/2*_Y(r)-h/2*wY(r),p+=g/2*wY(r)+h/2*_Y(r);break;case"middleLeft":g=-g,h=0,d=bY(c,g,s),l=TY(u,h,n),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m-=g/2*_Y(r)+h/2*wY(r),p-=g/2*wY(r)-h/2*_Y(r)}return{position:{centerX:m,centerY:p},size:{width:c,height:u}}},SY=(e,t,o,a)=>{const{x:i,y:s,width:n,height:r}=e,{x:l,y:d}=t,{x:c,y:u,width:m,height:p}=o,h=t.width/o.width,g=t.height/o.height;let f,y;switch(a){case"topLeft":f=l-c,y=d-u;break;case"topRight":f=l+m-(c+m),y=d+p-(u+p);break;case"bottomLeft":f=-(c-l),y=-(u-d);break;case"bottomRight":f=0,y=0;break;default:return null}return{x:(i-l+f)*h+l,y:(s-d+y)*g+d,width:n*g,height:r*g}},EY=(e,t,o)=>{const a=e.x+e.width/2,i=e.y+e.height/2,s=t.x+t.width/2,n=t.y+t.height/2,r=t.rotation-o.rotation,l=r*Math.PI/180;let d;d=o.rotation!==e.rotation?r+e.rotation:t.rotation;const c=Math.cos(l)*(e.x-a)-Math.sin(l)*(e.y-i)+a,u=Math.cos(l)*(e.y-i)+Math.sin(l)*(e.x-a)+i,m=Math.cos(l)*(e.x-s)-Math.sin(l)*(e.y-n)+s,p=Math.cos(l)*(e.y-n)+Math.sin(l)*(e.x-s)+n;return{newX:e.x+m-c,newY:e.y+p-u,layerRotation:d}},IY=(e,t,o,a)=>{const i=t-a,s=o-a;return{topLeft:[0,0,i,s],topRight:[i,0,0,s],bottomLeft:[0,s,i,0],bottomRight:[i,s,0,0],middleLeft:[0,s/2,i,0],middleRight:[i,s/2,0,0]}[e]},CY=e=>{if(Su(e))return!0;return 0===e.button},kY=Math.random()<.05;let AY=[],jY=null;const NY=(e,t)=>{jY||(jY=setTimeout((()=>{jY=null,sr().dispatch(Rh(AY)),AY=[]}),0)),AY.push({font:e,status:t})},RY=new Map;function PY(e){return document.fonts.check(`12px "${e}"`)}function DY({name:e,url:t}){const o=`${e}_${t}`;let a=RY.get(o);return a||(a=new Promise(((o,a)=>{function i(e){setTimeout((()=>o(e)),0)}FY.runExclusive((()=>{const o=new window.FontFace(e,`url(${t})`);document.fonts.add(o);yH({actionDescription:"Loading font with FontFace",timeoutMs:2e4,promise:o.load()}).then((()=>{NY(e,"success"),i({firstLoad:!0})})).catch((o=>{NY(e,"failed"),console.error(o);if(PY(e))return NY(e,"success"),void i({firstLoad:!0});var s;kY&&f(o instanceof fH?"Font Loading - FontFace load timed out":"Font Loading - FontFace load failed",{tags:{font:e},extra:{name:e,url:t,error:o}}),s=o,setTimeout((()=>a(s)),0)}))}))})),RY.set(o,a)),a}const OY=[300,400,700,800].map((e=>`${e},${e}i`)).join(",");async function LY({name:e,withWeights:t}){const o=t?`${e}:${OY}`:e,a=o;let i=RY.get(a);return i||(i=new Promise(((t,a)=>{const i=e=>{setTimeout((()=>t(e)),0)};FY.runExclusive((()=>{let t=!1;const s=Date.now();ut.load({timeout:2e4,google:{families:[o]},fontactive:()=>{t||(NY(e,"success"),t=!0,i({firstLoad:!0}))},fontinactive:()=>{if(t)return;if(PY(e))return NY(e,"success"),t=!0,void i({firstLoad:!0});if(kY){const t=(Date.now()-s)/1e3;f("Font Loading - WebFont loader failed",{tags:{font:e,likelyTimedOut:t>19.5},extra:{loadTimeSec:t}})}var o;NY(e,"failed"),t=!0,o=new Error("WebFont loader failed"),setTimeout((()=>a(o)),0)}})}))})),RY.set(a,i)),i}const FY=new dt(8),MY=async({fontToLoad:e,withWeights:t=!0})=>{if("undefined"==typeof document)return{firstLoad:!1};const{fontFamily:o}=e;var a,i;return a=o,sr().state.loadedFonts[a]||"success"===(null==(i=AY.find((e=>e.font===a)))?void 0:i.status)?{firstLoad:!1}:"default"===e.type?UY(e,t):(BY(GY(e)),BY(e))},UY=async(e,t)=>{const{fontFamily:o}=e;if(Ih.has(o))return{firstLoad:!1};if(Ah.has(o)||ct.has(o))return LY({name:o,withWeights:t});if(o in Ch){return DY({name:o,url:`https://cdn-useast1.kapwing.com/defaultFonts/${Ch[o]}`})}throw NY(o,"failed"),f("Font Loading - Unloadable font",{tags:{font:o}}),new Error(`Don't know where to load default font ${o} from`)},BY=async e=>{const{fontFamily:t}=e;return DY({name:t,url:e.url})},VY=(e=[])=>{for(const t of e)MY({fontToLoad:t,withWeights:!0})},WY=async e=>{try{return await DY({name:e.fontFamily,url:e.url}),!0}catch(t){console.error(t)}return!1},GY=e=>({...e,fontFamily:`asset_${e.asset_id}`});function HY(e){if(e.hasCustomFont&&(!e.asset_id||!e.url)){const t=function(e){const{fontFamily:t}=e,{state:o}=sr(),{selectedWorkspace:a,allWorkspaces:i}=o.workspaces,{activeBrandkit:s}=o.teams,n=[];for(const d of i)a!==d._id&&n.splice(0,0,d),n.push(d);let r;function l(e){if(r)return;const o=null==e?void 0:e.find((e=>e.fontFamily===t?e:null));o&&(r={type:"custom",fontFamily:o.fontFamily,url:o.url,asset_id:o.asset_id})}if(s){const e=[];s.fonts.forEach((t=>{"custom"===t.type&&e.push(t)})),l(e)}for(const d of n){if(r)break;l(d.customFonts)}return r&&OI({[e.id]:{asset_id:r.asset_id,url:r.url,preemptiveDownloadError:!1}},"attemptToGetCustomFontWithoutAssetId",!1),r}(e);if(t)return t}return VC(e)}var $Y={alignVert:!1,alignHoriz:!1,multiLine:!1,detectMultiLine:!0,minFontSize:6,maxFontSize:80,reProcess:!0,widthOnly:!1,alignVertWithFlexbox:!1};function KY(e,t){if(o=e,!("object"==typeof HTMLElement?o instanceof HTMLElement:o&&"object"==typeof o&&null!==o&&1===o.nodeType&&"string"==typeof o.nodeName)||!t.reProcess&&e.getAttribute("textFitted"))return!1;var o,a,i,s,n,r,l,d;if(t.reProcess||e.setAttribute("textFitted",1),s=e.innerHTML,n=function(e){var t=window.getComputedStyle(e,null);return e.getBoundingClientRect().width-parseInt(t.getPropertyValue("padding-left"),10)-parseInt(t.getPropertyValue("padding-right"),10)}(e),i=function(e){var t=window.getComputedStyle(e,null);return e.getBoundingClientRect().height-parseInt(t.getPropertyValue("padding-top"),10)-parseInt(t.getPropertyValue("padding-bottom"),10)}(e),!n||!t.widthOnly&&!i)throw t.widthOnly?new Error("Set a static width on the target element "+e.outerHTML+" before using textFit!"):new Error("Set a static height and width on the target element "+e.outerHTML+" before using textFit!");-1===s.indexOf("textFitted")?((a=document.createElement("span")).className="textFitted",a.style.display="inline-block",a.innerHTML=s,e.innerHTML="",e.appendChild(a)):zY(a=e.querySelector("span.textFitted"),"textFitAlignVert")&&(a.className=a.className.replace("textFitAlignVert",""),a.style.height="",e.className.replace("textFitAlignVertFlex","")),t.alignHoriz&&(e.style["text-align"]="center",a.style["text-align"]="center");var c=t.multiLine;t.detectMultiLine&&!c&&a.scrollHeight>=2*parseInt(window.getComputedStyle(a)["font-size"],10)&&(c=!0),c||(e.style["white-space"]="nowrap"),r=t.minFontSize,d=t.maxFontSize;for(var u=r;r<=d;)l=d+r>>1,a.style.fontSize=l+"px",a.getBoundingClientRect().width<=n&&(t.widthOnly||a.getBoundingClientRect().height<=i)?(u=l,r=l+1):d=l-1;if(a.style.fontSize!=u+"px"&&(a.style.fontSize=u+"px"),t.alignVert){!function(){if(document.getElementById("textFitStyleSheet"))return;var e=[".textFitAlignVert{","position: absolute;","top: 0; right: 0; bottom: 0; left: 0;","margin: auto;","display: flex;","justify-content: center;","flex-direction: column;","}",".textFitAlignVertFlex{","display: flex;","}",".textFitAlignVertFlex .textFitAlignVert{","position: static;","}"].join(""),t=document.createElement("style");t.type="text/css",t.id="textFitStyleSheet",t.innerHTML=e,document.body.appendChild(t)}();var m=a.scrollHeight;"static"===window.getComputedStyle(e).position&&(e.style.position="relative"),zY(a,"textFitAlignVert")||(a.className=a.className+" textFitAlignVert"),a.style.height=m+"px",t.alignVertWithFlexbox&&!zY(e,"textFitAlignVertFlex")&&(e.className=e.className+" textFitAlignVertFlex")}}function zY(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}const YY=(e,t,o,a)=>{const i=document.createElement("div");return i.style.overflow="hidden",i.style.position="relative",i.style.width="0px",i.style.height="0px",e&&(i.style.position="fixed",i.style.bottom="0",i.style.right="0",i.style.width=t,i.style.height=o,i.style.zIndex="100",i.style.background=a),document.body.appendChild(i),i},JY=e=>{const{div:t,layer:o}=e;t.style.display="inline-block",t.style.verticalAlign="middle",t.style.outline="none";const{fontWeight:a,italic:i,fontFamily:s,text:n,textShadow:r,textAlign:l,textTransform:d,lineHeight:c}=o;let u="normal";a&&a.includes("bold")&&(u="bold"),t.style.fontWeight=u,t.style.fontStyle=i?"italic":"",t.style.fontFamily=s,t.style.textAlign=l||"left",t.style.textTransform=d||"none",t.style.whiteSpace="pre-line",t.style.lineHeight=String(c),t.textContent=n,t.style.textShadow=`-1px -1px 0 ${r}, 1px -1px 0 ${r}, -1px 1px 0 ${r}, 1px 1px 0 ${r}`};function qY(e,t,o,a=!1){var i,s,n;if(""===e.text.trim())return e.fontSize??16;if(t<=0||o<=0)return null;const r=document.createElement("div"),l=Math.abs(t),d=Math.abs(o),c={div:r,layer:e},u=YY(a,`${l}px`,`${d}px`,"white");if(l&&d&&l>0&&d>0){r.style.width=`${l<1?1:l}px`,r.style.height=`${d<1?1:d}px`,JY(c),u.appendChild(r),function(e,t){t||(t={});var o={};for(var a in $Y)t.hasOwnProperty(a)?o[a]=t[a]:o[a]=$Y[a];"function"==typeof e.toArray&&(e=e.toArray());var i=Object.prototype.toString.call(e);"[object Array]"!==i&&"[object NodeList]"!==i&&"[object HTMLCollection]"!==i&&(e=[e]);for(var s=0;s<e.length;s++)KY(e[s],o)}(r,{multiLine:!0,minFontSize:1,maxFontSize:500});const e=parseInt((null==(n=null==(s=null==(i=r.getElementsByTagName("span"))?void 0:i[0])?void 0:s.style)?void 0:n.fontSize)??"",10);return a||u.remove(),Math.max(e,1)}return 16}function XY(e){const t=e.position?e.position.width:"0",o=e.position?e.position.height:"0",{width:a,height:i}=function(e,t){const{state:o}=sr(),a=o.studio.width||0,i=o.studio.height||0;return{width:parseFloat(e)/100*a,height:parseFloat(t)/100*i}}(t,o);return qY(e,a,i)}const QY=(e,t,o)=>t<o?{height:e,width:o/t*e}:{height:t/o*e,width:e},ZY=["8","9","10","11","12","14","18","24","30","36","48","64","72","96","100","125","150"],eJ=()=>{const e=[];return ZY.forEach((t=>{e.push({iconUrl:"",value:t,label:`${t}`})})),e},tJ=()=>{const e=[];return Eh.forEach((t=>{e.push(t)})),e},oJ=()=>{const{state:e}=sr(),{teams:{activeBrandkit:t}}=e,o=null==t?void 0:t.fonts;null==o||o.forEach((e=>{if("custom"===e.type){const{fontFamily:t,url:o,asset_id:a}=e;MY({fontToLoad:{type:"custom",fontFamily:t,url:o,asset_id:a}})}}))},aJ=({nameType:e,name:t},o,a,i)=>{let s="";if("blob"===e){const e=t.split("-");if(e.length>=2){const[t]=e;t&&(s=t)}else e.pop(),s=e.join("-")}else{const[e]=t.split(".");e&&(s=e)}return{fontFamily:s,url:o,fontType:a.includes("ttf")?"truetype":"opentype",asset_id:i}};function iJ(e,t){const o=e/t;return!o||Number.isNaN(o)?1:o}function sJ(e,t){return t?Math.round(e/t*700):e}function nJ(e,t){return t?e/700*t:e}function rJ(e,t,o,a){const i=[];let s=0;const n=document.createElement("canvas").getContext("2d");if(n&&e&&t){const r=GC(e),l=e.italic?"italic":"normal",d="bold";n.font=`${l} normal ${d} ${a}px ${r}`,s=n.measureText("W").width;o.replaceAll("\r\n","").split("\n").forEach((o=>{const a=function(e,t,o,a){const i=[];if(t.length<1)return i;let s="";const n=[" ","-"];let r=-1;for(let d=0;d<t.length;d+=1){const c=t.charAt(d);let u=s+c;"uppercase"===a.textTransform?u=u.toLocaleUpperCase():"lowercase"===a.textTransform&&(u=u.toLocaleLowerCase()),e.measureText(u).width>=o&&(-1!==r?(i.push(s.substring(0,r+1)),s=s.substring(r+1)):(i.push(s),s=""),r=-1),l=c,n.includes(l)&&(r=s.length),s+=c}var l;return s.length>0&&i.push(s),i}(n,o,t,e),s=a.join("\r\n");i.push(s)}))}return{textWithLineBreaks:i.join("\n"),minWidth:s}}const lJ=async e=>{var t;const{dispatch:o,state:a}=sr(),i=a.studio.scenes[0];if(!i)throw Error("No scene found");o({type:"SHOW_STUDIO_CANVAS"});const s=function(e="30%",t="30%"){let o=100-parseInt(e,10)-20;o<5&&(o=5);const a=Math.random()*(o-3)+3,i=15*Math.random()+5;return{x:WI(a),y:WI(i),width:e,height:t,rotation:0}}((null==e?void 0:e.width)||"45%",(null==e?void 0:e.height)||"8%"),n={id:P(),type:zl.Text,backgroundColor:(null==e?void 0:e.backgroundColor)||ey,borderRadius:(null==e?void 0:e.borderRadius)||{relative:"25%"},color:(null==e?void 0:e.color)||"#000000",fontFamily:(null==e?void 0:e.fontFamily)||"Arial",fontSize:null==e?void 0:e.fontSize,baseWidth:null==e?void 0:e.baseWidth,baseHeight:null==e?void 0:e.baseHeight,italic:null==e?void 0:e.italic,fontWeight:(null==e?void 0:e.fontWeight)||"normal",globalAlpha:(null==e?void 0:e.globalAlpha)||1,lineHeight:(null==e?void 0:e.lineHeight)||1,lockAspectRatio:!0,position:s,text:(null==e?void 0:e.text)||"Sample text",textAlign:(null==e?void 0:e.textAlign)||"center",textTransform:(null==e?void 0:e.textTransform)||"none",textShadow:(null==e?void 0:e.textShadow)||"transparent",underline:null==e?void 0:e.underline,wrapOrFill:(null==e?void 0:e.wrapOrFill)||"wrap",textPadding:(null==e?void 0:e.textPadding)||12.5};if("custom"===(null==(t=null==e?void 0:e.font)?void 0:t.type)){const{fontType:t,fontFamily:o,url:a,asset_id:i}=e.font,s=await cU([i]);n.hasCustomFont=!0,n.asset_id=i,n.fontType=t,n.url=s[i]||a,n.fontFamily=o}const r=QE(n);if(r){const{width:t,height:o}=r,a=qY(n,t,o);a&&!n.fontSize&&(n.baseWidth=t,n.baseHeight=o,n.fontSize=a);const i=iJ(t,n.baseWidth),s=(n.fontSize||0)*i,l=(n.lineHeight||1)*s,{textWithLineBreaks:d}=rJ(n,t,n.text,n.fontSize||0);n.text=(null==e?void 0:e.text)||"Sample text",n.textWithLineBreaks=(null==e?void 0:e.text)||"",setTimeout((()=>{LE(n.id,{textTemp:d})}),0);const c=zE(t,d.split("\n").length*l);n.position&&(n.position.height=c.heightPercent)}if(!n.fontSize){const e=XY(n);n.fontSize=e||void 0}return gz(n,{sceneId:i.id,undoable:!0}),o({type:"ADD_TEXT_LAYER_ID_ADDED_IN_SESSION",id:n.id}),n},dJ=(e,t,o,a=!1,i=!1)=>{const{state:s}=sr(),n=Lg(s,e.id).fontSizingTemp,r=i?n??e:e;if(r&&(r.baseWidth!==t||r.baseHeight!==o)){if(i)return void LE(e.id,{fontSizingTemp:{fontSize:r.fontSize,baseWidth:t,baseHeight:o}});OI({[e.id]:{baseWidth:t,baseHeight:o}},"text.ts",a)}},cJ=(e,t="")=>{const{state:o}=sr();if(!Fg(o,e.id)||"text"!==e.type)return;const{textTemp:a=""}=Lg(o,e.id);""!==a||""!==t?LE(e.id,{isEditing:!1}):Az({layerIds:[e.id],undoable:!0})},uJ=e=>{const{dispatch:t}=sr();t(j_(e))},mJ=(e,t,o=!1)=>{var a;const{width:i,x:s,y:n}=t||QE(e),{containerWidth:r,containerHeight:l}=((e,t,o=!1)=>{const{fontSize:a,lockAspectRatio:i}=e,s=document.createElement("div");if(JY({div:s,layer:e}),s.style.fontSize=`${a}px`,i){const{baseHeight:t=0,baseWidth:o=0}=e;s.style.height="1px",s.style.width="1px",document.body.appendChild(s);const a={containerHeight:0,containerWidth:0};let i=1;const{containerHeight:n,containerWidth:r}=sr().state.studio;for(;s.scrollHeight>s.clientHeight||s.scrollWidth>s.clientWidth;){if(i>n&&i>r)return s.remove(),a;const{height:e,width:l}=QY(i,t,o);a.containerHeight=e,a.containerWidth=l,s.style.height=`${e}px`,s.style.width=`${l}px`,i+=1}return s.remove(),a}const n=YY(o,`${t}px`,"auto","blue");n.style.width=`${t}px`,n.appendChild(s);const{width:r}=s.getBoundingClientRect(),{height:l}=s.getBoundingClientRect();return o||n.remove(),{containerWidth:r,containerHeight:l}})(e,i),d=o?i:r,c=l,u={x:s,y:n,width:d,height:c,rotation:null==(a=e.position)?void 0:a.rotation};Sz(e,u,!0),dJ(e,d,c,!0)};function pJ(e,t,o,a=!0){const i=qY(e,t,o);if(!i)return e.fontSize;const s=iJ(t,e.baseWidth);return i===e.fontSize&&1===s&&null!=e.baseWidth||(a?ff.execInUndoBatch((()=>{OI({[e.id]:{fontSize:i}},"recomputeFontSize",!0),dJ(e,t,o,!0)})):(OI({[e.id]:{fontSize:i}},"recomputeFontSize",!1),dJ(e,t,o,!1))),i}const hJ=(e,t,o,a)=>{const{dispatch:i}=sr();i(Qv(e,t,o,a))},gJ=(e,t,o,a)=>{const{dispatch:i}=sr();i(Zv(e,t,o,a))},fJ=(e,t,o)=>{const{dispatch:a}=sr();a(e_(e,t,o))},yJ=(e,t,o)=>{const{dispatch:a}=sr();a(function(e,t,o){return{type:"ADD_GROUP_TO_GROUP",srcGroupId:e,destGroupId:t,undoable:o}}(e,t,o))},vJ=(e,t,o)=>{const{dispatch:a}=sr();a(function(e,t,o){return{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:e,destGroupId:t,undoable:o}}(e,t,o))},_J=m((e=>{var t;return e.studio.groups[(null==(t=e.studio.selectedItem)?void 0:t.id)??""]}),(e=>e.studio.allLayers.byId),((e,t)=>{if(e)return((e,t)=>{var o;const a=e.layers[0];if(!a)return;const i=null==(o=t[a.id])?void 0:o.type;return!i||e.layers.every((e=>{var o;return(null==(o=t[e.id])?void 0:o.type)===i}))?i:void 0})(e,t)})),wJ=e=>e.some((e=>!("audio"===e.type&&!e.isAudiogram))),bJ=(e,{isUndoable:t,isTimelineGroup:o=!0})=>{const{state:a,dispatch:i}=sr(),{selectedItem:s,groups:n}=a.studio,r=null==s?void 0:s.id,l=r?n[r]:void 0;if(e&&r!==e)if(r&&l){const a=r,i=l.layers.find((t=>t.id===e));i?i.fromMergedGroup?vJ(i.fromMergedGroup,a,t):fJ(e,a,t):hJ(e,a,o,t)}else{const a=P();i(l_({id:a,type:"group"})),r&&n[r]?yJ(r,a,t):r&&hJ(r,a,o,t),hJ(e,a,o,t)}},TJ=(e,t,o,a=!0)=>{const{state:i,dispatch:s}=sr(),{groups:n}=i.studio;if(e===t)return;const r=n[e],l=n[t];if(r){const a=e;r.layers.map((e=>e.id)).some((e=>null==l?void 0:l.layers.map((e=>e.id)).includes(e)))?vJ(t,a,o):yJ(t,a,o)}else{hJ(e,t,a,o),s(l_({id:t,type:"group"}))}},xJ=(e,t=!0)=>{var o;const{dispatch:a,state:i}=sr(),{groups:n}=i.studio,r=null==(o=Object.entries(n).find((([t,o])=>s.isEqual(o.layers.map((e=>e.id)),e))))?void 0:o[0],l=Object.keys(n),d=[],c=[];e.forEach((e=>{l.includes(e)?d.push(e):c.push(e)}));const u=d.shift()||P();if(e.length>0){if(r)return a(l_({id:r,type:"group"})),r;const o=e[0];if(1===e.length&&o){const e=Object.keys(n).find((e=>e===o));return a(l_({id:o,type:e?"group":"layer"})),o}return g.batch((()=>{d.forEach((e=>{yJ(e,u,!1)})),c.length>0&&gJ(c,u,t,!1),a(l_({id:u,type:"group"}))})),u}return a(l_(null)),null},SJ=(e,t)=>{const o=(null==t?void 0:t.state)||sr().state,{groups:a,selectedItem:i}=o.studio;if(!i||"group"!==i.type)return!1;const s=(null==t?void 0:t.currentGroup)||a[i.id];if(!s)return!1;const n=s.layers.find((({id:t})=>e===t));return!!n&&!0!==n.deselected},EJ=(e,t=!0)=>{const{state:o}=sr(),{selectedItem:a}=o.studio;a&&"group"===a.type&&IJ(a.id,e,t)},IJ=ff.withUndoBatch(((e,t,o=!0)=>{const{state:a,dispatch:i}=sr(),{groups:s}=a.studio;i(a_(e,t,o)),g.batch((()=>{if(t){const t=s[e];if(!t)return;t.layers.forEach((t=>{Object.entries(s).filter((([o,i])=>o!==e&&i.saved&&SJ(t.id,{currentGroup:i,state:a}))).map((([e])=>e)).forEach((e=>{i(o_(e,o))}))}))}}))})),CJ=(e=!0)=>{const{state:t}=sr(),{selectedItem:o}=t.studio;o&&"group"===o.type&&AJ(o.id,e)},kJ=()=>{var e;const{state:t}=sr(),{selectedItem:o,groups:a}=t.studio;if(!o||"group"!==o.type)return!1;const i=a[o.id];if(!i)return!1;const s=new Set([zl.Text,zl.Image,zl.Shape]);let n=!1;for(const r of i.layers){let t=null==(e=i.hydratedLayers)?void 0:e.find((({id:e})=>e===r.id));if(t||(t=dz(r.id)??void 0),t&&!s.has(t.type))return!1;t&&t.type===zl.Text&&(n=!0)}return!!n},AJ=(e,t=!0)=>{var o;const{state:a,dispatch:i}=sr(),{groups:s,ratio:n,projectId:r}=a.studio,l=n.split(":").map(Number),d=s[e];if(!d)return;const c=[];for(const p of d.layers){let e=null==(o=d.hydratedLayers)?void 0:o.find((({id:e})=>e===p.id));e||(e=dz(p.id)??void 0),e&&c.push(e)}const u=`template-${P()}`,m={templateId:u,layers:c.map((e=>((e,t)=>{const{state:o}=sr(),{animations:a}=o.studio;let i={animationName:Yl.None,transitionDuration:.5};Object.values(a.byId).forEach((t=>{if(t.isCrossTransition)return;const{animationName:o,transitionDuration:a,layerId:s}=t;s===e.id&&(i={animationName:o,transitionDuration:a||.5})}));const{textBlocks:s,draftJSTextTree:n,local_url:r,uploadConfirmed:l,uploadProgress:d,uploadPending:c,uploadId:u,asset_id:m,animation:p,pastedUrl:h,url:g,position:f,...y}=e;if(!f)throw Error("Missing position");const v={...y,position:f,url:h||g,fromTextDefaults:t};return i.animationName!==Yl.None&&(v.animation=i),v})(e,u))),timestampCreated:Date.now(),ratio:l,projectId:r??void 0};i(av({template:m,undoable:t,index:0})),i(YD({tabContainerId:"media-sidebar",tabId:"Text"}))};function jJ(e,t,o){var a;const{state:i,dispatch:s}=sr(),{scenes:n,projectId:r,width:l=0,height:d=0}=i.studio,c=n[0];if(!c)return;const{layers:u,duration:m}=c,p=[];let h=Number.MAX_SAFE_INTEGER;for(const T of e.layers){let t=null==(a=e.hydratedLayers)?void 0:a.find((({id:e})=>e===T.id));if(t||(t=dz(T.id)??void 0),t){const{start:e}=cm(t,m);if(e<h&&(h=e),o&&o.originalProject&&r!==o.originalProject.id&&qj(t)){const{originalProject:e}=o;t={...t,position:Qj({layer:t,newRatio:{height:d,width:l},prevRatio:{height:e.height,width:e.width},resizeMethod:"fit"})}}p.push(t)}}const g=P(),{minTimelineRow:f}=function(e){let t=-1,o=Number.MAX_SAFE_INTEGER;for(const a of e)null!=a.timelineRow&&(a.timelineRow<o&&(o=a.timelineRow),a.timelineRow>t&&(t=a.timelineRow));return t=Math.max(t,1),o=Math.min(t,o),t+=1,{minTimelineRow:o,maxTimelineRow:t}}(u),y=bE()-h,v={},_=p.map((e=>{const t={timelineRow:0,...e,id:P()};if(om(t)||Zu(t)?t.videoDelay=(t.videoDelay??0)+y:(t.startTime=(t.startTime??0)+y,t.endTime=(t.endTime??0)+y),nm(t)){const o=Lx(e);t.animation={intro:[],constant:[],outro:[]};["intro","constant","outro"].forEach((a=>{var i,n;const r=o[a][0];if(r&&r.id!==Yl.None)if(r.isCrossTransition){const o=r.animationStateMapId,a=r.introLayerId===e.id;v[o]||(v[o]={animationName:r.transitionId,transitionDuration:r.transitionDuration||.5}),v[o][a?"newIntroLayer":"newOutroLayer"]=t}else{const e={id:P(),animationName:r.id,isCrossTransition:!1,layerId:t.id,transitionDuration:r.transitionDuration||.5};null==(n=null==(i=t.animation)?void 0:i[a])||n.push(e.id),s(Pv(e))}}))}return t.timelineRow<f&&(t.timelineRow=f+t.timelineRow),t}));Object.values(v).filter((e=>!!e.newIntroLayer&&!!e.newOutroLayer)).forEach((({newIntroLayer:e,newOutroLayer:t,animationName:o,transitionDuration:a})=>{var i,n,r,l;const d={id:P(),animationName:o,isCrossTransition:!0,introLayerId:e.id,outroLayerId:t.id,transitionDuration:a};null==(n=null==(i=e.animation)?void 0:i.intro)||n.push(d.id),null==(l=null==(r=t.animation)?void 0:r.outro)||l.push(d.id),s(Pv(d))}));const{isTimelineGroup:w=!1}=e;_.forEach((e=>{gz(e,{undoable:t})}));const b=e.saved;_.forEach((e=>{hJ(e.id,g,w,t)})),b&&IJ(g,!0,t),s(l_({id:g,type:"group"}))}const NJ=(e,t=!0,o)=>{try{t&&ff.beginBatch(),jJ(e,t,o)}finally{t&&ff.endBatch()}},RJ=()=>{const e=PJ(!0);e&&NJ(e,!0)},PJ=e=>{const{state:t}=sr(),{selectedItem:o}=t.studio;return o&&"group"===o.type?DJ(o.id,e):null},DJ=(e,t)=>{var o;const{state:a}=sr();let i=null==(o=a.studio.groups)?void 0:o[e];if(i){if(t){const e=[];i.layers.forEach((t=>{const o=dz(t.id);o&&e.push({...o})})),i={...i,hydratedLayers:e}}return i}return null};const OJ=ff.withUndoBatch((e=>{const{dispatch:t}=sr(),o=P();g.batch((()=>{t(function(e=!0){return{type:"REMOVE_ALL_UNSAVED_GROUPS",undoable:e}}()),gJ(e,o,!0,!0),t(l_({id:o,type:"group"}))}))})),LJ=()=>{const{studio:e}=sr().state,{scenes:t,groups:o}=e,a=t[0];if(!a)return;const i=a.layers;let s=i.map((e=>e.id));if(0===s.length){if(!(i.length>0))return;s=i.map((e=>e.id))}xJ(((e,t)=>{var o;const a=new Set,i=[];for(const s of e)if(!a.has(s)){const e=null==(o=Object.entries(t).find((([e,t])=>t.saved&&t.layers.find((e=>e.id===s)))))?void 0:o[0];if(e){i.push(e);const o=t[e];o&&o.layers.forEach((e=>a.add(e.id)))}else i.push(s)}return i})(s,o))},FJ=ff.withUndoBatch(((e,t,o=!0)=>{const{rotation:a,origin:i,xDiff:s,yDiff:n,transformerNode:r}=t;void 0!==a&&((e,t,o)=>{const{dispatch:a,state:{studio:i}}=sr(),s=i.groups[e];if(!s)return;const{rotation:n,currentPosition:r,initialPosition:l}=t;void 0!==n&&r&&l&&g.batch((()=>{UJ(e,{rotation:n},o);for(const{id:e,deselected:t}of s.layers){if(t)continue;const s=fT(e,i);if(!s)continue;const{position:n}=s;let d=QE(s);"shape"===s.type&&"ellipse"===s.shapeType&&(d={...d,x:d.x-d.width/2,y:d.y-d.height/2});const c=EY(d,r,l),{layerRotation:u}=c;let{newX:m,newY:p}=c;"shape"===s.type&&"ellipse"===s.shapeType&&(m+=d.width/2,p+=d.height/2);const{xPercent:h,yPercent:g}=qE(m,p);a(Wv(s,u,o)),LE(s.id,{positionTemp:null}),a(Uv(s,h,g,n.width,n.height,o))}}))})(e,t,o),(s||n)&&((e,t,o)=>{var a,i;const s=bE(),{xDiff:n,yDiff:r}=t,{dispatch:l,state:{studio:d}}=sr(),{height:c=0,width:u=0,canvasX:m=0,canvasY:p=0}=d,h=d.groups[e];if(!h)return;const g={};for(const{id:f,deselected:y}of h.layers){if(y)continue;const e=fT(f,d);if(!e||!e.position)continue;const t=CI(e,null==(a=d.keyframing)?void 0:a[e.id],s,d.width||0,d.height||0),{x:h,y:v}=WE(t.x,t.y),{xPercent:_,yPercent:w}=qE(h+n,v+r);if(yI(e.id,vd.POSITION)){let t=_,o=w;if(yI(e.id,vd.ZOOM)){const a=QE(e),l=QE({...e,position:CI(e,null==(i=d.keyframing)?void 0:i[e.id],s,d.width||0,d.height||0)});if(l&&a){const e=l.x+n+l.width/2-m,i=l.y+r+l.height/2-p,s=e-a.width/2,d=i-a.height/2;t=s/u*100+"%",o=d/c*100+"%"}}_I({...e,position:{...e.position,x:t,y:o}})}if(LE(e.id,{positionTemp:null}),yI(e.id,vd.ZOOM)){const o=QE(e),a=QE({...e,position:t});if(!o||!a)continue;const i=a.x+n+a.width/2-m,s=a.y+r+a.height/2-p,l=i-o.width/2,d=s-o.height/2,h={...e.position,x:l/u*100+"%",y:d/c*100+"%"};g[e.id]={position:h}}else l(Uv(e,_,w,t.width,t.height,o))}OI(g,"groups.ts")})(e,t,o),r&&((e,t,o)=>{var a;const{currentPosition:i,initialPosition:s,transformerNode:n}=t;if(!n||!i||!s)return;const r=bE(),{dispatch:l,state:{studio:d}}=sr(),c=d.groups[e];if(!c)return;const{width:u=0,height:m=0,canvasX:p=0,canvasY:h=0}=d,g={};for(const{id:f,deselected:y}of c.layers){if(y)continue;const e=fT(f,d);if(!e)continue;const t=SY(QE(e),i,s,n),{xPercent:c,yPercent:v}=qE(t.x,t.y),{widthPercent:_,heightPercent:w}=zE(t.width,t.height);LE(e.id,{positionTemp:null});let b=null;if(vI(e.id)&&e.position){const t=CI(e,null==(a=d.keyframing)?void 0:a[e.id],r,d.width||0,d.height||0);if(b=QE({...e,position:t}),b){const e=i.width/s.width,t=b.x-s.x,o=b.y-s.y;b.x=i.x+t*e,b.y=i.y+o*e,b.width*=e,b.height*=e}}if(yI(e.id,vd.POSITION)&&e.position&&b){const t=(b.x-p)/u*100+"%",o=(b.y-h)/m*100+"%";_I({...e,position:{...e.position,x:t,y:o,width:_,height:w}})}if(yI(e.id,vd.ZOOM)&&e.position&&b){const t=e.zoom||100,{width:o,height:a}=HE(e.position.width,e.position.height),i=b.width*t/o;wI({...e,zoom:i});const s=b.x-p+b.width/2-o/2,n=b.y-h+b.height/2-a/2,r={...e.position,x:s/u*100+"%",y:n/m*100+"%"};g[e.id]={position:r}}else l(Uv(e,c,v,_,w,o));OI(g,"groups.ts"),am(e)&&pJ(e,t.width,t.height,o)}})(e,t,o),i&&UJ(e,{origin:i},o)})),MJ=ff.withUndoBatch(((e,t=!0)=>{const{state:o}=sr(),{groups:a,scenes:i}=o.studio,s=i[0],n=a[e];if(!s||!n)return;const r=n.layers.map((e=>e.id));Az({layerIds:r,groupId:e,undoable:t,logEvent:!0})})),UJ=(e,t,o=!0)=>{const{dispatch:a}=sr();a(function(e,t,o){return{type:"UPDATE_GROUP",groupId:e,updates:t,undoable:o}}(e,t,o))},BJ=(e,t=!0)=>{const{dispatch:o,state:a}=sr(),i=a.studio.scenes[0];if(!i)return;const s=a.studio.groups[e];if(!s)return;const{layers:n}=s,r=i.layers.filter((e=>n.map((e=>e.id)).includes(e.id))),l=r.every((e=>e.locked)),d={};for(const c of r)d[c.id]={locked:!l};OI(d,"groups.ts",!1),o(l_(null)),t&&ff.add({undo:{func(){const e={};for(const t of r)e[t.id]={locked:t.locked};OI(e,"groups.ts",!1)}},redo:{func(){BJ(e,!1)}}})},VJ=e=>{var t;const{layerId:o,groupId:a,deselected:i,undoable:s}=e,{state:n,dispatch:r}=sr(),l=n.studio.groups[a];if(!l)return;const d=l.layers.filter((e=>!e.deselected));1===d.length&&(null==(t=d[0])?void 0:t.id)===o&&i?ff.execInUndoBatch((()=>{l.layers.forEach((e=>{e.id!==o&&r(t_(e.id,a,!i,s))})),r(l_(null,s))})):r(t_(o,a,i,s))},WJ=()=>performance.now()/1e3;let GJ=null;const HJ=e=>e.type===zl.Audio||e.type===zl.Video&&!1!==e.hasAudio,$J=e=>{if(!GJ)return;const t=WJ(),{assetIdToMediaCacheId:o}=sr().state.mediaCache;Object.entries(e).forEach((([e,a])=>{if(!e.startsWith("layer_"))return;const i=a;if(!i.asset_id||!HJ(i))return;const s=o[i.asset_id];s&&(GJ.assetsInProject[s]={source:"remote re-edit",assetId:i.asset_id,timeAdded:t,assetLoadInfo:{}})}))},KJ=(e,t)=>{if(!GJ)return;let o=GJ.assetsInProject[e];if(!o){const t=sr().state.mediaCache.mediaCacheIdToAssetId[e];if(!t)return;o={assetId:t,source:"unknown",timeAdded:"unknown",assetLoadInfo:{}},GJ.assetsInProject[e]=o}o.assetLoadInfo[t]={fetchStartTime:WJ()}},zJ=(e,t)=>{if(!GJ)return;const o=GJ.assetsInProject[e];(null==o?void 0:o.assetLoadInfo[t])&&(o.assetLoadInfo[t].fetchCompleteTime=WJ())},YJ=(e,t)=>{if(!GJ)return;const o=GJ.assetsInProject[e];(null==o?void 0:o.assetLoadInfo[t])&&(o.assetLoadInfo[t].downloadIntoIDBTime=WJ())},JJ=({mediaCacheId:e,assetId:t,uploadId:o,source:a})=>{if(!GJ)return;const{mediaCache:i}=sr().state;let s;if(e?s=e:t?s=i.assetIdToMediaCacheId[t]:o&&(s=i.uploadIdToMediaCacheId[o]),!s)return void console.error("Asset mediaCacheId could not not found for asset with",o?`uploadId: ${o}`:`assetId: ${t}`);if(GJ.assetsInProject[s])return;const n=t||i.mediaCacheIdToAssetId[s];n||o?GJ.assetsInProject[s]={assetId:n,source:a,timeAdded:WJ(),assetLoadInfo:{}}:console.error("Asset id could not be found for mediaCacheId",s)},qJ=({mediaCacheId:e,assetQuality:t,method:o,fileMetadata:a})=>{var i;if(!GJ)return;let s=null==(i=null==GJ?void 0:GJ.assetsInProject)?void 0:i[e];const n=(null==s?void 0:s.assetId)||sr().state.mediaCache.mediaCacheIdToAssetId[e];s||(s={assetId:n,timeAdded:"unknown",source:"unknown",assetLoadInfo:{}},GJ.assetsInProject[e]=s),s.assetLoadInfo[t]||(s.assetLoadInfo[t]={assetMetadata:a}),s.assetLoadInfo[t].assetMetadata||(s.assetLoadInfo[t].assetMetadata=a),s.assetLoadInfo[t].currentWaveformGenerationAttempt={method:o,timeStarted:WJ()}},XJ=(e,t)=>{var o;if(!GJ)return;const a=null==(o=GJ.assetsInProject[e])?void 0:o.assetLoadInfo[t];if(!a)return void console.error(`Asset of quality ${t} not found for mediaCacheId ${e}`);const{currentWaveformGenerationAttempt:i,waveformGenerationLogs:s}=a;if(!i)return void console.error(`Ongoing waveform generation attempt not initialized for ${t} asset of mediaCacheId ${e}`);const n=WJ();a.waveformGenerationLogs={...s||{},SUCCESS:{success:!0,time:n-i.timeStarted,method:i.method,timeAtCompletion:n}},a.currentWaveformGenerationAttempt=void 0},QJ=e=>{if(!GJ)return;const t=GJ.assetsInProject[e];t?t.firstWaveformDrawnTime||(t.firstWaveformDrawnTime=WJ()):console.error("Asset not found for mediaCacheId",e)},ZJ=_.memo((()=>(h.useEffect((()=>(GJ={assetsInProject:{}},function(){if(!GJ)return;const{assetsInProject:e}=GJ;Object.values(e).forEach((e=>{const{assetId:t,assetLoadInfo:o,firstWaveformDrawnTime:a,timeAdded:i,source:s}=e,n={assetSource:s};if(a&&"number"==typeof i&&(n.timeToFirstWaveformDraw=a-i),t&&(n.assetId=t),!o)return;const r=Object.entries(o);let l=r.find((([e,t])=>!!t.currentWaveformGenerationAttempt||!!t.waveformGenerationLogs));if(!l&&r.length&&(l=r[0]),!l)return;const[d,c]=l;n.loggedAssetQuality=d;const{waveformGenerationLogs:u,currentWaveformGenerationAttempt:m,assetMetadata:p,fetchStartTime:h,fetchCompleteTime:g,downloadIntoIDBTime:f}=c;p&&(n.fileType=p.type,n.fileSize=p.size,n.duration=p.duration),"number"==typeof i&&h&&(n.timeToFetchStart=h-i),h&&g&&(n.timeToFetchComplete=g-h),g&&f&&(n.timeToDownloadIntoIDB=f-g);const y=null==u?void 0:u.SUCCESS;y&&y.success&&(n.waveformGenerationSuccess=!0,n.waveformGenerationSuccessMethod=y.method,n.waveformGenerationTime=y.time,"number"==typeof i&&(n.totalTimeToWaveformGeneration=y.timeAtCompletion-i));const v=Object.entries(u||{}).filter((([e,t])=>!t.success)).sort((([e],[t])=>e.localeCompare(t)));if(1===v.length){n.waveformGenerationError=!0;const[e,t]=v[0];n.waveformGenerationErrorMsgs=e,!1===t.success&&(n.waveformGenerationErrorMethods=t.method,n.waveformGenerationErrorAvgTimes=t.avgTime)}else v.length>1&&(n.waveformGenerationError=!0,n.waveformGenerationErrorMsgs=v.map((([e])=>e)).join(", "),n.waveformGenerationErrorMethods=v.map((([e,t])=>t.method)).join(", "),n.waveformGenerationErrorAvgTimes=v.map((([e,t])=>String(t.avgTime))).join(", "));m&&!u?(n.waveformGenerationPending=!0,n.waveformGenerationPendingMethod=m.method,n.waveformGenerationPendingRunTime=WJ()-m.timeStarted):m||u||(n.waveformGenerationNotAttempted=!0),Fm(ym.ASSET_WAVEFORM_GENERATION,n)}))})),[]),null)));async function eq(e,t){if(!e.length)return[];const{dispatch:o}=sr(),{uploadOptions:{multiRowUploadForRecording:a}}=t;let i=Array.from(e).sort(((e,t)=>e.lastModified-t.lastModified));a&&(i=i.sort(((e,t)=>"screen"===e.recordType?-1:1)));const s=new dt(8);i.length>1&&Fm(ym.MULTI_UPLOAD,{"Number of files":i.length,"Total file size (MB)":i.reduce(((e,t)=>e+t.size/1e6),0)});const n=(await Promise.all(i.map(((e,o)=>s.runExclusive((()=>async function(e,t,o){var a,i;const{dispatch:s,state:n}=sr();let r,l,d,c=e;const u=tq(t,o),{uploadOptions:{dragUpload:m,isMediaLibraryUpload:p,uploadLocation:h,doDuplicateHandling:g,convertToAudio:f,isThumbnail:y,analyticsUploadSource:v,usedProFeatures:_},validationOptions:w,uploadId:b}=u;y||(Fm(ym.UPLOAD_STARTED,{"File Type":e.type,"Size (MB)":e.size/1e6,"Upload Location":v}),p||u.uploadOptions.skipAddTimelineLayer||Um((null==(i=null==(a=e.type)?void 0:a.split("/"))?void 0:i[0])??"unknown",v));const T=((e,t)=>{const{audiogramUpload:o=!1,audioUpload:a=!1,disallowImages:i=!1,disallowGif:s=!1,disallowVideo:n=!1,fontUpload:r=!1}=t,l=vB(e);return l?(e.size??0)>6442450944?"You file is over 6GB and cannot be uploaded.":0===e.size?`Your upload has an invalid size of ${e.size} bytes. Please choose a valid file to upload.`:s&&"image/gif"===l?"Removing background from gifs is currently not supported. We support .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, and .mpeg formats for this feature.":!n||o||wB(l)?bB(l)||MB(l)||!a?bB(l)||MB(l)||!i?wB(l)||bB(l)||MB(l)||r?!r||l.endsWith("ttf")||l.endsWith("otf")?null:"Upload failed. Please upload a font with valid file types.":"Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, .mpeg formats.":"You must choose video/audio to use this feature. Currently we support .mp3, wav, .mp4, .mov, avi, flv, wmv, mkv, .webm, .ogg, .mpeg formats.":"Your file format is not currently supported. Currently we only support .mp3, wav, .mp4, .mov, avi, flv, wmv, mkv, .webm, .ogg, .mpeg formats.":"You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats.":"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension."})(e,w);if(T)return s(wl({description:T,type:"error"})),uq(u),{};if(w.fontUpload){const t={...Qz(),uploadId:b,type:zl.Image,source:"upload",name:e.name};nq(u,e,t)}else try{if(r=await Zz(e,{uploadId:b,uploadLocation:m?"dragUpload":h,isMediaLibraryUpload:p,usedProFeatures:_},{addAtSeeker:t.uploadOptions.addAtSeeker}),f&&r.type!==zl.Image&&!r.hasAudio)throw r=void 0,new Error("Please upload a file with Audio");c=await pq(u,e,r);const o=e.size<2*_n;if(g&&o){const t=bq(e),o=await t.arrayBuffer(),a=await crypto.subtle.digest("SHA-256",o);if(l=Tq(a),l){const e=n.CMLFiles.byId;for(const t of n.CMLFiles.myMediaIds){const o=e[t];(null==o?void 0:o.hash)&&0===Buffer.compare(l,new Uint8Array(o.hash.data))&&(d=o)}}}await LB(c,r)&&(r.requireConversion=!0,delete r.local_url)}catch(x){const{message:t}=ph(x);mh({description:"Upload Failed",error:x}),Fm(ym.UPLOAD_FAILS,{FailStage:"Process File and Create Layer",Origin:h,Message:t,FileType:e.type,"File Size (MB)":e.size/1e6}),uq(u)}return{file:c,layer:r,bundle:u,hash:l,cmlDuplicate:d}}(e,t,o))))))).filter((({layer:e})=>e));return n.length?(t.uploadOptions.skipAddTimelineLayer||o(V_(!0)),a||t.uploadOptions.skipAddTimelineLayer||_q(n),async function(e){const{dispatch:t,state:{assets:{byId:o},editorPath:a,mediaCache:{assetIdToMediaCacheId:i},studio:{_id:s,selectedItem:n,allLayers:{byId:r}},studioLocal:{localProjectId:l},uploadStatuses:d}}=sr();let c=!1;await Promise.all(e.map((async({file:e,layer:a,bundle:u,hash:m,cmlDuplicate:p})=>{if(!a)return;const{omitFromIDB:h,fontUpload:g,isMediaLibraryUpload:f,replace:y,convertToAudio:v,originalAssetId:_}=u.uploadOptions;let w;if(h||!a.uploadId||g||(w=P(),t(_u({mediaCacheId:w,uploadId:a.uploadId}))),p&&!Zr.forceNewAssets){!async function(e){const{dispatch:t}=sr();t(Fb({id:e.id,modified:new Date})),await qr("/api/v1/cloudMediaLibrary/myMedia/updateFileModifiedDate",{body:{cmlFileID:e.id}})}(p),t(mD(p,s));const m=p.asset_id,h=o[m],g=i[m];if((!g||!(await d$(g)))&&w)try{n$({mediaCacheId:w,type:a.type,file:e}),t(yu({mediaCacheId:w,assetId:m}))}catch(b){console.error(b)}let _={};if(v&&(_={type:zl.Audio,convert_type:"audio"}),y&&n&&"layer"===n.type&&h){r[n.id]&&Sq(p,h,_)}else!f&&h&&(xq(p,h,_),t(q_(m)));t(N$(u.uploadId,{stage:Sv.done})),c=!0;const T=l!==u.initialLocalProjectId;vq(a,d,u,{retries:0},{projectIdChanged:T,isDuplicateUpload:!0})}else{u.hash=m;try{if(a.requireConversion)a.conversion_type=yB(a.url,e.type),yq(u,e,a);else{if(w&&!_)try{const o=await n$({mediaCacheId:w,type:a.type,file:e});a.isMediaLibraryUpload&&t(qd(w)),o||Fm(ym.UPLOAD_FAILED_IDB_ADD,{fileType:e.type,fileSize:e.size}),a.isMediaLibraryUpload||JJ({mediaCacheId:w,source:u.uploadOptions.analyticsUploadSource,uploadId:a.uploadId??void 0})}catch(T){console.error(T)}hq(u,e,a)}}catch(T){mh({description:"Upload failed",error:T}),uq(u)}}})));const u=e[0];u&&e.length>1&&u.bundle.uploadOptions.multiRowUploadForRecording&&ff.execInUndoBatch((()=>{const t=P();gJ(e.filter((e=>e.layer)).map((e=>{var t;return(null==(t=e.layer)?void 0:t.id)||""})),t,!0,!0),IJ(t,!0,!0)}));t(V_(!1)),c&&eE(a)}(n),n.filter((({layer:e})=>e)).map((e=>e.bundle.uploadId))):[]}function tq(e,t){var o;const a=P();let{analyticsUploadSource:i}=e.uploadOptions;const s=void 0!==t?null==(o=e.uploadOptions.analyticsUploadSources)?void 0:o[t]:null;return s&&(i=s),{eventHandlers:{...e.eventHandlers},initialLocalProjectId:sr().state.studioLocal.localProjectId,uploadOptions:{...e.uploadOptions,analyticsUploadSource:i},validationOptions:{...e.validationOptions},uploadId:a}}function oq(e,t){if(e.uploadOptions.skipUploadStatusUpdates)return;const{dispatch:o}=sr();o(N$(e.uploadId,t))}async function aq(e,t){const{dispatch:o,state:a}=sr(),i=P(),{mediaLibraryID:s}=e;if("video"===e.type&&!e.file_v2)throw Error("Do not have the original file. Cannot reupload.");const n="audio"===e.type?e.file:e.file_v2.file,r={eventHandlers:{...t.eventHandlers},initialLocalProjectId:a.studioLocal.localProjectId,uploadOptions:{...t.uploadOptions},validationOptions:{...t.validationOptions},uploadId:i};r.uploadOptions.isThumbnail||Fm(ym.UPLOAD_STARTED,{"File Type":n.type,"Size (MB)":n.size/1e6,"Upload Location":t.uploadOptions.analyticsUploadSource,"Is Reupload":!0}),o(_u({mediaCacheId:s,uploadId:i}));try{const e=await Zz(n,{uploadId:i}),t=await pq(r,n,e);hq(r,t,e)}catch(l){mh({description:"Upload failed",error:l}),uq(r)}}async function iq(e,t,o){let a=t;const i={};t.uploadId||(i.uploadId=P()),t.local_url||(i.local_url=URL.createObjectURL(e)),s.isEmpty(i)||(OI({[t.id]:i},"studioReuploadLayer"),a={...t,...i});const n={...tq(o),uploadId:a.uploadId};n.uploadOptions.isThumbnail||Fm(ym.UPLOAD_STARTED,{"File Type":e.type,"Size (MB)":e.size/1e6,"Upload Location":o.uploadOptions.analyticsUploadSource,"Is Reupload":!0});const r=await pq(n,e,t);hq(n,r,a)}function sq(e){const{state:{uploadStatuses:t={}},dispatch:o}=sr(),a=t[e];if(!a)return;const{uploadManager:i}=a;null==i||i.cancel(),o({type:"DELETE_UPLOAD_STATUS",id:e})}const nq=(e,t,o)=>{var a;const{dispatch:i,state:s}=sr(),{teams:{selectedTeamId:n}}=s,{uploadId:r,uploadOptions:{isThumbnail:l,fontUpload:d,uploadSourceComponent:c,createTeamAsset:u}}=e,m=RU(Bl.UNLIMITED_EXPORT_DURATION_LIMIT),p=Hu(s),h=(null==(a=null==p?void 0:p.settings)?void 0:a.defaultPrivacy)||Ln.unlisted;m&&"duration"in o&&o.duration&&o.duration>7200&&i(wl({description:"Your file is longer than 2 hour. You must trim your video to publish.",type:"warning"})),!m&&"duration"in o&&o.duration!==1/0&&o.duration&&o.duration>240&&wl({description:"Your file is longer than 4 minutes. Trim or upgrade to export videos longer than 4 minutes.",type:"warning"});const g=h===Ln.private||!l,f={},y=new wP({analyticsUploadSource:e.uploadOptions.analyticsUploadSource,file:t,layer:o,isPrivate:g,onError:mq(e),onProgress:rq(e),onFinish:[dq(e,f),cq(e,f)],onCancel:()=>uq(e),onRetry:lq(e),origin:o.uploadLocation,uploadSourceComponent:c});y.upload(),e.uploadOptions.skipUploadStatusUpdates||i(j$({id:r,fileName:t.name})),oq(e,{fontUpload:d,uploadManager:y,omitFromIDB:e.uploadOptions.omitFromIDB,teamId:u?n:void 0})},rq=e=>(t,o,a)=>{if(!a.uploadId)return;const i=Math.round(100*t);let s=`Uploading ... ${i.toString()}%`;100===i&&"image/gif"===o.type?s="Processing your GIF ...":100===i&&"video/3gpp"===o.type&&(s="Converting file to mp4 ..."),oq(e,{progressText:s,progress:i,stage:Sv.inProgress})},lq=e=>(t,o)=>{t.uploadId&&oq(e,{retryInfo:o})},dq=(e,t)=>async(o,a,i,s)=>{var n,r;const{uploadId:l,uploadOptions:{fontUpload:d,isThumbnail:c,createTeamAsset:u,createWorkspaceAsset:m,usedProFeatures:p,originalAssetId:h,dimensions:g},hash:f}=e,{state:y}=sr(),{studio:{_id:v},workspaces:{selectedWorkspace:_},teams:{selectedTeamId:w}}=y,b=Hu(y),T=(null==(n=null==b?void 0:b.settings)?void 0:n.defaultPrivacy)===Ln.private,x=t=>{oq(e,{stage:t})};if(200!==o.status)return void mq(e)(o.statusText||"An error occurred during upload. Please try again.",i,s,"onGCSUploadFinish");x(Sv.onGCSUploadFinish);const[S,E]=O$(a),I={bucket:S||hn,size:i.size,mime:i.type,name:i.name,hash:f,usedProFeature:null==p?void 0:p[0]};if(E&&(I.blob_name=E),d){const e=(null==(r=I.name)?void 0:r.split(".").pop())??"";s.mime=`font/${e}`}const C={fontUpload:d,skipSigning:!T&&c,skipCML:c||d||e.uploadOptions.skipCMLCreation||h};v&&(C.video_id=v),m&&(C.workspaceId=_),u&&(C.teamId=w),h&&(C.originalAssetId=h),g&&(I.dimensions=g),x(Sv.createAsset);const{asset:k,cmlFile:A}=await F$(I,C);oq(e,{assetId:k._id});const j={...k};s.conversion_type&&(j.conversion_type=s.conversion_type),d||Mz(j,A,l),t.asset=k,A&&(t.cmlFile=A)},cq=(e,t)=>async(o,a,i,s,n)=>{const{uploadId:r,uploadOptions:{isThumbnail:l,fontUpload:d,originalAssetId:c}}=e,{asset:u,cmlFile:m}=t;if(!u)return;const{dispatch:p}=sr(),h=t=>{oq(e,{stage:t})},g={...s,asset_id:u._id,source:"upload",url:a,uploadConfirmed:Date.now()};if(h(Sv.assetCreated),s.requireConversion){h(Sv.runConversion);const e=await pK({asset_id:u._id,resource:u.blob_name,type:"blob",conversion_type:s.conversion_type,layer:g});g.conversion_id=e,g.videoConvertedState="begun",h(Sv.addPendingConversion),await a$(e,s.id,s.name,r,null==m?void 0:m.id)}if(u.name&&(g.name=u.name),m&&(g.cmlFileId=m.id),u.ffprobeData){g.ffprobeData=u.ffprobeData;const{duration:e}=u.ffprobeData,t=Number(e);"number"!=typeof t||isNaN(t)||(g.duration=t)}const f=Tu(s);if(f&&p(tc(f)),!d&&!l&&(h(Sv.updateCompletedUploadInIDB),f&&g.asset_id&&(({mediaCacheId:e,assetId:t})=>{(null==GJ?void 0:GJ.assetsInProject[e])&&(GJ.assetsInProject[e].assetId=t)})({mediaCacheId:f,assetId:g.asset_id}),!s.requireConversion&&f&&await s$(f,{url:g.url,asset_id:g.asset_id}),f&&HJ(s))){const e=await d$(f);if(e&&"waveformData_v5"in e&&e.waveformData_v5){const{waveformData_v5:t}=e;X$(u._id,t)}}c&&h(Sv.updateCompletedUploadInIDB),h(Sv.handleFinish),gq(e,g,n),h(Sv.done)},uq=e=>{const{uploadId:t,eventHandlers:{handleCancel:o},uploadOptions:{dragUpload:a}}=e,{dispatch:i,state:s}=sr(),n=s.mediaCache.uploadIdToMediaCacheId[t];n&&i(tc(n)),a&&"Scenes"!==Ij()&&rE(),o&&o(t)},mq=e=>(t,o,a,i,s)=>{u({category:"Upload Flow Error",message:`ErrorType: ${i} layer: ${JSON.stringify(a)} file: ${JSON.stringify(o)}`}),s&&R(new Error(t));const{eventHandlers:{handleError:n},initialLocalProjectId:r}=e,{dispatch:l}=sr();if(sr().state.studioLocal.localProjectId!==r)return;oq(e,{stage:Sv.errored}),null==n||n();let d=t;t||(d="An error occurred while uploading. Please try again later."),l(wl({description:d,type:"error"})),uq(e)},pq=async(e,t,o)=>{const{dispatch:a}=sr();e.uploadOptions.skipUploadStatusUpdates||a(j$({id:e.uploadId,fileName:t.name}));const i=await gB(t,(t=>oq(e,{progressText:t})),mq(e));if(t!==i&&(o.local_url=URL.createObjectURL(i)),i.type.includes("video")||i.type.includes("audio")){const e=await gH(i);o.duration=e}return i},hq=(e,t,o)=>{const{state:{editorPath:a}}=sr();try{al((()=>{fq(e,o,t),nq(e,t,o)}))}catch(IGe){console.error("error during upload ",IGe),mq(e)("An error occurred during upload. Please make sure your media is a compatible format.",t,o,"checkFileAndUpload"),eE(a)}},gq=(e,t,o)=>{const{state:{studioLocal:{localProjectId:a},uploadStatuses:i}}=sr();try{const{eventHandlers:{handleFinish:s},initialLocalProjectId:n}=e,r=a!==n;vq(t,i,e,o,{projectIdChanged:r,isDuplicateUpload:!1}),s&&!r&&s(t)}catch(IGe){console.error("error during upload ",IGe),mq(e)(`An error occurred during upload. ${IGe}`,void 0,t,"handleFinish");const{state:{editorPath:a}}=sr();eE(a)}},fq=(e,t,o)=>{oq(e,{preemptivelyAvailableAt:performance.now()});try{const{eventHandlers:{handlePreemptiveFinish:o},initialLocalProjectId:a,uploadOptions:{multiRowUploadForRecording:i,recordScreenAndCameraUpload:s},selectedGroupId:n}=e,r=sr().state.studioLocal.localProjectId!==a;o&&!r&&o(t,{multiRowUploadForRecording:i,selectLayerInCreator:!0,selectedGroupId:n,recordScreenAndCameraUpload:s})}catch(IGe){console.error("error during upload ",IGe),mq(e)(`An error occurred during upload. ${IGe}`,o,t,"handleFinish");const{state:{editorPath:i}}=sr();eE(i)}},yq=(e,t,o)=>{const{state:{editorPath:a}}=sr();try{al((()=>{fq(e,o,t),nq(e,t,o)}))}catch(IGe){console.error("error during upload ",IGe),mq(e)("An error occurred during upload. Please make sure your media is a compatible format.",t,o,"checkFileAndUpload"),eE(a)}};function vq(e,t,o,a,i){if(!o.uploadOptions.isThumbnail)try{const s=Tu(e),n={"Layer Type":e.type,mime:e.mime,"Size (MB)":(e.size??0)/1e6,"Layer Duration":"duration"in e&&e.duration||0,"Conversion Required":e.requireConversion||!1,"Project ID Changed During Upload":i.projectIdChanged,mediaCacheId:s,"Upload Retries":a.retries,"Upload Location":o.uploadOptions.analyticsUploadSource,"Duplicate Upload":i.isDuplicateUpload,"Asset ID":e.asset_id},r=null==t?void 0:t[o.uploadId];if(r){const e=performance.now();n["Overall Upload Duration"]=(e-r.beganAt)/1e3,r.preemptivelyAvailableAt&&(n["Time to on Canvas"]=(r.preemptivelyAvailableAt-r.beganAt)/1e3,n["Upload Duration after on Canvas"]=(e-r.preemptivelyAvailableAt)/1e3)}"ffprobeData"in e&&e.ffprobeData&&(e.ffprobeData.codec_name&&(n.Codec=e.ffprobeData.codec_name),e.ffprobeData.codec_long_name&&(n["Codec (Long)"]=e.ffprobeData.codec_long_name)),Fm(ym.UPLOAD_FINISHED,n)}catch(IGe){console.error(IGe),R(IGe)}}const _q=e=>{const t=e[0];if(!t)return;const{state:o,dispatch:a}=sr(),i=wq(),s=ef(o);let n=void 0===s?0:bE();const r=e.filter((({layer:e})=>e)).some((({layer:e})=>e.duration)),l=e.every((({layer:e,bundle:t})=>!(!e||t.uploadOptions.isThumbnail)&&"image"===e.type)),d="make/slideshow"===o.studio.origin&&l;if(!o.studio.duration&&l){const t=e.filter((({layer:e,bundle:t})=>e&&"Media sidebar button - This Project"!==t.uploadOptions.analyticsUploadSource)).map((({layer:e,file:t})=>`${e.id} ${t.lastModified}`));if(a(G_([...o.studioLocal.staticUploadIds,...t])),e.filter((({layer:e})=>e)).length>1){const t=P();gJ(e.filter((({layer:e})=>e)).map((({layer:e})=>e.id)),t,!1,!1),e.forEach((({bundle:e})=>{e.selectedGroupId=t}))}}if(!o.studio.duration&&!r&&!d)return;const c=[i];e.forEach((({layer:t,bundle:o})=>{if(!t)return;if(o.uploadOptions.isThumbnail)return;if(o.uploadOptions.isMediaLibraryUpload)return;if(o.uploadOptions.createTeamAsset)return;if(t.requireConversion){const e=wq(c);return t.timelineRow=e,void c.push(e)}e.length>1&&(t.timelineRow=i);["video","audio"].find((e=>e===t.type))?(t.videoDelay=n,n+=t.duration||0):(t.isTrimmed=!0,t.startTime=n,t.endTime=n+3,n=t.endTime)}));const u=o.studio.selectedTimelineRows,m=1===e.length,p=bz({...t.layer},bE(),Math.min(...u,0));if(m&&p&&u.length>0&&(t.layer.timelineRow=Math.min(...u)),!o.studio.duration&&r){const e=o.studio.scenes[0];e&&KN(e,n,!0)}d&&(e=>{const{dispatch:t}=sr(),o=P(),a=e.filter((({layer:e})=>e)).map((({layer:e})=>e.id));t(pS("")),gJ(a,o,!0,!0),t(l_({id:o,type:"group"}))})(e)},wq=(e=[])=>{const{state:t}=sr(),o=t.studio.scenes[0];if(!o)return 0;const{layers:a}=o;if(!t.studio.duration&&a.length)return a.length;const i=[...a.map((e=>e.timelineRow||0)),...e];for(let s=0;s<i.length+1;s+=1)if(!i.includes(s))return s;return 0},bq=e=>new File([e],"tempFile",{type:e.type}),Tq=e=>{const t=Buffer.alloc(e.byteLength),o=new Uint8Array(e);for(let a=0;a<t.length;a+=1)t[a]=o[a];return t},xq=async(e,t,o={},a)=>{const{state:i,dispatch:s}=sr(),{isAdding:n}=i.studioLocal;let r=t;if(n[r._id]||jz(r._id),(!t.url||Pc(t.url)||t.preview_asset_id&&!t.preview||t.track_preview_asset_id&&!t.track_preview)&&(r=await W$(t._id,"addFromMediaLib"),s(JP([r]))),!r.url)return jz(r._id),console.error(`Could not create layer for cml file ${e.id}: asset has no url`),null;const{dimensions:l}=r;try{const i={addedFromMediaLibrary:!0,asset_id:r._id,cmlFileId:e.id,name:r.name||r.blob_name,mime:r.content_type,usedProFeatures:t.usedProFeature?[t.usedProFeature]:[],...l,...o},s=await Eq(r,i);return o.isTrimmed||a||lz(s),yz({newLayer:s,options:{undoable:!0,knownTimelineRow:void 0!==i.timelineRow},idOfLayerToReplace:a}),s.asset_id&&HJ(s)&&JJ({assetId:s.asset_id,source:"Media Library"}),s}catch(d){return mh({description:"Failed to add layer",error:d}),jz(r._id),null}},Sq=async(e,t,o={})=>{const{dispatch:a,state:i}=sr(),{isAdding:s}=i.studioLocal;let n=t;if(s[n._id]||jz(n._id),t.url&&!Pc(t.url)||(n=await W$(t._id,"addFromMediaLib"),a(JP([n]))),!n.url)return jz(n._id),console.error(`Could not create layer for cml file ${e.id}: asset has no url`),null;const{state:{studio:{selectedItem:r,scenes:l}}}=sr(),d=l[0];if(!d)return null;const c=dz((null==r?void 0:r.id)||"");if(!c)return null;try{const a=await Eq(n,{addedFromMediaLibrary:!0,asset_id:t._id,cmlFileId:e.id,usedProFeatures:t.usedProFeature?[t.usedProFeature]:[],...o}),i=sC(a,c);return fz(i,c,{knownTimelineRow:!0,sceneId:d.id,undoable:!0}),a.asset_id&&HJ(a)&&JJ({assetId:a.asset_id,source:"Media Library"}),a}catch(u){return mh({description:"Failed to replace layer",error:u}),null}},Eq=async(e,t={})=>{const{state:o,dispatch:a}=sr(),{mediaCache:{assetIdToMediaCacheId:i}}=o;let s;const n=i[e._id];if(n&&(s=await(async(e,t,o)=>{const a=await d$(e);if(!a)return;const i=a.type===zl.Image?["original"]:["preview","original"],s=y$(a,["preview","original"]),n={...tY(t),...w$({idbAsset:a,includeHasAudio:!0,fileSelectionOrder:i})};if(!s)return;const{id:r}=Qz(),l={};let d=t.preview;if(null==d?void 0:d.url)if(a.type===zl.Image)if(l.preview={...d,mediaLibraryID:e},a.optimizedPreviewFile_v2)l.preview.height=a.optimizedPreviewFile_v2.height,l.preview.width=a.optimizedPreviewFile_v2.width;else if(d.width&&d.height)l.preview.height=d.height,l.preview.width=d.width;else{const e=await CB(d.url,"image/png");e.success&&(l.preview.height=e.properties.height,l.preview.width=e.properties.width)}else if(d={...d,...n},d.width&&d.height&&d.duration){const{width:e,height:t,duration:o}=d;l.preview={...d,width:e,height:t,duration:o,startTime:0,endTime:o}}else{const e=await xB(d.url,"video/mp4");if(!e.success)return;const{width:t,height:o,duration:a}=e.properties;l.preview={...d,width:t,height:o,duration:a,startTime:0,endTime:a}}if(t.track_preview){l.track_preview={...t.track_preview,mediaLibraryID:e};const o=y$(a,["track"]);o&&LE(r,{trackPreviewLocalUrl:URL.createObjectURL(o)})}if(a.type===zl.Video&&a.thumbnailSheet){const{file:t,thumbnail_height:o,thumbnail_width:i,fps:s,width:n,height:r}=a.thumbnailSheet,l={url:URL.createObjectURL(t),thumbnail_height:o,thumbnail_width:i,fps:s,sheet_width:n,sheet_height:r};sr().dispatch(c_(e,{thumbnailSheetLocalInfo:l}))}if(a.type===zl.Audio&&void 0!==n.duration&&void 0===(null==o?void 0:o.duration)){const e=new Yz("duration is undefined");R(e,{extra:{idbAsset:a,metadata:n,properties:o}})}return{id:r,url:t.url,asset_id:a.asset_id,type:a.type,...n,source:"upload",local_url:URL.createObjectURL(s),size:s.size,name:s.name,originalName:s.name,mime:s.type,addedFromMediaLibrary:!0,...l,...o}})(n,e,t)),!s){const o=n||P();s=await(async(e,t,o)=>{var a;if(!e.url)return void console.error("MISING ASSET url getNewLayerFromRemoteAsset",e);if(e.preview&&e.preview.url){const i={...e.preview,mediaLibraryID:t},s=null==(a=e.content_type)?void 0:a.startsWith("image");if(s&&i.width&&i.height)o.preview=i;else if(s&&i.url){o.preview=i;const e=await CB(i.url,"image/png");e.success&&(o.preview.height=e.properties.height,o.preview.width=e.properties.width)}else if(i.width&&i.height&&i.duration){const{width:e,height:t,duration:a}=i;o.preview={...i,width:e,height:t,duration:a,startTime:0,endTime:a}}else{const t=await xB(e.preview.url,"video/mp4");if(!t.success)return;const{width:a,height:s,duration:n}=t.properties;o.preview={...i,width:a,height:s,duration:n,startTime:0,endTime:n}}}e.track_preview&&(o.track_preview={...e.track_preview,mediaLibraryID:t});const i=tY(e);return await eY(e.url,o,{overwriteLayerType:o.type,mediaInfo:i})})(e,o,t),a(yu({assetId:e._id,mediaCacheId:o}))}return s},Iq=["overlay/record/video","overlay/record/audio","overlay/record/screen"],Cq=h.createContext(void 0),kq=_.memo((({children:e})=>{const t=il(),[o,a]=h.useState(void 0),i=h.useRef(null),[s,n]=h.useState(void 0),r=h.useRef(null),[l,d]=h.useState(!1),[c,u]=h.useState([]),[m,p]=h.useState(void 0),[g,f]=h.useState(!1),[y,v]=h.useState([]),[_,b]=h.useState(void 0),[T,x]=h.useState(void 0),[S,E]=h.useState(),[I,C]=h.useState(void 0),k=h.useCallback(((e,t)=>{f(e),e&&("function"!=typeof e||e(g))&&Fm(ym.TELEPROMPTER_OPENED,t?{"Opened From":t}:void 0)}),[g]),{pathname:A}=be(),j=h.useCallback(((e,o)=>{const a=aY(e,{selectLayerInCreator:!0});rE(),function(e){var t,o;const{state:a,dispatch:i}=sr(),{byId:s}=a.studio.allLayers,n=null==(t=a.studioLocal.awaitingRecordings)?void 0:t.screen,r=null==(o=a.studioLocal.awaitingRecordings)?void 0:o.video;if("recordType"in e)switch(e.recordType){case"screen-audio":case"screen-video":"string"==typeof n&&jq(s,e,n),i(M_({video:e.id}));break;case"screen":"string"==typeof r&&jq(s,e,r),i(M_({screen:e.id}))}}(a),"recordType"in a&&("screen-video"===a.recordType&&(LE(e.id,{positionTemp:null}),t(Uv(a,"3%","67%","30%","30%")),t(Hv(a))),"screen"===a.recordType&&(null==o?void 0:o.recordScreenAndCameraUpload)&&t($v(a)))}),[t]),N=h.useCallback((()=>{var e;null==(e=i.current)||e.destroy(),i.current=null,a((e=>{null==e||e.getTracks().forEach((e=>e.stop()))}))}),[]),R=h.useCallback((()=>{var e;null==(e=r.current)||e.destroy(),r.current=null,n((e=>{null==e||e.getTracks().forEach((e=>e.stop()))}))}),[]);h.useEffect((()=>()=>{null==o||o.getTracks().forEach((e=>e.stop()))}),[o]),h.useEffect((()=>()=>{null==s||s.getTracks().forEach((e=>e.stop()))}),[s]);const P=h.useCallback((e=>{E(Date.now()),void 0!==e&&C((()=>e)),a((e=>(e&&(i.current=FG(e),d(!0)),e)))}),[]),D=h.useCallback((()=>{E(Date.now()),n((e=>(e&&(r.current=FG(e),d(!0)),e)))}),[]),O=h.useCallback((()=>{D(),P()}),[D,P]),L=h.useRef(!1),F=cE((async()=>{const e=[];if(!L.current){L.current=!0;try{const a=Date.now()-(S??0);if(E(void 0),i.current&&o){const t=o.getTracks().some((e=>"video"===e.kind));let n,l;s&&r.current?(n=t?"screen-video":"screen-audio",l="Record screen"):t?(l="Record video",n="video"):(l="Record audio",n="audio"),e.push(LG(o,i.current,n,a).then((e=>({file:e,analyticsUploadSource:l}))).finally((()=>N())))}r.current&&s&&e.push(LG(s,r.current,"screen",a).then((e=>({file:e,analyticsUploadSource:"Record screen"}))).finally((()=>R())));const n=(await Promise.all(e)).filter((({file:e})=>e)).map((({file:e,analyticsUploadSource:t})=>({file:e,analyticsUploadSource:t})));d(!1);const l=n.map((({file:e})=>e));if(I){if(l&&l[0]){if(a<6e4)return void t(wl({description:"Record for least a minute for better results.",type:"warning"}));I(l[0])}else console.error("audio file was invalid");return}const c=n.map((({analyticsUploadSource:e})=>e)),u=!!l.find((e=>"screen-video"===e.recordType));return t(M_({screen:void 0,video:void 0})),eq(l,{eventHandlers:{handlePreemptiveFinish:j,handleFinish:iY},uploadOptions:{addAtSeeker:!0,analyticsUploadSource:c[0],analyticsUploadSources:c,uploadSourceComponent:"RecordContext",multiRowUploadForRecording:!0,recordScreenAndCameraUpload:u}})}finally{L.current=!1}}})),M=h.useCallback((async()=>{const e=await async function(){const e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"default"!==e.deviceId)).filter((e=>""!==e.deviceId));return{videoInputDevices:e.filter((e=>"videoinput"===e.kind)),audioInputDevices:e.filter((e=>"audioinput"===e.kind))}}();return u(e.videoInputDevices),v(e.audioInputDevices),e}),[]);h.useEffect((()=>{!m&&c.length>0&&p(c[0])}),[m,c]),h.useEffect((()=>{!_&&y.length>0&&b(y[0])}),[_,y]),h.useEffect((()=>{if(s&&l){const e=s.getVideoTracks()[0];e&&(e.onended=F)}}),[s,l,F]),h.useEffect((()=>{Iq.some((e=>A.includes(e)))||l||(N(),R())}),[R,N,A,l]),h.useEffect((()=>()=>{R(),N()}),[R,N]);const U=h.useMemo((()=>({videoAudioStream:o,isRecording:l,micDevices:y,selectedMic:_,setSelectedMic:b,cameraDevices:c,selectedCamera:m,setSelectedCamera:p,setVideoAudioStream:a,setScreenStream:n,pollDevices:M,saveRecordings:F,recordScreen:D,recordVideo:P,record:O,startTime:S,teleprompterText:T,setTeleprompterText:x,teleprompterOpen:g,setTeleprompterOpen:k})),[o,l,y,_,c,m,M,F,D,P,O,S,T,g,k]);return w.jsx(Cq.Provider,{value:U,children:e})}));function Aq(){const e=h.useContext(Cq);if(!e)throw new Error("useRecord must be used within a RecordProvider");return h.useEffect((()=>{e.pollDevices()}),[]),e}function jq(e,t,o){const a=e[t.id],i=e[o];if(!a||!i)return;const s=(null==a?void 0:a.duration)??0,n=(null==i?void 0:i.duration)??0,r=Math.min(s,n);OI({[a.id]:{endTime:r,isTrimmed:!0},[i.id]:{endTime:r,isTrimmed:!0}},"syncTiming")}const Nq="CountDownTimer-module_countDownTimer_glMQS",Rq="CountDownTimer-module_lightCountDownTimer_dA3iT",Pq="CountDownTimer-module_alertUser_dHinj",Dq="CountDownTimer-module_flash_cc5hI",Oq=15,Lq=_.memo((({maxRecordDuration:e,lightTheme:t})=>{const{startTime:o,isRecording:a,saveRecordings:i}=Aq(),s=e||9e5,[n,r]=h.useState((()=>o?Mq(o,s):s));h.useEffect((()=>{let e;if(a&&o){let t=!1;e=setInterval((()=>{r((()=>{const e=Mq(o,s);return e<=0&&!t&&(t=!0,i()),e}))}),1e3)}return()=>{e&&clearInterval(e)}}),[a,s,i,o]);let l=t?Rq:Nq;return n<=6e4&&(l+=` ${Pq}`,n<=15e3&&(l+=` ${Dq}`)),w.jsx("b",{className:l,children:Fq(Math.round(n/1e3))})})),Fq=e=>{const t=Math.floor(e/60),o=Math.round(e-60*t);return`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`};function Mq(e,t){const o=Date.now()-e;return Ru(t-o,0,t)}const Uq="RecordButton-module_container_DPV2B",Bq="RecordButton-module_buttonContainer_gUAUT",Vq="RecordButton-module_lightButtonContainer_edMhz",Wq="RecordButton-module_recordCircle_X4kLr",Gq="RecordButton-module_animate_HrHrs",Hq="RecordButton-module_recordingMetadata_UR5xa",$q="RecordButton-module_lightRecordingMetadata_34yfB",Kq="RecordButton-module_equalizer_ftfaD",zq=_.memo((({onClick:e,isRecording:t,maxRecordDuration:o,lightTheme:a})=>{const[i,s]=h.useState("NOT_STARTED");h.useEffect((()=>{"NOT_STARTED"===i&&t?s("IN_PROGRESS"):"IN_PROGRESS"!==i||t||s("DONE")}),[t,i]);const n="IN_PROGRESS"===i;return w.jsxs("div",{className:Uq,children:[w.jsx("div",{className:a?Vq:Bq,onClick:e,children:w.jsx("span",{className:mt(n&&[Wq,Gq],!n&&[Wq])})}),w.jsxs("div",{className:a?$q:Hq,children:[w.jsx("span",{children:(()=>{switch(i){case"NOT_STARTED":return"Start Recording";case"IN_PROGRESS":return"Recording...";case"DONE":return"Recording Stopped"}return""})()}),w.jsx(Lq,{maxRecordDuration:o,lightTheme:a})]}),w.jsx("div",{className:Kq,children:w.jsx(hH,{audioPlaying:"IN_PROGRESS"===i})})]})})),Yq="VoiceCloningRecordOverlay-module_container_XMF--",Jq="VoiceCloningRecordOverlay-module_lightContainer_mqIv8",qq="VoiceCloningRecordOverlay-module_headerText_rlH9B",Xq="VoiceCloningRecordOverlay-module_lightHeaderText_GLHhb",Qq="VoiceCloningRecordOverlay-module_footerControls_JtO-1",Zq="VoiceCloningRecordOverlay-module_recordSection_bUJ0W",eX="VoiceCloningRecordOverlay-module_subheader_uqBix",tX="VoiceCloningRecordOverlay-module_lightSubheader_rTFqk",oX="VoiceCloningRecordOverlay-module_scriptContainer_Hltaf",aX="VoiceCloningRecordOverlay-module_lightScriptContainer_MH7h3",iX="VoiceCloningRecordOverlay-module_toggleScript_Do729",sX="VoiceCloningRecordOverlay-module_icon_2edRy",nX="VoiceCloningRecordOverlay-module_scriptHeader_RcHwO",rX="VoiceCloningRecordOverlay-module_script_aVYpV",lX="VoiceCloningRecordOverlay-module_lightScript_FFLMC",dX="Permissions-module_header_k72yJ",cX="Permissions-module_description_6fr5O",uX="Permissions-module_primaryButton_zUT0R",mX="Permissions-module_iconContainer_W-gXq",pX="Permissions-module_icon_5rFAS",hX=_.memo((({title:e,description:t,renderDescription:o,handleClose:a=(()=>rE())})=>w.jsx(XV,{goBackToEditor:!0,children:w.jsxs("div",{children:[w.jsx("div",{className:dX,children:e}),w.jsx("div",{className:cX,children:t}),o&&w.jsx("div",{className:cX,children:o()}),w.jsx("div",{onClick:a,className:uX,children:"Close"})]})}))),gX=({handleClose:e})=>w.jsx(hX,{title:"Media Device Access Denied",description:"The browser does not have access to your media device. Enable access and try recording again.",handleClose:e}),fX=_.memo((()=>w.jsx("div",{className:mX,children:w.jsx(pt,{className:pX})}))),yX=()=>{const e=h.useCallback((()=>w.jsxs("div",{children:["Kapwing does not have access to the clipboard. This can be set by clicking the lock icon ",w.jsx(fX,{})," next to the URL in the address bar. Enable access and try pasting again."]})),[]),t=h.useCallback((()=>{rE()}),[]);return w.jsx(hX,{title:"Clipboard Access Denied",renderDescription:e,handleClose:t})},vX=_.memo((({setRecordOpen:e,addFiles:t,lightTheme:o})=>{const{setVideoAudioStream:a,recordVideo:i,saveRecordings:s,isRecording:n,micDevices:r,setSelectedMic:l,selectedMic:d}=Aq(),[c,u]=h.useState(!0),[m,p]=h.useState(!1);h.useEffect((function(){(async()=>{const e=await VG(null==d?void 0:d.deviceId);e?a(e):p(!0)})()}),[a,d]);const g=h.useRef(!0);h.useEffect((function(){g.current?g.current=!1:n||e(!1)}),[n,e]);const f=h.useCallback((e=>{t([e])}),[t]),y=h.useCallback((async()=>{n?await s():i(f)}),[f,n,i,s]);return w.jsxs(w.Fragment,{children:[m&&gX({handleClose:()=>{p(!1)}}),w.jsxs("div",{className:o?Jq:Yq,children:[w.jsx("div",{className:o?Xq:qq,children:"Record Voice Cloning Sample"}),w.jsxs("div",{className:o?tX:eX,children:["You can record ",w.jsx("b",{children:"1-3 minutes"})," per audio sample. Make sure to record your sample in a quiet space. Click the red button below to start recording audio for your custom voice clone."]}),w.jsxs("div",{className:o?aX:oX,children:[w.jsxs("div",{className:nX,children:["Sample script",c?w.jsxs("div",{className:iX,onClick:()=>u(!1),children:["Show script",w.jsx("div",{className:sX,children:w.jsx(ht,{})})]}):w.jsxs("div",{className:iX,onClick:()=>u(!0),children:["Hide script",w.jsx("div",{className:sX,children:w.jsx(gt,{})})]})]}),!c&&w.jsxs(w.Fragment,{children:[w.jsx("p",{className:o?lX:rX,children:"This is a recording of what my voice sounds like. Text-to-speech voiceovers are a powerful tool for content creators in various fields. They can enhance your podcasts, elevate your webinars, and enrich educational videos."}),w.jsx("p",{className:o?lX:rX,children:"But what if you could take it a step further and make your content truly unique? That's where cloned voices come in."}),w.jsx("p",{className:o?lX:rX,children:"Imagine having your very own personalized touch to everything you create. With a cloned voice, you can infuse your content with your identity and style, making it stand out in the crowded world of digital media."}),w.jsx("p",{className:o?lX:rX,children:"What's even more remarkable is the ability to break language barriers. Cloned voices make it possible for your content to be dubbed into countless languages, expanding your reach and connecting with global audiences."})]})]}),w.jsxs("div",{className:Qq,children:[w.jsx("div",{className:Zq,children:w.jsx(zq,{onClick:y,isRecording:n,maxRecordDuration:18e4,lightTheme:o})}),w.jsx(YG,{isDeviceToggled:!n,devices:r,setSelectedDevice:l,selectedDevice:d,icon:GG,lightTheme:o})]})]})]})}));async function _X(e){return await Yr(`/api/v1/ai/generate-elevenlabs-tts/${e}`)}async function wX({text:e,voiceId:t,language_code:o,cancellationSource:a}){const i=sr().state.studio._id,{id:s}=await async function({text:e,voiceId:t,model:o,language_code:a,video_id:i}){var s;return await Jr("/api/v1/ai/generate-elevenlabs-tts",{body:{text:e,voiceId:t,model:o,language_code:a,video_id:i,teamId:null==(s=Hu())?void 0:s._id}})}({text:e,voiceId:t,model:o.includes("en")?"eleven_turbo_v2":"eleven_multilingual_v1",language_code:o,video_id:i}),n=e=>new Promise((t=>setTimeout(t,e)));let r=!1;for(;!r;){if(a&&a.cancelled)return"cancelled";const{error:e,result:t}=await _X(s);if(e)throw new Error(e);if(t&&"pending"!==t)return r=!0,t;await n(1e3)}}const bX="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAFACAMAAAD6TlWYAAAB8lBMVEUFoIH////9/v7x+fjl9fLY8OvN7OW65NyX18pyybhOu6YqrpMHoYLz+vm55Nt8zb0/tp4LooT2+/qt4NVXv6oNo4Wl3dJGuKLQ7edfwq4JoYPj9PF0yrnd8u5WvqrC5+A1spn8/f2D0MAIoYLL6+QrrpT1+/poxbKT1si45NsSpYfV7+ogqo7b8e0fqo7a8eweqY3Z8OwdqY2p3tR+zr4TpYgwsJZTvah5zLuh29De8u7+/v5PvKYjq5BnxbK95t3o9vMYp4rq9/QOo4Xn9vNdwa2S1cju+PaV1skXp4rA59/6/fyZ2Muw4ddsx7X7/f08tZ2u4NaAzr8kq5Cr39WQ1MfO7OYQpIYhqo/p9vSy4di/5t74/PsRpIc2spnE6OEmrJH3/PvK6uQ4s5sKooMxsJdRvae149mb2cxvyLaO1MZ4y7uBz7+J0sOI0cOG0cJ2y7rJ6uPv+fdHuaIprZNawKv5/Pw7tJyE0MFIuaMPpIbt+PbD6OA6tJzc8e11yrlMu6UsrpTw+fdbwKwVpokWpokur5V3y7rS7uiz4thEuKF9zb17zbzs9/Wg28/y+vhmxLGb2c2H0cKK0sSW18qi29Bhw69Bt59gwq5uyLbr9/VDt6DP7edJuqPf8++249pLuqR/zr4nrZKe2s5pxrMzsZgQPDzOAAADa0lEQVR4Ae3cg7ptNxuA0XzHtm3btm1bP2vbtu32Pvugnll756zUHeMS3ukZJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOD3QvwqunTt1r1Hz169+/TtJ2Cd/gMGDhosYJ0hQ4cNF7BO/xEjBaw0avQYAeuMHTdYwDrjJwhYaeIkAetMnjJVwDrTpgtYZ8ZMASvN6idgndlzBKwzd56AdeYvELDOwkUC1lm8RMA6PYYLWGepgJWW/TMCppvWb/m8FStXrV4TnVi7TsAOrd+wsUt0ZNNmATsxb9mW6MBQATu1tfe2aG27gJ2bs2NytLJzs4AFJo2PVnYJWGL3nmhhb18BS0zdFy3sF7DMgYORd0jAMsPWRtZhAQsdiazJRwUsdCyyjgtYaOuJyOl6UsBCp05HzmgBS22PnDMCFjsbGefOC1hqxdrI2C5gscORcUzAYhciY5uA5S5GxiUBi82se5ERcPnlaNonYLme0XRFwHKrommLgOWuRsZJAYtdmxxN1wUsNz+abghY7l/RtEHAcv+Opv8IWO6/0fQ/Acv9P5qOCFhuYDTdImC5W6PpNgHL7Yqm2wUsN8JrTJ07ommYgOXujKa7BCy2JDLuFrDYPdF0bz8Bq77k5iYBi62pmq0v4H2Rcb+AxXpFxgMClnrwoWi6d6uApcZFxsNJwEKDu0XGFAFL3R45jwhYaF7/yHg0CVjocORMEbDQY5HVV8Ayj3eJnCtJwCJPPBlZTwlY5On5kTW+n4AlnrkYeQdSAQGffTTyTg8XsECfrlFxAgr4XJdo4fl+AnZq/QvR0otJwE5sfWlG+xvHCDjn5S3R2itLBOzQi6++Fh1ZmVoRsF/f10dsi469kb4n4KQ3f/TW2++cmXtvdKr7VgF/8G7ctIfuThUEvPe9VEPA91MNAVelGgI+lioIuPaDVEHAgxtSBQE//ChVEPDj9amCgO9sTe0TcNuNVEHAEc+k9gn48SepfQJ+Ojq1T8CFH1xL7RJw7Wefp7YJeOKLL1ObBJxxtvf61B4BT3/19Tf9UtsEfCcVEFBAAQUUUEABBRRQQAEFFFBAAQUUUEABBRRQwAoCFhJQQAEFFFBAAQUUUEABBRRQQAEFFFBAAQUUUEABAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL4FwSegPJGNcQIAAAAASUVORK5CYII=",TX=[Gg.videos,Gg.images,Gg.elements,Gg.templates],xX={QUERY:"SIDEBAR_SEARCH_QUERY",RESULTS:{VIDEO:"SIDEBAR_VIDEO_RESULTS",IMAGE:"SIDEBAR_IMAGE_RESULTS",QUERY:{VIDEO:"SIDEBAR_VIDEO_QUERY",IMAGE:"SIDEBAR_IMAGE_QUERY"}}},SX="elements-sidebar",EX="sidebar-audio",IX="sidebar-transitions",CX=["boob","boobs","breast","breasts","butt","butts","seggs","kill","guns","foreplay","prostitution","mary jane","doobie","joint","spliff","shoot","drug","304","blood","nude","big bobs"],kX=["vodka","kicking","demon"],AX=()=>sh.remove(xX.QUERY),jX=()=>{const e=sh.get(xX.RESULTS.IMAGE,{disabled:null});return e?sh.get(xX.RESULTS.QUERY.IMAGE,{disabled:null})!==sh.get(xX.QUERY,{disabled:null})?[]:e:[]},NX=()=>sh.get(xX.QUERY,{disabled:""})||"",RX=()=>{const e=sh.get(xX.RESULTS.VIDEO,{disabled:null});return e?sh.get(xX.RESULTS.QUERY.VIDEO,{disabled:null})!==sh.get(xX.QUERY,{disabled:null})?[[],[]]:e:[[],[]]},PX=async(e,t={})=>{const{pageNumber:o,useGoogleOnly:a,includeGetty:i,aspectRatio:s,royaltyFree:n}=t;return Qr("image_search",{body:{query:e,pageNumber:o,useGoogleOnly:a,includeGetty:i,aspectRatio:s,royaltyFree:n}})},DX=(e,t)=>{const{width:o,height:a}=t.dimensions;return e+a/o},OX=new Map;const LX=async({url:e,options:t={}})=>{var o,a,i,s,n,r;if(!e)return null;OX.has(e)||OX.set(e,function(e,t){var o;const{layerProperties:a={}}=t,i={};a.name?i.fileName=a.name:"emojiDescription"in a&&a.emojiDescription&&(i.fileName=a.emojiDescription),t.skipCML&&(i.skipCML=!0);const s=null==(o=a.usedProFeatures)?void 0:o[0];s&&(i.usedProFeature=s),t.sourceInfo&&(i.sourceName=t.sourceInfo.sourceName,i.sourceType=t.sourceInfo.sourceType,i.sourceId=t.sourceInfo.sourceId,i.sourceDimensions=t.sourceInfo.sourceDimensions);const n={};return t.thumbnailUrl&&(n.thumbnailUrl=t.thumbnailUrl),B$(e,i,n)}(e,t));const l=OX.get(e);if(!l)throw new Error("Pending request not found");let d=null,c=null;try{const e=await l;d=e.asset,c=e.cmlFile}catch(y){return null}const u=d.status!==On.uploaded,m={asset_id:d._id,source:u?"pastedLink":"upload",url:u?void 0:d.url,pastedUrl:e,duration:d.duration,isMediaLibraryUpload:t.isMediaLibraryUpload,...t.layerProperties};u&&(m.uploadId=P(),m.uploadPending=!0,m.url=e,d.lowerQualityPreviewUrl&&(m.lowerQualityPreviewUrl=d.lowerQualityPreviewUrl)),c&&(m.cmlFileId=c.id);const p=await Eq(d,m);if(!p)throw console.error("Failed to create layer from asset",d),Error(`Could not create layer from asset ${d._id}`);Mz(d,c,p.uploadId??void 0);let h=!1;if(p.type===zl.Audio||p.type===zl.Video)try{const o=t.mediaInfo||await yH({actionDescription:"getMediaInfo",timeoutMs:1e4,promise:AB(e,{name:e})});o&&"hasAudio"in o&&(h=o.hasAudio)}catch(y){console.error(y)}!t.isMediaLibraryUpload&&h&&JJ({assetId:d._id,source:(null==(a=null==(o=null==t?void 0:t.layerProperties)?void 0:o.addedLayerFrom)?void 0:a.source)||(null==(i=null==t?void 0:t.layerProperties)?void 0:i.assetSource)||"Url Add"}),sr().dispatch(l_({id:p.id,type:"layer"})),t.isMediaLibraryUpload||Um(p.type,(null==(n=null==(s=t.layerProperties)?void 0:s.addedLayerFrom)?void 0:n.source)||t.pluginId||void 0);const g={selectLayerInCreator:!0,singleFileUpload:!0,knownTimelineRow:void 0!==(null==(r=t.layerProperties)?void 0:r.timelineRow),skipStudioAddLayer:t.skipStudioAddLayer,useCustomVideoDelay:t.useCustomVideoDelay};let f={...p};if(t.idOfLayerToReplace){const e=sr().state.studio.allLayers.byId[t.idOfLayerToReplace];e&&(f=sC(f,e),g.layerToReplace=e)}return aY(f,g),zg()&&dE(),p},FX=e=>{var t;const{state:o,dispatch:a}=sr(),i=zg(),s=(null==(t=o.studio.scenes[0])?void 0:t.background)||"#ffffff",n=$I();let r="#ffffff";["#fff","#ffffff","white",ey].includes(s.toLowerCase())&&(r="#000000");let l={id:P(),type:zl.Shape,shapeType:e,background:r,stroke:ey,position:n,lineCap:["line","arrow"].includes(e)?"round":"butt",globalAlpha:1};const d="svg"===e?"0.1%":"0.3%";l.lineWidth=["line","arrow"].includes(e)?"0.6%":d,["line","arrow"].includes(e)&&(l={...l,position:n,lineRightAngle:"horizontal",linePointStartCorner:"topLeft",stroke:"#000000"}),"arrow"===e&&(l={...l,lineArrow:"open"}),["rectangle","ellipse","svg"].includes(e)&&(l.position=tI(l.position)),gz(l,{undoable:!0}),a(l_({id:l.id,type:"layer"})),i&&dE()},MX=async(e,t={})=>{const{pageNumber:o,includeGetty:a}=t;return Qr("video_search",{body:{query:e,pageNumber:o,includeGetty:a}})},UX=e=>{const t=ft.filter((e=>!kX.includes(e)));if(t.push(...CX),t.includes(e))return!0;const o=e.split(" ");for(const a of o)if(t.includes(a))return!0;return!1},BX=(e,t,o,a=0)=>{if("GOOGLE"===t){const t=e;return{name:t.name||o,smallUrl:t.url,largeUrl:t.url,downloadUrl:t.url,type:"GOOGLE",mimeType:t.mime,isPremiumAsset:a>=2,searchResult:e}}if("PEXELS"===t){const t=e;return{name:t.name||o,smallUrl:t.images.small,largeUrl:t.images.large,downloadUrl:t.images.download,type:"PEXELS",attribution:{providerUrl:"//pexels.com",altText:"Pexels Logo",logoSrc:bX,attributionUrl:t.attribution.url,attributionName:t.attribution.name},dimensions:t.dimensions,images:t.images,isPremiumAsset:!1,searchResult:e}}const i=e;return{name:i.name||o,smallUrl:i.images.small,largeUrl:i.images.large,downloadUrl:i.images.download,type:"GETTY",attribution:{providerUrl:"//gettyimages.com",altText:"Getty Images Logo",logoSrc:"https://cdn-useast1.kapwing.com/static/ORb-gettyLogo.webp",attributionName:i.attribution.name,attributionUrl:i.attribution.url},dimensions:i.dimensions,images:i.images,id:i.id,isPremiumAsset:!0,searchResult:e}};function VX({emoji:e,isMediaLibraryUpload:t}){const o=(e=>{var t,o,a,i;let s=null==(a=null==(o=null==(t=null==e?void 0:e.blob_name)?void 0:t.split("/"))?void 0:o.pop())?void 0:a.split("-");return(null==s?void 0:s.length)&&["drink","places"].includes(s[0])&&(s=s.slice(1)),`Emoji ${null==(i=null==s?void 0:s.join(" "))?void 0:i.split(".")[0]}`})(e),a=`https://cdn-useast1.kapwing.com/${e.blob_name}`;LX({url:a,options:{layerProperties:{emojiDescription:o,isMediaLibraryUpload:t,library:"emoji",lockAspectRatio:!0,mime:"image/png",position:tI($I())},mediaInfo:{height:120,type:zl.Image,width:120}}})}const WX=async(e,t)=>Qr("music_search",t?{body:{query:e,nextPage:t}}:{body:{query:e,nextPage:""}}),GX=async(e,t)=>Qr("sfx_search",t?{body:{query:e,nextPage:t}}:{body:{query:e,nextPage:""}}),HX=e=>{let t=e;e.type===zl.Video&&(t={...e,type:zl.Audio,converted_type:"audio"}),iY(t)},$X=async e=>{const t=aY(e,{selectLayerInCreator:!0});t&&KX(t)},KX=e=>{const{dispatch:t}=sr();g.batch((()=>{"video"===e.type&&OI({[e.id]:{type:zl.Audio,converted_type:"audio"}},"helpers.ts",!0),t(l_({id:e.id,type:"layer"}))}))},zX=async({voiceOption:e,text:t,cancellationSource:o})=>{const{dispatch:a}=sr();let i;if(e.elevenLabsId)Fm(ym.TTS_ENDPOINT_CALLED,{Voice:e.name,Source:"Eleven Labs","Character Count":t.length}),i=await wX({text:t,voiceId:e.elevenLabsId,language_code:e.languageCode,cancellationSource:o});else{const o={gender:e.gender,languageCode:e.languageCode,name:e.name};Fm(ym.TTS_ENDPOINT_CALLED,{Voice:o.name,Source:"Google","Character Count":t.length}),i=await async function(e,t,o){return Jr("/api/v1/tts/synthesize",{body:{text:e,video_id:o,voice:t}})}(t,o,sr().state.studio._id)}if("cancelled"===i)return;const{asset:s,audioB64:n,startTime:r,endTime:l,transcription:d}=i,c=P();a(yu({assetId:s._id,mediaCacheId:c})),a(JP([s]));return{asset:s,mediaCacheId:c,dataURL:`data:audio/mpeg;base64,${n}`,startTime:r,endTime:l,transcription:d}},YX=async({language:e,voiceOption:t,text:o,withSubtitles:a,fromMediaSidebar:i,cancellationSource:s})=>{const n=await zX({voiceOption:t,text:o,cancellationSource:s});if(!n)return;const{asset:r,mediaCacheId:l,dataURL:d,startTime:c,endTime:u,transcription:m}=n,p=await AB(d,((e,t)=>{const o=e.split(","),a=atob(o[o.length-1]||""),i=new Uint8Array(a.length);for(let s=0;s<a.length;s++)i[s]=a.charCodeAt(s);return new File([i],t,{type:"audio/mpeg"})})(d,"ttsmedia.mp3"));let h;if(p&&"duration"in p&&(h=p.duration),!h)throw new Error("Text to Speech failed in acquiring duration. Please try again.");if(!r.url)throw new Error("Text to Speech failed in acquiring the asset URL. Please try again.");const g={id:P(),type:zl.Audio,name:XX(o,25),asset_id:r._id,url:r.url,duration:h,hasAudio:!0,usedProFeatures:["text-to-speech"],volume:1,videoDelay:bE(),startTime:c,endTime:u,isTrimmed:!0,ttsText:o,ttsLanguage:e,ttsVoice:t,ttsSubtitlePreference:a},f=hB({name:"tts.mp3"},d);n$({mediaCacheId:l,type:zl.Audio,file:f}),g.local_url=URL.createObjectURL(f);let y="Google";return t.elevenLabsId&&(y="Eleven Labs"),"isClone"in t&&t.isClone&&(y="Eleven Labs Clone"),Fm(ym.TEXT_TO_SPEECH_AUDIO_LAYER,{Language:e,Voice:t.label,WithSubtitles:a,Text:o.slice(0,200),CharCount:o.length,Location:i?"Media Sidebar":"AI Overlay",Source:y}),{layer:g,transcription:m}},JX=async(e,t,o,a)=>{const{dispatch:i}=sr(),s=await YX({language:e,voiceOption:t,text:o,withSubtitles:a,fromMediaSidebar:!0});if(!s)return;const{layer:n,transcription:r}=s;return gz(n,{undoable:!0}),i(nN([{assetId:n.asset_id,languageKey:t.languageCode,status:{assetTranscriptionId:r._id,state:"completed",languageKey:t.languageCode,words:r.words,job_params:r.job_params}}])),n},qX=async(e,t,o,a,i)=>{const{dispatch:s}=sr(),n=await YX({language:t,voiceOption:o,text:a,withSubtitles:i,fromMediaSidebar:!0});if(!n)return;const{layer:r,transcription:l}=n;return Az({layerIds:[e.id],undoable:!0}),gz({...e,id:r.id,name:r.name,asset_id:r.asset_id,url:r.url,local_url:r.local_url,duration:r.duration,startTime:r.startTime,endTime:r.endTime,ttsText:r.ttsText,ttsLanguage:r.ttsLanguage,ttsVoice:r.ttsVoice},{undoable:!0}),s(nN([{assetId:r.asset_id,languageKey:o.languageCode,status:{assetTranscriptionId:l._id,state:"completed",languageKey:o.languageCode,words:l.words,job_params:l.job_params}}])),r},XX=(e,t)=>{if(e.length<=t)return e;const o=e.slice(0,t).split(" ");if(o.length<=1)return o.join(" ");return" "===e[t]?o.join(" "):o.slice(0,-1).join(" ")},QX=async e=>{const t=e.filter((e=>e.type===zl.Audio&&e.soundStripeID)),o=t.map((e=>e.soundStripeID));if(o.length>0){let e=[];return e=await(async e=>Qr("youtube_codes",{body:{ids:e}}))(o),e.map(((e,o)=>{var a;return{name:null==(a=t[o])?void 0:a.name,code:e}}))}return[]},ZX="DragUploadDropzone-module_overlayContainer_wNk2o",eQ="DragUploadDropzone-module_dragActive_vyROj",tQ="DragUploadDropzone-module_overlayBackground_UgxGk",oQ="DragUploadDropzone-module_borderless_5rbfY",aQ="DragUploadDropzone-module_overlayContent_P7Ifi",iQ="DragUploadDropzone-module_active_4FzlS",sQ="DragUploadDropzone-module_loading_VXRF2",nQ="DragUploadDropzone-module_loader_xWUbO",rQ="DragUploadDropzone-module_invisible_c4J53",lQ=_.memo((({children:e,dragContainerClass:t,doAudioUpload:o=!1,customAddUploads:a,forMainCanvas:i,forMainStudio:s,invisible:n,onEnter:r,overlayContainerClass:l,uploadSource:d,uploadTarget:c})=>{const u=["UploadDragOverlay","Timeline","StudioRight"].includes(d),[m,p]=h.useState([]),[g,f]=h.useState(!1),y=il(),{studioDragDropActive:v,mainStudioDragDropDisabled:_}=tl((e=>({studioDragDropActive:e.studioLocal.studioDragDropActive,mainStudioDragDropDisabled:e.studioLocal.mainStudioDragDropDisabled})),ol),b=tl((e=>e.uploadStatuses)),T=tl((e=>e.studioLocal.mediaSidebarSelectedTab));h.useEffect((()=>{if(i&&m.length&&b){const e=m.filter((e=>{const t=b[e];return!t||t.stage<Sv.inProgress}));m.length!==e.length&&p(e)}}),[i,b,m]);const x=`${tQ} ${l||""} ${g?iQ:""}`,S=o?"as audio":`to the ${"canvas"===c?"canvas":"project"}`;return s&&_?w.jsx("div",{className:`${ZX} ${t}`,children:e}):w.jsxs("div",{className:`${ZX} ${t} ${v?eQ:""}`,"data-cy":"drag-upload-dropzone-container",onDragEnter:e=>{e.preventDefault(),r&&r(),f(!0),y(__(!0))},onDragLeave:e=>{e.preventDefault(),f(!1)},onDragOver:e=>{ju(e)&&(e.preventDefault(),e.stopPropagation())},children:[i&&m.length>0&&w.jsx("div",{className:`${x} ${oQ}`,children:w.jsx("div",{className:aQ,children:w.jsxs("div",{className:sQ,children:[w.jsx("div",{className:nQ}),w.jsx("span",{children:"Uploading Files"})]})})}),e,v&&w.jsx("div",{"data-cy":"drag-upload-dropzone",className:`${x} ${n&&rQ}`,onDrop:async e=>{e.preventDefault();const{files:t}=e.dataTransfer;if(a)return a(t),f(!1),void y(__(!1));const s=o?HX:iY,n=o?$X:aY,r=u||o,l=await eq(t,{eventHandlers:{...r&&{handleFinish:s,handlePreemptiveFinish:n},handleCancel:e=>{p((t=>t.filter((t=>t!==e))))}},uploadOptions:{analyticsUploadSource:"sidebar"===c?"Drag and drop - Media sidebar":"Drag and drop - Canvas",dragUpload:!0,uploadSourceComponent:d,isMediaLibraryUpload:!r,doDuplicateHandling:!0,convertToAudio:o}});i&&p([...m,...l]),"sidebar"===c&&"thisProject"!==T&&y(N_("thisProject")),f(!1),y(__(!1))},children:!n&&w.jsxs("div",{className:aQ,children:[w.jsx(yt,{size:30}),w.jsx("p",{children:"Drop here to add"}),w.jsx("p",{children:S})]})})]})}));function dQ(){const{dispatch:e}=sr();e(w_(!1)),eE("/studio/editor")}const cQ={margin:0,marginLeft:20,width:20,height:20},uQ=_.memo((({setCurrentVoice:e,lightTheme:t,onClose:o=dQ})=>{const[a,i]=h.useState(""),[s,n]=h.useState([]),[r,l]=h.useState(!1),[d,c]=h.useState(!1),[u,m]=h.useState(!1),p=il(),{activeBrandkit:g,selectedTeamId:f}=tl((e=>({activeBrandkit:e.teams.activeBrandkit,selectedTeamId:e.teams.selectedTeamId})),ol),y=h.useCallback((e=>{0===s.length?n(e):n([...s,...e])}),[s]),v=h.useCallback((e=>{if(e.length>3-s.length)p(wl({description:"Upload up to 3 samples.",type:"warning"}));else{const t=Array.from(e).filter((e=>{if(MB(e.type)||bB(e.type)){if(e&&e.size<=5e7)return!0;p(wl({description:"Uploaded file is too large.",type:"error"}))}else p(wl({description:`Invalid file type ${e.type}, upload video or audio.`,type:"error"}));return!1}));y(t)}}),[y,p,s.length]),_=h.useCallback((e=>{const t=e.target;t&&t.files&&t.files.length>0&&v(t.files)}),[v]),b=h.useCallback((async t=>{if(m(!0),t.preventDefault(),Fm(ym.VOICE_CLONING_STARTED,{numFiles:s.length}),g){const t=new FormData;t.append("name",P()),s.forEach((e=>{t.append("files",e,e.name)}));try{const s=await Sp(t,f);if(!s)return void m(!1);const r={label:a,name:`eleven-labs-clone-${a}`,languageCode:"en-US",elevenLabsId:s.voiceId},l=await(async({voiceOption:e,text:t,cancellationSource:o})=>{const a=await zX({voiceOption:e,text:t,cancellationSource:o});if(!a)return;const{asset:i}=a;return i})({voiceOption:r,text:"Automatically turn your text into speech with an ai-generated voice."});l||mh({description:"Voice preview failed to generate",error:new Error("Cloned voice preview failed to generate")});const d=g.clonedVoices?[...g.clonedVoices,{name:a,voiceId:s.voiceId,assetId:l?l._id:void 0,previewUrl:l?l.url:void 0}]:[{name:a,voiceId:s.voiceId,assetId:l?l._id:void 0,previewUrl:l?l.url:void 0}],u={...g,clonedVoices:d};p(Rp(u)),Mp(f,{brandkit:u}),Fm(ym.VOICE_CLONING_FINISHED,{voiceId:s.voiceId}),PP({TTSVoiceClones:1}),n([]),i(""),c(!1),e&&e(r),o()}catch(r){console.error(r),mh({description:"Failed to clone voice.",error:r})}}m(!1)}),[g,p,o,s,f,e,a]),T=h.useCallback((()=>{l(!0)}),[]),x=h.useCallback((()=>{r?l(!1):o()}),[o,r]);return r?w.jsxs("div",{className:KW,children:[w.jsx("div",{className:JW,onClick:x}),w.jsxs("div",{className:t?ZW:QW,children:[w.jsx("div",{className:t?wG:_G,onClick:x,children:w.jsx(ve,{})}),w.jsx(vX,{setRecordOpen:l,addFiles:y,lightTheme:t})]})]}):w.jsx(w.Fragment,{children:w.jsxs("div",{className:KW,children:[w.jsx("div",{className:JW,onClick:x}),w.jsxs("div",{className:t?XW:qW,children:[w.jsx("div",{className:t?wG:_G,onClick:x,children:w.jsx(ve,{})}),w.jsx("form",{className:eG,children:w.jsxs("div",{className:tG,children:[w.jsxs("div",{className:oG,children:[w.jsxs("div",{className:aG,children:[w.jsx("div",{className:t?sG:iG,children:"Add Voice"}),w.jsx("p",{className:t?rG:nG,children:"Clone your voice with ElevenLabs technology to use it with Text to Speech voiceovers. Your voice will be saved to your Brand Kit, so it will be accessible to everyone in your team workspace."})]}),w.jsx("div",{className:t?dG:lG,children:"Voice Name"}),w.jsx("input",{className:t?YW:zW,placeholder:"Type the name of your voice here",type:"text",autoComplete:"off",value:a,onKeyDown:e=>{a||" "!==e.key||e.preventDefault()},onChange:e=>{i(e.target.value)}}),w.jsx("div",{className:t?dG:lG,children:`Audio Samples (${s.length}/3)`}),w.jsxs("p",{className:t?rG:nG,children:["Upload or record up to 3 video or audio samples of your voice or a voice you have permission to clone.\n                   Each file must be 50MB or smaller."," ",w.jsx("b",{children:"For best results, please upload or record 1-5 minutes of sample material."})]}),w.jsx(lQ,{doAudioUpload:!0,customAddUploads:v,invisible:!0,uploadSource:"UploadDragOverlay",uploadTarget:"canvas",children:w.jsxs("label",{className:t?uG:cG,style:u?{pointerEvents:"none"}:{},children:[w.jsx("input",{className:vG,id:"file",type:"file",accept:"audio/*, video/*",multiple:!0,onChange:_,onClick:e=>{e.target.value=""},disabled:u}),w.jsxs("div",{className:t?pG:mG,children:["Custom Upload",w.jsx(vt,{})]}),w.jsx("div",{className:t?gG:hG,children:"Click to upload files from your device"})]})}),w.jsx("div",{className:t?yG:fG,style:u?{pointerEvents:"none"}:{},onClick:T,children:w.jsxs("div",{className:t?pG:mG,children:["Record Sample",w.jsx(_t,{})]})}),w.jsx("div",{className:bG,children:s.map(((e,o)=>w.jsxs("div",{className:t?xG:TG,children:[w.jsx("div",{className:t?kG:CG,onClick:()=>(e=>{const t=s;t.splice(e,1),n([...t])})(o),children:w.jsx(ve,{})}),e.name,w.jsxs("div",{className:t?EG:SG,children:["Upload Complete",w.jsx("span",{className:IG,children:w.jsx(wt,{})})]})]},e.name)))})]}),w.jsxs("div",{className:AG,children:[w.jsxs("div",{className:jG,children:[w.jsx("div",{className:t?RG:NG,onClick:()=>c(!d),children:d?w.jsx(bt,{}):w.jsx(Tt,{})}),w.jsxs("div",{className:t?rG:nG,children:["I confirm that I am the owner of this voice or have explicit permission to clone this voice. I confirm that I will not use this voice clone for abusive purposes such as fraud, discrimination, hate speech or for any form of online abuse. I confirm that I have reviewed the information outlined in this",w.jsx("a",{href:"https://elevenlabs.io/safety",target:"_blank",rel:"noopener noreferrer",children:" Voice Cloning Guide"}),"."]})]}),w.jsxs("button",{className:PG,onClick:b,disabled:0===a.length||0===a.trim().length||0===s.length||!d||u,children:[u?w.jsx("div",{children:"Cloning..."}):w.jsx("div",{children:"Clone"}),u&&w.jsx(MU,{text:"",wrapperStyles:cQ})]})]})]})})]})]})})})),mQ=e=>{var t;return(null==(t=e.teams.activeBrandkit)?void 0:t.projectId)===e.studio.projectId},pQ=m(tu,mQ,((e,t)=>e.hasPermission(Bl.BRANDKIT)&&t)),hQ=m((e=>{var t;return null==(t=e.teams.activeBrandkit)?void 0:t.teamId}),(e=>e.teams.selectedTeamId),((e,t)=>e===t)),gQ=e=>{const{allTeams:t,selectedTeamId:o}=e.teams;return t.find((e=>e._id===o))},fQ=m(gQ,(e=>e.currentUser.user),((e,t)=>{var o;return null==(o=null==e?void 0:e.users)?void 0:o.find((e=>e.userId===t._id))})),yQ=e=>{const t=fQ(e);return!!(null==t?void 0:t.enterpriseFormDismissed)},vQ=e=>{const{allTeams:t}=e.teams;return t.some((e=>e.planTier!==Cl.Free))};function _Q(){const e=Ac();$p();const t=tl((e=>{var t;return null==(t=gQ(e))?void 0:t.limits}),g.shallowEqual);return h.useMemo((()=>t&&new Date(t.lastReset).getUTCMonth()!==(new Date).getUTCMonth()?TP(e.planTier):TP(e.planTier,t)),[t,e.planTier])}const wQ=()=>{const e=ou(),t=_Q(),o=bW(),{openEnterpriseTypeform:a}=sW();return h.useCallback((function(i,s){return(...n)=>{let r;Object.entries(s).forEach((([e,o])=>{const a=t[e];a&&a.remainingUsage<o&&(r=e)}));const l=!(!s||!r);if(l&&Fm(ym.ENTERPRISE_USAGE_BLOCKED,{"Usage Category":r}),l&&bP(e.type)){const{dispatch:e}=sr(),t=Hu();if(!t)return;const{name:o,unit:i,monthly:s}=Lc[r];let n={inline:!0,text:` ${s?"monthly":""} usage limits here.`,href:`/team/${t._id}/billing`};"voice clone"===o&&(n={inline:!0,text:"Contact Sales",href:"",onClick:a});const l=Lc[r].limit.enterprise;let d=s?`You don’t have enough ${o} ${i}s for this month. You’ll need to upgrade to the Enterprise Plan for ${l?"more":"unrestricted"} usage. See your `:`You don’t have enough ${o} ${i}s. You’ll need to upgrade to the Enterprise Plan for ${l?"more":"unrestricted"} usage. See your `;return"voice clone"===o&&(d=`You don’t have enough ${o} ${i}s. You’ll need to upgrade to the Enterprise Plan for ${l?"more":"unrestricted"} usage. `),void e(wl({type:"error",description:d,link:n}))}if(!l||e.type!==Cl.Enterprise)return o((()=>i(...n)),{action:Vl.LIMITS_WARNING,if:l})();{const{dispatch:e}=sr();e(wl({description:"You can only have a maximum of four cloned voices.",type:"warning"}))}}}),[e.type,a,o,t])},bQ=_.memo((({value:e,listItems:t,onChange:o,allowArrowKeys:a=!1,dataTestId:i="",allowDirectInput:s=!1,className:n,halfWidth:r,dropdownMaxHeight:l,alignItemsLeft:d,addNewVoiceOptionEnabled:c,disabled:u})=>{const m=h.useRef(null),p=h.useRef(null),[g,f]=h.useState(!1),[y,v]=h.useState(!1),[_,b]=h.useState(!1),[T,x]=h.useState(""),S=h.useRef((()=>{})),[E,I]=h.useState(null),C=t.find((t=>t.value.toString()===e.toString())),k=!!C&&!!C.iconUrl,A=C?C.label:e,j=null===E?e:E,N=NU(Bl.CLONED_VOICES),R=wQ();let P=g?`${OW.selectDropDownDisplay} ${OW.selectDropDownShowing}`:OW.selectDropDownDisplay;u&&(P+=` ${OW.selectDropDownDisabled}`),h.useEffect((()=>{g||(m.current.blur(),p.current.blur())}),[g]),h.useEffect((()=>()=>S.current()),[S]);const D=()=>{if(!a||!C)return;const e=t.indexOf(C),i=t[e-1];i&&o(i.value)},O=()=>{if(!a||!C)return;const e=t.indexOf(C),i=t[e+1];i&&o(i.value)},L=()=>{f(!1),v(!1)},F=e=>{o(e),L()},M=h.useCallback((()=>{E&&(o(E),I(null))}),[E,I,o]);S.current=M;const U=h.useCallback((e=>{const t=e.target;I(t.value),e.preventDefault(),e.stopPropagation()}),[I]),B=h.useCallback((e=>{({Tab:O,ArrowUp:D,ArrowDown:O,Escape:L}[e.key]||(()=>{}))(),s||(e.preventDefault(),e.stopPropagation())}),[D,O,L,s]),V=h.useCallback((e=>{"Enter"===e.key&&M()}),[M]),W=R((()=>{!function(){const{dispatch:e}=sr();e(w_(!0)),eE("/studio/editor/voice-cloning")}()}),{[Oc.CLONED_VOICES]:1}),G=h.useCallback((()=>{Fm(ym.VOICE_CLONING_CLICKED,{location:"Text to Speech"}),N?W():TW((()=>null),{action:Vl.CLONED_VOICES,overrideRecommendedUpgrade:Cl.Business})()}),[N,W]);return w.jsxs("div",{"data-cy":"small-control-select-dropdown","data-testid":i,className:`${OW.selectDropDownContainer} ${r&&OW.halfWidth} ${n}`,onKeyDown:B,children:[w.jsxs("div",{role:"button",ref:m,className:P,"data-testid":`${i}__button`,tabIndex:0,onBlur:()=>{y&&!_&&L()},onMouseUp:()=>{u||(g&&y&&!_?L():(f(!0),v(!0)))},children:[k&&("string"==typeof C.iconUrl?w.jsx("img",{className:OW.selectDropDownIcon,style:{width:"30px"},src:C.iconUrl,alt:`${C.value} icon confirm`,"data-testid":`${i}__icon`}):C.iconUrl&&w.jsx(C.iconUrl,{})),s?w.jsx("input",{type:"text",value:j,className:OW.dropdownDirectInput,onBlur:M,onChange:U,onKeyPress:V,"data-testid":`${i}__input`,"data-cy":"small-control-select-dropdown-input"}):w.jsxs("div",{className:OW.selectDropDownLabelContainer,children:[(null==C?void 0:C.flagUrl)&&w.jsx("img",{className:OW.selectDropDownFlag,src:null==C?void 0:C.flagUrl,alt:"flag icon"}),w.jsx("span",{className:OW.selectDropDownLabel,"data-testid":`${i}__label`,children:A}),(null==C?void 0:C.isVoiceClone)&&w.jsx("div",{className:OW.voiceCloneIcon,children:w.jsx(Ze,{})})]}),w.jsx(xt,{className:OW.dropDownButtonIcon,id:"dropdown-button"})]}),w.jsxs("div",{ref:p,className:OW.selectDropDownList,style:{display:g?"block":"none"},tabIndex:-1,onBlur:()=>{y&&!_&&L()},children:[w.jsx("div",{className:OW.selectDropDownListScrollContainer,style:{maxHeight:l},children:t.map(((t,o)=>w.jsx($W,{item:t,value:e,setMouseUp:v,handleConfirm:F,previewCurrentlyPlaying:T,setPreviewCurrentlyPlaying:x,setClickingPreview:b,alignItemsLeft:d},`${t.label}-${o}`)))}),c&&w.jsx("button",{type:"button",className:OW.selectDropDownItemBottomStatic,onMouseDown:()=>v(!1),onMouseUp:e=>{0===e.button&&(v(!0),f(!1),G())},children:w.jsxs("div",{className:OW.selectDropDownLabelContainer,children:[w.jsx("div",{className:OW.dropDownAddIcon,children:w.jsx(St,{})}),w.jsx("span",{className:OW.selectDropDownLabel,children:"Add new Voice"}),!N&&w.jsx(EW,{})]})})]})]})})),TQ={color:"#6E7077"};_.memo((({icon:e,label:t,onIconClick:o})=>{if(!e)return null;const a=`${t.toUpperCase().replace(/ /g,"-").replace(/[:#]/g,"")}-icon`;if("loadingIcon"===e)return w.jsxs("div",{className:OW.iconAndLabelRow,"data-cy":"icon-and-label",children:[w.jsx("div",{style:{width:"30px",display:"flex",justifyContent:"center"},children:w.jsx(BW,{className:OW.loadingIcon})}),w.jsx(WW,{style:TQ,children:"Volume"})]});return w.jsxs("div",{className:OW.iconAndLabelRow,"data-cy":"icon-and-label",children:[w.jsx("div",{style:{width:"30px",display:"flex",justifyContent:"center",cursor:o?"pointer":"inherit"},onClick:o,"data-cy":a,children:function(){if(!e)return null;if(null==e?void 0:e.render)return e.render();switch(typeof e){case"string":return w.jsx("img",{src:e,className:OW.bigOverlayButtonIcon,alt:"","data-testid":"icon-and-label-row__image-icon"});case"function":return w.jsx("div",{className:OW.bigOverlayButtonIcon,"data-testid":"icon-and-label-row__component-icon",children:e({})});default:return e}}()}),w.jsx(WW,{children:t})]})}));const xQ="MenuMessage-module_menuMessage_AIVAN",SQ=_.memo((({text:e})=>w.jsxs(w.Fragment,{children:[w.jsx(LW,{}),w.jsx("div",{className:xQ,children:e})]}))),EQ=_.forwardRef((({containerStyle:e,dataTestId:t,decrement:o,disableDecrement:a=!1,disableIncrement:i=!1,extraSmallTheme:s=!1,increment:n,incrementDecrementValueStyles:r,lightTheme:l=!1,smallTheme:d,symbol:c,value:u},m)=>{const p=h.useRef(null),g=h.useRef(0),f=h.useRef(a),y=h.useRef(i),v=h.useRef(o),_=h.useRef(n);let b=OW.incrementDecrementControl,T=OW.incrementDecrementControlValue,x=OW.incrementDecrementButton,S=OW.controlButtonOnlyIcon;d||s?(b=s?OW.incrementDecrementControlExtraSmallTheme:OW.incrementDecrementControlSmallTheme,T=OW.incrementDecrementControlValueSmallTheme,x=OW.incrementDecrementButtonSmallTheme,S=OW.controlButtonOnlyIconRoundedSmallTheme):l&&(b=OW.incrementDecrementControlLightTheme,x=OW.incrementDecrementButtonLightTheme);const E=e=>{I();const t=()=>e?y.current?(I(),!1):(_.current(),!0):f.current?(I(),!1):(v.current(),!0);t()&&(p.current=window.setInterval((()=>{g.current+=1,g.current>=4&&t()}),150))},I=()=>{p.current&&clearInterval(p.current),p.current=null,g.current=0};return h.useEffect((function(){return I}),[]),h.useEffect((function(){f.current=a}),[a]),h.useEffect((function(){y.current=i}),[i]),h.useEffect((function(){_.current=n}),[n]),h.useEffect((function(){v.current=o}),[o]),w.jsxs("div",{className:b,style:e,"data-testid":t,ref:m,children:[w.jsx("div",{className:OW.decrementControl,children:w.jsx("div",{className:a?OW.disabledIncrementDecrementButton:x,onMouseDown:()=>E(!1),onMouseLeave:I,onMouseUp:I,"data-cy":"decrement-control","data-testid":"decrement-control",children:w.jsx("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANIAAAAeCAYAAABZs0CNAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB4SURBVHgB7dyxDcAgAANBiLL/ysAOfEFxJ3mEbz3XMYAb6xvANSFBQEgQEBIEhAQBIUFASBAQEgSEBAEhQUBIEBASBIQEASFBQEgQEBIEhAQBIUFASBAQEgSEBAEhQUBIEBASBIQEASFBQEgQEBIE/jMn+u+bg6dt4RYGOdVsFE0AAAAASUVORK5CYII=",alt:"Decrement",className:S})})}),w.jsxs("div",{className:T,style:r,"data-cy":"increment-decrement-value","data-testid":"increment-decrement-value",children:[w.jsx("span",{children:u}),c&&c]}),w.jsx("div",{className:OW.incrementControl,children:w.jsx("div",{className:i?OW.disabledIncrementDecrementButton:x,onMouseDown:()=>E(!0),onMouseLeave:I,onMouseUp:I,"data-cy":"increment-control","data-testid":"increment-control",children:w.jsx("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMoAAADKCAYAAADkZd+oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKYSURBVHgB7d1BasMwFABRpeRe7U0aerJepReLmkD3HUjkgP0eaG2MPQJt9MdgiTnnZW7ren/mYIm3AfxLKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQHAe8KA559i78+0lL4MVPsa2Trf1/oKf9jT2b57mEbYDeMx0RoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBDcL+l2peoar7qT1/d8vnkP5WuwwsdtfY5tfd/Wz+DZbD6r3KcEzG1dTSZYxxkFAqFAIBQIhAKBUCAQyjpHmG14GEJZwFjM/REKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUBwHqwy/9Zen3cov+TEC2aS5UVtAAAAAElFTkSuQmCC",alt:"Increment",className:S})})})]})})),IQ=_.memo((({children:e,style:t})=>w.jsx("div",{className:OW.controlSectionRow,style:t,children:e}))),CQ={right:0,marginRight:4,top:2.2,height:14},kQ=_.forwardRef((({icon:e,title:t="",label:o="",selected:a=!1,disabled:i=!1,children:s,handleClick:n,labelFont:r,style:l,iconStyle:d,labelFontStyle:c,className:u="",selectedClassName:m="",type:p="",dataCy:g="",dataCyString:f="",dataTestId:y="",hasSparkle:v=!1,isLoading:_=!1,onMouseEnter:b,onMouseLeave:T},x)=>{const S=h.useMemo((()=>{let e=r?{fontFamily:r}:{};return c&&(e={...e,...c}),e}),[r,c]);let E;E=g||(f?`${f.replace(/ /g,"-").replace(/[:#]/g,"")}-small-control-button`:o&&"string"==typeof o?`${o.replace(/ /g,"-").replace(/[:#]/g,"")}-small-control-button`:p?`${p}-small-control-button`:"small-control-button");let I=`${OW.smallControlButton}`;return i?I=`${OW.smallControlButton} ${OW.smallControlButtonDisabled}`:a&&(I=`${OW.smallControlButton} ${OW.smallControlButtonSelected}`,m&&(I+=` ${m}`)),u&&(I+=` ${u}`),w.jsxs("div",{ref:x,"data-cy":E,"data-cy-selected":!!a,"data-testid":y,className:I,onMouseEnter:b,onMouseLeave:T,onClick:()=>{i||n&&n()},style:l,children:[s,"string"==typeof e?w.jsx("img",{src:e,alt:t,className:o?OW.controlButtonIcon:OW.controlButtonOnlyIcon,style:d,"data-testid":"small-control-button__image-icon"}):"function"==typeof e?w.jsx("div",{className:o?OW.controlButtonIcon:OW.controlButtonOnlyIcon,style:d,"data-testid":"small-control-button__icon",children:e({})}):"object"==typeof e?e:null,o&&w.jsx(WW,{style:S,children:_?w.jsxs(w.Fragment,{children:[w.jsx(BW,{className:OW.loadingIcon,style:CQ}),o]}):o}),v&&w.jsx(EW,{})]})})),AQ=.2,jQ=_.memo((e=>{var t,o;const{selectedLayers:a}=e,i=tl((e=>e.studioLocal.layerTempValues)),s=a[0];if(!s)return null;const n=0===a.length?.2:s.textBlur;let r=null==(t=i[s.id])?void 0:t.textBlurTemp;for(let c=1;c<a.length;c+=1){const e=a[c];if(!e)continue;const t=null==(o=i[e.id])?void 0:o.textBlurTemp;if(!t||r!==t){r=void 0;break}}const l=r||n||.2,d=ff.withUndoBatch(((e,t)=>{const o={},i={};a.forEach((a=>{t?(i[a.id]={textBlurTemp:null},o[a.id]={textBlur:e}):i[a.id]={textBlurTemp:e}})),FE(i),OI(o,"TextBlurControls.tsx",!0)}));return w.jsx("div",{children:w.jsx(UW,{title:"Blur",children:w.jsx(Md,{min:0,max:1,defaultValue:l,step:.01,onSliderChange:d})})})})),NQ=m((e=>e.activeEditors),(e=>gR(e)),((e,t)=>t.map((e=>e.id)).some((t=>{var o;const a=null==(o=e[t])?void 0:o.editor;return null!=a&&(!a.getSelection().isCollapsed()&&!SO(a))})))),RQ=m((e=>e.activeEditors),(e=>gR(e)),((e,t)=>{var o,a;const i=t.map((e=>e.id)),n=Object.values(s.pick(e,i)).filter((e=>e)).map((e=>{const t=e.editor,o=t.getSelection(),a={uniqueStyles:t.getCurrentInlineStyle(),allStyles:t.getCurrentInlineStyle()};if(o.isCollapsed())return a;const i=[...TO(t.getCurrentContent(),o)].map((e=>e.getStyle()));return a.uniqueStyles=a.uniqueStyles.intersect(...i),a.allStyles=a.uniqueStyles.union(...i),a})),r=n.map((e=>e.allStyles)),l=n.map((e=>e.uniqueStyles));return n.length>0?{allStyles:(null==(o=r[0])?void 0:o.union(...r).toArray())||[],uniqueStyles:(null==(a=l[0])?void 0:a.intersect(...l).toArray())||[]}:{allStyles:[],uniqueStyles:[]}})),PQ=m(RQ,(e=>{const t=e.uniqueStyles.find((e=>e.startsWith("COLOR")));if(t)return t.split("_")[1]})),DQ=e=>m((t=>{var o;return null==(o=t.studio.keyframing)?void 0:o[e]}),(e=>{const t=[];return e?(Object.values(e).forEach((({keyframes:e})=>{t.push(...e)})),t.sort(((e,t)=>e.time-t.time))):t})),OQ=e=>m((t=>{var o;return null==(o=t.studio.keyframing)?void 0:o[e||""]}),(t=>{var o;return null==(o=t.studioLocal.layerTempValues[e||""])?void 0:o.keyframe}),((e,t)=>{if(!e&&!t)return e;const o={...e};return t&&(o[t.channel]={bezArray:null,keyframes:[t]}),o})),LQ=(e,t,o,a)=>{let i=t/o;return"outro"===e.type&&(i=a<=o?a/o:1),i},FQ=e=>({[Yl.MagicFade]:{maxAnimationThreshold:.15,minAnimationThreshold:.35,overlapPercent:.6},[Yl.MagicFlip]:{maxAnimationThreshold:.01,minAnimationThreshold:.19,overlapPercent:0},[Yl.MagicPop]:{maxAnimationThreshold:.01,minAnimationThreshold:.19,overlapPercent:0}}[e]||{maxAnimationThreshold:void 0,minAnimationThreshold:void 0,overlapPercent:0}),MQ=(e,t)=>{const{overlapPercent:o}=FQ(e),a=((e,t)=>{let o=t;if(!o){const{state:e}=sr(),t=IA()(e);o=(null==t?void 0:t.transitionSpeed)||50}const{maxAnimationThreshold:a,minAnimationThreshold:i}=FQ(e);return a&&i?a+(100-o)/100*(i-a):0})(e,t);return{transitionOverlapDuration:o*a,transitionDuration:a}};function UQ(e,t=""){const{state:o}=sr(),{scenes:a,animations:i}=o.studio,s=bE();let n={};const r=Mx(e),l=r.find((e=>"intro"===e.type)),d=r.find((e=>"outro"===e.type)),c=r.find((e=>"constant"===e.type)),{start:u,end:m}=e.isTrimmed?cm(e):cm(e,a[0].duration),p=s-u,h=l?{start:0,end:ex(l,i)}:void 0,g=d?{start:m-ex(d,i)-u,end:m-u}:void 0;if(c){const o=c,a=o.id===Yl.ProgressBar&&void 0!==e.endTime&&void 0!==e.startTime?e.endTime-e.startTime:ex(o,i),s=LQ(o,p,a,m-p);n={...n,...o.animationFunc(s,e,t)}}if(l&&h&&p>=h.start&&p<=h.end){const o=l,a=ex(o,i),s=LQ(o,p,a,h.end-p);n={...n,...o.animationFunc(s,e,t)}}if(d&&g&&p>=g.start&&p<=g.end){const o=d,a=ex(o,i),s=LQ(o,p,a,g.end-p);n={...n,...o.animationFunc(s,e,t)}}return n}function BQ(e,t=!0,o="",a){const{state:i}=sr(),{animations:s}=i.studio,n=bE();if(!a||"none"===a.type)return{};const{start:r,end:l}=cm(e);if(((e,t)=>e&&t<e)(r,n))return{};const d=n-l>=0;if("outro"===a.type&&l&&d)return{};const c=ex(a,s);let u=n;r&&(u-=r);let m=l-n;if("video"===e.type&&(m=l-n),"outro"===a.type&&m<=c&&(u=m),"intro"===a.type&&u>c||"outro"===a.type&&n<l-c)return{};const p=LQ(a,u,c,m);return a.animationFunc(p,e,o)}function VQ(e,t){const o=t.position||{};o&&delete t.position;const a={...e,...t,...o};return e.WebkitFilter&&t.WebkitFilter&&(a.WebkitFilter=`${t.WebkitFilter} ${e.WebkitFilter}`),e.filter&&(a.WebkitFilter?a.WebkitFilter+=` ${e.filter}`:a.WebkitFilter=e.filter),e.transform&&t.transform&&(a.transform=`${t.transform} ${e.transform}`),a}const WQ={home:"Layers-module_home_eIN3r",homeHowBackgroundWhite:"Layers-module_homeHowBackgroundWhite_rb29a",largeButton:"Layers-module_largeButton_3zzBV",sectionContent:"Layers-module_sectionContent_dmXy-",sectionHeader:"Layers-module_sectionHeader_uxUJJ",spacer:"Layers-module_spacer_dIOWH",chevron:"Layers-module_chevron_iKP4Q",splashText:"Layers-module_splashText_SYRhV",splashSubtext:"Layers-module_splashSubtext_t05-J",aboutSection:"Layers-module_aboutSection_YUNOE",mobile:"Layers-module_mobile_-DSoC",desktop:"Layers-module_desktop_SEDkV",screenReaderOnlyLabel:"Layers-module_screenReaderOnlyLabel_k-yab",disabled:"Layers-module_disabled_1IFRh",noScrollBar:"Layers-module_noScrollBar_IoLzq",textOverflowEllipsis:"Layers-module_textOverflowEllipsis_dvJ1n",disableTextHighlight:"Layers-module_disableTextHighlight_SCpz-",genericButtonBlue:"Layers-module_genericButtonBlue_h0jOj",button:"Layers-module_button_UGm-3",buttonDisabled:"Layers-module_buttonDisabled_6clj6",buttonSelected:"Layers-module_buttonSelected_5uykv",buttonOk:"Layers-module_buttonOk_VnebN",buttonStacked:"Layers-module_buttonStacked_KbIbL",doneButton:"Layers-module_doneButton_SZkk8",desktopNoWrap:"Layers-module_desktopNoWrap_jXks7",mobileNoWrap:"Layers-module_mobileNoWrap_PSBLH",controlSectionContainer:"Layers-module_controlSectionContainer_iJnhC",section:"Layers-module_section_73NJu",input:"Layers-module_input_8a5sX",cyanDoneButton:"Layers-module_cyanDoneButton_g7SAY",cyanDoneButton__disabled:"Layers-module_cyanDoneButton__disabled_U-sXV",cyanDoneButtonContainer:"Layers-module_cyanDoneButtonContainer_oPPdA",genericButton:"Layers-module_genericButton_N-77G",genericButtonSelected:"Layers-module_genericButtonSelected_89ylV",groupControlContainer:"Layers-module_groupControlContainer_khEqy",controlSectionRows:"Layers-module_controlSectionRows_OgJiT",controlSectionRowsTimeline:"Layers-module_controlSectionRowsTimeline_FGf-l",controlSectionRowsTwoPerRow:"Layers-module_controlSectionRowsTwoPerRow_bOVvt",controlSectionRowsExpandChildren:"Layers-module_controlSectionRowsExpandChildren_KnIwL",controlSectionRowsFullWidth:"Layers-module_controlSectionRowsFullWidth_D95Mb",controlSectionRowsNoWrap:"Layers-module_controlSectionRowsNoWrap_hRBLQ",controlSectionRowsNoPadding:"Layers-module_controlSectionRowsNoPadding_Cd84c",controlSectionRowsIconAndControl:"Layers-module_controlSectionRowsIconAndControl_UHK7p",controlSectionWrapColumns:"Layers-module_controlSectionWrapColumns_DwVNt",controlSectionScrollableColumn:"Layers-module_controlSectionScrollableColumn_DCxia",controlSectionTitle:"Layers-module_controlSectionTitle_1MSgo",controlSectionTitleNoPadding:"Layers-module_controlSectionTitleNoPadding_etFGZ",controlSectionDescription:"Layers-module_controlSectionDescription_vvbCv",smallControlButton:"Layers-module_smallControlButton_mGAE9",smallControlButtonDisabled:"Layers-module_smallControlButtonDisabled_MvAbH",smallControlButtonSelected:"Layers-module_smallControlButtonSelected_HeOvT",smallControlButtonLabel:"Layers-module_smallControlButtonLabel_u3hA1",controlSectionRow:"Layers-module_controlSectionRow_So3m0",controlButtonIcon:"Layers-module_controlButtonIcon_R2q6T",controlButtonOnlyIcon:"Layers-module_controlButtonOnlyIcon_EjuTV",controlButtonOnlyIconRoundedSmallTheme:"Layers-module_controlButtonOnlyIconRoundedSmallTheme_v8T75",bigOverlayButton:"Layers-module_bigOverlayButton_RKdLd",glimmer:"Layers-module_glimmer_1nVoO",pulse:"Layers-module_pulse_PzjTF",bigOverlayButtonSelected:"Layers-module_bigOverlayButtonSelected_Ay5XD",bigOverlayButtonDisabled:"Layers-module_bigOverlayButtonDisabled_cZYv2",bigOverlayButtonIcon:"Layers-module_bigOverlayButtonIcon_82U6a",incrementDecrementControl:"Layers-module_incrementDecrementControl_iv74b",incrementDecrementControlLightTheme:"Layers-module_incrementDecrementControlLightTheme_lG9xA",incrementDecrementControlSmallTheme:"Layers-module_incrementDecrementControlSmallTheme_6St8L",incrementDecrementControlExtraSmallTheme:"Layers-module_incrementDecrementControlExtraSmallTheme_XJ3hW",incrementDecrementButton:"Layers-module_incrementDecrementButton_JdGi4",incrementDecrementButtonLightTheme:"Layers-module_incrementDecrementButtonLightTheme_92-O7",incrementDecrementButtonSmallTheme:"Layers-module_incrementDecrementButtonSmallTheme_Ojws-",incrementDecrementControlValue:"Layers-module_incrementDecrementControlValue_ZBawM",incrementDecrementControlValueSmallTheme:"Layers-module_incrementDecrementControlValueSmallTheme_nRXeL",incrementControl:"Layers-module_incrementControl_F2k0o",decrementControl:"Layers-module_decrementControl_3BAXX",disabledIncrementDecrementButton:"Layers-module_disabledIncrementDecrementButton_HY2MJ",tooltip:"Layers-module_tooltip_wHlTl",selectDropDownContainer:"Layers-module_selectDropDownContainer_HY2IM",selectDropDownDisplay:"Layers-module_selectDropDownDisplay_fghtC",selectDropDownDisabled:"Layers-module_selectDropDownDisabled_otL-H",selectDropDownLabel:"Layers-module_selectDropDownLabel_74Z7M",selectDropDownLabelContainer:"Layers-module_selectDropDownLabelContainer_NwmRQ",selectDropDownFlag:"Layers-module_selectDropDownFlag_7NYAU",proSparkle:"Layers-module_proSparkle_5m4Y6",selectDropDownLink:"Layers-module_selectDropDownLink_Xf9fy",selectDropDownList:"Layers-module_selectDropDownList_ftwm6",selectDropDownListScrollContainer:"Layers-module_selectDropDownListScrollContainer_ZvyWJ",selectDropDownItem:"Layers-module_selectDropDownItem_spfT6",selectDropDownItemLeft:"Layers-module_selectDropDownItemLeft_jYVYw",selectDropDownItemBottomStatic:"Layers-module_selectDropDownItemBottomStatic_YYXw-",voiceCloneIcon:"Layers-module_voiceCloneIcon_JNFMZ",bottomDivider:"Layers-module_bottomDivider_UBaV8",selectDropDownItemSelected:"Layers-module_selectDropDownItemSelected_Ww2JN",selectDropDownShowing:"Layers-module_selectDropDownShowing_niCYf",dropDownButtonIcon:"Layers-module_dropDownButtonIcon_ascFz",selectOptionIcon:"Layers-module_selectOptionIcon_-JNSK",dropDownAddIcon:"Layers-module_dropDownAddIcon_osGQX",selectDropdownItemPreview:"Layers-module_selectDropdownItemPreview_3Hfq-",selectDropDownItemPlayIcon:"Layers-module_selectDropDownItemPlayIcon_nGXiS",transparentSelectInput:"Layers-module_transparentSelectInput_oAixw",selectOptionContainer:"Layers-module_selectOptionContainer_BotTo",dropDownHeader:"Layers-module_dropDownHeader_4kW21",noMargin:"Layers-module_noMargin_k-KXh",halfWidth:"Layers-module_halfWidth_OM7Wh",fullWidth:"Layers-module_fullWidth_gj82w",selectDropDownIcon:"Layers-module_selectDropDownIcon_A-RSe",controlButtonsContainer:"Layers-module_controlButtonsContainer_fbWKw",loadingIcon:"Layers-module_loadingIcon_CFsaY",spin:"Layers-module_spin_HVCp8",iconAndLabelRow:"Layers-module_iconAndLabelRow_VnALb",dropdownDirectInput:"Layers-module_dropdownDirectInput_CmtsB",backgroundTransparencyGrid:"Layers-module_backgroundTransparencyGrid_5rUUz",background:"Layers-module_background_8DMmp",border:"Layers-module_border_ueUs2",disableselect:"Layers-module_disableselect_E-qba",text:"Layers-module_text_um0Ln",imageContainer:"Layers-module_imageContainer_eCzlm",image:"Layers-module_image_Ef6KM",videoContainer:"Layers-module_videoContainer_z7Msk",video:"Layers-module_video_Tqu1w",videoConversion:"Layers-module_videoConversion_hiekj",outline:"Layers-module_outline_OSXmE",editorWrapperEditing:"Layers-module_editorWrapperEditing_W3B0C",svgContainer:"Layers-module_svgContainer_fPoIR",svgLine:"Layers-module_svgLine_IVz1N"},GQ=_.memo((({width:e,height:t,editorWidth:o,editorHeight:a,textWithLineBreaks:i,fontSize:s,textScale:n,layer:r,animStyles:l,viewOnly:d})=>{const c=h.useRef(),{borderRadiusTemp:u,globalAlphaTemp:m,textPaddingTemp:p}=tl((e=>e.studioLocal.layerTempValues[r.id]))||{},{relative:g=0}=u||r.borderRadius||{},f=r.textTransform||"none";let y=i||"";"uppercase"===f?y=y.toLocaleUpperCase():"lowercase"===f&&(y=y.toLocaleLowerCase());const v=r.backgroundColor,_="wrap"===r.wrapOrFill,b=g||"0%",T=r.textAlign||"center",x=GC(r),S=r.italic?"italic":"normal",{fontWeight:E}=r,I=m??r.globalAlpha,C=p??r.textPadding??0,k=_?a/y.split("\n").length:Math.min(e,t),A=C*k/100,j=A;return h.useEffect((function(){if(!c.current)return;const o=c.current;o.width=e+A+A+j+j,o.height=t+A+A+j+j;const a=o.getContext("2d");if(!a)return;if(e<=0&&t<=0)return;const i=window.devicePixelRatio;o.width*=i,o.height*=i,a.scale(i,i),a.save(),a.clearRect(0,0,o.width,o.height),a.globalAlpha=l.opacity?+l.opacity:I,a.translate(A+j,A+j),a.font=`${S} normal ${E} ${s}px ${x}`;let d=[];if(r.isMagicSubtitle){const e=r;d=e.frame.lines.map((t=>[t.words.map((e=>e.text)).join(e.wordSeparator),t.width]))}else{d=y.replaceAll("\r","").split("\n").map((e=>[e,a.measureText(e).width*n]))}const u=d.map((([e,t])=>t)),m=t/d.length;_?aA(a,u,s,r,e,t,m,0,b,C):tA(a,r,e,t,b,C),a.restore()}),[y,v,_,e,t,o,a,T,f,b,s,x,E,S,n,I,r,A,C,j,null==l?void 0:l.opacity]),w.jsx("canvas",{"data-cy":d?"text-background-view-only":"text-background",style:{width:e+A+A+j+j,height:t+A+A+j+j,position:"absolute",top:0,left:0,marginTop:-A-j,marginLeft:-A-j,transformOrigin:"0px 0px",...l},ref:e=>{e&&(c.current=e)}})}));let HQ;const $Q=_.memo((({style:e,layer:t,studioTime:o})=>{var a,i;const s=h.useRef(null),{animationName:n="",wordByWordStyles:r={}}=t.wordByWordAnimations||{},{active:l,unspoken:d}=r[n]||{},c=tl((e=>e.studioLocal.magicSubtitleSelection)),u=c&&c.cleanSelectionStart!==c.cleanSelectionEnd,m=h.useMemo((()=>{if(""===t.wordSeparator)return 0;const e=HC(t,t.fontSize),o=function(e,t){HQ||(HQ=document.createElement("canvas"));const o=HQ.getContext("2d");return o.font=t,o.measureText(e).width}(t.wordSeparator,e);return Math.floor(o)}),[t]),p=((null==(a=t.position)?void 0:a.rotation)?m:(null==(i=s.current)?void 0:i.getBoundingClientRect().width)||m)/2,{lines:g}=t.frame;return w.jsx("span",{children:g.map(((a,i)=>w.jsxs("span",{style:{...e,display:"block",whiteSpace:"nowrap"},className:"magic-text__line",dir:t.isRTL?"rtl":"ltr",children:[0===a.words.length&&w.jsx("span",{style:{paddingLeft:p,paddingRight:p,zIndex:i}}),a.words.map(((e,m)=>{var h,g;const{styles:f,className:y,isActive:v,isUnspoken:b}=((e,t,o,a)=>{const{active:i,spoken:s,unspoken:n,inactive:r}=t||{},l=o<e.start,d=o>=e.start,c=!!a&&o>=e.start&&o<e.end,u=[];let m={position:"relative"};return!c&&(u.push("magic-text__inactive"),m={...m,...r}),l&&(u.push("magic-text__unspoken"),m={...m,...n}),d&&(u.push("magic-text__spoken"),m={...m,...s}),c&&(u.push("magic-text__active"),m={...m,...i}),{styles:m,className:u.join(" "),isActive:c,isUnspoken:l}})(e,r[n]||{},o,n),T=0===m,x=m===a.words.length-1,S=t.isRTL?T:x;let E={};const I=t.isRTL?m-1:m+1,C=a.words[I];if(!S&&t.wordSeparator&&C){const o=t.isRTL?C.text.length-1:0,a=null==(h=null==C?void 0:C.styles)?void 0:h[o],i=t.isRTL?0:e.text.length-1,s=null==(g=e.styles)?void 0:g[i];E=Jk(t,s,a),v&&(E.bottom=(null==d?void 0:d.bottom)||0,E.color=(null==E?void 0:E.color)||t.color),!u&&b&&(null==d?void 0:d.color)&&ty(d.color)&&(E.color="transparent")}const k=o=>{const a="start"===o?e.charOffset-1:e.charOffset+e.text.length+1,n=c&&c.cleanSelectionStart<a&&c.cleanSelectionEnd>=a;return w.jsx("span",{className:"magic-text__word-separator",ref:s,style:{...f,...E,display:"initial",borderRadius:0,backgroundColor:"transparent",zIndex:i+1,...n?{backgroundColor:"rgba(80, 108, 147, 0.9)"}:{}},children:w.jsx("span",{children:t.wordSeparator})},`line-${m}-separator`)};return w.jsxs(_.Fragment,{children:[t.isRTL&&!T&&t.wordSeparator&&k("start"),w.jsx("span",{style:{...f,marginLeft:-p,marginRight:-p,paddingLeft:p,paddingRight:p,zIndex:i},className:`magic-text__word ${y}`,children:e.splitTextByStyle.map(((e,o)=>{var a,i;const s=e.styles||{index:-1},n={...f,...s,color:v&&!e.isSelected&&(null==l?void 0:l.color)?f.color:s.color||f.color,borderRadius:0,backgroundColor:void 0,bottom:"unset"};t.underline&&"none"!==s.textDecoration&&(n.textDecoration="underline"),!u&&b&&(null==d?void 0:d.color)&&ty(d.color)&&(n.color="transparent"),u&&"transparent"===n.color&&(n.color=s.color||t.color);const r=[];e.isSelected&&(n.backgroundColor="rgba(80, 108, 147, 0.9)");const c=n.color&&ty(n.color),p="none"!==f.textShadow&&!c;c&&(n.textShadow="none");const h=(null==(a=t.textOutline)?void 0:a.color)&&ty(null==(i=t.textOutline)?void 0:i.color);return w.jsxs(_.Fragment,{children:[t.textOutline&&!h&&w.jsx("span",{style:{...n,WebkitTextStroke:p?`${Bk(t,t.fontSize)}px ${t.textOutline.color}`:void 0,position:"absolute"},className:`magic-text__char ${r.join(" ")}`,children:e.text}),w.jsx("span",{style:n,className:`magic-text__char ${r.join(" ")}`,children:e.text})]},`line-${m}-${o}`)}))},`line-${m}`),!t.isRTL&&!x&&t.wordSeparator&&k("end")]},`line-${m}`)}))]},`line-${i}`)))})})),KQ=()=>{},zQ=s.memoize(TS),YQ=e=>e&&["middleLeft","middleRight"].includes(e);let JQ=(t=class extends h.Component{constructor(e){super(e),i(this,"editor",_.createRef()),i(this,"hiddenEditorContainer",_.createRef()),i(this,"hiddenEditor",_.createRef()),i(this,"container",_.createRef()),i(this,"_mounted",!1),i(this,"selectionIndices",null),i(this,"tmpInput",null),i(this,"backspacePressed",!1),i(this,"backspaceLinebreakPressed",!1),i(this,"clickCount",0),i(this,"clickTimeout",null),i(this,"previousSelectionIndices"),i(this,"checkedForOutsideCanvas",!1),i(this,"cursorHistory",{current:-1,undoStack:[],redoStack:[]}),i(this,"customStyleMap",{}),i(this,"shouldUpdateTextBlocks",!1),i(this,"undoFocusLock",!1),i(this,"moveCursorToEnd",!1),i(this,"latestTextWithLineBreaks"),i(this,"addMountedActionToQueue",(e=>{null==t.editorMountedActionsTimeout&&(t.editorMountedActionsTimeout=setTimeout((()=>{t.editorMountedActionsTimeout=null,t.editorMountedActions.length>0&&(this.props.mountActiveEditors(t.editorMountedActions),t.editorMountedActions=[])}),0)),t.editorMountedActions.push(e)})),i(this,"addUnmountedActionToQueue",(e=>{null==t.editorUnmountedActionsTimeout&&(t.editorUnmountedActionsTimeout=setTimeout((()=>{t.editorUnmountedActionsTimeout=null,t.editorUnmountedActions.length>0&&(this.props.unmountActiveEditors(t.editorUnmountedActions),t.editorUnmountedActions=[])}),0)),t.editorUnmountedActions.push(e)})),i(this,"recomputeTextWithLineBreaks",(e=>{const{layer:t,width:o,height:a}=this.props;if(t.isMagicSubtitle)return;const i=e||t.fontSize||1,{baseWidth:s}=t,n=iJ(o,s)*i,{textWithLineBreaks:r}=rJ(t,o,t.text,n),l=(t.lineHeight||1)*n,d=r.split("\n").length*l,c=t.text!==r,u=d>1&&a!==d;if(c&&(OI({[t.id]:{text:r,textWithLineBreaks:r}},"Text.tsx"),LE(t.id,{textTemp:r})),c||u){const e=QE(t);if(e){const o=e.height-d,a=e.y+o/2,i={...e,y:a,height:d};XE(t,i)}}})),i(this,"parseEditorSize",(()=>{if(!(this.hiddenEditorContainer.current&&this.hiddenEditor.current&&this.container.current&&this._mounted))return null;const e=this.container.current.style.transform;this.container.current.style.transform="none";const t=this.hiddenEditorContainer.current.style.display;this.hiddenEditorContainer.current.style.display="flex";const{width:o,height:a}=this.hiddenEditor.current.editor.getBoundingClientRect();if(this.container.current.style.transform=e,this.hiddenEditorContainer.current.style.display=t,!o||!a)return null;return{editorWidth:o,editorHeight:a}})),i(this,"handleSelectionState",(e=>{if(this.previousSelectionIndices&&!SO(e)){const[t,o]=this.previousSelectionIndices;if(t<o){const a=e.getCurrentContent(),i=CO(a,t,o);if(i){const{isEditing:t,layer:o}=this.props;return t||LE(o.id,{isEditing:!0}),re.EditorState.forceSelection(e,i)}}}return e})),i(this,"updateLayerHeightForText",((e,t,o)=>{const{fontSizingTemp:a,layer:i,width:s,y:n}=this.props,r=QE(i),l=r?iJ(i.baseWidth,r.width):1,d=((null==a?void 0:a.fontSize)||i.fontSize||1)/l,c=(i.lineHeight||1)*d,u=e.split("\n").length*c;if(r){const e={...r,width:s,height:u,y:n};XE(i,e,t,o)}return u})),i(this,"handleEditorTextChange",((e,t,o)=>{if(o===this.latestTextWithLineBreaks)return t;this.latestTextWithLineBreaks=o;const{beingTransformed:a,isEditing:i}=this.props,s=t.getUndoStack().size,n=null==e?void 0:e.getUndoStack().size,r=!a&&i&&(!!n&&s===n-1),l=t.getRedoStack().size,d=null==e?void 0:e.getRedoStack().size,c=!!d&&l===d-1,u=!!this.tmpInput||!!this.backspacePressed,m=!a&&i&&c&&!u;"Sample text"===o.replaceAll("\r","").replaceAll("\n","")&&(this.moveCursorToEnd=!0);const p=this.updateEditorTextWithLineBreaks(t,o,r,m);return!a&&i&&this.updateLayerHeightForText(o,!0),p})),i(this,"updateEditorTextWithLineBreaks",((e,t,o,a)=>{var i;const{isEditing:s,isSelected:n}=this.props,r=kO(e);let l=((e,t)=>{const o=e.getCurrentContent(),a=xO(o);return re.Modifier.replaceText(o,a,t)})(e,t);const d=l.getPlainText(),c=e.getCurrentContent(),u=TO(c,xO(c)),m=e=>["\n","\r"].includes(e),p="\n"===this.tmpInput;let h=0;for(let y=0;y<r.length;y+=1){const e=r.charAt(y);let t=0;p&&this.selectionIndices&&this.selectionIndices[0]<=y&&(t=-1);let o=Math.max(y+t,0);if(o>=u.length&&(o=u.length-1),h>=d.length)break;let a=d.charAt(h);for(;m(a)&&h<d.length-1;){if(o-1>=0){u[o-1].getStyle().toArray().forEach((e=>{l=jO(l,h,e)}))}h+=1,a=d.charAt(h)}const i=u[o];if(i&&a===e){i.getStyle().toArray().forEach((e=>{l=jO(l,h,e)})),h+=1}}const g=this.props.layer.color;l=AO(l,`COLOR_${g}`);let f=re.EditorState.push(e,l,"insert-characters");if((o||a||this.backspacePressed)&&(f=re.EditorState.set(f,{undoStack:e.getUndoStack(),redoStack:e.getRedoStack()})),YQ(this.props.nodePosition)||!s&&!n||this.moveCursorToEnd)f=re.EditorState.moveSelectionToEnd(f),this.moveCursorToEnd=!1;else if(this.selectionIndices&&!o&&!a&&s){let e=(null==(i=this.tmpInput)?void 0:i.length)||0,o=this.selectionIndices[0];if(o>0&&!p){const e=(e=>e.replaceAll("\r\n","").replaceAll("\n",""))(r.substring(0,o));let a=0;for(let i=0;i<t.length&&a<e.length;i+=1){m(t.charAt(i))||(o=i+1,a+=1)}}if(this.backspacePressed)for(;o<this.selectionIndices[0];){if(!m(t.charAt(o)))break;o+=1}else if(p)o+=1;else for(;e>0;){m(t.charAt(o))||(e-=1),o+=1}o=Math.min(o,t.length),f=IO(f,o),this.cursorHistory.undoStack.push(this.cursorHistory.current),this.cursorHistory.redoStack=[],this.cursorHistory.current=o}else if(s){let e=-1;o&&this.cursorHistory.undoStack?(this.cursorHistory.redoStack.push(this.cursorHistory.current),e=this.cursorHistory.undoStack.pop()):a&&this.cursorHistory.redoStack&&(this.cursorHistory.undoStack.push(this.cursorHistory.current),e=this.cursorHistory.redoStack.pop()),e<0&&(e=t.length);const i=Math.min(e,t.length);f=IO(f,i),this.cursorHistory.current=i}return this.selectionIndices=null,this.tmpInput=null,this.backspacePressed=!1,this.backspaceLinebreakPressed=!1,f})),i(this,"getCurrentPosition",(()=>{const{x:e,y:t,width:o,height:a,rotation:i}=this.props,{xPercent:s,yPercent:n}=qE(e,t),{widthPercent:r,heightPercent:l}=zE(o,a);return{x:s,y:n,width:r,height:l,rotation:i||0}})),i(this,"updateTextBlocks",(()=>{if(this.props.viewOnly)return void(this.shouldUpdateTextBlocks=!1);if(!(this.container.current&&this.hiddenEditorContainer.current&&this.props.editorState&&this._mounted))return;const e=this.container.current.style.transform;this.container.current.style.transform="none";const t=this.hiddenEditorContainer.current.style.display;this.hiddenEditorContainer.current.style.display="flex";const o=Ak(this.container.current,this.hiddenEditorContainer.current);this.container.current.style.transform=e,this.hiddenEditorContainer.current.style.display=t;if(o.some((e=>Object.values(e.position).some((e=>null==e||Number.isNaN(e))))))return;const a=JSON.stringify(this.props.layer.textBlocks),i=JSON.stringify(o);this.shouldUpdateTextBlocks=!1,a!==i&&OI({[this.props.layer.id]:{textBlocks:o}},"Text.tsx",!1)})),i(this,"refreshEditorState",(e=>{const{layer:t,editorState:o}=this.props;if(null!=o&&"refresh"!==e){const a=this.convertLayerToContentState(t);return re.EditorState.push(o,a,e)}return this.getEditorStateFromLayer(t)})),i(this,"getEditorStateFromLayer",(e=>{const t=re.EditorState.createWithContent(this.convertLayerToContentState(e));return re.EditorState.set(t,{allowUndo:!0})})),i(this,"convertLayerToContentState",(e=>{const{isCanvasPreview:t,viewOnly:o}=this.props;if(e.draftJSTextTree)return re.convertFromRaw(e.draftJSTextTree);let a=re.ContentState.createFromText(e.text);if(t)return a;const i=xO(a);return"bold"===e.fontWeight&&(a=re.Modifier.applyInlineStyle(a,i,"BOLD")),e.italic&&(a=re.Modifier.applyInlineStyle(a,i,"ITALIC")),e.underline&&(a=re.Modifier.applyInlineStyle(a,i,"UNDERLINE")),e.color&&(a=re.Modifier.applyInlineStyle(a,i,`COLOR_${e.color}`)),t||e.isMagicSubtitle||o||OI({[e.id]:{draftJSTextTree:re.convertToRaw(a)}},"Text.tsx"),a})),i(this,"getRotateWrapperStyles",(()=>{const{width:e,height:t,x:o,y:a,rotation:i}=this.props;return{position:"absolute",left:o,top:a,transform:`rotate(${i}deg)`,width:e,height:t}})),i(this,"getTextStyles",(()=>{var e,t,o;const{layer:a,staticPreview:i,duration:s,globalAlphaTemp:n,viewOnly:r,width:l,height:d,studioTime:c,textBlurTemp:u,textShadowBlurTemp:m,textShadowDistTemp:p,textShadowRotTemp:h,fontSizingTemp:g,magicAssetId:f,keyframeChannels:y}=this.props,[v,_]=this.props.absoluteTimes,{textAlign:w,textBlur:b,textEffect:T,textEffectColor:x,textShadowBlur:S,textShadowDist:E,textShadowRot:I,isMagicSubtitle:C}=a,k=!i&&!(v<=c&&c<=_)&&!C,A=iJ(l,(null==g?void 0:g.baseWidth)||a.baseWidth);let j=.005,{fontSize:N}=g||a;N&&(N*=A,j*=N),j=Math.max(1,j);const R=!!(null==y?void 0:y[vd.OPACITY]);let P=a.globalAlpha;R&&(P=cx(a,y,c).opacity/100),null!=n&&(P=n);let D={position:"absolute",marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto",pointerEvents:r?"none":"unset",fontSize:N,font:HC(a,N,a.fallbackFonts),textAlign:a.textAlign,textTransform:a.textTransform,color:a.color,opacity:P,textDecoration:!a.isMagicSubtitle&&a.underline?"underline":void 0,transform:""};if(a.textShadow?D.textShadow=`-${j}px -${j}px 0 ${a.textShadow}, ${j}px -${j}px 0 ${a.textShadow}, -${j}px ${j}px 0 ${a.textShadow}, ${j}px ${j}px 0 ${a.textShadow}`:D.textShadow="",D.fontDisplay="swap",T){if("dropShadow"===T){const e=m??S,t=p??E??0,o=(h??I??0)*Math.PI/180,a=t*Math.cos(o),i=t*Math.sin(o),s=D.textShadow?", ":"";D.textShadow+=`${s}${a}em ${i}em ${e}em ${x}`}if("textBlur"===T){const{fontSize:e}=a;if(e){const t=.2*e*+(u||b||.2);D.filter=`blur(${t}px)`}}}let O="center";"left"===(null==(e=a.textAlign)?void 0:e.toLowerCase())?O="flex-start":"right"===(null==(t=a.textAlign)?void 0:t.toLowerCase())&&(O="flex-end"),D={...D,display:k?"none":"flex",transformOrigin:"0px 0px",width:l,height:d,alignItems:"center",justifyContent:O};const L=Fx(a);let F={},M=D;if(C||!i&&s&&"none"!==(null==L?void 0:L.id)){F=C?function(e,t,o){const a=o??bE(),{transition:i}=t;if(!i||!i.transitionId)return{};const s=Cx[i.transitionId];return s&&s.animationFunc?s.animationFunc(a,t,e):{}}(f,a,this.props.studioTime):UQ(a);let{transform:e}=D;F&&"transform"in F&&(e=`${D.transform} ${F.transform}`),M=VQ(D,F),M.transform=e}const U={};C&&(U.flexDirection="column",U.justifyContent="center","left"===(null==w?void 0:w.toLowerCase())?U.alignItems="flex-start":"right"===(null==w?void 0:w.toLocaleLowerCase())&&(U.alignItems="flex-end")),R&&(F.opacity=D.opacity);const B={WebkitTextStroke:`${Bk(a,N??0)}px ${null==(o=a.textOutline)?void 0:o.color}`};return a.textOutline&&!a.isMagicSubtitle&&(B.textShadow=M.textShadow,M.textShadow=""),{animTextStyles:M,animStyles:F,rawTextStyles:D,textOutlineStyles:B,magicTextStyles:U}})),i(this,"handleBeforeInput",((e,t)=>{const{isCanvasPreview:o}=this.props;if(o)return"not-handled";const[a,i]=this.selectionIndices||EO(t);return this.selectionIndices||(this.selectionIndices=[a,i]),this.tmpInput=e,"not-handled"})),i(this,"handleClick",(()=>{if(this.clickCount+=1,this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout((()=>{this.clickCount=0}),350),this.clickCount>=3&&(this.clickCount=0,this.props.editorState)){const e=(e=>{const t=e.getCurrentContent(),o=xO(t);return re.EditorState.forceSelection(e,o)})(this.props.editorState);this.props.updateActiveEditor({id:this.props.layer.id,editor:e})}const{layer:e,selectItem:t}=this.props;e.locked&&t(null)})),i(this,"handlePastedText",((e,t,o)=>(this.selectionIndices=EO(o),this.tmpInput=e,"not-handled"))),i(this,"handleEditorChange",(e=>{var t;const{layer:o,textTemp:a,updateActiveEditor:i,fontSizingTemp:s,width:n,editorState:r}=this.props;let l=e,d=kO(l);if(r&&!this.tmpInput){const e=kO(r);if(e.length<d.length&&d.includes("  "))return this.selectionIndices=EO(r),void i({id:o.id,editor:this.updateEditorTextWithLineBreaks(r,e)})}if(r&&this.tmpInput){if(d===kO(r).replace(/\r\n/g,""))return this.moveCursorToEnd=!0,this.selectionIndices=null,this.tmpInput=null,void i({id:o.id,editor:re.EditorState.moveFocusToEnd(r)})}const c=this.selectionIndices&&this.tmpInput,[u,m]=c?this.selectionIndices:EO(l);if(this.selectionIndices=[u,m],r&&(null==(t=this.tmpInput)?void 0:t.includes("\n"))){const e=r.getCurrentContent().getPlainText(),t=e.substring(0,u),o=e.substring(m);d=t+this.tmpInput+o}if(this.backspaceLinebreakPressed){"\r"===d.charAt(u-1)&&u>2&&(d=d.substring(0,u-2)+d.substring(u),this.selectionIndices=[u-2,u-2]),this.backspaceLinebreakPressed=!1}const p=iJ(n,(null==s?void 0:s.baseWidth)||o.baseWidth)*((null==s?void 0:s.fontSize)||o.fontSize||0),{textWithLineBreaks:h}=rJ(o,n,d,p);a!==h&&(l=this.handleEditorTextChange(this.props.editorState,l,h),LE(o.id,{textTemp:h})),i({id:o.id,editor:l}),this.shouldUpdateTextBlocks=!0})),i(this,"handleKeyBindingFn",(e=>"Escape"===e.key?"escape-editor":("Enter"===e.key&&(this.tmpInput="\n"),re.getDefaultKeyBinding(e)))),i(this,"handleKeyCommand",((e,t)=>{var o;const[a,i]=EO(t);if(this.selectionIndices=[a,i],"delete"===e){const e=kO(t);if(e.length>a+2){const t=e.charAt(a+1),o=e.charAt(a+2);"\r"===t&&"\n"===o&&(this.backspaceLinebreakPressed=!0)}}if("backspace"===e){const e=kO(t);if(e.length>0&&a>0&&(this.backspacePressed=!0),i-a<=1&&a>0){this.selectionIndices=[a-1,a-1];const t=e.charAt(a-1),o=e.charAt(a-2);"\n"===t&&"\r"===o&&(this.backspaceLinebreakPressed=!0)}}if("escape-editor"===e){null==(o=this.editor.current)||o.blur();const e=kO(t);return cJ(this.props.layer,e),"handled"}const s=re.RichUtils.handleKeyCommand(t,e);return s?(this.handleEditorChange(s),"handled"):"not-handled"})),i(this,"customEditorBlockStyle",(e=>"")),i(this,"getEditorWrapperClassName",(()=>{const{isSelected:e,isCanvasPreview:t,isEditing:o}=this.props;return o&&e&&!t?WQ.editorWrapperEditing:""})),i(this,"onEditorFocus",(()=>{var e;if(this.undoFocusLock)return void(null==(e=document.activeElement)||e.blur());const{layer:t,isSelected:o,isEditing:a,selectItem:i}=this.props;o||i({id:t.id,type:"layer"}),a||uJ(t)})),i(this,"onEditorBlur",(()=>{var e;const{layer:t,editorState:o}=this.props;null==(e=document.activeElement)||e.blur();const a=null==o?void 0:o.getCurrentContent().getPlainText();cJ(t,a)})),this.state={editorWidth:void 0,editorHeight:void 0}}componentDidMount(){const{isCanvasPreview:e,layer:t,width:o,height:a,textLayerIDsAddedInSession:i,magicAssetId:s}=this.props,n=[];let r=t.fontSize||1;const l=HY(this.props.layer);if(e){if(s){l&&n.push(l),n.push({type:"default",fontFamily:"Noto Sans"});const e=Q(t.text);n.push(...e.map((e=>({type:"default",fontFamily:e}))))}}else t.fontSize&&t.baseWidth&&t.baseHeight||(r=pJ(t,o,a,!1)||r),"string"==typeof t.fontSize&&(r=parseFloat(t.fontSize),OI({[t.id]:{fontSize:r}},"Text.tsx")),l&&n.push(l),n.push({type:"default",fontFamily:"Noto Sans"}),n.push(...(t.fallbackFonts||[]).map((e=>({type:"default",fontFamily:e}))));if(n.length>0){Promise.all(n.map((e=>MY({fontToLoad:e})))).then((s=>{s.some((e=>e.firstLoad))&&(e||null!=t.baseWidth&&t.fontSize||!i.includes(t.id)||(r=pJ(t,o,a,!1)||r),this.recomputeTextWithLineBreaks(r))})).catch((e=>{console.error("error loading fonts",t.fontFamily,...t.fallbackFonts||[]),console.error(e)}))}if(this.addMountedActionToQueue({id:t.id,editor:this.getEditorStateFromLayer(t)}),this._mounted=!0,this.editor.current){const e=this.editor.current,t=e._onInput;e._onInput=function(o){const a="historyRedo"===o.nativeEvent.inputType||"historyUndo"===o.nativeEvent.inputType,{anchorNode:i,focusNode:s}=global.getSelection()||{};a&&(null!=i&&!e.editor.contains(i)||null!=s&&!e.editor.contains(s))||t.call(this,o)}}}componentDidUpdate(e,t){var o,a;const{historyIndex:i,lastUndoTimestamp:n,isCanvasPreview:r,isEditing:l,isSelected:d,layer:c,refreshKey:u,beingTransformed:m,x:p,y:h,width:g,height:f,rotation:y,textTemp:v,fontSizingTemp:_,updateActiveEditor:w,editorState:b,editorStateSync:T,usedUndo:x,nodePosition:S,selectedLayersLength:E,absoluteTimes:[I,C],studioTime:k,staticPreview:A}=this.props;if(this.shouldUpdateTextBlocks&&setTimeout((()=>{this.updateTextBlocks()}),100),!this.checkedForOutsideCanvas&&b&&(null==(o=this.container.current)?void 0:o.clientWidth)){this.checkedForOutsideCanvas=!0;(null==(a=c.textBlocks)?void 0:a.some((e=>e.position.bottom<0)))&&this.syncToLayer(b)}c.id!==e.layer.id&&(this.addUnmountedActionToQueue(e.layer.id),this.addMountedActionToQueue({id:c.id,editor:this.getEditorStateFromLayer(c)}));if(!(!A&&!(I<=k&&k<=C))){const e=this.parseEditorSize();!e||(null==e?void 0:e.editorHeight)===t.editorHeight&&(null==e?void 0:e.editorWidth)===t.editorWidth||this.setState(e)}if(r)return;const j=e.historyIndex!==i,N=e.lastUndoTimestamp!==n;if(j||N){this.shouldUpdateTextBlocks=!0,this.undoFocusLock=!0,LE(c.id,{positionTemp:void 0,fontSizingTemp:void 0,textTemp:void 0});const e=this.refreshEditorState(x?"undo":"redo");return w({id:c.id,editor:e}),void setTimeout((()=>{this.undoFocusLock=!1}),100)}if(e.refreshKey!==u&&!m&&!l){LE(c.id,{positionTemp:void 0,fontSizingTemp:void 0,textTemp:void 0});const e=this.refreshEditorState("refresh");return void w({id:c.id,editor:e})}let R=b;if(!R)return;const P=c.textBlocks!==e.layer.textBlocks,D=l!==e.isEditing;d&&!l&&!m&&e.editorState&&(P||D)&&(this.previousSelectionIndices=EO(e.editorState),R=this.handleSelectionState(R));const O=d!==e.isSelected;!d&&O&&(this.onEditorBlur(),this.previousSelectionIndices=void 0);const L=l&&!e.isEditing,F=m&&!e.beingTransformed;if(L||F)return this.cursorHistory={current:-1,undoStack:[],redoStack:[]},R=re.EditorState.set(R,{undoStack:R.getUndoStack().clear(),redoStack:R.getRedoStack().clear()}),L?R=this.previousSelectionIndices?this.handleSelectionState(R):re.EditorState.moveFocusToEnd(R):F&&(R=re.EditorState.moveSelectionToEnd(R)),w({id:c.id,editor:R}),void(this.previousSelectionIndices=void 0);const M=g!==e.width,U=f!==e.height;if(m&&(M||U)&&!YQ(S)){const e=R.getCurrentContent().getPlainText();!function(e,t,o,a,i){const n=qY(void 0!==a?{...e,text:a}:e,t,o);if(!n)return;const r={fontSize:n,baseWidth:t,baseHeight:o};s.isEqual(i,r)||LE(e.id,{fontSizingTemp:r})}(c,g,f,e,_)}c.fontSize||pJ(c,g,f,!1);if(e.layer.fontFamily!==c.fontFamily||!s.isEqual(e.layer.fallbackFonts,c.fallbackFonts)){this.moveCursorToEnd=!0;const e=VC(this.props.layer);return void Promise.all([...e?[e]:[],...(c.fallbackFonts||[]).map((e=>({type:"default",fontFamily:e})))].map((e=>MY({fontToLoad:e})))).then((()=>{setTimeout((()=>{this.recomputeTextWithLineBreaks()}),0)}),(e=>{console.error("error loading fonts",c.fontFamily,...c.fallbackFonts||[]),console.error(e)}))}if(c.lineHeight!==e.layer.lineHeight){const e=v||c.text,t=QE(c),o=t?iJ(c.baseWidth,t.width):1,a=((null==_?void 0:_.fontSize)||c.fontSize||1)/o,i=this.updateLayerHeightForText(e,!0);return LE(c.id,{fontSizingTemp:{fontSize:a,baseWidth:g,baseHeight:i}}),void setTimeout((()=>{const{editorState:e}=this.props;this._mounted&&e&&this.syncToLayer(e)}),100)}const B=e.textTemp!==v;v&&B&&(R=this.handleEditorTextChange(this.props.editorState,R,v));e.layer.textTransform!==this.props.layer.textTransform&&(this.moveCursorToEnd=!0,this.recomputeTextWithLineBreaks()),R!==b&&w({id:c.id,editor:R}),this.selectionIndices=null,this.tmpInput=null,this.backspacePressed=!1,this.backspaceLinebreakPressed=!1;const V=QE(c);let W=!1;const G=1!==E;if(V&&!G){const e=p!==V.x,t=h!==V.y,o=e||t,a=g!==V.width,i=f!==V.height,s=a||i,n=y!==V.rotation;W=o||s||n}const H=kO(R)!==c.text,$=!m&&e.beingTransformed&&W,K=!l&&e.isEditing&&H,z=e.editorStateSync!==T,Y=e.layer.textAlign!==c.textAlign;if($||K||z||Y){const e=!Y;this.syncToLayer(R,e)}else null==c.textBlocks&&setTimeout((()=>{const{editorState:e}=this.props;this._mounted&&(G?this.updateTextBlocks():e&&this.syncToLayer(e,!1))}),100);K&&(this.cursorHistory={current:-1,undoStack:[],redoStack:[]})}componentWillUnmount(){const{layer:e,editorState:t,isCanvasPreview:o,isEditing:a}=this.props;!o&&t&&a&&this.syncToLayer(t);const i=null==t?void 0:t.getCurrentContent().getPlainText();cJ(e,i),this.addUnmountedActionToQueue(e.id),this._mounted=!1}syncToLayer(e,t=!0){var o;const{layer:a,fontSizingTemp:i,inlineStyles:s,isCanvasPreview:n,viewOnly:r}=this.props;if(!e||!this._mounted||a.isMagicSubtitle||n||r)return;const{position:l}=a;if("object"!=typeof l)return;let d=e.getCurrentContent();d=re.Modifier.removeInlineStyle(d,xO(d),"persistent_selection");const c=d.getPlainText(),u=re.convertToRaw(d),m=Q(c),p={draftJSTextTree:u,text:c,textWithLineBreaks:c,fallbackFonts:m.length?m:void 0,fontSize:(null==i?void 0:i.fontSize)||a.fontSize,baseWidth:(null==i?void 0:i.baseWidth)||a.baseWidth,baseHeight:(null==i?void 0:i.baseHeight)||a.baseHeight,position:this.getCurrentPosition(),italic:s.unique.includes("ITALIC"),fontWeight:s.unique.includes("BOLD")?"bold":"normal",underline:s.unique.includes("UNDERLINE"),color:(null==(o=s.unique.find((e=>e.startsWith("COLOR"))))?void 0:o.slice("COLOR".length+1))||a.color};OI({[a.id]:p},"Text.tsx",t),LE(a.id,{positionTemp:void 0,fontSizingTemp:void 0,textTemp:void 0}),this.shouldUpdateTextBlocks=!0}createInlineStyles(){const{editorState:e,inlineStyles:t}=this.props,{customStyleMap:o}=this;if(null==e)return o;const a=t.all.filter(jk).filter((e=>!o[e]));if(0===a.length)return o;const i={...o};for(const s of a)i[s]=Nk(s);return this.customStyleMap=i,i}render(){const{viewOnly:e,layer:t,editorState:o=re.EditorState.createEmpty(),isEditing:a,width:i,height:s,fontSizingTemp:n,magicAssetId:r}=this.props,{editorWidth:l,editorHeight:d}=this.state,c=this.createInlineStyles(),{animTextStyles:u,animStyles:m,rawTextStyles:p,magicTextStyles:h,textOutlineStyles:g}=this.getTextStyles(),f=iJ(i,(null==n?void 0:n.baseWidth)||t.baseWidth),y=(null==n?void 0:n.fontSize)||t.fontSize||1,v=re.EditorState.set(o,{forceSelection:!1});let _=o.getCurrentContent().getPlainText();!_&&t.isMagicSubtitle&&(_=t.text);const b=t.isMagicSubtitle&&!!r;return w.jsxs("div",{style:this.getRotateWrapperStyles(),className:this.getEditorWrapperClassName(),"data-cy":e?"canvasTextViewOnly":"canvasText","data-test":u.display,onClick:this.handleClick,ref:this.container,translate:"no",children:[w.jsx("div",{style:{display:u.display},children:w.jsx(GQ,{textWithLineBreaks:_,fontSize:y,width:i,height:s,editorWidth:l||i,editorHeight:d||s,textScale:f,layer:t,animStyles:m,isEditing:a,viewOnly:e})}),w.jsx("div",{style:{...p,visibility:"hidden",opacity:"0",pointerEvents:"none"},"data-cy":e?"text-hidden-view-only":"text-hidden",ref:this.hiddenEditorContainer,children:w.jsx(re.Editor,{customStyleMap:c,blockStyleFn:this.customEditorBlockStyle,editorState:v,onChange:KQ,readOnly:!0,ref:this.hiddenEditor})}),t.textOutline&&!b&&w.jsx("div",{style:{...u,...h,...g},"data-cy":"text-outline",children:w.jsx(re.Editor,{customStyleMap:c,blockStyleFn:this.customEditorBlockStyle,editorState:o,onChange:KQ,readOnly:!0})}),w.jsx("div",{style:{...u,...h},"data-cy":e?"text-view-only":"text",children:b?w.jsx($Q,{layer:t,studioTime:this.props.studioTime}):w.jsx(re.Editor,{customStyleMap:c,blockStyleFn:this.customEditorBlockStyle,editorState:o,handleBeforeInput:this.handleBeforeInput,handlePastedText:this.handlePastedText,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.handleKeyBindingFn,onBlur:this.onEditorBlur,onChange:this.handleEditorChange,onFocus:this.onEditorFocus,readOnly:e,ref:this.editor})})]})}},i(t,"editorMountedActions",[]),i(t,"editorMountedActionsTimeout",null),i(t,"editorUnmountedActions",[]),i(t,"editorUnmountedActionsTimeout",null),t);const qQ=g.connect((()=>{const e=m(((e,t)=>{var o;return null==(o=e.activeEditors[t])?void 0:o.editor.getCurrentContent()}),(e=>e?{all:Ck(e),unique:kk(e)}:{all:[],unique:[]}));return(t,o)=>{var a,i,s;const{beingTransformed:n,fontSizingTemp:r,globalAlphaTemp:l,positionTemp:d,textBlurTemp:c,textShadowBlurTemp:u,textShadowDistTemp:m,textShadowRotTemp:p,textTemp:h}=Lg(t,o.layer.id),g=OQ(o.layer.id),f=t.studio.scenes[0];return{absoluteTimes:zQ(o.layer),duration:f.duration,isSelected:(null==(a=t.studio.selectedItem)?void 0:a.id)===o.layer.id,selectedScene:f,canvasWidth:t.studio.width,canvasX:t.studio.canvasX,currentFolderId:t.workspaces.selectedWorkspace,currentUser:t.currentUser,customFontsFetched:t.studio.customFontsFetched,historyIndex:t.studio.historyIndex,lastUndoTimestamp:t.studio.lastUndoTimestamp,usedUndo:t.studio.usedUndo,beingTransformed:n,fontSizingTemp:r,globalAlphaTemp:l,isEditing:Fg(t,o.layer.id),textBlurTemp:c,textShadowBlurTemp:u,textShadowDistTemp:m,textShadowRotTemp:p,textTemp:h,positionTemp:d,layerTempValues:t.studioLocal.layerTempValues,textLayerIDsAddedInSession:t.studioLocal.textLayerIDsAddedInSession,editorState:null==(i=t.activeEditors[o.layer.id])?void 0:i.editor,editorStateSync:(null==(s=t.activeEditors[o.layer.id])?void 0:s.syncCounter)??0,inlineStyles:e(t,o.layer.id),selectedLayersLength:gR(t).length,keyframeChannels:g(t)}}}),(e=>ye({selectItem:l_,mountActiveEditors:RO,unmountActiveEditors:PO,updateActiveEditor:DO},e)))(JQ);function XQ(e,t,o){const a=document.createElement("canvas").getContext("2d");if(!a)return 0;const i=t.style.italic?"italic":"normal",{fontWeight:s}=t.style,{fontFamily:n}=t.style.fontFamily;let r=e;return"uppercase"===t.style.textTransform?r=r.toLocaleUpperCase():"lowercase"===t.style.textTransform&&(r=r.toLocaleLowerCase()),a.font=`${i} normal ${s} ${o}px ${n}`,a.measureText(r).width}const QQ=["Your","subtitles","here"],ZQ=.5*QQ.length,eZ=.1+ZQ;function tZ({preset:e,width:t=100,height:o=100,animate:a=!1}){const i=.8*t,s=.54*o,n=(t-i)/2,r=(o-s)/2,l=s/3,[d,c]=_.useState(0),[u,m]=_.useState(a),[p,g]=_.useState(QQ.map((t=>XQ(t,e,l)))),f=rU();h.useEffect((()=>{!async function(){await MY({fontToLoad:e.style.fontFamily}),f.current&&g(QQ.map((t=>XQ(t,e,l))))}()}),[e,l,f]),h.useEffect((function(){const e=setInterval((()=>{u&&f.current&&c((e=>e>eZ+.1?.1:e+.01))}),10);return()=>clearInterval(e)}),[u,f]);const y=h.useCallback((()=>{const{wordByWordAnimations:t}=e,o=(null==t?void 0:t.animationName)||"";if(u||!["Reveal","Bounce"].includes(o))return t}),[u,e]),v=h.useMemo((()=>({...qA(e.style),id:e.presetId,lineHeight:1,fontSize:l,globalAlpha:1,baseWidth:t,baseHeight:o,text:QQ.join("\n"),textWithLineBreaks:QQ.join("\n"),position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},isMagicSubtitle:!0,startTime:.1,endTime:eZ,type:zl.Text,frame:{id:"123",endTimeOffset:0,containingLayerPlaybackRate:1,startTimeOffset:0,words:[],wordIsClippedList:[],start:.1,end:eZ,lines:QQ.map(((e,t)=>({width:p[t],words:[{start:.1+.5*t,end:.1+.5*t+.5,text:e,charOffset:0,splitTextByStyle:Yk({text:e}),styles:[]}]}))),containingLayerEndTime:eZ,containingLayerStartTime:.1,containingLayerIds:new Set(["123"])},assetId:e.presetId,wordSeparator:" ",isRTL:!1,wordByWordAnimations:y(),transition:e.transition})),[l,y,o,e.presetId,e.style,e.transition,p,t]),b=e.style.colorHighlights||e.style.rotationOffsets,T=[],x=[];function S(){return u?d:.1+Math.round(ZQ/2)}return b&&(QQ.forEach(((t,o)=>{let{color:a}=v;e.style.colorHighlights&&(a=e.style.colorHighlights[o]||e.style.fontColor);let{position:i}=v;e.style.rotationOffsets&&(i={x:"0%",y:"0%",width:"100%",height:"100%",rotation:e.style.rotationOffsets[o]||0});const s={...v,id:`preset.presetId-${o}`,text:t,textWithLineBreaks:t,startTime:.1+.5*o,endTime:.1+.5*o+.5,frame:{...v.frame,words:[],wordIsClippedList:[],startTime:.1+.5*o,endTime:.1+.5*o+.5,lines:[{width:p[o],words:[{start:.1+.5*o,end:.1+.5*o+.5,text:t,charOffset:0,splitTextByStyle:Yk({text:t}),styles:[]}]}],containingLayerEndTime:.1+.5*o+.5,containingLayerStartTime:.1+.5*o,containingLayerIds:new Set(["123"])},color:a,position:i,backgroundColor:"transparent"};T.push(s)})),T.forEach(((t,o)=>{x.push({...t,id:`preset.presetId-background-${o}`,color:"transparent",backgroundColor:e.style.backgroundColor,textOutline:void 0,textEffect:void 0,textShadow:"transparent",wordByWordAnimations:void 0})}))),w.jsx("div",{onMouseEnter:()=>{m(!0),c(0)},onMouseLeave:()=>m(!1),children:b?w.jsxs(w.Fragment,{children:[x.map(((t,a)=>{var r;return w.jsx(qQ,{viewOnly:!0,layer:t,x:n,y:(o-s)/2+a*(o-s)/3,rotation:(null==(r=t.position)?void 0:r.rotation)||0,width:i,height:s/2,refreshKey:JSON.stringify(e),magicAssetId:e.presetId,studioTime:S()},t.id)})),T.map(((t,a)=>{var r;return w.jsx(qQ,{viewOnly:!0,layer:t,x:n,y:(o-s)/6+a*(o-s)/3,rotation:(null==(r=t.position)?void 0:r.rotation)||0,width:i,height:s,refreshKey:JSON.stringify(e),magicAssetId:e.presetId,studioTime:S()},t.id)}))]}):w.jsx(qQ,{viewOnly:!0,layer:v,x:n,y:r,width:i,height:s,refreshKey:JSON.stringify(e),magicAssetId:e.presetId,studioTime:S()})})}const oZ="PresetTitleInput-module_title_xclOc",aZ="PresetTitleInput-module_disabled_2P6U3";function iZ(e){const t=h.useRef(null),[o,a]=_.useState(e.value),i=!e.onChange;let s=e.className||oZ;return i&&(s+=` ${aZ}`),w.jsx("input",{ref:t,type:"text",value:o,className:s,disabled:i,onChange:e=>{a(e.target.value)},onKeyPress:e=>{var o;"Enter"===e.key&&(null==(o=t.current)||o.blur())},onBlur:()=>{var t;0===o.trim().length?a(e.value):o!==e.value&&(null==(t=e.onChange)||t.call(e,o))}})}function sZ({preset:e,isSelected:t,viewOnly:o,animate:a,onClickPreset:i}){const s=il(),n=!!e.teamId,r=h.useCallback((o=>{if("custom"===e.presetId){const a={...e,presetId:`preset-${P()}`,title:o};ff.execInUndoBatch((()=>{s(Nf({index:0,preset:a,undoable:!0})),t&&vU(a,!0,!1),bU()}))}else s(jf({presetId:e.presetId,title:o,undoable:!n}));n&&pU({...e,title:o})}),[s,n,t,e]),l=()=>{if(i)return void i();vU(e);kg(e)&&Fm(ym.CLICKED_DEFAULT_SUBTITLE_PRESET,{presetId:e.presetId}),ez(gL.SUBTITLES)};return w.jsxs("div",{className:EU,children:[w.jsx("div",{className:t?CU:IU,onClick:l,children:w.jsx(tZ,{preset:e,animate:a})}),!o&&w.jsx("div",{className:AU,children:w.jsx(DW,{preset:e,isBrandkit:n,isSelected:t})}),n&&w.jsx("div",{className:kU,onClick:l,children:w.jsx(sU,{message:"Added to your team’s Brand Kit",wrapWithDiv:!0,children:w.jsx(Ze,{className:jU})})}),w.jsx(iZ,{value:e.title,onChange:o?void 0:r})]})}const nZ="MoreOptions-module_optionTextStyle_tSqgQ",rZ="/api/v2/presets/textPresets";let lZ=0;const dZ=async e=>{const{dispatch:t}=sr(),o=Date.now();if(o-lZ<1e4)return;lZ=o;const a=await(async e=>{const t=`${rZ}/${e}`,{presets:o}=await Yr(t);return o})(e);a&&t(Uy({brandkitPresets:a}))},cZ=async(e,t)=>{const{dispatch:o,state:a}=sr();try{const i={...e,teamId:a.teams.selectedTeamId,timestampCreated:Date.now()};o(Gy({preset:i,index:t})),await(async e=>{await Jr(rZ,{body:{preset:e}})})(i);o(wl({description:"Your text style is now accessible to everyone on your team!",type:"success"})),nU("add","textPreset")}catch(IGe){mh({description:"Failed to save text style.",error:IGe})}},uZ=async e=>{try{await(async e=>{await qr(rZ,{body:{preset:e}})})(e)}catch(IGe){mh({description:"Failed to update text style.",error:IGe})}},mZ=async e=>{const{dispatch:t,state:o}=sr(),a=o.teams.selectedTeamId;if(a)try{t($y({presetId:e})),await(async(e,t)=>{const o=`${rZ}/${e}/${t}`;await zr(o)})(a,e),nU("remove","textPreset")}catch(IGe){mh({description:"Failed to remove text style.",error:IGe})}},pZ=()=>{const{state:e,dispatch:t}=sr(),{showCanvas:o}=e.studio;o||(UN({ratioWidth:16,ratioHeight:9}),t({type:"SHOW_STUDIO_CANVAS"}))},hZ={},gZ=e=>["white","#ffffff","#fff","rgb(255,255,255)"].includes(null==e?void 0:e.toLowerCase().replaceAll(" ","")),fZ=e=>["black","#000000","#000","rgb(0,0,0)"].includes(null==e?void 0:e.toLowerCase().replaceAll(" ","")),yZ=e=>["transparent","rgba(0,0,0,0)",ey].includes(null==e?void 0:e.toLowerCase().replaceAll(" ","")),vZ=e=>!(!gZ(e.style.color)||!yZ(e.style.backgroundColor)||e.style.textShadow&&"none"!==e.style.textShadow&&!yZ(e.style.textShadow)&&!gZ(e.style.textShadow)),_Z=(e,t={})=>{var o,a;const{state:i}=sr(),s=bE(),{duration:n}=YN(i.studio.scenes[0],lT(i.studio)),{canvasDimensions:r,scenes:l}=i.studio,{canvasWidth:d,canvasHeight:c}=r||{},u=d||320,m=c||180,p=(null==(o=l[0])?void 0:o.background.toLowerCase())||"";gZ(p)&&vZ(e)&&"BASIC"!==e.presetId&&(t.textShadow="#000000"),"BASIC"===e.presetId&&(t.color=K(p).lightness()>50?"#000000":"#FFFFFF");const h={id:P(),presetId:e.presetId,backgroundColor:e.style.backgroundColor,fontFamily:e.style.fontFamily,hasCustomFont:e.style.hasCustomFont,url:e.style.url,asset_id:e.style.asset_id,fontType:e.style.fontType,fontWeight:e.style.fontWeight,textAlign:e.style.textAlign,textTransform:e.style.textTransform,textOutline:e.style.textOutline,textShadow:"none"===e.style.textShadow?"transparent":e.style.textShadow,color:e.style.color,textBlur:e.style.textBlur,textEffect:e.style.textEffect,textEffectColor:e.style.textEffectColor,textPadding:e.style.textPadding,wrapOrFill:e.style.wrapOrFill,textShadowBlur:e.style.textShadowBlur,textShadowDist:e.style.textShadowDist,textShadowRot:e.style.textShadowRot,borderRadius:e.style.borderRadius,underline:e.style.underline,italic:e.style.italic,globalAlpha:e.style.globalAlpha,lineHeight:e.style.lineHeight,type:zl.Text,fontSize:15,baseWidth:u,baseHeight:m,text:"Sample text",position:{x:"32.5%",y:"32.5%",width:"25%",height:"25%",rotation:0},startTime:s,endTime:s+3,isTrimmed:n>0,...t},g=(e=>{const t=e.italic?"italic":"normal",o=document.createElement("canvas").getContext("2d");if(!o)return 0;const a=e.fontWeight||"normal",i=GC(e);o.font=`${t} normal ${a} ${e.fontSize}px ${i}`;let s=e.text;return"uppercase"===e.textTransform?s=e.text.toLocaleUpperCase():"lowercase"===e.textTransform&&(s=e.text.toLocaleLowerCase()),o.measureText(s).width})(h)+10,f=h.fontSize*h.lineHeight;return h.baseWidth=g,h.baseHeight=f,t.position||(h.position={x:WI((u-g)/2*100/u),y:WI((m-f)/2*100/m),width:WI(100*g/u),height:WI(100*f/m),rotation:(null==(a=h.position)?void 0:a.rotation)||0}),h},wZ=async({preset:e,undoable:t=!0,overrides:o={},idOfLayerToReplace:a})=>{pZ();const{dispatch:i}=sr(),s=_Z(e,o);yz({newLayer:s,options:{undoable:t,knownTimelineRow:void 0!==s.timelineRow},idOfLayerToReplace:a}),i(l_({id:s.id,type:"layer"})),Fm(ym.ADDED_TEXT_PRESET,{presetId:e.presetId,isDefaultPreset:Ry(e),dndTimeline:void 0!==o.timelineRow,dndCanvas:void 0!==o.position})},bZ=e=>{const{backgroundColor:t,fontFamily:o,hasCustomFont:a,url:i,asset_id:s,fontType:n,fontWeight:r,textAlign:l,textTransform:d,textShadow:c,textOutline:u,color:m,textBlur:p,textEffect:h,textEffectColor:g,textPadding:f,wrapOrFill:y,textShadowBlur:v,textShadowDist:_,textShadowRot:w,borderRadius:b,underline:T,italic:x,globalAlpha:S,lineHeight:E}=e;return{presetId:e.presetId||`preset-${P()}`,style:{backgroundColor:t,fontFamily:o,hasCustomFont:a,url:i,asset_id:s,fontType:n,fontWeight:r,textAlign:l,textTransform:d,textShadow:c,textOutline:u,color:m,textBlur:p,textEffect:h,textEffectColor:g,textPadding:f,wrapOrFill:y,textShadowBlur:v,textShadowDist:_,textShadowRot:w,borderRadius:b,underline:T,italic:x,globalAlpha:S,lineHeight:E}}};function TZ(e,t){let o=!0;return Object.keys(e.style).forEach((a=>{const i=a,s=e.style[i],n=t.style[i],r=JSON.stringify(s),l=JSON.stringify(n);if("url"===i)return;if(!s&&!n)return;if("textShadow"===i){if(vZ(e)&&gZ(t.style.color)&&fZ(t.style.textShadow))return;if(vZ(t)&&gZ(e.style.color)&&fZ(e.style.textShadow))return}if(["textShadow","color"].includes(i)&&[e.presetId,t.presetId].includes("BASIC")){if(gZ(e.style.color)&&fZ(t.style.color))return;if(gZ(t.style.color)&&fZ(e.style.color))return;if(gZ(e.style.textShadow)&&fZ(t.style.textShadow))return;if(gZ(t.style.textShadow)&&fZ(e.style.textShadow))return}[r,l].every((e=>["none","transparent"].includes(e)))||r!==l&&(o=!1)})),o}function xZ(e){const{state:t,dispatch:o}=sr(),{projectId:a}=t.studio,i=t.textPresets.presets,s={};i.forEach((e=>{s[e.presetId]=e}));const n=new Set,r=[];e.forEach((e=>{const t=bZ(e);let o=s[t.presetId];o&&TZ(o,t)||(o=[...r,...i].find((e=>TZ(e,t))));let l=null==o?void 0:o.presetId;!l&&(l=`preset-${P()}`,t.presetId=l,t.projectId=a||void 0),l&&!n.has(l)&&(n.add(l),r.push(t)),e.presetId!==l&&OI({[e.id]:{presetId:l}},"saveTextPresets")}));const l=i.filter((e=>!n.has(e.presetId)));r.reverse();const d=[...r,...l];o(My({presets:d}))}function SZ(){const{state:e}=sr(),t=hR(e);if(!t||t.type!==zl.Text)return;xZ([t])}function EZ(){const e=rU(),t=tl((e=>e.teams.selectedTeamId)),{brandkitPresets:o,presets:a}=tl((e=>e.textPresets)),[i,s]=h.useState(!1);if(h.useEffect((()=>{dZ(t)}),[t]),h.useEffect((()=>{!async function(){await(async()=>{const{dispatch:e,state:t}=sr(),{presets:o,lastAssetUrlSignedAt:a}=t.textPresets;if(Date.now()-(a||0)<144e5)return;const i=(e=>{const t=[];return e.forEach((({style:{hasCustomFont:e,asset_id:o}})=>{e&&o&&t.push(o)})),t})(o);if(i.length)try{const t=await cU(i),a=o.map((e=>((e,t)=>{const{style:{hasCustomFont:o,asset_id:a}}=e;return o&&a?{...e,style:{...e.style,url:t[a]}}:e})(e,t)));e(My({presets:a})),e(zy(Date.now()))}catch(s){console.error("refreshSubtitlePresetFontAssetUrls err",s)}})(),e.current&&s(!0)}()}),[e]),!i)return{presets:[],brandkitPresets:[]};const n=new Set(o.map((e=>e.presetId))),r=a.filter((e=>e&&e.presetId&&!n.has(e.presetId)));return{presets:Dy(r),brandkitPresets:o}}const IZ=w.jsx(Xe,{color:"gray",size:14}),CZ=_.memo((({preset:e,isBrandkit:t})=>{const o=il(),a=NU(Bl.TEXT_PRESETS),i=bW(),s=()=>{const o=()=>{t?mZ(e.presetId):cZ(e)};if(a)o();else{i(o,{action:Vl.TEXT_PRESETS})()}},n=async()=>{const s=async()=>{o(Wy({presetId:e.presetId,undoable:!t})),t&&await mZ(e.presetId)};if(a||!t)await s();else{i(s,{action:Vl.TEXT_PRESETS})()}},r=!t||a,l=h.useMemo((()=>{const e=[];return e.push(w.jsxs("div",{className:nZ,onClick:s,children:[w.jsx("span",{style:{marginRight:4},children:t?"Remove from Brand Kit":"Add to Brand Kit"}),!a&&w.jsx(EW,{})]})),r&&e.push(w.jsx("div",{className:nZ,onClick:n,children:"Remove style"})),e}),[r,a,t]);return w.jsx(NW,{content:IZ,options:l})}));function kZ(){const[e,t]=h.useState(),[o,a]=h.useState(!1),i=h.useRef(!1);o&&(i.current=!0);const s=h.useMemo((()=>new IntersectionObserver((([e])=>{e&&a(e.isIntersecting)}))),[]);return h.useEffect((()=>e?(s.observe(e),()=>s.disconnect()):()=>{}),[s,e]),{ref:function(e){t(e)},isVisible:o,wasVisible:i.current}}const AZ=_.memo((function({disabled:e,children:t,onLoad:o,...a}){const{ref:i,wasVisible:s}=kZ(),n=s||e;return w.jsx("div",{ref:i,...a,children:n&&t})})),jZ="PresetText-module_container_R79l5",NZ=_.memo((function({preset:e,width:t=100,height:o=100,onClick:a}){h.useEffect((()=>{MY({fontToLoad:{type:"default",fontFamily:e.style.fontFamily}})}),[e]);const i=h.useMemo((()=>({id:e.presetId,presetId:e.presetId,backgroundColor:e.style.backgroundColor,fontFamily:e.style.fontFamily,hasCustomFont:e.style.hasCustomFont,url:e.style.url,asset_id:e.style.asset_id,fontType:e.style.fontType,fontWeight:e.style.fontWeight,textAlign:e.style.textAlign,textTransform:e.style.textTransform,textShadow:"none"===e.style.textShadow?"transparent":e.style.textShadow,textOutline:e.style.textOutline,color:e.style.color,textBlur:(e.style.textBlur||0)/2,textEffect:e.style.textEffect,textEffectColor:e.style.textEffectColor,textPadding:e.style.textPadding,wrapOrFill:e.style.wrapOrFill,textShadowBlur:e.style.textShadowBlur,textShadowDist:e.style.textShadowDist,textShadowRot:e.style.textShadowRot,borderRadius:e.style.borderRadius,underline:e.style.underline,italic:e.style.italic,globalAlpha:e.style.globalAlpha,lineHeight:1,fontSize:t/4.2,baseWidth:t,baseHeight:o,text:"Sample\nText",position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},isMagicSubtitle:!1,startTime:0,endTime:Number.MAX_VALUE,type:zl.Text})),[e,t,o]),s=h.useMemo((()=>({width:t,height:o})),[t,o]);return w.jsx(AZ,{"data-cy":`preset-text-${e.presetId}`,className:jZ,style:s,onClick:a,children:w.jsx(qQ,{layer:i,viewOnly:!0,height:.5*o,width:.8*t,x:.09999999999999998*t,y:.25*o,refreshKey:JSON.stringify(e),studioTime:0})})})),RZ="PresetPreview-module_container_MGmcA",PZ="PresetPreview-module_brandkit_CZcev",DZ="PresetPreview-module_more_gkQfH",OZ="PresetPreview-module_brandkitIcon_ZWuKK",LZ=_.memo((function({preset:e,width:t=100,height:o=100,viewOnly:a,onClick:i}){const s=!!e.teamId;return w.jsxs("div",{className:RZ,children:[w.jsx(NZ,{preset:e,width:t,height:o,onClick:i}),!a&&w.jsx("div",{className:DZ,children:w.jsx(CZ,{preset:e,isBrandkit:s})}),s&&w.jsx("div",{className:PZ,onClick:i,children:w.jsx(sU,{message:"Added to your team’s Brand Kit",wrapWithDiv:!0,children:w.jsx(Ze,{className:OZ})})})]})})),FZ="MoreOptions-module_optionTextStyle_ji9Sl",MZ="/api/v2/presets/textTemplates";let UZ=0;const BZ=async e=>{const{dispatch:t}=sr(),o=Date.now();if(o-UZ<1e4)return;UZ=o;const a=await(async e=>{const t=`${MZ}/${e}`,{templates:o}=await Yr(t);return o})(e);a&&t(ov({brandkitTemplates:a}))},VZ=async(e,t)=>{const{dispatch:o,state:a}=sr();try{const i={...e,teamId:a.teams.selectedTeamId,timestampCreated:Date.now()};o(nv({template:i,index:t})),await(async e=>{await Jr(MZ,{body:{template:e}})})(i);o(wl({description:"Your text style is now accessible to everyone on your team!",type:"success"})),nU("add","textTemplate")}catch(IGe){mh({description:"Failed to save text style.",error:IGe})}},WZ=async e=>{try{await(async e=>{await qr(MZ,{body:{template:e}})})(e)}catch(IGe){mh({description:"Failed to update text style.",error:IGe})}},GZ=async e=>{const{dispatch:t,state:o}=sr(),a=o.teams.selectedTeamId;if(a)try{t(lv({templateId:e})),await(async(e,t)=>{const o=`${MZ}/${e}/${t}`;await zr(o)})(a,e),nU("remove","textTemplate")}catch(IGe){mh({description:"Failed to remove text style.",error:IGe})}},HZ=(e,t={})=>{var o;const{state:a}=sr(),{ratio:i,scenes:s}=a.studio,{duration:n}=s[0],r=(null==(o=e.ratio)?void 0:o.join(":"))||"16:9",l=i!==r;return e.layers.map((o=>{const a=P(),{type:s}=o;let{position:r}=o;if(l&&r){const t=+i.split(":")[0],o=+i.split(":")[1],a={width:t/Math.min(t,o),height:o/Math.min(t,o)},s=e.ratio||[16,9],n=s[0]/s[1],l=EN({xPct:GI(r.x),yPct:GI(r.y),widthPct:GI(r.width),heightPct:GI(r.height)},{width:n,height:1},a,{left:!1,top:!1});r={...r,x:WI(l.xPct),y:WI(l.yPct),width:WI(l.widthPct),height:WI(l.heightPct)}}const d={...o,position:r,id:a,type:s,fromTextDefaults:e.templateId};if(n&&(lz(d),t.startTime)){const e=(d.endTime||0)-(d.startTime||0)||t.duration||0;d.duration=e,d.isTrimmed=!0,d.startTime=t.startTime,d.endTime=t.startTime+e}return d}))},$Z={},KZ=async(e,t=!0,o={})=>{var a;pZ();const{state:i,dispatch:s}=sr(),{ratio:n,scenes:r}=i.studio,{duration:l}=r[0],d=n!==((null==(a=e.ratio)?void 0:a.join(":"))||"16:9"),c=HZ(e,o);if(ff.beginBatch(),1===c.length){const o=c[0],a=e.layers[0];if(gz(o,{undoable:t}),d&&((e,t=!0)=>{const{state:o}=sr(),{byId:a}=o.studio.allLayers,i=a[e];if(!i)return;let{position:s}=i;if(s){let e=50-GI(s.width)/2,o=50-GI(s.height)/2,a=GI(s.width),n=GI(s.height);a>100&&(a=100,n=GI(s.height)*a/GI(s.width),e=0,o=50-n/2),n>100&&(n=100,a=GI(s.width)*n/GI(s.height),e=0,o=50-a/2),s={...s,x:WI(e),y:WI(o),width:WI(a),height:WI(n)},OI({[i.id]:{position:s}},"layers.ts",t)}})(o.id,t),s(l_({id:o.id,type:"layer"})),a.animation&&l){const e=Nx(a.animation.animationName);e.transitionDuration=a.animation.transitionDuration,wR(o.id,e)}}else{const a=P(),i=Au();for(let o=0;o<c.length;o+=1){const a=c[o];Xl(a)&&a.url?(await LX({url:a.url,options:{layerProperties:a,skipCML:!0}}),s(l_(null))):gz(a,{undoable:t,isReplacing:!0});const i=e.layers[o];if(i.animation&&l){const e=Nx(i.animation.animationName);e.transitionDuration=i.animation.transitionDuration,wR(a.id,e)}}gJ(c.map((e=>e.id)),a,!0,t),s(a_(a,!1,t));const n={x:50,y:50};if(o.position){const{x:e,y:t,width:a,height:i}=o.position,s=GI(e),r=GI(t),l=GI(a),d=GI(i);n.x=s+l/2,n.y=r+d/2}((e,t=!0,o={x:50,y:50})=>{const{state:a}=sr(),i=a.studio.scenes[0];if(!i)return;const s=a.studio.groups[e];if(!s)return;const n=s.layers.map((e=>e.id)),r=i.layers.filter((e=>n.includes(e.id))),l={width:a.studio.width||0,height:a.studio.height||0};let d=null;const c=Sj(r,0);if(c.width>l.width){const o=l.width-c.width;if(d={width:l.width,height:c.height*l.width/c.width,x:c.x-o/2,y:c.y-o/2},d.height>l.height){const e=l.height-d.height;d={width:d.width*l.height/d.height,height:l.height,x:d.x-e/2,y:d.y-e/2}}FJ(e,{initialPosition:c,currentPosition:d,transformerNode:"topLeft"},t)}const u=d?{x:d.x+d.width/2,y:d.y+d.height/2}:XI(r),m=WE(o.x,o.y),p=m.x-u.x,h=m.y-u.y;FJ(e,{xDiff:p,yDiff:h},t)})(a,t,n),s(a_(a,!0,t)),i&&(s(a_(a,!1,t)),s(l_(null)))}ff.endBatch();const u=!!Yy.find((t=>t.templateId===e.templateId)),m=!!e.teamId;Fm(ym.ADDED_TEXT_TEMPLATE,{templateId:e.templateId,isDefaulTemplate:u,isBrandkitTemplate:m,dndTimeline:void 0!==o.timelineRow,dndCanvas:void 0!==o.position})};function zZ(){const e=rU(),t=tl((e=>e.teams.selectedTeamId)),{brandkitTemplates:o,templates:a}=tl((e=>e.textTemplates)),[i,s]=h.useState(!1);if(h.useEffect((()=>{BZ(t)}),[t]),h.useEffect((()=>{!async function(){await(async()=>{const{dispatch:e,state:t}=sr(),{templates:o,lastAssetUrlSignedAt:a}=t.textTemplates;if(Date.now()-(a||0)<144e5)return;const i=(e=>{const t=[];return e.forEach((({layers:e})=>{e.forEach((e=>{e.asset_id&&t.push(e.asset_id)}))})),t})(o);if(i.length)try{const t=await cU(i),a=o.map((e=>((e,t)=>{const{layers:o}=e,a=o.map((e=>{const{asset_id:o}=e;return o&&t[o]?{...e,url:t[o]}:e}));return{...e,layers:a}})(e,t)));e(tv({templates:a})),e(cv(Date.now()))}catch(s){console.error("refreshSubtitlePresetFontAssetUrls err",s)}})(),e.current&&s(!0)}()}),[e]),!i)return{templates:[],brandkitTemplates:[]};const n=new Set(o.map((e=>e.templateId))),r=a.filter((e=>e&&e.templateId&&!n.has(e.templateId)));return{templates:Xy(r),brandkitTemplates:o}}const YZ=w.jsx(Xe,{color:"gray",size:14}),JZ=_.memo((({template:e,isBrandkit:t})=>{const o=il(),a=NU(Bl.TEXT_PRESETS),i=bW(),s=()=>{const o=()=>{t?GZ(e.templateId):VZ(e)};if(a)o();else{i(o,{action:Vl.TEXT_PRESETS})()}},n=async()=>{const s=async()=>{o(sv({templateId:e.templateId,undoable:!t})),t&&await GZ(e.templateId)};if(a||!t)await s();else{i(s,{action:Vl.TEXT_PRESETS})()}},r=!t||a,l=h.useMemo((()=>{const e=[];return e.push(w.jsxs("div",{className:FZ,onClick:s,children:[w.jsx("span",{style:{marginRight:4},children:t?"Remove from Brand Kit":"Add to Brand Kit"}),!a&&w.jsx(EW,{})]})),r&&e.push(w.jsx("div",{className:FZ,onClick:n,children:"Remove template"})),e}),[r,a,t]);return w.jsx(NW,{content:YZ,options:l})})),qZ="TemplatePreview-module_container_6p3Bp",XZ="TemplatePreview-module_brandkit_fHGvN",QZ="TemplatePreview-module_more_05Ink",ZZ="TemplatePreview-module_brandkitIcon_k1IVU",e0="TemplateLayers-module_container_2qoFt",t0="CanvasPreview-module_container_pNA0S",o0="CanvasPreview-module_canvas_zmEex",a0=async(e,t={},o)=>{const a=await Zz(e.file,{...t,uploadId:e.layer.uploadId});return yz({newLayer:a,options:{undoable:!0,knownTimelineRow:void 0!==t.timelineRow},idOfLayerToReplace:o})},i0=async(e,t={})=>{const{state:{studio:{scenes:o,selectedItem:a}}}=sr(),i=dz((null==a?void 0:a.id)||"");if(!i)return null;const s=await Zz(e.file,{...t,uploadId:e.layer.uploadId}),n=sC(s,i);return fz(n,i,{knownTimelineRow:!0,sceneId:o[0].id,undoable:!0}),s},s0=e=>g.batch((()=>{const{dispatch:t,state:o}=sr(),a=cz().filter((t=>e.id===t.cmlFileId)).map((e=>e.id));Az({layerIds:a}),t(pD(e.id,o.studio._id))})),n0=e=>g.batch((()=>{const t=cz().filter((t=>e===t.uploadId)).map((e=>e.id));Az({layerIds:t}),sq(e)})),r0=()=>g.batch((()=>{const{dispatch:e,state:{CMLFiles:{byId:t},studio:{_id:o,thisProjectCMLFiles:a},uploadStatuses:i={}}}=sr();if(!a)return;const s=Object.values(a).map((e=>e.cmlFileId)),n=new Set(s),r=cz().filter((e=>e.cmlFileId&&n.has(e.cmlFileId))).map((e=>e.id));Az({layerIds:r}),Object.values(a).forEach((({cmlFileId:a})=>{const i=t[a];i&&e(pD(i.id,o))})),Object.entries(i).forEach((([e,t])=>{t.stage!==Sv.done&&sq(e)}))})),l0=(e,t,o)=>{const a={};Object.keys(t).forEach((e=>{const o=e,i=t[o];void 0!==i&&(a[o]=i)})),wZ({preset:e,undoable:!0,overrides:a,idOfLayerToReplace:o})},d0=async({dndAsset:e,layerProperties:t={},idOfLayerToReplace:o})=>{var a;const{url:i,query:s,urlSource:n,name:r,actionSource:l,mediaType:d,bRollLayerSource:c,usedProFeature:u,sourceInfo:m,width:p,height:h}=e,g=d===zl.Video;let f;g&&"videoDelay"in t&&(f=t.videoDelay),!g&&t.isTrimmed&&(f=t.startTime);const y={layerProperties:{addedLayerFrom:{source:l,query:s},name:r,bRollLayerSource:c,usedProFeatures:u?[u]:void 0,type:g?zl.Video:zl.Image,width:p,height:h,...t},idOfLayerToReplace:o,sourceInfo:m,useCustomVideoDelay:f};if(g){const t=e,i=null==(a=t.videoRef)?void 0:a.current,s=(null==i?void 0:i.duration)??t.duration,n=!!i&&await SB(i),r={type:zl.Video,duration:s,hasAudio:n,width:p,height:h};y.mediaInfo=r,y.layerProperties.duration=s,o||(y.layerProperties.endTime=s)}if(n){const e=g?ym.ADD_LAYER_FROM_VIDEO_SEARCH:ym.ADD_LAYER_FROM_IMAGE_SEARCH;Fm(e,{source:n})}return LX({url:i,options:y})};function c0(e){const{state:t}=sr(),{width:o,height:a}=t.studio;let i=null,s=null,n=null;switch(e.type){case jv.CML_FILE:n=q$(e.asset),e.asset.metadata_stage&&e.asset.dimensions&&(i=e.asset.dimensions.height,s=e.asset.dimensions.width);break;case jv.UPLOADING_LAYER:n=e.layer.type;break;case jv.SIDEBAR_IMAGE:n=e.image.mediaType,i=e.image.height,s=e.image.width;break;case jv.SIDEBAR_VIDEO:n=e.video.mediaType,i=e.video.height,s=e.video.width;break;case jv.TEXT_PRESET:{const{width:t,height:r}=((e,t,o)=>{const a=`${e.presetId}_${t}_${o}`,i=hZ[a];if(i)return i;const s=_Z(e),{width:n,height:r}=s.position,l={width:t*GI(n)/100,height:o*GI(r)/100};return hZ[a]=l,l})(e.preset,o||0,a||0);s=t,i=r,n=zl.Text;break}case jv.TEXT_TEMPLATE:{const{width:t,height:n}=((e,t,o)=>{const a=`${e.templateId}_${t}_${o}`,i=$Z[a];if(i)return i;const s=HZ(e);let n=100,r=0,l=100,d=0;s.forEach((({position:e})=>{if(!e)return;const{x:t,y:o,width:a,height:i}=e,s=GI(t),c=GI(o),u=GI(a),m=GI(i);s<n&&(n=s),c<l&&(l=c),s+u>r&&(r=s+u),c+m>d&&(d=c+m)}));const c={width:t*(r-n)/100,height:o*(d-l)/100};return $Z[a]=c,c})(e.template,o||0,a||0);s=t,i=n;break}}return{layerType:n,nativeWidth:s,nativeHeight:i}}function u0(e){let t=3,o=null;switch(e.type){case jv.CML_FILE:o=q$(e.asset),e.asset.metadata_stage&&"number"==typeof e.asset.duration&&(t=e.asset.duration);break;case jv.UPLOADING_LAYER:o=e.layer.type,"number"==typeof e.layer.duration&&(t=e.layer.duration);break;case jv.SIDEBAR_IMAGE:o=e.image.mediaType;break;case jv.SIDEBAR_VIDEO:o=e.video.mediaType,e.video.duration&&(t=e.video.duration);break;case jv.TEXT_PRESET:t=3,o=zl.Text}return{layerType:o,duration:t}}const m0=async({item:e,layerUpdates:t,idOfLayerToReplace:o,source:a})=>{switch(Fm(ym.ADD_LAYER_FROM_DND,{source:a,dragObjectType:e.type,isReplace:!!o}),e.type){case jv.CML_FILE:{const a=RU(Bl.BRANDKIT);return(await xW((()=>xq(e.cmlFile,e.asset,t,o)),{if:e.brandkitItem&&!a,action:Vl.BRANDKIT}))()}case jv.UPLOADING_LAYER:return(async(e,t={},o)=>{var a,i;const{state:s}=sr(),n=null==(i=null==(a=s.uploadStatuses)?void 0:a[e])?void 0:i.uploadManager;n&&await a0(n,t,o)})(e.uploadId,{...t,addedFromMediaLibrary:!0},o);case jv.SIDEBAR_IMAGE:return d0({dndAsset:e.image,layerProperties:t,idOfLayerToReplace:o});case jv.SIDEBAR_VIDEO:return d0({dndAsset:e.video,layerProperties:t,idOfLayerToReplace:o});case jv.TEXT_PRESET:return l0(e.preset,t||{},o);case jv.TEXT_TEMPLATE:return o&&Az({layerIds:[o]}),i=e.template,s=t||{},Object.keys(s).forEach((e=>{s[e]})),void KZ(i,!0,s);case jv.TRANSITION_TILE:default:return null}var i,s},p0=()=>{const[e,t]=h.useState({x:0,y:0}),[o,a]=h.useState({x:0,y:0});return h.useEffect((()=>{const e=e=>{t({x:e.screenX,y:e.screenY})};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}})),h.useEffect((()=>{const e=e=>{a({x:e.screenX,y:e.screenY})};return window.addEventListener("mouseup",e),()=>{window.removeEventListener("mouseup",e)}})),{initialCoords:e,finalCoords:o}},h0=(e,t)=>{const{start:o,end:a}=t;g0(e,{duration:a-o,startTime:o})},g0=(e,t)=>{const o=uI(e,t);o&&OI({[e.id]:o},"keyframeAnimations.ts",!0)},f0=(e,t)=>{const{start:o,end:a}=t;return y0(e,{duration:a-o,startTime:o})},y0=(e,t)=>{const o=uI(e,t);if(o)return o},v0=200,_0=244,w0=(e,t)=>{if(!e&&!t)return{scaledWidth:244,scaledHeight:200};let o,a;return t>=e?(a=200,o=a/t*e):(o=244,a=o/e*t),{scaledWidth:o,scaledHeight:a}};function b0(e,t){const{layer:o,x:a,y:i,width:s,height:n,canvasHeight:r,rotation:l}=e,d=bE(),[c,u]=TS(o,0),m=c<=d&&d<=u;if(!o)return{};const p=Oz(t??null,o,s,n),h=o.stroke||"#000000",g=o.lineWidth||0,f=r?parseFloat(g)/100*r:0,y={top:i,left:a,width:s,height:n,transform:`rotate(${l}deg)`,boxShadow:m?`0 0 0 ${f}px ${h}`:"none",borderRadius:`${p}px`,opacity:1,zIndex:"auto"};return o.filters&&o.filters.opacity&&(y.filter=`opacity(${o.filters.opacity}%)`),y}const T0=_.memo((({x:e,y:t,width:o,height:a})=>w.jsx("div",{children:w.jsx("div",{style:{background:"rgba(88, 107, 216, 0.5)",left:e,top:t,width:o,height:a,display:"block",position:"absolute",overflow:"hidden",outline:"1px dashed gray"}})}))),x0=!Yg()&&!qg(),S0=(e,t,o,a=null,i=!1)=>{let s="";if(e)for(const n in e){switch(n){case"contrast":case"brightness":case"saturate":s+=`${n}(${e[n]/100})`;break;case"opacity":i||(s+=`opacity(${e[n]}%)`);break;case"blur":void 0===e.blurPercent&&(s+=`blur(${e[n]}px)`);break;case"blurPercent":{let i=Math.min(t,o);if(a){const e=pm(t,o,a);i=Math.min(e.width,e.height)}s+=`blur(${Math.round(i*e[n]/100)}px)`;break}}s+=" "}return s},E0=e=>({mixBlendMode:e.foregroundBlendMode,opacity:e.foregroundOpacity}),I0=(e,t,o)=>{const a=e/255,i=t/255,s=o/255,n=Math.min(a,i,s),r=Math.max(a,i,s),l=r-n;let d=0;0===l?d=0:(r===a&&(d=(i-s)/l*60),r===i&&(d=60*(2+(s-a)/l)),r===s&&(d=60*(4+(a-i)/l)));return{H:d,S:0===r?0:l/r,V:r}};function C0(e,t,o=sr().state){var a,i,s,n,r,l;const d=e.asset_id;return"waveform"===t?d?null==(i=null==(a=o.assets.byId[d])?void 0:a.waveformInfo)?void 0:i.cdnUrl:"":"preview"===t?null==(s=e.preview)?void 0:s.url:"thumbnail_sheet"===t?d?null==(r=null==(n=o.assets.byId[d])?void 0:n.thumbnail_sheet)?void 0:r.cdnUrl:"":"track"===t?null==(l=e.track_preview)?void 0:l.url:"original"===t?k0(e,void 0,"original",o):void 0}function k0(e,t,o="preview",a){var i,s,n;let r="";const l=a??sr().state;if(!e)return r;t&&t.length&&(r=e[t]);const d=e;if("video"===d.type&&d.lowerQualityPreviewUrl&&!d.preview)return d.lowerQualityPreviewUrl;const{id:c}=e;if("track_preview"in e){const{track_preview:t}=e,{trackPreviewLocalUrl:a}=(null==(s=null==(i=l.studioLocal)?void 0:i.layerTempValues)?void 0:s[c])||{};if("track_preview"===o){if(t){if(a)return a;if(t.url)return t.url}o="preview"}}const{local_url:u}=e;if(u&&("original"!==o||!("preview"in e)&&!e.isOptimizedImage))return u;"preview"===o&&(r=(null==(n=e.preview)?void 0:n.url)||r);const{soundUrl:m,url:p}=e,{uri:h}=e;if(r=r||m||p||h||"",r||"FULFILLED"!==l.ffmpegReducer.ffmpegStatus||void 0===l.ffmpegReducer.outputFile){if(!r)return r}else r=l.ffmpegReducer.outputFileUrl;return"string"!=typeof r||r.includes("X-Goog-Expires=")||(r=r.replace("https://storage.googleapis.com/kapwing/",yn),r=r.replace("https://storage.googleapis.com/kapwing-useast1",yn)),r}const A0=e=>e.includes("https://cdn.kapwing.com/")||e.includes("https://cdn-useast1.kapwing.com/");function j0(e){const{image_url:t,fullPath:o}=e;let a=t;return a||(a=o),a&&"string"==typeof a||(a="https://cdn-useast1.kapwing.com/video_image-cHDmsyz_G.jpg"),a.includes("X-Goog-Expires=")||(a=a.replace("https://storage.googleapis.com/kapwing/",yn),a=a.replace("https://storage.googleapis.com/kapwing-useast1",yn)),a}const N0=(e,t,o,a,i,s,n,r=1)=>{e.save();let l=0,d=o;s>1&&(d=o*s),i&&(l=t,d=o),e.globalAlpha=r||1,n&&(e.globalCompositeOperation=n);const c=e.createLinearGradient(l,0,0,d);for(let u=0;u<a.length;u+=1){const e=a[u];c.addColorStop(e.start,e.color)}e.fillStyle=c,e.fillRect(0,0,t,o),e.restore()},R0=(e,t)=>{const{width:o,height:a}=t.canvas;e.background&&N0(t,o,a,e.background,e.backgroundAngle,e.backgroundGradientEnd)},P0=(e,t)=>{const{width:o,height:a}=t.canvas;e.foreground&&N0(t,o,a,e.foreground,e.foregroundAngle,e.foregroundGradientEnd)},D0=(e,t,o,a,i)=>{const{width:s,height:n}=t.canvas;e.background&&N0(t,s,n,e.background,e.backgroundAngle,e.backgroundGradientEnd),t.globalCompositeOperation=e.backgroundBlendMode,t.filter=e.styles,t.save(),t.globalAlpha=e.opacity,a&&i?t.drawImage(o,0,0,a,i,0,0,s,n):t.drawImage(o,0,0,s,n),t.restore(),e.foreground&&N0(t,s,n,e.foreground,e.foregroundAngle,e.foregroundGradientEnd,e.foregroundBlendMode,e.foregroundOpacity)},O0="SafariFilterImage-module_filterCanvasWrapper_bIuXn",L0="SafariFilterImage-module_backgroundCanvas_wvbgJ",F0="SafariFilterImage-module_imageCanvasWrapper_HxI2u",M0="SafariFilterImage-module_imageCanvas_6eZMk",U0="SafariFilterImage-module_foregroundCanvas_eZFbn",B0=_.memo((({image:e,filter:t,style:o,sizeStyle:a})=>{const i=h.useRef(null),s=h.useRef(null),n=h.useRef(null),r=h.useRef(null),[l,d]=h.useState(!1),c=h.useCallback(((o,a)=>{const n=i.current,r=s.current;if(!n||!r)return;const{width:l,height:d}=n,c=r.getContext("2d");c&&t&&(c.save(),c.clearRect(0,0,l,d),a(t,c),c.restore());const u=o.getContext("2d");u&&e&&(u.drawImage(e,0,0,l,d),u.save(),u.globalCompositeOperation="source-in",u.drawImage(r,0,0,l,d),u.restore())}),[e,t]),u=h.useCallback((()=>{const t=i.current,o=null==t?void 0:t.getContext("2d");if(!e||!t||!o)return;if(!l)return void setTimeout((()=>d(!0)),0);const{width:a,height:s}=t;if(0===a||0===s)return;o.drawImage(e,0,0,a,s);const u=n.current,m=r.current;u&&m&&(c(u,P0),c(m,R0))}),[e,c,l]);return h.useEffect((()=>{u()}),[u]),w.jsxs("div",{style:o,className:O0,children:[w.jsx("canvas",{ref:s,style:{...a,opacity:0},width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}),w.jsx("canvas",{ref:r,className:L0,style:a,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}),w.jsx("div",{className:F0,style:(m=t||{},{mixBlendMode:m.backgroundBlendMode,opacity:m.opacity,filter:m.styles,WebkitFilter:m.styles}),children:w.jsx("canvas",{ref:i,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0,className:M0,style:a})}),w.jsx("canvas",{ref:n,className:U0,style:{...E0(t||{}),...a},width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0})]});var m})),V0=_.memo((({image:e,filter:t,layer:o,style:a,sizeStyle:i})=>{const s=tl((e=>e.studioLocal.layerTempValues)),n=h.useRef(null),r=h.useRef(null),l=h.useRef(null),[d,c]=h.useState(!1),u=h.useCallback((()=>{const t=l.current;if(!t||!e)return!1;const{width:o,height:a}=t;if(o<0||a<0)return!1;const i=t.getContext("2d");if(!i)return!1;i.drawImage(e,0,0,o,a);try{return i.getImageData(0,0,o,a)}catch(IGe){return console.error("CANVAS ERROR",IGe),null}}),[e]),m=h.useCallback(((e,t,a,i)=>{if(!o)return null;const{chromaKeyThresholdTemp:n,chromaKeyHueTldTemp:r,chromaKeySatTldTemp:l,chromaKeyValTldTemp:d}=s[o.id]||{},c=n||o.chromaKeyThreshold||0,u=r||o.chromaKeyHueThreshold||0,m=l||o.chromaKeySatThreshold||0,p=d||o.chromaKeyValThreshold||0;if("colorKey"===o.chromaKeyChannel){const{H:o,S:s,V:n}=I0(e,t,a);return!(Math.abs(i.H-o)>=u&&Math.abs(i.H-o-360)>=u&&Math.abs(i.H-o+360)>=u)&&(!(Math.abs(i.S-s)>=m)&&!(Math.abs(i.V-n)>=p))}const h="green"===o.chromaKeyChannel?t:a,g="green"===o.chromaKeyChannel?[e,a]:[e,t],f=Math.max(e,t,a);if(f!==h)return!1;return f-Math.max(...g)>255-c}),[o,s]),p=h.useCallback((async()=>{const t=n.current,a=null==t?void 0:t.getContext("2d");if(!o)return;const{chromaKeyChannel:i,chromaKeyColor:s}=o;if("colorKey"===i&&s===ey){if(t&&a&&e){const{width:o,height:i}=t;a.drawImage(e,0,0,o,i)}return}let r;if("colorKey"===i&&s){const e=parseInt(s.slice(1,3),16),t=parseInt(s.slice(3,5),16),o=parseInt(s.slice(5,7),16);r=I0(e,t,o)}if(t&&r&&l.current){const e=u();if(!e)return;const t=e.data;for(let o=0;o<t.length;o+=4)m(t[o]??0,t[o+1]??0,t[o+2]??0,r)&&(t[o+3]=0);((e,t,o)=>{if(!t||!o)return;const{width:a,height:i}=t,s=t.getContext("2d");if(!s)return;const n=null==o?void 0:o.getContext("2d");if(!n)return;n.imageSmoothingEnabled=!0;const{width:r,height:l}=o;try{s.putImageData(e,0,0),n.clearRect(0,0,r,l),n.drawImage(t,0,0,a,i,0,0,r,l)}catch(IGe){console.error("CANVAS ERROR",IGe)}})(e,l.current,n.current)}}),[o,u,m,e]),g=h.useCallback((()=>{const a=n.current,i=null==a?void 0:a.getContext("2d");if(!a||!i||!e)return;if(!d)return void setTimeout((()=>c(!0)),0);const{width:s,height:l}=a;if(0===s||0===l)return;i.clearRect(0,0,s,l),(null==o?void 0:o.chromaKey)?p():i.drawImage(e,0,0,s,l);const u=r.current,m=null==u?void 0:u.getContext("2d");t&&m&&u&&(m.save(),m.clearRect(0,0,s,l),D0(t,m,e),m.restore(),i.save(),i.globalCompositeOperation="source-in",i.drawImage(u,0,0,s,l),i.restore())}),[e,t,p,null==o?void 0:o.chromaKey,d]);return h.useEffect((()=>{g()}),[g,e]),w.jsx("div",{children:qg()&&t?w.jsx(B0,{filter:t,image:e,style:a,sizeStyle:i}):w.jsxs(w.Fragment,{children:[w.jsx("div",{style:{display:"none"},children:w.jsx("canvas",{ref:l,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0})}),w.jsx("canvas",{ref:r,style:{display:"none"},width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}),w.jsx("canvas",{ref:n,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0,style:x0?a:i})]})})})),W0=[],G0=m((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),(e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.duration}),(e=>e.studioLocal.layerTempValues),(e=>e.studioLocal.draggedTracksOverrides),(e=>e.mediaCache),((e=[],t=0,o,a,i)=>{var s,n,r;const l=[];for(const d of e)if(!d.isHidden&&(om(d)||Zu(d))&&!lC(d)){const{assetSource:e,source:c}=d,u=null==a?void 0:a[d.id],m=iC(d,u),p=nl(m),h=Tu(d,i);let g,f,y=!1;UI()&&om(d)&&(null==(s=d.preview)?void 0:s.fragmented)&&(null==(n=d.preview)?void 0:n.url)?(g=d.preview.url,f=d.preview.asset_id,y=!!d.preview.fragmented):g=k0(d);const v={layerId:d.id,playbackRate:Number(d.playbackRate)||1,mediaId:h||d.asset_id||d.uploadId||d.id,url:g,type:d.type,volume:(null==(r=o[d.id])?void 0:r.volumeTemp)??d.volume??1,relativeStartEndTimes:[wS(m.startTime||0),wS(m.endTime??(m.startTime||0)+d.duration)],startEndTimes:[wS(m.videoDelay||0),wS((m.videoDelay||0)+p)],mediapipe:(null==d?void 0:d.removeBg)||(null==d?void 0:d.blurBg),fragmented:y,previewAssetId:f,disableCORS:e&&["Google Photos","Youtube"].includes(e)&&!A0(g)||"pastedLink"===c};u&&("trim-start"===u.type||"trim-end"===u.type||u.leftMost)&&(v.shouldBePlayingOverride=!0),v.startEndTimes[1]===wS(t)&&(v.isAtEnd=!0),l.push(v)}return 0===l.length?W0:l.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]))}));function H0({dragOverride:e,layer:t,layerTempValues:o,mediaCacheId:a,sceneDuration:i}){var s,n,r;const l=iC(t,e),d=nl(l),{assetSource:c,source:u}=t;let m,p,h;UI()&&(null==(s=t.preview)?void 0:s.fragmented)&&(null==(n=t.preview)?void 0:n.url)?(m=t.preview.url,h=t.preview.asset_id,p=!!t.preview.fragmented):m=k0(t);const g={layerId:t.id,playbackRate:Number(t.playbackRate)||1,mediaId:a||t.asset_id||t.uploadId||t.id,url:m,fragmented:p,previewAssetId:h,disableCORS:c&&["Google Photos","Youtube"].includes(c)&&!A0(m)||"pastedLink"===u,type:t.type,volume:t.isMuted?0:(null==(r=o[t.id])?void 0:r.volumeTemp)??t.volume??1,relativeStartEndTimes:[wS(l.startTime||0),wS(l.endTime??(l.startTime||0)+t.duration)],startEndTimes:[wS(l.videoDelay||0),wS((l.videoDelay||0)+d)],mediapipe:!!om(t)&&(t.removeBg||t.blurBg)};return e&&("trim-start"===e.type||"trim-end"===e.type||e.leftMost)&&(g.shouldBePlayingOverride=!0),g.startEndTimes[1]===wS(i)&&(g.isAtEnd=!0),g}m((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),((e=[])=>{const t=[];for(const o of e){const[e,a]=TS(o);t.push({...o,absoluteStartTime:e,absoluteEndTime:a})}return t}));const $0=m((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),(e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.duration}),(e=>e.studioLocal.layerTempValues),(e=>e.studioLocal.draggedTracksOverrides),(e=>e.mediaCache),(e=>e.studio.canvasBlur),((e=[],t=0,o,a,i,s)=>{const n=[];for(const l of e)if(!l.isHidden&&om(l)&&lC(l)){const e=Tu(l,i),s=H0({dragOverride:null==a?void 0:a[l.id],layer:l,layerTempValues:o,mediaCacheId:e,sceneDuration:t});n.push(s)}if(s)return n.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]));const r={};for(const l of n){const e=r[l.mediaId];e?e.push(l):r[l.mediaId]=[l]}return Object.values(r).forEach((e=>{e.sort(((e,t)=>e.relativeStartEndTimes[0]-t.relativeStartEndTimes[0]))})),n.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]))})),K0=e=>({layerId:e.layerId,startEndTimes:[e.startEndTimes[0],e.startEndTimes[1]]});function z0(e,t){return{...K0(e),whichElementPool:t}}const Y0=m($0,G0,((e,t)=>{const o=[],{studio:a}=sr().state;return e.forEach((e=>o.push(z0(e,"ep")))),t.forEach((e=>{const t=fT(e.layerId,a);t&&dC(t)&&o.push(z0(e,"canvas"))})),o})),J0=({selectElementPoolLayers:e=$0,selectPossibleReferenceLayers:t=Y0})=>m(e,t,((e,t)=>t),((e,t,o)=>{for(const a of e){const[e,i]=a.startEndTimes;if(e<=o&&o<i&&PH([e,i],o,t))return!0}return!1}));J0({selectElementPoolLayers:$0,selectPossibleReferenceLayers:Y0});const q0=({selectPossibleReferenceLayers:e,selectElementPoolLayers:t})=>{const o=J0({selectElementPoolLayers:t,selectPossibleReferenceLayers:e});return m(e,((e,t)=>t),o,((e,t,o)=>{if(o)return!1;const a=t-.03333333333333333,i=t+.03333333333333333,s=e.filter((e=>"canvas"===e.whichElementPool));for(const n of s){const[o,s]=n.startEndTimes;if(o<a&&i<s&&PH([o,s],t,e))return!0}return!1}))};q0({selectElementPoolLayers:$0,selectPossibleReferenceLayers:Y0});const X0=(e,t,o)=>!o&&!!DH(e,t,e+Q0),Q0=.16666666666666666,Z0=()=>m($0,G0,(e=>e.studioLocal.isLayerMountedByLayerId),((e,t)=>t),((e,t,o,a)=>{const i=e.find((e=>ME(a,e.startEndTimes[0],.03333333333333333)))||t.find((e=>e.type===zl.Video&&ME(a,e.startEndTimes[0],.03333333333333333)));return!!i&&!o[i.layerId]}));function e1(e,t,o,a){const i=Math.abs(e),s=Math.abs(t);let n=Math.abs(o),r=Math.abs(a);const l=i/s,d=n/r;let c=1,u=1,m=0,p=0;d<l?(c=i/n,u=i/n,r=i*r/n,n=i,p=Math.abs(r-s)/2):d>=l&&(c=s/r,u=s/r,n=s*n/r,r=s,m=Math.abs(n-i)/2);return{xScaleFactor:c,yScaleFactor:u,xOffset:-1*m,yOffset:-1*p}}function t1(e,t,o,a){if(!a)return{x:0,y:0,width:e,height:t};const i=yj(o,{x:0,y:0,width:a.naturalWidth,height:a.naturalHeight}),s=e1(e,t,i?i.width:a.naturalWidth,i?i.height:a.naturalHeight),n=yj(o,{x:0,y:0,width:s.xScaleFactor*a.naturalWidth,height:s.yScaleFactor*a.naturalHeight});return{x:s.xOffset-(n?n.x:0),y:s.yOffset-(n?n.y:0),width:s.xScaleFactor*a.naturalWidth,height:s.yScaleFactor*a.naturalHeight}}const o1=(e,t,o)=>{const a=Number(e.width);return{width:t,height:o,transform:`translate(${e.left}px, ${e.top}px) scale(${a/t})`,transformOrigin:"top left"}},a1=s.memoize(TS),i1={color:"white",fontWeight:600,fontSize:"12px",fontFamily:"Open Sans, sans-serif"},s1={display:"none"};let n1=class extends h.Component{constructor(e){super(e),i(this,"image",null),i(this,"handleClick",(()=>{const{selectItem:e}=this.props;e(null)})),i(this,"getImageContainerStyles",(()=>{var e;const{forMovingZoomControls:t,height:o,imageShadowBlurTemp:a,imageShadowDistTemp:i,imageShadowRotTemp:s,isBeingInlineCropped:n,layer:r,rotation:l,staticPreview:d,width:c,x:u,y:m,isWaitingForNextEPLayer:p,borderRadiusTemp:h,waitingForSeekToResolve:g}=this.props,{imageEffect:f}=r,[y,v]=this.props.absoluteTimes,{studioTime:_}=this.props,w=t||y<=_&&_<=v,b=Oz(h??null,r,c,o),T={x:"",y:""};(null==(e=r.position)?void 0:e.flip)&&!this.props.forMovingZoomControls&&Object.assign(T,{x:r.position.flip.x?" scaleX(-1)":"",y:r.position.flip.y?" scaleY(-1)":""});const x=!(d||w||p||g);let S="",E="";if(r.imageEffect&&"dropShadow"===f){const e=.5*(a||r.imageShadowBlur||0),t=i||r.imageShadowDist||0,o=(s||r.imageShadowRot||0)*Math.PI/180;S=`drop-shadow(${2*t*Math.cos(o)}em ${2*t*Math.sin(o)}em ${e}em ${r.imageEffectColor})`,(qg()||Jg())&&(E="filter")}let I=l||0;return 0!==b&&l&&l%90==0&&0!==l&&(I+=1e-5),{position:"absolute",left:u,top:m,width:c,height:o,overflow:n?"visible":"hidden",zIndex:n?5:"auto",filter:S,willChange:E,transform:`rotate(${I}deg)${T.x}${T.y}`,display:x?"none":"block",borderRadius:`${b}px`}})),i(this,"checkAnimationType",(e=>e&&e.type&&"none"!==e.id)),i(this,"getSizeStyles",(()=>{const{width:e,height:t,layer:o}=this.props,a=t1(e,t,o.crop,this.image);return{width:a.width,height:a.height}})),i(this,"getImageStyles",(()=>{const{width:e,height:t,staticPreview:o,layer:a,duration:i,trackIsBeingManipulated:s,isWaitingForNextEPLayer:n,keyframeChannels:r,studioTime:l,forMovingZoomControls:d,absoluteTimes:c,tempFilters:u,waitingForSeekToResolve:m}=this.props,[p,h]=c,g=!(o||(d||p<=l&&l<=h)||n||m),f=t1(e,t,cI(a,l,s),this.image),y={position:"absolute",left:f.x,top:f.y,width:f.width,height:f.height};if(this.props.forMovingZoomControls)return y;const{width:v,height:_}=t1(e,t,wj,this.image),w=o1(y,v,_),b=Mx(a);let T={};!o&&i&&b.some((e=>"none"!==(null==e?void 0:e.id)))&&(T=UQ(a,w.transform),w.transform="");let x=u||a.filters;r&&(x=cx(a,r,l));return VQ({position:"absolute",filter:S0(x,e,t,a),display:g?"none":"block",...w},T)})),i(this,"getAnimationOutlineStyles",(()=>{const{staticPreview:e,layer:t,duration:o}=this.props;let a={};const i=b0(this.props,this.props.borderRadiusTemp??null),s=Mx(t);return!e&&o&&s.some((e=>"none"!==(null==e?void 0:e.id)))&&(a=UQ(t,i.transform)),{...i,...a}})),i(this,"imageRef",(e=>{this.image=e,LE(this.props.layer.id,{layerRef:e})})),this.state={loaded:!1}}componentDidUpdate(){const{staticPreview:e,layer:t,duration:o,updateLayerAnimationPosition:a}=this.props,i=Mx(t);if(!e&&o&&a)if(i.some((e=>"none"!==(null==e?void 0:e.id)))){const e=UQ(t);i.some((e=>e.layerInvolvesMovement))&&a(e)}else i.some((e=>this.checkAnimationType(e)))&&a(void 0)}hasPresetFilter(){const{layer:e}=this.props;return e.presetFilter&&e.presetFilter.name&&"Original"!==e.presetFilter.name||!0===e.chromaKey}renderImage(){const{loaded:e}=this.state,{url:t}=this.props;return w.jsx("img",{"data-cy":"image",ref:this.imageRef,src:t,onLoad:()=>{Nw("canvas"),this.setState((e=>({...e,loaded:!0})))},className:[WQ.image,WQ.disableselect].join(" "),style:e&&!this.hasPresetFilter()?this.getImageStyles():{display:"none"},draggable:!1,alt:"Studio preview"})}renderFilterImage(){const{loaded:e}=this.state,{layer:t}=this.props;return w.jsx(V0,{image:this.image,filter:t.presetFilter,layer:t,style:e?this.getImageStyles():s1,sizeStyle:this.getSizeStyles()})}renderConversion(){return w.jsx("div",{className:WQ.videoConversion,children:w.jsx(MU,{textStyles:i1,text:"Converting Image..."})})}render(){const e=this.getImageContainerStyles(),{layer:t}=this.props,{loaded:o}=this.state;return w.jsxs("div",{children:[w.jsxs("div",{className:WQ.imageContainer,style:e,children:[t.requireConversion&&this.renderConversion(),o&&this.hasPresetFilter()&&this.renderFilterImage(),this.renderImage()]}),w.jsx("div",{style:this.getAnimationOutlineStyles(),className:WQ.outline,onClick:this.handleClick})]})}};const r1=g.connect((()=>{const e=Z0();return(t,o)=>{var a,i,s;const{imageShadowBlurTemp:n,imageShadowDistTemp:r,imageShadowRotTemp:l}=Lg(t,o.layer.id),d=a1(o.layer),[c,u]=d;let m=!1;X0(u,o.studioTime,XN(t))&&(m=e(t,u));const p=OQ(o.layer.id);return{absoluteTimes:d,containerWidth:t.studio.containerWidth,containerHeight:t.studio.containerHeight,duration:t.studio.scenes[0].duration,isBeingInlineCropped:(null==(a=t.studioLocal.layerTempValues[o.layer.id])?void 0:a.isBeingInlineCropped)||null,isDraggingGlobal:t.studio.isDragging,isResizingGlobal:t.studio.isResizing,isRotatingGlobal:t.studio.isRotating,imageShadowBlurTemp:n,imageShadowDistTemp:r,imageShadowRotTemp:l,trackIsBeingManipulated:Bg(t,o.layer.id),isWaitingForNextEPLayer:m,url:k0(o.layer),keyframeChannels:p(t),tempFilters:null==(i=t.studioLocal.layerTempValues[o.layer.id])?void 0:i.filters,borderRadiusTemp:null==(s=t.studioLocal.layerTempValues[o.layer.id])?void 0:s.borderRadiusTemp}}}),(e=>ye({selectItem:l_},e)))(n1),l1=(e,t,o)=>{const a=e.createShader(t);if(!a)return null;e.shaderSource(a,o),e.compileShader(a);return e.getShaderParameter(a,e.COMPILE_STATUS)?a:(console.error(e.getShaderInfoLog(a)),e.deleteShader(a),null)},d1=(e,t,o,a,i)=>{const s=t,n=t+a,r=o,l=o+i;e.bufferData(e.ARRAY_BUFFER,new Float32Array([s,r,n,r,n,l,s,l]),e.STATIC_DRAW)},c1=(e,t)=>{const o=e.FLOAT;e.vertexAttribPointer(t,2,o,!1,0,0)},u1=(e,t,o,a)=>{((e,t)=>{const o=e.getAttribLocation(t,"a_vertexPosition"),a=e.createBuffer();e.enableVertexAttribArray(o),e.bindBuffer(e.ARRAY_BUFFER,a),d1(e,-1,-1,2,2),c1(e,o);const i=e.getAttribLocation(t,"a_textureCoord"),s=e.createBuffer();e.enableVertexAttribArray(i),e.bindBuffer(e.ARRAY_BUFFER,s),d1(e,0,0,1,1),c1(e,i)})(e,t),((e,t)=>{const o=e.createTexture();e.bindTexture(e.TEXTURE_2D,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)})(e,o),((e,t)=>{const o=e.getUniformLocation(t,"u_resolution");e.uniform2f(o,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height)})(e,t),m1(e,t,{u_rotation:[a]})},m1=(e,t,o)=>{for(const[a,i]of Object.entries(o)){const o=e.getUniformLocation(t,a);1===i.length?e.uniform1fv(o,i):2===i.length?e.uniform2fv(o,i):3===i.length?e.uniform3fv(o,i):4===i.length&&e.uniform4fv(o,i)}},p1=(e,t,o,a)=>{const{key:i,valThreshold:s}=o;if(!i||void 0===s)return;const n=((e,t,o)=>{const a=l1(e,e.VERTEX_SHADER,t),i=l1(e,e.FRAGMENT_SHADER,o);if(!a||!i)return null;const s=e.createProgram();return s?(e.attachShader(s,a),e.attachShader(s,i),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)?(e.useProgram(s),s):(console.error(e.getProgramInfoLog(s)),e.deleteProgram(s),null)):null})(e,"\nprecision mediump float;\n\nattribute vec3 a_vertexPosition;\nattribute vec2 a_textureCoord;\nvarying vec2 v_textureCoord;\n\nuniform float u_rotation;\n\nvec2 rotateTexture(vec2 pixelCoord, float rotation) {\n  if(rotation == 0.0) return pixelCoord;\n\n  float angle = radians(-rotation);\n  float sine = sin(angle);\n  float cosine = cos(angle);\n\n  vec2 centerTranslation = - vec2(0.5, 0.5);\n  vec2 centeredCoord = pixelCoord + centerTranslation;\n  mat2 rotMatrix = mat2(cosine, -sine,\n                      sine, cosine);\n  vec2 rotatedCoord = rotMatrix * centeredCoord;\n\n  return rotatedCoord - centerTranslation;\n\n}\n\nvoid main() {\n  gl_Position = vec4(a_vertexPosition, 1.0);\n  v_textureCoord = rotateTexture(a_textureCoord, u_rotation);\n}\n","\nprecision mediump float;\n\n// Passed in from the vertex shader\nvarying vec2 v_textureCoord;\n\n// Global variables\nuniform sampler2D u_textureImage;\nuniform vec3 u_key;\nuniform float u_threshold;\n\nbool shouldKeyOut(vec4 rgb) {\n  float diff = sqrt(\n    (\n      (rgb.r - u_key[0]) * (rgb.r - u_key[0])\n        + (rgb.g - u_key[1]) * (rgb.g - u_key[1])\n        + (rgb.b - u_key[2]) * (rgb.b - u_key[2])\n    ) / 3.0\n  );\n\n  return diff < u_threshold;\n}\n\nvoid main() {\n  // Get pixel color from the texture.\n  vec4 color = texture2D(u_textureImage, v_textureCoord);\n\n  float transparency = 1.0;\n  if (shouldKeyOut(color)) transparency = 0.0;\n  gl_FragColor = vec4(color.rgb, transparency);\n}\n");if(!n)return;u1(e,n,t,a);const r={u_key:[i.R,i.G,i.B],u_threshold:[s]};m1(e,n,r),(e=>{e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4)})(e)},h1=(e,t,o,a,i,s,n,r)=>{if("audio"===e.type&&!e.isAudiogram)return{};const l=n?cx(e,n,r):e.filters;let d={filter:S0(l,i,s,e),display:"audio"===e.type?"none":"block",opacity:1,...a};const c=Fx(e),{introTransition:u,outroTransition:m}=Bx(e);if(!t&&("none"!==(null==c?void 0:c.id)||u||m)){const t=BQ(e,!!o,d.transform||"",u),a=BQ(e,!!o,d.transform||"",m);d={...VQ(d,UQ(e,d.transform||"")),...t,...a}}return d},g1=(e,t,o,a)=>{const i=function(e,t,o){const a=yj(o,{x:0,y:0,width:t[0],height:t[1]}),i=e1(e[0],e[1],a?a.width:t[0],a?a.height:t[1]),s=yj(o,{x:0,y:0,width:i.xScaleFactor*t[0],height:i.yScaleFactor*t[1]});return{x:i.xOffset-(s?s.x:0),y:i.yOffset-(s?s.y:0),width:i.xScaleFactor*t[0]||e[0],height:i.yScaleFactor*t[1]||e[1]}}(t,o,e),{width:s,height:n}=y1(o,[i.width,i.height]);return{position:"relative",left:i.x,top:i.y,width:a?i.width:s,height:a?i.height:n}},f1=(e,t)=>{const{width:o,height:a}=g1(wj,e,t);return{width:Number(o),height:Number(a)}},y1=(e,t)=>{const[o,a]=t,i=e[1]?e[0]/e[1]:t[0]/t[1],s=Math.ceil(o),n=Math.ceil(a);let r,l;return s-o>n-a?(l=s,r=s*(1/i)):(r=n,l=n*i),{width:l,height:r}};const v1=async(e,t,o,a)=>{let i=((e,t)=>{const{state:o}=sr(),{draggedTracksOverrides:a={}}=o.studioLocal,i=um(e),s=!!a[e.id];let n=1;e.playbackRate&&(n=e.playbackRate);let r=t;return r-=e.videoDelay||0,r>i&&!s&&(r%=i),r*=n,r+=e.startTime||0,e.isReversed&&(r=e.duration-r),r})(e,o);if(i>=t.duration&&(i=t.duration-.01),e.isReversed){const t=e.duration-i;a&&(a.currentTime=t)}await FH(t,i)},_1={slow:3,default:1,fast:.5},w1={invertedParabola:(e,t=!0)=>t?1-(1-e)*(1-e):(1-e)*(1-e)},b1=(e,t,o)=>({startTime:o-t,endTime:o-e}),T1=(e,t,o)=>({startTime:-1*(t-o),endTime:-1*(e-o)}),x1=()=>!Xg();class S1{constructor(){i(this,"mutexes",new Map)}getMutex(e){const t=this.mutexes.get(e);if(t)return t;const o=new st;return this.mutexes.set(e,o),o}async runExclusive(e,t){return this.getMutex(e).runExclusive(t)}}const E1=e=>e/1e3;function I1(){const{state:e}=sr(),t={},o=Object.values(e.studio.allLayers.byId);t["Number of Layers"]=o.length;let a=0;const i=new Set,s={video:0,text:0,audio:0,image:0};for(const n of o)s[n.type]&&(s[n.type]+=1),n.animation&&(a+=1),n.asset_id&&i.add(n.asset_id);t["Number of animations"]=a,t["Number of unique assets"]=i.size;for(const[n,r]of Object.entries(s))t[`Number of ${jc(n)} Layers`]=r;return t}let C1={Canvas:0,"Main Studio View":0,"Studio Trackpad":0};const k1=(e,t)=>{C1[e]+=t,A1.components[e].numberOfRenders+=1,A1.components[e].totalDuration+=t,A1.components[e].totalSquaredDuration+=t*t};let A1={components:{Canvas:{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Main Studio View":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Studio Trackpad":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0}},"Project fetch time":[],unresponsiveness:{frustratedClicks:0,superduperAngryClicks:0,past2Seconds:0,past5Seconds:0},waveforms:{}};function j1(){const e=tl((e=>e.studioLocal.isProjectFetched));return h.useEffect((function(){if(e)return()=>{};const t=performance.now();return()=>{const e=performance.now();A1["Project fetch time"].push(E1(e-t))}}),[e]),h.useEffect((function(){let e,t=0,o=performance.now();const a=()=>{const e=performance.now(),a=e-o;o=e,a>=2e3&&(A1.unresponsiveness.past2Seconds+=1,a>=5e3&&(A1.unresponsiveness.past5Seconds+=1)),t>5&&(A1.unresponsiveness.frustratedClicks+=1,t>25&&(A1.unresponsiveness.superduperAngryClicks+=1)),(a>=2e3||t>5)&&Fm(ym.KAPWING_FROZE,{...I1(),duration:a>=2e3?a:void 0,clicks:t>5?t:void 0,lastDispatchedActions:JSON.stringify(XL),recentDispatchedActions:JSON.stringify(QL),timeInReduxSelectors:wF,timeInCanvas:C1.Canvas,timeInMainStudioView:C1["Main Studio View"],timeInStudioTrackpad:C1["Studio Trackpad"],timeInReduxReducer:YL}),t=0,YL=0,QL={},C1={Canvas:0,"Main Studio View":0,"Studio Trackpad":0},wF=0},i=()=>{a(),e=setTimeout(i,200)};function s(){t+=1}function n(){e&&(clearInterval(e),e=void 0),"visible"===document.visibilityState&&(o=performance.now(),i())}return"visible"===document.visibilityState&&i(),window.addEventListener("click",s,{capture:!0,passive:!0}),document.addEventListener("visibilitychange",n),()=>{e&&clearInterval(e),window.removeEventListener("click",s,{capture:!0}),document.removeEventListener("visibilitychange",n)}}),[]),h.useEffect((function(){return A1={components:{Canvas:{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Main Studio View":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Studio Trackpad":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0}},"Project fetch time":[],unresponsiveness:{frustratedClicks:0,superduperAngryClicks:0,past2Seconds:0,past5Seconds:0},waveforms:{}},()=>{const e={...ip()},t=A1["Project fetch time"].reduce(((e,t)=>e+t),0)/A1["Project fetch time"].length;e["Project fetch time"]=Number.isNaN(t)?null:t;for(const[d,c]of Object.entries(A1.components)){const{numberOfRenders:t,totalDuration:o,totalSquaredDuration:a}=c,i=o/t,s=a/t-i*i,n=Math.sqrt(s);e[`${d} (Avg)`]=Number.isNaN(i)?null:i,e[`${d} (Std)`]=Number.isNaN(n)?null:n,e[`${d} (Count)`]=t}const o=E1(performance.now());let a=0,i=0,s=0,n=0,r=0;const l=[];for(const[d,c]of Object.entries(A1.waveforms)){let e=0;void 0===c.duration?(a+=1,e=o-c.startTime,r+=e):(e=c.duration,i+=1,s+=c.duration,n+=c.fileDuration??0),e>=600&&l.push({assetId:d,videoDuration:c.fileDuration,completed:void 0!==c.duration,generationTime:e})}e["Avg waveform generation time"]=s/i,e["Avg unfinished waveform time"]=r/a,e["Generation time per asset second"]=s/n,e["Number of page unresponsive instances for 2 seconds"]=A1.unresponsiveness.past2Seconds,e["Number of page unresponsive instances for 5 seconds"]=A1.unresponsiveness.past5Seconds,e["Number of frustrated clicks (>5 clicks before page responds)"]=A1.unresponsiveness.frustratedClicks,e["Number of frustrated clicks (>25 clicks before page responds)"]=A1.unresponsiveness.superduperAngryClicks,Fm(ym.PERFORMANCE_BASELINE,e),l.length>0&&Math.random()<.2&&l.forEach((e=>{Fm(ym.LONG_WAVEFORM_GENERATION,{...e,...ip()})}))}}),[]),null}class N1{constructor(e,t){this.unallocate=()=>{this.dataArray=new Float32Array},this.dataArray=new Float32Array(t),this.duration=e.duration,this.sampleRate=e.sampleRate,this.isFfmpeg=e.isFfmpeg,this.scalingFactor=e.scalingFactor}static async fromDataFile(e){const t=await e.file.arrayBuffer();return new N1(e,t)}}const R1=()=>zg()||Zg.isChromium(),P1=(e,t)=>{var o;return!(!(null==(o=e.waveformInfo)?void 0:o.cdnUrl)||!1===t.waveformDataFetchSucceeded)},D1=m([e=>e.assets.layerIdsByAssetId,e=>e.assets.byId,e=>e.assets.assetWaveformData],((e,t,o)=>Object.keys(e).filter((e=>!O1.has(e))).filter((e=>{const a=t[e],i=(null==a?void 0:a.file_size)&&a.file_size>52428800;return a&&!P1(a,o[a._id]??{})&&i}))));let O1=new Set;const L1=_.memo((()=>{const e=h.useRef({}),t=h.useRef(),o=tl((e=>D1(e)),g.shallowEqual);return h.useEffect((()=>{const o=async()=>{try{await(async()=>{const t=e.current;for(const o in t){const a=t[o],{job:i}=await Yr(`/api/v1/decode/${a}`),{status:s,decodedWaveformInfo:n}=i;n&&Q$(o,{waveformInfo:n}),"success"!==s&&"failed"!==s||("failed"===s&&console.error(`Decode job ${a} failed for asset ${o}`),delete e.current[o])}})()}catch(IGe){console.error("error polling decode jobs",IGe)}t.current=window.setTimeout(o,2e3)};return o(),()=>{O1=new Set,t.current&&clearTimeout(t.current)}}),[]),o.forEach((async t=>{try{if(O1.has(t))return;O1.add(t),console.debug(`Kicking off decode job for asset ${t}`);const{decodeJobId:o}=await Jr("/api/v1/decode",{body:{assetId:t}});if(!o)throw Error("No decode job id returned");e.current={...e.current,[t]:o}}catch(IGe){console.error("Error trying to kick off decode job for asset",t,IGe)}})),null})),F1=23,M1=R1(),U1=1,B1=30,V1=29,W1=Math.log(30),G1=Math.floor(110.25),H1=["track","preview","original"],$1=new st,K1=new S1,z1=qg(),Y1=(e,t)=>new Promise(((o,a)=>{const i=e.decodeAudioData(t);i&&"then"in i?i.then((e=>o(e))).catch((e=>a(e))):e.decodeAudioData(t,(e=>o(e)),(e=>{e&&a(e)}))})),J1=async e=>{window.AudioContext=window.AudioContext||window.webkitAudioContext;const t=await e.arrayBuffer(),o=XG(),a=await Y1(o,t),i=new OfflineAudioContext(a.numberOfChannels,22050*a.duration,22050),s=i.createBufferSource();s.buffer=a,s.start(0),s.connect(i.destination);const n=await(r=i,new Promise(((e,t)=>{r.oncomplete=t=>e(t.renderedBuffer);const o=r.startRendering();o&&o.catch&&o.catch((e=>t(e)))})));var r;const l=n.getChannelData(0),d=new Float32Array(Math.floor(l.length/G1));for(let m=0,p=0;m<l.length;m+=G1,p+=1){let e=0;for(let o=0;o<G1;o+=1)e+=Math.abs(l[m+o]??0);const t=e/G1;d[p]=t}const c=d.filter((e=>e>.01)).sort(((e,t)=>e-t)),u=1/(c.length>0?c[Math.floor(.95*c.length)]??1:1);if(1!==u)for(let m=0;m<d.length;m+=1){const e=d[m]*u,t=Math.log(29*e+1)/W1;d[m]=t}return[d,{duration:n.duration,sampleRate:n.sampleRate/G1,scalingFactor:u}]},q1={audio:{desktop:100*vn,lowendDesktop:30*vn,mobile:10*vn},video:{desktop:1.9*_n,lowendDesktop:200*vn,mobile:100*vn}};async function X1(e,t,o){const a=new Worker("/waveform-worker.js");try{a.postMessage({sourceFile:e});const{data:i,duration:s,errorMessage:n}=await new Promise((e=>{a.onmessage=t=>{a.terminate(),t.data&&e({errorMessage:t.data.errorMessage,data:t.data.data,duration:t.data.duration})}}));if(n)throw new Error(`ffmpeg error: ${n}`);if(void 0===i||void 0===s)throw new Error("ffmpeg error: no data or duration");const r=new File([i],"file");return XJ(t,o),{file:r,duration:s,sampleRate:i.length/s,isFfmpeg:!0}}catch(IGe){return a.terminate(),Z1(t,{method:"ffmpeg",error:IGe.message,assetQuality:o},IGe),null}}async function Q1(e,t){const o=zg(),a=o&&Yg(),i=sr().state.mediaCache.mediaCacheIdToAssetId[e],s=(()=>{if(o)return"mobile";if(!("memory"in performance))return"desktop";return performance.memory.jsHeapSizeLimit<2147483648?"lowendDesktop":"desktop"})(),n="audio"===t.type?"audio":"video",{file:r,assetQuality:l,hasAudio:d,assetDuration:c}=_$(t,H1);if(!1===d)return null;if(!r)throw console.error(t),Error("No file");i&&((e,t)=>{A1.waveforms[e]={startTime:E1(performance.now()),fileDuration:t}})(i,c);const u=!a&&r.size>q1[n][s]||z1&&"video/quicktime"===r.type;let m=null;const p={size:r.size,type:r.type,duration:c};if(await $1.runExclusive((async()=>{u?(qJ({mediaCacheId:e,method:"ffmpeg",fileMetadata:p,assetQuality:l}),m=await X1(r,e,l)):(qJ({mediaCacheId:e,method:"audioContext",fileMetadata:p,assetQuality:l}),m=await async function(e,t,o,a){try{const[i,s]=await J1(e);if(Math.abs(s.duration-t)>=2)throw new Error("Waveform duration delta too large");const n=new File([i],"file");return XJ(o,a),{file:n,duration:s.duration,sampleRate:s.sampleRate,scalingFactor:s.scalingFactor,isFfmpeg:!1}}catch(IGe){return Z1(o,{error:IGe.message,method:"audioContext",assetQuality:a},IGe),null}}(r,c||0,e,l),m||(qJ({mediaCacheId:e,method:"ffmpeg fallback",fileMetadata:p,assetQuality:l}),m=await X1(r,e,l)))})),!m)return null;i&&(e=>{A1.waveforms[e]&&(A1.waveforms[e].duration=E1(performance.now())-A1.waveforms[e].startTime)})(i),s$(e,{waveformData_v5:m});const h=sr().state.mediaCache.mediaCacheIdToAssetId[e];return h&&X$(h,m),N1.fromDataFile(m)}const Z1=(e,t,o)=>{console.error("Waveform log generation failed!!",t.method,t.error);const{dispatch:a}=sr();var i,s;((e,t,o)=>{var a;if(!GJ)return;const i=null==(a=GJ.assetsInProject[e])?void 0:a.assetLoadInfo[t];if(!i)return void console.error(`Asset of quality ${t} not found for mediaCacheId ${e}`);const{currentWaveformGenerationAttempt:s,waveformGenerationLogs:n}=i;if(!s)return void console.error(`Ongoing waveform generation attempt not initialized for ${t} asset of mediaCacheId ${e}`);const r=WJ()-s.timeStarted,l=null==n?void 0:n[o];if(l){if(!0===l.success)return;const{avgTime:e,attemptNumber:t}=l;l.avgTime=(e*t+r)/(t+1),l.attemptNumber=t+1}else i.waveformGenerationLogs={...n||{},[o]:{success:!1,avgTime:r,method:s.method,attemptNumber:1}};i.currentWaveformGenerationAttempt=void 0})(e,t.assetQuality,ph(o,"UNKNOWN_ERROR").message),Math.random()<.1&&R(o,{tags:{audioContextFailure:!0,assetId:t.assetId,fileType:t.fileType}}),a(Tp({waveformCreationFailure:!0,waveformUsesFFMPEG:"ffmpeg"===t.method})),t.assetId&&(i=t.assetId,delete A1.waveforms[i]),s=t,Fm(ym.WAVEFORM_GENERATION_FAILURE,{...s,...ip()})};async function e2(e){const t=await d$(e);return t&&"image"!==t.type?"waveformData_v5"in t&&t.waveformData_v5?N1.fromDataFile(t.waveformData_v5):K1.runExclusive(e,(async()=>{const o=await d$(e);return o?"image"===o.type?null:"waveformData_v5"in o&&o.waveformData_v5?N1.fromDataFile(o.waveformData_v5):((e,t,o=M1)=>{const{state:a}=sr(),{mediaCache:i,assets:s}=a,n=i.mediaCacheIdToAssetId[e],r=n?s.byId[n]:void 0,l=n?s.assetWaveformData[n]:void 0;if(r&&P1(r,l||{}))return!1;const{file:d}=_$(t,H1);return!(o&&(null==d?void 0:d.size)&&(null==d?void 0:d.size)>52428800)})(e,t)?Q1(e,o):null:null})):null}function t2(){return new Worker("/assets/reverseaudio-worker-a4fae9ac.js")}const o2=(e,t)=>!(e<0||e>64)&&(e<8?Boolean(t[0]&1<<e):e<16?Boolean(t[1]&1<<e-8):e<24?Boolean(t[2]&1<<e-16):Boolean(t[3]&1<<e-24)),a2=({blurPixels:e,image:t,createCanvas:o=((e,t)=>{const o=document.createElement("canvas");return o.width=e,o.height=t,o}),width:a,height:i})=>{if(!("width"in t)||!("height"in t)||"number"!=typeof t.width||"number"!=typeof t.height)throw Error("Unexpected SVG image");const[s,n]=[a||t.width,i||t.height],r=3*e,l=o(s+2*r,n+2*r),d=l.getContext("2d");if(!d)throw Error("Failed to create canvas ctx");const[c,u,m,p,h,g,f]=[t.width,t.height,s,n,r,s+r,n+r];return d.drawImage(t,0,0,c,1,h,0,m,h),d.drawImage(t,0,u-1,c,1,h,f,m,h),d.drawImage(t,0,0,1,u,0,h,h,p),d.drawImage(t,c-1,0,1,u,g,h,h,p),d.drawImage(t,0,0,1,1,0,0,h,h),d.drawImage(t,c-1,0,1,1,g,0,h,h),d.drawImage(t,0,u-1,1,1,0,f,h,h),d.drawImage(t,c-1,u-1,1,1,g,f,h,h),d.drawImage(t,h,h,m,p),[l,r]};async function i2(e){const{bucket_name:t,blob_name:o,url:a}=e;if(a)return a;if(t)return`${gn}/${t}/${o}}`;try{if((await Wr(`${gn}/${hn}/${o}}`,{method:"HEAD"})).ok)return`${gn}/${hn}/${o}}`}catch(IGe){}return`${gn}/kapwing/${o}}`}const s2=_.memo(h.forwardRef((({style:e,children:t,layer:o},a)=>w.jsx("div",{style:e,"data-cy":"filter-layer-style-wrapper",children:w.jsx("div",{ref:a,className:o.presetFilter?`cssco ${o.presetFilter.className}`:"","data-cy":"filter-style-wrapper",children:t})})))),n2=_.memo((e=>{const{width:t,height:o,x:a,y:i,background:s}=e,n="#ffffff"===s.toLowerCase()?"https://storage.googleapis.com/kapwing/samples/waveform_placeholder_purple.png":"https://storage.googleapis.com/kapwing/samples/waveform_placeholder_pwhite.png";return w.jsx("img",{style:{width:t,height:o,left:a,top:i},src:n,alt:"Waveform placeholder"})})),r2=[[204.35838132923993,203.00945332832035,199.65900469732605,194.98271845278515,189.56132214289326,183.33473438912372,172.52400430499736,167.07532066537684,187.47065016402843,198.68807545388097,203.48982568521964,204.1176240653317,202.15691732602392,200.06529787993665,199.29780568337057,198.68467837138908,197.26189269581153,195.4906761781706,193.5894680197673,190.99841409170546,187.04933995236826,182.25360885686126,177.63250777500204,173.28407960282425,167.70417685616633,158.76226893469703,144.56500607291406,141.00209952410114,145.56804845329737,145.98247959194708,151.30333957601397,158.65594331047583,163.28351501985006,165.0274425332393,164.56009034724005,162.69563468431807,160.3371300218423,158.2700085578228,157.39999468815182,158.03471062124936,159.09200990304208,159.69089115160511,159.86921679067325,159.6075664376986,158.52087286589776,156.6650151944958,155.10307758735354,154.76731334199766,154.53817469416,152.83946762235234,149.7773929680549,146.91810966789785,145.2304213494264,144.0396936303876,142.34788989257112,140.02924475411893,137.86488379627102,136.94443024999612,137.23038873543342,137.02795358522172,135.09262390148805,131.78995127630665,127.15201700601123,118.07364045259453,92.95048846026552,111.58227970522246,129.45278563115795,138.2921805525958,143.1711053210688,145.54670069071844,146.10057562215798,145.83463815520878,146.36977981790818,148.0554387843523,149.43629769169783,149.03798836610676,145.92771765577686,140.3413699534398,134.16252749146054,130.7483709722678,129.62976562861337,128.55726783363963,128.17372090103626,128.68453448110859,129.61467268224547,131.37936708272957,133.615185772025,134.24522747949015,132.49724810152492,130.3479207101576,132.49438546853943,136.93991181373855,139.66216072746448,140.10834545254787,138.1270546398033,132.51069038452,120.69558867721602,89.01754914367318,110.34211587855022,120.83417434236462,122.36200772241834,119.71362583248677,117.22074187792266,119.75264768893518,126.5367395343374,132.2061093130478,133.96693353280494,130.6684966876412,123.6815217863759,126.52157795061277,134.62983091628038,139.3180272591702,140.28667668531253,137.62219818584865,131.98348466528336,124.07663570706792,114.2267694499014,103.44772202882844,92.9584608439638,83.35329993623219,82.46689771012865,75.82770036464417,66.06349703115293,98.03414526793118,111.33889876855572,118.98648423031145,122.54177224513953,122.47951959397489,118.64583070128839,113.87371352182163,119.12974241422387,127.33420020821598,131.46335674969552,131.3822456107658,127.3830481228133,119.37978564347974,107.60067684669835,111.66825278667098,124.05076277537741,131.22772394028615,134.48448788702927,134.7861839517469,131.92539177767685,127.40494750758486,124.68811639326971,123.8965060008981,120.9054998438967,114.88101986961341,109.76176859442026,112.1629841277428,119.27887876494424,124.82951411454222,128.02837046990257,129.85943432178908,131.89986646363,134.2959664200011,135.78516337340758,135.22114124260463,131.84250434163295,126.45507975231583,121.93106290183131,122.11921102289395,126.02335733427888,130.41644177850932,134.06653952639124,136.5638564699891,138.01616957258577,138.23945775755297,136.29941618189454,131.33912440717808,125.33728980410184,126.77827246986509,131.88614297305546,134.5995306065226,136.2399757750571,139.04068907529907,142.9197060262825,145.9078344918701,147.13650225775328,146.41335613205808,143.84972114295687,139.64912794324272,134.3253574737259,129.02642302040337,124.93796462149683,121.5393264193191,117.322732247941,114.73057166609908,118.8452229107018,125.32158129160658,130.25817923584472,133.19297336645127,134.27063636776148,133.61613697497285,131.3563797543291,127.81845352593217,124.49172753170508,123.7513624080227,124.38224504365684,121.98895450367736,114.08596503252865,105.82629767516569,110.88300039306839,119.90552132506646,127.202147201513,131.9667614478077,133.76958758760802,132.70781458819803,129.56830485026168,125.94077414424684,122.38418137561702,117.21442780157889,104.9489244287997,92.05361102549689,112.54203234883539,121.46683920506331,124.38005590514472,123.53852557520595,121.56477951652924,121.33882435595636,122.2275429466472,121.4062971945044,117.93754225866843,112.6971528635918,104.27515467306111,88.6528521160044,96.42663339577929,107.60183673130071,106.82225946173723,88.40507400283728,104.04178637381129,117.95828545895965,122.46746248313711,124.28669381415281,126.67005328527794,129.27522451899023,129.7650229950298,126.52643324838441,118.86804102107371,109.40834958178631,110.93113718338012,114.07121904322369,108.35331346001797,88.96705472009042,100.66853781444378,109.97573475103614,108.08517276324821,95.58895557030422,89.06300976096674,100.91403830932555,104.06730366572654,102.81085812399192,102.27248417282829,109.75997332490616,122.65446694505044,131.27973072984534,134.659499974981,132.34540824765594,122.983550056949,117.08732924209211,129.23091278150616,136.1537186103394,138.83472161916444,139.99022039298902,140.92873074735414,141.4350478891782,140.302255484849,137.183074064597,134.8362750409565,136.08173198415673,137.3102051022957,135.29421222826153,129.14481974035795,120.98443896939034,122.10389522255312,129.55517351459943,133.1448836556803,130.95005729684308,120.2247398448641,88.75300107301513,115.15603565056695,125.57494349672899,129.060984495252,130.1292469749284,130.3401027591469,129.43479875948742,127.3812776144528,128.0007642924076,131.7025425637015,133.04022544791667,130.59201431746015,123.86052071405743,111.95477123616325,105.70885785702148,118.51401850384497,127.74406905646723,132.76569119540864,134.50333751053557,133.95982949270305,133.34831260302562,135.23414699652548,138.76267935057723,141.77778219016764,143.28657189711944,142.627691535347,139.3644825559961,133.4722084696932,125.10044387363267,112.46111177234778,92.09275680431377,116.55997780602732,126.09832147776532,124.7534823951912,110.71875423547183,96.50112043365947,112.4485124681327,113.26506731234124,108.58103656834763,101.99803482567827,97.14913597763675,113.57660886046824,125.21760786245515,131.97504303651732,137.11982745823596,142.19699775863148,146.74299115161836,149.8110840053253,151.14779573703814,151.33695915010136,151.12865162025216,150.500088718598,148.7887948486843,145.75817203220814,142.99623735437788,143.01809980998883,145.25921794002127,146.94978222310706,145.90004561737913,140.90565004641883,132.09016956580749,120.14784234370435,115.32010047236865,127.36594813894344,133.55111744902817,133.779199329228,130.05306182494044,125.02575693885959,122.87310149941793,123.0047656386207,121.46331452528521,117.8741314694841,117.78964041278229,122.5987050435432,125.50729776735199,124.54332009302718,120.16906619959042,114.14090655164526,115.6280158581019,124.03749904425878,128.12242075902333,125.8990361446127,117.54157651579577,109.15688815418844,117.72541720595963,127.23209372584536,131.4583482182636,131.00135069548762,127.335942799752,121.62186226856994,114.22543748940511,114.85572068019748,122.37860097066992,126.59694202163297,127.4986334752324,125.67563125327746,122.00225729495378,119.92276357023357,122.23990555829354,126.51250740094001,129.903949786847,131.71070023688006,131.97553484395505,129.78930892615406,123.78174072681384,116.3424370534271,118.26378107046335,123.7633490117246,125.59327470473724,122.7324601126848,114.68183007149709,101.26825438324576,86.63384744011921,83.21618025600223,92.5882747839233,101.81575376052287,107.16764512838256,109.37281048707132,112.3974640636089,119.9366852918811,127.35884663106289,132.47940283462185,135.70218555776887,137.10112609991162,136.34754082287984,133.0083175599282,126.02857776304094,112.29113303317646,97.16001644870359,111.40431919504549,114.2106564702352,106.30950393288109,94.81430769903297,96.47370642704341,84.92532458224564,60.545487148081754,79.88039774315853,68.67596712239431,89.11906170616737,91.34917675692962,73.856623411296,90.26844758457986,104.1086223795779,111.58070017271665,116.49222512452609,118.90377264729761,118.22411457287104,114.23802667459175,107.40620915533147,100.60987015302861,97.57527844151682,97.34158232256256,98.10290657702991,98.66362467593973,101.7433519346422,106.2073561951195,108.69895880734114,110.8035723792059,112.15569136889091,109.49690243299439,103.93036448482624,100.92628029593007,97.86096217096936,95.66608809626983,101.03380856504565,108.34648051731253,116.07978807883318,123.8283548391442,130.54394791018052,135.56296750803784,138.76204157391325,140.13435297163534,139.4593490534493,136.21123380350022,129.43441998628626,117.31101607955178,103.73912043267357,112.44864947671577,118.98964903641227,121.21591071320593,121.98924397601607,122.15980962476785,121.38400859362196,119.26549450974018,116.8959893414305,115.88483515515084,114.78338677210779,112.33315907937443,107.62137119796489,98.73602747048403,87.73038295136323,91.13378536825944,101.16947207803058,106.2253997649699,104.13784134633754,100.52905925732327,105.68729473617451,108.82944337043381,105.65177463603948,99.53348804272758,99.12635127717267,101.89825121460251,104.22530938942084,106.5199998892505,109.53476613473762,113.18969053622115,115.68672529991734,115.68799615105743,113.54259565985197,111.07854773053354,109.34605744693557,106.82092535033571,101.93352157530809,95.15483646585035,85.77495510365729,71.47980071875158,56.42559082770286,37.29837819664849,61.63020725776271,60.59370173495803,29.06580455390409,48.298454080119065,55.25910173785193,49.07081918616964,27.913389433570206,46.06408623486975,65.30229863737705,69.00799421180668,62.951246181167086,78.39628391473362,92.91338861566796,101.18515479771182,107.06300736303153,112.21793848064252,116.14938312247597,118.20778576944683,118.84594635653883,119.06929816454088,119.14718314409345,118.36809783419976,116.29053669089575,113.1890980334156,109.04454487149671,102.72609076505472,92.41500440345374,76.33094400443694,52.15810967929434,60.53209431838238,74.51909568179593,71.77931834367912,39.82659016836722,60.1169244820835,62.52548851218519,62.11074567808925,63.45832055316442,46.8261122989831,57.52269917794884,70.21957081125319,80.99419298885374,93.73663259384219,102.81429704783874,108.98970049077947,114.1615558836602,118.65326487722758,121.47156722067137,121.70532057926238,119.0050512192624,113.91296124678925,108.02487100201645,102.45933706749719,99.47598191566438,103.07457144991398,107.83179905939933,109.71431398958043,111.18776497305835,115.9312322534841,122.2031968088484,127.06021086188508,129.01757233521474,127.38100954224436,121.95378438456284,113.88747930721628,108.24673019657541,108.8848456885361,110.8492682187245,110.54528629513362,106.91146973958499,100.23720183593618,93.09935251508304,88.52204668469803,83.40893002956824,75.3313841827785,73.00260059182122,74.77627146153478,76.25559930918028,84.45871817093106,89.97952576061537,91.3626377391236,91.7720533305402,92.52791684811231,92.58468973705524,90.10201677066587,83.06805232336963,69.79640996980096,59.46018368728643,64.53504442365393,64.72506424680589,48.59176666190088,42.997013594499144,58.400853744202436,49.148725852729285,19.301829008746356,45.525192245861724,34.586577726746604,32.89897205356545,37.35431487600631,39.36070499932478,47.28944881987594,55.80702434942269,58.31379853055729,53.27520107576588,51.77221796539581,59.30468018244898,64.77574569278,63.45891452054705,57.60286625521149,64.7802979806566,76.39692667582972,85.4774034636836,91.17797207425647,93.54958517538748,93.58937200947447,93.20455317792343,93.90957285858832,95.18829374855927,95.20282588854431,94.1588385341336,93.16395918149897,91.64607366999336,88.37909124667785,83.1975774402594,76.5085768647885,68.0130768674399,55.14813057328617,44.67960299230243,66.19961637978649,73.74863121315964,73.14806942281302,70.76269255868576,73.75017282602815,80.37283457139709,87.42884063345399,91.6920197763112,92.84484827437588,93.15688891664955,95.12943817890444,98.85873726821387,102.5135604044542,104.24947206735496,103.74848206676312,101.97082217522741,99.89393393504812,97.42699236602259,93.52313150722814,87.44822165948382,79.08988655073196,68.55796791028351,57.70810591072713,50.239173324672905,44.00139587945284,39.17083257776271,37.56426246163583,31.857100767319398,20.165041089762884,30.798890823664454,32.02446587793886,19.32695305555075,27.48639441172864,10.930601425652121,12.518216720193713,2.623565728612991,22.124740941086785,21.123585398658616,24.3753003574641,30.536378710455626,30.35213053286443,22.59887852402723,11.9977441597185,25.025017367983914,26.00439871228424,18.850166521576575,9.604053766122993,13.011991569025879,7.01229322727204,11.365433863731198,8.7599170980214,15.208450149837269,15.512142053824034,13.521601913144004,15.627891152571781,18.21907486102378,14.10397536331784,6.684626869803753,14.97313805067607,17.469824613321073,9.143059568749683,9.72404561637773,10.913143242930877,11.254267483348588,12.760208164488825,11.77213667443736,11.140989359072801,11.10708686047775,13.140019528204556,14.488009330945031,14.833626779648931,6.488046088213211,16.2637832245964,18.805897212928652,19.046297637613492,19.094705802544446,13.896945197556589,5.927629107022312,4.88997960497853,13.662719862992427,12.802014202571163,15.88131005611988,20.900868342879562,14.231926082696635,3.084827018001512,11.369536829619058,15.940886671074017,11.84259622372541,9.559611031609194,14.878394008099942,16.009889164087866,11.666183139837901,0,12.514914259860406,15.279401813005864,17.800918809356883,21.1931645496907,17.429196777389954,7.843912801881345,5.419655023241892,13.47154206569122,15.202617570591675,10.050371931296217,13.540489467787344,15.464754579117251,11.21828400842651,2.3313856619575697,0,0,7.332534216620066,10.865586005260077,0,2.224326565846797,7.864873951393415,4.891568249139188,6.328567349711326,9.358049038355206,15.130964014834193,15.451401393072944,11.804496346795498,7.581079491398729,11.531322431346336,0,8.785004433259628,9.392121069315627,11.304817166597942,17.287662196476834,16.980347110242366,10.820287423168313,0,2.1537316621570883,12.37549089851758,11.882712849582024,0,0,8.332193257260796,14.52776345255954,15.534839890870575,5.716670958406418,0,9.193888869630946,12.165761627915707,14.438050716725746,10.029858466961555,2.5528491032018263,1.1157600999344226,9.023402532060699,11.84909143756013,10.996168833136753,1.1101978370485968,1.6905400167320037,9.165985999739283,11.476104803759513,6.424915969262808,8.078837643373163,15.305529378163936,11.383243139804426,.2952564977218819,6.767946143193262,12.780993948718079,14.38604755985657,14.007328091697389,3.734705766356697,9.029154344080528,13.815128884049631,18.164041081188802,19.24454885612999,17.615774330925618,11.30736552162138,15.281484694967853,19.860681293473736,14.219040359734858,10.568559653800875,13.531719935107636,6.619084727827993,18.10185293789845,20.20005490406164,12.977800532040959,13.630593272325221,15.613474662488834,1.4071067722403952,5.104100308028737,4.453092250334667,7.950531831873705,12.546181719144284,16.912889584119306,13.611063804511913,0,5.14340750155569,4.168112019595056,7.907150889977693,8.979147446431407,9.426140225224962,13.243225390442396,11.469977914072203,6.748875731042129,12.419333543855343,17.67077925645081,18.880096475694156,17.976945230424562,13.259975924641125,9.110054638830176,13.897020932221713,10.897095324514966,7.8151207360060235,9.849822772927759,11.325162474719361,12.016694841102133,11.961220785443153,17.26423194554651,21.170934171205246,19.36679035480077,10.251257554114659,12.697790518293173,12.226322012316976,8.797966914057117,7.304920597468326,6.035264457772584,9.213676766218406,6.700444658116453,0,9.469079930845345,12.587156119390347,10.245214753239326,0,3.9196260047336264,14.939554766587442,20.32950591396716,17.43295039442306,12.232478269551809,7.075514116679573,11.653567301617436,14.522086687604194,4.999105820822678,8.972467820299194,14.752996098031064,12.58737256922795,8.269772553863397,6.845181399549767,9.453814130341753,6.702038616580293,0,5.248058865577265,9.060301063117464,4.959265667263332,1.6907237601620995,12.1849239447419,10.75358814568625,5.579890828342152,10.25437631919848,8.727296893037195,8.674164699122215,8.654266132067589,17.559192518562003,18.013714536426534,3.19846928252853,15.138023018241498,13.120210256537089,13.25959664576775,14.705757047417212,13.646956860434232,11.4493918726612,14.42216931817045,15.61832623520531,9.588827906656373,13.530472972857197,12.078871233581653,12.325619997935547,16.171122133369753,12.287442774753139,9.18184999018405,15.581479804162036,18.89011269904545,12.610509248201758,4.349945852315997,10.24488560466813,7.227081000118217,5.75185749552973,10.778581893610276,13.024889141559335,1.6624037980402562,0,5.918273781830605,11.381155590038007,13.981295548325248,13.94288510294386,10.133007988991162,2.121248558055799,0,1.9723575884446862,0,3.6330911978320097,0,10.113576400672237,10.40896817062201,0,10.454790827761203,10.174902839382536,0,3.5765172429638006,0,1.6182090693881206,0,1.7447440566893428,10.14584872592788,14.082806239138574,14.13045625770746,11.519994887021749,6.000767441228888,0,1.342626361452378,12.895630837651595,10.65092334647549,5.653708141569734,7.225975812423864,10.279236321645836,4.420118550235051,12.63436625022545,18.90372918109156,15.609480264737144,9.227081575590395,12.28784948291024,16.150819092173037,12.313925939027017,12.108909431418597,13.543631056849733,9.508949273227547,15.512028540224131,14.328925846207822,11.606027192071757,13.781481597455045,14.782072988727856,13.30651238407281,13.138829884869365,15.116653621679085,2.9554299337869274,17.91580710523786,17.470496727492755,8.753478916254254,8.814297997449522,8.777238025275853,10.263800483364781,5.636264759368252,10.794078851559046,12.174723218930296,1.4999538295923966,4.8007532181192625,9.094005719383269,5.504161448330176,0,6.91445360252918,9.53931383986776,6.812469238027456,8.104675064882583,12.402321867359854,14.575215846710353,8.894139055166587,5.41943166165391,14.702972067789473,11.856970622795508,7.31333026934427,12.322306413619625,17.448578513027048,20.310376499547864,14.862257403880673,3.6298947871426073,0,10.22551953701423,12.663942733922736,9.61832375637568,0,6.745343890336374,9.1393486211929,5.781388148243254,6.969392453063516,8.48361378533504,12.179137558366316,12.915935053266153,10.579301518169789,19.476760426918048,21.219739452820882,17.2642243065431,11.862556627260657,11.853653103061724,11.114382480645585,9.604425225673191,7.6263471783133365,10.939435292913382,13.995774524794472,9.214802148624713,13.269349891158216,17.961464275474153,18.8761951030306,17.698161852858053,12.50827264365707,6.932947620998374,11.58021263899969,13.310898121668322,9.484703064785522,9.030022395410246,7.984609496401385,4.285134891752637,5.175920875087389,0,13.47134581762161,16.757700789043493,12.272879876417079,7.605413336393965,4.436834888590431,5.3134281624631585,1.586948407695722,15.628696329790479,13.638049432844555,12.981066845845277,20.19082567242849,18.075206606619627,6.555147116491932,13.552012665837841,10.672208165568314,14.32546649410791,19.931514729626965,15.377797494051292,11.375769236373975,17.588585804754313,19.15950620196171,18.01841039563144,13.588143662169683,9.003820447085538,4.03228667394176,14.040446206569532,14.325258350511012,12.642339255005362,6.742497661212694,.7632554290740886,11.504334170814484,15.332947927875477,8.03418629947505,6.311434613265711,11.402639779964485,9.08442868708418,1.601545623919535,1.3179729309311625,11.175473098509213,12.027947817686973,9.206758553558133,1.3016492801836677,2.486550006182436,9.873629602046508,14.267461740251058,11.989494723427752,9.41420926886248,0,6.207702433978429,15.662305858152648,14.565948407450774,8.191337129018594,0,0,11.59078022260681,12.47321848095627,2.679199564616129,0,10.77357845916403,16.891122441267942,17.1738294458997,11.228060112174784,9.666473753231518,9.186067689083913,0,11.708749974182963,7.648578892756032,11.719897248816912,15.319507064767029,14.968844289851205,9.178167370766324,6.354883478391251,5.0317240483073755,7.875625082238901,2.016429963438845,0,10.81387157350129,7.390275955986494,0,0,2.473783795561967,11.283288373376966,15.494440278723957,13.529264929400577,9.9355770563046,15.074756774232712,13.328369502150904,5.5117560855136665,8.147300916502846,17.538402466378802,21.23247911794689,17.79172658927885,15.18189805300655,12.281546300058944,0,11.647743078165266,16.218227783549956,15.059530854897316,9.791646218821802,12.002311842637019,16.021067746218772,11.394436422577598,2.8364568713671985,14.060141217183588,20.80123791581557,15.77343773482499,12.726059083415214,13.584190131875445,4.713261533825819,6.033935500495772,14.02584255505931,19.162913910339118,19.09196180796629,18.83135815701536,16.263660209745257,6.366220890786104,14.713260017851788,14.321220889923108,13.119121396181448,11.41273340341992,11.490232130794169,12.058640417183204,12.939169262726953,11.333490287597444,10.857884175240345,9.538347399436034,8.87164508142129,17.33526561528871,14.797043625492982,6.303864751177793,14.008458579047376,18.281616804764848,15.714776244389387,13.536078416015936,15.43565038521385,15.085553833964894,8.816838562473114,11.57889252690025,7.243366337808657,13.049992675819164,9.562100439480858,18.8423624821782,26.026230764925945,25.063588495745275,12.088440383270365,22.598703824524417,30.335175370360073,30.507203823934503,24.31575743172064,21.091347153092375,22.192008263984746,2.6921532477189625,12.555925389688039,10.955792349554407,27.496596933783845,19.32309532965342,32.02016781504115,30.79363057915056,20.153705208595028,31.84733432313043,37.55422676155908,39.161318089373836,43.99725905548563,50.239521349711644,57.709945157232774,68.56102072874769,79.09277757582453,87.45022449812227,93.52414032558913,97.42708629345228,99.89326580207333,101.96969528883949,103.74738305478293,104.24929170393897,102.51409565496083,98.85891221948177,95.12889229516455,93.15575142612721,92.84481690448938,91.69353557099636,87.43065766212484,80.37511065919674,73.75278758416235,70.76481546499228,73.1488809356018,73.748251522107,66.19754420726265,44.67055040009078,55.14127984460118,68.00897312875901,76.50577378971266,83.19565707317221,88.37928427891767,91.64707205600125,93.1645549214913,94.15892605231977,95.2024261748412,95.18759292865255,93.90926869773944,93.20519129451228,93.58993179108286,93.54980638035424,91.17789631782823,85.47711109836708,76.39650364258733,64.77967081028163,57.60148341599023,63.457047409979346,64.77373700220063,59.30619115439834,51.77610792645369,53.27738581379225,58.31513815008083,55.809899784465536,47.29546194987288,39.36798475813622,37.358230987929666,32.900513693669474,34.58876357417883,45.52733381871206,19.30418051352355,49.14605651861594,58.39674489502643,42.985076505824125,48.58277552730088,64.72489073088832,64.53855632176429,59.46461446008204,69.79866094213094,83.06895000871368,90.10241292436534,92.58477826421021,92.52767576810614,91.77141536117016,91.36164373019474,89.97832484647684,84.45765489771985,76.25612211802503,74.77793832270372,73.00464769163953,75.33322759939438,83.40998967778759,88.52257846445491,93.09950831286169,100.23713376604933,106.91129234333648,110.54503255674483,110.84895308710479,108.88450078687669,108.24640086701157,113.88723795443882,121.95382120919903,127.38124075994413,129.01779133987984,127.06035587666086,122.20320925325537,115.93106559880616,111.18750587058453,109.71416357836468,107.8317384576405,103.07442993273,99.47570439915134,102.45913685400123,108.02480011537054,113.91292131176246,119.00504719734893,121.70543114560706,121.4717871530839,118.65353350928577,114.16181719598866,108.98992131815601,102.8145364807752,93.73710616384784,80.99522436021847,70.22074977909531,57.522235111051,46.820031202418996,63.45379796911414,62.10573859306925,62.522478315454485,60.116833586304146,39.831630797412195,71.7806367413494,74.5199217836516,60.53234686501897,52.15602168536246,76.32972481770639,92.41450363484631,102.72603832002034,109.04463777755306,113.18911196254741,116.29040798264832,118.3678616281676,119.14690593059633,119.06909211625258,118.84607224151263,118.20797609910174,116.14962898219424,112.21827699609415,107.06342747939058,101.18559829646743,92.9137702620287,78.39634865319103,62.949900114705216,69.0062502703019,65.30050053459482,46.064088050295645,27.925213019067385,49.07620602908922,55.26130242039997,48.297181557952335,29.0547768428826,60.59226990706777,61.63229498033179,37.31050251614931,56.42876438016364,71.47969431040048,85.77420915075048,95.15419246153931,101.93312177445505,106.82075655302869,109.34608956875489,111.07870777085459,113.54273215819515,115.68801133344986,115.68660528363839,113.18945966755618,109.53447768330773,106.51968978192635,104.22493771561832,101.89789204190814,99.12657145417897,99.53419272300803,105.65227830143226,108.8297392582113,105.68749484539899,100.52925035881725,104.13800355421641,106.2254843732615,101.16934758006757,91.13304937350996,87.72891307583734,98.7349633067024,107.62097112736863,112.3335144467274,114.78372232892166,115.8850378488818,116.89611504765251,119.26561324794429,121.3841409612775,122.15993185509966,121.98932645564041,121.21593174035927,118.98958046309708,112.44840636612393,103.73853807373665,117.31064469551029,129.43421370886102,136.2111032227428,139.4593666500088,140.13445296046177,138.76213759970432,135.5630320707424,130.54393168059855,123.82818837992177,116.07941747991194,108.34647026968001,101.03456677959765,95.66676904546009,97.86113189561249,100.92602617581143,103.92989096852207,109.49660407900826,112.15584663912672,110.80382908028835,108.69898621387294,106.20701462462121,101.74262759240635,98.66422744858968,98.10394110643142,97.34235283999772,97.57566565538899,100.60994855041994,107.40617250158246,114.23798647603215,118.22408238485863,118.90373163887496,116.49216867904974,111.58068216565138,104.10879697628687,90.26906232119254,73.85763572461435,91.3491361317248,89.11836156706346,68.6726434655926,79.87799282974109,60.54385059908123,84.92760936178982,96.4752001963592,94.81545038646067,106.30970359538547,114.2104747499376,111.40391612227951,97.15934129972361,112.29095612707094,126.02848842354501,133.0082159148334,136.34745581511382,137.10109773309034,135.70217756931117,132.47935526768777,127.35878828072931,119.93677584068564,112.39768481660613,109.37303827394014,107.16791080188607,101.81608101208793,92.58847469956677,83.21567458536418,86.63294719282503,101.26812860539339,114.68214557056169,122.7327563809439,125.59348797481894,123.76350402125736,118.26389009957268,116.34245948001073,123.78168323041649,129.78921427083176,131.9754194958146,131.71057816330685,129.90384904754552,126.51249016784601,122.2400326926942,119.92296598384048,122.00238053081277,125.67563725822029,127.49855890937131,126.59682802396568,122.37848723288941,114.85566139586028,114.22547302310696,121.62189039066338,127.33590647591397,131.00124646643715,131.4581964185114,127.23195927702446,117.72549862641351,109.15718761707542,117.5417232792651,125.89906325638462,128.1223527402383,124.03727447364358,115.62748592770117,114.1414572415632,120.16950335825283,124.54351889399076,125.50728589986323,122.59848279111162,117.78921780035344,117.87374702603012,121.46344538503499,123.00503642802835,122.8734071286911,125.0260325714215,130.05322831072004,133.77926904706976,133.55111737490492,127.36586241105557,115.31977487505993,120.14742685497546,132.08991772494053,140.90571592124957,145.90019036520025,146.94986939321637,145.25922677868306,143.01802540646966,142.99611495827006,145.75805912714097,148.7887275816813,150.50010621591636,151.12869154826384,151.3369874794862,151.14782222367967,149.81112513081436,146.74304447140364,142.19704817050356,137.1198908229571,131.9752019882868,125.21794163113624,113.57714712439454,97.1496708876078,101.99777402644207,108.58044026376153,113.26447168913776,112.44799022370425,96.50035067728408,110.7184240927532,124.75329634069374,126.09814773550508,116.55980886066847,92.09290392856308,112.46133923706601,125.10058260240726,133.47227546085253,139.36449484155528,142.62766498926533,143.28651934923624,141.7777189620662,138.76263185246356,135.23412709801426,133.3482677848772,133.95975448544326,134.50352636166627,132.7659707744914,127.74442217998808,118.51443047524482,105.70920689819519,111.95472089630582,123.86037400016116,130.59188784746723,133.04014714791705,131.70252224342494,128.0008127705433,127.38138224297306,129.434918343866,130.34020737337966,130.12929658046303,129.06093066996556,125.57473288368382,115.15550893518736,88.75111693106655,120.22453810765779,130.95014630155598,133.14503685689422,129.55533244102588,122.1039896651948,120.98431843230455,129.14457830522727,135.29395885539418,137.31014313066748,136.0819237857414,134.83640740952785,137.1831284757891,140.30229214517712,141.43509044999527,140.92874954055137,139.99017540878293,138.83460020229015,136.15353009056514,129.23071391558705,117.08769051494484,122.98399945459973,132.34571375732787,134.6597375927039,131.27989475331978,122.65446358116598,109.75949319385768,102.27131663760005,102.80963036664456,104.0666210406399,100.91412970054837,89.06336437380658,95.58870434298841,108.08474410886177,109.975290454292,100.66889665503349,88.96843946142424,108.35377053933227,114.07147267518978,110.93133801377837,109.40847694746347,118.86806993241346,126.52642833562173,129.76501730620384,129.27523809375847,126.67010440280367,124.2867969604617,122.46761377773747,117.95846370606961,104.04194815548871,88.40480038565197,106.82193564925728,107.60151358936267,96.42637893625684,88.65279147756746,104.27502925063335,112.6969219771717,117.9373093683718,121.406189082809,122.22759791766974,121.33894117599992,121.56481739405223,123.53842605672006,124.37982270531079,121.4664769197343,112.5421258034038,92.05572428849077,104.95013039989355,117.2150495419483,122.38464342834497,125.94120162594115,129.56872072251423,132.70817382527588,133.76983838542708,131.96684976064296,127.20200356221375,119.90507895581473,110.88228885993007,105.82567256372081,114.08568971832912,121.98872160371074,124.38192964308752,123.75101574287024,124.49157990671355,127.81856423476499,131.35653746685884,133.61619154056436,134.27054425788754,133.19274055872873,130.25785139226338,125.32131062603564,118.84529769293798,114.73094669137538,117.32300402124814,121.53943096505532,124.9379924905757,129.02643889799754,134.3253630920495,139.64910289859577,143.8496663010949,146.41329976809035,147.13649400326642,145.90790583900943,142.91983020235745,139.0408100268394,136.24004215578535,134.59953604193316,131.88611703248006,126.77824631740835,125.3372918872163,131.3391518029233,136.2994523875791,138.23949026777544,138.01618690253528,136.56384741173846,134.06648656763667,130.41631523162945,126.02312916597072,122.11888737668045,121.93072850705732,126.4549135403018,131.84271947263983,135.2216409007247,135.78574715423088,134.29650210685182,131.90021668190013,129.8594835186377,128.02810329865105,124.82896562622523,119.27804181115263,112.1618210875847,109.7606065138958,114.88031169305953,120.90516479632258,123.89634815814485,124.68805393056857,127.40506420407145,131.92568913122147,134.78655438887444,134.4848762084327,131.22808687816396,124.05101542935647,111.6680648967376,107.59959271972605,119.37875651717499,127.38222796356523,131.3818360741695,131.46362921294215,127.33447882627286,119.12981556963278,113.87365385967676,118.6459118084248,122.47968242291527,122.54191464816928,118.98660493600012,111.3390799924638,98.03459026282384,66.0661580661814,75.82987579913082,82.46862653900081,83.35442562124413,92.95836763726317,103.44710699349196,114.2263158659949,124.07664699923747,131.9837736115233,137.62243813449857,140.2867189328989,139.3177998211297,134.62922878192632,126.52050160692933,123.68212005871749,130.6692723829163,133.96735606383828,132.20629593622854,126.5367302709491,119.75248527642005,117.22061060775094,119.7137227059548,122.3623542790754,120.83475813308127,110.34310180873224,89.01927960713165,120.69558179387168,132.5104431738287,138.12673652205208,140.1080316236496,139.66190688366913,136.93978178629223,132.49447508534894,130.34818088211662,132.497424113394,134.24522201135863,133.6150381540072,131.37917928582317,129.61449782803453,128.68427532159342,128.17334706648543,128.5570699958125,129.62991707093713,130.74845529998203,134.16233629157972,140.3412106741102,145.92797999640203,149.0383053133878,149.4364893947315,148.0554258060447,146.3695241642237,145.83421067683977,146.10029858906174,145.5471045139762,143.17158774370387,138.29280912280117,129.4537010593994,111.58363981456151,92.9500761571869,118.07215437644277,127.15033919507839,131.78855357780378,135.09324290014425,137.02860179241654,137.23047459407942,136.94397279949845,137.86427558389795,140.02962568671,142.3485383990313,144.04004642976972,145.23040828356415,146.91784789675518,149.77722092433748,152.83961538279263,154.53838820199408,154.767354252018,155.10287774079123,156.66466873822475,158.52065843724156,159.60779223082642,159.8694960176258,159.69121555858095,159.09241653554025,158.03511913820253,157.40026253234646,158.2700924193581,160.33717038158198,162.69577420981906,164.56028366121572,165.02755215312504,163.283454921089,158.65569137848354,151.30289226152428,145.98183448662513,145.5672642570963,141.00160436370405,144.56602842693394,158.76317699692117,167.70472832739583,173.28440040276342,177.63272863056815,182.25384109168323,187.0496190825908,190.998692836551,193.5896629106951,195.4906998402826,197.26171132802398,198.68440631822128,199.29787388223784,200.06585544947043,202.15749478072573,204.1179813944494,203.48988916928616,198.68772392755173,187.46942834049108,167.07117359067868,172.52204017273783,183.33627056640074,189.56207222209986,194.98293881072215,199.6589895567035]],l2=[[204.35838132923993,203.00945332832035,199.65900469732605,194.98271845278515,189.56132214289326,183.33473438912372,172.52400430499736,167.07532066537684,187.47065016402843,198.68807545388097,203.48982568521964,204.1176240653317,202.15691732602392,200.06529787993665,199.29780568337057,198.68467837138908,197.26189269581153,195.4906761781706,193.5894680197673,190.99841409170546,187.04933995236826,182.25360885686126,177.63250777500204,173.28407960282425,167.70417685616633,158.76226893469703,144.56500607291406,141.00209952410114,145.56804845329737,145.98247959194708,151.30333957601397,158.65594331047583,163.28351501985006,165.0274425332393,164.56009034724005,162.69563468431807,160.3371300218423,158.2700085578228,157.39999468815182,158.03471062124936,159.09200990304208,159.69089115160511,159.86921679067325,159.6075664376986,158.52087286589776,156.6650151944958,155.10307758735354,154.76731334199766,154.53817469416,152.83946762235234,149.7773929680549,146.91810966789785,145.2304213494264,144.0396936303876,142.34788989257112,140.02924475411893,137.86488379627102,136.94443024999612,137.23038873543342,137.02795358522172,135.09262390148805,131.78995127630665,127.15201700601123,118.07364045259453,92.95048846026552,111.58227970522246,129.45278563115795,138.2921805525958,143.1711053210688,145.54670069071844,146.10057562215798,145.83463815520878,146.36977981790818,148.0554387843523,149.43629769169783,149.03798836610676,145.92771765577686,140.3413699534398,134.16252749146054,130.7483709722678,129.62976562861337,128.55726783363963,128.17372090103626,128.68453448110859,129.61467268224547,131.37936708272957,133.615185772025,134.24522747949015,132.49724810152492,130.3479207101576,132.49438546853943,136.93991181373855,139.66216072746448,140.10834545254787,138.1270546398033,132.51069038452,120.69558867721602,89.01754914367318,110.34211587855022,120.83417434236462,122.36200772241834,119.71362583248677,117.22074187792266,119.75264768893518,126.5367395343374,132.2061093130478,133.96693353280494,130.6684966876412,123.6815217863759,126.52157795061277,134.62983091628038,139.3180272591702,140.28667668531253,137.62219818584865,131.98348466528336,124.07663570706792,114.2267694499014,103.44772202882844,92.9584608439638,83.35329993623219,82.46689771012865,75.82770036464417,66.06349703115293,98.03414526793118,111.33889876855572,118.98648423031145,122.54177224513953,122.47951959397489,118.64583070128839,113.87371352182163,119.12974241422387,127.33420020821598,131.46335674969552,131.3822456107658,127.3830481228133,119.37978564347974,107.60067684669835,111.66825278667098,124.05076277537741,131.22772394028615,134.48448788702927,134.7861839517469,131.92539177767685,127.40494750758486,124.68811639326971,123.8965060008981,120.9054998438967,114.88101986961341,109.76176859442026,112.1629841277428,119.27887876494424,124.82951411454222,128.02837046990257,129.85943432178908,131.89986646363,134.2959664200011,135.78516337340758,135.22114124260463,131.84250434163295,126.45507975231583,121.93106290183131,122.11921102289395,126.02335733427888,130.41644177850932,134.06653952639124,136.5638564699891,138.01616957258577,138.23945775755297,136.29941618189454,131.33912440717808,125.33728980410184,126.77827246986509,131.88614297305546,134.5995306065226,136.2399757750571,139.04068907529907,142.9197060262825,145.9078344918701,147.13650225775328,146.41335613205808,143.84972114295687,139.64912794324272,134.3253574737259,129.02642302040337,124.93796462149683,121.5393264193191,117.322732247941,114.73057166609908,118.8452229107018,125.32158129160658,130.25817923584472,133.19297336645127,134.27063636776148,133.61613697497285,131.3563797543291,127.81845352593217,124.49172753170508,123.7513624080227,124.38224504365684,121.98895450367736,114.08596503252865,105.82629767516569,110.88300039306839,119.90552132506646,127.202147201513,131.9667614478077,133.76958758760802,132.70781458819803,129.56830485026168,125.94077414424684,122.38418137561702,117.21442780157889,104.9489244287997,92.05361102549689,112.54203234883539,121.46683920506331,124.38005590514472,123.53852557520595,121.56477951652924,121.33882435595636,122.2275429466472,121.4062971945044,117.93754225866843,112.6971528635918,104.27515467306111,88.6528521160044,96.42663339577929,107.60183673130071,106.82225946173723,88.40507400283728,104.04178637381129,117.95828545895965,122.46746248313711,124.28669381415281,126.67005328527794,129.27522451899023,129.7650229950298,126.52643324838441,118.86804102107371,109.40834958178631,110.93113718338012,114.07121904322369,108.35331346001797,88.96705472009042,100.66853781444378,109.97573475103614,108.08517276324821,95.58895557030422,89.06300976096674,100.91403830932555,104.06730366572654,102.81085812399192,102.27248417282829,109.75997332490616,122.65446694505044,131.27973072984534,134.659499974981,132.34540824765594,122.983550056949,117.08732924209211,129.23091278150616,136.1537186103394,138.83472161916444,139.99022039298902,140.92873074735414,141.4350478891782,140.302255484849,137.183074064597,134.8362750409565,136.08173198415673,137.3102051022957,135.29421222826153,129.14481974035795,120.98443896939034,122.10389522255312,129.55517351459943,133.1448836556803,130.95005729684308,120.2247398448641,88.75300107301513,115.15603565056695,125.57494349672899,129.060984495252,130.1292469749284,130.3401027591469,129.43479875948742,127.3812776144528,128.0007642924076,131.7025425637015,133.04022544791667,130.59201431746015,123.86052071405743,111.95477123616325,105.70885785702148,118.51401850384497,127.74406905646723,132.76569119540864,134.50333751053557,133.95982949270305,133.34831260302562,135.23414699652548,138.76267935057723,141.77778219016764,143.28657189711944,142.627691535347,139.3644825559961,133.4722084696932,125.10044387363267,112.46111177234778,92.09275680431377,116.55997780602732,126.09832147776532,124.7534823951912,110.71875423547183,96.50112043365947,112.4485124681327,113.26506731234124,108.58103656834763,101.99803482567827,97.14913597763675,113.57660886046824,125.21760786245515,131.97504303651732,137.11982745823596,142.19699775863148,146.74299115161836,149.8110840053253,151.14779573703814,151.33695915010136,151.12865162025216,150.500088718598,148.7887948486843,145.75817203220814,142.99623735437788,143.01809980998883,145.25921794002127,146.94978222310706,145.90004561737913,140.90565004641883,132.09016956580749,120.14784234370435,115.32010047236865,127.36594813894344,133.55111744902817,133.779199329228,130.05306182494044,125.02575693885959,122.87310149941793,123.0047656386207,121.46331452528521,117.8741314694841,117.78964041278229,122.5987050435432,125.50729776735199,124.54332009302718,120.16906619959042,114.14090655164526,115.6280158581019,124.03749904425878,128.12242075902333,125.8990361446127,117.54157651579577,109.15688815418844,117.72541720595963,127.23209372584536,131.4583482182636,131.00135069548762,127.335942799752,121.62186226856994,114.22543748940511,114.85572068019748,122.37860097066992,126.59694202163297,127.4986334752324,125.67563125327746,122.00225729495378,119.92276357023357,122.23990555829354,126.51250740094001,129.903949786847,131.71070023688006,131.97553484395505,129.78930892615406,123.78174072681384,116.3424370534271,118.26378107046335,123.7633490117246,125.59327470473724,122.7324601126848,114.68183007149709,101.26825438324576,86.63384744011921,83.21618025600223,92.5882747839233,101.81575376052287,107.16764512838256,109.37281048707132,112.3974640636089,119.9366852918811,127.35884663106289,132.47940283462185,135.70218555776887,137.10112609991162,136.34754082287984,133.0083175599282,126.02857776304094,112.29113303317646,97.16001644870359,111.40431919504549,114.2106564702352,106.30950393288109,94.81430769903297,96.47370642704341,84.92532458224564,60.545487148081754,79.88039774315853,68.67596712239431,89.11906170616737,91.34917675692962,73.856623411296,90.26844758457986,104.1086223795779,111.58070017271665,116.49222512452609,118.90377264729761,118.22411457287104,114.23802667459175,107.40620915533147,100.60987015302861,97.57527844151682,97.34158232256256,98.10290657702991,98.66362467593973,101.7433519346422,106.2073561951195,108.69895880734114,110.8035723792059,112.15569136889091,109.49690243299439,103.93036448482624,100.92628029593007,97.86096217096936,95.66608809626983,101.03380856504565,108.34648051731253,116.07978807883318,123.8283548391442,130.54394791018052,135.56296750803784,138.76204157391325,140.13435297163534,139.4593490534493,136.21123380350022,129.43441998628626,117.31101607955178,103.73912043267357,112.44864947671577,118.98964903641227,121.21591071320593,121.98924397601607,122.15980962476785,121.38400859362196,119.26549450974018,116.8959893414305,115.88483515515084,114.78338677210779,112.33315907937443,107.62137119796489,98.73602747048403,87.73038295136323,91.13378536825944,101.16947207803058,106.2253997649699,104.13784134633754,100.52905925732327,105.68729473617451,108.82944337043381,105.65177463603948,99.53348804272758,99.12635127717267,101.89825121460251,104.22530938942084,106.5199998892505,109.53476613473762,113.18969053622115,115.68672529991734,115.68799615105743,113.54259565985197,111.07854773053354,109.34605744693557,106.82092535033571,101.93352157530809,95.15483646585035,85.77495510365729,71.47980071875158,56.42559082770286,37.29837819664849,61.63020725776271,60.59370173495803,29.06580455390409,48.298454080119065,55.25910173785193,49.07081918616964,27.913389433570206,46.06408623486975,65.30229863737705,69.00799421180668,62.951246181167086,78.39628391473362,92.91338861566796,101.18515479771182,107.06300736303153,112.21793848064252,116.14938312247597,118.20778576944683,118.84594635653883,119.06929816454088,119.14718314409345,118.36809783419976,116.29053669089575,113.1890980334156,109.04454487149671,102.72609076505472,92.41500440345374,76.33094400443694,52.15810967929434,60.53209431838238,74.51909568179593,71.77931834367912,39.82659016836722,60.1169244820835,62.52548851218519,62.11074567808925,63.45832055316442,46.8261122989831,57.52269917794884,70.21957081125319,80.99419298885374,93.73663259384219,102.81429704783874,108.98970049077947,114.1615558836602,118.65326487722758,121.47156722067137,121.70532057926238,119.0050512192624,113.91296124678925,108.02487100201645,102.45933706749719,99.47598191566438,103.07457144991398,107.83179905939933,109.71431398958043,111.18776497305835,115.9312322534841,122.2031968088484,127.06021086188508,129.01757233521474,127.38100954224436,121.95378438456284,113.88747930721628,108.24673019657541,108.8848456885361,110.8492682187245,110.54528629513362,106.91146973958499,100.23720183593618,93.09935251508304,88.52204668469803,83.40893002956824,75.3313841827785,73.00260059182122,74.77627146153478,76.25559930918028,84.45871817093106,89.97952576061537,91.3626377391236,91.7720533305402,92.52791684811231,92.58468973705524,90.10201677066587,83.06805232336963,69.79640996980096,59.46018368728643,64.53504442365393,64.72506424680589,48.59176666190088,42.997013594499144,58.400853744202436,49.148725852729285,19.301829008746356,45.525192245861724,34.586577726746604,32.89897205356545,37.35431487600631,39.36070499932478,47.28944881987594,55.80702434942269,58.31379853055729,53.27520107576588,51.77221796539581,59.30468018244898,64.77574569278,63.45891452054705,57.60286625521149,64.7802979806566,76.39692667582972,85.4774034636836,91.17797207425647,93.54958517538748,93.58937200947447,93.20455317792343,93.90957285858832,95.18829374855927,95.20282588854431,94.1588385341336,93.16395918149897,91.64607366999336,88.37909124667785,83.1975774402594,76.5085768647885,68.0130768674399,55.14813057328617,44.67960299230243,66.19961637978649,73.74863121315964,73.14806942281302,70.76269255868576,73.75017282602815,80.37283457139709,87.42884063345399,91.6920197763112,92.84484827437588,93.15688891664955,95.12943817890444,98.85873726821387,102.5135604044542,104.24947206735496,103.74848206676312,101.97082217522741,99.89393393504812,97.42699236602259,93.52313150722814,87.44822165948382,79.08988655073196,68.55796791028351,57.70810591072713,50.239173324672905,44.00139587945284,39.17083257776271,37.56426246163583,31.857100767319398,20.165041089762884,30.798890823664454,32.02446587793886,19.32695305555075,27.48639441172864,10.930601425652121,12.518216720193713,2.623565728612991,22.124740941086785,21.123585398658616,24.3753003574641,30.536378710455626,30.35213053286443,22.59887852402723,11.9977441597185,25.025017367983914,26.00439871228424,18.850166521576575,9.604053766122993,13.011991569025879,7.01229322727204,11.365433863731198,8.7599170980214,15.208450149837269,15.512142053824034,13.521601913144004,15.627891152571781,18.21907486102378,14.10397536331784,6.684626869803753,14.97313805067607,17.469824613321073,9.143059568749683,9.72404561637773,10.913143242930877,11.254267483348588,12.760208164488825,11.77213667443736,11.140989359072801,11.10708686047775,13.140019528204556,14.488009330945031,14.833626779648931,6.488046088213211,16.2637832245964,18.805897212928652,19.046297637613492,19.094705802544446,13.896945197556589,5.927629107022312,4.88997960497853,13.662719862992427,12.802014202571163,15.88131005611988,20.900868342879562,14.231926082696635,3.084827018001512,11.369536829619058,15.940886671074017,11.84259622372541,9.559611031609194,14.878394008099942,16.009889164087866,11.666183139837901,0,12.514914259860406,15.279401813005864,17.800918809356883,21.1931645496907,17.429196777389954,7.843912801881345,5.419655023241892,13.47154206569122,15.202617570591675,10.050371931296217,13.540489467787344,15.464754579117251,11.21828400842651,2.3313856619575697,0,0,7.332534216620066,10.865586005260077,0,2.224326565846797,7.864873951393415,4.891568249139188,6.328567349711326,9.358049038355206,15.130964014834193,15.451401393072944,11.804496346795498,7.581079491398729,11.531322431346336,0,8.785004433259628,9.392121069315627,11.304817166597942,17.287662196476834,16.980347110242366,10.820287423168313,0,2.1537316621570883,12.37549089851758,11.882712849582024,0,0,8.332193257260796,14.52776345255954,15.534839890870575,5.716670958406418,0,9.193888869630946,12.165761627915707,14.438050716725746,10.029858466961555,2.5528491032018263,1.1157600999344226,9.023402532060699,11.84909143756013,10.996168833136753,1.1101978370485968,1.6905400167320037,9.165985999739283,11.476104803759513,6.424915969262808,8.078837643373163,15.305529378163936,11.383243139804426,.2952564977218819,6.767946143193262,12.780993948718079,14.38604755985657,14.007328091697389,3.734705766356697,9.029154344080528,13.815128884049631,18.164041081188802,19.24454885612999,17.615774330925618,11.30736552162138,15.281484694967853,19.860681293473736,14.219040359734858,10.568559653800875,13.531719935107636,6.619084727827993,18.10185293789845,20.20005490406164,12.977800532040959,13.630593272325221,15.613474662488834,1.4071067722403952,5.104100308028737,4.453092250334667,7.950531831873705,12.546181719144284,16.912889584119306,13.611063804511913,0,5.14340750155569,4.168112019595056,7.907150889977693,8.979147446431407,9.426140225224962,13.243225390442396,11.469977914072203,6.748875731042129,12.419333543855343,17.67077925645081,18.880096475694156,17.976945230424562,13.259975924641125,9.110054638830176,13.897020932221713,10.897095324514966,7.8151207360060235,9.849822772927759,11.325162474719361,12.016694841102133,11.961220785443153,17.26423194554651,21.170934171205246,19.36679035480077,10.251257554114659,12.697790518293173,12.226322012316976,8.797966914057117,7.304920597468326,6.035264457772584,9.213676766218406,6.700444658116453,0,9.469079930845345,12.587156119390347,10.245214753239326,0,3.9196260047336264,14.939554766587442,20.32950591396716,17.43295039442306,12.232478269551809,7.075514116679573,11.653567301617436,14.522086687604194,4.999105820822678,8.972467820299194,14.752996098031064,12.58737256922795,8.269772553863397,6.845181399549767,9.453814130341753,6.702038616580293,0,5.248058865577265,9.060301063117464,4.959265667263332,1.6907237601620995,12.1849239447419,10.75358814568625,5.579890828342152,10.25437631919848,8.727296893037195,8.674164699122215,8.654266132067589,17.559192518562003,18.013714536426534,3.19846928252853,15.138023018241498,13.120210256537089,13.25959664576775,14.705757047417212,13.646956860434232,11.4493918726612,14.42216931817045,15.61832623520531,9.588827906656373,13.530472972857197,12.078871233581653,12.325619997935547,16.171122133369753,12.287442774753139,9.18184999018405,15.581479804162036,18.89011269904545,12.610509248201758,4.349945852315997,10.24488560466813,7.227081000118217,5.75185749552973,10.778581893610276,13.024889141559335,1.6624037980402562,0,5.918273781830605,11.381155590038007,13.981295548325248,13.94288510294386,10.133007988991162,2.121248558055799,0,1.9723575884446862,0,3.6330911978320097,0,10.113576400672237,10.40896817062201,0,10.454790827761203,10.174902839382536,0,3.5765172429638006,0,1.6182090693881206,0,1.7447440566893428,10.14584872592788,14.082806239138574,14.13045625770746,11.519994887021749,6.000767441228888,0,1.342626361452378,12.895630837651595,10.65092334647549,5.653708141569734,7.225975812423864,10.279236321645836,4.420118550235051,12.63436625022545,18.90372918109156,15.609480264737144,9.227081575590395,12.28784948291024,16.150819092173037,12.313925939027017,12.108909431418597,13.543631056849733,9.508949273227547,15.512028540224131,14.328925846207822,11.606027192071757,13.781481597455045,14.782072988727856,13.30651238407281,13.138829884869365,15.116653621679085,2.9554299337869274,17.91580710523786,17.470496727492755,8.753478916254254,8.814297997449522,8.777238025275853,10.263800483364781,5.636264759368252,10.794078851559046,12.174723218930296,1.4999538295923966,4.8007532181192625,9.094005719383269,5.504161448330176,0,6.91445360252918,9.53931383986776,6.812469238027456,8.104675064882583,12.402321867359854,14.575215846710353,8.894139055166587,5.41943166165391,14.702972067789473,11.856970622795508,7.31333026934427,12.322306413619625,17.448578513027048,20.310376499547864,14.862257403880673,3.6298947871426073,0,10.22551953701423,12.663942733922736,9.61832375637568,0,6.745343890336374,9.1393486211929,5.781388148243254,6.969392453063516,8.48361378533504,12.179137558366316,12.915935053266153,10.579301518169789,19.476760426918048,21.219739452820882,17.2642243065431,11.862556627260657,11.853653103061724,11.114382480645585,9.604425225673191,7.6263471783133365,10.939435292913382,13.995774524794472,9.214802148624713,13.269349891158216,17.961464275474153,18.8761951030306,17.698161852858053,12.50827264365707,6.932947620998374,11.58021263899969,13.310898121668322,9.484703064785522,9.030022395410246,7.984609496401385,4.285134891752637,5.175920875087389,0,13.47134581762161,16.757700789043493,12.272879876417079,7.605413336393965,4.436834888590431,5.3134281624631585,1.586948407695722,15.628696329790479,13.638049432844555,12.981066845845277,20.19082567242849,18.075206606619627,6.555147116491932,13.552012665837841,10.672208165568314,14.32546649410791,19.931514729626965,15.377797494051292,11.375769236373975,17.588585804754313,19.15950620196171,18.01841039563144,13.588143662169683,9.003820447085538,4.03228667394176,14.040446206569532,14.325258350511012,12.642339255005362,6.742497661212694,.7632554290740886,11.504334170814484,15.332947927875477,8.03418629947505,6.311434613265711,11.402639779964485,9.08442868708418,1.601545623919535,1.3179729309311625,11.175473098509213,12.027947817686973,9.206758553558133,1.3016492801836677,2.486550006182436,9.873629602046508,14.267461740251058,11.989494723427752,9.41420926886248,0,6.207702433978429,15.662305858152648,14.565948407450774,8.191337129018594,0,0,11.59078022260681,12.47321848095627,2.679199564616129,0,10.77357845916403,16.891122441267942,17.1738294458997,11.228060112174784,9.666473753231518,9.186067689083913,0,11.708749974182963,7.648578892756032,11.719897248816912,15.319507064767029,14.968844289851205,9.178167370766324,6.354883478391251,5.0317240483073755,7.875625082238901,2.016429963438845,0,10.81387157350129,7.390275955986494,0,0,2.473783795561967,11.283288373376966,15.494440278723957,13.529264929400577,9.9355770563046,15.074756774232712,13.328369502150904,5.5117560855136665,8.147300916502846,17.538402466378802,21.23247911794689,17.79172658927885,15.18189805300655,12.281546300058944,0,11.647743078165266,16.218227783549956,15.059530854897316,9.791646218821802,12.002311842637019,16.021067746218772,11.394436422577598,2.8364568713671985,14.060141217183588,20.80123791581557,15.77343773482499,12.726059083415214,13.584190131875445,4.713261533825819,6.033935500495772,14.02584255505931,19.162913910339118,19.09196180796629,18.83135815701536,16.263660209745257,6.366220890786104,14.713260017851788,14.321220889923108,13.119121396181448,11.41273340341992,11.490232130794169,12.058640417183204,12.939169262726953,11.333490287597444,10.857884175240345,9.538347399436034,8.87164508142129,17.33526561528871,14.797043625492982,6.303864751177793,14.008458579047376,18.281616804764848,15.714776244389387,13.536078416015936,15.43565038521385,15.085553833964894,8.816838562473114,11.57889252690025,7.243366337808657,13.049992675819164,9.562100439480858,18.8423624821782,26.026230764925945,25.063588495745275,12.088440383270365,22.598703824524417,30.335175370360073,30.507203823934503,24.31575743172064,21.091347153092375,22.192008263984746,2.6921532477189625,12.555925389688039,10.955792349554407,27.496596933783845,19.32309532965342,32.02016781504115,30.79363057915056,20.153705208595028,31.84733432313043,37.55422676155908,39.161318089373836,43.99725905548563,50.239521349711644,57.709945157232774,68.56102072874769,79.09277757582453,87.45022449812227,93.52414032558913,97.42708629345228,99.89326580207333,101.96969528883949,103.74738305478293,104.24929170393897,102.51409565496083,98.85891221948177,95.12889229516455,93.15575142612721,92.84481690448938,91.69353557099636,87.43065766212484,80.37511065919674,73.75278758416235,70.76481546499228,73.1488809356018,73.748251522107,66.19754420726265,44.67055040009078,55.14127984460118,68.00897312875901,76.50577378971266,83.19565707317221,88.37928427891767,91.64707205600125,93.1645549214913,94.15892605231977,95.2024261748412,95.18759292865255,93.90926869773944,93.20519129451228,93.58993179108286,93.54980638035424,91.17789631782823,85.47711109836708,76.39650364258733,64.77967081028163,57.60148341599023,63.457047409979346,64.77373700220063,59.30619115439834,51.77610792645369,53.27738581379225,58.31513815008083,55.809899784465536,47.29546194987288,39.36798475813622,37.358230987929666,32.900513693669474,34.58876357417883,45.52733381871206,19.30418051352355,49.14605651861594,58.39674489502643,42.985076505824125,48.58277552730088,64.72489073088832,64.53855632176429,59.46461446008204,69.79866094213094,83.06895000871368,90.10241292436534,92.58477826421021,92.52767576810614,91.77141536117016,91.36164373019474,89.97832484647684,84.45765489771985,76.25612211802503,74.77793832270372,73.00464769163953,75.33322759939438,83.40998967778759,88.52257846445491,93.09950831286169,100.23713376604933,106.91129234333648,110.54503255674483,110.84895308710479,108.88450078687669,108.24640086701157,113.88723795443882,121.95382120919903,127.38124075994413,129.01779133987984,127.06035587666086,122.20320925325537,115.93106559880616,111.18750587058453,109.71416357836468,107.8317384576405,103.07442993273,99.47570439915134,102.45913685400123,108.02480011537054,113.91292131176246,119.00504719734893,121.70543114560706,121.4717871530839,118.65353350928577,114.16181719598866,108.98992131815601,102.8145364807752,93.73710616384784,80.99522436021847,70.22074977909531,57.522235111051,46.820031202418996,63.45379796911414,62.10573859306925,62.522478315454485,60.116833586304146,39.831630797412195,71.7806367413494,74.5199217836516,60.53234686501897,52.15602168536246,76.32972481770639,92.41450363484631,102.72603832002034,109.04463777755306,113.18911196254741,116.29040798264832,118.3678616281676,119.14690593059633,119.06909211625258,118.84607224151263,118.20797609910174,116.14962898219424,112.21827699609415,107.06342747939058,101.18559829646743,92.9137702620287,78.39634865319103,62.949900114705216,69.0062502703019,65.30050053459482,46.064088050295645,27.925213019067385,49.07620602908922,55.26130242039997,48.297181557952335,29.0547768428826,60.59226990706777,61.63229498033179,37.31050251614931,56.42876438016364,71.47969431040048,85.77420915075048,95.15419246153931,101.93312177445505,106.82075655302869,109.34608956875489,111.07870777085459,113.54273215819515,115.68801133344986,115.68660528363839,113.18945966755618,109.53447768330773,106.51968978192635,104.22493771561832,101.89789204190814,99.12657145417897,99.53419272300803,105.65227830143226,108.8297392582113,105.68749484539899,100.52925035881725,104.13800355421641,106.2254843732615,101.16934758006757,91.13304937350996,87.72891307583734,98.7349633067024,107.62097112736863,112.3335144467274,114.78372232892166,115.8850378488818,116.89611504765251,119.26561324794429,121.3841409612775,122.15993185509966,121.98932645564041,121.21593174035927,118.98958046309708,112.44840636612393,103.73853807373665,117.31064469551029,129.43421370886102,136.2111032227428,139.4593666500088,140.13445296046177,138.76213759970432,135.5630320707424,130.54393168059855,123.82818837992177,116.07941747991194,108.34647026968001,101.03456677959765,95.66676904546009,97.86113189561249,100.92602617581143,103.92989096852207,109.49660407900826,112.15584663912672,110.80382908028835,108.69898621387294,106.20701462462121,101.74262759240635,98.66422744858968,98.10394110643142,97.34235283999772,97.57566565538899,100.60994855041994,107.40617250158246,114.23798647603215,118.22408238485863,118.90373163887496,116.49216867904974,111.58068216565138,104.10879697628687,90.26906232119254,73.85763572461435,91.3491361317248,89.11836156706346,68.6726434655926,79.87799282974109,60.54385059908123,84.92760936178982,96.4752001963592,94.81545038646067,106.30970359538547,114.2104747499376,111.40391612227951,97.15934129972361,112.29095612707094,126.02848842354501,133.0082159148334,136.34745581511382,137.10109773309034,135.70217756931117,132.47935526768777,127.35878828072931,119.93677584068564,112.39768481660613,109.37303827394014,107.16791080188607,101.81608101208793,92.58847469956677,83.21567458536418,86.63294719282503,101.26812860539339,114.68214557056169,122.7327563809439,125.59348797481894,123.76350402125736,118.26389009957268,116.34245948001073,123.78168323041649,129.78921427083176,131.9754194958146,131.71057816330685,129.90384904754552,126.51249016784601,122.2400326926942,119.92296598384048,122.00238053081277,125.67563725822029,127.49855890937131,126.59682802396568,122.37848723288941,114.85566139586028,114.22547302310696,121.62189039066338,127.33590647591397,131.00124646643715,131.4581964185114,127.23195927702446,117.72549862641351,109.15718761707542,117.5417232792651,125.89906325638462,128.1223527402383,124.03727447364358,115.62748592770117,114.1414572415632,120.16950335825283,124.54351889399076,125.50728589986323,122.59848279111162,117.78921780035344,117.87374702603012,121.46344538503499,123.00503642802835,122.8734071286911,125.0260325714215,130.05322831072004,133.77926904706976,133.55111737490492,127.36586241105557,115.31977487505993,120.14742685497546,132.08991772494053,140.90571592124957,145.90019036520025,146.94986939321637,145.25922677868306,143.01802540646966,142.99611495827006,145.75805912714097,148.7887275816813,150.50010621591636,151.12869154826384,151.3369874794862,151.14782222367967,149.81112513081436,146.74304447140364,142.19704817050356,137.1198908229571,131.9752019882868,125.21794163113624,113.57714712439454,97.1496708876078,101.99777402644207,108.58044026376153,113.26447168913776,112.44799022370425,96.50035067728408,110.7184240927532,124.75329634069374,126.09814773550508,116.55980886066847,92.09290392856308,112.46133923706601,125.10058260240726,133.47227546085253,139.36449484155528,142.62766498926533,143.28651934923624,141.7777189620662,138.76263185246356,135.23412709801426,133.3482677848772,133.95975448544326,134.50352636166627,132.7659707744914,127.74442217998808,118.51443047524482,105.70920689819519,111.95472089630582,123.86037400016116,130.59188784746723,133.04014714791705,131.70252224342494,128.0008127705433,127.38138224297306,129.434918343866,130.34020737337966,130.12929658046303,129.06093066996556,125.57473288368382,115.15550893518736,88.75111693106655,120.22453810765779,130.95014630155598,133.14503685689422,129.55533244102588,122.1039896651948,120.98431843230455,129.14457830522727,135.29395885539418,137.31014313066748,136.0819237857414,134.83640740952785,137.1831284757891,140.30229214517712,141.43509044999527,140.92874954055137,139.99017540878293,138.83460020229015,136.15353009056514,129.23071391558705,117.08769051494484,122.98399945459973,132.34571375732787,134.6597375927039,131.27989475331978,122.65446358116598,109.75949319385768,102.27131663760005,102.80963036664456,104.0666210406399,100.91412970054837,89.06336437380658,95.58870434298841,108.08474410886177,109.975290454292,100.66889665503349,88.96843946142424,108.35377053933227,114.07147267518978,110.93133801377837,109.40847694746347,118.86806993241346,126.52642833562173,129.76501730620384,129.27523809375847,126.67010440280367,124.2867969604617,122.46761377773747,117.95846370606961,104.04194815548871,88.40480038565197,106.82193564925728,107.60151358936267,96.42637893625684,88.65279147756746,104.27502925063335,112.6969219771717,117.9373093683718,121.406189082809,122.22759791766974,121.33894117599992,121.56481739405223,123.53842605672006,124.37982270531079,121.4664769197343,112.5421258034038,92.05572428849077,104.95013039989355,117.2150495419483,122.38464342834497,125.94120162594115,129.56872072251423,132.70817382527588,133.76983838542708,131.96684976064296,127.20200356221375,119.90507895581473,110.88228885993007,105.82567256372081,114.08568971832912,121.98872160371074,124.38192964308752,123.75101574287024,124.49157990671355,127.81856423476499,131.35653746685884,133.61619154056436,134.27054425788754,133.19274055872873,130.25785139226338,125.32131062603564,118.84529769293798,114.73094669137538,117.32300402124814,121.53943096505532,124.9379924905757,129.02643889799754,134.3253630920495,139.64910289859577,143.8496663010949,146.41329976809035,147.13649400326642,145.90790583900943,142.91983020235745,139.0408100268394,136.24004215578535,134.59953604193316,131.88611703248006,126.77824631740835,125.3372918872163,131.3391518029233,136.2994523875791,138.23949026777544,138.01618690253528,136.56384741173846,134.06648656763667,130.41631523162945,126.02312916597072,122.11888737668045,121.93072850705732,126.4549135403018,131.84271947263983,135.2216409007247,135.78574715423088,134.29650210685182,131.90021668190013,129.8594835186377,128.02810329865105,124.82896562622523,119.27804181115263,112.1618210875847,109.7606065138958,114.88031169305953,120.90516479632258,123.89634815814485,124.68805393056857,127.40506420407145,131.92568913122147,134.78655438887444,134.4848762084327,131.22808687816396,124.05101542935647,111.6680648967376,107.59959271972605,119.37875651717499,127.38222796356523,131.3818360741695,131.46362921294215,127.33447882627286,119.12981556963278,113.87365385967676,118.6459118084248,122.47968242291527,122.54191464816928,118.98660493600012,111.3390799924638,98.03459026282384,66.0661580661814,75.82987579913082,82.46862653900081,83.35442562124413,92.95836763726317,103.44710699349196,114.2263158659949,124.07664699923747,131.9837736115233,137.62243813449857,140.2867189328989,139.3177998211297,134.62922878192632,126.52050160692933,123.68212005871749,130.6692723829163,133.96735606383828,132.20629593622854,126.5367302709491,119.75248527642005,117.22061060775094,119.7137227059548,122.3623542790754,120.83475813308127,110.34310180873224,89.01927960713165,120.69558179387168,132.5104431738287,138.12673652205208,140.1080316236496,139.66190688366913,136.93978178629223,132.49447508534894,130.34818088211662,132.497424113394,134.24522201135863,133.6150381540072,131.37917928582317,129.61449782803453,128.68427532159342,128.17334706648543,128.5570699958125,129.62991707093713,130.74845529998203,134.16233629157972,140.3412106741102,145.92797999640203,149.0383053133878,149.4364893947315,148.0554258060447,146.3695241642237,145.83421067683977,146.10029858906174,145.5471045139762,143.17158774370387,138.29280912280117,129.4537010593994,111.58363981456151,92.9500761571869,118.07215437644277,127.15033919507839,131.78855357780378,135.09324290014425,137.02860179241654,137.23047459407942,136.94397279949845,137.86427558389795,140.02962568671,142.3485383990313,144.04004642976972,145.23040828356415,146.91784789675518,149.77722092433748,152.83961538279263,154.53838820199408,154.767354252018,155.10287774079123,156.66466873822475,158.52065843724156,159.60779223082642,159.8694960176258,159.69121555858095,159.09241653554025,158.03511913820253,157.40026253234646,158.2700924193581,160.33717038158198,162.69577420981906,164.56028366121572,165.02755215312504,163.283454921089,158.65569137848354,151.30289226152428,145.98183448662513,145.5672642570963,141.00160436370405,144.56602842693394,158.76317699692117,167.70472832739583,173.28440040276342,177.63272863056815,182.25384109168323,187.0496190825908,190.998692836551,193.5896629106951,195.4906998402826,197.26171132802398,198.68440631822128,199.29787388223784,200.06585544947043,202.15749478072573,204.1179813944494,203.48988916928616,198.68772392755173,187.46942834049108,167.07117359067868,172.52204017273783,183.33627056640074,189.56207222209986,194.98293881072215,199.6589895567035]],d2=_.memo((({layer:e,width:t,height:o,analyser:a})=>{var i;const s=h.useRef(null),n=(null==(i=s.current)?void 0:i.getContext("2d"))||null,r=h.useRef(!1),l=h.useRef(null),d=h.useRef(null),c=h.useRef(!1),u=tl(XN),m=h.useRef(!u),p=_E(),g=cE((()=>{const a=o/2,i="wave"===e.waveformStyle?a:o;if(n)if(n.fillStyle=e.color,"wave"===e.waveformStyle){let e=.01*o;e>5?e=5:e<2&&(e=2),n.fillRect(0,i,t,e)}else for(let e=0;e<t;e+=1){const a=Math.floor(.005*t)||1,i=e*(2*a),s=.05*o;n.fillRect(i,o,a,-s)}})),f=cE(((e,t,o,a)=>{const i=Math.floor(.0015*o)||1,s=e*i,r=.5*a,l=t/255*a*.34;null==n||n.fillRect(s,r+1,i,-l),null==n||n.fillRect(s,r-1,i,l)})),y=cE(((e,t,o,a)=>{const i=Math.floor(.005*o)||1,s=e*(2*i),r=a,l=-(t/255)*a*.8;null==n||n.fillRect(s,r,i,l)})),v=cE((()=>{if(r.current||0===d.current)return r.current=!1,void(d.current=null);if(null!==d.current&&d.current--,!((e,t)=>e[0]<=t&&t<=e[1])(TS(e),bE()))return void(null==n||n.clearRect(0,0,t,o));if(aE())return void b();l.current=window.requestAnimationFrame((()=>{v()})),a.fftSize=4096;const i=new Uint8Array(a.frequencyBinCount);a.getByteFrequencyData(i),_(i)})),_=cE((a=>{if(!n)return;n.clearRect(0,0,t,o),n.fillStyle=e.color;const i=t;for(let s=0;s<i;s+=1)"wave"===e.waveformStyle?f(s,a[s],t,o):"bar"===e.waveformStyle&&y(s,a[s],t,o)})),b=cE((()=>{let t;if("wave"===e.waveformStyle)[t]=l2;else[t]=r2;_(t)}));h.useEffect((function(){a&&s.current&&(c.current||(g(),b(),c.current=!0),u?null!==l.current&&window.cancelAnimationFrame(l.current):l.current=window.requestAnimationFrame((()=>v())))}),[c,a,s,u,g,b,v]),h.useEffect((function(){aE()?v():g()}),[t,o,v,g]);const T=cE((e=>{null!==l.current&&window.cancelAnimationFrame(l.current),d.current=e,l.current=window.requestAnimationFrame((()=>v()))}));return h.useEffect((function(){m.current&&T(1)}),[m,T,e]),h.useEffect((function(){u&&m.current&&T(12),m.current=u}),[p,u,m,T]),w.jsx("canvas",{"data-cy":`waveform-${e.id}`,width:t,height:o,ref:s})})),c2=e=>({size:e.getUint32(0),type:String.fromCharCode(e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7))});class u2 extends Error{constructor(e,t){super(t),i(this,"name","FetchError"),i(this,"status"),i(this,"statusText"),this.response=e,this.status=e.status,this.statusText=e.statusText}}async function*m2(e){if(!e.body||!e.ok)throw new u2(e);const t=e.body.getReader();for(;;){const e=await t.read();if(e.done)return;yield e.value}}class p2{constructor(e,t=0){i(this,"currentStream"),this._stream=e,this.byteOffset=t}[Symbol.asyncIterator](){return this}async getStream(){if(null==this.currentStream||0===this.currentStream.length){const e=await this._stream.next();if(e.done)return;this.currentStream=e.value}return this.currentStream}async consumeAtMost(e){const t=await this.getStream();if(null==t)return;if(null!=e&&t.length>e){const o=t.subarray(0,e);return this.currentStream=t.subarray(e),this.byteOffset+=o.length,o}const o=t;return this.currentStream=void 0,this.byteOffset+=o.length,o}async peakExactly(e){const t=await this.getStream();if(null==t)return;if(t.length>=e)return t.subarray(0,e);const o=[t];let a=t.length;for(;a<e;){this.currentStream=void 0;const e=await this.getStream();if(null==e)break;a+=e.length,o.push(e)}const i=new Uint8Array(a);let s=0;for(const n of o)i.set(n,s),s+=n.length;return this.currentStream=i,i.subarray(0,e)}async nextAtMost(e){const t=await this.consumeAtMost(e);return null==t?{done:!0,value:void 0}:{done:!1,value:t}}async nextExactly(e){const t=await this.consumeAtMost(e);if(null==t)return{done:!0,value:void 0};const o=new Uint8Array(e);o.set(t,0);let a=t.length;for(;a<e;){const t=await this.consumeAtMost(e-a);if(null==t)throw new Error("Not enough bytes");o.set(t,a),a+=t.length}return{done:!1,value:o}}async next(){return this.nextAtMost(void 0)}return(...e){return this._stream.return(...e)}throw(e){return this._stream.throw(e)}}async function h2(e){const t=await e.peakExactly(8);if(!(null==t||t.length<8))return c2(new DataView(t.buffer,t.byteOffset,t.length))}const g2=async e=>{const t=await b$(e.mediaLibraryId);if(null!=t){if(t.assetId===e.assetId){if(t.fragmented&&t.headers)return t.headers;throw new NH(e.mediaLibraryId,"IndexDB file is not fragmented")}x$(e.mediaLibraryId)}const o=()=>{T$({mediaCacheId:e.mediaLibraryId,assetId:e.assetId,fragmented:!1})};let a,i,s=0;const n=[],r=new p2(async function*({url:e,signal:t,headers:o={}},a=1e5){let i,s=0,n=a;const r=new AbortController,l=t?kH([t,r.signal]):r.signal;try{for(;;){AH(t);const r=await fetch(e,{signal:l,headers:{...o,Range:`bytes=${s}-${n}`}});if(null==i){const e=r.headers.get("Content-Range"),t=null==e?void 0:e.match(/^bytes \d+-\d+\/(\d+)$/);null!=t&&(i=Number(t[1]))}for await(const e of m2(r))AH(t),yield e;if(s+=a+1,n=s+a,null!=i&&i<s)return}}finally{r.abort()}}({...e}));for await(const l of async function*(e){try{for(;;){const t=await h2(e);if(null==t)return;const o=await e.nextExactly(t.size);if(o.done||o.value.length<t.size)return;yield o.value}}finally{e.return()}}(r)){switch(c2(new DataView(l.buffer,l.byteOffset,l.byteLength)).type){case"ftyp":a=l;break;case"moov":if(!a)throw o(),new NH(e.mediaLibraryId,"Mp4 file doesn't contain ftyp\nthis should be impossible");i=new Uint8Array(a.length+l.length),i.set(a,0),i.set(l,a.length);break;case"sidx":n.push({offset:s,bytes:l})}s+=l.length;const t=await h2(r);if(null==t||"moof"===t.type||"mdat"===t.type||n.length)break;if("moov"===t.type&&t.size>5e3)break}if(r.return(),null==i||0===n.length){if(o(),!i)throw new NH(e.mediaLibraryId,"Could not parse the initialization segment");if(0===n.length)throw new NH(e.mediaLibraryId,"Could not parse any sidx atoms")}return T$({mediaCacheId:e.mediaLibraryId,assetId:e.assetId,fragmented:!0,headers:{initSegment:i,sidx:n}}),{assetId:e.assetId,initSegment:i,sidx:n}},f2=new Map,y2=async e=>{const t=await Xs(f2,e.assetId,{async insert(){try{return await g2(e)}finally{f2.delete(e.assetId)}}}),o=t.sidx.map((e=>{const t=Et.inspect(e.bytes)[0];return t.offset=e.offset,t})),a=((e,t,o)=>{const a=Ct();s.uniqBy(o,(e=>e.firstOffset+e.offset+e.size)).length>1&&f("Fragmented mp4 file has multiple distinct sidx atoms",{extra:{mediaLibraryId:e,assetId:t}}),0!==o.length&&0!==o[0].references.length||f("Fragmented mp4 file is empty",{extra:{mediaLibraryId:e,assetId:t}});const i=o[0];if(null==i)throw new NH(e,"No sidx atoms to parse\nIs this file fragmented?");const{timescale:n}=i;let r=i.earliestPresentationTime,l=i.firstOffset+i.offset+i.size;if(0===n)throw new NH(e,"Invalid timescale");let d=0;for(const s of i.references){if(0!==s.referenceType)throw new NH(e,"Unsupported SIDX format");const o=r/n,i=(r+s.subsegmentDuration)/n,c=l,u=l+s.referencedSize-1,m={idx:d,mediaLibraryId:e,assetId:t,startTime:o,endTime:i,duration:s.subsegmentDuration/n,size:s.referencedSize,byteRange:[c,u]};d+=1,a.insert([o,i,m]),r+=s.subsegmentDuration,l+=s.referencedSize}return a})(e.mediaLibraryId,e.assetId,o),i=(n=o,Math.max(...n.map((e=>e.references.reduce(((e,t)=>e+t.subsegmentDuration),0)/e.timescale))));var n;const r=It.tracks(t.initSegment).filter((e=>"video"===e.type||"audio"===e.type));return{mimeType:`${r.some((e=>"video"===e.type))?"video":"audio"}/mp4; codecs="${r.map((e=>e.codec)).join(",")}";`,initializationSegment:t.initSegment,tree:a,duration:i}},v2=e=>new Promise((t=>e.addEventListener("updateend",t,{once:!0}))),_2=new Map;async function w2(e,t,o,a){const i=(e=>{const t=new AbortController,o=new Set;function a(e){o.delete(e.currentTarget),0===o.size&&t.abort()}for(const i of e)i.aborted||(o.add(i),i.addEventListener("abort",a));return 0===o.size&&t.abort(),t.signal})([a,jH(5e3)]),s=o.map((({segment:t})=>{const o=`${t.mediaLibraryId}_${t.idx}`;return Xs(_2,o,{async insert(){try{const n=await S$(t.assetId,t.idx);if(null!=n)return n;const r=await fetch(e,{signal:i,headers:{Range:`bytes=${t.byteRange[0]}-${t.byteRange[1]}`}}).then((e=>{if(!e.ok)throw e;return e})).then((e=>e.blob())).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e)));return a=t.mediaLibraryId,s=t.size,wH[a]?wH[a]+=s:wH[a]=s,EH("asset_segment_sizes",wH),hF("segmented",t.mediaLibraryId,t.size),E$(t.mediaLibraryId,t.assetId,t.idx,r),r}finally{_2.delete(o)}var a,s}})}));for(const n of s){const e=await n;if(AH(a),e){for(;t.updating;)await v2(t),AH(a);t.appendBuffer(e)}}}class b2{constructor(e,t,o){i(this,"queue",[]),i(this,"queueSorted",!1),i(this,"controller"),this.url=e,this.signal=t,this.buffer=o}isSegmentLoaded(e){let t=0,o=this.buffer.buffered.length-1;for(;t<=o;){const a=Math.floor((t+o)/2),i=this.buffer.buffered.start(a),s=this.buffer.buffered.end(a);if(e.startTime>=i&&e.endTime<=s)return!0;s<=e.startTime?t=a+1:o=a-1}return!1}clear(){var e;null==(e=this.controller)||e.abort(),this.queue.splice(0,this.queue.length)}async enqueue(e){for(const a of e)this.queue.push(a),this.queueSorted=!1;if(null!=this.controller&&!this.controller.signal.aborted)return;const t=new AbortController;this.controller=t;const o=kH([this.signal,t.signal]);try{for(;this.queue.length;){AH(o),this.queueSorted||(this.queue.sort(((e,t)=>e.priority-t.priority)),this.queueSorted=!0);const e=[];for(;e.length<5&&this.queue.length;){const t=this.queue.shift();null==t||this.isSegmentLoaded(t.segment)||e.push(t)}await w2(this.url,this.buffer,e,o),AH(o)}}catch(IGe){if(IGe instanceof DOMException&&IGe.name.startsWith("AbortError"))return;throw IGe}finally{t.abort()}}}const T2=new class{constructor(e){i(this,"queue",new Map),i(this,"currentCalls",0),this.concurrentCalls=e}enqueue(e,t){this.queue.set(e,t),this.currentCalls<this.concurrentCalls&&(this.currentCalls+=1,this.loop().finally((()=>{this.currentCalls-=1})))}async loop(){for(;this.queue.size;){const e=this.queue.entries().next();if(e.done||null==e.value)return;try{this.queue.delete(e.value[0]);const t=e.value[1];await t()}catch{console.error(e.value,"failed")}}}}(5),x2=new Map,S2=class e{constructor(t){i(this,"mediaLibraryId"),i(this,"assetId"),i(this,"video"),i(this,"controller"),i(this,"mp4State"),i(this,"url"),i(this,"pausedBuffer"),i(this,"destroyed",!1),this.mediaLibraryId=t.mediaLibraryId,this.assetId=t.assetId,this.video=t.video,this.controller=new AbortController,this.url=t.url,this.pausedBuffer=t.pausedBuffer??e.MAX_BUFFER_TIME,t.signal.addEventListener("abort",(()=>{this.controller.abort()})),t.signal.aborted&&this.controller.abort(),this.error=this.error.bind(this),this.cleanup=this.cleanup.bind(this),this.listen=this.listen.bind(this),this.bufferCurrentTime=this.bufferCurrentTime.bind(this),this.forceBufferCurrentTime=this.forceBufferCurrentTime.bind(this),this.getMp4State=this.getMp4State.bind(this),this.listen(),T2.enqueue(`${this.mediaLibraryId}.${this.assetId}`,this.getMp4State)}updateUrl(e){this.url=e,this.mp4State&&this.mp4State.then((({queue:e})=>{e.url=this.url}))}async getMp4State(){return this.mp4State||(this.mp4State=(async()=>{const e=await y2({mediaLibraryId:this.mediaLibraryId,assetId:this.assetId,signal:this.controller.signal,url:this.url});if(AH(this.controller.signal),!MediaSource.isTypeSupported(e.mimeType))throw console.error("Type not supported!"),new NH(this.mediaLibraryId,"Type not supported!",{mimeType:e.mimeType});const t=new MediaSource,o=URL.createObjectURL(t);this.video.src=o,await new Promise((e=>{t.addEventListener("sourceopen",e,{once:!0})})),AH(this.controller.signal),t.duration=e.duration;const a=t.addSourceBuffer(e.mimeType);return t.addEventListener("sourceclose",this.error),a.addEventListener("error",this.error),a.appendBuffer(e.initializationSegment),{headers:e,mediaSource:t,mediaSourceLink:o,sourceBuffer:a,queue:new b2(this.url,this.controller.signal,a)}})().catch((e=>{throw R(e),this.controller.abort(),e}))),this.mp4State}getNodesToBuffer(t,o,a=0){const i=[],s=(this.video.paused?this.pausedBuffer:e.MAX_BUFFER_TIME)*this.video.playbackRate;return t.queryInterval(o-s,o+s,(([,,e])=>{let t;t=e.startTime<=o&&o<=e.endTime?-1:e.endTime<=o?o-e.endTime:e.startTime-o,i.push({segment:e,priority:t+a})})),0===i.length?(Xs(x2,this.assetId,{insert:()=>{f("can't find a node for this time? this should never happen",{extra:{time:o,url:this.url,assetId:this.assetId,mediaLibraryId:this.mediaLibraryId}})}}),[]):i.sort(((e,t)=>e.priority-t.priority))}async prebuffer(e){const{headers:t,queue:o}=await this.getMp4State(),a=this.getNodesToBuffer(t.tree,e,5);o.enqueue(a)}async forceBufferCurrentTime(){var e;const{headers:t,queue:o}=await this.getMp4State(),a=this.getNodesToBuffer(t.tree,this.video.currentTime);null==(e=o.controller)||e.abort(),o.clear(),o.enqueue(a)}async bufferCurrentTime(){const{headers:e,queue:t}=await this.getMp4State(),o=this.getNodesToBuffer(e.tree,this.video.currentTime);t.enqueue(o)}listen(){this.video.addEventListener("timeupdate",this.bufferCurrentTime),this.video.addEventListener("playing",this.forceBufferCurrentTime),this.video.addEventListener("error",this.error),this.controller.signal.addEventListener("abort",this.cleanup);const e=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"currentTime");Object.defineProperty(this.video,"currentTime",{...e,set:t=>{null==e||e.set.call(this.video,t),this.forceBufferCurrentTime()}})}error(e){this.video.dataset.mseError="true",R(e),this.cleanup()}cleanup(){if(this.destroyed)return;this.destroyed=!0,delete I2[this.mediaLibraryId],this.controller.abort(),this.video.removeEventListener("timeupdate",this.bufferCurrentTime),this.video.removeEventListener("playing",this.forceBufferCurrentTime),this.video.removeEventListener("error",this.error),this.controller.signal.removeEventListener("abort",this.cleanup),this.controller.abort();const e=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"currentTime");e&&Object.defineProperty(this.video,"currentTime",e),this.mp4State&&this.mp4State.then((({mediaSource:e,mediaSourceLink:t,sourceBuffer:o})=>{e.removeEventListener("sourceclose",this.error),o.removeEventListener("error",this.error),URL.revokeObjectURL(t);for(const a of e.activeSourceBuffers)e.removeSourceBuffer(a)})),delete this.video.dataset.mse,delete this.video.dataset.mediaId,this.video.src=this.url,this.video.load()}};i(S2,"MAX_BUFFER_TIME",15);let E2=S2;const I2={};function C2(e,{url:t,signal:o,mediaLibraryId:a,assetId:i,pausedBuffer:s}){if("undefined"==typeof MediaSource)return void(e.src=t);e.dataset.mse="true",e.dataset.mediaId=a;return new E2({mediaLibraryId:a,assetId:i,video:e,signal:o,url:t,pausedBuffer:s})}const k2=e=>{console.debug("OnPause: ",e)};class A2{constructor(e){i(this,"id"),i(this,"domElementByLayerId",new Map),i(this,"isCanvas"),i(this,"layerIdsByMediaId",new Map),i(this,"layerIdsByElementId",new Map),i(this,"layerByLayerId",new Map),i(this,"domElementByDomId",new Map),i(this,"numVideoElements",0),i(this,"abortController",new AbortController),i(this,"streamsByElementId",new Map),i(this,"batchedTimeout"),i(this,"batchedUpdateLayers",{}),i(this,"batchedUpdateLocalLayerValues",{});const{isCanvas:t=!1}=e;this.isCanvas=t,this.id=t?`canvas_${e.id}`:e.id}getJsonLayerIdToElementId(){const e={};for(const[t,o]of this.domElementByLayerId)e[t]=o.id;return e}static doTimesOverlap(e,t,o=!0){return!o&&e[0]<t[1]&&e[1]>t[0]||!!(o&&e[0]<=t[1]&&e[1]>=t[0])}logAmplitudeEvents(e,t){const o=t.startsWith("blob:")?"local":"remote";e.onplay=()=>{console.debug("OnPlay: ",e.id)},e.onpause=k2.bind(null,e.id),e.onseeking=()=>{},e.onseeked=()=>{},e.onerror=()=>{var a,i;console.debug("ElementPool onerror",{src:t,localOrRemoteSrc:o,errorCode:null==(a=e.error)?void 0:a.code,errorMessage:null==(i=e.error)?void 0:i.message})},e.onwaiting=()=>{console.debug("OnWaiting: ",e.id)}}logAmplitudeUsageEvents(){const e=pF.getMetrics();e&&e["Bytes fetched"]&&e["Bytes fetched"]>1e9&&Fm(ym.VIDEO_USAGE,e),pF.map.clear()}createVideoElement(e){const{url:t,disableCORS:o,type:a,mediaId:i}=e,s=document.createElement("video");iH(s),s.id=`ep_${this.id}_v${this.numVideoElements}`,this.numVideoElements+=1,s.autoplay=!1,s.preload=Yg()?"metadata":"auto",s.crossOrigin="anonymous",s.playsInline=!0,s.setAttribute("style","width: 100%; height: 100%;"),this.logAmplitudeEvents(s,t),o&&(s.crossOrigin=null),Yg()&&s.setAttribute("data-hasBeenPlayed","false");if("video"===a&&BI({isCanvas:this.isCanvas,mediaPipe:e.mediapipe})&&e.fragmented){const o=C2(s,{url:t,mediaLibraryId:e.mediaId,assetId:e.previewAssetId,signal:this.abortController.signal});o&&this.streamsByElementId.set(s.id,o)}else s.src=t;return s.addEventListener("loadedmetadata",(()=>{if(s.setAttribute("data-hasBeenPlayable","true"),this.layerIdsByElementId.has(s.id)){const e=this.layerIdsByElementId.get(s.id).map((e=>[e,{readyForTrackComponentRender:!0}]));Object.assign(this.batchedUpdateLocalLayerValues,Object.fromEntries(e)),this.enqueueUpdateToRedux()}}),{once:!0}),s.addEventListener("durationchange",(()=>{const e=s.duration;if(Number.isNaN(e))return;const t=[],{state:{studio:o}}=sr();for(const a of this.layerIdsByElementId.get(s.id)||[]){const e=o.allLayers.byId[a];e&&!e.duration&&t.push(a)}0!==t.length&&(console.debug("updating layer durations for ",t.length,"layers",t),Object.assign(this.batchedUpdateLayers,Object.fromEntries(t.map((t=>[t,{duration:e}])))),this.enqueueUpdateToRedux())})),mF.attachEvents(s,i),pF.attachEvents(s,i),s.addEventListener("seeking",(function(){this.dataset.seekStatus="seeking"})),s.addEventListener("seeked",(function(){this.dataset.seekStatus="seeked"})),s.addEventListener("waiting",(function(){this.dataset.waitingSince=String(performance.now())})),s.addEventListener("canplay",(function(){delete this.dataset.waitingSince})),s.addEventListener("loadeddata",(function(){Nw("canvas")}),{once:!0}),s}findLayerIdWithReusableElement(e){const t=this.layerIdsByMediaId.get(e.mediaId);let o;for(const a of t){const{startEndTimes:t}=this.layerByLayerId.get(a);if(A2.doTimesOverlap(t,e.startEndTimes))continue;const i=this.domElementByLayerId.get(a),s=this.layerIdsByElementId.get(i.id);let n=!1;for(const o of s){const t=this.layerByLayerId.get(o);if(A2.doTimesOverlap(e.startEndTimes,t.startEndTimes)){n=!0;break}}if(!n){o=a;break}}return o}findLayersOverlappingTarget(e){const t=this.layerIdsByMediaId.get(e.mediaId),o=[];return t?(t.forEach((t=>{const a=this.layerByLayerId.get(t);A2.doTimesOverlap(e.startEndTimes,a.startEndTimes)&&o.push(a)})),o):[]}isCurrentElementMappingValid(e,t){const o=this.domElementByLayerId.get(e.layerId);if(!o)return console.error("Ran `isCurrentElementMappingValid` with no valid target element."),!0;for(const a of t)if(a.layerId!==e.layerId&&this.domElementByLayerId.get(a.layerId)===o)return!1;return!0}getCachedLayerIdsToInvalidate(e){const t=[];e.filter((e=>{const t=this.layerByLayerId.get(e.layerId);if(!t)return!1;const[o,a]=t.startEndTimes,[i,s]=e.startEndTimes;return!(o===i&&a===s)})).forEach((e=>{const o=this.findLayersOverlappingTarget(e);this.isCurrentElementMappingValid(e,o)||t.push(e.layerId)}));return e.filter((e=>!this.layerByLayerId.get(e.layerId))).forEach((o=>{this.findLayersOverlappingInNewTimeline(o,e).forEach((e=>{t.includes(e.layerId)||t.push(e.layerId)}))})),t}findLayersOverlappingInNewTimeline(e,t){const o=t.filter((t=>t.mediaId===e.mediaId)),a=[];return o.forEach((t=>{t.layerId!==e.layerId&&A2.doTimesOverlap(e.startEndTimes,t.startEndTimes,!1)&&a.push(t)})),a}destroyDomPool(){this.logAmplitudeUsageEvents(),this.abortController.abort(),this.abortController=new AbortController;for(const[e,t]of this.domElementByDomId)t.remove();for(const[e,t]of this.streamsByElementId)t.cleanup();this.streamsByElementId.clear(),this.domElementByDomId.clear(),this.domElementByLayerId.clear(),this.layerByLayerId.clear(),this.layerIdsByElementId.clear(),this.layerIdsByMediaId.clear(),this.numVideoElements=0}regenerateDomPool(e){var t;const o=new Map(this.domElementByLayerId);this.getCachedLayerIdsToInvalidate(e).forEach((e=>{o.delete(e)})),this.domElementByLayerId=new Map,this.layerIdsByMediaId=new Map,this.layerIdsByElementId=new Map,this.layerByLayerId=new Map,e.forEach((e=>{this.layerByLayerId.set(e.layerId,e)}));for(const a of e)if(o.has(a.layerId)){const e=o.get(a.layerId),t=this.streamsByElementId.get(e.id);let i;if(i=e.dataset.mse?null==t?void 0:t.url:e.src,a.url!==i&&void 0!==i){const o=()=>{const{currentTime:o,muted:i}=e;e.muted=i,e.crossOrigin=a.disableCORS?null:"anonymous";if("video"===a.type&&BI({isCanvas:this.isCanvas,mediaPipe:a.mediapipe})&&a.fragmented&&!e.dataset.mseError)if(e.dataset.mse)null==t||t.updateUrl(a.url);else{const t=C2(e,{url:a.url,mediaLibraryId:a.mediaId,assetId:a.previewAssetId,signal:this.abortController.signal});t&&this.streamsByElementId.set(e.id,t)}else e.src=a.url;e.currentTime=o,Yg()&&e.load()};e.paused?o():e.onpause=()=>{o(),e.onpause=k2.bind(null,e.id)}}this.domElementByLayerId.set(a.layerId,e),this.domElementByDomId.set(e.id,e),e.hasAttribute("data-hasBeenPlayable")&&LE(a.layerId,{readyForTrackComponentRender:!0}),this.layerIdsByElementId.has(e.id)?this.layerIdsByElementId.get(e.id).push(a.layerId):this.layerIdsByElementId.set(e.id,[a.layerId]),this.layerIdsByMediaId.has(a.mediaId)?this.layerIdsByMediaId.get(a.mediaId).push(a.layerId):this.layerIdsByMediaId.set(a.mediaId,[a.layerId]),o.delete(a.layerId)}else if(this.layerIdsByMediaId.has(a.mediaId)){const e=this.findLayerIdWithReusableElement(a);if(e){const o=this.domElementByLayerId.get(e);this.domElementByLayerId.set(a.layerId,o),this.domElementByDomId.set(o.id,o),null==(t=this.layerIdsByElementId.get(o.id))||t.push(a.layerId),this.layerIdsByMediaId.get(a.mediaId).push(a.layerId),o.hasAttribute("data-hasBeenPlayable")&&LE(a.layerId,{readyForTrackComponentRender:!0})}else{const e=this.createVideoElement(a);this.domElementByLayerId.set(a.layerId,e),this.domElementByDomId.set(e.id,e),this.layerIdsByElementId.set(e.id,[a.layerId]),this.layerIdsByMediaId.get(a.mediaId).push(a.layerId)}}else{const e=this.createVideoElement(a);this.domElementByLayerId.set(a.layerId,e),this.domElementByDomId.set(e.id,e),this.layerIdsByElementId.set(e.id,[a.layerId]),this.layerIdsByMediaId.set(a.mediaId,[a.layerId])}for(const[a,i]of o)i.pause(),i.remove();for(const[a,i]of this.streamsByElementId)this.domElementByDomId.has(a)||(i.cleanup(),this.streamsByElementId.delete(a));for(const a of this.domElementByDomId.keys()){const e=this.layerIdsByElementId.get(a);if(!e||!e.length){const e=this.domElementByDomId.get(a);e&&tH(e),this.domElementByDomId.delete(a)}}}getDomIdFromLayerId(e){return`EPContainer_${this.id}_${e}`}enqueueUpdateToRedux(){this.batchedTimeout||(this.batchedTimeout=setTimeout((()=>{this.batchedTimeout=void 0,s.isEmpty(this.batchedUpdateLayers)||OI(this.batchedUpdateLayers,"EP:newElement.durationchange",!1),s.isEmpty(this.batchedUpdateLocalLayerValues)||FE(this.batchedUpdateLocalLayerValues),this.batchedUpdateLayers={},this.batchedUpdateLocalLayerValues={}}),0))}}!function(){function e(e){e&&(e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime))}"undefined"!=typeof window&&JG()&&(window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return e(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var o=t?this.internal_createDelay(t):this.internal_createDelay();return e(o.delayTime),o},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start?(t.internal_start=t.start,t.start=function(e,o,a){void 0!==a?t.internal_start(e||0,o,a):t.internal_start(e||0,o||0)}):t.start=function(e,t,o){t||o?this.noteGrainOn(e||0,t,o):this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},e(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return e(t.threshold),e(t.knee),e(t.ratio),e(t.reduction),e(t.attack),e(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return e(t.frequency),e(t.detune),e(t.Q),e(t.gain),t},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start?(t.internal_start=t.start,t.start=function(e){t.internal_start(e||0)}):t.start=function(e){this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},t.setPeriodicWave||(t.setPeriodicWave=t.setWaveTable),e(t.frequency),e(t.detune),t})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext))}();const j2=_.createContext(null),N2=_.memo((({children:e,id:t,selectElementPoolLayers:o,selectCanvasElementPoolLayers:a})=>{const i=il(),[s]=h.useState((()=>(i(rS.initialize({elementPoolId:t})),new A2({isCanvas:!0,id:t}))));window.canvasElementPoolById||(window.canvasElementPoolById={}),window.canvasElementPoolById[t]=s;const n=_E(),r=tl(a),l=tl(o),d=tl((e=>e.studioLocal.isLayerMountedByLayerId),g.shallowEqual),c=tl((e=>{var o;return"number"==typeof(null==(o=e.elementPool.byElementPoolId[t])?void 0:o.userManualSeekTime)})),u=h.useRef([]),m=h.useRef((e=>!1));return h.useEffect((()=>{m.current=e=>{const t=l.find((t=>ME(e,t.startEndTimes[0],.03333333333333333)))||r.find((t=>t.type===zl.Video&&ME(e,t.startEndTimes[0],.03333333333333333)));return!!t&&!d[t.layerId]}}),[l,r,d]),h.useEffect((function(){s.regenerateDomPool(r)}),[r,s]),h.useEffect((function(){const e=[];for(const[t,o]of s.domElementByDomId){const a=s.layerIdsByElementId.get(t);if(!a){console.warn(`Video ${t}: no layers for `,o.src);continue}const i=e=>{const t=s.layerByLayerId.get(e),[o,a]=t.startEndTimes;return o<=n&&n<=a||(!(!X0(a,n,!1)||!m.current(a))||!(!u.current.includes(e)||!c))};if(a.every((t=>!i(t)||(e.push(t),!1)))){const e=a.find((e=>{const t=s.layerByLayerId.get(e),[o,a]=t.startEndTimes;return n<o}))||a[0],t=s.layerByLayerId.get(e);o.pause(),o.remove(),IH(e,!1),ME(o.currentTime,t.relativeStartEndTimes[0],.03333333333333333)||setTimeout((()=>{o.currentTime=t.relativeStartEndTimes[0]}),0)}}u.current=e}),[n,c,s]),h.useEffect((function(){return()=>{s.destroyDomPool()}}),[s]),w.jsx(j2.Provider,{value:s,children:e})}));const R2=x1(),P2=$g(),D2={fontSize:12,marginBottom:10},O2=(e,t)=>e[0]<=t&&t<e[1],L2=e=>e.removeBg||e.blurBg||e.chromaKey;let F2=(o=class extends h.PureComponent{constructor(e){var t;super(e),i(this,"analyser",null),i(this,"audiogramErrorToastShown"),i(this,"canvas",null),i(this,"videoContainer",_.createRef()),i(this,"didLogVideoAnalytics"),i(this,"firstTimeReferenceLayer",!1),i(this,"filterCanvas",null),i(this,"fullIntermediateCanvas",null),i(this,"logFileExperiment",null),i(this,"logFileSize",null),i(this,"logFileSource"),i(this,"logFileType",null),i(this,"loopSetStudioTimeID",null),i(this,"mounted"),i(this,"mountTime"),i(this,"onCanPlayTime"),i(this,"onLoadedDataTime"),i(this,"onLoadedMetadataTime"),i(this,"onLoadStartTime"),i(this,"previousDrawingTime",null),i(this,"reverseAudio",null),i(this,"reversedIntervalID",null),i(this,"setStudioTimeLoopRunning",!1),i(this,"shouldSetStudioTimeFromVideo",!1),i(this,"smallIntermediateCanvas",null),i(this,"staticVideo",null),i(this,"video",null),i(this,"videoDriftCounter"),i(this,"videoDriftInterval"),i(this,"webGLCanvas",null),i(this,"mediapipeSegmentResults",null),i(this,"currentProcessedBlurValue",null),i(this,"setupSelfieSegmentation",(e=>{e.onResults(this.onMediapipeSegmentResults),this.setState({selfieSegmentationLoaded:!0})})),i(this,"setStudioTimeFromVideo",(async()=>{if(!this.video||!this.props.setsTime||!dC(this.props.layer))return;const[e,t]=this.props.absoluteTimes,o=this.props.layer.startTime||0,a=this.props.layer.playbackRate||1,i=OH(this.props.studioTime,e,o,a);if(this.firstTimeReferenceLayer)DH(i,this.video.currentTime,i+.03333333333333333)||await UH(this.video,i),this.firstTimeReferenceLayer=!1;else{const{currentTime:t}=this.video;if(!(t-.03333333333333333<=i&&i<=t+.03333333333333333)){const t=LH(this.video.currentTime,e,o,a);this.props.setEPTime(t)}}})),i(this,"loopSetStudioTimeFromVideo",(()=>{this.loopSetStudioTimeID=window.setTimeout((async()=>{if(this.shouldSetStudioTimeFromVideo)try{await this.setStudioTimeFromVideo()}finally{this.loopSetStudioTimeFromVideo()}else this.setStudioTimeLoopRunning=!1}),33.333333333333336)})),i(this,"openSetStudioTimeInterval",(()=>{this.setStudioTimeLoopRunning||(this.setStudioTimeLoopRunning=!0,this.shouldSetStudioTimeFromVideo=!0,this.firstTimeReferenceLayer=!0,this.loopSetStudioTimeFromVideo())})),i(this,"closeSetStudioTimeInterval",(()=>{this.shouldSetStudioTimeFromVideo=!1})),i(this,"setVideoSrc",((e=!1)=>{const{layer:t}=this.props,{videoSrc:o}=this.state,a=k0(t)||"",i=a.startsWith("blob:"),s=null==o?void 0:o.startsWith("blob:");if((i||!s)&&a!==o){const t={videoSrc:a};e&&!this.state.videoSrc&&(t.videoSrcAtMount=a||""),this.setState(t),this.logFileSource="gcs"}})),i(this,"updateReversedVideoTime",(()=>{this.video&&void 0!==this.video.currentTime&&(this.video.currentTime-=.1*(this.props.layer.playbackRate??1)*this.props.globalPlaybackRate)})),i(this,"setupVideo",(async()=>{const{layer:e,studioPaused:t}=this.props;this.video&&(this.video.onloadedmetadata=this.initVideo,this.video.onerror=this.handleError,(e.isAudiogram||e.local_url)&&(e.isReversed&&this.initReverseAudio(),e.isAudiogram&&this.initAnalyser()),t&&(this.video.pause(),sH(this.video,0),this.reverseAudio&&sH(this.reverseAudio,0)),await v1(this.props.layer,this.video,this.props.studioTime),rR({time:null})),this.staticVideo&&(this.staticVideo.onloadedmetadata=this.initStaticVideo,this.staticVideo.onerror=this.handleError,this.staticVideo.onloadeddata=async({currentTarget:t})=>{t instanceof HTMLVideoElement&&(await UH(t,bE()-(e.videoDelay||e.startTime||0)),this.drawPreviewToCanvas())})})),i(this,"checkHasAudio",(()=>{const{video:e}=this,{layer:t}=this.props;if(e){const o=e.mozHasAudio||(e.audioTracks||[]).length>0||e.webkitAudioDecodedByteCount>0;OI({[t.id]:{hasAudio:o}},"Video.tsx",!1)}})),i(this,"getNumVideoLayers",(()=>{const e=sr().state.studio.allLayers.byId;let t=0;return Object.values(e).forEach((e=>("video"===e.type&&(t+=1),!0))),t})),i(this,"setVolume",(()=>{const{layer:e,layerTempValues:t,absoluteTimes:[o,a],studioTime:i}=this.props;if(!this.video)return;const{volumeTemp:s}=t||{},n=this.props.layer.volume;let r=e.isMuted?0:Number(s??n);if(Number.isNaN(r)&&(r=1),"fade"===e.audioEffect){const{fadePosition:t,fadeSpeed:s}=e;r*=(e=>{const{start:t,end:o,current:a,fadeSpeed:i,fadePosition:s}=e;if(!i)return 0;const n=_1[i];if(!n)return 0;let r=1;("intro"===s||"both"===s)&&t<=a&&a<t+n&&(r=w1.invertedParabola((a-t)/n));("outro"===s||"both"===s)&&o-n<a&&a<=o&&(r=w1.invertedParabola((a-(o-n))/n,!1));return Math.max(Math.min(r,1),0)})({current:i,end:a,fadePosition:t,fadeSpeed:s,start:o})}this.reverseAudio?(sH(this.video,0),sH(this.reverseAudio,r)):sH(this.video,r)})),i(this,"initStaticVideo",(()=>{const{staticVideo:e}=this,{layer:t}=this.props;if(e&&e.videoHeight&&e.videoWidth&&this.setIntermediateCanvasWidth(e.videoWidth,e.videoHeight),!t.duration&&e){const o=parseFloat(e.duration);OI({[t.id]:{duration:o}},"Video.tsx")}})),i(this,"handleAudiogramPlayError",(e=>{const{layer:t}=this.props;t.isAudiogram&&"pastedLink"===t.source&&e&&e.catch((()=>{this.audiogramErrorToastShown||(this.audiogramErrorToastShown=!0,this.props.showToast({description:"Failed to draw waveform using pasted URL. Please wait for asset to download.",type:"warning"}))}))})),i(this,"handleError",(async e=>{var t;const{layer:o,mediaCacheId:a}=this.props,{retries:i}=this.state,{code:s,message:n}=(e.target||{}).error||e;if(e.target&&console.error(`Failed to load video. Error ${s} details: ${n}`),i>=5)return;const r=null==(t=null==o?void 0:o.preview)?void 0:t.asset_id;let l=r||o.asset_id;if(l){this.setState({retries:i+1});let e=null;try{e=await W$(l,"Video_handleError_preview")}catch(IGe){if(l===r&&o.asset_id){l=o.asset_id;try{e=await W$(l,"Video_handleError_original")}catch(d){console.error(`Failed to fetch asset_id ${l} on layer.id ${o.id}`)}}else console.error(`Failed to fetch asset_id ${l} on layer.id ${o.id}`)}if(e){const{blob_name:t,status:i}=e;if(i===On.uploaded&&t){const t=await i2(e);if(this.setState({videoSrc:t}),a&&r$(a),!r)return void OI({[o.id]:{url:t,soundUrl:null,source:"upload"}},"Video.tsx");OI({[o.id]:{preview:{...o.preview,url:t},soundUrl:null,source:"upload"}},"Video.tsx")}}}"pastedLink"===o.source&&(async()=>{this.setState({retries:i+1});const e=await(t=o.pastedUrl,mB({url:t,excludedMimes:["x-mpegurl"]}));var t;OI({[o.id]:{soundUrl:null,url:e.url}},"Video.tsx")})()})),i(this,"initVideo",(()=>{const{video:e}=this,{layer:t,studioPaused:o,studioTime:a,globalPlaybackRate:i}=this.props;if((null==e?void 0:e.getAttribute("data-initVideoLayerId"))===t.id)return;if(null==e||e.setAttribute("data-initVideoLayerId",t.id),e&&e.videoHeight&&e.videoWidth&&(e.width=e.videoWidth,e.height=e.videoHeight,this.setIntermediateCanvasWidth(e.videoWidth,e.videoHeight)),!e)return void console.warn(`Video.tsx initVideo - No video for ${t.id}!`);e.loop=!!t.converted_gif,e.playsInline=!0;const s=i*(t.playbackRate??1);e.playbackRate!==s&&(e.playbackRate=s),o&&e.pause(),t.isTrimmed||(LE(t.id,{removeBgPreviewUrl:null}),OI({[t.id]:{endTime:e.duration,startTime:0}},"Video.tsx")),t.isReversed?(e.pause(),v1(t,e,a,this.reverseAudio)):e.currentTime=t.startTime||0,Object.assign(e.style,this.getSizeStyles())})),i(this,"setIntermediateCanvasWidth",((e,t)=>{let o,a;e>t?(o=Math.min(e,720),a=t*(o/e)):(a=Math.min(t,720),o=e*(a/t)),this.setState({intermediateCanvasWidth:o,intermediateCanvasHeight:a})})),i(this,"getSizeStyles",(()=>{if(this.props.layer.isAudiogram)return{display:"none"};if(this.isAudioOnly())return{display:"none"};const e=this.getVideoWidthAndHeight(),{width:t,height:o}=f1([this.props.width,this.props.height],e);return{width:`${t}px`,height:`${o}px`}})),i(this,"initAnalyser",(()=>{if(null==this.video)return;const e=XG().createAnalyser();e.minDecibels=-120,oH(this.reverseAudio??this.video).gainNode.connect(e),this.analyser=e})),i(this,"initReverseAudio",(async()=>{var e,t,o,a,i;const{mediaCacheId:s,globalPlaybackRate:n}=this.props,{playbackRate:r}=this.props.layer;if(!this.reverseAudio||!s)return;const l=await d$(s);if(!l)return;const{reversedAudioBlob:d}=l;if(d)this.reverseAudio.src=URL.createObjectURL(d);else{const{layer:n}=this.props,r=await(null==(i=(null==(e=l.trackOptimizedPreviewFile_v2)?void 0:e.hasAudio)&&(null==(t=l.trackOptimizedPreviewFile_v2)?void 0:t.file)||(null==(o=l.optimizedPreviewFile_v2)?void 0:o.file)||(null==(a=l.file_v2)?void 0:a.file))?void 0:i.arrayBuffer());if(!r)return;const d=await Y1(XG(),r);window.webWorkerDict||(window.webWorkerDict={}),window.webWorkerDict[n.id]=new t2;const{webWorkerDict:c}=window;let m=null;if(c&&(m=c[n.id]||null),m)try{const{numberOfChannels:e,sampleRate:t,length:o}=d,a={};for(let s=0;s<e;s+=1)a[s]=d.getChannelData(s);const i={mapChannelToChannelData:a,numberOfChannels:e,sampleRate:t,length:o};m.postMessage(i);const n=await new Promise((e=>{m.onmessage=t=>{e(t.data)}})),{wav:r}=n;await s$(s,{reversedAudioBlob:r}),this.reverseAudio.src=URL.createObjectURL(r),m.terminate()}catch(u){return}}this.reverseAudio.playbackRate=n*(r||1);const c=n*(r??1);this.reverseAudio.playbackRate!==c&&(this.reverseAudio.playbackRate=c),this.reverseAudio.crossOrigin="anonymous",this.analyser&&(this.video&&(oH(this.video).gainNode.disconnect(this.analyser),this.analyser.disconnect()),oH(this.reverseAudio).gainNode.connect(this.analyser))})),i(this,"openReverseVideoInterval",(()=>{this.reversedIntervalID||(this.reversedIntervalID=window.setInterval(this.updateReversedVideoTime,100))})),i(this,"closeReverseVideoInterval",(()=>{this.reversedIntervalID&&(clearInterval(this.reversedIntervalID),this.reversedIntervalID=null)})),i(this,"getVideoRef",(()=>this.video)),i(this,"bodyPixRemoveBackground",(async e=>{const t=window.slowTFJS?"low":"medium",o=await window.bodyPixNet.segmentPerson(e,{flipHorizontal:!1,internalResolution:t,segmentationThreshold:.7}),a=e.data;for(let i=0;i<a.length;i+=4)0===o.data[i/4]&&(a[i+3]=0)})),i(this,"drawUrlToCanvas",(e=>{const{layer:t}=this.props;if(!this.canvas)return;const o=this.canvas.getContext("2d");if(!o)return;o.imageSmoothingEnabled=!0;const{width:a,height:i}=this.canvas;o.clearRect(0,0,a,i);const s=new Image;s.onload=()=>{o.drawImage(s,0,0,a,i),t.presetFilter&&this.filterCanvas&&this.drawPresetFilter()},s.src=e})),i(this,"drawToIntermediateCanvas",((e,t,o=!0)=>{if(!t||!e)return!1;const{width:a,height:i}=t;if(a<0||i<0)return!1;const s=t.getContext("2d");if(!s)return!1;if(s.drawImage(e,0,0,a,i),!o)return null;try{return s.getImageData(0,0,a,i)}catch(IGe){return console.error("CANVAS ERROR",IGe),null}})),i(this,"drawIntermediateDataToCanvas",((e,t,o=!0)=>{if(!t||!this.canvas)return;const{layer:a}=this.props,{width:i,height:s}=t,n=t.getContext("2d");if(!n)return;const r=this.canvas.getContext("2d");if(!r)return;r.imageSmoothingEnabled=!0;const{width:l,height:d}=this.canvas;try{n.putImageData(e,0,0),r.clearRect(0,0,l,d),r.drawImage(t,0,0,i,s,0,0,l,d),o&&a.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}catch(IGe){console.error("CANVAS ERROR",IGe)}})),i(this,"drawSelfieSegmentationImage",(async()=>{if(!this.video||0===this.video.videoWidth||0===this.video.videoHeight)return;const{selfieSegmentationLoaded:e}=this.state,{layer:t}=this.props,o=!!t.preview;if(!(R2||!window.slowTFJS&&window.bodyPixNet)||R2&&!e){if(this.canvas){const e=this.canvas.getContext("2d");if(!e)return;const{width:t,height:o}=this.canvas;e.drawImage(this.video,0,0,t,o)}}else{if(R2&&this.video&&e&&this.props.selfieSegmentation&&this.canvas&&this.video.videoWidth>0)try{let e=this.video;!o&&this.smallIntermediateCanvas&&this.smallIntermediateCanvas.width>0&&(this.drawToIntermediateCanvas(this.video,this.smallIntermediateCanvas,!1),e=this.smallIntermediateCanvas),await yH({actionDescription:"Selfie segmentation",timeoutMs:1e3,promise:this.props.selfieSegmentation.send({image:e})})}catch(IGe){console.error(IGe)}if(!R2){const e=this.drawToIntermediateCanvas(this.video,this.smallIntermediateCanvas);e&&(await this.bodyPixRemoveBackground(e),this.canvas&&this.drawIntermediateDataToCanvas(e,this.smallIntermediateCanvas))}}})),i(this,"setRemoveBgPreviewUrl",(async e=>{const{layer:t,layerTempValues:o}=this.props,{removeBgPreviewUrl:a}=o||{};if(!a&&"pastedLink"!==t.source){const o=await new Promise((t=>e.toBlob(t))),a=URL.createObjectURL(o);LE(t.id,{removeBgPreviewUrl:a})}})),i(this,"drawRemoveBgPreview",(async()=>{const{layer:e,layerTempValues:t}=this.props,{removeBgPreviewUrl:o}=t||{};if(o)return void this.drawUrlToCanvas(o);if(this.canvas){const e=this.canvas.getContext("2d"),{width:t,height:o}=this.canvas;null==e||e.drawImage(this.staticVideo,0,0,t,o)}const a=this.drawToIntermediateCanvas(this.staticVideo,this.smallIntermediateCanvas);if(a){if(await this.bodyPixRemoveBackground(a),this.canvas){if(this.drawIntermediateDataToCanvas(a,this.smallIntermediateCanvas,!1),"pastedLink"!==e.source){const t=await new Promise((e=>this.canvas.toBlob(e))),o=URL.createObjectURL(t);LE(e.id,{removeBgPreviewUrl:o})}e.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}}else setTimeout(this.drawRemoveBgPreview,100)})),i(this,"drawChromaKeyImage",(async e=>{if(!e||!this.webGLCanvas)return;const{layer:t,studioPaused:o,layerTempValues:a}=this.props,{chromaKeyThreshold:i,chromaKeyHueThreshold:s,chromaKeySatThreshold:n,chromaKeyValThreshold:r,chromaKeyChannel:l,chromaKeyColor:d,ffprobeData:c}=t,{chromaKeyThresholdTemp:u,chromaKeyHueTldTemp:m,chromaKeySatTldTemp:p,chromaKeyValTldTemp:h}=a||{};if("colorKey"===l&&d===ey){if(this.canvas){const t=this.canvas.getContext("2d");if(!t)return;const{width:o,height:a}=this.canvas;t.drawImage(e,0,0,o,a)}return}let g;if("colorKey"===l&&d){g={R:parseInt(t.chromaKeyColor.slice(1,3),16)/255,G:parseInt(t.chromaKeyColor.slice(3,5),16)/255,B:parseInt(t.chromaKeyColor.slice(5,7),16)/255}}else"green"===l?g={R:0,G:1,B:0}:"blue"===l&&(g={R:0,G:0,B:1});const f={key:g,threshold:u||i,hueThreshold:m||s,satThreshold:p||n,valThreshold:h||r,channel:l},y=this.webGLCanvas.getContext("webgl",{premultipliedAlpha:!1})||this.webGLCanvas.getContext("experimental-webgl",{premultipliedAlpha:!1});if(y){let a=e;const i=!c||!c.rotate;let s=i?0:parseFloat(c.rotate);if(this.fullIntermediateCanvas&&(qg()||o||i)&&(this.drawToIntermediateCanvas(e,this.fullIntermediateCanvas),a=this.fullIntermediateCanvas,s=0),((e,t,o,a)=>{e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),p1(e,t,o,a)})(y,a,f,s),this.canvas){const e=this.canvas.getContext("2d");if(!e)return;e.imageSmoothingEnabled=!0;const{width:o,height:a}=this.canvas;e.clearRect(0,0,o,a),e.drawImage(this.webGLCanvas,0,0,o,a),t.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}}})),i(this,"drawPreviewToCanvas",(async()=>{const{layer:e}=this.props,{removeBg:t,blurBg:o,chromaKey:a}=e;if(this.mounted&&this.canvas&&this.staticVideo)if(t||o)await this.drawRemoveBgPreview();else if(a)await this.drawChromaKeyImage(this.staticVideo);else{const e=this.canvas.getContext("2d");if(!e)return;e.drawImage(this.staticVideo,0,0,this.canvas.width,this.canvas.height)}})),i(this,"drawPausedFrameToCanvas",(async()=>{const{layer:e}=this.props,{removeBg:t,blurBg:o,chromaKey:a}=e;if(this.canvas&&this.video)if(t||o)await this.drawSelfieSegmentationImage();else if(a)await this.drawChromaKeyImage(this.video);else{const t=this.canvas.getContext("2d");if(!t)return;t.drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.couldBeTransparent()&&e.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}})),i(this,"onMediapipeSegmentResults",(e=>{this.mediapipeSegmentResults=e,this.drawMediapipeResults()})),i(this,"drawMediapipeResults",(()=>{if(!this.mediapipeSegmentResults)return;const{canvas:e}=this,t=null==e?void 0:e.getContext("2d");if(!e||!t)return;const{layer:o}=this.props;if(o.blurBg){const o=document.createElement("canvas");o.width=e.width,o.height=e.height;const a=o.getContext("2d");o&&a&&P2?(this.drawBlurredBackgroundToCanvas(t),this.drawPortraitToCanvas(a),t.drawImage(o,0,0)):t.drawImage(this.mediapipeSegmentResults.image,0,0,e.width,e.height)}else this.drawPortraitToCanvas(t);this.setRemoveBgPreviewUrl(e)})),i(this,"drawBlurredBackgroundToCanvas",(e=>{if(!this.mediapipeSegmentResults||!e)return;const{layer:t,layerTempValues:o}=this.props,{blurBgValueTemp:a}=o||{},i=a??t.blurBgValue;if(null==i)return;const s=e.canvas.width,n=e.canvas.height;e.save(),e.clearRect(0,0,s,n);const r=Math.min(s,n);this.currentProcessedBlurValue=i;const l=i*r/100,[d,c]=a2({blurPixels:l,image:this.mediapipeSegmentResults.image,width:s,height:n});e.filter=`blur(${l}px)`,e.drawImage(d,-c,-c,d.width,d.height),e.globalCompositeOperation="destination-out",e.restore()})),i(this,"drawPortraitToCanvas",(e=>{if(!this.mediapipeSegmentResults||!e)return;const t=e.canvas.width,o=e.canvas.height;e.save(),e.clearRect(0,0,t,o),e.drawImage(this.mediapipeSegmentResults.image,0,0,t,o),e.globalCompositeOperation="destination-in",e.drawImage(this.mediapipeSegmentResults.segmentationMask,0,0,t,o),e.restore()})),i(this,"drawVideoToCanvas",(async e=>{const{layer:t,studioPaused:o}=this.props,{removeBg:a,blurBg:i,chromaKey:s}=t;if(!this.mounted)return;const n="number"==typeof e&&"number"==typeof this.previousDrawingTime?e-this.previousDrawingTime:null,r=1e3/24;if(null!==n&&(n>r||"requestVideoFrameCallback"in HTMLVideoElement.prototype)&&(this.previousDrawingTime=e-n%r,this.canvas&&this.video)){const{canvas:e}=this,o=e.getContext("2d");if(!o)return;"video/webm"!==t.mime&&"video/quicktime"!==t.mime||a||i||o.clearRect(0,0,e.width,e.height),a||i?await this.drawSelfieSegmentationImage():s?await this.drawChromaKeyImage(this.video):(o.drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.couldBeTransparent()&&t.presetFilter&&this.filterCanvas&&this.drawPresetFilter()),this.props.isLayerMountedValueInStudioLocal||IH(t.id,!0)}O2(this.props.absoluteTimes,this.props.studioTime)&&!o&&window.requestAnimationFrame(this.drawVideoToCanvas)})),i(this,"startDrawingVideoToCanvas",(()=>{this.previousDrawingTime=performance.now(),this.drawVideoToCanvas(performance.now())})),i(this,"canvasRef",(e=>{this.canvas=e,LE(this.props.layer.id,{layerRef:e})})),i(this,"setVideoAttributes",(e=>{e.dataset.hasSetAttributes||(e.className=`${WQ.video} ${WQ.disableselect}`,e.draggable=!1,"pastedLink"!==this.props.layer.source?e.crossOrigin="anonymous":e.crossOrigin=null,e.onloadstart=e=>{this.didLogVideoAnalytics||(this.onLoadStartTime=e.timeStamp)},e.onloadedmetadata=e=>{this.didLogVideoAnalytics||(this.onLoadedMetadataTime=e.timeStamp)},e.onloadeddata=e=>{this.didLogVideoAnalytics||(this.onLoadedDataTime=e.timeStamp)},e.oncanplay=e=>{void 0===this.props.layer.hasAudio&&this.checkHasAudio(),this.didLogVideoAnalytics||(this.onCanPlayTime=e.timeStamp)},e.oncanplaythrough=t=>{var o,a,i,n,r;if(this.didLogVideoAnalytics)return;if(Math.random()>.002&&!this.logFileExperiment)return;if(this.props.layer.requireConversion||this.props.layer.removeBg||this.props.layer.blurBg||this.props.layer.chromaKey)return;const l={eventVersion:3,onLoadedMetadata:s.round((this.onLoadedMetadataTime-this.onLoadStartTime)/1e3,1),onLoadedData:s.round((this.onLoadedDataTime-this.onLoadStartTime)/1e3,1),onCanPlay:s.round((this.onCanPlayTime-this.onLoadStartTime)/1e3,1),onCanPlayThrough:s.round((t.timeStamp-this.onLoadStartTime)/1e3,1),videoHeight:e.videoHeight,videoWidth:e.videoWidth,duration:e.duration,fileSource:this.logFileSource,fileType:this.logFileType,size:s.round(this.logFileSize/1048576,1),deviceMemory:navigator.deviceMemory,mountToCanPlayThrough:s.round((performance.now()-this.mountTime)/1e3,1),numberOfVideoElementsInDocument:document.getElementsByTagName("video").length,experimentName:null==(o=this.logFileExperiment)?void 0:o.name,experimentTimeToInit:null==(a=this.logFileExperiment)?void 0:a.timeToInit,experimentTimeToTranscode:null==(i=this.logFileExperiment)?void 0:i.timeToTranscode,experimentStatus:null==(n=this.logFileExperiment)?void 0:n.status,error:null==(r=this.logFileExperiment)?void 0:r.error};Fm(ym.VIDEOTAGLOAD,l),this.didLogVideoAnalytics=!0},e.dataset.hasSetAttributes="true")})),i(this,"setAudioContext",(()=>{XG().resume()})),i(this,"videoRef",(e=>{this.video=e,e&&(e.readyState>0?this.initVideo():e.addEventListener("loadedmetadata",this.initVideo,{once:!0}),this.mountVideo(e)),LE(this.props.layer.id,{layerRef:e})})),i(this,"mountVideo",(async e=>{const{layer:t,studioPaused:o}=this.props;if(Object.assign(e.style,this.getSizeStyles()),this.setVideoAttributes(e),this.videoContainer.current&&!this.videoContainer.current.contains(e)){e.parentNode&&e.parentNode.removeChild(e);const a=this.videoContainer.current;for(const e of a.children)"VIDEO"===e.tagName&&a.removeChild(e);a.appendChild(e);try{await yH({actionDescription:"Seeking video",timeoutMs:5e3,promise:v1(t,e,this.props.studioTime)}),this.handleDriftingVideo()}catch(IGe){console.error(IGe)}t.type!==zl.Video||L2(t)||o||e.addEventListener("playing",(function(){IH(t.id,!0)}),{once:!0})}})),i(this,"renderConversion",(()=>{const{isRemoteUploadingLayer:e,viewOnly:t,layer:o}=this.props;return!o.requireConversion||o.preview||"complete"===o.videoConvertedState||t||e?null:w.jsx("div",{className:WQ.videoConversion,children:w.jsx(MU,{textStyles:D2,text:this.getConversionText()})})})),i(this,"renderVideo",(()=>{const{staticPreview:e,layer:t,width:o,height:a,x:i,y:s,background:n,trackIsBeingManipulated:r,tempFilters:l}=this.props,d=this.getVideoWidthAndHeight(),c=cI(this.props.layer,this.props.studioTime,r),u=g1(c,[this.props.width,this.props.height],d,qS(t)),{width:m,height:p}=f1([this.props.width,this.props.height],d),h=o1(u,m,p),g=h1({...t,filters:l||t.filters},!!e,!!this.props.multiScene,h,this.props.width,this.props.height,this.props.keyframeChannels,this.props.studioTime),f="none"===g.display;if(g.display="hidden",e){const e=L2(t);return e&&(g.display="hidden"),w.jsxs(w.Fragment,{children:[e&&this.renderCanvasVideo(),t.isAudiogram&&w.jsx(n2,{width:o,height:a,x:i,y:s,background:n}),w.jsx(s2,{ref:this.videoContainer,layer:t,style:g,children:!e&&w.jsx("video",{id:"staticvideo",className:WQ.video,ref:e=>{this.staticVideo=e},style:this.getSizeStyles(),src:this.getVideoSrc(),draggable:!1,muted:!0,autoPlay:!0,onLoadStart:e=>{e.target.pause()},onPlaying:e=>{e.target.pause()},playsInline:!0,..."pastedLink"!==t.source&&{crossOrigin:"anonymous"}})})]})}return L2(t)||f?g.display="none":g.display="block",this.props.forMovingZoomControls?w.jsx("div",{ref:this.videoContainer,style:g,"data-cy":"filter-layer-style-wrapper"}):w.jsxs(w.Fragment,{children:[L2(t)&&this.renderCanvasVideo(),t.isAudiogram&&w.jsx(d2,{layer:t,width:o,height:a,video:this.getVideoRef(),analyser:this.analyser}),t.isReversed&&w.jsx("audio",{ref:e=>{e&&iH(e),this.reverseAudio=e}}),w.jsx(s2,{ref:this.videoContainer,layer:t,style:g})]})})),this.state={retries:0,videoSrc:k0(e.layer),sourceAtMount:(null==(t=e.layer)?void 0:t.source)||"",selfieSegmentationLoaded:!1},this.videoDriftCounter=_.createRef(),this.videoDriftInterval=window.setInterval((()=>{this.videoDriftCounter.current=(this.videoDriftCounter.current||0)+1}),1e3)}async componentDidMount(){const{layer:e,selfieSegmentation:t,studioPaused:o}=this.props;this.didLogVideoAnalytics=!1,this.mountTime=performance.now(),e.local_url||this.setVideoSrc(!0),this.mounted=!0,t&&this.setupSelfieSegmentation(t),await this.setupVideo(),e.isReversed&&e.hasAudio&&this.initReverseAudio(),L2(e)&&!o&&O2(this.props.absoluteTimes,this.props.studioTime)&&this.startDrawingVideoToCanvas()}componentDidUpdate(e,t){var o,a,i,s,n,r,l;const{absoluteTimes:d,userManualSeek:c,isBeingDragged:u,layer:m,layerTempValues:p,staticPreview:h,studioPaused:g,studioTime:f,updateLayerAnimationPosition:y,globalPlaybackRate:v,isWaitingForNextEPLayer:_,isReferenceLayer:w}=this.props,b=O2(e.absoluteTimes,e.studioTime);let T=!0;if(this.props.forMovingZoomControls){if(!this.video){const e=document.createElement("video");iH(e),e.src=this.props.layer.local_url||(null==(a=null==(o=this.props.layer)?void 0:o.preview)?void 0:a.url)||this.props.layer.url||"",this.videoRef(e)}}else{const t=this.props.canvasElementPool.domElementByLayerId.get(this.props.layer.id)||null,o=this.props.canvasElementPool.layerByLayerId.get(this.props.layer.id);T=!!(O2(d,f)||(null==o?void 0:o.isAtEnd)&&ME(f,d[1],.03333333333333333)),!T||h||this.video&&!this.isVideoRefOutdated(t)||(this.videoRef(t),this.setAudioContext(),m.isAudiogram&&this.initAnalyser()),T&&!h&&t&&this.videoContainer.current&&!this.videoContainer.current.contains(t)&&this.mountVideo(t),!t||m===e.layer&&this.props.width===e.width&&this.props.height===e.height||Object.assign(t.style,this.getSizeStyles()),this.video&&this.setVideoAttributes(this.video),T||_||!this.video||(this.videoRef(null),IH(m.id,!1))}const{videoSrc:x}=this.state,S=e.layer.hasAudio;t.videoSrc===x&&S===m.hasAudio||this.setupVideo(),!e.layer.isAudiogram&&m.isAudiogram&&(this.setAudioContext(),this.initAnalyser()),this.video&&(null==(i=e.layer)?void 0:i.isReversed)!==m.isReversed&&(this.closeReverseVideoInterval(),m.isReversed?(this.video.pause(),this.initReverseAudio(),v1(m,this.video,f,this.reverseAudio)):v1(m,this.video,f)),!e.selfieSegmentation&&this.props.selfieSegmentation&&this.setupSelfieSegmentation(this.props.selfieSegmentation),!this.video||u||e.isBeingDragged||T||!b||(this.video.pause(),this.closeSetStudioTimeInterval(),m.isReversed&&v1(m,this.video,f),this.reverseAudio&&(this.reverseAudio.pause(),this.reverseAudio.currentTime=m.startTime||0)),w&&T?this.openSetStudioTimeInterval():this.closeSetStudioTimeInterval();const E=!this.reversedIntervalID&&!g||!b;if(this.video&&this.reverseAudio&&m.isReversed&&T&&E&&(this.reverseAudio&&this.reverseAudio.paused&&this.reverseAudio.play(),v1(m,this.video,f,this.reverseAudio),g||this.openReverseVideoInterval()),e.studioPaused&&!g&&XG().resume(),"number"==typeof c&&m.isReversed&&!T&&this.closeReverseVideoInterval(),this.video&&!h){const o=v*(m.playbackRate??1);this.video.playbackRate!==o&&(this.video.playbackRate=o),this.reverseAudio&&this.reverseAudio.playbackRate!==o&&(this.reverseAudio.playbackRate=o),this.setVolume();const[a,i]=d;if(a<=f&&f<=i||u){if("number"==typeof c?(this.videoDriftCounter.current=0,v1(m,this.video,bE(),this.reverseAudio).then((()=>{L2(m)?g?this.drawPausedFrameToCanvas().then((()=>{IH(m.id,!0)})):m.isReversed&&(this.openReverseVideoInterval(),this.reverseAudio&&this.reverseAudio.paused&&this.reverseAudio.play()):IH(m.id,!0)}))):f<e.studioTime-.5?(this.videoDriftCounter.current=0,v1(m,this.video,f,this.reverseAudio)):this.videoDriftCounter.current&&this.videoDriftCounter.current>5&&this.handleDriftingVideo(),L2(m)&&!g&&(e.studioPaused||!b&&T)&&this.startDrawingVideoToCanvas(),!m.isReversed&&!g&&(null==(s=this.video)?void 0:s.paused)){const e=ME(m.startTime||0,0,.1)&&ME(f,a,.1);if(this.video.currentTime===this.video.duration&&!e)return;const t=null==(n=this.video)?void 0:n.play().catch(BH);this.handleAudiogramPlayError(t)}m.isReversed&&g!==e.studioPaused&&!g&&(this.openReverseVideoInterval(),this.reverseAudio&&this.reverseAudio.paused&&this.reverseAudio.play()),!g||(null==(r=this.video)?void 0:r.paused)&&!m.isReversed||(m.isReversed?(this.closeReverseVideoInterval(),this.reverseAudio&&!this.reverseAudio.paused&&this.reverseAudio.pause()):null==(l=this.video)||l.pause()),g&&this.shouldDrawPausedFrameToCanvas(e,t)&&this.drawPausedFrameToCanvas()}else"number"==typeof c?v1(m,this.video,a,this.reverseAudio):this.video.paused||this.video.pause()}this.staticVideo&&(this.staticVideo.onloadedmetadata=this.initStaticVideo,this.shouldDrawPreviewToCanvas(e)&&this.drawPreviewToCanvas()),this.mounted&&this.setVideoSrc();const I=Fx(m),{introTransition:C,outroTransition:k}=Bx(m);if(h||"none"===(null==I?void 0:I.id)&&!C&&!k)y&&y(null);else if(I.layerInvolvesMovement){const e=UQ(m,"");y&&y(e)}const{blurBgValueTemp:A}=p||{},j=A??m.blurBgValue;this.mediapipeSegmentResults&&j!==this.currentProcessedBlurValue&&this.drawMediapipeResults()}async componentWillUnmount(){if(this.mounted=!1,this.closeReverseVideoInterval(),this.video=null,clearInterval(this.videoDriftInterval),this.loopSetStudioTimeID&&clearTimeout(this.loopSetStudioTimeID),this.analyser){this.analyser.disconnect();const e=this.reverseAudio??this.video;e&&oH(e).gainNode.disconnect(this.analyser)}}getVideoWidthAndHeight(){let e=[0,0];return this.video?e=[this.video.videoWidth,this.video.videoHeight]:this.staticVideo&&(e=[this.staticVideo.videoWidth,this.staticVideo.videoHeight]),e}isVideoRefOutdated(e){var t;return(null==e?void 0:e.id)!==(null==(t=this.video)?void 0:t.id)}getVideoSrc(e=!1){const{videoSrc:t}=this.state,o=t;return o&&o.startsWith("blob:")&&e?"blob":o||""}getConversionText(){const{uploadStatus:e}=this.props;return e?nY(e):null}isAudioOnly(){const{layer:e}=this.props;return"audio"===e.type&&!e.isAudiogram}drawPresetFilter(){if(!this.canvas)return;const{layer:e}=this.props;if(!e.presetFilter||!this.filterCanvas)return;if("Original"===e.presetFilter.name)return;const t=this.canvas.getContext("2d");if(!t)return;const{width:o,height:a}=this.canvas,i=this.filterCanvas.getContext("2d");i&&(i.save(),i.clearRect(0,0,o,a),D0(e.presetFilter,i,this.canvas,this.canvas.width,this.canvas.height),i.restore(),t.save(),t.globalCompositeOperation="source-in",t.drawImage(this.filterCanvas,0,0,o,a),t.restore())}shouldDrawPreviewToCanvas(e){const{layer:t}=this.props;return t.chromaKey&&!e.layer.chromaKey||t.chromaKeyChannel!==e.layer.chromaKeyChannel||t.chromaKeyThreshold!==e.layer.chromaKeyThreshold||t.chromaKeyColor!==e.layer.chromaKeyColor||t.chromaKeyHueThreshold!==e.layer.chromaKeyHueThreshold||t.chromaKeySatThreshold!==e.layer.chromaKeySatThreshold||t.chromaKeyValThreshold!==e.layer.chromaKeyValThreshold||t.presetFilter!==e.layer.presetFilter}shouldDrawPausedFrameToCanvas(e,t){const{layer:o,layerTempValues:a}=this.props,{selfieSegmentationLoaded:i}=this.state,s=e.layerTempValues||{},{chromaKeyThresholdTemp:n,chromaKeyHueTldTemp:r,chromaKeySatTldTemp:l,chromaKeyValTldTemp:d}=a||{};return o.chromaKey!==e.layer.chromaKey||o.removeBg!==e.layer.removeBg||o.blurBg!==e.layer.blurBg||o.animation!==e.layer.animation||i!==t.selfieSegmentationLoaded||n!==s.chromaKeyThresholdTemp||r!==s.chromaKeyHueTldTemp||l!==s.chromaKeySatTldTemp||d!==s.chromaKeyValTldTemp||this.shouldDrawPreviewToCanvas(e)}couldBeTransparent(){const{layer:e}=this.props;return e.chromaKey||e.removeBg||e.blurBg||"video/webm"===e.mime}handleDriftingVideo(){const{absoluteTimes:e,layer:t,isReferenceLayer:o,setsTime:a}=this.props,i=e[0];if(this.video){const e=this.video.currentTime-(t.startTime||0),s=this.props.studioTime-i;if((()=>{var t;if(null==(t=this.video)?void 0:t.paused)return!1;const o=1/30;return!(e>=s-o&&e<=s+o)})()&&o&&!a){const t=s+(e-s)/2+i;this.props.setEPTime(t)}this.videoDriftCounter.current=0}}renderCanvasVideo(){if(!this.video&&!this.staticVideo||this.isAudioOnly())return null;const{layer:e,trackIsBeingManipulated:t}=this.props,{videoWidth:o,videoHeight:a}=this.staticVideo||this.video||{},{intermediateCanvasWidth:i,intermediateCanvasHeight:s}=this.state,n=this.getVideoWidthAndHeight(),r=cI(this.props.layer,this.props.studioTime,t),l=g1(r,[this.props.width,this.props.height],n,qS(e)),{width:d,height:c}=f1([this.props.width,this.props.height],n),u=o1(l,d,c),m=h1({...this.props.layer,filters:this.props.tempFilters||this.props.layer.filters},!!this.props.staticPreview,!!this.props.multiScene,u,this.props.width,this.props.height,this.props.keyframeChannels,this.props.studioTime);return w.jsxs(w.Fragment,{children:[w.jsx("div",{style:{display:"none"},children:w.jsx("canvas",{ref:e=>{this.smallIntermediateCanvas=e},width:i,height:s})}),w.jsx("div",{style:{display:"none"},children:w.jsx("canvas",{ref:e=>{this.fullIntermediateCanvas=e},width:o,height:a})}),w.jsx("div",{style:{display:"none"},children:w.jsx("canvas",{ref:e=>{this.filterCanvas=e},width:o,height:a})}),w.jsx("div",{style:{display:"none"},children:w.jsx("canvas",{ref:e=>{this.webGLCanvas=e},width:o,height:a})}),this.couldBeTransparent()||!e.presetFilter?w.jsx("canvas",{"data-cy":"ep-container",ref:this.canvasRef,style:m,width:o,height:a}):w.jsx(s2,{layer:e,style:m,children:w.jsx("canvas",{"data-cy":"ep-container",ref:this.canvasRef,width:o,height:a})})]})}render(){const{layer:{requireConversion:e,preview:t}}=this.props;return w.jsxs("span",{children:[this.renderConversion(),e&&!t?null:this.renderVideo()]})}},i(o,"initializingSelfieSegmentation",!1),o);const M2=g.connect((()=>{const e=Z0(),t=kt(TS),o=kt(q0,s.isEqual);return(a,i)=>{var s,n,r,l,d;const c=o({selectElementPoolLayers:i.selectElementPoolLayers,selectPossibleReferenceLayers:i.selectPossibleReferenceLayers}),u=i.elementPool.id,m=OQ(i.layer.id),p=Tu(i.layer,a.mediaCache),h=i.layer.uploadId&&a.uploadStatuses&&!(i.layer.uploadId in a.uploadStatuses),g=t(i.layer),[f,y]=g;let v=!1;X0(y,i.studioTime,XN(a))&&(v=e(a,y));const _=m(a),w=Y0(a),b=PH(g,i.studioTime,w);return{absoluteTimes:g,background:a.studio.scenes[0].background,userManualSeek:null==(s=a.elementPool.byElementPoolId[oS.studio])?void 0:s.userManualSeekTime,isBeingDragged:!!(null==(n=a.studioLocal.draggedTracksOverrides)?void 0:n[i.layer.id]),globalPlaybackRate:a.studioLocal.playbackRate??1,isRemoteUploadingLayer:h,layerTempValues:a.studioLocal.layerTempValues[i.layer.id],mediaCacheId:p,studioPaused:!!(null==(r=a.elementPool.byElementPoolId[u])?void 0:r.paused),trackIsBeingManipulated:Bg(a,i.layer.id),uploadStatus:i.layer.uploadId?null==(l=a.uploadStatuses)?void 0:l[i.layer.uploadId]:null,isWaitingForNextEPLayer:v,isLayerMountedValueInStudioLocal:a.studioLocal.isLayerMountedByLayerId[i.layer.id],keyframeChannels:_,tempFilters:null==(d=a.studioLocal.layerTempValues[i.layer.id])?void 0:d.filters,setsTime:c(a,i.studioTime),isReferenceLayer:b}}}),(e=>ye({playStudio:sS,showToast:wl},e))),U2=function(e){return t=>w.jsx(uE.Consumer,{children:({elementPool:o,getEPTime:a,setEPTime:i,selectElementPoolLayers:s,selectPossibleReferenceLayers:n})=>w.jsx(e,{...t,elementPool:o,getEPTime:a,setEPTime:i,selectElementPoolLayers:s,selectPossibleReferenceLayers:n})})}((B2=wE(je(M2(F2))),e=>w.jsx(j2.Consumer,{children:t=>w.jsx(B2,{...e,canvasElementPool:t})})));var B2;class V2 extends h.Component{constructor(){super(...arguments),i(this,"getRectStyles",(()=>{const{layer:e,width:t,height:o,canvasHeight:a,keyframeChannels:i,studioTime:s,globalAlphaTemp:n}=this.props,{lineWidth:r}=e,l=parseFloat(r)/100*a,d=dx(e,i,s),c=n??((null==i?void 0:i[vd.OPACITY])?cx(e,i,s).opacity/100:e.globalAlpha);return{width:t,height:o,x:l/2,y:l/2,fill:d,stroke:e.stroke,strokeWidth:l,opacity:c}}))}render(){const{layer:e,borderRadiusTemp:t,width:o,height:a}=this.props,i=Oz(t??null,e,o,a);return w.jsx("rect",{style:this.getRectStyles(),rx:i})}}const W2=g.connect(((e,t)=>{var o;return{keyframeChannels:OQ(t.layer.id)(e),globalAlphaTemp:null==(o=e.studioLocal.layerTempValues[t.layer.id])?void 0:o.globalAlphaTemp}}))(wE(V2));class G2 extends h.Component{constructor(){super(...arguments),i(this,"getEllipseStyles",(()=>{const{layer:e,width:t,height:o,canvasHeight:a,studioTime:i,keyframeChannels:s,globalAlphaTemp:n}=this.props,{lineWidth:r}=e,l=parseFloat(r)/100*a,d=dx(e,s,i),c=n??((null==s?void 0:s[vd.OPACITY])?cx(e,s,i).opacity/100:e.globalAlpha);return{cx:l/2+t/2,cy:l/2+o/2,rx:t/2,ry:o/2,fill:d,stroke:e.stroke,strokeWidth:l,opacity:c}}))}render(){return w.jsx("ellipse",{style:this.getEllipseStyles()})}}const H2=g.connect(((e,t)=>{var o;return{keyframeChannels:OQ(t.layer.id)(e),globalAlphaTemp:null==(o=e.studioLocal.layerTempValues[t.layer.id])?void 0:o.globalAlphaTemp}}))(wE(G2));class $2 extends h.Component{constructor(){super(...arguments),i(this,"getLineStyles",(()=>{const{layer:e,canvasHeight:t,keyframeChannels:o,studioTime:a,globalAlphaTemp:i}=this.props,{lineWidth:s}=e,n=parseFloat(s)/100*t,r=i??((null==o?void 0:o[vd.OPACITY])?cx(e,o,a).opacity/100:e.globalAlpha);return{stroke:e.stroke,strokeWidth:n,opacity:r,strokeLinecap:e.lineCap}})),i(this,"getLineMarkerEnd",(e=>{switch(e){case"open":return{path:"M0,0 L3,1.5 L0,3",fill:!1};case"closed":return{path:"M0,0 V3 L3,1.5 Z",fill:!0};default:return{path:"",fill:!1}}})),i(this,"getLineDashArray",((e,t)=>{switch(e){case"big dash":return[4*t,2*t];case"small dash":return[2*t];case"dotted":return[0,t+t/2];default:return[]}})),i(this,"handleSelectLayer",(()=>{const{selectedItem:e,layer:t,selectItem:o}=this.props;(null==e?void 0:e.id)!==t.id&&o({id:t.id,type:"layer"})}))}render(){const{width:e,height:t,layer:o,points:a,lineResizing:i,canvasHeight:s}=this.props,{id:n,stroke:r,lineCap:l,lineWidth:d,lineStyle:c,lineArrow:u,linePointStartCorner:m}=o,p=`markerEnd${n}`,h=u?`url(#${p})`:"",g=parseFloat(d)/100*s,f=this.getLineMarkerEnd(u),y=this.getLineDashArray(c,g),v={topLeft:[g,g,e,t],topRight:[e,g,g,t],bottomLeft:[g,t,e,g],bottomRight:[e,t,g,g]},[_,b,T,x]=v[m||"topLeft"];return w.jsxs(w.Fragment,{children:[f.path&&w.jsx("defs",{children:w.jsx("marker",{id:p,orient:"auto",markerWidth:"4",markerHeight:"8",refX:"3",refY:"1.5",style:{overflow:"visible"},children:w.jsx("path",{d:f.path,stroke:r,strokeWidth:1,fill:f.fill?r:"none",strokeLinejoin:l,strokeLinecap:l,strokeDasharray:10})})}),w.jsx("line",{x1:i?a[0]+g:_,y1:i?a[1]+g:b,x2:i?a[2]+g:T,y2:i?a[3]+g:x,style:this.getLineStyles(),strokeDasharray:y||"",markerEnd:h,className:WQ.svgLine,onClick:this.handleSelectLayer})]})}}const K2=g.connect(((e,t)=>{var o;const a=OQ(t.layer.id);return{selectedItem:e.studio.selectedItem,keyframeChannels:a(e),globalAlphaTemp:null==(o=e.studioLocal.layerTempValues[t.layer.id])?void 0:o.globalAlphaTemp}}),(e=>ye({selectItem:l_},e)))(wE($2)),z2=e=>{const t=h.useMemo((()=>OQ(e)),[e]);return tl(t,g.shallowEqual)},Y2=(e,t,o)=>(null==e?void 0:e.type)&&"path"===e.type?w.jsx("path",{d:e.props.d,style:t,transform:o},e.props.d):"circle"===(null==e?void 0:e.type)?w.jsx("circle",{cx:e.props.cx,cy:e.props.cy,r:e.props.r,pathLength:e.props.pathLength,style:t,transform:o}):null,J2=_.memo((({layer:e,canvasHeight:t,position:{width:o,height:a}})=>{tl((e=>e.studio.containerWidth)),tl((e=>e.studio.containerHeight));const i=tl((t=>{var o;return null==(o=t.studioLocal.layerTempValues[e.id])?void 0:o.globalAlphaTemp})),s=z2(e.id),n=_E(),r=()=>{var a;const{lineWidth:r}=e,l=parseFloat(r)/100*t,d=parseFloat(o)/((null==(a=null==e?void 0:e.position)?void 0:a.svg_width)||1),c=dx(e,s,n),u=i??((null==s?void 0:s[vd.OPACITY])?cx(e,s,n).opacity/100:e.globalAlpha);return{fill:c,stroke:e.stroke,strokeWidth:l/d,opacity:u}},l=()=>{var i,s;const{lineWidth:n}=e,r=parseFloat(n)/100*t,l=parseFloat(o)/((null==(i=null==e?void 0:e.position)?void 0:i.svg_width)||1),d=parseFloat(a)/((null==(s=null==e?void 0:e.position)?void 0:s.svg_height)||1),c=r/l/2,u=r/d/2;return`scale(${l},${d})${"line"!==e.shapeType?`,translate(${c},${u})`:""}`};return"string"==typeof e.svgData?w.jsx("path",{style:r(),d:e.svgData,transform:l()}):w.jsx(w.Fragment,{children:e.svgChildren&&e.svgChildren.map((e=>Y2(e,r(),l())))})}));function q2(e){const{background:t}=e;if(!t)return null;const o=ay(t);if(!o)return null;const{r:a,g:i,b:s}=o;return{background:t,gradientStyleColor:`rgba(${a}, ${i}, ${s}, 0.2)`,glowingStyleColor:`rgba(${a}, ${i}, ${s}, 0.9)`,backgroundStyleColor:`rgba(${a}, ${i}, ${s}, 0.2)`}}function X2(e,t,o=!1){const{progressBarStyle:a}=e,i=q2(e);if(!i)return;const{background:s,gradientStyleColor:n}=i;if(!a||"solid"===a||"glowing"===a)return s;if("gradient"===a)return`linear-gradient(to right, ${n}, ${i.background})`;if(o)return s;const r=100*t+"%";return`linear-gradient(to right, ${`${s} 0% ${r}`}, ${`${i.backgroundStyleColor} ${r} 100%`})`}function Q2(e,t,o=!1){const a=q2(e);return{containerDivStyles:a&&"glowing"===e.progressBarStyle?{filter:`drop-shadow(0px 0px 12px ${a.glowingStyleColor})`}:null,progressBarStyles:{background:X2(e,t,o)}}}class Z2 extends h.Component{constructor(){super(...arguments),i(this,"pctComplete",(()=>{const{layer:e,layerScene:t,studioTime:o}=this.props;let a=o;e.startTime&&(a-=e.startTime);let i=0;void 0!==e.startTime&&void 0!==e.endTime?i=e.endTime-e.startTime:t.duration&&(i=t.duration);return a/i})),i(this,"getProgressBarStyles",(()=>{const{layer:e,width:t,height:o,canvasHeight:a,staticPreview:i}=this.props,{progressBarStyle:s,lineWidth:n}=e;let r;i||"background"===s||(r=UQ(e));const l=parseFloat(n)/100*a,{progressBarStyles:d}=Q2(e,this.pctComplete(),this.props.staticPreview);return{width:t,height:o+l,...r,borderColor:e.stroke,borderStyle:"solid",borderWidth:l,opacity:e.globalAlpha,...d}})),i(this,"ProgressBar",(()=>w.jsx("div",{style:this.getProgressBarStyles()})))}componentDidMount(){const{layer:e,layerScene:t}=this.props;void 0!==(null==e?void 0:e.startTime)&&void 0!==(null==e?void 0:e.endTime)||OI({[e.id]:{startTime:0,endTime:t.duration}},"ProgressBar.tsx")}render(){const{layer:e}=this.props,{containerDivStyles:t}=Q2(e,this.pctComplete(),this.props.staticPreview);return t?w.jsx("div",{style:t,children:this.ProgressBar()}):this.ProgressBar()}}const e3=wE(g.connect((e=>{const{scenes:t}=e.studio;return{layerScene:t[0]}}))(Z2)),t3=s.memoize(TS);let o3=class extends h.Component{constructor(){super(...arguments),i(this,"getStyles",(()=>{const{layer:e,staticPreview:t}=this.props,[o,a]=this.props.absoluteTimes,{studioTime:i}=this.props,s=!t&&!(o<=i&&i<=a),n={...this.getDivSize(),display:s?"none":"block"},r=Fx(e);let l={};return t||"progress-bar"===(null==r?void 0:r.id)||(l=UQ(e,n.transform)),VQ(n,l)})),i(this,"getDivSize",(()=>{const{layer:e,x:t,y:o,width:a,height:i,rotation:s,canvasHeight:n}=this.props,{lineWidth:r}=e,l=parseFloat(r)/100*n/2;return{position:"absolute",left:t-l,top:o-l,width:a+2*l,height:i+2*l,transform:`rotate(${s}deg)`}})),i(this,"renderShapes",(()=>{const{layer:e}=this.props;return"progressBar"===e.shapeType?w.jsx("div",{className:WQ.svgContainer,children:this.renderShape()}):w.jsx("svg",{className:WQ.svgContainer,height:"100%",width:"100%","data-cy":"shape",children:this.renderShape()})})),i(this,"renderShape",(()=>{const{layer:e,x:t,y:o,width:a,height:i,points:s,lineResizing:n,canvasHeight:r,staticPreview:l,borderRadiusTemp:d}=this.props,c={x:t,y:o,width:a,height:i};switch(e.shapeType){case"progressBar":return w.jsx(e3,{staticPreview:l,layer:e,width:a,height:i,canvasHeight:r});case"rectangle":return w.jsx(W2,{layer:e,width:a,height:i,canvasHeight:r,borderRadiusTemp:d});case"ellipse":return w.jsx(H2,{layer:e,width:a,height:i,canvasHeight:r});case"line":case"arrow":return w.jsx(K2,{layer:e,width:a,height:i,points:s,lineResizing:n,canvasHeight:r});case"svg":return w.jsx(J2,{layer:e,position:c,canvasHeight:r});default:return null}}))}componentDidUpdate(){const{layer:e,staticPreview:t,updateLayerAnimationPosition:o}=this.props,[a,i]=this.props.absoluteTimes,{studioTime:s}=this.props,n=!t&&!(a<=s&&s<=i),r={...this.getDivSize(),display:n?"none":"block"},l=Fx(e);if(!t&&"progress-bar"!==(null==l?void 0:l.id)){const t=UQ(e,r.transform);l.layerInvolvesMovement&&o(t)}}render(){const e=this.getStyles();return w.jsx("div",{style:e,className:WQ.disableselect,children:this.renderShapes()})}};const a3=je(g.connect((()=>(e,t)=>{var o;return{absoluteTimes:t3(t.layer),borderRadiusTemp:null==(o=e.studioLocal.layerTempValues[t.layer.id])?void 0:o.borderRadiusTemp}}))(o3)),i3="Placeholder-module_placeholder_laym8",s3="Placeholder-module_placeholderImage_HtXg2",n3="Placeholder-module_placeholderPreview_ogQth",r3=s.memoize(TS),l3=_.memo(wE((e=>{const{previewUrl:t,layer:o}=e,[a,i]=r3(o);return w.jsx("div",{className:i3,style:(()=>{const{layer:t,x:o,y:s,width:n,height:r,staticPreview:l,rotation:d,studioTime:c}=e,u=!l&&!(a<=c&&c<=i);return{position:"absolute",left:o,top:s,width:n,height:r,background:t.background,display:u?"none":"flex",transform:`rotate(${d}deg)`}})(),children:t?w.jsx("img",{src:t,alt:"placeholder preview",className:n3}):w.jsx("img",{src:"/assets/placeholder-29822612.svg",className:s3,alt:"placeholder icon"})})}))),d3=e=>{const{dispatch:t}=sr();e.preventDefault(),t({type:"HIDE_CONTEXT_MENU"})},c3=(e,t,o)=>{const{state:a,dispatch:i}=sr();if(!t)return;if(!a.userPermissions.canWrite)return;let s,n;if(e.preventDefault(),e.stopPropagation(),"clientX"in e)s=e.clientX,n=e.clientY;else{const t=e.touches[0];if(!t)return;s=t.clientX,n=t.clientY}const r={type:t,properties:o,clientX:s,clientY:n};var l,d;a.contextMenu?(l=a.contextMenu,d=r,Math.abs((null==l?void 0:l.clientX)-(null==d?void 0:d.clientX))<2&&Math.abs((null==l?void 0:l.clientY)-(null==d?void 0:d.clientY))<2&&d3(e)):(i({type:"ADD_CONTEXT_MENU_ANALYTICS"}),i(function(e){return{type:"SHOW_CONTEXT_MENU",contextMenu:e}}(r)))},u3=(e,t)=>c3(e,kv.track,{layerId:t}),m3=(e,t)=>c3(e,kv.layer,{layerId:t}),p3=e=>c3(e,kv.gap),h3=e=>c3(e,kv.trackpad),g3=e=>c3(e,kv.background),f3=e=>c3(e,kv.row);let y3=null;const v3=e=>{const{dispatch:t}=sr();e.preventDefault(),e.stopPropagation(),y3===e.target&&(y3=null,t(__(!1)))},_3=e=>{const{dispatch:t}=sr();e.preventDefault(),e.stopPropagation(),y3=null,t(__(!1))},w3=e=>{const{dispatch:t}=sr();if(!ju(e))return y3=null,void t(__(!1));e.preventDefault(),e.stopPropagation(),y3=e.target,t(__(!0))},b3="ContextMenu-module_wrapper_PG8XD",T3=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2);let x3;const S3=()=>{},E3=_.memo((({children:e,onContextMenu:t=S3})=>{const o=(e=>{const[t]=h.useState((()=>Math.random().toString(36).substring(2))),o=cE(e),a=h.useRef(null),i=h.useRef(),s=h.useRef(),n=h.useCallback((e=>{if(x3)return;x3=t;const n=e.touches[0];n&&(i.current={x:n.clientX,y:n.clientY},s.current=i.current,a.current=setTimeout((()=>{null!=i.current&&null!=s.current&&T3(i.current,s.current)<15&&o(e)}),600))}),[t,o]),r=h.useCallback((e=>{const t=e.touches[0];t&&(s.current={x:t.clientX,y:t.clientY})}),[]),l=h.useCallback((()=>{x3=void 0,a.current&&clearTimeout(a.current)}),[]);return Yg()?{onTouchStart:n,onTouchMove:r,onTouchEnd:l}:{onContextMenu:o}})(t);return Object.is(t,S3)?w.jsx(w.Fragment,{children:e}):w.jsx("div",{className:b3,...o,"data-testid":"context-menu",children:e})})),I3=(e,t="Content",o="middle")=>{if(!e)return t;if(e.length<30)return e;let a=10,i=e.length-10;switch(o){case"beginning":a=0,i=e.length-20;break;case"end":a=20,i=e.length}return`${e.substring(0,a)}...${e.substring(i,e.length)}`},C3=(e,t,o)=>{const{start:a,end:i}=cm(e,o),s=BS(t,a),n=BS(t,i);return{left:s,width:Math.max(n-s,.01)}},k3=new WeakMap;const A3=m(_z,(e=>zN(e)),(e=>sf(e)),HA,(e=>{var t;return!!(null==(t=e.comments.comments)?void 0:t.length)}),((e,t,o,a,i)=>{const s=function({layers:e,pxInSecond:t,sceneDuration:o,hasMagicSubtitles:a,hasComments:i}){const s=[],n={},r={};for(const l of e){const d=l.timelineRow??0;let c=!0;const u=n[d];void 0!==u?c=u:(c=dk(d,e),n[d]=c);const m=ck(c);let p=0;const h=r[d];void 0!==h?p=h:(p=ik(sk(d,e,a),i),r[d]=p);const g={...l,timelineRow:d,timelinePosition:{...C3(l,t,o),height:m,top:p},isTall:c},f=k3.get(l);f&&f.isTall===g.isTall&&ol(g.timelinePosition,f.timelinePosition)?s.push(f):(k3.set(l,g),s.push(g))}return s.sort(((e,t)=>e.timelinePosition.left-t.timelinePosition.left)),s}({layers:e,pxInSecond:o||0,sceneDuration:t,hasMagicSubtitles:a,hasComments:i});return s})),j3=m(A3,(e=>{var t;return null==(t=e.studioLocal.mouseState)?void 0:t.id}),(e=>e.studio.selectedItem),(e=>e.studio.groups),((e,t,o,a)=>e.filter((e=>{if(e.id===t)return!0;if(!o)return!1;if("layer"===o.type)return e.id===o.id;if("group"===o.type){const t=a[o.id];return SJ(e.id,{currentGroup:t})}return!1})))),N3=()=>m(A3,((e,t)=>t),((e,t)=>e.find((e=>e.id===t)))),R3=["audio"],P3=m((e=>e.studio.scenes),(e=>e.studio.allLayers.byId),(e=>e.studio.groups),((e,t)=>t),((e,t,o,a)=>{const i=Object.entries(o),s=[],n=[],r=e[0];if(!r)return[];const l=r.layers.filter((e=>{const[t,o]=TS(e);return t<=a&&a<=o&&!e.locked&&!R3.includes(e.type)}));return i.length>0&&l.forEach((e=>{const o=i.find((([t,o])=>o.layers.find((t=>t.id===e.id))));if(o){o[1].layers.forEach((e=>{n.push(e.id)}));const e=o[0];if(!!!s.find((({id:t})=>t===e))){const a=o[1].layers.map((e=>t[e.id])).filter(Ir),{rotation:i,origin:n}=o[1],{tl:r,tr:l,br:d,bl:c}=qI({position:Sj(a,i,n),shapeType:"group",positionType:"pixel"}),u=[r,l,d,c];s.push({id:e,points:u,item:{type:"group"}})}}})),l.forEach((e=>{if(!n.includes(e.id)&&e.position){const{tl:t,tr:o,br:a,bl:i}=qI({position:e.position,shapeType:e.shapeType,positionType:"percent"}),n=[t,o,a,i],{id:r}=e;s.push({id:r,points:n,item:{type:"layer"}})}})),s})),D3=m(A3,(e=>e.map((e=>{const{id:t}=e,{top:o,left:a,width:i,height:s}=e.timelinePosition;return{id:t,points:[{x:a,y:o},{x:a+i,y:o},{x:a+i,y:o+s},{x:a,y:o+s}],item:{type:"layer"}}})))),O3=m(uj,(e=>e.map((e=>{const{id:t}=e,{top:o,left:a,width:i,height:s}=e.timelinePosition;return{id:t,points:[{x:a,y:o},{x:a+i,y:o},{x:a+i,y:o+s},{x:a,y:o+s}],item:{type:"magicSubtitle",frames:e.containedFrames}}})))),L3=()=>{const{dispatch:e,state:{studio:{analytics:t}}}=sr();t.usedTimeline||e(Tp({usedTimeline:!0}))},{Video:F3,Audio:M3,Text:U3,Image:B3,Shape:V3,Placeholder:W3}=zl,{Drag:G3,TrimStart:H3,TrimEnd:$3}=LS,K3=(e,t)=>e.startTime===t.startTime&&e.duration===t.duration&&e.timelineRow===t.timelineRow,z3=(e,t)=>e.newTimelineRow-t.newTimelineRow?e.newTimelineRow-t.newTimelineRow:e.position.left-t.position.left,Y3=e=>{let t=1/0,o=0,a=1/0;return e.forEach((e=>{const i=e[0];if(!i)return;const s=i.timelinePosition;t=Math.min(t,s.left);const n=e[e.length-1].timelinePosition;o=Math.max(o,n.left+n.width),a=Math.min(a,i.timelineRow)})),{minLeft:t,maxRight:o,smallestTimelineRow:a}},J3=(e,t)=>{let o=e[e.length-1];for(let a=0;a<e.length;a+=1){const{start:i,end:s}=e[a];if(t<s){if(0===a||t>=i)o=e[a];else{const{end:s}=e[a-1];o=t-s<i-t?e[a-1]:e[a]}break}}return o},q3=(e,t)=>e.start-1<=t.start&&t.start<=e.end+1||t.start-1<=e.start&&e.start<=t.end+1,X3=(e,t)=>{const{state:o}=sr(),a=o.studio.scenes[0].duration,i=VS(e,t);return i.sort(((e,t)=>{const{start:o}=cm(e,a),{start:i}=cm(t,a);return o<i?-1:o>i?1:0})),i},Q3=()=>{g.batch(ff.withUndoBatch((()=>{const{dispatch:e,state:t}=sr(),{studio:o}=t,a=XN(t),{selectedItem:i,groups:s}=o,{duration:n}=o.scenes[0],r=bE();if(!i)return;let l=[];if("group"===i.type){const e=s[i.id];e&&(l=e.layers.map((({id:e})=>e)))}else"layer"===i.type&&(l=[i.id]);const d=_z(t),c=l.map((e=>d.find((({id:t})=>t===e)))).sort(((e,t)=>{const{start:o}=cm(e,n),{start:a}=cm(t,n);return a-o})),u=c.reduce(((e,t)=>{var o;return t&&void 0!==(null==t?void 0:t.timelineRow)?(e[t.timelineRow]||(e[t.timelineRow]=[]),null==(o=e[t.timelineRow])||o.push(t),e):e}),{});if(Object.values(u).forEach((e=>{const t={};e.forEach((e=>{if(e&&void 0!==e.timelineRow){const{start:o,end:a}=cm(e,n),i=a-o,s=o5(o,1/0,e.timelineRow,-i,t);Object.assign(t,s)}})),OI(t,"rippleDeleteSelectedLayer",!0),Az({layerIds:e.map((({id:e})=>e)),undoable:!0,logEvent:!0}),UR(),Object.keys(t).length>0&&L3()})),a&&c.find((e=>e))){const e=c.find((e=>e)),{start:t}=cm(e);r>t&&aR(t)}e(Tp({usedRippleDelete:!0}))})))},Z3=e=>{const{state:t}=sr(),{studio:o}=t,{duration:a}=o.scenes[0],i=_z(t);if(!e||void 0===e.timelineRow)return 1/0;const{end:s}=cm(e,a),n=X3(i,e);for(const r of n){const{start:e}=cm(r,a);if(e+1e-4>=s)return e}return 1/0},e5=ff.withUndoBatch((()=>{const{dispatch:e,state:t}=sr(),{studio:o}=t,{selectedItem:a,timelineGap:i}=o,s=XN(t);if(!i||i.gapId!==(null==a?void 0:a.id))return;const n=o5(i.startTime,1/0,i.timelineRow,-i.duration);OI(n,"rippleDeleteSelectedGap",!0),e(l_(null)),s&&aR(i.startTime)})),t5=ff.withUndoBatch((function(e,t){const o=s.cloneDeep(e);o.sort(((e,t)=>cm(e,0).start-cm(t,0).start));const a=new Set(t.keys());let i=0;const n={};o.forEach((e=>{const{start:o,end:s}=cm(e),r=t.get(e.id),l=(null==r?void 0:r.shift)||0;n[e.id]=r5(e,{start:o+i,end:s+i+l}),a.has(e.id)&&(i+=l)})),OI(n,"rippleShiftInRow",!0),UR()})),o5=ff.withUndoBatch((function(e,t,o,a,i={}){const{state:s}=sr(),{duration:n}=s.studio.scenes[0],{byId:r}=s.studio.allLayers,l=_z(s),d={};for(const c of l){const s={...c,...i[c.id]||{}};if(s.timelineRow!==o||!r[s.id])continue;const{start:u,end:m}=cm(s,n);let p=u;const{introTransition:h}=Bx(s);if(h){const e=l.find((({id:e})=>e===h.outroLayerId));e&&(p=cm(e,n).end)}if(e-p>1e-4||p>t)continue;const g=u+a,f=m+a;d[s.id]=r5(s,{start:g,end:f})}return d})),a5=(e,t)=>{const{state:o}=sr(),{byId:a}=o.studio.allLayers,i=_z(o),s=WS(i),n=new Map,{groups:r}=o.studio;if(Object.entries(r).forEach((([e,t])=>{t.layers.forEach((t=>{n.set(t.id,e)}))})),0===e.size)return;const l=[...e.values()].reduce(((e,t)=>e<t?e:t)),d=[...e.keys()];let c=0;for(;c<d.length;){const o=d[c],u=s.get(o),m=e.get(o)??l;null==u||u.forEach((e=>{var o;if(t.includes(e.id))return;const{start:s}=cm(e);let l=s;const{introTransition:c}=Bx(e);if(c){const e=i.find((({id:e})=>e===c.outroLayerId));e&&(l=cm(e).end)}if(m-l>1e-4)return;const u=n.get(e.id);if(u){((null==(o=r[u])?void 0:o.layers)||[]).forEach((e=>{const t=a[e.id],o=null==t?void 0:t.timelineRow;void 0===o||d.includes(o)||d.push(o)}))}})),c+=1}return{rowsToShift:d,smallestMinLeftTime:l}},i5=ff.withUndoBatch(((e,t)=>{const{state:o}=sr(),{selectedItem:a,groups:i}=o.studio,s=[];if("layer"===(null==a?void 0:a.type))s.push(null==a?void 0:a.id);else if("group"===(null==a?void 0:a.type)){const e=i[a.id];null==e||e.layers.forEach((e=>s.push(e.id)))}const n=a5(e,s);if(void 0===n)return;const{rowsToShift:r,smallestMinLeftTime:l}=n,d={};r.forEach((o=>{const a=e.get(o)??l,i=o5(a,1/0,o,t);Object.assign(d,i)})),g.batch((()=>{OI(d,"shiftTracks",!0),UR(),Object.keys(d).length>0&&L3()}))})),s5=({track:e,newTime:t})=>{const{state:o}=sr(),{start:a,end:i}=t,s=o.studio.allLayers.byId[e.id];if(!s)return{};let n={};return qS(s)&&(n={...f0(s,t)}),n=e.type===F3||e.type===M3?{...n,videoDelay:a}:{...n,isTrimmed:!0,startTime:a,endTime:i},n},n5=ff.withUndoBatch((function({updatingMultipleTracks:e,track:t,newTime:o,updateType:a,videoStartEndTimes:i}){const{dispatch:s,state:n}=sr(),{start:r,end:l}=o,d=n.studio.allLayers.byId[t.id];if(!d)return;const c=fI(d.id),u=r,m=d.startTime||0,p=d.videoDelay||0,h=d.playbackRate||1;let g,f=u;qS(d)&&h0(d,o);let y=!0;switch(t.type){case F3:case M3:switch(a){case G3:OI({[d.id]:{videoDelay:r}},"updateLayerStartAndEnd",!0);break;case H3:f=(d.startTime||0)+h*(u-p),OI({[d.id]:{startTime:f,videoDelay:u,endTime:d.endTime||d.duration,isTrimmed:!0}},"updateLayerStartAndEnd",!0),c&&s(CE({[d.id]:p-u}));break;case $3:g=h*(l-p)+m,OI({[d.id]:{isTrimmed:!0,startTime:m,endTime:g}},"updateLayerStartAndEnd",!0),c&&s(kE({[d.id]:l-r}));break;case"TrimPreview":f=i?i.start:(d.startTime||0)+h*(u-p),g=i?i.end:h*(l-p)+m,OI({[d.id]:{isTrimmed:!0,startTime:f,endTime:g}},"updateLayerStartAndEnd",!0);break;default:y=!1}break;case U3:case V3:case B3:case W3:OI({[d.id]:{isTrimmed:!0,startTime:r,endTime:l}},"updateLayerStartAndEnd",!0),c&&a===H3?s(CE({[d.id]:m-u})):c&&a===$3&&s(kE({[d.id]:l-r}));break;default:y=!1}y&&(L3(),e||UR(d))})),r5=(e,t)=>{const{state:o}=sr(),{start:a,end:i}=t,s=o.studio.allLayers.byId[e.id];if(!s)return;let n={};if(qS(s)){const e=uI(s,{startTime:a,duration:s.duration});e&&(n={...n,...e})}switch(e.type){case F3:case M3:return{videoDelay:a,...n};case U3:case V3:case B3:case W3:return{isTrimmed:!0,startTime:a,endTime:i,...n};default:return}},l5=(e,t,o)=>{let a=!1;const i={};for(const s of t)if(s.id!==e.id){if(a){const{start:e,end:t}=cm(s),a=s5({track:s,newTime:{start:e+o,end:t+o}});a&&(i[s.id]=a)}}else a=!0;OI(i,"shiftTracksToRight",!0),UR()},d5=(e,t)=>{const{state:o}=sr(),a=af(o),{layers:i}=o.studio.scenes[0],s=dz(e);if(!s||void 0===s.timelineRow||void 0===s.duration)return;const n=i.filter((e=>e.timelineRow===s.timelineRow)).sort(((e,t)=>cm(e).start-cm(t).start)),r=s.startTime||0,l=s.endTime||s.duration||0,d=s.videoDelay||0,{playbackRate:c=1}=s,u=s.isReversed?{start:s.duration-t.end,end:s.duration-t.start}:t,m=(l-r)/c,p=(u.end-u.start)/c;ff.beginBatch();const h=d+p;if(n5({track:s,newTime:{start:d,end:h},updateType:"TrimPreview",videoStartEndTimes:u}),a)l5(s,n,p-m);else{let t;const o=n.findIndex((t=>t.id===e));if(o>=0&&o+1<n.length){const e=n[o+1];e&&(t=cm(e).start)}t&&h>t&&l5(s,n,h-t)}s.isReversed&&(rR({time:null}),ff.add({undo:{func:()=>{rR({time:null})}},redo:{func:()=>{rR({time:null})}}})),ff.endBatch()},c5=(e,t,o)=>{const a=e.timelineRow||0;let i=a+1;const s=t.map((e=>({...e})));let n;s.sort(((e,t)=>(e.timelineRow||0)-(t.timelineRow||0)));const{start:r,end:l}=cm(e,o);for(const c of s){const{timelineRow:e=0}=c;if(e<i)continue;if(i<e)break;const{start:t,end:a}=cm(c,o);if(r<=t&&t<l||t<=r&&r<a){n=!0;break}}if(!n)return;const d={};s.forEach((e=>{void 0!==e.timelineRow&&a<e.timelineRow&&e.timelineRow<=i&&(d[e.id]={timelineRow:e.timelineRow+1},i+=1)})),OI(d,"offsetTimelineTrackRows",!0)},u5=e=>{const t=[];let o,a=[];const i=[...e];i.sort(((e,t)=>e.timelineRow-t.timelineRow?e.timelineRow-t.timelineRow:e.timelinePosition.left-t.timelinePosition.left)),i.forEach((e=>{o!==e.timelineRow&&(o=e.timelineRow,a=[],t.push(a)),a.push(e)}));return t.sort(((e,t)=>e[0].timelinePosition.left-t[0].timelinePosition.left)),t},m5=(e,t)=>{const o=t.find((t=>{const o=((e,t)=>{const{top:o,left:a,width:i,height:s}=t,n=e.left,r=e.top+e.height/2;return o<=r&&o+s>=r&&a+10<=n&&a+i-10>=n})(e,t.timelinePosition);return o}));return o},p5=(e,t,o)=>({type:"SET_ASSET_PARSED_SUBTITLE",assetId:e,subtitles:t,undoable:o});function h5({assetId:e,endTime:t,startTime:o}){return jA([e])(sr().state).find((e=>{const[a,i]=TS(e);return Sr(a,i,o,t)}))}function g5({beforeFrame:e,newTime:t,timeType:o,wordIsClippedList:a}){const{startNdx:i,endNdx:s}="start"===o?function(e){let t=!1,o=0,a=0;for(let i=0;i<e.length;i++)if(e[i]){if(t)return a=i-1,{startNdx:o,endNdx:a}}else t||(o=i),t=!0;return{startNdx:o,endNdx:e.length-1}}(a):function(e){let t=!1,o=0,a=0;for(let i=0;i<e.length;i++)e[i]?(t&&(a=i-1),t=!1):(t||(o=i),t=!0);return t&&(a=e.length-1),{startNdx:o,endNdx:a}}(a),n=function({beforeFrame:e,newTime:t,startNdx:o,endNdx:a,timeType:i}){const s=[{type:"frame_update",frameId:e.id,update:{[i]:t}}];if(!nd(e))return s;const n="start"===i?"end":"start",r="start"===i,l=e.words[o],d=e.words[a-1];if(r&&l&&t<l.start)return s.push({type:"word_update",ndx:o,frameId:e.id,update:{start:t}}),s;if(!r&&d&&t>d.end)return s.push({type:"word_update",ndx:a,frameId:e.id,update:{end:t}}),s;const c=[];for(let p=o;p<=a;p++){const o=e.words[p];void 0!==o&&((r?o.start<t:o.end>t)&&c.push({word:o,ndx:p}))}if(0===c.length)return s;r||c.reverse();const u=c[r?c.length-1:0],m=Math.abs(t-u.word[n])/c.length;for(let p=0;p<c.length;p++){const o=c[p];if(!o)continue;const{ndx:a}=o,l=m*(r?1:-1),d=t+l*p,u={[i]:d};c.length>1&&(u[n]=d+l),s.push({type:"word_update",ndx:a,frameId:e.id,update:u})}return s}({beforeFrame:e,newTime:t,startNdx:i,endNdx:s,timeType:o}),r=PA(e);if("start"===o){const o=[];for(let r=0;r<i;r++){n.push({frameId:e.id,type:"word_remove",ndx:0});const a=e.words[r];if(a){r===i-1&&id(a)?o.push({...a,end:Math.min(a.end,t)}):o.push(a)}}const a=r.words[0],s=r.words[o.length-1];a&&s&&n.push({type:"frame_insert",frame:{id:P(),start:a.start,end:Math.min(s.end,t),words:o}})}if("end"===o){const o=e.words.length-s-1,a=[];for(let s=0;s<o;s++){n.push({frameId:e.id,type:"word_remove",ndx:e.words.length-o});const i=e.words[e.words.length-s-1];if(i){s===o-1&&id(i)?a.push({...i,start:Math.max(i.start,t)}):a.push(i)}}a.reverse();const i=r.words[e.words.length-o],l=r.words[e.words.length-1];i&&l&&n.push({type:"frame_insert",frame:{id:P(),start:Math.max(i.start,t),end:l.end,words:a}})}return n}var f5=(e=>(e.LAYER_CONTROLS="LAYER_CONTROLS",e.MEDIA_CONTROLS="MEDIA_CONTROLS",e.COMMENTS="COMMENTS",e))(f5||{});const y5=()=>{const e=tl(TA),[t=""]=e,o=h.useMemo((()=>zA(t)),[t]);return tl(o)},v5=e=>{const t=tl((e=>{var t;return!!(null==(t=e.studio.magicSubtitlesGlobal)?void 0:t.isHidden)})),o=_E(),{canvasHeight:a,canvasWidth:i,canvasX:s,canvasY:n}=tl((e=>({canvasHeight:e.studio.height,canvasWidth:e.studio.width,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY})),ol),r=h.useMemo((()=>oj({assetId:e,canvasHeight:a,canvasWidth:i,canvasX:s,canvasY:n})),[e,a,i,s,n]),l=h.useMemo((()=>r(o)),[r,o]),d=tl(l);return t?null:d},_5=e=>{var t;const{canvasHeight:o,canvasWidth:a,canvasX:i,canvasY:s}=tl((e=>({canvasHeight:e.studio.height,canvasWidth:e.studio.width,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY})),ol),n=h.useMemo((()=>CA({assetId:e,canvasHeight:o,canvasWidth:a,canvasX:i,canvasY:s})),[e,o,a,i,s]),r=tl(n,ol),l=tl((t=>{var o,a,i;return null==(i=null==(a=null==(o=t.studio)?void 0:o.magicSubtitleFramesByAsset)?void 0:a[e])?void 0:i.byId}),ol)||{},d=tl((e=>e.studioLocal.magicSubtitlesGlobal.position),ol),c=v5(e),u=l[(null==(t=null==c?void 0:c.frame)?void 0:t.id)||""],m=null==u?void 0:u.position,p={...r},g=d||m;if(g){const e={height:o,width:a,x:i,y:s},{x:t,y:n}=WE(g.xPct??0,g.yPct??0,e),{width:r,height:l}=HE(g.widthPct??0,g.heightPct??0,e);p.x=t,p.y=n,p.height=l,p.width=r}return p},w5=(e,t)=>({type:"DELTA_ASSET_TRANSCRIPTION_EDIT_COUNT",assetIds:e,delta:t}),b5=e=>({type:"RESET_ASSET_TRANSCRIPTION_EDIT_COUNT",assetIds:e});let T5=null;const x5=()=>{if(!T5)return;const{assetId:e,words:t}=T5;T5=null;const o=t[0];if(!o)return;const a=t.reduce(((e,t)=>({...e,...t,before:e.before})),o);A5({assetId:e,shouldSync:!0,undoable:!0,updates:[a]})},S5=(e,t,o)=>{if(0===e.length)return null;((e,t,o)=>{var a;if(o&&t!==o.assetId)return!1;const i=e[0];if(!i)return!1;if("word_update"!==i.type)return!1;const s=(null==(a=null==o?void 0:o.words)?void 0:a[0])||i;return e.every((e=>"word_update"===e.type&&e.frameId===s.frameId&&e.ndx===s.ndx))})(e,t,T5)?(A5({updates:e,assetId:t,shouldSync:!1,undoable:!1}),T5||(T5={assetId:t,words:[]}),T5.words.push(...e)):(x5(),A5({updates:e,assetId:t,shouldSync:!0,undoable:!0}));let a=null,i=null,s=null,n=0,r=0,l=null;for(const p of e)"frame_insert"===p.type&&(n+=1),"frame_remove"===p.type&&(r+=1),"word_insert"===p.type&&(null===i&&(i=p.ndx),s=p.ndx),"frame_update"===p.type&&(void 0!==p.update.start&&(l="delete"),void 0!==p.update.end&&(l="backspace"));let d=!1,c=null;(n||r)&&(n&&r?a=o+1:r?"backspace"===l?(a=o-1,d=!0,c=i):(a=o,d=!0,null!==s&&(c=s+1)):a=o);let u=0;if(d&&null!==a&&null!==c){const e=(m=a,(aj(sr().state)??[])[m]);if(e){const o=(e=>YA(e)(sr().state))(t);for(let t=0;t<c;t++){const a=e.words[t];a&&(u+=a.text.length+o.length)}}}var m;return{targetNdx:a,charNdx:u}};function E5(e){const t={...e};void 0===t.undoable&&(t.undoable=!0),x5(),sr().dispatch(t)}function I5(e){return e.type.startsWith("multi_frame")||e.type.startsWith("frame")}function C5(e,t){switch(e.type){case"multi_frame_insert":return{type:"INSERT_MAGIC_SUBTITLE_FRAMES",assetIdFramePairs:e.assetIdFramePairs,undoable:t.undoable};case"multi_frame_update":return{type:"UPDATE_MAGIC_SUBTITLE_FRAMES",updates:e.updates,undoable:t.undoable};case"multi_frame_remove":return{type:"REMOVE_MAGIC_SUBTITLE_FRAMES",frameIdPairs:e.frameIdPairs,undoable:t.undoable};default:throw Error(`Unknown change ${e}`)}}function k5(e,t){switch(e.type){case"word_insert":return{type:"INSERT_MAGIC_SUBTITLE_FRAME_WORD",wordNdx:e.ndx,word:e.word,frameId:e.frameId,...t};case"word_update":return{type:"UPDATE_MAGIC_SUBTITLE_FRAME_WORD",wordNdx:e.ndx,update:e.update,frameId:e.frameId,undoBeforeWord:e.before,...t};case"word_remove":return{type:"REMOVE_MAGIC_SUBTITLE_FRAME_WORD",wordNdx:e.ndx,frameId:e.frameId,...t};default:throw Error(`Unknown change ${e}`)}}const A5=ff.withUndoBatch((({assetId:e,shouldSync:t,undoable:o,updates:a})=>{const{dispatch:i}=sr();x5();const s=function(e,t){const o=[],a=[],i=[],s=[];return e.forEach((e=>{!function(e){return e.type.startsWith("frame")}(e)?o.push(e):"frame_insert"!==e.type?"frame_remove"!==e.type?"frame_update"!==e.type||s.push(e):i.push(e):a.push(e)})),a.length>0&&o.push({type:"multi_frame_insert",assetIdFramePairs:a.map((e=>({assetId:t,frame:e.frame})))}),i.length>0&&o.push({type:"multi_frame_remove",frameIdPairs:i.map((e=>({assetId:t,id:e.frameId})))}),s.length>0&&o.push({type:"multi_frame_update",updates:s.map((e=>({assetId:t,frameId:e.frameId,update:e.update})))}),o}(a,e);for(const d of s)I5(d)?i(C5(d,{assetId:e,undoable:o})):i(k5(d,{assetId:e,shouldSync:t,undoable:o}));const n=aj(sr().state),r=TA(sr().state),l=new Set(r);for(const d of n)l.delete(d.assetId);for(const d of l.keys())i(wC(d)),E5({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:d,frames:null});i(b5(Array.from(l)))})),j5=ff.withUndoBatch((()=>{const{state:e,dispatch:t}=sr();g.batch((()=>{const o=[...Object.keys(e.studio.magicSubtitles||{}),"background-asset"];t(b5(o));for(const e of o)N5(e)}))})),N5=ff.withUndoBatch((e=>{var t;const{dispatch:o,state:a}=sr();(null==(t=a.studioLocal.magicSubtitleSelection)?void 0:t.assetId)===e&&(o(tw(-1)),o(ew(null))),o(wC(e)),E5({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:e,frames:null}),o(p5(e,null,!0))})),R5=()=>{const{dispatch:e,state:t}=sr();e(l_({type:"magicSubtitle",frames:lj(t).map((e=>({assetId:e.assetId,id:e.frame.id,containingLayerPlaybackRate:e.frame.containingLayerPlaybackRate,wordIsClippedList:e.frame.wordIsClippedList})))}))};const P5=ff.withUndoBatch((({assetId:e,frameId:t,startTime:o,endTime:a,wordIsClippedList:i})=>{const{state:s}=sr(),n=LA(e,t)(s);u({category:"Magic Subtitles/studioEjectMagicSubtitle",data:{assetId:e,frameId:t,startTime:o,endTime:a,beforeFrame:n}}),E5({type:"REMOVE_MAGIC_SUBTITLE_FRAME",assetId:e,frameId:t});for(const{start:l,end:d,words:c}of function(e,t){const o=[];let a=null;const i=PA(t);for(let s=0;s<e.length;s++){const n=t.words[s],r=i.words[s],l=e[s];r&&n&&(l?a?(a.end=r.end,a.words.push(n)):(a={start:r.start,end:r.end,words:[n]},o.push(a)):a=null)}return o}(i,n))E5({type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:e,frame:{id:P(),start:l,end:d,words:c}});const r=[];for(let l=0;l<n.words.length;l++){const e=n.words[l],t=i[l];if(!e)continue;if(t)continue;const o={text:e.text};e.styles&&(o.styles=e.styles),r.push(o)}E5({type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:"background-asset",frame:{id:n.id,start:o,end:a,words:r}})})),D5=ff.withUndoBatch((e=>{const{dispatch:t}=sr();g.batch((()=>{E5({type:"REMOVE_MAGIC_SUBTITLE_FRAMES",frameIdPairs:s.uniqBy(e,(e=>`${e.id}-${e.assetId}`))}),t(w5(e.map((e=>e.assetId)),1))}))}));function O5({assetId:e,beforeFrame:t,newTimeFrameRelative:o,newTimeTimelineRelative:a,timeType:i,timelineRelativeEndClipped:s,timelineRelativeStartClipped:n,wordIsClippedList:r}){const l="start"===i?a-n:a-s;if(h5("start"===i?{assetId:e,startTime:a,endTime:a+.001}:{assetId:e,startTime:a-.001,endTime:a})){const a=g5({beforeFrame:t,newTime:Math.max(o,0),timeType:i,wordIsClippedList:r});A5({updates:a,assetId:e,shouldSync:!0,undoable:!0})}else{const o=Math.max("start"===i?n+l:n,0);P5({assetId:e,startTime:o,endTime:"end"===i?s+l:s,frameId:t.id,wordIsClippedList:r})}}function L5(){const{dispatch:e,state:t}=sr(),{isMobile:o}=t;e(ic(!0)),e(YD({tabContainerId:"media-sidebar",tabId:"Subtitles"})),o&&e(H_(f5.MEDIA_CONTROLS))}const F5={top:1,middle:.5,bottom:0};function M5(e,t){const{state:o,dispatch:a}=sr();let i=(e=>{const t=bE(),{state:o}=sr();return oj({assetId:e,canvasHeight:o.studio.height,canvasWidth:o.studio.width,canvasX:o.studio.canvasX,canvasY:o.studio.canvasY})(t)(o)})(e);if(!i){const t=tj({assetId:e,filterEmpty:!0,filterInvalid:!0,canvasHeight:o.studio.height,canvasWidth:o.studio.width,canvasX:o.studio.canvasX,canvasY:o.studio.canvasY,fontSizeOverride:null})(o);i=t[Math.min(t.length-1,3)]||null}if(!i)return;const s=CA({assetId:e,canvasHeight:o.studio.height,canvasWidth:o.studio.width,canvasX:o.studio.canvasX,canvasY:o.studio.canvasY})(o),n=LC(i,i.frame.lines,s),r=(l=i.verticalAlign??"top",(F5[l]-F5[t])*n.height);var l;const d=BC({...s,y:s.y+r});a(bC({updates:{position:d}}))}function U5(e=!1){const{state:t}=sr();t.studio.width&&t.studio.height&&Object.keys(t.studio.magicSubtitles||{}).forEach((o=>{var a,i;const s=IA(o)(t);if(!(s&&s.enabled&&s.style&&s.position))return;if(DA(o)(t)&&!e)return;if("upload"===s.transcriptionSource){const e=null==(i=null==(a=t.studio.assetUploadedSubtitles)?void 0:a[o])?void 0:i.subtitles;if(!e)return;return void E5({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:o,frames:UC(e)})}if("manual"===s.transcriptionSource)return;const n=AA(o)(t);if("completed"!==(null==n?void 0:n.state))return;const r=YA(o)(t),l=s.languageKey?$A(s.languageKey).translateCode||$A(s.languageKey).languageCode:void 0,d=s.defaultCharsPerSubtitle??16,c=GA({assetId:o,languageCode:l,maxCharsPerSubtitle:" "===r?2*d:d,ignoreCorrections:e})(t);if(!c)return;E5({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:o,frames:MC({distributed:c,removeGaps:!0,type:s.translated?"simple":"timed"})})}))}const B5=()=>{const{state:e}=sr(),{selectedItem:t,allLayers:{byId:o}}=e.studio;return o[(null==t?void 0:t.id)??""]},V5=e=>{const t=B5();if(!t)return;e&&e.preventDefault();const{dispatch:o}=sr();o($v(t,!0))},W5=e=>{const t=B5();if(!t)return;e&&e.preventDefault();const{dispatch:o}=sr();o(Hv(t,!0))},G5=e=>{const t=B5();if(!t)return;e&&e.preventDefault();const{dispatch:o}=sr();o(Kv(t,0,!0))},H5=e=>{const t=B5();if(!t)return;e&&e.preventDefault();const{dispatch:o,state:a}=sr();let i=a.studio.scenes[0].layers.length-1;i<0&&(i=0),o(Kv(t,i,!0))},$5=(e,t,o)=>{const{dispatch:a}=sr(),i=oe.v4();a(function(e,t,o,a,i){return{type:"SET_TIMELINE_GAP",gapId:e,startTime:t,duration:o,timelineRow:a,undoable:i}}(i,e,t,o,!1)),a(l_({id:i,type:"gap"}))},K5=(e,t,o)=>{const{dispatch:a}=sr(),i=o||B5();if(i&&i.position){const o=((e,t,o,a)=>{const{x:i,y:s}=WE(e,t),n="120%",r="-50%",l=WE(n,n),d=WE(r,r);return qE(Math.max(Math.min(i+o,l.x),d.x),Math.max(Math.min(s+a,l.y),d.y))})(i.position.x,i.position.y,e,t);a(function(e,t,o,a){return{type:"REPOSITION_LAYER",layer:e,x:t,y:o,undoable:a}}(i,o.xPercent,o.yPercent,!0))}},z5=e=>{K5(0,-1,e)},Y5=e=>{K5(0,-10,e)},J5=e=>{K5(0,1,e)},q5=e=>{K5(0,10,e)},X5=e=>{K5(1,0,e)},Q5=e=>{K5(10,0,e)},Z5=e=>{K5(-1,0,e)},e4=e=>{K5(-10,0,e)},t4=e=>{const{dispatch:t}=sr();t($_(e))},o4=ff.withUndoBatch(((e=!0)=>{const{dispatch:t,state:o,history:{location:a}}=sr(),{studio:i}=o,{selectedItem:s,overlayMounted:n}=i;if(!s)return;if(n)return;if(a.pathname.includes("remove-background"))return;if("layer"===s.type&&fI(s.id)){let a=!1;const i=o.studio.allLayers.byId[s.id],n=bE(),[r]=TS(i);if(NI(i.id).forEach((o=>{o.time.toFixed(5)===(n-r).toFixed(5)&&(t(IE(i.id,o.channel,o.time,e)),a=!0)})),a)return void t(l_(null))}const r=af(o);switch(s.type){case"group":if(r)return void Q3();MJ(s.id,e);break;case"layer":{if(r)return void Q3();Az({layerIds:[s.id],undoable:e,logEvent:!0});const t=Object.entries(i.groups).filter((e=>e[1].layers.some((e=>e.id===(null==s?void 0:s.id)))));if(t.length>0){const o=t[0][0];fJ(s.id,o,e)}break}case"magicSubtitle":ff.execInUndoBatch((()=>{D5(s.frames.allFrames),t(l_(null,!0))}))}}));function a4(){return tl(gR)}const i4="BoxSelect-module_boxSelectContainerWorkspace_CjCbh",s4="BoxSelect-module_boxSelectContainerCanvas_-0Joz",n4="BoxSelect-module_boxSelectContainerTrackpad_T9zxF";function r4(e,t){const o=[e,t];let a,i,s,n,r,l,d;for(const c of o)for(n=0;n<c.length;n+=1){const o=(n+1)%c.length,u=c[n],m=c[o],p={x:m.y-u.y,y:u.x-m.x};for(a=void 0,i=void 0,r=0;r<e.length;r+=1)s=p.x*e[r].x+p.y*e[r].y,(void 0===a||s<a)&&(a=s),(void 0===i||s>i)&&(i=s);for(l=void 0,d=void 0,r=0;r<t.length;r+=1)s=p.x*t[r].x+p.y*t[r].y,(void 0===l||s<l)&&(l=s),(void 0===d||s>d)&&(d=s);if(i<l||d<a)return!1}return!0}const l4=[],d4=_.memo((({autoScrollDisplacement:e,boxSelectIsHappening:t,boxSelectStartCoords:o,containerOffsetX:a,containerOffsetY:i,disabled:n=!1,location:r,setBoxSelectIsHappening:l,setBoxSelectStartCoordsToNull:d,unlockedProjectsArray:c})=>{const u=il(),[m,p]=h.useState(null),[g,f]=h.useState({}),y=tl((e=>e.studioLocal.boxSelectedIds)),v=tl((e=>{return"trackpad"===r?D3(e):"workspace"===r&&c?null==(t=c)?void 0:t.map((e=>{const{top:t,left:o,width:a,height:i}=e.position?e.position:{top:0,left:0,width:0,height:0},s=[{x:o,y:t},{x:o+a,y:t},{x:o+a,y:t+i},{x:o,y:t+i}];return{id:e._id,points:s,item:{type:"project"}}})):P3(e,bE());var t})),_=tl((e=>"trackpad"!==r?l4:O3(e))),b=a4().map((e=>null==e?void 0:e.id)),T={x:0,y:0},x={x:T.x,y:T.y};let S=0,E=0;if(m){T.x=o.x-a,T.y=o.y-i,S=m.x+((null==e?void 0:e.horizontal)??0),E=m.y+((null==e?void 0:e.vertical)??0),S<0&&(T.x+=S),E<0&&(T.y+=E),x.x=T.x+Math.abs(S),x.y=T.y+Math.abs(E);const t=[{x:T.x,y:T.y},{x:x.x,y:T.y},{x:x.x,y:x.y},{x:T.x,y:x.y}],n=e=>!e.points.every((e=>0===e.x&&0===e.y))&&r4(e.points,t),r=v.filter(n),l=_.filter(n),d=(r.length>0?r:l).reduce(((e,t)=>(e[t.id]=t.item,e)),{});s.isEqual(d,g)||f(d)}const I=cE((()=>{if(l&&t&&l(!1),null!==m){p(null);let e=Object.entries(g).filter((e=>"layer"===e[1].type||"group"===e[1].type)).map((e=>e[0]));(null==b?void 0:b.length)&&(e=[...new Set([...e,...b])]),t4({});if(Object.values(g).some((e=>"magicSubtitle"===e.type))){const e=Object.values(g).filter((e=>"magicSubtitle"===e.type)).map((e=>e.frames)).flat();u(l_({type:"magicSubtitle",frames:e}))}else xJ(e,"trackpad"===r);Object.keys(g).length>0&&f({}),d()}d()})),C=cE((e=>{l&&!t&&l(!0);const{clientX:a,clientY:i}=e,s=a-o.x,n=i-o.y;p({x:s,y:n}),b.length&&!l&&sr().dispatch(l_(null))}));return h.useEffect((()=>(document.addEventListener("mousemove",C),document.addEventListener("mouseup",I),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",I)})),[C,I]),h.useEffect((()=>{s.isEqual(g,y)||t4(g)}),[g,y]),m&&!n?w.jsx("div",{className:(()=>{switch(r){case"workspace":return i4;case"canvas":return s4;default:return n4}})(),style:{left:`${T.x}px`,top:`${T.y}px`,width:`${Math.max(Math.abs(S),1)}px`,height:`${Math.max(Math.abs(E),1)}px`}}):null})),c4=e=>e.length-1;function u4(e,t){const{x:o,y:a,width:i,height:s}=e,n=t*Math.PI/180,r=o+i/2,l=a+s/2;return{tl:{x:(o-r)*Math.cos(n)-(a-l)*Math.sin(n)+r,y:(o-r)*Math.sin(n)+(a-l)*Math.cos(n)+l},tr:{x:(o+i-r)*Math.cos(n)-(a-l)*Math.sin(n)+r,y:(o+i-r)*Math.sin(n)+(a-l)*Math.cos(n)+l},bl:{x:(o-r)*Math.cos(n)-(a+s-l)*Math.sin(n)+r,y:(o-r)*Math.sin(n)+(a+s-l)*Math.cos(n)+l},br:{x:(o+i-r)*Math.cos(n)-(a+s-l)*Math.sin(n)+r,y:(o+i-r)*Math.sin(n)+(a+s-l)*Math.cos(n)+l},origin:{x:r,y:l}}}function m4(e,t=!0){const{state:o}=sr(),{canvasX:a,canvasY:i}=o.studio,s=o.studio.width,n=o.studio.height,r=[];for(const l of e){const{width:e,height:t}=l,{x:o,y:d}=l;let c={x:o,y:d,width:e,height:t};if("position"in l&&l.position){const{x:e,y:t,width:o,height:r}=l.position;c={x:a+parseFloat(e)/100*s,y:i+parseFloat(t)/100*n,width:parseFloat(o)/100*s,height:parseFloat(r)/100*n},"shape"===l.type&&"ellipse"===l.shapeType&&(c.x-=c.width/2,c.y-=c.height/2)}const{tl:u,tr:m,bl:p,br:h,origin:g}=u4(c,l.position&&l.position.rotation||0);r.push({x:u.x,y:u.y},{x:m.x,y:m.y},{x:p.x,y:p.y},{x:h.x,y:h.y},{x:g.x,y:u.y},{x:g.x,y:h.y},{x:u.x,y:g.y},{x:h.x,y:g.y})}return t?r.filter((e=>e.x>=a&&e.x<=a+s&&e.y>=i&&e.y<=i+n)):r}function p4(e,t,o){return[90,270].includes(e)?{x:UE((t-o)/2),y:UE((o-t)/2)}:{x:0,y:0}}function h4(e,t){const o=function(){var e;const{state:t}=sr(),{scenes:o,selectedItem:a,canvasX:i,canvasY:s,width:n,height:r,groups:l}=t.studio,d=(null==a?void 0:a.id)||"";return m4([{x:i,y:s,width:n,height:r},...(null==(e=o[0])?void 0:e.layers.filter((e=>{var t;if(!e)return!1;const o=l&&l[d]&&(null==(t=l[d])?void 0:t.layers.map((e=>e.id)).includes(e.id)),[a,i]=TS(e),s=a<=bE()&&bE()<=i;return!o&&e.id!==d&&s})))||[]])}(),{x:a,y:i,width:s,height:n}=e;let r=a,l=i;const d=p4(t,n,s);r-=d.x,l-=d.y;const c=[90,270].includes(t),u=c?n:s,m=c?s:n,p={top:!1,right:!1,bottom:!1,left:!1,centerX:!1,centerY:!1},h={},g={top:[],right:[],bottom:[],left:[],centerX:[],centerY:[]};for(const{x:I,y:C}of o){const e=I-3,t=I+3,o=C-3,a=C+3;l>=o&&l<=a&&(p.top=!0,g.top.push({x:I,y:C})),r+u>=e&&r+u<=t&&(p.right=!0,g.right.push({x:I,y:C})),l+m>=o&&l+m<=a&&(p.bottom=!0,g.bottom.push({x:I,y:C})),r>=e&&r<=t&&(p.left=!0,g.left.push({x:I,y:C}));const i=r+u/2;i>=e&&i<=t&&(p.centerX=!0,g.centerX.push({x:I,y:C}));const s=l+m/2;s>=o&&s<=a&&(p.centerY=!0,g.centerY.push({x:I,y:C}))}const[f,y,v,_,w,b,T,x]=m4([{x:r,y:l,width:u,height:m}],!1);if(!(f&&y&&v&&_&&w&&b&&T&&x))return{shouldSnap:p,snapPositions:h};const S=(e,t)=>((e={},t="",o="")=>{const a=e[t].sort(((e,t)=>e[o]-t[o]));return Object.assign(e,{[t]:a}),a})(g,e,t);let E=0;return p.top&&(S("top","x"),E=c4(g.top),y.x>g.top[E].x&&g.top.push({x:y.x,y:g.top[E].y}),f.x<g.top[0].x&&g.top.unshift({x:f.x,y:g.top[0].y})),p.bottom&&(S("bottom","x"),E=c4(g.bottom),_.x>g.bottom[E].x&&g.bottom.push({x:_.x,y:g.bottom[E].y}),v.x<g.bottom[0].x&&g.bottom.unshift({x:f.x,y:g.bottom[0].y})),p.left&&(S("left","y"),E=c4(g.left),v.y>g.left[E].y&&g.left.push({x:g.left[E].x,y:v.y}),f.y<g.left[0].y&&g.left.unshift({x:g.left[0].x,y:f.y})),p.right&&(S("right","y"),E=c4(g.right),_.y>g.right[E].y&&g.right.push({x:g.right[E].x,y:_.y}),y.y<g.right[0].y&&g.right.unshift({x:g.right[0].x,y:y.y})),p.centerX&&(S("centerX","y"),E=c4(g.centerX),b.y>g.centerX[E].y&&g.centerX.push({x:g.centerX[E].x,y:b.y}),w.y<g.centerX[0].y&&g.centerX.unshift({x:g.centerX[0].x,y:w.y})),p.centerY&&(S("centerY","x"),E=c4(g.centerY),x.x>g.centerY[E].x&&g.centerY.push({x:x.x,y:g.centerY[E].y}),T.x<g.centerY[0].x&&g.centerY.unshift({x:T.x,y:g.centerY[0].y})),Object.keys(g).forEach((e=>{const t=g[e];if(t.length){const o=t.length-1;Object.assign(h,{[e]:[{x:t[0].x,y:t[0].y},{x:t[o].x,y:t[o].y}]})}})),{shouldSnap:p,snapPositions:h}}const g4=e=>{const{x:t,y:o,width:a,height:i}=e,{state:s}=sr(),{canvasX:n,canvasY:r,width:l,height:d}=s.studio,c=e;return t<=n+3&&t>=n-3&&(c.x=n),o<=r+3&&o>=r-3&&(c.y=r),i<=d+3&&i>=d-3&&(c.height=d),a<=l+3&&a>=l-3&&(c.width=l),c},f4=(e,t,o="")=>{const{shouldSnap:a,snapPositions:i}=h4(e,t),{x:s,y:n,width:r,height:l}=e,{dispatch:d,state:c}=sr();let u=s,m=n;const p={},h=p4(t,l,r),g=[90,270].includes(t),f=g?l:r,y=g?r:l;let v=f,_=y;if(a.centerX){const e=i.centerX[0].x+h.x;if(o.includes("Right")){v+=2*(e-f/2-s)}else if(o.includes("Left")){const t=f+s-e;u=e-t,v=2*t}Object.assign(p,{centerX:{start:i.centerX[0],end:i.centerX[1]}})}if(a.centerY){const e=i.centerY[0].y+h.y;if(o.includes("bottom")){_+=2*(e-y/2-n)}else if(o.includes("top")){const t=n+y-e;m=e-t,_=2*t}Object.assign(p,{centerY:{start:i.centerY[0],end:i.centerY[1]}})}if(a.top){const e=i.top[0].y+h.y;m=e,_+=n-e,Object.assign(p,{top:{start:i.top[0],end:i.top[1]}})}if(a.right&&(v+=-1*f+(i.right[0].x-s)+h.x,Object.assign(p,{right:{start:i.right[0],end:i.right[1]}})),a.bottom&&(_+=-1*y+(i.bottom[0].y-n)+h.y,Object.assign(p,{bottom:{start:i.bottom[0],end:i.bottom[1]}})),a.left){const e=i.left[0].x+h.x;u=e,v+=s-e,u=i.left[0].x+h.x,Object.assign(p,{left:{start:i.left[0],end:i.left[1]}})}(Object.keys(p).length||c.studio.snapLines&&Object.keys(p).length!==Object.keys(c.studio.snapLines).length)&&d(Xv(p));return g4({x:u,y:m,width:g?_:v,height:g?v:_})},y4=(e,t,o=!0)=>{const{shouldSnap:a,snapPositions:i}=h4(e,t),{x:s,y:n,width:r,height:l}=e,{dispatch:d,state:c}=sr();let u=s,m=n;const p={},h=p4(t,l,r),g=[90,270].includes(t),f=g?l:r,y=g?r:l;a.top&&(m=i.top[0].y+h.y,Object.assign(p,{top:{start:i.top[0],end:i.top[1]}})),a.right&&(u=i.right[0].x-f+h.x,Object.assign(p,{right:{start:i.right[0],end:i.right[1]}})),a.bottom&&(m=i.bottom[0].y-y+h.y,Object.assign(p,{bottom:{start:i.bottom[0],end:i.bottom[1]}})),a.left&&(u=i.left[0].x+h.x,Object.assign(p,{left:{start:i.left[0],end:i.left[1]}})),a.centerX&&(u=i.centerX[0].x-r/2,Object.assign(p,{centerX:{start:i.centerX[0],end:i.centerX[1]}})),a.centerY&&(m=i.centerY[0].y-l/2,Object.assign(p,{centerY:{start:i.centerY[0],end:i.centerY[1]}})),(Object.keys(p).length||c.studio.snapLines&&Object.keys(p).length!==Object.keys(c.studio.snapLines).length)&&o&&d(Xv(p));const v={...e,x:u,y:m};return g4(v)},v4={home:"Transformer-module_home_oIkMB",homeHowBackgroundWhite:"Transformer-module_homeHowBackgroundWhite_lXDmU",largeButton:"Transformer-module_largeButton_a8Fs4",sectionContent:"Transformer-module_sectionContent_DUpV-",sectionHeader:"Transformer-module_sectionHeader_ROcM-",spacer:"Transformer-module_spacer_1JWk0",chevron:"Transformer-module_chevron_c9Ys4",splashText:"Transformer-module_splashText_zdbos",splashSubtext:"Transformer-module_splashSubtext_OwPHU",aboutSection:"Transformer-module_aboutSection_1zW2e",mobile:"Transformer-module_mobile_r3-eB",desktop:"Transformer-module_desktop_t7exQ",screenReaderOnlyLabel:"Transformer-module_screenReaderOnlyLabel_sfUXl",disabled:"Transformer-module_disabled_gVJ7y",noScrollBar:"Transformer-module_noScrollBar_8J5fU",textOverflowEllipsis:"Transformer-module_textOverflowEllipsis_nxsp7",disableTextHighlight:"Transformer-module_disableTextHighlight_S3tWX",genericButtonBlue:"Transformer-module_genericButtonBlue_cqcrv",button:"Transformer-module_button_Vi0nG",buttonDisabled:"Transformer-module_buttonDisabled_hnVvt",buttonSelected:"Transformer-module_buttonSelected_h7uwI",buttonOk:"Transformer-module_buttonOk_x3KcI",buttonStacked:"Transformer-module_buttonStacked_fKQ7m",doneButton:"Transformer-module_doneButton_5NtwR",desktopNoWrap:"Transformer-module_desktopNoWrap_-tLqx",mobileNoWrap:"Transformer-module_mobileNoWrap_f7WTr",controlSectionContainer:"Transformer-module_controlSectionContainer_hLek9",section:"Transformer-module_section_euMbw",input:"Transformer-module_input_m-yAq",cyanDoneButton:"Transformer-module_cyanDoneButton_IrFLD",cyanDoneButton__disabled:"Transformer-module_cyanDoneButton__disabled_M4k3M",cyanDoneButtonContainer:"Transformer-module_cyanDoneButtonContainer_P3-bu",genericButton:"Transformer-module_genericButton_1ijrh",genericButtonSelected:"Transformer-module_genericButtonSelected_iPBIo",groupControlContainer:"Transformer-module_groupControlContainer_zkpv8",controlSectionRows:"Transformer-module_controlSectionRows_4k6Qd",controlSectionRowsTimeline:"Transformer-module_controlSectionRowsTimeline_FlKJR",controlSectionRowsTwoPerRow:"Transformer-module_controlSectionRowsTwoPerRow_-4BFu",controlSectionRowsExpandChildren:"Transformer-module_controlSectionRowsExpandChildren_nmuI0",controlSectionRowsFullWidth:"Transformer-module_controlSectionRowsFullWidth_VhT5g",controlSectionRowsNoWrap:"Transformer-module_controlSectionRowsNoWrap_e-uIj",controlSectionRowsNoPadding:"Transformer-module_controlSectionRowsNoPadding_cx-6r",controlSectionRowsIconAndControl:"Transformer-module_controlSectionRowsIconAndControl_nFyPo",controlSectionWrapColumns:"Transformer-module_controlSectionWrapColumns_BivM-",controlSectionScrollableColumn:"Transformer-module_controlSectionScrollableColumn_J-gFN",controlSectionTitle:"Transformer-module_controlSectionTitle_XmRot",controlSectionTitleNoPadding:"Transformer-module_controlSectionTitleNoPadding_KtNiK",controlSectionDescription:"Transformer-module_controlSectionDescription_2-HSU",smallControlButton:"Transformer-module_smallControlButton_HIoC4",smallControlButtonDisabled:"Transformer-module_smallControlButtonDisabled_v6XIu",smallControlButtonSelected:"Transformer-module_smallControlButtonSelected_PbxGE",smallControlButtonLabel:"Transformer-module_smallControlButtonLabel_Z6bKj",controlSectionRow:"Transformer-module_controlSectionRow_QBQPc",controlButtonIcon:"Transformer-module_controlButtonIcon_ACT-S",controlButtonOnlyIcon:"Transformer-module_controlButtonOnlyIcon_5Eu5N",controlButtonOnlyIconRoundedSmallTheme:"Transformer-module_controlButtonOnlyIconRoundedSmallTheme_ZA-xU",bigOverlayButton:"Transformer-module_bigOverlayButton_OxS-t",glimmer:"Transformer-module_glimmer_vDFY4",pulse:"Transformer-module_pulse_lh7a-",bigOverlayButtonSelected:"Transformer-module_bigOverlayButtonSelected_XURUs",bigOverlayButtonDisabled:"Transformer-module_bigOverlayButtonDisabled_Rhhuh",bigOverlayButtonIcon:"Transformer-module_bigOverlayButtonIcon_GjO6b",incrementDecrementControl:"Transformer-module_incrementDecrementControl_CfA8b",incrementDecrementControlLightTheme:"Transformer-module_incrementDecrementControlLightTheme_9zl2W",incrementDecrementControlSmallTheme:"Transformer-module_incrementDecrementControlSmallTheme_9Rgzy",incrementDecrementControlExtraSmallTheme:"Transformer-module_incrementDecrementControlExtraSmallTheme_PbZBt",incrementDecrementButton:"Transformer-module_incrementDecrementButton_sMETt",incrementDecrementButtonLightTheme:"Transformer-module_incrementDecrementButtonLightTheme_1TfRV",incrementDecrementButtonSmallTheme:"Transformer-module_incrementDecrementButtonSmallTheme_8kYSG",incrementDecrementControlValue:"Transformer-module_incrementDecrementControlValue_Bx7yY",incrementDecrementControlValueSmallTheme:"Transformer-module_incrementDecrementControlValueSmallTheme_W03za",incrementControl:"Transformer-module_incrementControl_KmuZK",decrementControl:"Transformer-module_decrementControl_1Xcvp",disabledIncrementDecrementButton:"Transformer-module_disabledIncrementDecrementButton_WENvC",tooltip:"Transformer-module_tooltip_NF-Wl",selectDropDownContainer:"Transformer-module_selectDropDownContainer_P9GTI",selectDropDownDisplay:"Transformer-module_selectDropDownDisplay_F-vsU",selectDropDownDisabled:"Transformer-module_selectDropDownDisabled_ZUnFq",selectDropDownLabel:"Transformer-module_selectDropDownLabel_P7-kO",selectDropDownLabelContainer:"Transformer-module_selectDropDownLabelContainer_dEuD1",selectDropDownFlag:"Transformer-module_selectDropDownFlag_7HFaQ",proSparkle:"Transformer-module_proSparkle_jzRSo",selectDropDownLink:"Transformer-module_selectDropDownLink_5fZK7",selectDropDownList:"Transformer-module_selectDropDownList_V2HW3",selectDropDownListScrollContainer:"Transformer-module_selectDropDownListScrollContainer_7PkwU",selectDropDownItem:"Transformer-module_selectDropDownItem_-XZnv",selectDropDownItemLeft:"Transformer-module_selectDropDownItemLeft_8QRJ9",selectDropDownItemBottomStatic:"Transformer-module_selectDropDownItemBottomStatic_n3p0i",voiceCloneIcon:"Transformer-module_voiceCloneIcon_sVDjf",bottomDivider:"Transformer-module_bottomDivider_RKXqa",selectDropDownItemSelected:"Transformer-module_selectDropDownItemSelected_2LCG6",selectDropDownShowing:"Transformer-module_selectDropDownShowing_qDUJJ",dropDownButtonIcon:"Transformer-module_dropDownButtonIcon_0OqsW",selectOptionIcon:"Transformer-module_selectOptionIcon_kjJnB",dropDownAddIcon:"Transformer-module_dropDownAddIcon_3RnBW",selectDropdownItemPreview:"Transformer-module_selectDropdownItemPreview_1D6NM",selectDropDownItemPlayIcon:"Transformer-module_selectDropDownItemPlayIcon_mmvjG",transparentSelectInput:"Transformer-module_transparentSelectInput_HygXf",selectOptionContainer:"Transformer-module_selectOptionContainer_qml6Z",dropDownHeader:"Transformer-module_dropDownHeader_GxJNc",noMargin:"Transformer-module_noMargin_0oBkV",halfWidth:"Transformer-module_halfWidth_dX1EJ",fullWidth:"Transformer-module_fullWidth_xPldo",selectDropDownIcon:"Transformer-module_selectDropDownIcon_hwd-X",controlButtonsContainer:"Transformer-module_controlButtonsContainer_cPbvi",loadingIcon:"Transformer-module_loadingIcon_MF0b4",spin:"Transformer-module_spin_1QE-k",iconAndLabelRow:"Transformer-module_iconAndLabelRow_Vr58x",dropdownDirectInput:"Transformer-module_dropdownDirectInput_LdF7r",transformer:"Transformer-module_transformer_AgKxF",groupTransformer:"Transformer-module_groupTransformer_7N1m-",selectedLayer:"Transformer-module_selectedLayer_wuDY5",solidOutline:"Transformer-module_solidOutline_PI1ux",eligibleForDottedLineHover:"Transformer-module_eligibleForDottedLineHover_Au-OO",groupTransformerParent:"Transformer-module_groupTransformerParent_ZbEKU",transformerNode:"Transformer-module_transformerNode_fv9Ib",middleTransformerNode:"Transformer-module_middleTransformerNode_BsDVF",middleTransformerNodeActive:"Transformer-module_middleTransformerNodeActive_iPzKE",transformerBorder:"Transformer-module_transformerBorder_HEMEY",groupTransformerBorder:"Transformer-module_groupTransformerBorder_VaT21",transformerBackground:"Transformer-module_transformerBackground_8y2Mk",middleTransformerNodeContainer:"Transformer-module_middleTransformerNodeContainer_sUXSe",rotateNode:"Transformer-module_rotateNode_KRuRD",rotateNodeIcon:"Transformer-module_rotateNodeIcon_ZafZL",rotateNodeHandle:"Transformer-module_rotateNodeHandle_6jbaW",transformerNodeTopLeft:"Transformer-module_transformerNodeTopLeft_F1qT7",transformerNodeBottomRight:"Transformer-module_transformerNodeBottomRight_f6KCz",transformerNodeTopRight:"Transformer-module_transformerNodeTopRight_LmneV",transformerNodeBottomLeft:"Transformer-module_transformerNodeBottomLeft_MfqPg",transformerNodeMiddleRight:"Transformer-module_transformerNodeMiddleRight_ke6CJ",transformerNodeMiddleLeft:"Transformer-module_transformerNodeMiddleLeft_a-4mB",transformerNodeHideUntilHover:"Transformer-module_transformerNodeHideUntilHover_z-gsf",hide:"Transformer-module_hide_1bWy6",transformerText:"Transformer-module_transformerText_5ZCPt",selectedTransformer:"Transformer-module_selectedTransformer_7K06Q",transformerBackgroundOverlay:"Transformer-module_transformerBackgroundOverlay_lf8MM",transformerBackgroundOverlayTransparent:"Transformer-module_transformerBackgroundOverlayTransparent_dvw-C",presentUserTag:"Transformer-module_presentUserTag_BhJvX"},_4=_.createContext(null),w4=({containerRef:e,children:t})=>w.jsx(_4.Provider,{value:e,children:t});class b4 extends h.Component{constructor(e){super(e),i(this,"useTouch"),i(this,"touchStartHandler",(e=>{this.useTouch=!0,this.handleMouseDown(e)})),i(this,"mouseDownHandler",(e=>{this.useTouch||this.handleMouseDown(e)})),i(this,"contextualSelectLayer",(e=>{const{selectItem:t}=this.props;t("magicSubtitle"===e.type?{...e,frames:e.frames.allFrames}:e)})),i(this,"getIdOfOtherSelectedLayerPointerEventHappenedInside",(e=>{const{layer:t,selectedLayers:o,canvasContainerRef:a}=this.props;if(!a)return null;const{current:i}=a;if(t&&o.includes(t))return null;const{state:s}=sr(),n=i.getBoundingClientRect(),[r,l]=Eu(e),d=r-n.left,c=l-n.top,u=P3(s,bE()),m=[{x:d,y:c}];for(const p of u)if(o.some((e=>e.id===p.id))&&r4(p.points,m))return p.id;return null})),i(this,"handleMouseDown",(e=>{if(!CY(e))return;const{x:t,y:o,handleExitEditorClick:a,isBackgroundTransformer:i,isSelected:s,setDragging:n,handleMouseDownCallback:r}=this.props;if(CY(e)){null==r||r(e);const[a,l]=Eu(e);let d=!1;!i&&s&&(d=!0),n(!0),this.setState({dragging:!0,didDrag:!1,layerWasSelected:d,mouseStartX:a,mouseStartY:l,layerStartX:t,layerStartY:o}),this.addListeners()}a()})),i(this,"handleMouseUp",(e=>{const{handleTransformFinish:t,layer:o,isSelected:a,setDragging:i,handleMouseUpCallback:s}=this.props;null==s||s(e),i(!1);const{didDrag:n,layerWasSelected:r}=this.state;o&&!n&&r&&a&&("placeholder"===(null==o?void 0:o.type)&&eE("/studio/editor/replace"),this.props.handleDoubleClick&&this.props.handleDoubleClick()),CY(e)&&(this.removeListeners(),this.setState({dragging:!1,didDrag:!1,layerWasSelected:!1,mouseStartX:void 0,mouseStartY:void 0,layerStartX:void 0,layerStartY:void 0}),t("drag"),this.props.showSnapLines({}))})),i(this,"handleMouseMove",(e=>{const{isSelected:t,isBackgroundTransformer:o,width:a,height:i,rotation:s,handleTransform:n,shiftIsBeingPressed:r}=this.props,{dragging:l,didDrag:d,mouseStartX:c,mouseStartY:u,layerStartX:m=0,layerStartY:p=0}=this.state;if(!XN(sr().state)&&tR(),!l)return;if(e.which>1)return;if(!t)return;if(o)return;const[h,g]=Eu(e),f=h-(c??0),y=g-(u??0);let v=m+f,_=p+y;r&&(Math.abs(f)>Math.abs(y)&&(_=p??0),Math.abs(f)<Math.abs(y)&&(v=m??0));let w={x:v,y:_,width:a,height:i};WN()&&void 0!==s&&s%90==0&&(w=y4(w,s));n(w,"drag",{height:0,width:0,x:w.x-m,y:w.y-p}),!d&&(Math.abs(f)>0||Math.abs(y)>0)&&this.setState({didDrag:!0}),e.preventDefault()})),i(this,"getStyles",(()=>{const{x:e,y:t,width:o,height:a,rotation:i,isEditing:s,isBackgroundTransformer:n,zIndex:r,backgroundColor:l}=this.props;return{top:t,left:e,width:o,height:a,transform:`rotate(${i}deg)`,cursor:!n&&s?"text":"pointer",zIndex:r,backgroundColor:l??"transparent"}})),i(this,"getPresenceStyles",(e=>{var t;const{presence:o,x:a,y:i,width:s,height:n}=this.props;return{border:`2px solid ${null==(t=o[e])?void 0:t.color}`,top:i,left:a,width:s,height:n}})),i(this,"handleContextMenu",(e=>{const{isBackgroundTransformer:t,layer:o,groupId:a}=this.props;if(t)return void g3(e);let i="";const s=this.getIdOfOtherSelectedLayerPointerEventHappenedInside(e);s?i=s:a?(this.contextualSelectLayer({id:a,type:"group"}),i=a):o&&(this.contextualSelectLayer({id:o.id,type:"layer"}),i=o.id),m3(e,i)})),this.useTouch=!1,this.state={dragging:!1,didDrag:!1,layerWasSelected:!1,mouseStartX:0,mouseStartY:0,layerStartX:0,layerStartY:0}}componentDidUpdate(e){const{isGhostTransformer:t,handleTransform:o,mIGhostLayerAbsolutePosition:a}=this.props;if(t&&WN()){const t=!s.isEqual(a,null==e?void 0:e.mIGhostLayerAbsolutePosition),i=y4(a,0,t);t&&o(i,"drag",{height:0,width:0,x:0,y:0})}}componentWillUnmount(){this.removeListeners()}addListeners(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp)}removeListeners(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp)}renderPresentUserSelection(){const{presentUser:e,presentUserId:t}=this.props;return e&&e!==t?w.jsx("div",{style:this.getPresenceStyles(e)}):null}render(){const{groupId:e,height:t,isBackgroundTransformer:o,isCollaborating:a,isDraggingGlobal:i,isSelectedLayerInSameGroup:s,isSelected:n,solidOutline:r,presence:l,width:d}=this.props;if(e&&!s)return null;const c=!o&&!n&&!i||this.state.dragging,u=mt(v4.transformer,{[v4.transformerBackground]:o,[v4.selectedLayer]:n,[v4.solidOutline]:r,[v4.eligibleForDottedLineHover]:c&&!r});return w.jsx(E3,{onContextMenu:this.handleContextMenu,children:w.jsxs("div",{style:this.getStyles(),className:u,onMouseDown:this.mouseDownHandler,onTouchStart:this.touchStartHandler,onDoubleClick:this.props.handleDoubleClick,"data-cy":"drag-handler",children:[w.jsx("div",{className:v4.transformerText,children:this.props.transformerText}),e&&w.jsx("div",{style:{width:d,height:t},className:v4.groupTransformerBorder}),a&&l&&this.renderPresentUserSelection()]})})}}const T4=g.connect(((e,t)=>{var o;const a=t.groupId&&(null==(o=e.studio.groups[t.groupId])?void 0:o.layers.some((t=>{var o;return(null==(o=e.studio.selectedItem)?void 0:o.id)===t.id})));return{isDraggingGlobal:e.studio.isDragging,isEditing:t.layer&&Fg(e,t.layer.id),isSelectedLayerInSameGroup:a,shiftIsBeingPressed:e.studioLocal.shiftIsBeingPressed,isCollaborating:e.studio.isCollaborating,presence:e.studio.presence,presentUserId:e.studio.presentUserId,mIGhostLayerAbsolutePosition:Ug(e),selectedLayers:gR(e)}}),(e=>ye({selectItem:l_,setDragging:_S,showSnapLines:Xv},e)))(function(e){return t=>w.jsx(_4.Consumer,{children:o=>w.jsx(e,{...t,canvasContainerRef:o})})}(b4));class x4 extends h.Component{constructor(e){super(e),i(this,"globalHandlersAdded",!1),i(this,"cleanupGlobalHandlers",(()=>{this.globalHandlersAdded&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp),this.globalHandlersAdded=!1)})),i(this,"handleMouseDown",(e=>{const{x:t,y:o,width:a,height:i,setRotating:s,handleMouseDownCallback:n}=this.props;null==n||n(e);const r=document.getElementById("canvas-container");if(!r)return;const l=r.getBoundingClientRect(),d={x:l.left+t+a/2,y:l.top+o+i/2};CY(e)&&(s(!0),this.setState({rotating:!0,startVector:d}))})),i(this,"handleMouseUp",(e=>{const{handleTransformFinish:t,setRotating:o,handleMouseUpCallback:a}=this.props;null==a||a(e),CY(e)&&(o(!1),this.setState({rotating:!1}),t("rotate"))})),i(this,"handleMouseMove",(e=>{const{handleTransform:t}=this.props,{rotating:o,startVector:a}=this.state;if(!o)return;if(e.which>1)return;const[i,s]=Eu(e);let n=(yY(a,{x:i,y:s})-90)%360;if(WN()){const e=(r=n)-(l=45)*Math.floor(r/l);if(e>=41){n+=45-e}else e<=4&&(n-=e);(Math.abs(n)<1||Math.abs(n)>359)&&(n=0)}var r,l;t({rotation:n,x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height},"rotate",{x:0,y:0,width:0,height:0}),e.preventDefault()})),i(this,"getStyles",(()=>{const{x:e,y:t,width:o,height:a,rotation:i=0}=this.props,s=e+o/2,n=t+a/2,r=a/2+20,l=i*Math.PI/180;let d=s-r*Math.sin(l),c=n+r*Math.cos(l);return d-=10,c-=10,{width:20,height:20,top:c,left:d}})),this.state={rotating:!1,startVector:{x:0,y:0}}}componentDidUpdate(e,t){const{rotating:o}=this.state;o&&!t.rotating?(document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp),this.globalHandlersAdded=!0):!o&&t.rotating&&this.cleanupGlobalHandlers()}componentWillUnmount(){this.cleanupGlobalHandlers()}render(){return w.jsx("div",{style:this.getStyles(),"data-cy":"rotate-handler-node",className:[v4.transformer,v4.transformerNode,v4.rotateNode,v4.selectedTransformer].join(" "),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onTouchStart:this.handleMouseDown,onTouchEnd:this.handleMouseUp,children:w.jsx(At,{className:v4.rotateNodeIcon})})}}const S4=g.connect(void 0,(e=>ye({setRotating:uS},e)))(x4);class E4 extends h.Component{constructor(e){super(e),i(this,"presenceRef"),i(this,"transformerContainerRef"),i(this,"handleMouseDownCallback",(e=>{const{layer:t,handleMouseDownCallback:o}=this.props;"text"===(null==t?void 0:t.type)&&LE(t.id,{beingTransformed:!0}),o&&o(e)})),i(this,"handleMouseUpCallback",(e=>{const{layer:t,handleMouseUpCallback:o}=this.props;"text"===(null==t?void 0:t.type)&&LE(t.id,{beingTransformed:!1}),o&&o(e)})),i(this,"handleMouseDown",((e,{nodePosition:t})=>{const{x:o,y:a,width:i,height:s,handleExitEditorClick:n,canvasX:r,canvasY:l,handleMouseDownCallback:d,isBeingInlineCropped:c}=this.props;d&&d(e),e.stopPropagation();const[u,m]=Eu(e);CY(e)&&(this.setIsResizing(!0),this.setState({resizing:!c,mouseStartX:u,mouseStartY:m,layerStartX:null!=o?o:r,layerStartY:null!=a?a:l,layerStartWidth:i,layerStartHeight:s,...!c&&{activeNodePosition:t}}),this.props.setNodePosition&&this.props.setNodePosition(t)),n()})),i(this,"handleMouseUp",(e=>{const{handleTransformFinish:t,handleMouseUpCallback:o}=this.props;CY(e)&&(this.setIsResizing(!1),this.setState({resizing:!1,mouseStartX:void 0,mouseStartY:void 0,layerStartX:void 0,layerStartY:void 0,layerStartWidth:void 0,layerStartHeight:void 0,activeNodePosition:void 0}),t("resize"),o&&o(e),this.props.setNodePosition&&this.props.setNodePosition(void 0))})),i(this,"handleMouseMove",(e=>{e.preventDefault();const{resizing:t}=this.state;e.which>1||t&&this.handleMouseMoveForResizing(e)})),i(this,"handleMouseMoveForResizing",(e=>{const{handleTransform:t,layers:o,lockAspectRatio:a,isBackgroundTransformer:i,canvasWidth:s,canvasHeight:n,shiftIsBeingPressed:r,forMovingZoomControls:l,rotation:d=0,textTemp:c,layer:u,hasPositionAffectingKeyframes:m}=this.props,{mouseStartX:p,mouseStartY:h,layerStartX:g=0,layerStartY:f=0,layerStartWidth:y=0,layerStartHeight:v=0,activeNodePosition:_}=this.state;if(!_)return;if(!s||!n)return;let w=g,b=f,T=y,x=v;const S=g+y/2,E=f+v/2,[I,C]=Eu(e),k=I-(p||0),A=C-(h||0),j=Math.atan2(A,k),N=fY(k,A),R=j-vY(d||0),P=N*Math.cos(R),D=N*Math.sin(R),O={width:y||0,height:v||0,centerX:S,centerY:E,rotateAngle:d||0},L=["middleLeft","middleRight"].includes(_);let F=0;i||L||!a&&!r&&"text"!==(null==u?void 0:u.type)||(F=(y||0)/(v||1));let M=15,U=15;if((null==u?void 0:u.lockAspectRatio)&&(null==u?void 0:u.position)){const e=parseFloat(u.position.width)/100*s,t=parseFloat(u.position.height)/100*n;e>t?M=e*U/t:U=t*M/e}if(i){const e=Ej(o),t=(e.right-e.left)/100*s,a=(e.bottom-e.top)/100*n;let i,r;switch(_){case"topLeft":i=s-e.right/100*s,r=n-e.bottom/100*n;break;case"topRight":i=e.left/100*s,r=n-e.bottom/100*n;break;case"bottomLeft":i=s-e.right/100*s,r=e.top/100*n;break;case"bottomRight":i=e.left/100*s,r=e.top/100*n;break;case"middleLeft":i=s-e.right/100*s,r=0;break;case"middleRight":i=e.left/100*s,r=0;break;default:i=0,r=0}t>M&&(M=t+i),a>U&&(U=a+r)}const B=xY(_,O,P,D,F,M,U);w=B.position.centerX-B.size.width/2,b=B.position.centerY-B.size.height/2,T=B.size.width,x=B.size.height;let V={x:w,y:b,width:T,height:x};if(m&&(V.x=S-T/2,V.y=E-x/2),i||l||!WN()||(d||0)%90!=0||(V=f4(V,d,_)),u&&am(u)&&L){w=V.x,b=V.y,T=V.width,x=V.height;const e=c||u.text||"",t=iJ(u.baseWidth,y),o=(u.fontSize||1)/t,a=(u.lineHeight||1)*o,{textWithLineBreaks:i,minWidth:s}=rJ(u,T,e,o),n=i.split("\n").length*a;T=Math.max(s,T),x=Math.max(s,n);const{width:r}=this.props;if(T===r)return;if(d){O.height=x;const e=xY(_,O,P,D,F,M,U);w=e.position.centerX-T/2,b=e.position.centerY-x/2}LE(u.id,{textTemp:i,fontSizingTemp:{fontSize:o,baseWidth:T,baseHeight:x}}),V={x:w,y:b,width:T,height:x}}const W={x:V.x-g,y:V.y-f,width:V.width-y,height:V.height-v};t({...V,rotation:d},"resize",W);const G=o.map((e=>e.id)),H={};G.forEach((e=>{H[e]={inlineCropAspectRatio:null}})),FE(H)})),i(this,"getNodeSize",(()=>{const{nodeSize:e,width:t,height:o}=this.props;let a=16;try{(t<80||o<80)&&(a=12),(t<50||o<50)&&(a=9)}catch(IGe){console.error("No width and height found for layer")}let i=e??a,s=e??a;return zg()&&(i=22,s=22),{nodeWidth:i,nodeHeight:s}})),i(this,"getNodeStyles",(e=>{const{props:t}=this,{cornerBeingManipulated:o,x:a,y:i,width:s,height:n,layer:r,isBackgroundTransformer:l,isSelected:d,isBoxSelected:c,hasPositionAffectingKeyframes:u}=t,m=t.rotation||0;let{nodeWidth:p,nodeHeight:h}=this.getNodeSize();(p>s||h>n)&&(p/=2,h/=2);const g={width:p,height:h,display:"",zIndex:7};u&&(g.backgroundColor="white",g.borderColor="#0083E2"),(l||d||c||"ghost"===(null==r?void 0:r.id))&&!o||(g.display="none");let f,y,v=a,_=i;const w=m*Math.PI/180,b=a+s/2,T=i+n/2;switch(e){case"topLeft":return f=(a-b)*Math.cos(w)-(i-T)*Math.sin(w)+b,y=(a-b)*Math.sin(w)+(i-T)*Math.cos(w)+T,v=f-p/2,_=y-h/2,{top:_,left:v,...g};case"topRight":return v+=s,f=(v-b)*Math.cos(w)-(_-T)*Math.sin(w)+b,y=(v-b)*Math.sin(w)+(_-T)*Math.cos(w)+T,v=f-p/2,_=y-h/2,{top:_,left:v,...g};case"bottomLeft":return _+=n,f=(v-b)*Math.cos(w)-(_-T)*Math.sin(w)+b,y=(v-b)*Math.sin(w)+(_-T)*Math.cos(w)+T,v=f-p/2,_=y-h/2,{top:_,left:v,...g};case"bottomRight":return v+=s,_+=n,f=(v-b)*Math.cos(w)-(_-T)*Math.sin(w)+b,y=(v-b)*Math.sin(w)+(_-T)*Math.cos(w)+T,v=f-p/2,_=y-h/2,{top:_,left:v,...g};case"middleLeft":{if(_+=n/2,h=n-p,h<p&&(h=n),!zg()&&h>n){const e=p/h;h=n,p=n*e}f=(v-b)*Math.cos(w)-(_-T)*Math.sin(w)+b,y=(v-b)*Math.sin(w)+(_-T)*Math.cos(w)+T,v=f-p/2,_=y-h/2;let e=0;return zg()&&(e=p/4),{top:_,left:v-e,...g,height:h,width:p+e+e,transform:`rotate(${m}deg)`,backgroundColor:void 0}}case"middleRight":{if(v+=s,_+=n/2,h=n-p,h<p&&(h=n),!zg()&&h>n){const e=p/h;h=n,p=n*e}f=(v-b)*Math.cos(w)-(_-T)*Math.sin(w)+b,y=(v-b)*Math.sin(w)+(_-T)*Math.cos(w)+T,v=f-p/2,_=y-h/2;let e=0;return zg()&&(e=p/4),{top:_,left:v-e,...g,height:h,width:p+e+e,transform:`rotate(${m}deg)`,backgroundColor:void 0}}default:return g}})),i(this,"getNodeClassNames",(e=>{const{isSelected:t,isBackgroundTransformer:o,width:a,height:i,layer:s}=this.props,{activeNodePosition:n}=this.state,{nodeWidth:r,nodeHeight:l}=this.getNodeSize();let d=`${v4.transformerNode} `;switch(e){case"topLeft":d+=v4.transformerNodeTopLeft;break;case"topRight":d+=v4.transformerNodeTopRight;break;case"bottomLeft":d+=v4.transformerNodeBottomLeft;break;case"bottomRight":d+=v4.transformerNodeBottomRight;break;case"middleLeft":d=`${v4.middleTransformerNodeContainer} ${v4.transformerNodeMiddleLeft}`;break;case"middleRight":d=`${v4.middleTransformerNodeContainer} ${v4.transformerNodeMiddleRight}`;break;default:throw new Error("Improper NodePosition supplied")}if((o||t)&&(d+=` ${v4.selectedTransformer}`),s&&am(s)){const t=2*r,o=2.5*l,s=a<t||i<o,c=i<t,u=!["topLeft","middleRight"].includes(e)&&s,m=n&&n===e;(n?!m:u)&&(d+=c||n&&!m?` ${v4.hide}`:` ${v4.transformerNodeHideUntilHover}`)}return d})),i(this,"getOverlayStyles",(e=>{const{canvasBackground:t}=this.props;let{x:o,y:a,canvasX:i,canvasY:s,canvasWidth:n,canvasHeight:r,width:l,height:d}=this.props;o=Math.floor(o),a=Math.floor(a),i=Math.floor(i),s=Math.floor(s),l=Math.ceil(l),d=Math.ceil(d),n=null==n?n:Math.ceil(n),r=null==r?r:Math.ceil(r);const{activeNodePosition:c}=this.state,u="#202020";let m,p=t.includes("#")?t:void 0;if(!c||!n||!r)return{};switch(e){case"top":if(a>s&&(p=u),!c.includes("top"))return{};m={left:o>i?i:o,top:a>s?s:a,width:l>n?l:n,height:Math.abs(d-r),background:p};break;case"left":if(o>i&&(p=u),!c.includes("Left"))return{};m={left:o>i?i:o,top:"topLeft"!==c&&a>s&&o>i?s:a,width:Math.abs(l-n),height:"topLeft"===c||r<d?d:r,background:p};break;case"bottom":if(d<r&&(p=u),!c.includes("bottom"))return{};m={left:o,top:r>d?d+s:r+s,height:Math.abs(d-r),width:"bottomLeft"===c||n<l?l:n,background:p};break;case"right":if(l<n&&(p=u),!c.includes("Right"))return{};m={left:n>l?l+i:n+i,top:a,width:Math.abs(l-n),height:d,background:p};break;default:throw new Error("Improper NodePosition supplied")}return{left:`${m.left}px`,top:`${m.top}px`,width:`${m.width}px`,height:`${m.height}px`,background:m.background}})),i(this,"getPresentUserStyles",(e=>{var t,o;const{x:a,y:i,width:s,height:n,rotation:r,presence:l}=this.props,d=a+s/2,c=i+n/2,u=n/2+20,m=r*Math.PI/180;let p=d+u*Math.sin(m);const h=c-u*Math.cos(m);p-=s/2;const g=null==(t=this.presenceRef.current)?void 0:t.getBoundingClientRect(),f=(null==g?void 0:g.height)&&(null==g?void 0:g.height)>25?g.height/2:0;return{color:null==(o=l[e])?void 0:o.color,margin:"auto",top:h-f,left:p,padding:"2px",width:s,transform:`rotate(${r}deg)`}})),i(this,"handleContextMenu",(e=>{const{layer:t}=this.props;t?m3(e,t.id):g3(e)})),i(this,"renderTransformerNodes",(()=>{const{visibleNodes:e,hasPositionAffectingKeyframes:t}=this.props,{activeNodePosition:o}=this.state;return e.map((e=>{const a=["middleLeft","middleRight"].includes(e),i=this.getNodeStyles(e),s=o===e;return w.jsx("div",{className:this.getNodeClassNames(e),"data-cy":`${e}-transformer-node`,style:i,onTouchStart:t=>this.handleMouseDown(t,{nodePosition:e}),onTouchEnd:e=>this.handleMouseUp(e),onMouseDown:t=>this.handleMouseDown(t,{nodePosition:e}),onMouseUp:e=>this.handleMouseUp(e),children:a&&w.jsx("div",{className:s?v4.middleTransformerNodeActive:v4.middleTransformerNode,style:{backgroundColor:t?"white":void 0,borderColor:t?"#0083E2":void 0,width:Number(i.width)/(zg()?2.5:1.5),height:Math.min(Number(i.width)*(zg()?1:1.5),Number(i.height))}})},e)}))})),i(this,"renderDragHandler",(()=>{var e;const{isBoxSelected:t,isSelected:o,layer:a,groupId:i,presence:s}=this.props,n=Zp(s,null==a?void 0:a.id);return w.jsx(T4,{backgroundColor:this.props.backgroundColor,groupId:i,handleDoubleClick:this.props.handleDoubleClick,handleExitEditorClick:this.props.handleExitEditorClick,handleMouseDownCallback:this.handleMouseDownCallback,handleMouseUpCallback:this.handleMouseUpCallback,handleTransform:this.props.handleTransform,handleTransformFinish:this.props.handleTransformFinish,height:this.props.height,isBackgroundTransformer:!!this.props.isBackgroundTransformer,isGhostTransformer:"ghost"===(null==(e=this.props.layer)?void 0:e.id),isSelected:o,isBoxSelected:t,layer:this.props.layer,presentUser:n,rotation:this.props.rotation,solidOutline:this.props.solidOutline,transformerText:this.props.transformerText,viewOnly:this.props.viewOnly,width:this.props.width,x:this.props.x,y:this.props.y,zIndex:this.props.zIndex})})),this.state={resizing:!1},this.presenceRef=h.createRef(),this.transformerContainerRef=h.createRef()}componentDidUpdate(e,t){const{resizing:o}=this.state;o&&!t.resizing?(document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp)):!o&&t.resizing&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp))}componentWillUnmount(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp),this.setIsResizing(!1)}setIsResizing(e){const{layer:t,setResizing:o}=this.props;if(o(e),t){const o={beingTransformed:e};LE(t.id,o)}}renderPresentUserSelection(){var e;const{layer:t,presence:o,presentUserId:a}=this.props,i=Zp(o,null==t?void 0:t.id);return i&&i!==a?w.jsx("div",{ref:this.presenceRef,className:v4.presentUserTag,style:this.getPresentUserStyles(i),children:null==(e=o[i])?void 0:e.name}):null}render(){const{canvasBackground:e,groupId:t,isBackgroundTransformer:o,isCollaborating:a,isSelected:i,presence:s,selectedItemIsALayer:n,layerIsDeselectedInGroup:r}=this.props;return this.props.forMovingZoomControls?w.jsxs(w.Fragment,{children:[this.renderTransformerNodes(),this.renderDragHandler()]}):!t||n||r?w.jsx(E3,{onContextMenu:this.handleContextMenu,children:w.jsxs("div",{onDragEnter:w3,onDoubleClick:()=>{o||this.props.layer&&(this.props.layer.type!==zl.Image&&this.props.layer.type!==zl.Video||this.props.setIsInlineCropping(this.props.layer.id,"Double Click"))},ref:this.transformerContainerRef,children:[o&&gY.map((t=>w.jsx("div",{style:this.getOverlayStyles(t),className:v4.transformerBackgroundOverlay+(e.includes("#")?"":` ${v4.transformerBackgroundOverlayTransparent}`)},`transformerOverlay${t}`))),!o&&i&&!this.props.isBeingInlineCropped&&w.jsx(S4,{handleTransform:this.props.handleTransform,handleTransformFinish:this.props.handleTransformFinish,handleMouseDownCallback:this.handleMouseDownCallback,handleMouseUpCallback:this.handleMouseUpCallback,height:this.props.height,width:this.props.width,x:this.props.x,y:this.props.y,rotation:this.props.rotation}),!this.props.isBeingInlineCropped&&this.renderDragHandler(),a&&s&&this.renderPresentUserSelection(),!this.props.isBeingInlineCropped&&this.renderTransformerNodes()]})}):null}}const I4=g.connect(((e,t)=>{var o,a,i,s,n,r,l,d,c;const{scenes:u}=e.studio,m=t.layer?null==(o=Object.entries(e.studio.groups).find((([e,o])=>{var a;return o.layers.map((e=>e.id)).includes((null==(a=t.layer)?void 0:a.id)||"")})))?void 0:o[0]:null,p=m&&t.layer&&(null==(i=null==(a=e.studio.groups[m])?void 0:a.layers.find((e=>{var o;return e.id===(null==(o=t.layer)?void 0:o.id)})))?void 0:i.deselected),{textTemp:h,borderRadiusTemp:g,textPaddingTemp:f}=Lg(e,(null==(s=t.layer)?void 0:s.id)||""),y=!(!g&&"number"!=typeof f),v=!m&&yI((null==(n=t.layer)?void 0:n.id)||"",vd.POSITION),_=!m&&yI((null==(r=t.layer)?void 0:r.id)||"",vd.ZOOM);return{canvasBackground:u[0].background,canvasHeight:e.studio.height,canvasWidth:e.studio.width,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY,groupId:m,layerIsDeselectedInGroup:p,groups:e.studio.groups,isBeingInlineCropped:(null==(d=e.studioLocal.layerTempValues[(null==(l=t.layer)?void 0:l.id)||""])?void 0:d.isBeingInlineCropped)||!1,layers:u[0].layers,cornerBeingManipulated:y,selectedItem:e.studio.selectedItem,selectedItemIsALayer:"layer"===(null==(c=e.studio.selectedItem)?void 0:c.type),shiftIsBeingPressed:e.studioLocal.shiftIsBeingPressed,isCollaborating:e.studio.isCollaborating,presence:e.studio.presence,presentUserId:e.studio.presentUserId,textTemp:h,hasPositionKeyframes:v,hasZoomKeyframes:_,hasPositionAffectingKeyframes:v||_}}),(e=>ye({setResizing:cS,setStudioDragDropActive:__,setIsInlineCropping:p_},e)))(E4);class C4 extends h.Component{constructor(e){super(e),i(this,"handleMouseDown",((e,t)=>{const{x:o,y:a,width:i,height:s,handleExitEditorClick:n,layer:r,canvasHeight:l}=this.props,{lineWidth:d}=r,[c,u,m,p]=IY(r.linePointStartCorner,i,s,parseFloat(d)/100*l),[h,g]=Eu(e);CY(e)&&this.setState({resizing:!0,mouseStartX:h,mouseStartY:g,nodePosition:t,x:o,y:a,width:i,height:s,start:{x:o+c,y:a+u},end:{x:o+m,y:a+p},initialStartCorner:r.linePointStartCorner}),n()})),i(this,"handleMouseUp",(e=>{const{handleTransformFinish:t}=this.props;CY(e)&&(this.setState({resizing:!1,mouseMove:!1}),t())})),i(this,"calculateNewPosition",((e,t,o=0,a=0)=>{const{nodePosition:i,start:s,end:n,x:r,y:l,width:d,height:c,initialStartCorner:u}=this.state;let m=r,p=l,h=d,g=c;const f=(e=>{const t={topLeft:e[0]<=e[2]&&e[1]<=e[3],bottomLeft:e[0]<=e[2]&&e[1]>=e[3],topRight:e[0]>=e[2]&&e[1]<=e[3],bottomRight:e[0]>=e[2]&&e[1]>=e[3]};return hY.find((e=>!0===t[e]))||"topLeft"})([s.x,s.y,n.x,n.y]);if(this.setState({linePointStartCorner:f}),"topLeft"===u)switch(i){case"start":m=r+o,p=l+a,h=d-o,g=c-a,this.setState({start:{x:m,y:p}});break;case"end":h=d+o-e,g=c+a-e,this.setState({end:{x:h+r,y:g+l}})}if("bottomRight"===u)switch(i){case"end":m=r+o,p=l+a,h=d-o-t,g=c-a-t,this.setState({end:{x:m,y:p}});break;case"start":h=d+o-e,g=c+a-e,this.setState({start:{x:h+r,y:g+l}})}if("bottomLeft"===u)switch(i){case"start":m=r+o,p=l+a,h=d-o,g=c-a-e,this.setState({start:{x:m,y:g+p+a}});break;case"end":h=d+o-e,g=c+a,this.setState({end:{x:h+r,y:p+a}})}if("topRight"===u)switch(i){case"start":m=r+o,p=l+a,h=d-o-e,g=c+a,this.setState({start:{x:h+m+o,y:p}});break;case"end":m=r+o,h=d+o,g=c+a-e,this.setState({end:{x:m,y:g+l}})}return{x:m,y:p,width:h,height:g,linePointStartCorner:f}})),i(this,"handleMouseMove",(e=>{const{handleTransform:t,layer:o,canvasHeight:a}=this.props,{mouseStartX:i,mouseStartY:s,resizing:n,start:r,end:l,nodePosition:d}=this.state;if(!n)return;if(e.which>1)return;this.setState({mouseMove:!0});const[c,u]=Eu(e),{lineWidth:m}=o,p=parseFloat(m)/100*a,h=p/2,g=c-i,f=u-s,y=this.calculateNewPosition(p,h,g,f),{linePointStartCorner:v}=y;let _=y.x,w=y.y,b=y.width,T=y.height,x=[];switch(v){case"topLeft":_=r.x+h,w=r.y+h,b=l.x-r.x+h,T=l.y-r.y+h,x=[0,0,b-h,T-h];break;case"topRight":_=l.x+h,w=r.y+h,b=r.x-l.x+h,T=l.y-r.y+h,x=[b-h,0,0,T-h];break;case"bottomLeft":_=r.x+h,w=l.y+h,b=l.x-r.x+h,T=r.y-l.y+h,x=[0,T-h,b-h,0];break;case"bottomRight":_=l.x+h,w=l.y+h,b=r.x-l.x+h,T=r.y-l.y+h,x=[b-h,T-h,0,0]}const[S,E,I,C]=x,k=Math.atan2(I-S,C-E)/Math.PI*180;let A="";const j=WN();if(j){const e=((e,t,o,a,i,s,n,r,l,d)=>{let c=i,u=s,m=n,p=r,h=l;const g=a=>"start"===e?o[a]:t[a],f=g("x"),y=g("y");let v=a;const _=v-45*Math.floor(v/45);_>=41?v+=45-_:_<=4&&(v-=_);(Math.abs(v)<1||Math.abs(v)>359)&&(v=0);let w="";switch(v){case 0:c=f+d,m=d,h=[0,0,0,p-d],w="vertical";break;case 90:u=y+d,p=d,h=[0,0,m-d,0],w="horizontal";break;case-90:u=y+d,p=d,h=[m-d,0,0,0],w="horizontal";break;case 180:case-180:c=f+d,m=d,h=[0,p-d,0,0],w="vertical"}return{x:c,y:u,width:m,height:p,points:h,lineRightAngle:w}})(d,r,l,k,_,w,b,T,x,h);_=e.x,w=e.y,b=e.width,T=e.height,x=e.points,A=e.lineRightAngle}let N={x:_-h,y:w-h,width:b+h,height:T+h,points:x,lineResizing:!0,linePointStartCorner:v,lineRightAngle:A,lineWidth:p};j&&(N=(e=>{const{linePointStartCorner:t,lineWidth:o,lineRightAngle:a}=e,{x:i,y:s,width:n,height:r}=f4(e),l=IY(t,n,r,o);return{...e,x:i,y:s,width:"vertical"===a||n<o?o:n,height:"horizontal"===a||r<o?o:r,points:l}})(N)),t(N),e.preventDefault()})),i(this,"getNodeStyles",(e=>{const{x:t,y:o,width:a,height:i,selectedLayerId:s,layer:n,canvasHeight:r,boxSelectedIds:l}=this.props,{linePointStartCorner:d,mouseMove:c}=this.state;let u=18,m=18;zg()&&(u=22,m=22);const p={width:u,height:m},h=s===n.id,{lineWidth:g}=n,f=parseFloat(g)/100*r,y=f/2,[v,_,w,b]=IY(c?d:n.linePointStartCorner,a,i,f);switch(h||l[n.id]||(p.display="none"),e){case"start":return{left:t+v+y-u/2,top:o+_+y-m/2,...p};case"end":return{left:t+w+y-u/2,top:o+b+y-m/2,...p};default:return p}})),this.state={resizing:!1,start:{x:0,y:0},end:{x:0,y:0},nodePosition:"",linePointStartCorner:"topLeft"}}componentDidMount(){const{x:e,y:t,width:o,height:a,layer:i}=this.props,{linePointStartCorner:s}=i;this.setState({x:e,y:t,width:o,height:a,linePointStartCorner:s||"topLeft",mouseMove:!1})}componentDidUpdate(e,t){this.state.resizing&&!t.resizing?(document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp)):!this.state.resizing&&t.resizing&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp))}render(){var e;const{selectedLayerId:t,layer:o,groups:a,boxSelectedIds:i,presence:s}=this.props,n=t===o.id,r=o?null==(e=Object.entries(a).find((([e,t])=>t.layers.map((e=>e.id)).includes(o.id))))?void 0:e[0]:null,l=Zp(s,null==o?void 0:o.id);return w.jsxs("div",{style:{display:"block"},children:[w.jsx(T4,{groupId:r,handleExitEditorClick:this.props.handleExitEditorClick,handleMouseDownCallback:this.props.handleMouseDownCallback,handleMouseUpCallback:this.props.handleMouseUpCallback,handleTransform:this.props.handleTransform,handleTransformFinish:this.props.handleTransformFinish,height:this.props.height,isBackgroundTransformer:this.props.isBackgroundTransformer,isSelected:o.id===t,isBoxSelected:!!i[o.id],layer:this.props.layer,presentUser:l,rotation:this.props.rotation,viewOnly:this.props.viewOnly,width:this.props.width,x:this.props.x,y:this.props.y}),["start","end"].map(((e,t)=>w.jsx("div",{className:`${v4.transformerNode} ${n?v4.selectedTransformer:""}`,style:this.getNodeStyles(e),onTouchStart:t=>this.handleMouseDown(t,e),onTouchEnd:this.handleMouseUp,onMouseDown:t=>this.handleMouseDown(t,e),onMouseUp:this.handleMouseUp},t)))]})}}const k4=g.connect((e=>{var t;return{selectedLayerId:(null==(t=e.studio.selectedItem)?void 0:t.id)||"",boxSelectedIds:e.studioLocal.boxSelectedIds,groups:e.studio.groups,presence:e.studio.presence}}))(C4),A4=_.memo((({layer:e,width:t,height:o,videoWidth:a,videoHeight:i,keyframeChannels:s})=>{const{elementPool:n}=mE(),r=h.useRef(),l=h.useRef(null),d=_E(),c=tl((t=>{var o;return null==(o=t.studioLocal.layerTempValues[e.id])?void 0:o.filters}),ol),u=tl((t=>Bg(t,e.id))),m=h.useMemo((()=>{const n=cI(e,d,u),r=g1(n,[t,o],[a,i],qS(e)),{width:l,height:m}=f1([t,o],[a,i]),p=o1(r,l,m);return h1({...e,filters:c||e.filters},!1,!1,p,t,o,s,d)}),[e,t,o,a,i,d,u,s,c]),p=il();return h.useEffect((function(){return r.current=new MutationObserver((t=>{for(const o of t)"childList"===o.type&&l.current&&LE(e.id,{layerRef:l.current.children[0]})})),()=>{var e;null==(e=r.current)||e.disconnect()}}),[p,e.id]),w.jsx(s2,{layer:e,style:m,children:w.jsx("div",{id:n.getDomIdFromLayerId(e.id),"data-cy":"ep-container",ref:t=>{var o,a;l.current=t,(null==t?void 0:t.children[0])&&LE(e.id,{layerRef:t.children[0]}),t?null==(o=r.current)||o.observe(t,{childList:!0}):null==(a=r.current)||a.disconnect()}})})}));A4.displayName="EPContainer";class j4 extends h.Component{constructor(e){super(e),i(this,"resizeLockRatioLayer",(e=>{const{layer:t,resizeLayer:o,convertPositionToPercent:a=qE,convertSizeToPercent:i=zE}=this.props;this.setLayerAbsolutePosition({...e});const{xPercent:s,yPercent:n}=a(e.x,e.y),{widthPercent:r,heightPercent:l}=i(e.width,e.height);LE(t.id,{positionTemp:null}),o(t,s,n,r,l)})),i(this,"updateLayerAnimationPosition",(e=>{s.isEqual(this.state.layerAnimationPosition,e)||this.setState({layerAnimationPosition:e||null})})),i(this,"rotateGroupedLayer",(()=>{const{layerAbsolutePosition:e}=this.state;if(!this.props.groupInfo||!e)return;const{groupInitialPosition:t,groupAbsolutePosition:o}=this.props.groupInfo,a=this.getAbsolutePositionFromLayer();if(!a)return;const{newX:i,newY:s,layerRotation:n}=EY(a,o,t);this.setLayerAbsolutePosition({...e,x:i,y:s,rotation:n})})),i(this,"resizeGroupedLayer",(()=>{const{layerAbsolutePosition:e}=this.state;if(!this.props.groupInfo||!e)return;const{groupInitialPosition:t,groupTransformerNode:o,groupAbsolutePosition:a}=this.props.groupInfo,i=this.getAbsolutePositionFromLayer();if(!i)return;const s=SY(i,a,t,o);this.setLayerAbsolutePosition({...e,...s})})),i(this,"getAbsolutePositionFromLayer",(()=>{const{layer:e,getLayerPositionAndSize:t=QE}=this.props,o=t(e);return o?(u({category:"Studio Layer Mounted",message:`Layer: ${e.id}`}),"ellipse"===e.shapeType&&(o.x-=o.width/2,o.y-=o.height/2),o):null})),i(this,"setLayerAbsolutePosition",(e=>{this.setState({layerAbsolutePosition:e})})),i(this,"saveLayerPosition",ff.withUndoBatch((()=>{var e;const{layerAbsolutePosition:t}=this.state,{resizeLayer:o,resizeLineLayer:a,setRotation:i,layer:s,setScale:n,convertPositionToPercent:r=qE,convertSizeToPercent:l=zE,keyframeChannels:d,studioTime:c,canvasWidth:u,canvasHeight:m}=this.props,p=CI(s,d,c,u||0,m||0);if(!t)return;let{xPercent:h,yPercent:g}=r(t.x,t.y);const{widthPercent:f,heightPercent:y}=l(t.width,t.height),v=s.position&&p.width!==f||s.position&&p.height!==y,_=s.position&&p.x!==h||s.position&&p.y!==g||v;if("ellipse"===s.shapeType&&(h=`${parseFloat(h)+parseFloat(f)/2}%`,g=`${parseFloat(g)+parseFloat(y)/2}%`),im(s)&&"svg"===s.shapeType){n(s,t.width/s.position.svg_width,t.height/s.position.svg_height)}if(v&&(e=>{var t;const{state:o}=sr(),a=fT(e,o.studio);if(!a)return void console.error("Could not find layer to add cross transition to");if((null==(t=a.keyframeAnimation)?void 0:t.id)!==lI.id)return;const{height:i,width:s}=a,{scaledHeight:n,scaledWidth:r}=w0(s,i),l={width:r,height:n,x:0,y:0,rotation:0},d=(e,t=l)=>{const{width:o,height:a}=t;return{topLeft:{x:e.x/o,y:e.y/a},bottomRight:{x:(e.x+e.width)/o,y:(e.y+e.height)/a}}},c=l,u=((e,t=l)=>{const{x:o,y:a}=e.topLeft,{x:i,y:s}=e.bottomRight,{width:n,height:r}=t;return{x:o*n,y:a*r,width:(i-o)*n,height:(s-a)*r,rotation:0}})(dI[0].transitions[0].endValues,l),m=d(c,l),p=d(u,l),h=a.keyframeAnimation,g=h.transitions[0];h&&g&&g0(a,{startValues:m,endValues:p})})(s.id),im(s)&&s.shapeType&&["line","arrow"].includes(s.shapeType)&&_)return a(s,h,g,f,y,t.linePointStartCorner,t.lineRightAngle,!0),void i(s,t.rotation);if(LE(s.id,{positionTemp:null}),yI(s.id,vd.ZOOM)){const{getLayerPositionAndSize:e=QE,canvasWidth:o=0,canvasHeight:a=0,canvasX:i,canvasY:n}=this.props,r=e(s);if(!r)return;const l=t.x+t.width/2-i,d=t.y+t.height/2-n,c=l-r.width/2,u=d-r.height/2,m={...s.position,x:c/o*100+"%",y:u/a*100+"%"};OI({[s.id]:{position:m}},"LayerContainer.tsx",!0)}else o(s,h,g,f,y,!!s.position&&!!_);(null==(e=s.position)?void 0:e.rotation)!==t.rotation&&i(s,t.rotation,!0)}))),i(this,"handleTransform",((e,t)=>{const{layerAnimationPosition:o}=this.state,{studioPaused:a,layer:i,canvasWidth:s,canvasHeight:n}=this.props,{layerAbsolutePosition:r}=this.state,l=Fx(i);a&&o&&"vibrate"===(null==l?void 0:l.id)&&null!=e.x&&null!=e.y&&(e.x-=o.x,e.y-=o.y),r&&this.setLayerAbsolutePosition({...r,...e}),"ellipse"===i.shapeType&&e.x&&e.y&&(e.x+=(e.width||0)/2,e.y+=(e.height||0)/2);const d=rI({...i,position:sI(e)},s||0,n||0);LE(i.id,{tempDisplayPosition:d}),this.setState({transformSource:t,transforming:!0})})),i(this,"handleTransformFinish",(()=>{const{showSnapLines:e,layer:t}=this.props;ff.execInUndoBatch((()=>{this.addApplicableKeyframes(),"text"!==t.type&&this.saveLayerPosition()})),e({}),this.setState({transformSource:void 0,transforming:!1}),LE(t.id,{tempDisplayPosition:void 0})})),i(this,"handleEditorDoubleClick",(()=>{const{layer:e,viewOnly:t,isEditing:o}=this.props;t||o||(uJ(e),tR())})),i(this,"handleDoubleClick",(()=>{const{viewOnly:e,layer:t,isEditing:o,selectedItem:a,groupIDForLayer:i}=this.props;(null==a?void 0:a.id)!==t.id&&i?this.contextualSelectLayer({id:t.id,type:"layer"}):e||o||!am(t)||(uJ(t),tR())})),i(this,"handleExitEditorClick",(()=>{const{layer:e,viewOnly:t}=this.props,{layerAbsolutePosition:o}=this.state;!t&&o&&cJ(e,e.text)})),i(this,"contextualSelectLayer",(e=>{const{selectItem:t}=this.props;t("magicSubtitle"===e.type?{...e,frames:e.frames.allFrames}:e)})),i(this,"handleMouseDown",(e=>{const{layer:t,selectedItem:o,groupIDForLayer:a}=this.props;(e.shiftKey||e.metaKey)&&"background"!==(null==o?void 0:o.id)&&""!==(null==o?void 0:o.id)&&t?a?VJ({layerId:t.id,groupId:a,deselected:!1,undoable:!0}):bJ(t.id,{isUndoable:!0,isTimelineGroup:!1}):t&&(null==o?void 0:o.id)!==t.id&&(a||this.contextualSelectLayer({id:t.id,type:"layer"}))})),i(this,"setNodePosition",(e=>{this.setState({nodePosition:e})})),i(this,"addApplicableKeyframes",(()=>{const{layer:e,convertPositionToPercent:t=qE}=this.props,{layerAbsolutePosition:o}=this.state;if(!e.position||!o)return;const a=yI(e.id,vd.ZOOM);if("resize"===this.state.transformSource&&a){const t=e.zoom||100,{width:a}=HE(e.position.width,e.position.height),i=o.width*t/a;wI({...e,zoom:i})}if("drag"===this.state.transformSource&&yI(e.id,vd.POSITION)){"ellipse"===e.shapeType&&(o.x+=o.width/2,o.y+=o.height/2);let i=o.x,s=o.y;if(a){const t=o.x+o.width/2,a=o.y+o.height/2,{width:n,height:r}=HE(e.position.width,e.position.height);i=t-n/2,s=a-r/2}const{xPercent:n,yPercent:r}=t(i,s);_I({...e,position:{...e.position,x:n,y:r}})}})),i(this,"getKeyframedAbsolutePosition",(e=>{const{layer:t,getLayerPositionAndSize:o=QE,groupInfo:a,keyframeChannels:i,studioTime:s,canvasWidth:n,canvasHeight:r}=this.props,{transforming:l}=this.state;let d={...e};if(!l&&vI(t.id)){const e=CI(t,i,s,n||0,r||0),l=o({...t,position:e});if(l&&"ellipse"===t.shapeType&&(l.x-=l.width/2,l.y-=l.height/2),d={...d,...l},a&&a.groupResizing){const{groupInitialPosition:e,groupAbsolutePosition:t}=a,o=t.width/e.width,i=d.x-e.x,s=d.y-e.y;d.x=t.x+i*o,d.y=t.y+s*o,d.width*=o,d.height*=o}}return d})),i(this,"renderLayer",(e=>{const{layer:t}=this.props,{id:o,type:a}=t;if("ghost"===o)return w.jsx(T0,{...e},`layer-${o}`);switch((a||"").toLowerCase()){case"text":{const t={};return e.layer.isMagicSubtitle&&(t.magicAssetId=e.layer.assetId,t.staticPreview=!0),w.jsx(_.Fragment,{children:w.jsx(qQ,{...e,...t,nodePosition:this.state.nodePosition})},`layer-${o}`)}case"video":case"audio":{const t=(({layer:e,width:t,height:o,x:a,y:i,rotation:s,isBeingInlineCropped:n,borderRadiusTemp:r})=>{if("audio"===e.type&&!e.isAudiogram&&!e.requireConversion)return{opacity:0};const l=Oz(r??null,e,t,o);let d={x:"",y:""};e.position&&e.position.flip&&(d={x:e.position.flip.x?" scaleX(-1)":"",y:e.position.flip.y?" scaleY(-1)":""});let c=s;return 0!==l&&s%90==0&&0!==s&&(c+=1e-5),{position:"absolute",left:a,top:i,width:t,height:o,overflow:n?"visible":"hidden",zIndex:n?4:"auto",transform:`rotate(${c}deg) ${d.x}${d.y}`,opacity:1,borderRadius:`${l}px`}})({layer:e.layer,width:e.width,height:e.height,x:e.x,y:e.y,rotation:e.rotation,isBeingInlineCropped:this.props.isBeingInlineCropped,borderRadiusTemp:this.props.borderRadiusTemp??null}),a="audio"===e.layer.type?{}:b0(e,this.props.borderRadiusTemp??null);return w.jsxs("div",{children:[w.jsx("div",{"data-cy":`video-layer-container-${t.opacity}`,className:WQ.videoContainer,style:t,"data-testid":`video-layer-container-${o}`,children:(()=>{const t={...e,width:e.width,height:e.height,selfieSegmentation:this.props.selfieSegmentation};return e.staticPreview||!lC(e.layer)?w.jsx(U2,{...t},`layer-${o}`):w.jsx(A4,{width:t.width,height:t.height,videoWidth:t.layer.width,videoHeight:t.layer.height,layer:e.layer,keyframeChannels:this.props.keyframeChannels})})()}),w.jsx("div",{style:a,className:WQ.outline,onClick:()=>{this.props.selectItem(null)}})]})}case"image":{const t={...e};return t.waitingForSeekToResolve=this.props.waitingForSeekToResolve,w.jsx(r1,{...t},`layer-${o}`)}case"shape":return w.jsx(a3,{...e},`layer-${o}`);case"placeholder":return w.jsx(l3,{...e},`layer-${o}`);default:return null}})),i(this,"renderTransformer",((e,t)=>{var o;const{eyedropperMode:a,isShownAtStudioTime:i,trackIsDragging:s,layer:n,viewOnly:r,selectedItem:l,boxSelectedIds:d}=this.props,{layerAbsolutePosition:c}=this.state;if(!c)return;const u=`layer-${n.id}-transformer`;if("ghost"!==n.id){if("audio"===n.type&&!n.isAudiogram)return null;if(r||a)return null;if(!sE())return null}if(n.shapeType&&["line","arrow"].includes(n.shapeType)&&0===(null==(o=n.position)?void 0:o.rotation))return w.jsx(k4,{canvasHeight:this.props.canvasHeight,handleExitEditorClick:this.handleExitEditorClick,handleTransform:this.handleTransform,handleTransformFinish:this.handleTransformFinish,height:c.height,width:c.width,x:e,y:t,rotation:c.rotation,isBackgroundTransformer:!1,layer:this.props.layer,viewOnly:this.props.viewOnly,handleMouseDownCallback:this.handleMouseDown},u);const m="ghost"===n.id,p=(i||m)&&!s,h=n.id===(null==l?void 0:l.id),g=!!d[n.id],f=this.getKeyframedAbsolutePosition(c),y=am(n)?hY:mY;return w.jsx("div",{onClick:()=>{this.props.setSelectedEditorPane("canvas")},children:p&&w.jsx(I4,{handleDoubleClick:this.handleDoubleClick,handleExitEditorClick:this.handleExitEditorClick,setNodePosition:this.setNodePosition,handleTransform:this.handleTransform,handleTransformFinish:this.handleTransformFinish,isSelected:h,isBoxSelected:g,width:f.width,height:f.height,x:e,y:t,rotation:f.rotation,isBackgroundTransformer:!1,layer:this.props.layer,viewOnly:this.props.viewOnly,handleMouseDownCallback:this.handleMouseDown,lockAspectRatio:n.lockAspectRatio,visibleNodes:y},u)})}));const t=this.getAbsolutePositionFromLayer();this.state={layerAbsolutePosition:t,layerAnimationPosition:null,studioTimeState:e.studioTime,transformSource:void 0,transforming:!1}}static getDerivedStateFromProps(e,t){const{studioTime:o}=e,{studioTimeState:a}=t;return a===o?null:{studioTimeState:o}}shouldComponentUpdate(e,t){const o={...e},a={...this.props};delete o.studioTime,delete a.studioTime;return!s.isEqual(o,a)||!s.isEqual(t,this.state)}componentDidUpdate(e){const{canvasWidth:t,canvasHeight:o,containerWidth:a,containerHeight:i,groupInfo:s,layer:n,viewOnly:r}=this.props;let l=!1;if(!r&&e.canvasWidth!==t||e.canvasHeight!==o||e.containerWidth!==a||e.containerHeight!==i)if("shape"===n.type&&"progressBar"===n.shapeType&&n.position&&(n.position.width="100%"),n.lockAspectRatio&&"text"!==n.type&&"shape"!==n.type&&!r){const t=aI(n,e.canvasWidth,e.canvasHeight);this.resizeLockRatioLayer(t),l=!0}else this.setLayerAbsolutePosition(this.getAbsolutePositionFromLayer()),l=!0;if(s&&e.groupInfo){const{groupResizing:t,groupAbsolutePosition:o,groupRotating:a}=s;t&&e.groupInfo.groupAbsolutePosition&&e.groupInfo.groupAbsolutePosition.width!==o.width&&(this.resizeGroupedLayer(),l=!0),a&&e.groupInfo.groupAbsolutePosition&&e.groupInfo.groupAbsolutePosition.rotation!==o.rotation&&(this.rotateGroupedLayer(),l=!0)}!l&&this.shouldUpdateAbsolutePosition(e)&&"ghost"!==n.id&&this.setLayerAbsolutePosition(this.getAbsolutePositionFromLayer())}shouldUpdateAbsolutePosition(e){const{canvasWidth:t,canvasHeight:o,layer:a,viewOnly:i,refreshKey:n,positionTemp:r}=this.props,{layerAbsolutePosition:l}=this.state;return!l||(!!((i&&e.canvasWidth!==t||e.canvasHeight!==o)&&o&&t)||(!s.isEqual(e.positionTemp,r)||(!s.isEqual(e.layer.position,a.position)||n!==e.refreshKey)))}getPreviewUrl(e){switch(e.type){case jv.CML_FILE:return e.thumbnailUrl;case jv.SIDEBAR_IMAGE:return e.image.url;case jv.SIDEBAR_VIDEO:return e.video.thumbnailUrl;default:return""}}render(){const{layer:e,viewOnly:t,canvasHeight:o,canvasWidth:a,isCanvasPreview:i,isOverCurrent:s,item:n,staticPreview:r,onVideoLoad:l,groupInfo:d,refreshKey:c,studioTime:u}=this.props,{layerAbsolutePosition:m,layerAnimationPosition:p}=this.state;if(!m)return null;const h=this.getKeyframedAbsolutePosition(m),g={layer:e,handleTransform:this.handleTransform,handleTransformFinish:this.handleTransformFinish,...h,refreshKey:c,viewOnly:t,staticPreview:r,handleEditorDoubleClick:this.handleEditorDoubleClick,handleExitEditorClick:this.handleExitEditorClick,canvasHeight:o,canvasWidth:a,onVideoLoad:l,updateLayerAnimationPosition:this.updateLayerAnimationPosition,isCanvasPreview:i,studioTime:u};if(!e)return null;d&&(g.x+=d.groupXDiff,g.y+=d.groupYDiff);const f=Mx(e);p&&f.some((e=>e.layerInvolvesMovement))&&(g.x+=p.x||0,g.y+=p.y||0),s&&(g.previewUrl=this.getPreviewUrl(n));const y=r||"ghost"===e.id?"none":"auto";return this.props.connectDropTarget(w.jsxs("div",{style:{pointerEvents:y},children:[this.renderTransformer(g.x,g.y),this.renderLayer(g)]}))}}const N4={drop:(e,t)=>{const o=t.getItem(),{layer:a,selectItem:i,selectedSceneId:s}=e,n=RU(Bl.BRANDKIT);if(a.type===zl.Placeholder){switch(i({id:a.id,type:a.type}),o.type){case jv.UPLOADING_LAYER:fz(a,o.layer,{knownTimelineRow:!0,sceneId:s,undoable:!0});break;case jv.SIDEBAR_IMAGE:d0({dndAsset:o.image,idOfLayerToReplace:a.id});break;case jv.SIDEBAR_VIDEO:d0({dndAsset:o.video,idOfLayerToReplace:a.id});break;case jv.TRANSITION_TILE:break;case jv.CML_FILE:TW((()=>{Sq(o.cmlFile,o.asset)}),{if:o.brandkitItem&&!n,action:Vl.BRANDKIT})();break;case jv.TEXT_PRESET:l0(o.preset,{position:a.position})}return a}const r={};return e.mIGhostLayerAbsolutePosition&&(r.position=sI(y4(e.mIGhostLayerAbsolutePosition,0,!1))),m0({item:o,layerUpdates:r,source:"LayerContainer.tsx"}),{}}},R4=je(wE(g.connect(((e,t)=>{var o;const a=OQ(t.layer.id),{draggedTracksOverrides:i={},trackIsDragging:s}=e.studioLocal;let n=!1;if(t.layer){const e=i[t.layer.id];if(e&&e.leftMost||t.layer.requireConversion)n=!0;else{const[e,o]=TS(t.layer,0);n=e<=t.studioTime&&t.studioTime<=o}}const r=Object.entries(e.studio.groups).find((e=>e[1].layers.some((e=>e.id===t.layer.id)))),l=r&&r[0],d=e.studioLocal.layerTempValues[t.layer.id];return{boxSelectedIds:e.studioLocal.boxSelectedIds,containerHeight:e.studio.containerHeight,containerWidth:e.studio.containerWidth,eyedropperMode:e.studio.eyedropperMode,groupIDForLayer:l,groups:e.studio.groups,isBeingInlineCropped:!!(null==d?void 0:d.isBeingInlineCropped),isEditing:Fg(e,t.layer.id),trackIsDragging:s,isShownAtStudioTime:n,positionTemp:null==d?void 0:d.positionTemp,borderRadiusTemp:null==d?void 0:d.borderRadiusTemp,mediaCache:e.mediaCache,ratio:e.studio.ratio,refreshKey:e.studio.refreshKey,selectedItem:e.studio.selectedItem,studioPaused:XN(e),viewOnly:!e.userPermissions.canWrite||t.layer.locked&&t.layer.id!==(null==(o=e.studio.selectedItem)?void 0:o.id)||t.viewOnly,mIGhostLayerAbsolutePosition:Ug(e),selectedSceneId:e.studio.scenes[0].id,keyframeChannels:a(e)}}),(e=>ye({setSelectedEditorPane:f_,resizeLayer:Uv,showSnapLines:Xv,setScale:Vv,setRotation:Wv,resizeLineLayer:Bv,selectItem:l_},e)))(jt([jv.CML_FILE,jv.SIDEBAR_IMAGE,jv.SIDEBAR_VIDEO],N4,((e,t)=>({item:t.getItem(),connectDropTarget:e.dropTarget(),isOverCurrent:t.isOver({shallow:!0})})))(j4)))),P4=()=>{const[e,t]=h.useState(null),[o,a]=h.useState(null);return h.useEffect((()=>{if(!e)return;const t=new Nt.ResizeSensor(e,s.throttle((({width:e,height:t})=>{a({width:e,height:t})}),120));return()=>t.detach()}),[e]),{containerDimensions:o,containerRef:t}},D4=_.memo((({canvasHeight:e,canvasWidth:t,canvasY:o,layers:a})=>{const i=_E(),[s,n]=h.useState(null),r=h.useMemo((()=>Hz(a)),[a]),l=_.useContext(j2),{elementPool:d}=mE(),c=h.useRef(document.createElement("canvas")),u=h.useMemo((()=>{for(const{endTime:e,layer:t,startTime:o}of r)if(i>=o&&i<=e)return t;return null}),[r,i]),m=tl((e=>{var t;return"number"==typeof(null==(t=e.elementPool.byElementPoolId[oS.studio])?void 0:t.userManualSeekTime)})),p=z2(null==u?void 0:u.originalLayerId),g=h.useCallback((()=>{if(!u||"video"!==u.type)return null;const e=d.domElementByLayerId.get(u.originalLayerId),t=l.domElementByLayerId.get(u.originalLayerId),o=e||t||null;return(null==o?void 0:o.readyState)&&1!==o.readyState?o:null}),[l,u,d]);h.useEffect((()=>{function e(){const e=g();return n(e),!!e}if(e())return;const t=setInterval((()=>{e()&&clearInterval(t)}),250);return()=>clearInterval(t)}),[g]);const f=h.useMemo((()=>!!(u&&t&&e&&u.width&&u.height&&u.width/u.height<t/e)),[u,e,t]),y=h.useCallback((o=>{const a=c.current;if(!a)return;a.width=t||100,a.height=e||100;const i=a.getContext("2d");if(i&&s&&t&&e&&o.width&&o.height)if(f){const a=t*o.height/o.width;i.drawImage(s,0,-a/2+e/2,t,t*o.height/o.width)}else{const a=e*o.width/o.height;i.drawImage(s,-a/2+t/2,0,a,e)}}),[s,e,f,t]);if(h.useEffect((function(){u&&"video"===u.type&&(m||y(u))}),[u,y,i,m]),!u)return null;return w.jsx(s2,{layer:u,style:(()=>{const a=cx(u,p,i);return{position:"absolute",top:o,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",transform:"scale(1.1)",filter:S0(a,t??0,e??0,null,!0)}})(),children:"video"===u.type?w.jsx("canvas",{id:"blurCanvas",ref:c,width:t,height:e}):"image"===u.type?w.jsx("img",{style:f?{width:t}:{height:e},src:u.url,alt:"main layer"}):null})})),O4=_.memo((({background:e="transparent",canvasBlur:t,layers:o,ratio:a,onContainerSizeChange:i,onVideoLoad:s})=>{const n=_E(),{containerDimensions:r,containerRef:l}=P4(),{width:d,height:c}=h.useMemo((()=>{if(!a.width||!a.height)return{width:0,height:0};if(!r)return{width:0,height:0};const{width:e,height:t}=r,o=a.width/a.height;return o>e/t?{width:e,height:e/o}:{width:t*o,height:t}}),[r,a]);h.useEffect((()=>{i&&i({width:d,height:c})}),[i,d,c]);const u=o.filter((e=>{if(e.isHidden)return!1;const[t,o]=TS(e);if(Ql(e)){return t-1<=n&&n<=o+1}return t<=n&&n<=o})),m=h.useMemo((()=>u.map((e=>()=>eI(e,{width:d,height:c,x:0,y:0})))),[c,u,d]);return w.jsx("div",{className:t0,ref:l,"data-testid":"canvas-preview",children:!!d&&!!c&&w.jsxs("div",{className:o0,style:{width:d,height:c,background:e},children:[t&&w.jsx(D4,{layers:o,canvasHeight:c,canvasWidth:d,canvasY:0}),u.map(((e,t)=>{const o=m[t];return o?w.jsx(R4,{layer:e,viewOnly:!0,isCanvasPreview:!0,getLayerPositionAndSize:o,onVideoLoad:s,canvasHeight:c,canvasWidth:d,canvasX:0,canvasY:0},e.id):null}))]})})})),L4=[1,1],F4=_.memo((function({template:e,width:t=100,height:o=100,onClick:a}){const i=h.useMemo((()=>({width:t,height:o})),[o,t]);h.useEffect((()=>{!async function(){const t=e.layers.filter((e=>e.type===zl.Text));await Promise.all(t.map((async e=>{const t=VC(e);t&&await MY({fontToLoad:t})})))}()}),[e]);const s=h.useMemo((()=>({width:t,height:o})),[t,o]),n=e.layers.map(((t,o)=>{const[a,s]=e.ratio||L4,n=Qj({layer:t,prevRatio:{width:a,height:s},newRatio:i,resizeMethod:"fit"});return{...t,id:`${e.templateId}-${o}`,position:n}}));return w.jsx(AZ,{className:e0,style:s,onClick:a,children:w.jsx(O4,{layers:n,ratio:i,background:"transparent",canvasBlur:!1})})})),M4=_.memo((function({template:e,width:t=100,height:o=100,viewOnly:a,onClick:i}){const s=!!e.teamId;return w.jsxs("div",{className:qZ,children:[w.jsx(F4,{template:e,width:t,height:o,onClick:i}),!a&&w.jsx("div",{className:QZ,children:w.jsx(JZ,{template:e,isBrandkit:s})}),s&&w.jsx("div",{className:XZ,onClick:i,children:w.jsx(sU,{message:"Added to your team’s Brand Kit",wrapWithDiv:!0,children:w.jsx(Ze,{className:ZZ})})})]})})),U4="DragPreview-module_item_OtsDt",B4=_.memo((()=>{const{isDragging:e,item:t,sourceClientOffset:o,clientOffset:a}=Rt((e=>({isDragging:e.isDragging(),item:e.getItem(),sourceClientOffset:e.getSourceClientOffset(),clientOffset:e.getClientOffset()}))),{inTrackpadOrCanvas:i}=tl((e=>({inTrackpadOrCanvas:!!e.studioLocal.mediaItemDropLocation})),ol),s=il();h.useEffect((()=>{e||s(E_(null))}),[e,s]);return t&&e&&!i?w.jsx("div",{style:function(){if(!o)return{display:"none"};const e={left:o.x,top:o.y,width:120,height:100};switch(t.type){case jv.CML_FILE:t.thumbnailUrl&&(e.backgroundImage=`url(${t.thumbnailUrl})`);break;case jv.UPLOADING_LAYER:break;case jv.TRANSITION_TILE:a&&(e.left=a.x-60,e.top=a.y-50,e.width=60,e.height=50,e.backgroundImage=t.isCrossTransition?"url(https://cdn-useast1.kapwing.com/static/Fyi-crossTransitionIcon.png)":"url(https://cdn-useast1.kapwing.com/static/hjX-singleVideoTransitionIcon.png)");break;case jv.SIDEBAR_IMAGE:{const{url:o,imageRef:a}=t.image,i=null==a?void 0:a.current;if(o&&(e.backgroundImage=`url(${o})`),i){const t=i.getBoundingClientRect();e.width=t.width,e.height=t.height}break}case jv.SIDEBAR_VIDEO:{const{thumbnailUrl:o,videoRef:a}=t.video,i=null==a?void 0:a.current;if(o&&(e.backgroundImage=`url(${o})`),i){const t=i.getBoundingClientRect();e.width=t.width,e.height=t.height}break}case jv.MAGIC_SUBTITLE_PRESET:e.width=106,e.height=133,e.background="transparent",e.overflow="hidden";break;case jv.TEXT_PRESET:case jv.TEXT_TEMPLATE:e.width=106,e.height=106,e.background="transparent",e.overflow="hidden"}return e}(),className:U4,children:(()=>{switch(t.type){case jv.MAGIC_SUBTITLE_PRESET:return w.jsx("div",{style:{backgroundColor:"#101010"},children:w.jsx(sZ,{preset:t.preset,animate:!0,viewOnly:!0})});case jv.TEXT_PRESET:return w.jsx("div",{style:{backgroundColor:"#101010"},children:w.jsx(LZ,{preset:t.preset,viewOnly:!0})});case jv.TEXT_TEMPLATE:return w.jsx("div",{style:{backgroundColor:"#101010"},children:w.jsx(M4,{template:t.template,viewOnly:!0})});default:return null}})()}):null})),V4=_.memo((({children:e})=>w.jsx(Se,{children:w.jsx(Pt,{children:e})})));class W4 extends h.Component{componentDidUpdate(e){this.props.location!==e.location&&window.scrollTo(0,0)}render(){return this.props.children}}const G4=je(W4),H4="LoadingFullScreen-module_loadingWrapperFullScreen_tPwdp",$4="LoadingFullScreen-module_loadingWrapperFullScreenGray_1OpAV",K4="LoadingFullScreen-module_loadingLogo_-lDxm",z4="LoadingFullScreen-module_fullScreenLoadingDescription_Rprph",Y4=_.memo((({theme:e=RF.Workspace,title:t})=>{const o=(()=>{let t="https://cdn-useast1.kapwing.com/static/yeX-Kapwing-transparent-logo-animation-white.webp";e===RF.Studio&&(t="https://cdn-useast1.kapwing.com/static/8XE-Kapwing-transparent-logo-animation-gray.webp");return qg()&&(t="https://cdn-useast1.kapwing.com/static/nAu-loading-logo-gif-white.gif",e===RF.Studio&&(t="https://cdn-useast1.kapwing.com/static/AIU-loading-logo-dark.gif")),t})();return w.jsxs("div",{className:e===RF.Studio?$4:H4,children:[w.jsx("img",{className:K4,alt:"loading",src:o}),w.jsxs("div",{className:z4,"data-cy":"loading-full-screen",children:[w.jsx("span",{children:t||"Loading..."}),w.jsx(PF,{theme:e})]})]})})),J4={},q4={fallback:w.jsx(Y4,{theme:RF.Studio,title:"Loading Kapwing..."})},X4=Dt((()=>yc((()=>import("./Team-fcfc82c5.js")),["assets/Team-fcfc82c5.js","assets/vendor-3b0a39e0.js","assets/Navbar-96c073d1.js","assets/Navbar-740171fb.css","assets/Team-5f7c8f31.css"])),J4),Q4=Dt((()=>yc((()=>import("./Settings-f2e10b1f.js")),["assets/Settings-f2e10b1f.js","assets/vendor-3b0a39e0.js","assets/Settings-d080c9aa.css"])),J4),Z4=Dt((()=>yc((()=>import("./TemplateEditorContainer-a1faa4b5.js")),["assets/TemplateEditorContainer-a1faa4b5.js","assets/vendor-3b0a39e0.js"])),q4);Dt((()=>yc((()=>Promise.resolve().then((()=>wRe))),void 0)),J4);const e9=Dt((()=>yc((()=>import("./BrandkitEditor-450bf8c7.js")),["assets/BrandkitEditor-450bf8c7.js","assets/vendor-3b0a39e0.js","assets/CustomSpellingSection-7f5bf102.js","assets/CloudMediaLibraryTile-377234f5.js","assets/CloudMediaLibraryTile-15bb0bf3.css","assets/CustomSpellingSection-c875410e.css","assets/Navbar-96c073d1.js","assets/Navbar-740171fb.css","assets/BrandkitEditor-cb873154.css"])),J4),t9=Dt((()=>yc((()=>import("./Editor-0c29adb0.js")),["assets/Editor-0c29adb0.js","assets/vendor-3b0a39e0.js","assets/workspace-242b4869.js","assets/CloudMediaLibraryTile-377234f5.js","assets/CloudMediaLibraryTile-15bb0bf3.css","assets/workspace-8e8370b3.css","assets/Editor-fe176ac9.css"])),q4),o9=Dt((()=>yc((()=>import("./StudioEditor-0a68e3f0.js")),["assets/StudioEditor-0a68e3f0.js","assets/vendor-3b0a39e0.js","assets/workspace-242b4869.js","assets/CloudMediaLibraryTile-377234f5.js","assets/CloudMediaLibraryTile-15bb0bf3.css","assets/workspace-8e8370b3.css","assets/CustomSpellingSection-7f5bf102.js","assets/CustomSpellingSection-c875410e.css","assets/unitless.browser.esm-2037f92d.js","assets/index-36fd420b.js","assets/StudioEditor-e95b571f.css"])),q4),a9=_.memo((function(e){return h.useEffect((function(){(e=>{Aw=performance.now(),jw={},Cw=!1,kw=e,Iw||(Iw=au().isPaid);const t={"Remote Reedit":kw};console.debug(ym.KAPWING_STARTUP_STARTED,t),Iw&&Fm(ym.KAPWING_STARTUP_STARTED,t)})(!!e.match.params.id)}),[]),w.jsx(o9,{...e})})),i9=Dt((()=>yc((()=>import("./AdminContainer-1b58fe37.js")),["assets/AdminContainer-1b58fe37.js","assets/vendor-3b0a39e0.js","assets/_baseAssignValue-c4be27e9.js","assets/AdminOnly-6ca6dce6.js","assets/AdminContainer-0b309817.css"])),J4),s9=Dt((()=>yc((()=>Promise.resolve().then((()=>xFe))),void 0)),J4),n9=Dt((()=>yc((()=>Promise.resolve().then((()=>gu))),void 0)),J4),r9=Dt((()=>yc((()=>import("./DebugContainer-aeeb42f2.js")),["assets/DebugContainer-aeeb42f2.js","assets/vendor-3b0a39e0.js","assets/AdminOnly-6ca6dce6.js","assets/index-36fd420b.js","assets/DebugContainer-a34ebe68.css"])),J4),l9=Dt((()=>yc((()=>import("./HappyBirthday-9680747d.js")),["assets/HappyBirthday-9680747d.js","assets/vendor-3b0a39e0.js","assets/unitless.browser.esm-2037f92d.js"])),J4),d9=_.memo((({children:e,...t})=>{const[o,a]=_.useState(!1);return h.useEffect((()=>{a(!0)}),[]),o?w.jsx(_.Fragment,{...t,children:e}):null}));var c9=(e=>(e.account="account",e.accountChange="account/change",e))(c9||{});const u9="UpgradePill-module_upgradePill_xkjUA",m9="UpgradePill-module_proSparkle_-APHJ",p9=_.memo((({action:e=Vl.HEADER,className:t=""})=>{const o=bW();return w.jsxs("div",{className:`${u9} ${t}`,onClick:t=>{t.stopPropagation(),o((()=>{}),{action:e})()},"data-testid":"upgrade-pill","data-cy":"upgrade-pill",children:["Upgrade",w.jsx(EW,{className:m9})]})})),h9="SubscriptionStatePill-module_reactivatePill_3CQxI",g9="SubscriptionStatePill-module_proSparkle_9cSXz",f9="SubscriptionStatePill-module_pastDuePill_XQCI0",y9=_.memo((({className:e=""})=>{const t=Ve(),o=Ac(),{subscription:a}=pM(),{isPastDue:i}=Ju(a),s=e=>{e.stopPropagation(),t.push(`/team/${o._id}/billing`)},n=e=>{fW(Gl.Update)?s(e):hh({description:"Only team workspace admins can manage workspace subscriptions. Contact your admin to reactivate this subscription."})};return a?Xu(a)?w.jsxs("div",{className:`${h9} ${e}`,onClick:n,"data-testid":"reactivate-pill","data-cy":"reactivate-pill",children:["Reactivate",w.jsx(EW,{className:g9})]}):i?w.jsx("div",{className:`${f9} ${e}`,"data-testid":"past-due-pill","data-cy":"past-due-pill",onClick:s,children:"Payment Incomplete"}):null:null})),v9=(e,t,o)=>{const a=t||200,i=o||200,{fb_id:s,loggedInWith:n,picture:r,customPicture:l}=e||{};let d;switch((n||"").toLowerCase()){case"facebook":d=`https://graph.facebook.com/${s}/picture?width=${a}&height=${i}`;break;case"google":d=r?`${r}?sz=${a}`:void 0;break;default:d=r||void 0}var c;return l&&(d=(c=l).startsWith("https://cdn.kapwing.com")?c.replace("https://cdn.kapwing.com",yn):c),d},_9=({height:e,letter:t,width:o})=>{const a=document.createElement("canvas");a.width=o,a.height=e;const i=a.getContext("2d");if(i)return i.fillStyle="#78909C",i.fillRect(0,0,o,e),i.font=`normal ${o/2}px sans-serif`,i.textAlign="center",i.textBaseline="middle",i.fillStyle="white",i.fillText(t,o/2,e/2),a.toDataURL("image/png")};class w9 extends h.Component{constructor(e){super(e),i(this,"onImageError",(()=>{this.setState({error:!0})})),this.state={error:!1}}render(){const{currentUser:e,custom:t,suggestedWidth:o,suggestedHeight:a,absoluteWidth:i,absoluteHeight:n,className:r,team:l}=this.props,{error:d}=this.state;let c;const u=!(!this.props.user||!("pending"in this.props.user))&&this.props.user.pending;c=this.props.user&&!s.isEmpty(this.props.user)?this.props.user:e.user;const m=o||300,p=a||300;let h;if(d||u||t||l||(h=v9(c,m,p)),!d&&l&&"personal"!==l._id&&l.picture&&(h=l.picture),!h){let o="";if(t&&t.name)o=t.name.charAt(0).toUpperCase();else if(l&&l.name)o=l.name.charAt(0).toUpperCase();else if(u&&c.name)o=c.name.charAt(0).toUpperCase();else if(this.props.user&&!s.isEmpty(this.props.user)){const{firstName:e,name:t}=c;e&&(o=e.charAt(0).toUpperCase()),t&&!o&&(o=t.charAt(0).toUpperCase())}if(!o){const t=Ec(e);t&&(o=t.charAt(0).toUpperCase())}o||(e.user.email?o=e.user.email.charAt(0).toUpperCase():c.email&&(o=c.email.charAt(0).toUpperCase())),h=_9({height:p,letter:o,width:m})}return i&&n?w.jsx("img",{width:i,height:n,src:h,alt:"",className:r,"data-cy":"profile-picture","data-testid":"profile-picture",onError:this.onImageError}):w.jsx("img",{src:h,alt:"",className:r,"data-cy":"profile-picture","data-testid":"profile-picture",onError:this.onImageError})}}const b9=g.connect((e=>({currentUser:e.currentUser})))(w9);function T9(e,t=!1){return Jr("/api/v1/users/google/findUser",{body:{user:e}}).then((e=>{const{dispatch:o}=sr();o(sp(e.user,e.token));Wm(e.user,e.newUser,"Google",t)}))}class x9 extends h.Component{constructor(){super(...arguments),i(this,"handleError",((e,t="signIn",o="Sign In")=>{const{showToast:a}=this.props;let i=e;e||(i="An error occurred during sign in with One Tap. Please try again later."),Fm(ym.SIGN_IN_ERROR_OCCURRED,{"Error Type":t,Details:o,"One-Tap":!0}),a({description:i,type:"error"})})),i(this,"handleGoogleSuccessResponse",(e=>{T9(e,!0).catch((e=>{this.handleError(null==e?void 0:e.message,"fetchGoogleUser")}))}))}componentDidMount(){"undefined"!=typeof window&&(window.oneTapHandleSuccess=e=>{this.handleGoogleSuccessResponse(e)})}render(){var e,t,o;const{user:a}=this.props;return s.isEmpty(a)?w.jsx("div",{id:"g_id_onload","data-client_id":"823730063895-iqn5t0hivtu1ss7c2mhpfdmh1ghlf9fa.apps.googleusercontent.com","data-callback":"oneTapHandleSuccess","data-itp_support":"true","data-cancel_on_tap_outside":"false"}):(null==(o=null==(t=null==(e=window.google)?void 0:e.accounts)?void 0:t.id)||o.cancel(),null)}}const S9=je(g.connect((e=>({user:e.currentUser.user})),(e=>ye({showToast:wl},e)))(x9)),E9={upsellButton:"HeaderBar-module_upsellButton_-TB89",darkUpsellButton:"HeaderBar-module_darkUpsellButton_xOVIr",lightSparkle:"HeaderBar-module_lightSparkle_wE6a2",workspaceLink:"HeaderBar-module_workspaceLink_J1fiZ",divider:"HeaderBar-module_divider_r-sB3",workspaceDropDown:"HeaderBar-module_workspaceDropDown_d9WUp",plusIcon:"HeaderBar-module_plusIcon_dHLMZ",workspaceSwitcher:"HeaderBar-module_workspaceSwitcher_0qJrS",profileImage:"HeaderBar-module_profileImage_esu87",profileImageWithEmail:"HeaderBar-module_profileImageWithEmail_BzRZo",userName:"HeaderBar-module_userName_USIud",menuIcon:"HeaderBar-module_menuIcon_U0IHM",menu:"HeaderBar-module_menu_IWxm0",headerLinkText:"HeaderBar-module_headerLinkText_2leOT",headerActiveLinkText:"HeaderBar-module_headerActiveLinkText_h-inP",headerBar:"HeaderBar-module_headerBar_bSCyV",impersonating:"HeaderBar-module_impersonating_aKakH",headerBarEmpty:"HeaderBar-module_headerBarEmpty_7xuJg",headerRight:"HeaderBar-module_headerRight_8gDQm",headerLeft:"HeaderBar-module_headerLeft_UbvUw",headerMiddle:"HeaderBar-module_headerMiddle_b816Y",menuLogoImage:"HeaderBar-module_menuLogoImage_bbzDs",headerBarLogoText:"HeaderBar-module_headerBarLogoText_-wwuS",headerBarLogoImage:"HeaderBar-module_headerBarLogoImage_ZwwLj",hideMobile:"HeaderBar-module_hideMobile_YKjEF",hideDesktop:"HeaderBar-module_hideDesktop_xJuMZ",signedInContainer:"HeaderBar-module_signedInContainer_-giip",accountName:"HeaderBar-module_accountName_rI-4h",accountNameWithEmail:"HeaderBar-module_accountNameWithEmail_EeiGe",email:"HeaderBar-module_email_KPhaQ",accountLink:"HeaderBar-module_accountLink_3r30W",proLabel:"HeaderBar-module_proLabel_-pF20",planLabel:"HeaderBar-module_planLabel_8mUnY",basicLabel:"HeaderBar-module_basicLabel_mRaDf",freeLabel:"HeaderBar-module_freeLabel_sYx10",pill:"HeaderBar-module_pill_3sGIa",badges:"HeaderBar-module_badges_8PPmC"},I9=async(e="",t="")=>{const{history:o}=sr(),a=await xD(t,e)||"";o.push(`/folder/${a}`),await Dp(),yM(e)},C9=async(e="")=>{const{history:t,state:o}=sr(),{teams:{allTeams:a},workspaces:{allWorkspaces:i}}=o;let s="",n="";const r=a.find((e=>e.primary));if(r){s=r._id;const e=i.find((e=>e.teamId===s));n=null==e?void 0:e._id}n||(n=await xD(e,s)),n?t.push(`/folder/${n}`):t.push("/home")},k9=e=>{const{history:t,dispatch:o}=sr();o(ib(e)),t.push(`/folder/${e}`)},A9=(e,t)=>{const{history:o,dispatch:a}=sr(),i=function(e,t){const{allWorkspaces:o}=sr().state.workspaces,a=xP(o,e).find((e=>e._id!==t));return(null==a?void 0:a._id)||""}(t,e);a(ib(i)),o.push(`/folder/${i}`)};function j9(e){const{state:t}=sr(),{token:o,user:a}=t.currentUser||{};return Jr(`/api/v1/admin/users/${e}`,{body:{token:o,userId:a._id}})}function N9(e){const{state:t}=sr(),{token:o,user:a}=t.currentUser||{},{_id:i}=a;return Jr("/api/v1/admin/fetchUserByEmail",{body:{email:e,token:o,userId:i}})}function R9(e,t){const{state:o}=sr(),{token:a,user:i}=o.currentUser||{};return Jr("/api/v1/admin/fetchContentByEmail",{body:{targetUserEmail:e,pageNum:t,token:a,userId:i._id}})}function P9(e,t){return Jr("/api/v2/admin/addStripeId",{body:{targetTeamId:t,stripeId:e}})}function D9(e){const{state:t}=sr(),{user:o}=t.currentUser||{};return Jr("/api/v2/admin/removeStripeId",{body:{targetTeamId:e,userId:o._id}})}function O9(e,t){const{state:o}=sr(),{token:a,user:i}=o.currentUser||{};return Jr("/api/v2/admin/upgradeTeam",{body:{targetTeamId:e,planTier:t,token:a,userId:i._id}})}function L9(e){const{state:t}=sr(),{token:o,user:a}=t.currentUser||{};return Jr("/api/v2/admin/setTeamToFree",{body:{targetTeamId:e,token:o,userId:a._id}})}function F9(e,t){const{state:o}=sr(),{token:a,user:i}=o.currentUser||{};return Jr("/api/v1/admin/updateAccountType",{body:{targetUserId:e,newAccountType:t,token:a,userId:i._id}})}function M9(){return Qr("stripe_stats",{timeout:6e4,includeAuth:!0})}async function U9(e){const{dispatch:t,state:o}=sr(),{token:a,user:i,impersonatingAdminEmail:s}=o.currentUser;t(Ip(""));const n=await Jr("/api/v1/admin/impersonateUser",{parseJSON:!0,body:{token:a,userId:i._id,userToImpersonateId:e}});t(sp(n.user,n.token,s||i.email)),await Op(),await xD(),PU()}async function B9(){const{dispatch:e,state:t}=sr(),{token:o,user:a}=t.currentUser,{history:i}=sr();e(Ip(""));const s=await Jr("/api/v1/admin/revertImpersonation",{parseJSON:!0,body:{token:o,userId:a._id}});e(sp(s.user,s.token)),await Op(),await ah();const n=await xD();n?(e=>{const{history:t,dispatch:o}=sr();o(ib(e)),t.push(`/folder/${e}`)})(n):i.push("/home"),PU()}function V9(e){return Jr("/api/v2/admin/blockSuggestedDomain",{body:{domain:e}})}const W9="AdminImpersonationWarning-module_spacer_VCvul",G9="AdminImpersonationWarning-module_contentBox_oZsGS",H9="AdminImpersonationWarning-module_warningText_ugxIc",$9="AdminImpersonationWarning-module_dangerIcon_BMphk",K9="AdminImpersonationWarning-module_button_V1rUF",z9=g.connect((e=>({currentUser:e.currentUser}))),Y9=h.memo(z9((({className:e,currentUser:t})=>{const{user:o,impersonatingAdminEmail:a}=t,{email:i}=o;if(!a)return null;return w.jsxs("div",{className:`${W9} ${e||""}`,children:[w.jsx("span",{className:$9,style:{left:"4px"},children:"⚠"}),w.jsxs("div",{className:G9,children:[w.jsxs("span",{className:H9,children:["Admin - You are acting as ",w.jsx("b",{children:i}),"."]}),w.jsxs("button",{type:"button",onClick:async()=>{await B9()},className:K9,children:["Revert to ",a]})]}),w.jsx("span",{className:$9,style:{right:"4px"},children:"⚠"})]})}))),J9={pathname:"/home",state:{openModal:c9.account}},q9=_.memo((({currentUser:e,isMobile:t})=>{const o=Ec(e),a=Ic(e),i=ou();return w.jsxs("div",{className:E9.signedInContainer,children:[w.jsxs("div",{className:E9.badges,children:[w.jsx(y9,{className:E9.pill,entryPoint:"Workspace Header Pill"}),i.showUpgrades&&w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:E9[`${i.name.toLowerCase()}Label`],children:[i.name," Plan"]}),w.jsx("div",{"data-cy":"upgrade-label-header",children:w.jsx(p9,{className:E9.pill})})]})]}),w.jsx(Ot,{to:J9,className:E9.headerLinkText,activeClassName:E9.headerActiveLinkText,"data-cy":"account-nav-link",children:w.jsxs("div",{className:E9.accountLink,children:[w.jsxs("div",{children:[w.jsx("div",{className:a?E9.accountNameWithEmail:E9.accountName,children:o||"My Account"}),!t&&a&&w.jsx("div",{className:E9.email,children:a})]}),w.jsx("div",{children:w.jsx(b9,{suggestedWidth:300,suggestedHeight:300,className:a?E9.profileImageWithEmail:E9.profileImage})})]})})]})})),X9=g.connect((e=>({currentUser:e.currentUser,workspaces:e.workspaces,allWorkspaces:e.workspaces.allWorkspaces,currentFolderId:e.workspaces.selectedWorkspace}))),Q9=_.memo(je(X9((e=>{const{currentUser:t,history:o,location:a}=e,i=wc(t),[s,n]=h.useState(!1),[r,l]=h.useState(!1),[d,c]=h.useState(!1),u=ku(),m=h.useRef(null);h.useEffect((()=>{l(!1)}),[a]);const p=e=>{m&&m.current&&m.current.contains(e.target)||l(!1)};h.useEffect((()=>(document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)})),[]);const g=h.useCallback((()=>{l(!r)}),[r]),f=h.useCallback((()=>wc(t)?e.currentFolderId?`/folder/${e.currentFolderId}`:"/home":"/"),[t,e.currentFolderId]),y=h.useCallback((()=>{o.push(f())}),[f,o]),v=h.useCallback((()=>{n(!1)}),[]),_=()=>w.jsxs(w.Fragment,{children:[w.jsx("a",{className:E9.headerLinkText,href:"/tools","data-cy":"tools-nav-link",children:"Tools"}),w.jsx("a",{className:E9.headerLinkText,href:"/ai","data-cy":"tools-nav-link",children:"AI"}),w.jsx("a",{className:E9.headerLinkText,href:"/templates","data-cy":"templates-nav-link",children:"Templates"}),w.jsx("a",{className:E9.headerLinkText,target:"_blank",rel:"noopener noreferrer",href:"https://www.kapwing.com/resources",children:"Learn"}),w.jsx("a",{className:E9.headerLinkText,href:"/pricing","data-cy":"pricing-nav-link",children:"Pricing"})]});return w.jsxs(w.Fragment,{children:[w.jsx(S9,{}),w.jsxs("div",{className:E9.headerBar+(Kp(t)?` ${E9.impersonating}`:""),children:[w.jsx(Y9,{}),u?w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:E9.headerLeft,children:[w.jsx("a",{href:f(),children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",alt:"Kapwing Logo",className:E9.headerBarLogoImage,"data-cy":"header-logo",width:36,height:36})}),w.jsx("a",{className:E9.headerBarLogoText,href:f(),children:"KAPWING"})]}),r?w.jsx("div",{className:E9.menu,ref:m,children:_()}):null]}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:E9.headerLeft,children:[w.jsx("a",{href:f(),children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",className:E9.headerBarLogoImage,alt:"Kapwing Logo","data-cy":"header-logo",width:36,height:36})}),w.jsx("a",{className:E9.headerBarLogoText,href:f(),children:"KAPWING"})]}),w.jsx("div",{className:E9.headerMiddle,children:_()})]}),w.jsxs(d9,{children:[w.jsxs("div",{className:E9.headerRight,children:[i&&Hu()?w.jsx(q9,{currentUser:t,isMobile:u,showPaywall:d,setShowPaywall:c}):w.jsx("div",{className:E9.headerLinkText,onClick:()=>{n(!0)},"data-cy":"signin-nav-link",children:"Sign In"}),u?r?w.jsx(ve,{"data-cy":"mobile-nav-menu-toggle",className:E9.menuIcon,onClick:g}):w.jsx(Lt,{"data-cy":"mobile-nav-menu-toggle",className:E9.menuIcon,onClick:g}):null]}),s?w.jsx(bV,{hideSignIn:v,onSuccess:y}):null]})]})]})})))),Z9="Footer-module_footerText_pSvVq",e8="Footer-module_footer-link-column-link_Av4m0",t8="Footer-module_footer-link-column-link-last_iVeDd",o8="Footer-module_footer-div_w2pfL",a8="Footer-module_footer-container_ERTV0",i8="Footer-module_footer-company_Uzp5A",s8="Footer-module_footer-company-header_pIHgf",n8="Footer-module_footer-link-column_qoqNz",r8="Footer-module_footer-link-column-header_gNA8j",l8="Footer-module_footer-follow-link_UiWAy",d8="Footer-module_footer-link-column-links-container_4YPIn",c8="Footer-module_footer-instagram-icon-container_L0yKi",u8="Footer-module_footer-instagram-image_hWHel",m8="Footer-module_p_vTMHh";class p8 extends h.Component{constructor(e){super(e),i(this,"showSignIn",(e=>{e.preventDefault(),this.setState({showSignIn:!0})})),i(this,"hideSignIn",(()=>this.setState({showSignIn:!1}))),i(this,"goToAccount",(()=>{const{history:e}=this.props;e.push("/my")})),this.state={showSignIn:!1}}render(){const{currentUser:e,currentFolderId:t,signOut:o}=this.props,{showSignIn:a}=this.state,i=Pr(),s=wc(e);return w.jsxs("div",{className:o8,children:[w.jsxs("div",{className:a8,children:[w.jsxs("div",{className:i8,children:[w.jsxs("div",{className:s8,children:[w.jsx("img",{alt:"Kapwing Logo",height:50,src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",width:50}),w.jsx("a",{href:"/",children:"KAPWING"})]}),w.jsxs("div",{children:[w.jsx("a",{href:"https://twitter.com/KapwingApp",target:"_Blank",rel:"noopener noreferrer",className:l8,title:"Twitter",children:w.jsx("div",{className:c8,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/twitter-footer-light.webp",alt:"Twitter",className:u8,width:"28px",height:"28px",loading:"lazy"})})}),w.jsx("a",{href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1",target:"_Blank",rel:"noopener noreferrer",className:l8,title:"Youtube",children:w.jsx("div",{className:c8,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/yt-footer-light.webp",alt:"Youtube",className:u8,width:"28px",height:"28px",loading:"lazy"})})}),w.jsx("a",{href:"https://www.instagram.com/KapwingApp/",target:"_Blank",rel:"noopener noreferrer",className:l8,title:"Instagram",children:w.jsx("div",{className:c8,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/ig-footer-light.webp",alt:"Instagram",className:u8,width:"28px",height:"28px",loading:"lazy"})})}),w.jsx("a",{href:"https://www.tiktok.com/@kapwing",target:"_Blank",rel:"noopener noreferrer",className:l8,title:"TikTok",children:w.jsx("div",{className:c8,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/tiktok-footer-light.webp",alt:"TikTok",className:u8,width:"28px",height:"28px",loading:"lazy"})})}),w.jsx("a",{href:"https://www.facebook.com/groups/kapwing",target:"_Blank",rel:"noopener noreferrer",className:l8,title:"Facebook",children:w.jsx("div",{className:c8,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/fb-footer-light.webp",alt:"Facebook",className:u8,width:"28px",height:"28px",loading:"lazy"})})})]})]}),w.jsxs("div",{className:n8,children:[w.jsx("a",{href:"/tools",className:r8,children:"Tools"}),w.jsxs("div",{className:d8,children:[w.jsx("a",{href:"/video-editor",className:e8,children:"Video Editor"}),w.jsx("a",{href:"/subtitles",className:e8,children:"Subtitles"}),w.jsx("a",{href:"/meme-maker",className:e8,children:"Meme Generator"}),w.jsx("a",{href:"/tools/convert",className:e8,children:"Convert Video"}),w.jsx("a",{href:"/tools/trim",className:e8,children:"Video Trimmer"}),w.jsx("a",{href:"/tools/record/screen",className:e8,children:"Screen Recorder"}),w.jsx("a",{href:"/tools",className:`${e8} ${t8}`,children:"View All"})]})]}),w.jsxs("div",{className:n8,children:[w.jsx("a",{href:"/ai",className:r8,children:"AI-powered"}),w.jsxs("div",{className:d8,children:[w.jsx("a",{href:"/tools/smart-cut",className:e8,children:"Smart Cut"}),w.jsx("a",{href:"/ai-video-generator",className:e8,children:"AI Video Generator"}),w.jsx("a",{href:"/tools/remove-background/noise",className:e8,children:"Clean Audio"}),w.jsx("a",{href:"/ai/image-generator",className:e8,children:"AI Image Generator"}),w.jsx("a",{href:"/meme-maker/ai",className:e8,children:"AI Meme Generator"}),w.jsx("a",{href:"/tools/text-to-speech",className:e8,children:"Text to Speech"}),w.jsx("a",{href:"/ai/document-to-video",className:e8,children:"Document to Video"}),w.jsx("a",{href:"/ai",className:`${e8} ${t8}`,children:"View All"})]})]}),w.jsxs("div",{className:n8,children:[w.jsx("a",{href:"/templates",className:r8,children:"Templates"}),w.jsxs("div",{className:d8,children:[w.jsx("a",{href:"/templates",className:e8,children:"Video Templates"}),w.jsx("a",{href:"/meme-templates",className:e8,children:"Meme Templates"}),w.jsx("a",{href:"/templates/collage",className:e8,children:"Collage Templates"}),w.jsx("a",{href:"/templates/instagram",className:e8,children:"Instagram Video"}),w.jsx("a",{href:"/templates/popular",className:e8,children:"Popular Templates"}),w.jsx("a",{href:"/templates/edu",className:e8,children:"EDU Templates"}),w.jsx("a",{href:"/templates",className:`${e8} ${t8}`,children:"View All"})]})]}),w.jsxs("div",{className:n8,children:[w.jsx("div",{className:r8,children:"Learn"}),w.jsxs("div",{className:d8,children:[w.jsx("a",{href:"/about",className:e8,children:"About Us"}),w.jsx("a",{href:"/resources",target:"_self",className:e8,children:"Resources"}),w.jsx("a",{href:"/help",target:"_blank",rel:"noreferrer noopener",className:e8,children:"Help Center"}),w.jsx("a",{href:"/blog",target:"_self",className:e8,children:"Blog"}),w.jsx("a",{href:"/edu",className:e8,children:"EDU"}),w.jsx("a",{href:"/explore",className:e8,children:"Explore"}),w.jsx("a",{href:"/teams",className:e8,children:"Teams"}),w.jsx("a",{href:"/contact-us",className:e8,children:"Contact Us"}),s?w.jsxs(w.Fragment,{children:[w.jsx(Ft,{className:e8,to:`/folder/${t}`,children:"My Workspace"}),w.jsx(Ft,{className:e8,to:{pathname:`/folder/${t}`,state:{openModal:c9.account}},children:"My Account"}),w.jsx("div",{className:e8,onClick:o,children:"Sign out"})]}):w.jsx("div",{className:e8,onClick:this.showSignIn,children:"Sign in"}),a&&w.jsx(bV,{hideSignIn:this.hideSignIn,onSuccess:this.goToAccount})]})]}),w.jsxs("div",{className:n8,children:[w.jsx("div",{className:r8,children:"Company"}),w.jsxs("div",{className:d8,children:[w.jsx("a",{href:"/pricing",className:e8,children:"Pricing"}),w.jsx("a",{href:"/careers",className:e8,children:"Careers"}),w.jsx("a",{href:"/partnerships",className:e8,children:"Partnerships"}),w.jsx("a",{href:"/affiliates",className:e8,children:"Affiliates"}),w.jsx("a",{href:"/plugins",className:e8,children:"Plugins"}),w.jsx("a",{className:e8,href:"/help/tag/release-notes/",children:"Release Notes"}),w.jsx("a",{href:"/creators-fund",className:e8,children:"Creators Fund"}),w.jsx("a",{href:"/policies/refund",className:e8,children:"Refund Policy"}),w.jsx("a",{href:"/policies/privacy",className:e8,children:"Privacy Policy"}),w.jsx("a",{href:"/policies/terms-of-service",className:e8,children:"Terms of Service"})]})]})]}),w.jsxs("div",{className:Z9,children:["© ",(new Date).getFullYear()," Kapwing. Release ","v2023.12.22.1","—",i,".",w.jsx("p",{className:m8,children:"Made with love in San Francisco, California."})]})]})}}const h8=je(g.connect((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace})),(e=>ye({signOut:Tr},e)))(p8)),g8="EduLogin-module_background_Uy-3-",f8="EduLogin-module_backgroundImage_mlfkY",y8="EduLogin-module_signInContainer_MyMim",v8="EduLogin-module_signInHeader_60jiv",_8="EduLogin-module_signInText_-ZNvH",w8="EduLogin-module_text_ss9wC",b8="EduLogin-module_signInBox_zT-YJ",T8=_.memo((()=>{const e="EDU Program Sign In — Kapwing",t="Sign in to apply to the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return w.jsxs(w.Fragment,{children:[w.jsx(Q9,{}),w.jsxs(Mt,{children:[w.jsx("title",{children:e}),w.jsx("meta",{name:"description",content:t}),w.jsx("meta",{property:"og:title",content:e}),w.jsx("meta",{property:"og:description",content:t}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),w.jsxs("div",{className:g8,children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/U90-Kit-Bob-Background.webp",alt:"student kit and bob",className:f8}),w.jsxs("div",{className:y8,children:[w.jsx("div",{className:v8,children:"Sign in to get started with Kapwing for Education"}),w.jsx("div",{className:_8,children:w.jsx("div",{className:w8,children:"Please sign in with your official school email address."})}),w.jsx("div",{className:b8,children:w.jsx(cV,{immediateRedirectPathname:"/edu/signup"})})]})]}),w.jsx(h8,{})]})})),x8="EduSignup-module_container_8iB8J",S8="EduSignup-module_typeformBackground_zAuBk",E8="EduSignup-module_typeformWidget_Woiw9",I8=_.memo((()=>{const e=tl((e=>e.currentUser)),t=Sc(e),o=Ic(e),a=wc(e);h.useEffect((()=>{a||eE("/edu/login")}));const i=h.useMemo((()=>({kapwing_name:t,kapwing_email:o})),[t,o]),s=h.useCallback((async e=>{await Jr("/api/v1/edu/submit",{body:{userID:t,userEmail:o,responseID:e}})}),[o,t]),n="EDU Program Sign up — Kapwing",r="Sign up and apply to the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.",l=h.useCallback((e=>{s(e.responseId)}),[s]);return a&&void 0!==a?w.jsxs(w.Fragment,{children:[w.jsx(Q9,{}),w.jsxs(Mt,{children:[w.jsx("title",{children:n}),w.jsx("meta",{name:"description",content:r}),w.jsx("meta",{property:"og:title",content:n}),w.jsx("meta",{property:"og:description",content:r}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),w.jsx("div",{className:x8,children:w.jsx("div",{className:S8,children:w.jsx(we.Widget,{id:"yz2hQIEC",hidden:i,onSubmit:l,className:E8})})}),w.jsx(h8,{})]}):null})),C8=_.memo((()=>{const e="EDU Program Sign Up — Kapwing",t="Sign up as a district admin and apply for the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return w.jsxs(w.Fragment,{children:[w.jsx(Q9,{}),w.jsxs(Mt,{children:[w.jsx("title",{children:e}),w.jsx("meta",{name:"description",content:t}),w.jsx("meta",{property:"og:title",content:e}),w.jsx("meta",{property:"og:description",content:t}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),w.jsx("div",{className:x8,children:w.jsx("div",{className:S8,children:w.jsx(we.Widget,{id:"agzKsq7v",className:E8})})}),w.jsx(h8,{})]})}));const k8={home:"common-module_home_1RmXS",homeHowBackgroundWhite:"common-module_homeHowBackgroundWhite_tmS3r",largeButton:"common-module_largeButton_mqeEp",sectionContent:"common-module_sectionContent_oGtD5",sectionHeader:"common-module_sectionHeader_lqs-I",spacer:"common-module_spacer_4jJEN",chevron:"common-module_chevron_ue8Fs",splashText:"common-module_splashText_XxRuH",splashSubtext:"common-module_splashSubtext_doe31",aboutSection:"common-module_aboutSection_67WbE",mobile:"common-module_mobile_xYfSm",desktop:"common-module_desktop_r-fmO",screenReaderOnlyLabel:"common-module_screenReaderOnlyLabel_W-yva",disabled:"common-module_disabled_qze4D",noScrollBar:"common-module_noScrollBar_rA8Ld",textOverflowEllipsis:"common-module_textOverflowEllipsis_eFSw-",disableTextHighlight:"common-module_disableTextHighlight_5ewJq",genericButtonBlue:"common-module_genericButtonBlue_2nvue"};class A8 extends h.Component{constructor(e){super(e),i(this,"renderSubmitted",(()=>w.jsx("div",{className:"youre-in",children:"You're in! Thanks for signing up!"}))),this.state={emailValue:"",loading:!1,submitted:!1},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e){this.setState({emailValue:e.target.value})}handleSubmit(e){e.preventDefault();const{emailValue:t}=this.state,{source:o}=this.props;this.setState({loading:!0}),function(e,t){return Jr("/api/v1/email/add",{body:{email:e,source:t,submittedAt:new Date}})}(t,o).then((()=>{this.setState({loading:!1,submitted:!0})})).catch((e=>{mh({description:"There was an error signing up.",error:e}),this.setState({loading:!1})}))}renderCollection(){const{emailValue:e,loading:t}=this.state;return w.jsxs("form",{onSubmit:this.handleSubmit,className:"subscribe-form",children:[w.jsxs("label",{htmlFor:"email-subscribe",children:[w.jsx("span",{className:k8.screenReaderOnlyLabel,children:"Email"}),w.jsx("input",{id:"email-subscribe",placeholder:"youremail@gmail.com",type:"text",className:"primary-text-field email-subscribe-input",value:e,onChange:this.handleChange})]}),t?w.jsx("button",{type:"submit",className:"primary-button email-subscribe-button",children:"Loading..."}):w.jsx("button",{type:"submit",className:"primary-button email-subscribe-button",children:"Sign up"})]})}render(){const{submitted:e}=this.state;return w.jsx("div",{children:e?this.renderSubmitted():this.renderCollection()})}}const j8=[{id:"google",name:"Google",image:"https://i.imgur.com/qvCOvDE.jpg",logo:"https://i.imgur.com/RUYUxk0.jpg",date:"1998",description:"See the evolution of Google from the early days at Stanford to the iconic company it is today.",states:[{year:"1998",description:"The early days of Google, when Larry and Sergey still were at Stanford.",image:"https://i.imgur.com/gesKoOF.png",link:"https://web.archive.org/web/19981111183552/http://google.stanford.edu:80/"},{year:"2000",description:"Google implements its iconic, simple homepage, but still is focused on search, not any other products.",image:"https://i.imgur.com/yhmmQvJ.png",link:"https://web.archive.org/web/20000301214819/http://google.com:80/"},{year:"2002",description:"Google introduces image search, groups, and some other search features.",image:"https://i.imgur.com/Ws1RiTX.png",link:"https://web.archive.org/web/20020222232203/http://www.google.com:80/"},{year:"2004",image:"https://i.imgur.com/CuNRKyh.png",link:"https://web.archive.org/web/20040221050042/http://www.google.com:80/"},{year:"2006",description:"By 2006, Google starts looking much like the simple, centered home page of today.",image:"https://i.imgur.com/vMmprt2.png",link:"https://web.archive.org/web/20060301031331/http://www.google.com/"},{year:"2012",description:"Fast forward another 6 years, and Google simplifies its homepage further, and shifts to a header bar UI.",image:"https://i.imgur.com/WPJR94n.png",link:"https://web.archive.org/web/20120227195823/http://www.google.com/"},{year:"2016",description:"By 2006, Google starts looking much like the simple, centered home page of today.",image:"https://i.imgur.com/f8LQfDv.png",link:"https://web.archive.org/web/20060301031331/http://www.google.com/"},{year:"Today",description:"Google introduces a new, flatter logo, but still maintains its simple, uncluttered homepage.",image:"https://i.imgur.com/UnQhOkQ.png",link:"https://www.google.com/"}]},{id:"amazon",name:"Amazon",image:"https://i.imgur.com/rPSZBZY.jpg",logo:"https://i.imgur.com/g8O5Sur.jpg",date:"1999",description:"Bookseller to electronics to personalization and content creation to everything else. Here's how an ecommerce trickle turned into the Amazon",states:[{year:"1999",description:"Books take center stage on the original Amazon landing page.",image:"https://i.imgur.com/jwJsUEZ.png",link:"https://web.archive.org/web/19990828014913/http://www.amazon.com:80/"},{year:"2001",description:"Early on, Amazon prominently advertises personalized recommendations on the home page.",image:"https://i.imgur.com/XX7upff.png",link:"https://web.archive.org/web/20010630235838/http://www.amazon.com:80/exec/obidos/subst/home/home.html"},{year:"2005",description:"Introducing Amazon Prime! Two-day shipping makes its debut.",image:"https://i.imgur.com/q22junf.png",link:"https://web.archive.org/web/20050531233632/http://www.amazon.com:80/exec/obidos/subst/home/home.html"},{year:"2008",description:"Introducing Kindle. Amazon pivots towards electronics. Also, where did the search bar go?",image:"https://i.imgur.com/DsMabM8.png",link:"https://web.archive.org/web/20080301234936/http://www.amazon.com:80/"},{year:"2011",description:"The categories on the left show a clear shift towards electronics and TV.",image:"https://i.imgur.com/5nWXqaD.png",link:"https://web.archive.org/web/20110715002059/http://www.amazon.com/"},{year:"2013",description:"Amazon launches a more mobile-friendly version of the site with personalized recommendations and extended vertical scroll",image:"https://i.imgur.com/jppfbI9.png",link:"https://web.archive.org/web/20130531235338/http://www.amazon.com/"},{year:"Today",description:"Today, Amazon shows off their inventory with more visuals, less text. and bold colors.",image:"https://i.imgur.com/yqZ4QkK.png",link:"https://www.amazon.com/"}]},{id:"pinterest",name:"Pinterest",image:"https://i.imgur.com/b75lGep.png",logo:"https://i.imgur.com/OfE2Yh1.jpg",date:"2010",description:"Pinterest started with small groups of enthusiastic users, wanting to pin their favorite images from across the web.",meta:{title:"Evolution of Pinterest – Kapwing",description:"See how Pinterest evolved from an invite-only website for users to pin images to the online destination for visual inspiration for everyone."},states:[{year:"2010",description:"For a long time, joining Pinterest was by invite only. But the content was available for everyone.",image:"https://i.imgur.com/o7Xy4Jl.png",link:"https://web.archive.org/web/20110131073434/http://pinterest.com:80/"},{year:"2012",description:"By 2012, Pinterest introduced its iconic red color.",image:"https://i.imgur.com/FqL1q5v.png",link:"https://web.archive.org/web/20120131141949/https://www.pinterest.com/"},{year:"2014",description:"Pinterest quickly gained popularity for its quirky images and high quality content.",image:"https://i.imgur.com/fBs78Gv.png",link:"https://web.archive.org/web/20140812045916/http://www.pinterest.com/all/animals/"},{year:"Today",description:"Today Pinterest is a destination for ideas, especially those that involve highliy visual content.",image:"https://i.imgur.com/HvgP6fy.png ",link:"https://www.pinterest.com/"}]},{id:"facebook",name:"Facebook",image:"https://i.imgur.com/jGnmW6z.png",logo:"https://i.imgur.com/ZaZkeBt.jpg",date:"2004",description:"Watch one of the most popular websites in the world grow up!",states:[{year:"2004",description:'Facebook started as a social network for college students. You can see on their home page their claim as a "Mark Zuckerberg Production".',image:"https://i.imgur.com/8bM2yqy.png",link:"https://web.archive.org/web/19981111183552/http://google.stanford.edu:80/"},{year:"2008",description:"Facebook's landing page changes to reflect a more globally appealing service",image:"https://i.imgur.com/MnV886O.png",link:"https://web.archive.org/web/20090722142049/http://www.facebook.com/"},{year:"2009",description:"Facebook's famous Wall is used by millions to communicate with each other",image:"https://i.imgur.com/IX05Lyd.png",link:"https://web.archive.org/web/20090722142049/http://www.facebook.com/zuck"},{year:"2012",description:"Facebook turns its attention to mobile.",image:"https://i.imgur.com/5AoFmRV.png",link:"https://web.archive.org/web/20120722140441/https://www.facebook.com/"},{year:"Today",description:"The Facebook homepage has not changed much, but the product and its services definitely have",image:"https://i.imgur.com/eN3eGRb.png",link:"https://www.facebook.com/"}]},{id:"youtube",name:"YouTube",image:"https://i.imgur.com/JqulZ1O.png",logo:"https://i.imgur.com/4gegwsM.jpg",date:"2005",description:"YouTube was started by three former Paypal employees - Chad Hurley, Steve Chen, and Jawed Karim - who went on to sell the company to Google.",states:[{year:"2006",description:"In the early days of YouTube, there was a single feed that everyone consumed of popular videos on the site.",image:"https://i.imgur.com/GPZH7Z0.png",link:"https://web.archive.org/web/20060303064630/http://www.youtube.com/"},{year:"2008",description:"By 2008, Youtube had developed its iconic player and started surfacing trending video content on the web.",image:"https://i.imgur.com/Oohhd1Q.pngg",link:"https://web.archive.org/web/20080306015406/http://www.youtube.com/"},{year:"2010",description:"Youtube's integration with Google brought changes, some popular and others not so much.",image:"https://i.imgur.com/RSrULXl.png",link:"https://web.archive.org/web/20100306024813/http://www.youtube.com:80/"},{year:"2012",description:"YouTube relied heavily on Flash, and also began showing ads alongside content.",image:"https://i.imgur.com/7gXP0Vu.png",link:"https://web.archive.org/web/20120731224216/http://www.youtube.com/"},{year:"2016",description:"By 2016, YouTube had a very similar look and feel to the content today, with many popular channels for users to choose from.",image:"https://i.imgur.com/Bj3Tgy9.png",link:"https://web.archive.org/web/20160731223744/https://www.youtube.com/"},{year:"Today",description:"Today YouTube is one of the most popular video sharing sites out there!",image:"https://i.imgur.com/RwuvuZL.png",link:"https://www.youtube.com/"}]},{id:"reddit",name:"Reddit",image:"https://i.imgur.com/jUDALgT.jpg",logo:"https://i.imgur.com/bbDAN5t.jpg",date:"2005",description:"Not much has changed about Reddit's design over the last decade, until very recently. But, the community has grown to be one of the most vibrant on the internet.",states:[{year:"2005",description:"In the beginning, Reddit was just an interesting collection of links on the homepage.",image:"https://i.imgur.com/SkvHFAC.png",link:"https://web.archive.org/web/20051128021349/http://reddit.com:80/"},{year:"2007",description:"As more and more people joined the community, sub-reddits started emerging around different topics.",image:"https://i.imgur.com/2GJUO1u.png",link:"https://web.archive.org/web/20071128120627/http://reddit.com:80/"},{year:"2009",description:"Reddit's design from 2009 looks very similar to the homepage today, but note the lower number of upvotes on the homepage.",image:"https://i.imgur.com/tP2S7ug.png",link:"https://web.archive.org/web/20091125194850/http://www.reddit.com/"},{year:"2015",description:"Five years later, Reddit introduces new features like Reddit Gold, but the links remain the same.",image:"https://i.imgur.com/4d80yc7.png",link:"https://web.archive.org/web/20151125194114/https://www.reddit.com/"},{year:"Today",description:"New Reddit was just introduced, marking a shift away from its blue link design. What do you think?",image:"https://i.imgur.com/fs3zSEg.png",link:"https://www.reddit.com/"}]},{id:"airbnb",name:"Airbnb",image:"https://i.imgur.com/fBoKbXA.png",logo:"https://i.imgur.com/ncRM7O9.jpg",date:"2008",description:"From hustling on Craigslist to Unicorn status, Airbnb has grown exponentially since in lauched in 2008. Watch it become the largest hotel chain in the world.",states:[{year:"2008",description:"TechCrunch covers a YC travel startup called 'AirBed&Breakfast'. This is the screenshot from the first article.",image:"https://i.imgur.com/v7T7hej.png",link:"https://techcrunch.com/2008/08/11/airbed-and-breakfast-takes-pad-crashing-to-a-whole-new-level/"},{year:"2010",description:"The basic home page lets users search for available listings and features a few homes. The counter shows a few thousand homes available.",image:"https://i.imgur.com/2bti8rK.png",link:"https://web.archive.org/web/20100701085507/http://www.airbnb.com:80/"},{year:"2012",description:"Big, beautiful splash photos dominate the home page. Users can search for listings and discover.",image:"https://i.imgur.com/NTqW0f5.png",link:"https://web.archive.org/web/20120629225044/https://www.airbnb.com/"},{year:"2014",description:"AirBnb overlays the search UI on a gallery of featured photos. Airbnb also publishes content on cities and travel planning.",image:"https://i.imgur.com/uly4OER.png",link:"https://web.archive.org/web/20140629193814/https://www.airbnb.com/"},{year:"2016",description:"AirBnb updates their logo. Landing page full of beautiful photos to explore and inspire.",image:"https://i.imgur.com/iz8vZwk.png",link:"https://web.archive.org/web/20160602025743/https://www.airbnb.com/"},{year:"2018",description:"In the last few years, AirBnb has moved into travel experiences. The home page showcases photos of people rather than homes.",image:"https://i.imgur.com/inwtiDB.png",link:"https://www.airbnb.com"}]},{id:"twitter",name:"Twitter",image:"https://i.imgur.com/GSV165q.png",logo:"https://i.imgur.com/80f3Fb2.jpg",date:"2006",description:"The platform for short, real-time communication didn't always have it's full domain. When it started, it was known as Twttr.",meta:{title:"Evolution of Twitter – Kapwing",description:"Explore the museum of websites to see how Twitter evolved from a small community to the online destination for short, real-time communication."},states:[{year:"2006",description:"Just like any other startup, Twitter began as a small community.",image:"https://i.imgur.com/8xhyyf3.png",link:"https://web.archive.org/web/20061109073453/http://twitter.com:80/"},{year:"2008",description:"It took a while for folks to learn what Twitter was all about.",image:"https://i.imgur.com/cum4mXe.png",link:"https://web.archive.org/web/20080731045131/http://twitter.com/"},{year:"2010",description:"By 2010, the world learned about the hashtag and Twitter handles. And the service was growing, fast.",image:"https://i.imgur.com/PczLnvV.png",link:"https://web.archive.org/web/20100731060657/http://twitter.com/"},{year:"2012",description:"The basic profile that we recognize today was coming together by 2012.",image:"https://i.imgur.com/Vpv19cB.png",link:"https://web.archive.org/web/20120804170203/http://twitter.com/jack"},{year:"2015",description:"Twitter embraces flat design and creates a cleaner interface.",image:"https://i.imgur.com/BpqxxxP.png",link:"https://web.archive.org/web/20150803233857/https://twitter.com/jack"},{year:"Today",description:"It's clear that the world is becoming more and more visual, as posts on Twitter have less text and more media.",image:"https://i.imgur.com/H7foyal.png",link:"https://www.twitter.com/jack"}]},{id:"yelp",name:"Yelp",image:"https://i.imgur.com/4YN5brG.png",logo:"https://i.imgur.com/IN0Hphi.png",date:"2004",description:"Check out how Yelp soared from a dud to IPO in 7 years to became the leading platform for reviewing local businesses.",states:[{year:"2004",description:"In October, Yelp debuts as a an email-based referral network.",image:"https://i.imgur.com/csMuwiZ.jpg",link:"https://web.archive.org/web/20041014015116/http://www.yelp.com:80/home"},{year:"2005",description:"Yelp revamps its site to showcase reviews from 'real' people and motivate people to leave more reviews. Yelp receives $5M Series B in November.",image:"https://i.imgur.com/fDjMvuw.png",link:"https://web.archive.org/web/20051014001110/http://www.yelp.com:80/home"},{year:"2009",description:"Yelp goes international! The review site covers more cities, verticals, and features.",image:"https://i.imgur.com/tPeZBV5.png",link:"https://web.archive.org/web/20090226093725/http://www.yelp.com/"},{year:"2013",description:"Yelp showcases photos and enables mobile reviewing for the first time. The home page emphasizes fresh reviews and new businesses.",image:"https://i.imgur.com/u9GBTit.png",link:"https://web.archive.org/web/20130308045039/http://www.yelp.com/c/sf/food"},{year:"Today",description:"The mobile-friendly modern Yelp landing page has lots to browse and discover.",image:"https://i.imgur.com/yzQwf5h.png",link:"https://www.yelp.com"}]},{id:"yahoo",name:"Yahoo",image:"https://i.imgur.com/6D5x6zo.jpg",logo:"https://i.imgur.com/L4MA3H5.jpg",date:"1995",description:"Yahoo was the starting page for many in the earliest days of the internet.",states:[{year:"1997",description:"In the very beginning, Yahoo was a hand-curated collection of links to the most interesting pages on the web.",image:"https://i.imgur.com/T4zRjSr.png",link:"https://web.archive.org/web/19970109130853/http://www9.yahoo.com:80/"},{year:"2001",description:"Over time, the collection grew, as well as the services that Yahoo offered.",image:"https://i.imgur.com/alWc6FJ.png",link:"https://web.archive.org/web/20010614222934/http://www.yahoo.com:80/"},{year:"2003",description:"By 2003, Yahoo was the portal to the rest of the internet. It's homepage had news, sports, email, and more.",image:"https://i.imgur.com/jxycn9G.png",link:"https://web.archive.org/web/20030618011248/http://www.yahoo.com:80/"},{year:"2005",image:"https://i.imgur.com/95mqTZx.png",link:"https://web.archive.org/web/20050616111951/http://www.yahoo.com/"},{year:"2010",description:"By 2010, Yahoo had rebranded to embrace larger screens, as well as change their logo to the iconic purple color.",image:"https://i.imgur.com/o8LBSCS.png",link:"https://web.archive.org/web/20100616094317/http://www.yahoo.com/"},{year:"2014",description:"Yahoo embraces a more modern design and also struggles to find its identity in the world of social media and Google.",image:"https://i.imgur.com/gkel5vv.png",link:"https://web.archive.org/web/20140616095746/https://www.yahoo.com/"},{year:"Today",description:"The original web portal that Yahoo once was almost seems irrelevant today. But Yahoo was the original internet services pioneer.",image:"https://i.imgur.com/6LbyyXf.png",link:"https://www.yahoo.com"}]},{id:"new-york-times",name:"The New York Times",image:"https://i.imgur.com/aeJ0xx8.jpg",logo:"https://i.imgur.com/Gym4mbz.jpg",date:"2001",description:"Of course, the NYT has been around much longer than any internet company, but their online presence began around 2001.",states:[{year:"2001",description:"In the early 2000s, publishers like the NYT were still trying to find their identity online.",image:"https://i.imgur.com/k0fsABv.png",link:"https://web.archive.org/web/20010124140244/http://www2.nytimes.com:80/"},{year:"2003",description:"Over time, images became more important, and there was an increasing amount of digital content produced.",image:"https://i.imgur.com/U80nb2L.png",link:"https://web.archive.org/web/20030124140244/http://www2.nytimes.com:80/"},{year:"2008",description:"The New York Times brings its iconic print design to the web.",image:"https://i.imgur.com/Z3dkhaN.png",link:"https://web.archive.org/web/20080126085449/http://www.nytimes.com:80/"},{year:"2012",description:"By 2012, the Times has started pushing digital subscriptions amidst declinging print revenues.",image:"https://i.imgur.com/XZfD6ak.png",link:"https://web.archive.org/web/20120126092410/http://www.nytimes.com/"},{year:"2016",description:"In 2016, the Times website was simplified and looked to as an example of good journalism design on the web",image:"https://i.imgur.com/6y4HHdr.png",link:"https://web.archive.org/web/20160914235337/http://www.nytimes.com/"},{year:"Today",description:"Today's times embraces large screens, bold imagery, and eye-catching media.",image:"https://i.imgur.com/CM4KGrM.png",link:"https://www.nytimes.com"}]},{id:"product-hunt",name:"Product Hunt",image:"https://i.imgur.com/yP7Pzk9.png",logo:"https://i.imgur.com/3PeWAOV.jpg",date:"2014",description:"This go-to site for discovering new products started as a simple email list, but then grew quickly to become a large community of founders, entrepreneurs, and tech enthusiasts.",states:[{year:"2014",description:"Product Hunt was lean from the beginning, starting out as a simple list of products to upvote.",image:"https://i.imgur.com/ZlORgvU.png",link:"https://web.archive.org/web/20141001005151/http://www.producthunt.com/"},{year:"2016",description:"Product Hunt continued to grow, adding new categories and topics and expanding beyond the usual tech products.",image:"https://i.imgur.com/IubDg1T.png",link:"https://web.archive.org/web/20160731192941/https://www.producthunt.com/"},{year:"2017",description:"By 2017 Product Hunt's kitten becomes iconic in the tech community and beyond.",image:"https://i.imgur.com/fZGsprA.png",link:"https://web.archive.org/web/20170731212954/https://www.producthunt.com/"},{year:"Today",description:"Today, Product Hunt is a vibrant community that goes beyond a simple list of products. There are Q&A forums, discussions, job boards, and more that takes place on the site.",image:"https://i.imgur.com/yuAgMDi.png",link:"https://www.producthunt.com"}]},{id:"netflix",name:"Netflix",image:"https://i.imgur.com/r2nbum1.png",logo:"https://i.imgur.com/Kqrbs65.png",date:"1999",description:"Check out how Netflix grew up from a monthly DVD subscription service to a video streaming site to a content powerhouse.",meta:{title:"Evolution of Netflix – Kapwing",description:"Explore the museum of websites to see how Netflix evolved from a monthly DVD subscription service to a content powerhouse."},states:[{year:"1999",description:"Netflix launches their monthly subscription model: unlimited DVD rentals for a monthly fee.",image:"https://i.imgur.com/aR7DLVr.png",link:"https://web.archive.org/web/19990117011532/http://www.netflix.com:80/"},{year:"2003",description:"Netflix continues selling DVD subscriptions, building up their recommendations algorithm over time.",image:"https://i.imgur.com/usqc2ZB.png",link:"https://web.archive.org/web/20031003021435/http://www.netflix.com:80/Default?mqso=60141305"},{year:"2007",description:"Now the world's largest DVD rental company, Netflix launches a streaming service so that members can watch video direclty on their computer or TV.",image:"https://i.imgur.com/fNQbP8g.png",link:"https://web.archive.org/web/20071001023739/http://www.netflix.com:80/"},{year:"2010",description:"The company grows fast and acquires more than 20 million subscribers.",image:"https://i.imgur.com/Ca6sM1p.png",link:"https://web.archive.org/web/20100702101138/https://www.netflix.com/"},{year:"2013",description:'In February, Netflix debuts "House of Cards," an original TV series that earned 8 Emmy nominations.',image:"https://i.imgur.com/hdaURms.png",link:"https://web.archive.org/web/20130303055138/https://signup.netflix.com/#do-login"},{year:"2018",description:"With dozens of original shows and more than 50 Million subscribers, Netflix stock has gone up more than 10x since 2010.",image:"https://i.imgur.com/0FS9hBP.png",link:"https://www.netflix.com"}]}],N8=["startups","museum","gallery"];class R8 extends h.Component{constructor(){super(...arguments),i(this,"playVideo",(e=>{const{history:t}=this.props;t.push(`/museum-of-websites/${e.id}`)})),i(this,"renderVideoItem",(e=>w.jsxs("div",{className:"startup-demo-videos-item-container",children:[w.jsxs("div",{className:"evolution-of-products-image-container",onClick:()=>this.playVideo(e),children:[w.jsx("img",{alt:e.name,src:e.logo,className:"evolution-of-products-image"}),w.jsxs("div",{className:"startup-demo-videos-image-play-button",children:[w.jsx("span",{className:"evolution-of-products-go-button",children:"View gallery"}),w.jsx("div",{className:"evolution-of-products-overlay"})]})]}),w.jsxs("div",{className:"startup-demo-videos-item-metadata",children:[w.jsx("img",{alt:e.name,src:e.image,className:"startup-demo-videos-logo"}),w.jsx("div",{className:"startup-demo-videos-item-name",children:e.name}),w.jsx("div",{className:"startup-demo-videos-item-date",children:e.date}),w.jsx("div",{className:"startup-demo-videos-item-description",children:e.description})]})]},oe.v4())))}render(){return w.jsxs("div",{children:[w.jsxs("div",{className:"startup-videos-wrapper",children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Museum of Websites – Kapwing"}),w.jsx("meta",{name:"description",content:"Explore this hand-curated gallery featuring the evolution of famous internet companies. See the evolution of Google, Amazon, Pinterest, Reddit, and more!"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/museum-of-websites"})]}),w.jsx("div",{className:"evolution-of-products-header-container",children:w.jsxs("div",{children:[w.jsxs("div",{className:"evolution-of-products-header",children:["Museum of Websites",w.jsx("img",{src:"https://i.imgur.com/cfD5uhb.png",alt:"Museum of Websites Logo",className:"museum-of-websites-logo"})]}),w.jsx("div",{className:"evolution-of-products-description",children:"A hand-curated gallery of how famous internet companies have changed over time."}),w.jsxs("div",{className:"startup-demo-videos-share",children:[w.jsx(Ut,{url:"https://www.kapwing.com/museum-of-websites",quote:"Museum of Websites - Kapwing",className:"startup-demo-share-button",children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/museum-of-websites",title:"🦖 Museum of Websites - Kapwing",via:"kapwingapp",hashtags:N8,className:"startup-demo-share-button",children:w.jsx(Wt,{size:40,round:!0})})]}),w.jsxs("div",{className:"evolution-of-products-text",children:["Curated with love by the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",className:"evolution-of-products-header-link",children:"Kapwing"})]})]})}),w.jsxs("div",{className:"evolution-of-products-background",children:[w.jsxs("div",{className:"startup-demo-videos-list-container",children:[j8.map((e=>this.renderVideoItem(e))),w.jsx("div",{className:"startup-demo-videos-item-container",children:w.jsx("div",{className:"startup-demo-videos-image-container",children:w.jsx("img",{alt:"More to come!",src:"https://i.imgur.com/uXJdIsY.png",className:"startup-demo-videos-image"})})})]}),w.jsxs("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container",children:[w.jsxs("div",{className:"startup-demo-videos-email-subscribe",children:[w.jsx("div",{className:"startup-demo-videos-subscribe-header",children:"Looking for more?"}),w.jsx("div",{className:"startup-demo-videos-subscribe-description",children:"Sign up for our mailing list to get the latest updates:"}),w.jsx(A8,{source:"evolution-of-products"})]}),w.jsxs("div",{className:"startup-demo-videos-footer-text",children:["We're adding to the collection on a regular basis! Have a submission for a gallery? Contact us at"," ",w.jsx("a",{href:"mailto:hello@kapwing.com",children:"hello@kapwing.com"}),"!"]})]})]})]}),w.jsx(h8,{})]})}}const P8=je(R8),D8=kt((e=>[{src:e}]));class O8 extends h.Component{constructor(e){super(e),i(this,"imgNode",null),this.state={loaded:!1,isLightBoxOpen:!1},this.onImageLoad=this.onImageLoad.bind(this),this.openLightbox=this.openLightbox.bind(this),this.closeLightbox=this.closeLightbox.bind(this)}componentDidMount(){var e;const t=new window.Image;t.onload=this.onImageLoad,t.src=null==(e=this.imgNode)?void 0:e.getAttribute("src")}onImageLoad(){this.imgNode&&this.setState({loaded:!0})}openLightbox(){this.setState({isLightBoxOpen:!0})}closeLightbox(){this.setState({isLightBoxOpen:!1})}render(){const{className:e,lightBoxSrc:t,src:o}=this.props,{loaded:a,isLightBoxOpen:i}=this.state,s=["image"];e&&s.splice(0,0,e),a&&s.push("image-loaded");const n=w.jsx("img",{alt:"Click to expand",ref:e=>{this.imgNode=e},src:o,className:s.join(" "),onClick:this.openLightbox});return w.jsxs("div",{children:[n,w.jsx(Gt,{images:D8(t||o),isOpen:i,onClose:this.closeLightbox,backdropClosesModal:!0,enableKeyboardInpu:!0,showImageCount:!1})]})}}class L8 extends h.Component{constructor(e){super(e),this.state={currentProduct:void 0}}componentDidMount(){const{match:e,history:t}=this.props;if(e&&e.params&&e.params.id){const o=j8.find((t=>t.id===e.params.id));o?this.setState({currentProduct:o}):t.push("/museum-of-websites")}else t.push("/museum-of-websites")}renderTimeline(){const{currentProduct:e}=this.state;return w.jsx("div",{className:"evolution-of-products-item-timeline",children:e.states.map((e=>w.jsxs("div",{className:"evolution-of-products-item-state",children:[w.jsx("div",{className:"evolution-of-products-item-state-image-container",children:w.jsx(O8,{src:e.image,className:"evolution-of-products-item-state-image"})}),w.jsxs("div",{className:"evolution-of-products-item-state-info",children:[w.jsx("div",{className:"evolution-of-products-item-state-year",children:e.year}),e.description&&w.jsx("div",{className:"evolution-of-products-item-state-description",children:e.description}),e.link&&w.jsx("div",{className:"evolution-of-products-item-state-link-container",children:w.jsx("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:"Visit Page"})})]})]},e.link)))})}renderProduct(){const{currentProduct:e}=this.state,{meta:{title:t,description:o}={}}=e,{history:a}=this.props;return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:t}),w.jsx("meta",{name:"description",content:o}),w.jsx("link",{rel:"canonical",href:`https://www.kapwing.com/museum-of-websites/${e.id}`})]}),w.jsxs("div",{className:"evolution-of-products-item-wrapper",children:[w.jsxs("div",{className:"evolution-of-products-item-header",children:[w.jsx("div",{className:"evolution-of-products-item-back",onClick:()=>a.push("/museum-of-websites"),children:"← Back to all companies"}),w.jsx("div",{className:"evolution-of-products-item-logo-container",children:w.jsx("img",{alt:`${e.name} Logo`,className:"evolution-of-products-item-logo",src:e.image})}),w.jsx("div",{className:"evolution-of-products-header",children:e.name}),w.jsx("div",{className:"evolution-of-products-item-date",children:e.date}),w.jsx("div",{className:"evolution-of-products-item-description",children:e.description})]}),this.renderTimeline()]})]})}render(){const{currentProduct:e}=this.state;return e?this.renderProduct():null}}const F8=je(L8),M8="MapContainer-module_spacer_4NUeL",U8="MapContainer-module_footerLink_Hjx3w",B8="MapContainer-module_mapContainer_s-E1u",V8="MapContainer-module_mapTextContainer_rgv2o",W8="MapContainer-module_mapTextHeader_zQJAI",G8="MapContainer-module_mapTextDescription_2BurH",H8="MapContainer-module_mapPreviewImage_czzLc",$8="MapContainer-module_mapPreview_7vsiG",K8=_.memo((()=>w.jsxs("div",{className:B8,children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Sonoma County Fire Satellite Map — Kapwing"}),w.jsx("meta",{name:"description",content:"The Sonoma County Fire map allowed residents to see the status of their homes using satellite imagery after the Tubbs fire in November 2017."}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/sonoma-county-fire-map"}),w.jsx("meta",{property:"og:title",content:"Sonoma County Fire Satellite Map"}),w.jsx("meta",{property:"og:description",content:"This map compares the before and after of the Sonoma County fire. The imagery was taken on 10/11/2017 and is courtesy of Digital Globe."}),w.jsx("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),w.jsx("meta",{property:"og:image:url",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),w.jsx("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/sonoma-county-fire-map"})]}),w.jsxs("div",{className:V8,children:[w.jsx("div",{className:W8,children:"Sonoma County Fire Map"}),w.jsxs("div",{className:G8,children:[w.jsx("p",{children:"The Sonoma County Fire Map was a project created by Eric Lu after the Tubbs Fire in November 2017. The map allowed residents to see the status of their homes after the fires using satellite imagery, before the roads reopened."}),w.jsx("p",{children:"Eric, a long time Santa Rosa resident, created the map to help other residents see their homes."}),w.jsxs("p",{children:["The map was featured in various news outlets including the"," ",w.jsx("a",{href:"https://www.mercurynews.com/2017/10/13/before-and-after-the-fire-satellite-photos-of-santa-rosa-neighborhoods/",children:"Mercury Times"}),", the"," ",w.jsx("a",{href:"https://www.huffingtonpost.com/entry/santa-rosa-fire-3-angelsnot-in-disguise_us_59e65b00e4b0e60c4aa365d2",children:"Huffington Post"}),", and"," ",w.jsx("a",{href:"https://www.kqed.org/news/11623382/map-santa-rosa-residents-see-your-home-after-the-fires",children:"KQED"}),"."]})]}),w.jsx("div",{className:M8}),w.jsx("div",{className:$8,children:w.jsx("img",{src:"https://i.imgur.com/zZELAYl.png",alt:"Map Preview",className:H8})}),w.jsx("div",{className:$8,children:w.jsx("img",{src:"https://i.imgur.com/hfOM9Le.png",alt:"Map Preview",className:H8})}),w.jsx("div",{className:M8}),w.jsxs("div",{className:G8,children:[w.jsx("p",{children:"My heart goes out to those families who lost loved ones in the fire, and prayers for all others who were devastatingly affected."}),w.jsx("p",{children:"I am thankful for our local firefighters for risking their lives to save lives and property that night. I am so grateful for many other community members who worked tirelessly to help affected residents get back on their feet."}),w.jsx("p",{children:"Thanks for visiting the Sonoma County Fire Map and have a nice day."}),w.jsx("div",{className:U8,children:w.jsx("a",{href:"/",children:"← Return to Kapwing.com"})})]})]})]}))),z8=[{title:"This Page is Lost in Space",url:"https://i.imgur.com/A040Lxr.png",description:"You thought this mission to the moon would be a quick six month thing. Your neighbor offered to look after your dog. Your high school math teacher was impressed. He once said you wouldn’t amount to anything.You sure showed him. But now here you are, fifty feet from your spaceship with no way to get back. Your dog will be so sad. Your math teacher will be so smug. Pretty devastating.",containerStyles:{backgroundColor:"#83D9C8",color:"#5C77AC"}},{title:"This Page is Lost in the Wind",url:"https://i.imgur.com/oCkEbrA.png",description:"The child had looked so excited when the clown had presented a large red balloon. You had seen this, but in the throes of your morning commute you didn’t register it until it was too late. Who asked the government to support a fair right through Main Street during a week day anyway? Your bike barrelled right between the child and the clown and sent the balloon on its merry way. You didn’t turn back to see the damage you had done. Later you saw the balloon floating outside your office window.",containerStyles:{backgroundColor:"#D5E9F6",color:"#4E43FA"}},{title:"This Page is Buried in the Sand",url:"https://i.imgur.com/FOeYt4E.png",description:"You have never seen an ostrich head. Whenever you’re around it seems ostriches are avoiding your gaze. You came on this trip specifically to see an ostrich head, but here is this ostrich right in front of you, head invisible. You may never see an ostrich head.",containerStyles:{backgroundColor:"#EFEDFA",color:"#9F6C66"}},{title:"This Page is Broken",url:"https://i.imgur.com/g3hgqe8.png",description:"A broken clock is right twice a day. But if you just have one clock, it’s impossible to tell exactly when the clock is right. So it could be right at any moment. And that brings you to the crux of the conceptualization. What is time? Nothing but an abyss. Clocks are just false attempts to harness its power. It’s cruel really.",containerStyles:{backgroundColor:"#FFE4EA",color:"#709BFA"}},{title:"Caution! This Page is Cordoned Off",url:"https://i.imgur.com/qIufhof.png",description:"The earthquake was not good to the bike lane on your way to work. A large gap in the pavement (too big to be called a pothole) had swallowed three oblivious bikers whole. So the city had put up two pylons and yellow caution tape. Pretty frustrating for you given your propensity to do 360 jumps over the gap.",containerStyles:{backgroundColor:"#83D9C8",color:"#965418"}},{title:"This Page is Broken",url:"https://i.imgur.com/yW2W9SC.png",description:"This mug was a family heirloom. Of your neighbor. Your neighbor always loved the color, shape, and quantity of coffee held by this mug. But your neighbor moved out and left it on their porch, no explanation, no repair materials, no nothing. So you have this broken mug.",containerStyles:{backgroundColor:"#D5E9F6",color:"#2F8E89"}},{title:"This Page is Burnt to a Crisp",url:"https://i.imgur.com/WvEu0cO.png",description:"Toast takes so long to make. You stare at the toaster tapping your feet. Your laundry is in the dryer and it just dinged. Maybe you’ll take it out. After all, you have time. You take out your laundry. You fold your underwear. You think about folding your socks. You remember your toast! It is too late. It’s burnt to a crisp. The process repeats itself. You should probably figure out your toasting settings.",containerStyles:{backgroundColor:"#FFF4BB",color:"#4376C0"}},{title:"A Dog Ate this Page",url:"https://i.imgur.com/lKJiT77.png",description:"Your dog is cute but honestly a menace. Where are my shoes? Where is my graduation certificate? Where is the chocolate cake I baked for my Aunt’s birthday? And why did you take your dog to the vet on that same Thursday?!",containerStyles:{backgroundColor:"#FFE4EA",color:"#824B2"}},{title:"Don’t Cry Over Spilled Page",url:"https://i.imgur.com/oEUksmz.png",description:"Gulp. You hold back tears as the white liquid spreads across the floor from your sad looking carton. You should have bought the chocolate milk, it was clearly the better choice. And then maybe you wouldn’t have so carelessly smacked it across the room when you emphatically pointed at a bird outside. Too late now. You wipe the single tear from your eye and go fetch the mop.",containerStyles:{backgroundColor:"#FFE4EA",color:"#673164"}},{title:"Oh no! We tripped up!",url:"https://i.imgur.com/3suxlvm.png",description:"You had been told you should always check your shoes before getting up from the bleachers. Freshman were known to walk under them and tie peoples’ shoes together.",containerStyles:{backgroundColor:"#FFF4BB",color:"#180AD8"}},{title:"This Page is Wrong",url:"https://i.imgur.com/DWO5Hzg.png",description:"You have been trying for ten minutes. It’s pretty late at night and pretty dark in your room. You reach over and flick on a lamp. You feel oh so stupid. The gap in the toy is a triangle and you only have the cylinder and cube pieces. In dismay you toss the toy aside. Curse your five year old’s inability to keep track of the triangle!",containerStyles:{backgroundColor:"#D5E9F6",color:"#DF245D"}},{title:"This Page is Not on the Map",url:"https://i.imgur.com/Q2BAOd2.png",description:"You told your friends you weren’t bringing your phone, to try and experience what travel was like back in the day. You bought a map and a bottle of water and carried your camera for the money shot. But the map was from 2005 and the landscape had changed. So here you are, in the middle of a large field, that the map continues to claim is a local grocer.",containerStyles:{backgroundColor:"#83D9C8",color:"#386177"}},{title:"There’s a Leak in the Website",url:"https://i.imgur.com/U3vTGjX.png",description:"The boat had looked good to the naked eye. But you wear a very strong prescription and should have been wearing glasses. As you cling on to the bouey the coast guard had thrown at you, you watch the water rush into you beloved dingy. The leak sprays water higher and higher. Then the boat was swallowed and sunk into the abyss.",containerStyles:{backgroundColor:"#EFEDFA",color:"#684CFF"}},{title:"This Page is a Ghost",url:"https://i.imgur.com/QIxIKBH.png",description:"Once alive and now dead, this ghost appears to have some unfinished business. Could it be with you? Or the treasure hidden under the floorboards of the old mansion in the hills that may never reach its rightful owner, a compassionate school teacher in Brooklyn.",containerStyles:{backgroundColor:"#D5E9F6",color:"#5F749C"}},{title:"This Page Contains Nothing but Scraps",url:"https://i.imgur.com/kZNTPqI.png",description:"A perfectly enticing pizza box sitting on a table. You open it filled with anticipation. And find… nothing but scraps. Perhaps a half eaten crust. And a lot of grease. The anticipation turns to deep disappointment and despair. There’s nothing left!",containerStyles:{backgroundColor:"#83D9C8",color:"#386177"}},{title:"This Page is Lost",url:"https://i.imgur.com/flHudHE.png",description:"You bought a little bracelet for the express purpose of not losing your keys. You put a hook on your door specifically meant for keeping your keys. You briefly attempted to attach your keys to your phone. But here they are. In the dirt. In the park across the street from that bar you used to like but decided the last time you went that you probably wouldn’t go again. You’ll never find them.",containerStyles:{backgroundColor:"#FFF4BB",color:"#226FAB"}},{title:"This Page is in the Garbage",url:"https://i.imgur.com/Oqnene0.png",description:"When the king of racoons approached you during the fall of 2005, you were taken aback by the generosity of the offer he made and also his ability to talk. You’ve been living in harmony ever since. They pay 50% of your rent and you “forget” to take out the garbage every other week.",containerStyles:{backgroundColor:"#FFE4EA",color:"#4C76EC"}},{title:"This Page is Not Real",url:"https://i.imgur.com/hkRuanu.png",description:"The imposing figure with the trenchcoat shows you the two polaroids. One appears to show the Loch Ness monster herself in the middle of a stretch of dark water. The other shows a sasquatch picking it’s way through a dark forest. You look closer. The animal shapes are drawn on with ink. “This isn’t real!” You scream and throw the polaroids to the floor, sobbing.",containerStyles:{backgroundColor:"#EFEDFA",color:"#092048"}},{title:"This Page is Melted in the Sun",url:"https://i.imgur.com/O0DCcQy.png",description:"People questioned your desire to get strawberry. “That’s the worst flavor,” they said. But you are strong and independent so you got it anyway. And honestly, it wasn’t great. Luckily, two licks in a bike whizzed past you and knocked the cone out of your hand. “Oh no!” you yelled as the creamy pink became a mess in the dirt. But really you were happy.",containerStyles:{backgroundColor:"#FFF4BB",color:"#E896ED"}},{title:"More illustrations to come",url:"https://i.imgur.com/iRjGBZj.png",description:"We're working hard to put out new illustrations for your lost URLs. There will be many more stories and trendy images to come in the future. Stay tuned for new 404 illustrations!",containerStyles:{backgroundColor:"white",color:"black"}}],Y8="FourOFour-module_container_0yyqP",J8="FourOFour-module_headerContainer_trv8C",q8="FourOFour-module_headerText_iaNQl",X8="FourOFour-module_headerH1_zUrvB",Q8="FourOFour-module_headerH2_g-T7o",Z8="FourOFour-module_downloadAllButton_z9qN3",e6="FourOFour-module_headerImageContainer_hNc6c",t6="FourOFour-module_headerImage_uYdq3",o6="FourOFour-module_headerFooter_yvR9K",a6="FourOFour-module_shareButton_h-oGz",i6="FourOFour-module_headerFooterText_9XanJ",s6="FourOFour-module_illustrationWrapper_lyyun",n6="FourOFour-module_illustrationRow_ZBtsm",r6="FourOFour-module_illustrationContainer_8bYmu",l6="FourOFour-module_illustrationHeader_U8Flw",d6="FourOFour-module_illustrationDescription_SngMr",c6="FourOFour-module_illustration_DfJFt",u6="FourOFour-module_illustrationImage_VkzOT",m6="FourOFour-module_illustrationDownloadButton_M2z5D",p6="FourOFour-module_emailWrapper_Bh6j6",h6=["404","illustrations"];class g6 extends h.Component{renderImage(e){return w.jsxs("div",{className:r6,style:e.containerStyles,children:[w.jsx("a",{href:e.url,className:m6,target:"_blank",rel:"noopener noreferrer",children:"View full image"}),w.jsx("div",{className:c6,children:w.jsx("img",{src:e.url,alt:e.title,className:u6})}),w.jsx("div",{className:l6,children:e.title}),w.jsx("div",{className:d6,children:e.description})]})}render(){const e=[];for(let t=0;t<z8.length;t+=2)e.push(w.jsxs(_.Fragment,{children:[this.renderImage(z8[t]),this.renderImage(z8[t+1])]},t));return w.jsxs("div",{className:Y8,children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"404 Illustrations – Trendy 404 Images – Kapwing"}),w.jsx("meta",{name:"description",content:"Explore this collection of free trendy illustrations to make an eye-catching 404 error page on your website. Many more 404 error illustrations to come!"}),w.jsx("meta",{name:"keywords",content:"404 illustrations"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/404-illustrations"}),w.jsx("meta",{property:"og:title",content:"404 Illustrations - Trendy 404 page images for your next project"}),w.jsx("meta",{property:"og:description",content:"This website is a hand-crafted collection of illustrations that you can use for your website's 404 (Not Found) page. Your URL might not be found, but your user can still have a delightful experience. Many more illustrations to come!"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/2HLc0dN.jpg"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/2HLc0dN.jpg"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/2HLc0dN.jpg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/404-illustrations"})]}),w.jsxs("div",{className:J8,children:[w.jsxs("div",{className:q8,children:[w.jsx("div",{className:X8,children:"404 Illustrations"}),w.jsx("div",{className:Q8,children:"Trendy, ready to use images for your 404 page"}),w.jsx("a",{href:"https://drive.google.com/drive/folders/1yFKI9f9-R_WUhAMZnrxzATPHKaOVdCkl?usp=sharing",target:"_blank",rel:"noopener noreferrer",children:w.jsx("div",{className:Z8,children:"Download All"})}),w.jsxs("div",{className:o6,children:[w.jsxs("div",{children:[w.jsx(Ut,{url:"https://www.kapwing.com/404-illustrations",quote:"404 Illustrations - trendy, ready to use images for your 404 page",className:a6,children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/404-illustrations",title:"404 Illustrations - trendy, ready to use images for your 404 page",hashtags:h6,className:a6,children:w.jsx(Wt,{size:40,round:!0})})]}),w.jsx("div",{className:i6,children:"Curated with love by the team at Kapwing"})]})]}),w.jsx("div",{className:e6,children:w.jsx("img",{src:"https://i.imgur.com/QUC2CyX.png",alt:"Ice Cream Cone Melting",className:t6})})]}),w.jsx("div",{className:s6,children:e.map(((e,t)=>w.jsx("div",{className:n6,children:e},t)))}),w.jsx("div",{className:p6,children:w.jsx("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container",children:w.jsxs("div",{className:"startup-demo-videos-email-subscribe",children:[w.jsx("div",{className:"startup-demo-videos-subscribe-header",children:"Looking for more?"}),w.jsx("div",{className:"startup-demo-videos-subscribe-description",children:"Sign up for our mailing list to get the latest updates:"}),w.jsx(A8,{source:"404-illustrations"})]})})}),w.jsx(h8,{})]})}}function f6(e,t=!0){return{type:"SET_SOURCE_VIDEO",video:e,updateSharedDoc:t}}function y6(e,t="sourceVideo"){return{type:"SET_UPLOAD_PROGRESS_TEXT",text:e,id:t}}function v6(){return{type:"RESET_EDITOR"}}function _6(){return{type:"RESET_EDITOR_FLAGS"}}const w6="OverlayWrapper-module_overlayBackground_IgN-u",b6="OverlayWrapper-module_overlayContainer_Dbxsu",T6="OverlayWrapper-module_overlayContainerPadding_acU1f",x6="OverlayWrapper-module_exit_qhRlo",S6="OverlayWrapper-module_overlayContent_0qiec",E6="OverlayWrapper-module_overlayInput_Vxuv0";const I6=je(class extends h.Component{constructor(){super(...arguments),i(this,"escFunction",(e=>{27===e.keyCode&&this.handleClose()})),i(this,"handleClose",(()=>{const{dragUpload:e,hideDragUploadDialog:t,history:o}=this.props;e?t&&t():o.length<=1?o.push("/"):o.goBack()}))}componentDidMount(){document.addEventListener("keydown",this.escFunction,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.escFunction,!1)}getContainerStyle(){return this.props.biggerPadding?T6:b6}render(){const{showDragUploadDialog:e,handleDragUpload:t}=this.props;return w.jsxs("div",{children:[w.jsx("div",{className:w6,onClick:this.handleClose,"data-cy":"overlay-background"}),e&&t&&w.jsx("input",{className:E6,accept:"image/*,video/mp4,video/*",onClick:e=>{this.handleClose(),e.preventDefault()},onChange:e=>{t(e.target&&e.target.files)},type:"file",multiple:!0}),w.jsxs("div",{style:this.props.maxWidth?{maxWidth:`${this.props.maxWidth}px`}:void 0,className:this.getContainerStyle(),children:[w.jsx("div",{className:x6,onClick:this.handleClose,children:w.jsx(ve,{})}),w.jsx("div",{className:S6,children:this.props.children})]})]})}}),C6="DragUpload-module_dragUploadButton_BJfl-",k6="DragUpload-module_dragUploadLabel_ex8yk",A6="DragUpload-module_uploadContainer_X-54s",j6="DragUpload-module_dragUploadLabelHeader_vnj-D",N6={marginRight:10,marginBottom:5};class R6 extends h.Component{componentDidUpdate(e){this.props.files!==e.files&&this.props.handleMultiFileUpload(this.props.files)}render(){const{multiple:e,inputClassNames:t,labelClassNames:o,handleMultiFileUpload:a}=this.props;let i=C6;t&&(i+=` ${t}`);let s=k6;return o&&(s+=` ${o}`),w.jsxs("div",{className:A6,style:{height:"400px"},children:[w.jsx("input",{className:i,style:{height:"424px"},accept:this.props.returnAccepts(),onChange:e=>a(e.target&&e.target.files),type:"file",multiple:e?"multiple":null}),w.jsx("label",{htmlFor:"uploader-input",className:s,children:w.jsx("div",{children:w.jsxs("div",{className:j6,children:[w.jsx(yt,{size:23,style:N6}),"Drag here to upload"]})})})]})}}function P6(e){if(!e)return!1;if(!e.startsWith("http"))return!1;try{return new URL(e),!0}catch(IGe){return console.error(IGe),!1}}async function D6({acceptAudio:e=!0,acceptImage:t=!0,acceptVideo:o=!0,additionalAssetParams:a,progressCallback:i,analyticsCallback:s,url:n,doDuplicateHandling:r=!1}){if(!n)throw Error("No url to extract");const l={...a||{}},d=await mB({url:n,analyticsCallback:s,doDuplicateHandling:r}),{mime:c,title:u}=d;u&&(l.fileName=u);const[m]=(c||"").split(";",2)[0].split("/",2);let p=!1;switch(m){case"audio":e||(p=!0);break;case"image":t||(p=!0);break;case"video":o||(p=!0)}if(p)throw new Error("Invalid mime type");i&&i("Just a second..."),s({stage:wd.AssetCreation});const{asset:h,cmlFile:g}=await B$(n,l,d);Mz(h,g),((null==g?void 0:g.duplicate)||d.hasUploadedAssetDuplicate)&&(d.url=h.url);const f=function(e){const t=fB(e);return!!OB.includes(t||"")}(d.url);return s({requiresConversion:f}),f&&(d.requireConversion=!0,d.conversion_type=yB(d.url,d.type),d.conversion_id=await pK({asset_id:h._id,conversion_type:d.conversion_type,pastedUrl:n,resource:d.url,type:"pastedLink"})),{asset:h,cmlFile:g,extractInfo:d}}const O6=()=>{};class L6 extends h.Component{constructor(e){super(e),i(this,"handleChange",(async e=>{const{destination:t,disallowImages:o,disallowVideo:a,handleFinish:i,resetEditor:s,setProgressText:n,setSourceVideo:r,showToast:l,startUpload:d,stopUpload:c,history:u}=this.props,{pathname:m}=u.location,p=e.target.value;if(!P6(p))return void l({description:`${p} is not a valid URL`,type:"error"});if(_B(p))return void l({description:"MPD files are not currently supported. Please try a different file format.",type:"error"});let h=p.substring(0,Math.min(50,p.length));p.length>50&&(h+=" ..."),d(),n(`Fetching ${h} ...`);try{const{asset:e,extractInfo:d}=await D6({acceptAudio:!a,acceptImage:!o,acceptVideo:!a,progressCallback:n,analyticsCallback:O6,url:p}),u=d.mime||"",g="image/gif"===u,f=!g&&u&&u.startsWith("image/"),y={_id:P(),conversion_id:e.conversion_id,isGif:g,isImage:f,pastedUrl:p,source:"pastedLink",uploadedAt:new Date,...d};y.requireConversion&&(n("Converting..."),await this.pollConversion(y)),n("Finalizing..."),s();const v=i(y),_=await(null==v?Promise.resolve(!0):v);if(r(y),c(),n(""),!_)return l({description:`Sorry, that URL (${h}) didn't work.`,type:"error"}),void c();t&&!m.includes("/upgrade")&&eE(t)}catch(g){console.error(g);const{message:e}=ph(g);l({description:`Sorry, that URL (${h}) didn't work. ${e}`,type:"error"}),c()}})),this.state={pastedLink:""}}async pollConversion(e){return new Promise((t=>{const o=setInterval((async()=>{const a=await hK(e.conversion_id);a.status===qn.completed&&(e.url=a.output_url,e.asset_id=a.asset_id,delete e.local_url,clearInterval(o),t()),a.status===qn.failed&&clearInterval(o)}),5e3)}))}render(){const{pastedLink:e}=this.state,t=`upload-link-input-${P()}`;return w.jsx("div",{className:"upload-link-container",children:w.jsx("label",{htmlFor:t,children:w.jsx("input",{id:t,className:"primary-text-field upload-link-input",placeholder:"Paste a URL",value:e,onChange:this.handleChange,type:"url"})})})}}const F6=je(g.connect(void 0,(e=>ye({resetEditor:v6,setSourceVideo:f6,showToast:wl},e)))(L6)),M6=_.memo((e=>{const{handleFileUpload:t,returnAccepts:o}=e,a=`upload-button-input-${P()}`;return w.jsx("div",{className:"upload-button-container",children:w.jsxs("label",{htmlFor:a,className:"upload-button",children:["Upload",w.jsx("input",{"data-cy":"upload-input",id:a,className:"upload-button-input",accept:o(),onChange:t,type:"file"})]})})}));class U6 extends h.Component{constructor(e){super(e),this.state={loading:!1},this.saveRandom=this.saveRandom.bind(this)}async saveRandom(){const{setSourceVideo:e,destination:t,handleFinish:o,resetEditor:a,useImage:i,allowAudio:s,history:n}=this.props,{pathname:r}=n.location;this.setState({loading:!0});let l={_id:oe.v4(),asset_id:"5cb6720fbb291826f269a84d",lastModified:1511336812e3,name:"samples/GElVraM.mp4",size:594982,type:"video/mp4",uploadedAt:new Date,isGif:!1,isImage:!1,source:"upload",url:"https://cdn-useast1.kapwing.com/samples/GElVraM.mp4",mime:"video/mp4"};this.props.sample&&(l=this.props.sample),i&&(l={_id:oe.v4(),asset_id:"5cb77af3f3efea242e375232",lastModified:1511336812e3,name:"samples/DiRXHpj.jpg",size:46354,type:"image/jpg",uploadedAt:new Date,isGif:!1,isImage:!0,source:"upload",url:"https://cdn-useast1.kapwing.com/samples/DiRXHpj.jpg",mime:"image/jpg"}),e(l),s&&!this.props.sample&&(l={asset_id:"5cb6720fbb291826f269a84e",name:"samples/Summer_Love_trim.mp3",url:"https://cdn-useast1.kapwing.com/samples/Summer_Love_trim.mp3",size:1172125,mime:"audio/mp3",source:"upload",uri:"https://cdn-useast1.kapwing.com/samples/Summer_Love_trim.mp3"}),a(),this.setState({loading:!1});const d=await o(l);await(null==d?Promise.resolve(!0):d)&&t&&!r.includes("/upgrade")&&eE(t)}render(){const{loading:e}=this.state;return e?w.jsx("div",{className:"upload-separator",children:"just a second..."}):w.jsxs("div",{className:"upload-separator",children:["or"," ",w.jsx("span",{className:"upload-test-link",onClick:this.saveRandom,"data-cy":"non-studio-sample-link",children:"try a sample!"})]})}}const B6=je(g.connect(void 0,(e=>ye({setSourceVideo:f6,resetEditor:v6},e)))(U6)),V6="NonStudioUploadContainer-module_cancel_g6boc",W6="NonStudioUploadContainer-module_cancelIcon_9WNYy";class G6 extends h.Component{constructor(e){super(e),i(this,"numRetries"),i(this,"unmounted"),i(this,"uploadAndConvertData"),i(this,"fileInfo"),i(this,"startUpload",(()=>{this.unmounted||this.setState({uploading:!0})})),i(this,"stopUpload",(()=>{this.unmounted||this.setState({uploading:!1})})),i(this,"setProgressText",(e=>{const{setUploadProgressText:t}=this.props;t(e),this.unmounted||this.setState({progressText:e})})),i(this,"returnAccepts",(()=>{const{allowAudio:e,disallowImages:t}=this.props;let o="video/mp4,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv";return e&&(o+=",.mp3,.wav"),t||(o+=",image/*"),o})),i(this,"handleError",((e,t="",o=!0)=>{const{showToast:a,resetEditor:i,history:s}=this.props;let n=e;e||(n="An error occurred while uploading. Please try again later."),i(),this.setProgressText(""),a({description:n,type:"error"}),this.stopUpload(),o&&s.goBack()})),i(this,"loadMetadataBeforeUpload",(e=>{const{isSubtitler:t,isAddAudioToVideo:o}=this.props,a=document.createElement("video");a.src=e.local_url||"",a.onloadedmetadata=()=>{e.duration=a.duration;const i=((e,t=!1,o=!1)=>{const{dispatch:a}=sr();let i=!0;return!RU(Bl.UNLIMITED_EXPORT_DURATION_LIMIT)&&(e.duration||0)>240?t&&(e.duration||0)>7200?a(wl({description:"You cannot export videos longer than 2 hour, but you can upgrade to download the SRT file.",type:"error"})):t?a(wl({description:"Your file is longer than 4 minutes. Upgrade to export videos longer than 4 minutes.",type:"warning"})):o?(a(wl({description:"Your content must be under 4 minutes.",type:"error"})),i=!1):a(wl({description:"Your file is longer than 4 minutes. Trim or upgrade to export videos longer than 4 minutes.",type:"warning"})):(e.duration||0)>7200&&(t?a(wl({description:"You cannot export videos longer than 2 hour, but you can download the SRT file.",type:"error"})):o?(a(wl({description:"Your content must be under 2 hour.",type:"error"})),i=!1):a(wl({description:"Your file is longer than 2 hour. You must trim your video to publish.",type:"warning"}))),i})(e,t,o);i?this.preProcessAndUpload(e):this.stopUpload()}})),i(this,"handleResumableUpload",(e=>{const{showToast:t,setProjectName:o,projectName:a,editorPath:i}=this.props;if(""===a)if(e.name){let t=e.name;const a=t.split("."),i=a.pop();YU[i]&&(t=a.join(".")),o(t)}else null!=zU[i]&&o(zU[i]);this.setProgressText("Uploading ..."),yP({files:[{file:e}]}).then((t=>{const{read_uri:o,upload_uri:a}=t.uris[0],i=new URLSearchParams(a.split("?").slice(1).join("?"));let s=!1,n=!1;"image/gif"===e.type?s=!0:e.type.match(/.(jpg|jpeg|png)$/i)&&(n=!0);const r={_id:P(),lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,size:e.size,type:e.type,uploadedAt:new Date,url:o,isGif:s,isImage:n,bucket:hn,name:i.get("name"),blob_name:i.get("name"),source:"upload",local_url:e.local_url};this.fileInfo=r,this.uploadToGCS(a,e)})).catch((e=>{t({description:e.message,type:"error"}),this.stopUpload()}))})),i(this,"uploadToGCS",((e,t,o={})=>{const a=new XMLHttpRequest;a.open("PUT",e,!0),a.onload=()=>{this.onUploadFinish(a,t)},a.upload.onprogress=this.onUploadProgress,a.setRequestHeader("Content-Type",t.type),Object.entries(o).forEach((([e,t])=>{a.setRequestHeader(e,t)})),a.send(t),a.onerror=()=>{this.onUploadError(e,t,a.status)}})),i(this,"resumeUploadToGCS",((e,t)=>{const o=new XMLHttpRequest;o.open("PUT",e,!0),o.onload=a=>{if(308===a.target.status){const a=o.getResponseHeader("Range");if(!a)return void this.onUploadError(e,t,o.status);const i=parseInt(a.split("-").pop(),10);if(i<0)return void this.onUploadError(e,t,o.status);const s=i+1,n=t.size-1,r={"Content-Range":`bytes ${s}-${n}/${t.size}`};this.uploadToGCS(e,t.slice(s,n+1),r)}},o.upload.onprogress=e=>this.onUploadProgress(e),o.onerror=()=>{this.onUploadError(e,t,o.status)},o.setRequestHeader("Content-Range",`bytes */${t.size}`),o.send(t)})),i(this,"handleFileUpload",(async e=>{const{disallowImages:t,disallowVideo:o,showToast:a,allowedTypes:i,allowAudio:s}=this.props,n=RU(Bl.UNLIMITED_UPLOAD_SIZE_LIMIT);let r;if(this.startUpload(),this.setProgressText("Starting upload..."),e.target?[r]=e.target.files:[r]=e,r.local_url=URL.createObjectURL(r),!r)return a({description:"Please choose a file to upload.",type:"error"}),void this.stopUpload();const l=vB(r);try{const e=await AB(r.local_url,r);Object.assign(r,e)}catch(d){console.error(d)}l?s||!t||bB(l,i)?s||!o||wB(r.type)?s&&!["video/quicktime","audio/mp3","audio/mpeg","audio/wav","video/3gpp","video/avi","video/mp4","video/mpeg","video/ogg","video/webm","video/x-flv","video/x-matroska","video/x-ms-wmv"].includes(l)?(a({description:"Your audio file format is not currently supported. Currently we only support .mp3 and .wav formats.",type:"error"}),this.stopUpload()):s||wB(r.type)||bB(l,i)?await LB(r,r)?(r.conversion_type=yB(r.url,r.type),this.processConversion(r)):(r.size>6442450944?(a({description:"Your content must be under 6GB",type:"warning"}),this.stopUpload()):r.size>262144e3&&!n&&a({description:"Your upload is over 250MB. You may need to upgrade to use some Kapwing features.",type:"warning"}),r.type.includes("video")||r.type.includes("audio")?this.loadMetadataBeforeUpload(r):this.preProcessAndUpload(r)):(a({description:"Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, .ogg, .mpeg formats.",type:"error"}),this.stopUpload()):(a({description:"You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats.",type:"error"}),this.stopUpload()):(a({description:"You must choose a video to use this feature. Currently we support .mp4, .mov, .webm, .ogg, and .mpeg formats.",type:"error"}),this.stopUpload()):(a({description:"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension.",type:"error"}),this.stopUpload())})),i(this,"preProcessAndUpload",(e=>{const{resetEditor:t}=this.props;t(),e.source="local",this.handleFinish(e,!0,!0);try{gB(e,this.setProgressText,this.handleError).then((e=>{this.handleResumableUpload(e)}))}catch(IGe){console.error("error during upload ",IGe),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","checkFileAndUpload")}})),i(this,"onUploadProgress",(e=>{if(e.lengthComputable){const t=`Uploading ... ${Math.round(e.loaded/e.total*100).toString()}%`;this.setProgressText(t)}})),i(this,"onUploadError",((e,t,o)=>{if(this.numRetries<3&&o>=500)return this.resumeUploadToGCS(e,t),void(this.numRetries+=1);this.handleError("An network error occurred during upload. Please check your internet connection and try again.","onUploadError")})),i(this,"onUploadFinish",(async(e,t)=>{if(200!==e.status)return void this.handleError(e.statusText||"An error occurred during upload. Please try again.","onUploadFinish");await LB(t,t)?F$(this.fileInfo).then((async({asset:e,cmlFile:o})=>{Mz(e,o),await pK({asset_id:e._id,resource:this.fileInfo.name,type:"blob",conversion_type:t.conversion_type}).then((e=>{this.fileInfo.conversion_id=e,this.setProgressText("Converting file to mp4 ...")}));const a=setInterval((async()=>{var e;const t=await hK(this.fileInfo.conversion_id),o=`Converting file to mp4 ... ${null==(e=t.progress)?void 0:e.conversion}%`;if(this.setProgressText(o),qn.completed===t.status){const e={...this.fileInfo,url:t.output_url,conversion_id:this.fileInfo.conversion_id,asset_id:t.asset_id};delete e.local_url,this.handleFinish(e,!0,!0),clearInterval(a),this.uploadAndConvertData.timeToConvert=(Date.now()-this.uploadAndConvertData.startTime)/1e3,delete this.uploadAndConvertData.startTime,Fm(ym.UPLOAD_AND_CONVERT_ONE_OFF,this.uploadAndConvertData),this.uploadAndConvertData={}}qn.failed===t.status&&(clearInterval(a),this.uploadAndConvertData.timeToConvert=(Date.now()-this.uploadAndConvertData.startTime)/1e3,delete this.uploadAndConvertData.startTime,this.uploadAndConvertData.failed=!0,Fm(ym.UPLOAD_AND_CONVERT_ONE_OFF,this.uploadAndConvertData),this.uploadAndConvertData={},this.setProgressText("Failed to convert"),setTimeout(this.stopUpload,1e3))}),5e3)})):(this.stopUpload(),this.setProgressText(""),F$(this.fileInfo).then((({asset:e,cmlFile:t})=>{this.fileInfo.asset_id=e._id,Mz(e,t),this.handleFinish(this.fileInfo,!0,!0)})))})),i(this,"handleFinish",(async(e,t=!1,o=!1)=>{const{destination:a,handleFinish:i,history:s,setSourceVideo:n}=this.props,{pathname:r}=s.location;try{return null!=i&&i(e),t&&a&&!r.includes("/upgrade")&&eE(a),o&&n(e),!0}catch(IGe){return console.error("error during upload ",IGe),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","handleFinish",!1),!1}})),this.state={uploading:!1,progressText:""},this.numRetries=0,this.uploadAndConvertData={},this.unmounted=!1}componentWillUnmount(){this.unmounted=!0}async processConversion(e,t){e.id=P();const{destination:o}=this.props;try{this.uploadAndConvertData.size=e.size,this.uploadAndConvertData.conversionType=e.conversion_type,this.uploadAndConvertData.startTime=Date.now(),this.handleResumableUpload(e)}catch(IGe){console.error("error during upload ",IGe),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","checkFileAndUpload"),t&&eE(t)}if((new LD).isSupportedByClient()&&"/editor/convert"===o)try{(async e=>{const{dispatch:t}=sr(),o=new LD;try{t(BD.actions.updateTranscodeStatus({status:"PENDING"}));const a=e=>{t(MD(e))};await o.initialize(a);const i=await o.runCommandOnFile("-vcodec libx264 -crf 27 -preset ultrafast -threads 4",e.file,e.file.name,"output.mp4");t(BD.actions.updateTranscodeStatus({status:"FULFILLED",outputFile:i}))}catch(IGe){console.error(IGe),t(BD.actions.updateTranscodeStatus({status:"REJECTED"}))}})({file:e})}catch(IGe){console.error(IGe)}}renderUploading(){const{progressText:e}=this.state;return w.jsxs("div",{className:"upload-container",children:[w.jsxs("div",{className:"upload-loading",children:[w.jsx("div",{className:"loader upload-loader"}),w.jsx("span",{children:e||"Loading..."})]}),w.jsxs("div",{className:V6,onClick:this.stopUpload,children:[w.jsx("span",{children:"Cancel"}),w.jsx(Ht,{className:W6})]})]})}renderDragUpload(){const{hideDragUploadDialog:e}=this.props;return w.jsxs(I6,{hideDragUploadDialog:e,handleDragUpload:this.handleFileUpload,showDragUploadDialog:!0,dragUpload:!0,children:[w.jsx("div",{className:"drag-header",children:"Upload video or image"}),w.jsx(R6,{returnAccepts:this.returnAccepts,handleMultiFileUpload:this.handleFileUpload,multiple:!0})]})}renderNormalUpload(){const{destination:e,disallowImages:t,disallowVideo:o,sample:a,allowAudio:i,helperText:s,isOverlay:n=!1}=this.props,r=Du({"upload-container":!0,"upload-overlay":n});return w.jsxs("div",{className:r,children:[w.jsx(M6,{handleFileUpload:this.handleFileUpload,returnAccepts:this.returnAccepts}),w.jsx(F6,{destination:e,disallowImages:t,disallowVideo:o,handleFinish:this.handleFinish,setProgressText:this.setProgressText,startUpload:this.startUpload,stopUpload:this.stopUpload}),w.jsx(B6,{allowAudio:i,destination:e,handleFinish:this.handleFinish,sample:a,useImage:o}),w.jsx("div",{className:"upload-subtext",children:s})]})}render(){const{uploading:e}=this.state,{showDragUploadDialog:t,ffmpegReducer:o}=this.props;if("FULFILLED"===o.ffmpegStatus&&void 0!==o.outputFile&&this.fileInfo){const e={...this.fileInfo};e.source="local",e.local_url=o.outputFileUrl,this.handleFinish(e,!1,!0)}return e?this.renderUploading():t?this.renderDragUpload():this.renderNormalUpload()}}const H6=je(g.connect((e=>({currentUser:e.currentUser,projectName:e.projectName,editorPath:e.editorPath,ffmpegReducer:e.ffmpegReducer})),(e=>ye({setSourceVideo:f6,resetEditor:v6,setProjectName:SK,setUploadProgressText:y6,showToast:wl},e)))(G6));function $6(e){return{type:"SET_DIMENSIONS",dimensions:e}}function K6(e){return{type:"SET_DURATION",duration:e}}function z6(e){switch(e){case"Pridi":return"Pridi-Regular";case"Montserrat":return"Montserrat-Regular";case"Noto Sans":return"NotoSans-Regular";default:return null==e?void 0:e.replace(/ /g,"-")}}function Y6(e){return{type:"SET_NUM_LOOPS",numLoops:e}}function J6(){return{type:"MARK_AS_LOOPED"}}function q6(e){return{type:"SET_EDITOR_PATH",path:e}}const X6="LooperHome-module_home_XMs19",Q6="LooperHome-module_homeHowBackgroundWhite_7yMHF",Z6="LooperHome-module_splashText_8ObiG",e7="LooperHome-module_splashSubtext_C2J5z",t7="LooperHome-module_dottedLineContainer_FTRTa",o7="BackButton-module_backButton_ltWHd",a7="BackButton-module_buttonIcon_Y-FC8",i7="BackButton-module_buttonLabel_pI3AF",s7=_.memo((e=>{const{url:t}=e;return w.jsxs("a",{className:o7,href:t,children:[w.jsx("div",{className:a7,children:w.jsx($t,{})}),w.jsx("div",{className:i7,children:"Back"})]})}));class n7 extends h.Component{constructor(e){super(e),i(this,"handleDragEnter",(e=>{e.dataTransfer&&this.setState({dragging:!0}),e.stopPropagation()})),i(this,"handleDragLeave",(e=>{this.setState({dragging:!1}),e.stopPropagation()})),i(this,"hideDragUploadDialog",(()=>{this.setState({showDragUploadDialog:!1})})),i(this,"handleFinish",(()=>{this.props.markAsLooped(),this.props.setEditorPath("/upload/loop")})),this.state={dragging:!0,showDragUploadDialog:!1}}componentDidUpdate(e,t){const{dragging:o}=this.state;o&&!t.dragging&&this.setState({showDragUploadDialog:!0})}render(){const{showDragUploadDialog:e}=this.state;return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Loop Video Online — Upload — Kapwing"}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),w.jsx(Q9,{}),w.jsxs("div",{className:X6,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,children:[w.jsx(s7,{url:"/tools/loop"}),w.jsx("div",{className:`${Q6} ${t7}`,children:w.jsxs("div",{className:Z6,children:[w.jsx("h1",{children:"Loop Video"}),w.jsx("h2",{className:e7,children:"Upload or paste a link to a video or GIF to get started!"}),w.jsx(H6,{destination:"/editor/loop-video",disallowImages:!0,handleFinish:this.handleFinish,showDragUploadDialog:e,hideDragUploadDialog:this.hideDragUploadDialog})]})})]}),w.jsx(h8,{})]})}}const r7=g.connect(void 0,(e=>ye({markAsLooped:J6,setEditorPath:q6},e)))(n7);function l7(){return{type:"TOGGLE_REVERSE_STOP_MOTION"}}function d7(e){return{type:"SET_STOP_MOTION_CLIP_RATE",clipRate:e}}function c7(e){return{type:"SET_STOP_MOTION_SPEED",speed:e}}function u7(){return{type:"MARK_AS_STOP_MOTION"}}const m7="StopMotionHome-module_home_ampDM",p7="StopMotionHome-module_homeHowBackgroundWhite_vBIhy",h7="StopMotionHome-module_splashText_gn3Sd",g7="StopMotionHome-module_splashSubtext_E-hMP",f7="StopMotionHome-module_dottedLineContainer_iMjp1";class y7 extends h.Component{constructor(e){super(e),i(this,"handleDragEnter",(e=>{e.dataTransfer&&this.setState({dragging:!0}),e.stopPropagation()})),i(this,"handleDragLeave",(e=>{this.setState({dragging:!1}),e.stopPropagation()})),i(this,"hideDragUploadDialog",(()=>{this.setState({showDragUploadDialog:!1})})),i(this,"handleFinish",(()=>{this.props.markAsStopMotion(),this.props.setEditorPath("/upload/stop-motion")})),this.state={dragging:!0,showDragUploadDialog:!1}}componentDidUpdate(e,t){const{dragging:o}=this.state;o&&!t.dragging&&this.setState({showDragUploadDialog:!0})}render(){const{showDragUploadDialog:e}=this.state;return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Stop Motion Maker — Upload — Kapwing"}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),w.jsx(Q9,{}),w.jsxs("div",{className:m7,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,children:[w.jsx(s7,{url:"/tools/stop-motion"}),w.jsx("div",{className:`${p7} ${f7}`,children:w.jsxs("div",{className:h7,children:[w.jsx("h1",{children:"Stop Motion"}),w.jsx("h2",{className:g7,children:"Upload or paste a link to a video or GIF to get started!"}),w.jsx(H6,{destination:"/editor/stop-motion",helperText:"",disallowImages:!0,handleFinish:this.handleFinish,showDragUploadDialog:e,hideDragUploadDialog:this.hideDragUploadDialog}),!Au()&&w.jsxs("div",{className:"stop-motion-link-to-montage-maker",children:["Want to create a stop motion from images?",w.jsx("br",{}),"Use the ",w.jsx("a",{href:"/tools/make",children:"Video Maker"})," instead!"]})]})}),w.jsx(h8,{})]})]})}}const v7=[{toolsTitle:"Loop Video",toolsDescription:"Loop and repeat video online in just a few clicks. Makes it easy to lengthen a short video.",component:r7,url:"/upload/loop"},{toolsTitle:"Stop Motion Maker",toolsDescription:"Turn any video into a stop motion easily.",component:g.connect(void 0,(e=>ye({markAsStopMotion:u7,setEditorPath:q6},e)))(y7),url:"/upload/stop-motion"}],_7=()=>{const{search:e}=be();return _.useMemo((()=>new URLSearchParams(e)),[e])};const w7=_.memo((()=>{const e=Ve(),t=_7(),o=il(),a=t.get("session_id"),i=t.get("onSuccessPath"),s=i&&decodeURI(i);return h.useEffect((()=>{(async()=>{const t=await Jr("/api/v1/stripe/getCheckoutSessionInfo",{body:{session_id:a}}),{session:i}=t,{metadata:n,subscription:r}=i,{plan:l}=r,{interval:d,nickname:c}=l,{paywallModalAction:u,extraAmplitudeEventProperties:m,teamId:p,seats:h,planTier:g}=n;let f="Your upgrade was successful. Thanks for supporting our team at Kapwing by upgrading to Kapwing Pro. You can now use all Pro features in your current workspace.";u&&(f=(({action:e,currentPlan:t})=>{const o=t||$c(Cl.Pro);switch(e){case Vl.DEFAULT_PRIVACY:return"You have successfully upgraded and can now change the default privacy for your videos.";case"high-quality":return"You have successfully upgraded and you can now select high quality";case"privacy":return"You have successfully upgraded and your content has been set to private";case"subtitler":return"Your workspace has been successfully upgraded. You can now download the SRT file.";case"upload-limit":case"single-video-duration-limit":return"Your workspace has been upgraded. You may now publish your project.";case"upload-fonts":return"Your workspace has been upgraded. You can now upload custom fonts.";case Vl.REMOVE_WATERMARK:case Vl.REMOVE_30_SEC_WATERMARK:return"Your team workspace has been upgraded sucessfully. Try again to re-export your project without a watermark. Thank you for supporting Kapwing!";case Vl.MAGIC_TRANSCRIBE:case Vl.TRIM_WITH_TRANSCRIPT_TRANSCRIBE:return"Congratulations! Your workspace has been successfully upgraded. You can now generate unlimited subtitles and transcriptions.";case Vl.BRANDKIT:return"Your workspace has been succesfully upgraded. You can now save assets to Brand Kit and use them in Kapwing.";case Vl.GENERATE_IMAGES:return"Your workspace has been successfully upgraded. You can now generate images with AI.";case Vl.USE_MAGIC_FILL:return"Your workspace has been successfully upgraded. You can now create more images with Magic Fill.";default:return`Your team workspace has been successfully upgraded to the Kapwing ${o.name} plan. You can now use ${o.name} features in your current workspace.`}})({action:u,currentPlan:$c(g)})),o(wl({description:f,type:"success"}));let y="/studio/editor";s&&(y=s),e.replace(y),Jr("/api/v1/users/token/refresh").then((e=>{const{dispatch:t}=sr();t({type:"SET_TOKEN",token:e.token})})),Lp(),Gm({interval:d,planTier:c,upgradeSource:u||Vl.UNKNOWN,extraAmplitudeEventProperties:JSON.parse(m),teamId:p,quantity:h}),bl("Upgrade Workspace")})()}),[a,o,e,s]),w.jsx(Y4,{})}));function b7(e,t,o,a,i,s,n,r){let l=o,d=a,c=s,u=i;2===arguments.length&&(l=0,d=0,c=e.canvas.height,u=e.canvas.width);let m="number"==typeof n?n:.5,p="number"==typeof r?r:.5;m<0&&(m=0),p<0&&(p=0),m>1&&(m=1),p>1&&(p=1);const h=t.width,g=t.height,f=Math.min(u/h,c/g);let y,v,_,w,b=h*f,T=g*f,x=1;b<u&&(x=u/b),Math.abs(x-1)<1e-14&&T<c&&(x=c/T),b*=x,T*=x,_=h/(b/u),w=g/(T/c),y=(h-_)*m,v=(g-w)*p,y<0&&(y=0),v<0&&(v=0),_>h&&(_=h),w>g&&(w=g),e.drawImage(t,y,v,_,w,l,d,u,c)}function T7(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}const x7=Dt((async()=>(await yc((()=>import("./index-7b0d1de1.js").then((e=>e.i))),["assets/index-7b0d1de1.js","assets/vendor-3b0a39e0.js","assets/_baseAssignValue-c4be27e9.js"])).TwitterPicker)),S7=["mockup","design"],E7=["#EB144C","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#FFFFFF","#000000","#c9ba93"],I7=["#001323","#FFFFFF","#c9ba93"];class C7 extends h.Component{constructor(e){super(e),i(this,"handleBackgroundColorChange",(e=>{this.setState({canvasBackground:e.hex},(()=>{this.drawMockup()}))})),i(this,"handlePhoneColorChange",(e=>{this.setState({phoneColor:e.hex},(()=>{this.drawMockup()}))})),i(this,"changeImageFit",(e=>{this.setState({imageFit:e},(()=>{this.drawMockup()}))})),i(this,"downloadImage",(()=>{const{mostRecentImage:e}=this.state,t=function(e){const t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),i=new Uint8Array(a);for(let s=0;s<t.length;s+=1)i[s]=t.charCodeAt(s);return new Blob([a],{type:o})}(e);Kt.saveAs(t,`mobile-mockup-${Date.now()}.png`)})),i(this,"drawMockup",(()=>{const{img:e,imageFit:t,phoneColor:o,canvasBackground:a}=this.state,i=document.getElementById("mobile-mockup-canvas"),s=i.getContext("2d");s.clearRect(0,0,i.width,i.height),i.width=1024,i.height=1024,s.fillStyle=a||"rgba(1,22,39,.08)",s.fillRect(0,0,i.width,i.height);const n=i.width/2-200,r=i.height/2-414;s.fillStyle=o||"#001323",s.strokeStyle=o||"#001323",s.shadowColor=function(e){const t=T7(e);if(!t)return"rgba(5,23,39,.5)";const{r:o,g:a,b:i}=t,s=[o,a,i];return Math.round((299*s[0]+587*s[1]+114*s[2])/1e3)>125?"rgba(5,23,39,.5)":"rgba(255, 255, 255,.7)"}(a),s.shadowBlur=100,s.shadowOffsetX=0,s.shadowOffsetY=0,function(e,t,o,a,i,s,n,r){const l={tl:0,tr:0,br:0,bl:0};"number"==typeof s?(l.br=s,l.bl=s,l.tl=s,l.tr=s):Object.assign(l,s),e.beginPath(),e.moveTo(t+l.tl,o),e.lineTo(t+a-l.tr,o),e.quadraticCurveTo(t+a,o,t+a,o+l.tr),e.lineTo(t+a,o+i-l.br),e.quadraticCurveTo(t+a,o+i,t+a-l.br,o+i),e.lineTo(t+l.bl,o+i),e.quadraticCurveTo(t,o+i,t,o+i-l.bl),e.lineTo(t,o+l.tl),e.quadraticCurveTo(t,o,t+l.tl,o),e.closePath(),n&&e.fill(),(r||null==r)&&e.stroke()}(s,n,r,400,828,60,!0,!0);const l=n+20,d=r+80,c=360,u=668;console.debug(c,u),s.shadowColor="transparent",s.shadowBlur=0,s.beginPath(),s.lineWidth=1,s.strokeStyle="#888",s.rect(l,d,c,u),s.stroke(),s.fillStyle="#ddd",s.fillRect(l,d,c,u),e&&("crop"===t?b7(s,e,l,d,c,u):"fit"===t?function(e,t,o,a,i,s){const n=i/t.width,r=s/t.height,l=Math.min(n,r),d=(i-t.width*l)/2,c=(s-t.height*l)/2;i>=s?e.drawImage(t,0,0,t.width,t.height,o-d,a+c,t.width*l,t.height*l):e.drawImage(t,0,0,t.width,t.height,o+d,a+c,t.width*l,t.height*l)}(s,e,l,d,c,u):"stretch"===t?s.drawImage(e,0,0,e.width,e.height,l,d,c,u):b7(s,e,l,d,c,u));const m=i.toDataURL("image/png");this.setState({mostRecentImage:m})})),i(this,"stopUpload",(()=>{this.setState({loading:!1})})),i(this,"handleFileUpload",(e=>{const{showToast:t}=this.props;this.setState({loading:!0});const o=e.target.files[0];if(!o)return void t({description:"Please choose a file to upload.",type:"error"});if(o.type)if(["image/gif","image/jpg","image/jpeg","image/png"].includes(o.type))if(o.size>8e7)t({description:"Your content must be under 80MB",type:"error"}),this.stopUpload();else{const e=new FileReader;e.onload=e=>{const t=new Image;t.onload=()=>{this.setState({img:t}),this.drawMockup(),this.stopUpload()},t.src=e.target.result},e.readAsDataURL(o)}else t({description:"You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats.",type:"error"}),this.stopUpload();else t({description:"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension.",type:"error"}),this.stopUpload()})),this.state={loading:!1,img:void 0,imageFit:"crop",phoneColor:"#001323",canvasBackground:"#FFFFFF"}}componentDidMount(){this.drawMockup()}render(){const{loading:e,mostRecentImage:t,canvasBackground:o,phoneColor:a,imageFit:i}=this.state,s=function(e){const t=T7(e);if(!t)return"#242F40";const{r:o,g:a,b:i}=t,s=[o,a,i];return Math.round((299*s[0]+587*s[1]+114*s[2])/1e3)>125?"#242F40":"#EBECED"}(o);return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"startup-videos-wrapper",children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Mobile Mockup Generator – Kapwing"}),w.jsx("meta",{name:"description",content:"Create a beautiful mobile mockup with a custom color, screenshot, and background color in just a few clicks. After customizing, save the final mockup."}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/mobile-mockup"}),w.jsx("meta",{property:"og:title",content:"Mobile Mockup - Kapwing"}),w.jsx("meta",{property:"og:description",content:"The simplest way to create a beautiful mobile mockup. In just three clicks, choose a screenshot and download your mockup!"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/6SDNZse.png"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/6SDNZse.png"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/6SDNZse.png"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/mobile-mockup"})]}),w.jsxs("div",{className:"mobile-mockup-editor-container",style:{background:o},children:[w.jsx("div",{className:"mobile-mockup-left",children:w.jsxs("div",{className:"mobile-mockup-left-content",children:[w.jsx("div",{className:"mobile-mockup-header",style:{color:s},children:"Mobile Mockup"}),w.jsx("div",{className:"mobile-mockup-description",style:{color:s},children:"The simplest way to create a beautiful mobile mockup"}),e?w.jsx("div",{className:"mobile-mockup-upload-button-container",children:w.jsx("div",{className:"loader upload-loader"})}):w.jsx("div",{className:"mobile-mockup-upload-button-container",children:w.jsxs("label",{htmlFor:"mobile-mockup-uploader-input",children:[w.jsx("div",{className:"mobile-mockup-upload-button",children:w.jsx("div",{className:"mobile-mockup-download-button-header",children:"Choose screenshot"})}),w.jsx("input",{id:"mobile-mockup-uploader-input",accept:"image/jpg,image/png,image/jpeg",onChange:this.handleFileUpload,type:"file"})]})}),w.jsx("div",{className:"mobile-mockup-controls-container",children:["crop","fit","stretch"].map((e=>{let t="mobile-mockup-position-selector";return e===i&&(t+=" mobile-mockup-position-selector-selected"),w.jsx("div",{className:t,onClick:()=>this.changeImageFit(e),children:e},oe.v4())}))}),w.jsx(x7,{className:"mobile-mockup-twitter-picker",triangle:"hide",onChangeComplete:this.handleBackgroundColorChange,color:o,colors:E7}),w.jsx(x7,{className:"mobile-mockup-twitter-picker",triangle:"hide",onChangeComplete:this.handlePhoneColorChange,color:a,colors:I7}),w.jsx("div",{className:"mobile-mockup-download-button-container",children:w.jsx("div",{className:"mobile-mockup-download-button",children:w.jsx("div",{className:"mobile-mockup-download-button-header",onClick:this.downloadImage,children:"Download mockup"})})})]})}),w.jsx("div",{className:"mobile-mockup-right",children:w.jsxs("div",{className:"mobile-mockup-canvas-container",children:[w.jsx("canvas",{id:"mobile-mockup-canvas"}),t?w.jsx("img",{src:t,className:"mobile-mockup-most-recent-image",alt:"Generated Mobile Screenshot"}):w.jsx("div",{className:"loader upload-loader"})]})})]}),w.jsxs("div",{className:"mobile-mockup-sample-container",children:[w.jsx("img",{src:"https://i.imgur.com/Z15LwSm.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),w.jsx("img",{src:"https://i.imgur.com/eADTxZ4.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),w.jsx("img",{src:"https://i.imgur.com/LQoQlnI.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),w.jsx("img",{src:"https://i.imgur.com/c364bfG.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"})]}),w.jsxs("div",{className:"mobile-mockup-demo-container",children:[w.jsx("div",{className:"mobile-mockup-demo-header",children:"How it works"}),w.jsx("div",{className:"mobile-mockup-demo-left",children:w.jsx(O8,{src:"https://i.imgur.com/dKGqVMt.jpg",alt:"Choose a screenshot to use",className:"mobile-mockup-demo-image"})}),w.jsxs("div",{className:"mobile-mockup-demo-right",children:[w.jsx("div",{className:"mobile-mockup-demo-step-header",children:"Step 1"}),w.jsx("div",{className:"mobile-mockup-demo-step-description",children:"Choose a screenshot to use as your mockup. The most ideal size is 360x668, but any image will work!"})]})]}),w.jsxs("div",{className:"mobile-mockup-demo-container",children:[w.jsx("div",{className:"mobile-mockup-demo-left",children:w.jsx(O8,{src:"https://i.imgur.com/sxxfufO.jpg",alt:"Choose a background color",className:"mobile-mockup-demo-image"})}),w.jsxs("div",{className:"mobile-mockup-demo-right",children:[w.jsx("div",{className:"mobile-mockup-demo-step-header",children:"Step 2"}),w.jsx("div",{className:"mobile-mockup-demo-step-description",children:"Select the color of the background and the phone frame, in order to customize your mockup. You can also enter a custom color!"})]})]}),w.jsxs("div",{className:"mobile-mockup-demo-container",children:[w.jsx("div",{className:"mobile-mockup-demo-left",children:w.jsx(O8,{src:"https://i.imgur.com/vcit8Ji.png",alt:"Download your final mockup!",className:"mobile-mockup-demo-image"})}),w.jsxs("div",{className:"mobile-mockup-demo-right",children:[w.jsx("div",{className:"mobile-mockup-demo-step-header",children:"Step 3"}),w.jsx("div",{className:"mobile-mockup-demo-step-description",children:'Your mockup will be generated in real time. You can either right click the phone and save as, or you can click "Download" to save the final mockup!'})]})]})]}),w.jsx("div",{className:k8.spacer}),w.jsx("div",{className:k8.spacer}),w.jsx("div",{className:k8.spacer}),w.jsx("div",{className:k8.spacer}),w.jsx("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container",children:w.jsxs("div",{className:"startup-demo-videos-email-subscribe",children:[w.jsx("div",{className:"startup-demo-videos-subscribe-header",children:"Looking for more?"}),w.jsx("div",{className:"startup-demo-videos-subscribe-description",children:"Sign up for our mailing list to get the latest updates:"}),w.jsx(A8,{source:"mobile-mockup"})]})}),w.jsxs("div",{className:"mobile-mockup-share",children:[w.jsx(Ut,{url:"https://www.kapwing.com/mobile-mockup",quote:"Mobile Mockup - The simplest way to create a beautiful mobile mockup",className:"startup-demo-share-button",children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/mobile-mockup",title:"Mobile Mockup - The simplest way to create a beautiful mobile mockup",via:"kapwingapp",hashtags:S7,className:"startup-demo-share-button",children:w.jsx(Wt,{size:40,round:!0})}),w.jsxs("div",{className:"startup-demo-videos-text",children:["Created with love by the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",children:"Kapwing"})]})]}),w.jsx(h8,{})]})}}const k7=je(g.connect(void 0,(e=>ye({showToast:wl},e)))(C7)),A7="OverlayWrapper-module_overlayBackground_-tLeA",j7="OverlayWrapper-module_overlayContainer_695xA",N7="OverlayWrapper-module_exit_chpXg",R7="OverlayWrapper-module_overlayContent_520T1";const P7=je(class extends h.Component{render(){return w.jsxs("div",{children:[w.jsx("div",{className:A7,onClick:()=>{this.props.history.goBack()},"data-cy":"overlay-background"}),w.jsxs("div",{className:j7,children:[w.jsx("div",{className:N7,onClick:()=>{this.props.history.goBack()},children:w.jsx(ve,{})}),w.jsx("div",{className:R7,children:this.props.children})]})]})}}),D7="CreateOverlay-module_header_olnUM",O7="CreateOverlay-module_description_cHmlQ",L7=_.memo(je((()=>w.jsxs(P7,{children:[w.jsx("div",{className:D7,children:"Create MOTION"}),w.jsxs("p",{className:O7,children:["Sadly, creating a custom Motion is no longer available as of Feb 2020. Motion was a project launched in 2019 with the goal of making geometric animations from still images. You can see examples of the animations created on the ",w.jsx(Ft,{to:"/motion",children:"Motion homepage"})," as well as on the"," ",w.jsx("a",{href:"https://www.producthunt.com/posts/motion",target:"_blank",rel:"noopener noreferrer",children:"Product Hunt launch"}),"."]}),w.jsx("p",{className:O7,children:"We're happy to have brought joyful Motions to thousands of visitors over the years. Thanks for visiting our site!"}),w.jsx("p",{className:O7,children:w.jsx("a",{href:"/",children:"Visit Kapwing.com →"})})]})))),F7=je(_.memo((()=>w.jsx(zt,{children:w.jsx(Yt,{path:"/motion/create",component:L7})})))),M7="Gallery-module_container_DvCaF",U7="Gallery-module_header_0bS-A",B7="Gallery-module_gallery_NWA9Q",V7="Gallery-module_previewContainer_V10gW",W7="Gallery-module_sourceContainer_wDBk-",G7="Gallery-module_outputContainer_Bss-j",H7="Gallery-module_sourceImage_J-uY0",$7="Gallery-module_outputImage_RuZBo",K7=[{sourceUrl:"https://i.imgur.com/4FA6dDr.jpg",outputUrl:"https://i.imgur.com/5nBce1A.gif"},{sourceUrl:"https://cdn-useast1.kapwing.com/samples/source_409RSJ.jpeg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1af2514fc10e43a2d25fcb.gif"},{sourceUrl:"https://i.imgur.com/rHFKIj4.jpg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1b1afa39c6ae472dfe9db7.gif"},{sourceUrl:"https://cdn-useast1.kapwing.com/samples/source_OMGSU0.jpeg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1ae61da0208b3eee521d0d.gif"},{sourceUrl:"https://i.imgur.com/G0Ntbe7.jpg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1b1bd3cab1a1474b9fdfc5.gif"}],z7=_.memo(je((()=>w.jsxs("div",{className:M7,children:[w.jsx("div",{className:U7,children:"Or, browse the gallery:"}),w.jsx("div",{className:B7,children:K7.map((e=>w.jsxs("div",{className:V7,children:[w.jsx("div",{className:W7,children:w.jsx(O8,{src:e.sourceUrl,className:H7,alt:"Source Input"})}),w.jsx("div",{className:G7,children:w.jsx(O8,{src:e.outputUrl,className:$7,alt:"Ouput"})})]},e.sourceUrl)))})]})))),Y7="Motion-module_spacer_F62TB",J7="Motion-module_aboutSection_ypDHd",q7="Motion-module_header_y0sAj",X7="Motion-module_section_Xd66Q",Q7="Motion-module_aboutHeader_9dwPo",Z7="Motion-module_aboutSubheader_tMYQE",eee="Motion-module_aboutP_kYZls",tee="Motion-module_wrapper_YCnsy",oee="Motion-module_headerLeft_KYpQR",aee="Motion-module_headerRight_2oVEu",iee="Motion-module_headerLogoText_gX3Z7",see="Motion-module_headerButton_MxGnJ",nee="Motion-module_heroContainer_KIWOp",ree="Motion-module_heroText_BGpAs",lee="Motion-module_heroDescription_8OqNL",dee="Motion-module_heroAction_8Qla-",cee="Motion-module_footerButton_hRgDY",uee=["motion","gif"],mee=_.memo(je((()=>w.jsxs("div",{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Motion – Create Geometric Animations – Kapwing"}),w.jsx("meta",{name:"description",content:"Motion – Create Geometric Animations – Kapwing"}),w.jsx("meta",{name:"keywords",content:"watermark photo, watermark video online, add watermark, brand video, add image to video, add text to video"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/motion"}),w.jsx("meta",{property:"og:title",content:"Motion - Create Geometric Animations"}),w.jsx("meta",{property:"og:description",content:"Create stunning geometric GIFs and images from a still image. Using machine learning, this tool with recreate images with geometric shapes for a vector image effect."}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/Fxt1FYb.jpg"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/Fxt1FYb.jpg"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/Fxt1FYb.jpg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/motion"})]}),w.jsxs("div",{className:tee,children:[w.jsxs("div",{className:q7,children:[w.jsx("div",{className:oee,children:w.jsx("div",{className:iee,children:"MOTION"})}),w.jsx("div",{className:aee,children:w.jsx(Ft,{to:"/motion/create",children:w.jsx("div",{className:see,children:"CREATE"})})})]}),w.jsxs("div",{className:nee,children:[w.jsx("h1",{className:ree,children:"Create Geometric Animations"}),w.jsxs("h2",{className:lee,children:[w.jsx("b",{children:"Motion"})," uses machine learning to create stunning GIFs using geometric shapes. Get started below or see the"," ",w.jsx("a",{href:"https://github.com/kapwing/motion",target:"_blank",rel:"noopener noreferrer",children:"code on Github"}),"."]}),w.jsx("div",{className:dee,children:w.jsx(Ft,{to:"/motion/create",children:w.jsx("div",{className:cee,children:"Get Started"})})})]}),w.jsx(z7,{}),w.jsxs("div",{className:`${X7} ${J7}`,children:[w.jsxs("h3",{className:Q7,children:["More about ",w.jsx("b",{children:"Motion"})]}),w.jsx("div",{className:Z7,children:"Create beautiful geometric animations from your images"}),w.jsxs("div",{className:eee,children:[w.jsx("b",{children:"MOTION"})," is an exploration of geometry, video, and machine learning. By using ML techniques, the tool generates shapes to fit the lines and colors of your image."]}),w.jsx("div",{className:eee,children:"We wanted to create a tool that could make short looping videos from still images, and the abstract effect created by geomatric shapes has always been a source of inspiration. With a unique hill-climbing algorithm, we were able to convert still photographs into beautiful, moving GIFs."}),w.jsxs("div",{className:eee,children:[w.jsx("b",{children:"About the options:"})," Choose from a variety of shapes to create different outputs from a single image. Because there is a component of randomness, each output will be unique."]}),w.jsxs("div",{className:eee,children:["The project was inspired by"," ",w.jsx("a",{href:"https://primitive.lol/",target:"_blank",rel:"noopener noreferrer",children:"Primitive"})," ","as well as"," ",w.jsx("a",{href:"https://github.com/Tw1ddle/geometrize",target:"_blank",rel:"noopener noreferrer",children:"Geometrize"}),". The stitching of frames into GIFs is made possible by"," ",w.jsx("a",{href:"https://www.ffmpeg.org/",target:"_blank",rel:"noopener noreferrer",children:"FFMPEG"})," ","and"," ",w.jsx("a",{href:"https://www.imagemagick.org/script/index.php",target:"_blank",rel:"noopener noreferrer",children:"ImageMagick"}),". For the full repo, check out the"," ",w.jsx("a",{href:"https://github.com/kapwing/motion",target:"_blank",rel:"noopener noreferrer",children:"code on Github"}),"."]})]})]}),w.jsx("div",{className:nee,children:w.jsx("div",{className:dee,children:w.jsx(Ft,{to:"/motion/create",children:w.jsx("div",{className:cee,children:"Create MOTION"})})})}),w.jsx("div",{className:Y7}),w.jsx("div",{className:Y7}),w.jsxs("div",{className:"share-footer",children:[w.jsx(Ut,{url:"https://www.kapwing.com/motion",quote:"Motion - turn your photo into a geometric GIF, powered by machine learning.",className:"startup-demo-share-button",children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/motion",title:"Motion - turn your photo into a geometric GIF, powered by machine learning",via:"kapwingapp",hashtags:uee,className:"startup-demo-share-button",children:w.jsx(Wt,{size:40,round:!0})}),w.jsxs("div",{className:"startup-demo-videos-text",children:["Created with love by the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",children:"Kapwing"})]})]}),w.jsx(F7,{}),w.jsx(h8,{})]})))),pee=()=>{const e=il(),t=Ve();return h.useEffect((()=>{!async function(){const o=sh.get("GOOGLE_ONE_TAP_RESPONSE",{disabled:""})||"";o?(sh.remove("GOOGLE_ONE_TAP_RESPONSE"),await T9(o,!0).catch((t=>{((t,o="signIn",a="Sign In")=>{let i=t;t||(i="An error occurred during sign in with One Tap. Please try again later."),Fm(ym.SIGN_IN_ERROR_OCCURRED,{"Error Type":o,Details:a,"One-Tap":!0}),e(wl({description:i,type:"error"}))})(t.message,"fetchGoogleUser")})),t.push("/")):t.push("/signin")}()}),[e,t]),w.jsx(Y4,{})},hee="NewTabStretches-module_container_kt8At",gee="NewTabStretches-module_content_89ftM",fee="NewTabStretches-module_header_ERNeR",yee="NewTabStretches-module_icon_Ru5CL",vee="NewTabStretches-module_share_1gUqo",_ee="NewTabStretches-module_shareButton_jErDV",wee="NewTabStretches-module_title_AynMX",bee="NewTabStretches-module_subtitle_6sxPV",Tee="NewTabStretches-module_video_xprXb",xee="NewTabStretches-module_downloadButton_pva4g",See="NewTabStretches-module_buttonLabel_HlqCe",Eee="NewTabStretches-module_buttonChromeLogo_m76Jy",Iee="NewTabStretches-module_body_ncn9O",Cee="NewTabStretches-module_explainer_r8Rbh",kee="NewTabStretches-module_photo_tqx23",Aee="NewTabStretches-module_coverImage_pGyim",jee=["stretch","yoga","working from home"],Nee=_.memo((()=>w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"New Tab Stretches - Chrome Extension – Kapwing"}),w.jsx("meta",{name:"description",content:"Use the New Tab Stretches Chrome extension to improve your flexibility while working from home. Start getting reminders to stretch right after installing!"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/new-tab-stretches"}),w.jsx("meta",{property:"og:title",content:"New Tab Stretches — Kapwing"}),w.jsx("meta",{property:"og:description",content:"New Tab Stretches is a Chrome extension that reminds you to stretch your body while you're working from home. Whenever you open a new tab in Chrome, New Tab Stretches will show you a new stretch that you could do right in your office or even at your desk. Just follow the graphic and the on screen instructions and start stretching more throughout the day!"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/BQ0WNy7.png"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/BQ0WNy7.png"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/BQ0WNy7.png"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/new-tab-stretches"})]}),w.jsxs("div",{className:hee,children:[w.jsxs("header",{className:fee,children:[w.jsx("img",{src:"https://i.imgur.com/1HWhtMo.jpg",alt:"New Tab Stretches Icon",width:"40",height:"40",className:yee}),w.jsxs("div",{className:vee,children:[w.jsx(Ut,{url:"https://www.kapwing.com/new-tab-stretches",quote:"New Tab Stretches - Improve your flexibility with every new tab",className:_ee,children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/new-tab-stretches",title:"New Tab Stretches - Improve your flexibility with every new tab",via:"kapwingapp",hashtags:jee,className:_ee,children:w.jsx(Wt,{size:40,round:!0})})]})]}),w.jsxs("main",{className:gee,children:[w.jsx("h1",{className:wee,children:"New Tab Stretches"}),w.jsx("div",{className:bee,children:"Improve your flexibility with every new tab."}),w.jsx("div",{className:Aee,children:w.jsx("video",{src:"https://cdn-useast1.kapwing.com/static/new-tab-stretches.mp4",autoPlay:!0,muted:!0,className:Tee,controls:!0,loop:!0})}),w.jsx("a",{href:"https://chrome.google.com/webstore/detail/bfacamkncebkphfahhljkjkhpinmicof",target:"_blank",rel:"noopener noreferrer",children:w.jsxs("button",{type:"button",className:xee,children:[w.jsx("div",{className:Eee,children:w.jsx(Jt,{})}),w.jsx("div",{className:See,children:"Add New Tab Stretches to Chrome"})]})}),w.jsx("div",{className:Iee,children:w.jsxs("div",{className:Cee,children:[w.jsx("p",{children:"New Tab Stretches is a Chrome extension that reminds you to stretch your body while you're working from home. Whenever you open a new tab in Chrome, New Tab Stretches will show you a new stretch that you could do right in your office or even at your desk."}),w.jsx("p",{children:"The current COVID-19 situation has our whole team working from home. Gyms and many public areas are all closed. Since it's hard to get moving, we end up sitting at our desk for hours at a time."}),w.jsx("div",{children:w.jsx("img",{src:"https://i.imgur.com/NAtTr6Q.jpg",className:kee,alt:"Quad stretch"})}),w.jsx("p",{children:"New Tab Stretches is a small way to remind yourself to stay healthy and active throughout the day. Whether you're working intensely on a new project or just spending time browsing the web, the set of illustrations in your new tab can serve as a small reminder to move around. Many of the stretches can be done without having to get up from your computer, and all of the stretches can be done right near your desk."}),w.jsx("p",{children:"There's nothing special that you need to do in order to get set up and get started with this extension. Just install it directly from the Chrome extension store, and it will start working on your next new tab. You don't even need to restart your browser."}),w.jsx("div",{children:w.jsx("img",{src:"https://i.imgur.com/glTpHA6.jpg",className:kee,alt:"Neck stretch"})}),w.jsx("p",{children:"We worked with a professional illustrator to create original drawings of a diverse set of models who represent the many different types of people who could benefit from stretching throughout the day. We're also trying to improve the number of stretches in the extension as we create more illustrations and learn more stretches!"}),w.jsx("div",{children:w.jsx("img",{src:"https://i.imgur.com/bGdcmpS.jpg",className:kee,alt:"Calf stretch"})}),w.jsx("p",{children:"We hope that this extension can be a way to help in a small way throughout this pandemic. Thanks for sharing it with your friends!"}),w.jsx("p",{children:w.jsx("a",{href:"https://chrome.google.com/webstore/detail/bfacamkncebkphfahhljkjkhpinmicof",target:"_blank",rel:"noopener noreferrer",children:w.jsxs("button",{type:"button",className:xee,children:[w.jsx("div",{className:Eee,children:w.jsx(Jt,{})}),w.jsx("div",{className:See,children:"Add New Tab Stretches to Chrome"})]})})}),w.jsxs("p",{children:["Made with love by the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer",children:"Kapwing"}),"."]})]})})]})]})]}))),Ree="NotFound-module_notFoundContainer_FbIpq",Pee="NotFound-module_notFoundImageContainer_3O6EM",Dee="NotFound-module_notFoundImage_RU2Pw",Oee="NotFound-module_link_MCVdM",Lee="NotFound-module_bigTitle_hjw-2",Fee="NotFound-module_title_qFNuj",Mee=_.memo((()=>{const e="Page Not Found — 404 — Kapwing",t="Sorry, the page you were looking for cannot be found. Our team at Kapwing is investigating this 404 error. In the meantime, please return to Kapwing.com to continue browsing.";return w.jsxs(w.Fragment,{children:[w.jsx(Q9,{}),w.jsxs(Mt,{children:[w.jsx("title",{children:e}),w.jsx("meta",{name:"description",content:t}),w.jsx("meta",{name:"keywords",content:"404, Page Not Found"}),w.jsx("meta",{property:"og:title",content:e}),w.jsx("meta",{property:"og:description",content:t}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),w.jsx("div",{className:Ree,children:w.jsxs("div",{children:[w.jsx("div",{className:Pee,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/MHZ-404.webp",alt:"Not Found Kitten",className:Dee})}),w.jsx("h1",{className:Lee,children:"404 — Page Not Found"}),w.jsx("div",{className:Fee,children:"Sorry, the page you were looking for cannot be found."}),w.jsx("div",{className:Fee,children:w.jsx("a",{href:"/",className:Oee,children:"Click here to return home."})})]})}),w.jsx(h8,{})]})})),Uee=je(g.connect(void 0,(e=>ye({receiveUserAndSetToken:sp,setOnboarding:ul,setWorkspaces:ab,setTeams:kp,showToast:wl},e)))((e=>{const{showToast:t,receiveUserAndSetToken:o,setOnboarding:a,setWorkspaces:i,setTeams:s}=e,n=Ve(),r=be(),l=tl((e=>e.sessionValues.onboarding));return h.useEffect((()=>{!async function(){const e=new URLSearchParams(r.search||""),d=e.get("code"),c=new URLSearchParams(e.get("state")||""),u=c.get("pathname")||"/",m=c.get("goToNext"),p=e=>{n.replace(u),t({description:e,type:"error"}),Fm(ym.SIGN_IN_ERROR_OCCURRED,{"Error Type":"googleResponse",Details:e})};if(d)try{const e=await Jr("/api/v1/users/google/loginWithOAuth",{body:{code:d}});o(e.user,e.token),Wm(e.user,e.newUser,"Google",!1),Zm(e.user,e.newUser,"Google",u),PU(),e.newUser&&a({...l,newUser:!0}),e.workspace&&i([e.workspace]),e.team?s([e.team]):await Op(),n.replace(u),m&&n.push(m)}catch(IGe){const{message:t}=ph(IGe);p(t||"An error occured while confirming Google authorization.")}else p("Missing Google authorization code.")}()}),[]),w.jsx(Y4,{})}))),Bee=["rickroll","aprilfools"];class Vee extends h.Component{constructor(){super(...arguments),i(this,"installRickRoller",(()=>{window.open("https://chrome.google.com/webstore/detail/mjklaailjabbidpmbngdceejclkbikib","_blank")}))}render(){return w.jsxs("div",{children:[w.jsxs("div",{className:"startup-videos-wrapper",children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Rick Roller – Kapwing"}),w.jsx("meta",{name:"description",content:"Use this free Chrome extension to Rick Roll friends who forget to lock their computer or leave their computer unattended. Let the rick-rolling begin!"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/rick-roller"}),w.jsx("meta",{property:"og:title",content:"Rick Roller - Kapwing"}),w.jsx("meta",{property:"og:description",content:"A Chrome extension to Rick Roll friends who forget to lock their computer"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/HWgjbJ0.jpg"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/HWgjbJ0.jpg"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/HWgjbJ0.jpg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/rick-roller"})]}),w.jsx("div",{className:"startup-demo-videos-header-container",children:w.jsxs("div",{children:[w.jsx("div",{children:w.jsx("img",{src:"https://i.imgur.com/wU6NJAI.jpg",alt:"Rick Roller Logo",className:"rick-roller-logo"})}),w.jsx("div",{className:"rick-roller-header",children:"Rick Roller"}),w.jsx("div",{className:"rick-roller-description",children:"A Chrome extension to Rick Roll friends who forget to lock their computer"}),w.jsx("div",{className:"rick-roller-download-container",children:w.jsxs("button",{type:"button",className:"rick-roller-download-button",onClick:this.installRickRoller,children:[w.jsx("div",{className:"rick-roller-download-button-chrome-logo",children:w.jsx(Jt,{})}),w.jsx("div",{className:"rick-roller-download-button-header",children:"Add to Chrome"}),w.jsx("div",{className:"rick-roller-download-button-description",children:"(do it on your friend's computer)"})]})}),w.jsxs("div",{className:"rick-roller-demo-container",children:[w.jsx("div",{className:"rick-roller-demo-header",children:"How it works"}),w.jsx("div",{className:"rick-roller-demo-left",children:w.jsx(O8,{src:"https://i.imgur.com/j8DZRFK.png",alt:"Download the extension screenshot",className:"rick-roller-demo-image"})}),w.jsxs("div",{className:"rick-roller-demo-right",children:[w.jsx("div",{className:"rick-roller-demo-step-header",children:"Step 1"}),w.jsx("div",{className:"rick-roller-demo-step-description",children:"When your friend leaves their computer unlocked, install the Rick Roller extension on the Chrome browser on their computer."})]})]}),w.jsxs("div",{className:"rick-roller-demo-container",children:[w.jsx("div",{className:"rick-roller-demo-left",children:w.jsx(O8,{src:"https://i.imgur.com/H9yF65L.jpg",alt:"Watch your friend click a link",className:"rick-roller-demo-image"})}),w.jsxs("div",{className:"rick-roller-demo-right",children:[w.jsx("div",{className:"rick-roller-demo-step-header",children:"Step 2"}),w.jsx("div",{className:"rick-roller-demo-step-description",children:"Once the extension is installed, wait for your friend to click some links for the fun to begin!"})]})]}),w.jsxs("div",{className:"rick-roller-demo-container",children:[w.jsx("div",{className:"rick-roller-demo-left",children:w.jsx(O8,{src:"https://i.imgur.com/NEXyAsU.jpg",alt:"Wait and watch them get rick rolled!",className:"rick-roller-demo-image"})}),w.jsxs("div",{className:"rick-roller-demo-right",children:[w.jsx("div",{className:"rick-roller-demo-step-header",children:"Step 3"}),w.jsx("div",{className:"rick-roller-demo-step-description",children:"Your friend gets randomly rick roll'd while browsing the web. Have fun!"})]})]})]})}),w.jsx("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container",children:w.jsxs("div",{className:"startup-demo-videos-email-subscribe",children:[w.jsx("div",{className:"startup-demo-videos-subscribe-header",children:"Looking for more?"}),w.jsx("div",{className:"startup-demo-videos-subscribe-description",children:"Sign up for our mailing list to get the latest updates:"}),w.jsx(A8,{source:"rick-roll"})]})}),w.jsxs("div",{className:"rick-roller-share",children:[w.jsx(Ut,{url:"https://www.kapwing.com/rick-roller",quote:"Rick Roller - an extension to Rick Roll your friends",className:"startup-demo-share-button",children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/rick-roller",title:"Rick Roller - an extension to Rick Roll your friends",via:"kapwingapp",hashtags:Bee,className:"startup-demo-share-button",children:w.jsx(Wt,{size:40,round:!0})}),w.jsxs("div",{className:"startup-demo-videos-text",children:["Created with love by the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",children:"Kapwing"})]})]})]}),w.jsx(h8,{})]})}}const Wee="Sidedoor-module_container_yhbWF",Gee="Sidedoor-module_headerBar_6X8wc",Hee="Sidedoor-module_hero_hGi0x",$ee="Sidedoor-module_heroHeader_osl7K",Kee="Sidedoor-module_heroSubheader_3nDYp",zee="Sidedoor-module_heroButtons_tiMDO",Yee="Sidedoor-module_heroButton_EaauJ",Jee="Sidedoor-module_sectionLight_6Phc-",qee="Sidedoor-module_sectionSmall_np57A",Xee="Sidedoor-module_sectionLarge_-3HOX",Qee="Sidedoor-module_sectionRight_sxdyH",Zee="Sidedoor-module_sectionHeader_Yi-eu",ete="Sidedoor-module_sectionSubheader_6IRjK",tte="Sidedoor-module_sectionLeft_5SXGj",ote="Sidedoor-module_sectionImage_9C-og",ate="Sidedoor-module_sectionButtons_ulfEY",ite="Sidedoor-module_sectionButton_j3tAp",ste="Sidedoor-module_howItWorks_rzT-d",nte="Sidedoor-module_howItWorksBullet_kws9z",rte="Sidedoor-module_howItWorksBulletNumber_9995R",lte="Sidedoor-module_howItWorksBulletDescription_Ifyb-",dte="Sidedoor-module_testimonials_kmFJr",cte="Sidedoor-module_testimonialsHeader_Ruz6u",ute="Sidedoor-module_testimonial_PqYY8",mte="Sidedoor-module_testimonialImageContainer_8IbSI",pte="Sidedoor-module_testimonialImage_ET-jj",hte="Sidedoor-module_testimonialName_xdK1r",gte="Sidedoor-module_footer_Ac-fS",fte="Sidedoor-module_footerHeader_88hLa",yte="Sidedoor-module_footerDescription_qsFZR",vte="Sidedoor-module_bestsellers_Rsgso",_te="Sidedoor-module_bestsellersItem_cXYcg",wte="Sidedoor-module_bestsellersItemInner_XuSa-",bte="Sidedoor-module_bestsellersHeader_Hs36r",Tte="Sidedoor-module_bestsellersLeft_K-kFT",xte="Sidedoor-module_bestsellersRight_DOVYN",Ste="Sidedoor-module_bestsellersImageContainer_IuzNS",Ete="Sidedoor-module_bestsellersImage_WPOlQ",Ite="Sidedoor-module_bestsellersName_XZkP-",Cte="Sidedoor-module_bestsellersDescription_pwM7-",kte="Sidedoor-module_bestsellersButtonContainer_SGLx9",Ate="Sidedoor-module_bestsellersButton_hlZkZ",jte="Sidedoor-module_returnContainer_8tbxt",Nte="Sidedoor-module_startupDemoShareButton_uxH4S",Rte=["college","accepted"];class Pte extends h.Component{render(){return w.jsxs("div",{className:gte,children:[w.jsx("div",{className:fte,children:"About Sidedoor"}),w.jsxs("div",{className:yte,children:["Sidedoor is a side-business created with love by the team at"," ",w.jsx("a",{href:"/",children:"Kapwing"}),". If you find it useful, please help spread the love with a share!"]}),w.jsxs("div",{className:yte,children:[w.jsx(Ut,{url:"https://www.kapwing.com/sidedoor",quote:"Sidedoor - College acceptance simplified",className:Nte,children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/sidedoor",title:"Sidedoor - College acceptance simplified",hashtags:Rte,className:Nte,children:w.jsx(Wt,{size:40,round:!0})})]})]})}}class Dte extends h.Component{render(){return w.jsx("div",{className:Gee,children:w.jsx(Ft,{to:"/sidedoor",children:"Sidedoor"})})}}const Ote=[{name:"Lori Loughlin",image:"https://i.imgur.com/BAa9OWe.jpg",description:"American actress"},{name:"Bill McGlashan",image:"https://i.imgur.com/422a6G7.png",description:"Founder of TGP Growth"},{name:"Chris Schaepe",image:"https://i.imgur.com/rIVdoFX.png",description:"Co-founder of Lightspeed Venture Partners"},{name:"Gamal Aziz",image:"https://i.imgur.com/dnChPbR.jpg",description:"President of Wynn Resorts"},{name:"Felicity Huffman",image:"https://i.imgur.com/KjioaI2.png",description:"American Actress"},{name:"You?",image:"https://i.imgur.com/u7fAmA2.png",description:"Our next happy partner!"}];class Lte extends h.Component{constructor(e){super(e),MY({fontToLoad:{type:"default",fontFamily:"Rubik"}})}render(){return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Sidedoor - College Acceptance Simplified"}),w.jsx("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),w.jsx("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),w.jsx("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor"})]}),w.jsxs("div",{className:Wee,children:[w.jsx(Dte,{}),w.jsxs("div",{className:Hee,children:[w.jsx("div",{className:$ee,children:"College acceptance simplified"}),w.jsxs("div",{className:Kee,children:["Somewhere along the way, getting into college became too hard. We thought, there must be a better way. Introducing ",w.jsx("b",{children:"Sidedoor"}),"."]}),w.jsxs("div",{className:zee,children:[w.jsx(Ft,{to:"/sidedoor/ivy-league",children:w.jsx("div",{className:Yee,children:"Shop Ivy League"})}),w.jsx(Ft,{to:"/sidedoor/west-coast",children:w.jsx("div",{className:Yee,children:"Shop West Coast"})})]})]}),w.jsxs("div",{className:Jee,children:[w.jsx("div",{className:qee,children:"Trusted, easy, and affordable"}),w.jsx("div",{className:Xee,children:"Your acceptance, guaranteed."})]}),w.jsxs("div",{children:[w.jsxs("div",{className:tte,children:[w.jsx("div",{className:Zee,children:"Ivy League"}),w.jsx("div",{className:ete,children:"You've always forged your own path. You're not the kind to run with the crowd. So why apply just like everyone else?"}),w.jsx("div",{className:ate,children:w.jsx(Ft,{to:"/sidedoor/ivy-league",children:w.jsx("div",{className:ite,children:"Shop Ivy League"})})})]}),w.jsx("div",{className:Qee,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/0a963c_c7763f3a5bc54773b082bf24cf22c6cd_mv2_d_2048_1365_s_2.jpg",className:ote,alt:"college boys"})})]}),w.jsxs("div",{children:[w.jsx("div",{className:tte,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/jason-leung-417009-unsplash.jpg",className:ote,alt:"stanford"})}),w.jsxs("div",{className:Qee,children:[w.jsx("div",{className:Zee,children:"West Coast"}),w.jsx("div",{className:ete,children:"Sunshine, startups, and surfing. Home to burritos and the Warriors. Your golden future awaits."}),w.jsx("div",{className:ate,children:w.jsx(Ft,{to:"/sidedoor/west-coast",children:w.jsx("div",{className:ite,children:"Shop West Coast"})})})]})]}),w.jsxs("div",{className:ste,children:[w.jsx("div",{className:Zee,children:"How it works"}),w.jsxs("div",{className:nte,children:[w.jsx("div",{className:rte,children:"1"}),w.jsx("div",{className:lte,children:"Take your SATs with one of our trusted proctors. They'll make sure you get the scores you need."})]}),w.jsxs("div",{className:nte,children:[w.jsx("div",{className:rte,children:"2"}),w.jsx("div",{className:lte,children:"Fill out an athletic profile. Don't worry - you don't need to have any actual athletic background."})]}),w.jsxs("div",{className:nte,children:[w.jsx("div",{className:rte,children:"3"}),w.jsx("div",{className:lte,children:"Sidedoor works directly with coaches to make sure that your acceptance is guaranteed. No legacy status required!"})]})]}),w.jsxs("div",{className:dte,children:[w.jsx("div",{className:cte,children:"Serving thousands of happy customers"}),Ote.map((e=>w.jsxs("div",{className:ute,children:[w.jsx("div",{className:mte,children:w.jsx("img",{src:e.image,className:pte,alt:e.name})}),w.jsx("div",{className:hte,children:e.name}),w.jsx("div",{children:e.description})]},e.name)))]}),w.jsxs("div",{className:vte,children:[w.jsx("div",{className:qee,children:"You're going to like what you find"}),w.jsx("div",{className:bte,children:"Our Bestsellers"}),w.jsxs("div",{className:Tte,onClick:()=>{this.props.history.push("/sidedoor/ivy-league/yale")},children:[w.jsx("div",{className:Ste,children:w.jsx("img",{src:"https://i.imgur.com/qhYSTIj.jpg",className:Ete,alt:"Yale"})}),w.jsx("div",{className:Ite,children:"Yale University"}),w.jsx("div",{className:Cte,children:"Since its founding in 1701, Yale has been dedicated to expanding and sharing knowledge, inspiring innovation, and preserving cultural and scientific information for future generations."}),w.jsx("div",{className:kte,children:w.jsx("div",{className:Ate,children:"Shop Yale - from $630k"})})]}),w.jsxs("div",{className:xte,onClick:()=>{this.props.history.push("/sidedoor/west-coast/usc")},children:[w.jsx("div",{className:Ste,children:w.jsx("img",{src:"https://i.imgur.com/vJPoRZ7.jpg",className:Ete,alt:"USC"})}),w.jsx("div",{className:Ite,children:"University of Southern California"}),w.jsx("div",{className:Cte,children:"The University of Southern California is one of the world’s top private research universities. USC’s curricular offerings provide extensive opportunities for interdisciplinary study."}),w.jsx("div",{className:kte,children:w.jsx("div",{className:Ate,children:"Shop USC - from $200k"})})]})]}),w.jsx(Pte,{})]})]})}}const Fte=je(Lte),Mte=[{name:"Yale University",shortname:"Yale",image:"https://i.imgur.com/qhYSTIj.jpg",description:"Since its founding in 1701, Yale has been dedicated to expanding and sharing knowledge, inspiring innovation, and preserving cultural and scientific information for future generations.",link:"/sidedoor/ivy-league/yale",borderColor:"#DFDFDE",price:"630k"},{name:"Harvard University",shortname:"Harvard",image:"https://i.imgur.com/Rj2ee8c.jpg",description:"Established in 1636, Harvard is the oldest institution of higher education in the United States. The University, which is based in Cambridge and Boston, Massachusetts, has an enrollment of over 20,000 degree candidates.",link:"/sidedoor/ivy-league/harvard",price:"1.3m"},{name:"Georgetown University",shortname:"Georgetown",image:"https://i.imgur.com/R9zjl1J.jpg",description:"Located in the nation's capitol, Georgetown is home to a vibrant community of accomplished students, distinguished faculty members and committed professional staff.",link:"/sidedoor/ivy-league/georgetown",price:"350k"}];class Ute extends h.Component{render(){const{history:e}=this.props;return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Sidedoor - Ivy League"}),w.jsx("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),w.jsx("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),w.jsx("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor/ivy-league"})]}),w.jsxs("div",{className:Wee,children:[w.jsx(Dte,{}),w.jsxs("div",{className:vte,style:{paddingTop:"40px"},children:[w.jsx("div",{className:bte,children:"Ivy League"}),Mte.map((t=>w.jsx("div",{className:_te,onClick:()=>{e.push(t.link)},children:w.jsxs("div",{className:wte,style:{borderColor:t.borderColor},children:[w.jsx("div",{className:Ste,children:w.jsx("img",{src:t.image,className:Ete,alt:t.name})}),w.jsx("div",{className:Ite,children:t.name}),w.jsx("div",{className:Cte,children:t.description}),w.jsx("div",{className:kte,children:w.jsx(Ft,{to:t.link,children:w.jsxs("div",{className:Ate,children:["Shop ",t.shortname," - from $",t.price]})})})]})},t.name))),w.jsx("div",{className:_te,children:w.jsxs("div",{className:wte,style:{borderColor:"#DFDFDE"},children:[w.jsx("div",{className:Ste,children:w.jsx("img",{src:"https://i.imgur.com/kq9v1JI.jpg",className:Ete,alt:"More coming soon"})}),w.jsx("div",{className:Ite,children:"Stay tuned..."}),w.jsx("div",{className:Cte,children:"We're constantly building relationships and adding new schools. Stay tuned for more schools in Ivy League!"}),w.jsx("div",{})]})}),w.jsx("div",{className:jte,children:w.jsx(Ft,{to:"/sidedoor",children:w.jsx("div",{className:Ate,children:"Return home"})})})]}),w.jsx(Pte,{})]})]})}}const Bte=je(Ute),Vte=[{name:"Stanford University",shortname:"Stanford",image:"https://cdn-useast1.kapwing.com/static/jason-leung-417009-unsplash.jpg",description:"Stanford University is one of the world’s leading research universities. It is known for its entrepreneurial character, drawn from the legacy of its founders, Jane and Leland Stanford, and its relationship to Silicon Valley",link:"/sidedoor/west-coast/stanford",borderColor:"#DFDFDE",price:"800k"},{name:"University of Southern California",shortname:"USC",image:"https://i.imgur.com/vJPoRZ7.jpg",description:"The University of Southern California is one of the world’s top private research universities. USC’s curricular offerings provide extensive opportunities for interdisciplinary study.",link:"/sidedoor/west-coast/usc",price:"75k"},{name:"University of California, Los Angeles",shortname:"UCLA",image:"https://i.imgur.com/zhdlPwy.jpg",description:"For nearly 100 years, UCLA has been a pioneer, persevering through impossibility, turning the futile into the attainable.",link:"/sidedoor/west-coast/ucla",price:"240k"}];class Wte extends h.Component{render(){const{history:e}=this.props;return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Sidedoor - West Coast"}),w.jsx("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),w.jsx("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),w.jsx("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor/west-coast"})]}),w.jsxs("div",{className:Wee,children:[w.jsx(Dte,{}),w.jsxs("div",{className:vte,style:{paddingTop:"40px"},children:[w.jsx("div",{className:bte,children:"West Coast"}),Vte.map((t=>w.jsx("div",{className:_te,onClick:()=>{e.push(t.link)},children:w.jsxs("div",{className:wte,style:{borderColor:t.borderColor},children:[w.jsx("div",{className:Ste,children:w.jsx("img",{src:t.image,className:Ete,alt:t.name})}),w.jsx("div",{className:Ite,children:t.name}),w.jsx("div",{className:Cte,children:t.description}),w.jsx("div",{className:kte,children:w.jsx(Ft,{to:t.link,children:w.jsxs("div",{className:Ate,children:["Shop ",t.shortname," - from $",t.price]})})})]})},t.name))),w.jsx("div",{className:_te,children:w.jsxs("div",{className:wte,style:{borderColor:"#DFDFDE"},children:[w.jsx("div",{className:Ste,children:w.jsx("img",{src:"https://i.imgur.com/kq9v1JI.jpg",className:Ete,alt:"More coming soon"})}),w.jsx("div",{className:Ite,children:"Stay tuned..."}),w.jsx("div",{className:Cte,children:"We're constantly building relationships and adding new schools. Stay tuned for more schools on the west coast!"}),w.jsx("div",{})]})}),w.jsx("div",{className:jte,children:w.jsx(Ft,{to:"/sidedoor",children:w.jsx("div",{className:Ate,children:"Return home"})})})]}),w.jsx(Pte,{})]})]})}}const Gte=je(Wte),Hte={yale:{image:"https://i.imgur.com/jiHsYEp.jpg",name:"Yale University",description:"Admission to the school will be granted through the soccer team.",price:"630k"},harvard:{image:"https://i.imgur.com/75CICnw.jpg",name:"Harvard University",description:"Goodbye Z-list. Hello Sidedoor list.",price:"1.3m"},georgetown:{image:"https://i.imgur.com/ncwsxVU.jpg",name:"Georgetown University",description:'"Play" on the storied Georgetown tennis team.',price:"350k"},stanford:{image:"https://i.imgur.com/Ca5ft4n.jpg",name:"Stanford University",description:"Admittance through the sailing team. You can sail if you want to, too!",price:"800k"},usc:{image:"https://i.imgur.com/0PGHt5k.jpg",name:"University of Southern California",description:"Play on the storied football team. You could probably be a kicker, anyways.",price:"75k"},ucla:{image:"https://i.imgur.com/r6ydn22.jpg",name:"University of California, Los Angeles",description:"Play on the soccer team at UCLA. Don't worry, you won't have to start.",price:"240k"}};const $te="OverlayWrapper-module_overlayBackground_3fnyE",Kte="OverlayWrapper-module_sideDoorOverlayContainer_fO-Km",zte="OverlayWrapper-module_exit_um-2i",Yte="OverlayWrapper-module_overlayContent_HdbWH";class Jte extends h.Component{render(){return w.jsxs("div",{children:[w.jsx("div",{className:$te,onClick:()=>{this.props.onClose()},"data-cy":"overlay-background"}),w.jsxs("div",{className:Kte,children:[w.jsx("div",{className:zte,onClick:()=>{this.props.onClose()},children:w.jsx(ve,{})}),w.jsx("div",{className:Yte,children:this.props.children})]})]})}}const qte="School-module_background_CSIry",Xte="School-module_tile_ySOVO",Qte="School-module_tileHeader_HWaHu",Zte="School-module_tileDescription_zai3l",eoe="School-module_tileSteps_ZKHiI",toe="School-module_tileStep_Jl2Dw",ooe="School-module_tileStepHeader_SRwjE",aoe="School-module_tileStepSubheader_2hvzJ",ioe="School-module_button_FL67u",soe="School-module_buttonHelper_K9NBt",noe="School-module_disclaimer_1dSDk",roe="School-module_overlayHeader_LXt9h",loe="School-module_overlayDescription_lEzDs";class doe extends h.Component{constructor(e){super(e),i(this,"overlayOnClose",(()=>this.setState({showOverlay:!1}))),this.state={showOverlay:!1}}render(){const{school:e}=this.props.match.params,{history:t}=this.props,{showOverlay:o}=this.state,a=function(e){if(e in Hte)return Hte[e]}(e);if(!a)return t.push("/sidedoor"),null;return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsxs("title",{children:[a.name," - Sidedoor"]}),w.jsx("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),w.jsx("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),w.jsx("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),w.jsx("link",{rel:"canonical",href:`https://www.kapwing.com/sidedoor/${"harvard"===e||"georgetown"===e||"yale"===e?"ivy-league":"west-coast"}/${e}`})]}),w.jsx(Dte,{}),w.jsx("div",{className:qte,style:{width:"100vw",height:"100vh",backgroundColor:"#333333",backgroundImage:`url("${a.image}")`},children:w.jsxs("div",{className:Xte,children:[w.jsx("div",{className:Qte,children:a.name}),w.jsx("div",{className:Zte,children:a.description}),w.jsxs("div",{className:eoe,children:[w.jsxs("div",{className:toe,children:[w.jsx("span",{className:ooe,children:"1. Purchase upfront"}),w.jsx("span",{className:aoe,children:"Refundable for 30 days"})]}),w.jsxs("div",{className:toe,children:[w.jsx("span",{className:ooe,children:"2. Take our SAT"}),w.jsx("span",{className:aoe,children:"Location and proctor provided"})]}),w.jsxs("div",{className:toe,children:[w.jsx("span",{className:ooe,children:"3. Submit photos"}),w.jsx("span",{className:aoe,children:"Wearing athletic clothes"})]}),w.jsxs("div",{className:toe,children:[w.jsx("span",{className:ooe,children:"4. Enjoy senior year"}),w.jsx("span",{className:aoe,children:"Don't worry like everyone else"})]})]}),w.jsxs("div",{className:ioe,onClick:()=>{this.setState({showOverlay:!0})},children:["Purchase now - $",a.price," ",w.jsx("span",{className:soe,children:"One time payment"})]}),w.jsx("div",{className:noe,children:"* No legacy status required for purchase. Admissions are 100% legitimate and legal. Confidentiality guaranteed."}),o?w.jsxs(Jte,{onClose:this.overlayOnClose,children:[w.jsx("div",{className:roe,children:"Happy April Fools' Day!"}),w.jsxs("div",{className:loe,children:[w.jsx("p",{children:"Unfortunately, if you're trying to buy admission on this website, you probably can't afford it."}),w.jsx("p",{children:"Enjoy Sidedoor? Please help use spread the word on Facebook, Twitter, or your social network of choice!"}),w.jsxs("p",{children:["Built with love by the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer",children:"Kapwing"}),"."]}),w.jsx("p",{children:w.jsx(Ft,{to:"/sidedoor",children:"Return to Sidedoor →"})})]})]}):null]})})]})}}const coe=je(doe);class uoe extends h.Component{constructor(e){super(e),MY({fontToLoad:{type:"default",fontFamily:"Rubik"}})}render(){return w.jsxs(zt,{children:[w.jsx(Yt,{path:"/sidedoor",exact:!0,component:Fte}),w.jsx(Yt,{path:"/sidedoor/ivy-league",exact:!0,component:Bte}),w.jsx(Yt,{path:"/sidedoor/ivy-league/:school",component:coe}),w.jsx(Yt,{path:"/sidedoor/west-coast",exact:!0,component:Gte}),w.jsx(Yt,{path:"/sidedoor/west-coast/:school",component:coe})]})}}const moe=je(uoe),poe="SignIn-module_signInWrapper_lkskh",hoe="SignIn-module_signInLeft_KfIRn",goe="SignIn-module_signInContainer_FS7-R",foe="SignIn-module_signInImage_n-oku",yoe="SignIn-module_image_mhEPP";var voe=(e=>(e.TEAMS="Teams",e.NEW_USER_INVITE_ACCEPTED="New User Invite Accepted",e.NEW_USER_INVITE_DISMISSED="New User Invite Dismissed",e.EMAIL_INVITE="Email Invite",e.INVITE_LINK="Invite Link",e.ONBOARDING_MODAL="Onboarding Modal",e.REQUEST_TO_EDIT="Request to Edit",e))(voe||{});function _oe(){const e=Ve(),t=_7(),{location:o}=e,{state:a}=o;return{redirectSource:(()=>{switch(t.get("redirect")){case"from-request-to-edit":return"Request to Edit";case"from-teams":return"Teams";default:return null}})()??(null==a?void 0:a.redirectSource)??null,pushWithSource:(t,o,a)=>{e.push({pathname:t,state:{redirectSource:o,optionalProperties:a}})}}}const woe=_.memo((()=>{const e=Ve(),[t,o]=_.useState(!1),a=tl((e=>e.currentUser)),{redirectSource:i,pushWithSource:s}=_oe(),{search:n}=be(),r=h.useMemo((()=>new URLSearchParams(n)),[n]).get("next"),l=h.useCallback((()=>{var t;if(r)s(r,i);else{const o=null==(t=e.location.state)?void 0:t.pathname;i===voe.TEAMS&&Fm(ym.CLICKED_CREATE_A_TEAM,{Email:a.user.email}),s(o??"/",i)}}),[a.user.email,e.location.state,r,s,i]);h.useEffect((()=>{wc(a)&&(du(),l())}),[a,l]);const d="Sign In or Sign Up — Kapwing",c="Kapwing works better if you sign in. Sign in to access your projects, save content to your workspace, preview beta features, and much more.";return w.jsxs(w.Fragment,{children:[w.jsx(Q9,{}),w.jsxs(Mt,{children:[w.jsx("title",{children:d}),w.jsx("meta",{name:"description",content:c}),w.jsx("meta",{name:"keywords",content:"sign in, login, signup, sign in to Kapwing"}),w.jsx("meta",{property:"og:title",content:d}),w.jsx("meta",{property:"og:description",content:c})]}),w.jsxs("div",{className:poe,children:[w.jsx("div",{className:hoe,children:w.jsxs("div",{className:goe,children:[t?w.jsx("div",{className:pV,children:"Sign in with SSO"}):w.jsx("div",{className:pV,children:"Sign in to continue "}),t?w.jsx("div",{className:hV,children:"Sign in with your company provided credentials to access all of the benefits of your Enterprise team workspace."}):w.jsx("div",{className:hV,children:"Kapwing works better when you’re signed in. Sign in to save content to a workspace, share with others, and more."}),r?w.jsx(cV,{ssoSignIn:t,setSSOSignIn:o,onSuccess:l,immediateRedirectPathname:e.location.pathname+e.location.search,forceNavigationTo:r}):w.jsx(cV,{ssoSignIn:t,setSSOSignIn:o,onSuccess:l,immediateRedirectPathname:e.location.pathname+e.location.search})]})}),w.jsx("div",{className:foe,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/7ne-sign-in-illustration.webp",className:yoe,alt:"Benefits to signing in to Kapwing"})})]}),w.jsx(h8,{})]})})),boe="common-module_textContainer_D7NvK",Toe="common-module_textHeader_W1lwT",xoe="common-module_textDescription_VC-uV",Soe="common-module_previewImage_7xj-G",Eoe="common-module_preview_v9ycp";class Ioe extends h.Component{render(){return w.jsxs("div",{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Free Sound Effects for Video Editing – Kapwing"}),w.jsx("meta",{name:"description",content:"Use Kapwing's trendy sound effects generator to add emphasis to a video in a few clicks. Choose from over 30 popular sound effects, from Pikachu to Pacman."}),w.jsx("meta",{name:"keywords",content:"sound effects, sound effect generator"}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/sound-effects"}),w.jsx("meta",{property:"og:title",content:"Trendy Sound Effects Editor - Kapwing"}),w.jsx("meta",{property:"og:description",content:"Add trendy sound effects directly to your video in just a few clicks. Choose from over 30 popular sound effects, from Pikachu to Pacman."}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/SN2lyIK.png"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/SN2lyIK.png"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/SN2lyIK.png"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/sound-effects"})]}),w.jsx(Q9,{}),w.jsxs("div",{className:boe,children:[w.jsx("div",{className:Toe,children:"Trendy Sound Effects Editor"}),w.jsxs("div",{className:xoe,children:[w.jsx("p",{children:"The Trendy Sound Effects Editor was a fun project that allowed users to add, well, trendy sound effects to their videos."}),w.jsx("p",{children:"We created the app after watching many fun videos with funny sound effects, like a snap of fingers, or an explosion effect for extra emphasis."}),w.jsxs("p",{children:["The sound effects editor was featured in various places online including"," ",w.jsx("a",{href:"https://www.producthunt.com/posts/trendy-sound-effect-editor/",children:"Product Hunt"})," ","as well as"," ",w.jsx("a",{href:"https://www.thewindowsclub.com/kapwing-meme-maker-generator",children:"The Windows Club"}),"."]})]}),w.jsx("div",{}),w.jsx("div",{className:Eoe,children:w.jsx("img",{src:"https://i.imgur.com/VXAqJZW.png",alt:"Sound Effects Editor Home Page",className:Soe})}),w.jsx("div",{className:Eoe,children:w.jsx("img",{src:"https://i.imgur.com/iHjfHSa.png",alt:"Sound Effects Editor Preview",className:Soe})}),w.jsx("div",{}),w.jsx("div",{className:xoe,children:w.jsx("p",{children:"The feature included a large variety of sounds that could be added to the video, including the Mario Power-up sound, iMessage sending, mouse clicking, and many more."})}),w.jsx("div",{className:Eoe,children:w.jsx("img",{src:"https://i.imgur.com/QZR9LIc.png",alt:"Sound Effects Sounds Preview",className:Soe})}),w.jsxs("div",{className:xoe,children:[w.jsxs("p",{children:["The feature was deprecated in October of 2018 due to a lack of maintainence. If you're looking to add sound to your video, you can use the ",w.jsx("a",{href:"/tools/add-audio",children:"Add Sound to Video"})," ","feature on ",w.jsx("a",{href:"/",children:"Kapwing"}),"."]}),w.jsx("p",{children:"Thanks for visiting the Trendy Sound Effects Editor and have a nice day."})]})]}),w.jsx(h8,{})]})}}const Coe=[{id:"dropbox",name:"Dropbox",image:"https://i.imgur.com/z8sgVnv.png",logo:"https://i.imgur.com/YxDJLc6.png",date:"Sep 15, 2008",description:"A 24 year old Drew Houston gives the first introduction to Dropbox, in a video that responated with hackers.",youtubeLink:"https://www.youtube.com/watch?v=7QmCUDHpNzE",embedLink:"https://www.youtube.com/embed/7QmCUDHpNzE"},{id:"robinhood",name:"Robinhood",image:"https://i.imgur.com/tdMnozF.png",logo:"https://i.imgur.com/qV8t8BY.png",date:"Dec 10, 2014",description:"Watch the video that made Robinhood go viral on the internet, with the (at the time) revolutionary idea that stock trading could be free.",youtubeLink:"https://www.youtube.com/watch?v=Z_nsrcnwHQc",embedLink:"https://www.youtube.com/embed/Z_nsrcnwHQc"},{id:"uber",name:"Uber",image:"https://i.imgur.com/D9AB0t9.png",logo:"https://i.imgur.com/fiwh2Em.png",date:"May 10, 2010",description:"A demonstration of the UberCab app in 2010, when it was still focused on limousines.",youtubeLink:"https://youtu.be/k3wk4kem54k",embedLink:"https://www.youtube.com/embed/k3wk4kem54k"},{id:"google",name:"Google Street View",image:"https://i.imgur.com/XV8VL1t.png",logo:"https://i.imgur.com/0ABT4tR.png",date:"May 29, 2007",description:"Google's famous quirky-ness comes in full force in this fun introduction to Street View.",youtubeLink:"https://youtu.be/91wuBqlny50",embedLink:"https://www.youtube.com/embed/91wuBqlny50"},{id:"lyft",name:"Lyft (aka Zimride)",image:"https://i.imgur.com/QcL2jX1.png",logo:"https://i.imgur.com/WXputgn.png",date:"Sep 6, 2010",description:"Before Lyft, the founders created a ride share website for students called Zimride. Watch them walk through this product that led to much more.",youtubeLink:"https://youtu.be/ei5woMwH6vM",embedLink:"https://www.youtube.com/embed/ei5woMwH6vM"},{id:"linkedin",name:"LinkedIn",image:"https://i.imgur.com/zhea8VL.png",logo:"https://i.imgur.com/znK6zTR.png",date:"Apr 5, 2010",description:"LinkedIn wasn't super new when they put out this marketing video, but it's still interesting to watch and see how far they've come.",youtubeLink:"https://youtu.be/ZVlUwwgOfKw",embedLink:"https://www.youtube.com/embed/ZVlUwwgOfKw"},{id:"snapchat",name:"Snapchat Video",image:"https://i.imgur.com/o6IasQ7.png",logo:"https://i.imgur.com/jSPUZGJ.png",date:"Dec 13, 2012",description:"Looking at this old launch video for Snapchat video makes it seem crazy just how far the app has come.",youtubeLink:"https://youtu.be/r4237MZIb8g",embedLink:"https://www.youtube.com/embed/r4237MZIb8g"},{id:"apple",name:"Apple iPhone",image:"https://i.imgur.com/lx76CKr.png",logo:"https://i.imgur.com/s5aT8PJ.png",date:"Jan 10, 2007",description:"The original presentation by Steve Jobs that would change humanity in a real way.",youtubeLink:"https://youtu.be/ftf4riVJyqw",embedLink:"https://www.youtube.com/embed/ftf4riVJyqw"},{id:"twilio",name:"Twilio",image:"https://i.imgur.com/vPd1O46.png",logo:"https://i.imgur.com/uHkKO1v.png",date:"Mar 10, 2009",description:"Watch Evan Cooke, a co-founder of Twilio, give a basic whiteboard demonstration of their early service.",youtubeLink:"https://youtu.be/P4KaV3eiH3s",embedLink:"https://www.youtube.com/embed/P4KaV3eiH3s"},{id:"coinbase",name:"Coinbase Vault",image:"https://i.imgur.com/THA5PR9.png",logo:"https://i.imgur.com/l5M2lab.png",date:"Jul 2, 2014",description:"One of the early demos of Coinbase which set the stage for its latest success.",youtubeLink:"https://youtu.be/GX_c566xYcQ",embedLink:"https://www.youtube.com/embed/GX_c566xYcQ"},{id:"instacart",name:"Instacart",image:"https://i.imgur.com/jmLBfV2.png",logo:"https://i.imgur.com/KolJdHX.png",date:"Aug 24, 2012",description:"Apoorva Mehta gives an honest interview about his journey with Instacart during his time at Y Combinator, when no one knew about it.",meta:{title:"Evolution of Instacart – Kapwing",description:"Watch Apoorva Mehta share insight on his journey at Instacart as well as videos from other founders in the Startup demo video collection by Kapwing."},youtubeLink:"https://youtu.be/b5llwmsHXkw",embedLink:"https://www.youtube.com/embed/b5llwmsHXkw"},{id:"zenefits",name:"Zenefits",image:"https://i.imgur.com/RHknkvP.png",logo:"https://i.imgur.com/ywASlen.png",date:"Feb 10, 2013",description:"Watch a younger Parker Conrad, the founder of Zenefits, give the pitch in his application video to Y Combinator.",meta:{title:"Evolution of Zenefits – Kapwing",description:"Watch Parker Conrad, the founder of Zenefits, give his pitch in an application video. Explore more demo videos from the early days of successful startups."},youtubeLink:"https://youtu.be/-S83fysRwn4",embedLink:"https://www.youtube.com/embed/-S83fysRwn4"},{id:"docker",name:"Docker",image:"https://i.imgur.com/wtM1lus.png",logo:"https://i.imgur.com/hz8Wfd2.png",date:"May 10, 2010",description:"Docker seems like a no-brainer for developers today, but back when they first started, the idea of a container left many skeptical.",youtubeLink:"https://youtu.be/Q5POuMHxW-0",embedLink:"https://www.youtube.com/embed/Q5POuMHxW-0"},{id:"twitch",name:"Twitch (aka Justin.tv)",image:"https://i.imgur.com/zBrockk.png",logo:"https://i.imgur.com/L11W3bk.png",date:"Feb 4, 2010",description:"Before Twitch, was Justin.tv. Take a look at this authentic demo of their early live streaming technology on the web.",youtubeLink:"https://youtu.be/kfDBxa65m_A",embedLink:"https://www.youtube.com/embed/kfDBxa65m_A"}];class koe extends h.Component{constructor(e){super(e),i(this,"goToStartupDemoVideosPage",(()=>{const{history:e}=this.props;e.push("/startup-demo-videos")})),this.state={currentVideo:void 0}}componentDidMount(){const{match:e,history:t}=this.props;if(e&&e.params&&e.params.id){const o=Coe.find((t=>t.id===e.params.id));o?this.setState({currentVideo:o}):t.push("/startup-demo-videos")}else t.push("/startup-demo-videos")}renderVideo(){const{currentVideo:e}=this.state,{meta:{title:t,description:o}={}}=e;return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:t}),w.jsx("meta",{name:"description",content:o}),w.jsx("link",{rel:"canonical",href:`https://www.kapwing.com/startup-demo-videos/${e.id}`})]}),w.jsx("div",{className:"startup-video-player-wrapper",children:w.jsxs("div",{className:"startup-video-player-container",children:[w.jsx("div",{className:"startup-video-player-back",onClick:this.goToStartupDemoVideosPage,children:"< Back to all videos"}),w.jsx("div",{className:"splash-youtube-video",children:w.jsx("iframe",{title:`${e.name} Video`,src:`${e.embedLink}?autoplay=1&showinfo=0&modestbranding=0`,frameBorder:"0"})}),w.jsxs("div",{className:"startup-video-player-metadata",children:[w.jsx("img",{alt:e.name,src:e.logo,className:"startup-demo-videos-logo"}),w.jsx("div",{className:"startup-demo-videos-item-name",children:e.name}),w.jsx("div",{className:"startup-video-player-date",children:e.date}),w.jsx("div",{className:"startup-demo-videos-item-description",children:e.description})]})]})})]})}render(){const{currentVideo:e}=this.state;return e?this.renderVideo():null}}const Aoe=je(koe),joe=["startups","videos"];class Noe extends h.Component{constructor(){super(...arguments),i(this,"playVideo",(e=>{const{history:t}=this.props;t.push(`/startup-demo-videos/${e.id}`)})),i(this,"renderVideoItem",(e=>w.jsxs("div",{className:"startup-demo-videos-item-container",children:[w.jsxs("div",{className:"startup-demo-videos-image-container",onClick:()=>this.playVideo(e),children:[w.jsx("img",{alt:e.name,src:e.logo,className:"startup-demo-videos-image"}),w.jsxs("div",{className:"startup-demo-videos-image-play-button",children:[w.jsx("span",{className:"startup-demo-videos-play",children:"►"}),w.jsx("div",{className:"startup-demo-videos-overlay"})]})]}),w.jsxs("div",{className:"startup-demo-videos-item-metadata",children:[w.jsx("img",{alt:e.name,src:e.image,className:"startup-demo-videos-logo"}),w.jsx("div",{className:"startup-demo-videos-item-name",children:e.name}),w.jsx("div",{className:"startup-demo-videos-item-date",children:e.date}),w.jsx("div",{className:"startup-demo-videos-item-description",children:e.description})]})]},e.id)))}render(){return w.jsxs("div",{children:[w.jsxs("div",{className:"startup-videos-wrapper",children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Startup Demo Videos – Kapwing"}),w.jsx("meta",{name:"description",content:"Explore a collection of demo videos from the early days of successful startups such as Dropbox, LinkedIn, Robinhood, and more curated by the Kapwing team."}),w.jsx("meta",{property:"og:url",content:"https://www.kapwing.com/startup-demo-videos"}),w.jsx("meta",{property:"og:title",content:"Startup Demo Videos - Kapwing"}),w.jsx("meta",{property:"og:description",content:"A collection of demo videos from the early days of successful startups like Dropbox, LinkedIn, Robinhood, and more."}),w.jsx("meta",{property:"og:image",content:"https://i.imgur.com/nnvE6Bf.png"}),w.jsx("meta",{property:"og:image:url",content:"https://i.imgur.com/nnvE6Bf.png"}),w.jsx("meta",{property:"twitter:image",content:"https://i.imgur.com/nnvE6Bf.png"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/startup-demo-videos"})]}),w.jsx("div",{className:"startup-demo-videos-header-container",children:w.jsxs("div",{children:[w.jsxs("div",{className:"startup-demo-videos-header",children:["Startup Demo Videos"," ",w.jsx("span",{role:"img","aria-label":"Lightbult Emoji",children:"💡"})]}),w.jsx("div",{className:"startup-demo-videos-description",children:"A collection of demo videos from the early days of successful startups like Dropbox, LinkedIn, Robinhood, and more."}),w.jsxs("div",{className:"startup-demo-videos-share",children:[w.jsx(Ut,{url:"https://www.kapwing.com/startup-demo-videos",quote:"Startup Demo Videos - Kapwing",className:"startup-demo-share-button",children:w.jsx(Bt,{size:40,round:!0})}),w.jsx(Vt,{url:"https://www.kapwing.com/startup-demo-videos",title:"💡 Startup Demo Videos - Kapwing",via:"kapwingapp",hashtags:joe,className:"startup-demo-share-button",children:w.jsx(Wt,{size:40,round:!0})})]}),w.jsxs("div",{className:"startup-demo-videos-text",children:["Curated with love by the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",children:"Kapwing"})]})]})}),w.jsxs("div",{className:"startup-demo-videos-background",children:[w.jsxs("div",{className:"startup-demo-videos-list-container",children:[Coe.map((e=>this.renderVideoItem(e))),w.jsx("div",{className:"startup-demo-videos-item-container",children:w.jsx("div",{className:"startup-demo-videos-image-container",children:w.jsx("img",{alt:"More to come!",src:"https://i.imgur.com/uXJdIsY.png",className:"startup-demo-videos-image"})})})]}),w.jsxs("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container",children:[w.jsxs("div",{className:"startup-demo-videos-email-subscribe",children:[w.jsx("div",{className:"startup-demo-videos-subscribe-header",children:"Looking for more?"}),w.jsx("div",{className:"startup-demo-videos-subscribe-description",children:"Sign up for our mailing list to get the latest updates:"}),w.jsx(A8,{source:"startup-demo-videos"})]}),w.jsxs("div",{className:"startup-demo-videos-footer-text",children:["We're adding new videos to the collection on a regular basis! Have a submission for a video? Contact us at"," ",w.jsx("a",{href:"mailto:hello@kapwing.com",children:"hello@kapwing.com"}),"!"]})]})]})]}),w.jsx(h8,{})]})}}const Roe=je(Noe);function Poe(e){return{type:"SET_PARENT_ID",parentId:e}}function Doe(e){return{type:"SET_CURRENT_TEMPLATE",currentTemplate:e}}function Ooe(e){return{type:"SET_TEMPLATES",templates:e}}function Loe(e){return Yr("/api/v1/templates/getTemplate",{params:{slug:e}}).then((e=>{const{dispatch:t}=sr();return t(Doe(e)),e}))}let Foe=Date.now();async function Moe(e={},t){Foe=Date.now(),t&&(e.pattern={key:t.key,value:t.value});return Yr("/api/v1/templates/getTemplates",{params:{args:JSON.stringify({...e,timeOfRequest:Foe}),parseJson:!0}}).then((e=>{const{dispatch:t}=sr();e.timeOfRequest===Foe&&t(Ooe(e.templates))}))}async function Uoe(e,t,o=60){const{dispatch:a}=sr(),i={body:{searchTerm:e,lastTemplateId:t,limit:o}},s=await Jr("/api/v2/templates/paginated",i);s.templates.length&&a({type:"APPEND_TEMPLATES",templates:s.templates})}async function Boe(e,t){const o=await Promise.all(e.map((async e=>{if("Trending Now"===e)return await Yr("/api/v1/templates/getNewestNonMemeTemplates/1");const o={searchTerm:e};t&&(o.pattern={key:t.key,value:t.value});const a={params:{args:JSON.stringify(o)}};return(await Yr("/api/v1/templates/getTemplates",a)).templates}))),a=new Map;return e.forEach(((e,t)=>{const i=o[t];i&&a.set(e,i)})),a}function Voe(e=1){return Yr(`/api/v1/templates/getNewestTemplates/${e}`).then((e=>{const{dispatch:t}=sr();return t(Ooe(e)),e}))}function Woe(e,t=null){return Yr(`/api/v1/templates/${e}/children`,{params:{lastId:t}}).then((e=>{const{dispatch:t}=sr();return t({type:"SET_RECENT_VIDEOS",videos:e}),e}))}function Goe(e){return Yr(`/api/v1/templates/${e}/examples`).then((e=>{const{dispatch:t}=sr();return t({type:"SET_TEMPLATE_EXAMPLE_VIDEOS",exampleVideos:e}),e}))}function Hoe(e){const{currentUser:t}=sr().state,{token:o,user:a}=t||{},{_id:i}=a||{};return Jr("/api/v1/templates/upsertTemplate",{body:e,params:{token:o,userId:i}})}function $oe(e){const{currentUser:t}=sr().state,{token:o,user:a}=t||{},{_id:i}=a||{};return zr("/api/v1/templates/deleteTemplate",{body:e,params:{token:o,userId:i}})}function Koe(e,t,o){const{dispatch:a,state:i}=sr(),{currentUser:s}=i,{user:n}=s||{},{_id:r}=n||{};return("ADD"===e?qr:zr)(`/api/v1/templates/${t}/example`,{params:{_id:o,userId:r}}).then((t=>(a({type:"ADD"===e?"ADD_TEMPLATE_EXAMPLE":"REMOVE_TEMPLATE_EXAMPLE",example:o}),t)))}function zoe(e){return{type:"SET_TEMPLATE_SOURCE",source:e}}const Yoe="AddRemoveExamples-module_actionButton_UlQDA",Joe="AddRemoveExamples-module_container_DSqg7",qoe="AddRemoveExamples-module_header_HPzwW",Xoe="AddRemoveExamples-module_description_V-4Xd";class Qoe extends h.Component{constructor(e){super(e),i(this,"fetchParentTemplate",(()=>{const{currentVideo:e}=this.props;var t;(t=e.parentId,Yr("/api/v1/templates/getTemplateFromId",{params:{_id:t}}).then((e=>e))).then((e=>{this.setState({parentTemplate:e,loadingParentTemplate:!1})})).catch((e=>{mh({description:"Failed to fetch parent template",error:e}),this.setState({loadingParentTemplate:!1})}))})),i(this,"addToExamples",(()=>{const{currentVideo:e}=this.props,{parentTemplate:t}=this.state;this.setState({loadingTemplateExamples:!0}),Koe("ADD",t._id,e._id).then((()=>{this.fetchParentTemplate(),this.setState({loadingTemplateExamples:!1})})).catch((e=>{mh({description:"an error occurred when updating examples",error:e}),this.setState({loadingTemplateExamples:!1})}))})),i(this,"removeFromExamples",(()=>{const{currentVideo:e}=this.props,{parentTemplate:t}=this.state;this.setState({loadingTemplateExamples:!0}),Koe("REMOVE",t._id,e._id).then((()=>{this.fetchParentTemplate(),this.setState({loadingTemplateExamples:!1})})).catch((e=>{mh({description:"An error occurred when removing from examples",error:e}),this.setState({loadingTemplateExamples:!1})}))})),i(this,"currentVideoIsAlreadyExample",(()=>{const{currentVideo:e}=this.props,{parentTemplate:t}=this.state;return t&&t.examples&&t.examples.includes(e._id)})),this.state={loadingParentTemplate:!0,loadingTemplateExamples:!1,parentTemplate:{}}}componentDidMount(){const{currentVideo:e}=this.props;e&&e.parentId&&this.fetchParentTemplate()}renderExampleActions(){const{loadingTemplateExamples:e,parentTemplate:t}=this.state,o=this.currentVideoIsAlreadyExample();return e?w.jsx("div",{className:Yoe,children:"Loading ..."}):o?w.jsx("div",{className:Yoe,onClick:this.removeFromExamples,children:"Remove from examples"}):w.jsxs("div",{className:Yoe,onClick:this.addToExamples,children:["Add to examples for ",t.title]})}render(){const{loadingParentTemplate:e,parentTemplate:t}=this.state;if(e||s.isEmpty(t))return null;const o=this.currentVideoIsAlreadyExample();return console.debug(t),w.jsxs("div",{className:Joe,children:[w.jsx("div",{className:qoe,children:"Example actions"}),w.jsxs("div",{className:Xoe,children:["This content is a child of template"," ",w.jsx(Ft,{to:`/explore/${t.slug}`,children:t.title?t.title:"Error: template has no title"}),"."," ",w.jsx("span",{children:o?"Content already added as an example.":null})]}),this.renderExampleActions()]})}}const Zoe=je(g.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser})))(Qoe)),eae="VideoAdminActions-module_container_4MuJr",tae="VideoAdminActions-module_commentingContainer_XWbs5",oae="VideoAdminActions-module_header_bI4cD",aae="VideoAdminActions-module_description_S2wc7",iae="VideoAdminActions-module_actionButton_bYMFj";const sae=g.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,projectName:e.projectName})),(e=>ye({setCurrentTemplate:Doe},e))),nae=_.memo(je(sae((({history:e,currentVideo:t,projectName:o="",setCurrentTemplate:a,commentingView:i=!1})=>w.jsxs("div",{className:i?tae:eae,children:[w.jsx("div",{className:oae,children:"Admin actions"}),w.jsx("div",{className:aae,children:"This section is visible only to admin accounts."}),w.jsx("div",{className:iae,onClick:()=>{const{_id:i}=t,s={title:o,description:o,slug:(n=o,n.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")),video_id:i};var n;a(s);e.push("/admin/templates/update")},children:"Make template"}),w.jsxs("div",{className:iae,onClick:()=>{const e=`/videos/${t._id}/debug`;window.open(e)},children:["Visit debug page ",w.jsx(qt,{})]}),w.jsxs("div",{className:iae,onClick:async()=>{const{readonly:e}=t;await Xr(`/api/v1/videos/${t._id}`,{body:{readonly:!e}}),window.location.reload()},children:["Make video"," ",w.jsx("span",{children:t.readonly?"writable":"readonly"})]}),w.jsx(Zoe,{})]}))))),rae=["addedFromMediaLibrary","asset_id","base64_img","blob_name","bucket","bucket_name","cmlFileId","content_type","converted_type","conversion_id","duration","endTime","ext","ffprobeData","gcsShortId","hasAudio","height","hidden","id","index","isMediaLibraryUpload","isSample","local_source_url","local_url","lockAspectRatio","locked","loadErrorFired","longLoadFired","loopMode","mediaLibraryID","metadataGathered","mime","mime_type","name","objectFit","optimization_id","optimization_failed","originalName","original_url","position","positionTemp","preview","projectName","removeBgPreviewUrl","requireConversion","searchQuery","size","soundUrl","source","startTime","temp_dir","thumbnailUrl","timelineRow","timestamp","track_preview","type","uploadConfirmed","uploadLocation","uploadId","uri","url","wasUploadedAnonymously","width"],lae={borderRadius:{relative:"0%"},borderRadiusTemp:null,filters:{},isAudiogram:!1,lineWidth:"0%",playbackRate:1,presetFilter:null,recordType:"",tempOverlayState:{},uploadPending:!1,uploadProgress:100,videoDelay:0,volume:1,volumeTemp:null},dae=["isTrimmed","origin","conversion_type","loopMode","loadErrorFired"],cae={videoConvertedState:"complete"};function uae(e,t,o,a){var i,s;let n=!1;for(const[l,d]of Object.entries(e)){if(!rae.includes(l)&&JSON.stringify(lae[l])!==JSON.stringify(d)){n=!1;break}n=!0}return n&&"video"===e.type&&((null==(i=e.mime)?void 0:i.includes("mp4"))||(null==(s=e.mime)?void 0:s.includes("quicktime")))&&!e.isTrimmed&&!e.crop&&QI(e)&&ZI(e)&&tS(e)&&eC(e,t)&&function(e,t){const{width:o,height:a}=e,[i,s]=t.split(":").map((e=>parseInt(e)));return o===i&&a===s}(e,o)&&("Standard"===(r=a).exportQuality&&"AUTO"===r.exportResolution);var r}function mae(e,t){var o;const a=[...rae,...dae],i={...lae,...cae};let s=!1;for(const[r,l]of Object.entries(e)){if(!a.includes(r)&&JSON.stringify(i[r])!==JSON.stringify(l)){s=!1;break}s=!0}const n=(null==(o=e.mime)?void 0:o.includes("mp4"))||"complete"===e.videoConvertedState;return s&&"video"===e.type&&n&&e.isTrimmed&&!e.crop&&(!e.videoDelay||0===e.videoDelay)&&QI(e)&&ZI(e)&&tS(e)&&eC(e,t)}function pae(e,t){var o,a;if("videoState"===t){if(!e.studio)return!1;const{studio:t}=e;return 1===t.scenes.length&&1===t.scenes[0].layers.length&&"pastedLink"!==t.scenes[0].layers[0].source&&!(null==(o=null==e?void 0:e.audio)?void 0:o.url)}return"videoBuild"===t&&(!!e.scenes&&(1===e.scenes.length&&1===e.scenes[0].layers.length&&"pastedLink"!==e.scenes[0].layers[0].source&&!(null==(a=null==e?void 0:e.audio)?void 0:a.url)))}function hae(e,t,o){var a;if(!["mp4","mp4_convert"].includes(e.videoType))return;const i=(e.width??0)/(e.height??1);if(pae(e,"videoBuild")){const s=null==(a=e.scenes[0])?void 0:a.layers[0],{videoType:n}=e;s&&uae(s,i,e.ratio,{exportQuality:e.exportQuality,exportResolution:e.exportResolution})&&(t["Client Side Processable"]={...t["Client Side Processable"],"No Changes":!0,"Processed on client":o}),s&&mae(s,i)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Trim only":!0,"Processed on client":o}),s&&function(e,t,o){var a;return"mp4"===o&&"video"===e.type&&(null==(a=e.mime)?void 0:a.includes("mp4"))&&e.duration&&e.duration<=15&&QI(e)&&ZI(e)&&tS(e)&&(e.crop||!eC(e,t))}(s,i,n)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Short Duration Cropped or Resized Video":!0})}1===e.scenes.length&&(function(e){var t;let o=!0;return((null==(t=e.scenes[0])?void 0:t.layers)||[]).forEach((e=>{!["video","audio"].includes(e.type)&&"progressBar"!==e.shapeType&&QI(e)&&ZI(e)&&tS(e)&&!e.isTrimmed||(o=!1)})),e.duration>0&&o}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Static Image Video":!0}),function(e){var t,o;if(2!==(null==(t=e.scenes[0])?void 0:t.layers.length))return!1;let a=!1,i=!1;return null==(o=e.scenes[0])||o.layers.forEach((t=>{uae(t,(e.width??0)/(e.height??1),e.ratio,{exportQuality:e.exportQuality,exportResolution:e.exportResolution})&&(a=!0),"audio"!==t.type||t.isTrimmed||t.isAudiogram||(i=!0)})),a&&i}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"No Changes Video + Audio":!0}),function(e){var t,o;if(2!==(null==(t=e.scenes[0])?void 0:t.layers.length))return!1;let a=!1,i=!1;const s=(e.width||0)/(e.height||1);return null==(o=e.scenes[0])||o.layers.forEach((e=>{mae(e,s)&&(a=!0),"audio"!==e.type||e.isTrimmed||e.isAudiogram||(i=!0)})),a&&i}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Trimmed Video + Audio":!0}))}const gae={usedGapInsert:["Used Drag Into Split/Small Gap"],usedRippleDelete:["Used Ripple Delete"],usedRippleMode:["Used Ripple Mode"],usedPasteModifications:["Used Paste Modifications"],usedCanvasBlur:["Used Canvas Blur"],usedSafezone:["Used Safezone"],usedTimeline:["Used Timeline V2"],usedCrop:["Used Crop"],usedImageErase:["Used Image Erase"],usedExactInput:["Used Exact Input"],waveformCreationFailure:["Waveform Creation Failure"],renameLayer:["User Renamed Layer"],usedUploadSRT:["Used Upload SRT"],usedGenerateTTSVideo:["Used Generate TTS Video"],usedGenerateTTSVideoPastPrompt:["Used Past Prompt to Generate TTS Video"],usedGenerateVideo:["Used Generate Video"],usedGenerateVideoPastPrompt:["Used Past Prompt to Generate Video"],usedGenerateImage:["Used Generate Image"],usedGenerateImagePastPrompt:["Used Past Prompt to Generate Image"],usedGenerateMeme:["Used Generate Meme"],usedGenerateMemePastPrompt:["Used Past Prompt to Generate Meme"],usedGenerateVideoFromDocument:["Used Document to Video Generator"],usedGenerateVideoFromDocumentPastPrompt:["Used Past Prompt to Generate Document to Video Generator"],usedGenerateVideoFromScript:["Used Script to Video Generator"],usedGenerateVideoFromScriptPastPrompt:["Used Past Prompt to Generate Script to Video Generator"],usedGenerateVideoFromArticle:["Used Article to Video Generator"],usedGenerateVideoFromArticlePastPrompt:["Used Past Prompt to Generate Article to Video Generator"],usedGenerateBRoll:["Used Generate B-Roll"],usedMagicFill:["Used Magic Fill"],usedEnhanceImage:["Used Enhance Image"],usedSmartReframe:["Used Smart Reframe"],usedIndividualSubtitlePlacements:["Used Individual Subtitle Placements"],updatedAllSubtitlePlacements:["Updated All Subtitle Placements"],usedClassicTranscribe:["Used Classic Transcribe","Used Classic Autogenerate"],usedClassicTranslate:["Used Classic Translate","Used Classic Autogenerate"],usedVoiceDubbing:["Used Voice Dubbing"]};function fae({exportLocation:e,video:t,studioState:o={},processedOnClient:a=!1}){try{!async function({exportLocation:e,video:t,studioState:o={},processedOnClient:a=!1}){var i;const{state:s}=sr(),n=!1,r={};t._id&&(r["Video ID"]=t._id,r["Link to Video"]=`kapwing.com/videos/${t._id}`);"studio-publish-dropdown"===t.createLocation&&(r["Exported With Dropdown"]=!0);t.isStopMotionVideo?r.Editor="Stop Motion Maker":t.isLooped?r.Editor="Loop Video":t.isCreator||t.isStudio?r.Editor="Studio":t.isReversed?r.Editor="Reverse Video":t.isTrimmedOnly?r.Editor="Trim Video":t.isImageVideo?r.Editor="Image to Video":t.isRotate?r.Editor="Rotate Video":t.isSpeedVideo?r.Editor="Video Speed Changer":t.isConvertVideo&&(r.Editor="Convert Video");r.exportLocation=e;const{origin:l}=t;l&&(r["Landing Page"]=l);const{templateSource:d}=s;d&&(r["Template Source"]=d);Qg()&&(r["Used PWA"]=!0);t.duration&&(r.Duration=t.duration);(t.isCreator||t.isStudio)&&function(e,t,o,a,i){var s,n,r,l,d,c,u;const m=e.scenes[0];if(0===e.duration||e.exportFrameTime>=0?i["Export Type"]="jpg":i["Export Type"]=e.videoType,e.exportQuality&&(i.exportQuality=e.exportQuality),e.exportResolution&&(i.exportResolution=e.exportResolution),"usedUndo"in t&&t.usedUndo&&(i["Used Undo"]=!0),t.usedEyedropper&&(i["Used Eyedropper"]=!0),Km(i,t,o),t.analytics){const{analytics:e}=t;e.activeFindHighlightsJobInfo&&(i["Find Highlights Job ID"]=e.activeFindHighlightsJobInfo.jobId,i["Find Highlights Asset Duration"]=e.activeFindHighlightsJobInfo.assetDuration),Object.entries(gae).forEach((([t,o])=>{e[t]&&o.forEach((e=>i[e]=!0))}))}t.workflowId&&(i["Find Highlights Workflow ID"]=t.workflowId);const p=lj(o);i["Exported With Individual Subtitle Placements"]=p.some((e=>{var t,a,i,s;return!!(null==(s=null==(i=null==(a=null==(t=o.studio.magicSubtitleFramesByAsset)?void 0:t[e.assetId])?void 0:a.byId)?void 0:i[e.frame.id])?void 0:s.position)})),i["Has Smart Reframe Layers"]=m.layers.some((({fromSmartReframe:e})=>e)),i["Has Dubbed Layers"]=m.layers.some((({dubbedAssetId:e})=>!!e));let h=0,g=0;const f=new Map;m.layers.forEach((e=>{if(!e.bRollLayerSource)return;"image"===e.type&&(h+=1),"video"===e.type&&(g+=1);const t=f.get(e.bRollLayerSource)||0;f.set(e.bRollLayerSource,t+1)})),i["B-Roll Image Layers"]=h,i["B-Roll Image Layers From Google"]=f.get("google")||0,i["B-Roll Image Layers From Giphy"]=f.get("giphy")||0,i["B-Roll Image Layers From Dall-E"]=f.get("dall-e")||0,i["B-Roll Image Layers From Getty"]=f.get("getty-images")||0,i["B-Roll Image Layers From Pexels"]=f.get("pexels-images")||0,i["B-Roll Video Layers"]=g,i["B-Roll Video Layers From Pixabay"]=f.get("pixabay")||0,i["B-Roll Video Layers From Pexels"]=f.get("pexels")||0,i["B-Roll Video Layers From Getty"]=f.get("getty-videos")||0,"translate"in t&&!t.isTranscribed&&(i["Used Translate"]=!0),i["Number of Layers"]=Object.entries(e.allLayers.byId).length,i["Max Number of Rows Across Scenes"]=0,hae(e,i,a);const y=Object.keys({}).length;i["Number of Tracks Used"]=y,i["Strict Video Recorded Layers"]=0,i["Strict Audio Recorded Layers"]=0,i["Screen Recorded Layers"]=0,i["Video Recorded During Screen Record Layers"]=0,i["Audio Recorded During Screen Record Layers"]=0,i["Number of Subtitle Layers"]=0,i["Total Uploaded File Size (MB)"]=0;const v=new Set,_=new Set,w=new Set,b=(e,t)=>{i[e]?i[e].push(t):i[e]=[t]},T={};o.magicSubtitlePresets.presets.forEach((e=>{T[e.presetId]=e}));const x={};o.magicSubtitlePresets.brandkitPresets.forEach((e=>{x[e.presetId]=e}));const S={};o.textPresets.presets.forEach((e=>{S[e.presetId]=e}));const E={};o.textPresets.brandkitPresets.forEach((e=>{E[e.presetId]=e}));const I={};o.textTemplates.templates.forEach((e=>{I[e.templateId]=e}));const C={};o.textTemplates.brandkitTemplates.forEach((e=>{C[e.templateId]=e}));const k=new Set;let A=!1,j=!1;for(const P of Object.values(e.allLayers.byId)){if(P.volume&&P.volume>0&&P.volume<1&&(i["Uses Layer Volume Adjust"]=!0),"number"==typeof P.timelineRow&&(m.id,P.timelineRow,i["Max Number of Rows Across Scenes"]=Math.max(P.timelineRow+1,i["Max Number of Rows Across Scenes"])),"video"===P.type&&P.videoDelay&&(i["Uses Video Delay"]=!0),P.type===zl.Shape&&(i["Has Shape"]=!0),"progressBar"===P.shapeType&&(i["Has Progress Bar"]=!0),P.type===zl.Text)if(i["Has Text"]=!0,"wrap"===P.wrapOrFill?i["Used Text Background"]="wrap":"fill"===P.wrapOrFill||P.backgroundColor?i["Used Text Background"]="fill":i["Used Text Background"]="none",P.textShadow&&P.textShadow!==ey?i["Used Text Outline"]=P.textShadow:i["Used Text Outline"]="none",P.fromTextDefaults){const e=P.fromTextDefaults;if(!k.has(e)){k.add(e);const t=I[e],a=C[e],i=t||a;if(i){const e=!!a,s=qy(i),n=i.projectId!==o.studio.projectId;b("Reused Text Custom Template",!s&&n),b("Used Text Custom Template",!s&&!n),b("Used Text Brandkit Template",e),b("Used Text Brandkit Template From Another User",e&&!t),b("Used Text Default Template",s),s&&b("Text Default Template ID",i.templateId)}}}else{const e=bZ(P),t=S[e.presetId],a=E[e.presetId],i=t||a,s=!!a,n=!!i&&Ry(i),r=(null==i?void 0:i.projectId)!==o.studio.projectId;b("Reused Text Custom Preset",!n&&r),b("Used Text Custom Preset",!n&&!r),b("Used Text Brandkit Preset",s),b("Used Text Brandkit Preset From Another User",s&&!t),b("Used Text Default Preset",n),n&&b("Text Default Preset ID",i.presetId)}"image"===P.type&&("dropShadow"===P.imageEffect&&(i["Has Image Drop Shadow"]=!0),"image/webp"===P.mime&&(i["Has Webp File"]=!0),P.isFreezeFrameLayer&&(i["Has Freeze Frame"]=!0),(null==(s=P.usedProFeatures)?void 0:s.includes("enhanced-image"))&&(i["Has Enhanced Image"]=!0)),P.pluginSource&&(i["Has Layer From Plugin"]=!0);const e=Fx(P);e&&"none"!==e.id&&(i["Has Animation"]=!0,"image"===P.type&&(i["Has Image Animation"]=!0),"text"===P.type&&(i["Has Text Animation"]=!0),"video"===P.type&&(i["Has Video Animation"]=!0)),void 0!==Mx(P).find((e=>"outro"===e.type))&&(i["Has Outro Animation"]=!0),qS(P)&&(i["Has Moving Zoom"]=!0);const{introTransition:t,outroTransition:a}=Bx(P);if((t&&"none"!==t.id||a&&"none"!==a.id)&&(i["Has Transition"]=!0),(null==t?void 0:t.transitionId)&&fx(null==t?void 0:t.transitionId)&&w.add(null==t?void 0:t.transitionId),(null==a?void 0:a.transitionId)&&fx(null==a?void 0:a.transitionId)&&w.add(null==a?void 0:a.transitionId),"text"===P.type&&P.textEffect&&(i["Uses Text Effect"]=!0,"dropShadow"===P.textEffect&&(i["Uses Drop Shadow"]=!0),"textBlur"===P.textEffect&&(i["Uses Text Blur"]=!0)),(null==(n=P.draftJSTextTree)?void 0:n.blocks.length)&&!i["Uses Inline Styling"]){const{blocks:e}=P.draftJSTextTree,t=new Set(null==(r=e[0])?void 0:r.inlineStyleRanges.map((e=>e.style)));i["Uses Inline Styling"]=e.some((e=>e.inlineStyleRanges.some((o=>!t.has(o.style)||0!==o.offset||o.length!==e.text.length))))}if("library"in P&&"emoji"===P.library&&(i["Has Emoji"]=!0),P.hasCustomFont&&(i["Has Custom Font"]=!0),"video"!==P.type&&"image"!==P.type||!("lineWidth"in P)||0===P.lineWidth||(i["Uses Image/Video Border"]=!0),P.isAudiogram&&(i["Has Audiogram"]=!0),P.removeBg&&(i["Uses Video Remove Background"]=!0),P.blurBg&&(i["Uses Video Blurred Background"]=!0),P.chromaKey&&(i["Uses Chroma Key"]=!0),P.isReversed&&(i["Uses Reverse Effect"]=!0),P.presetFilter&&P.presetFilter.name&&"Original"!==P.presetFilter.name&&(i["Uses Preset Filter"]=!0),"video"===P.recordType&&(i["Strict Video Recorded Layers"]+=1),"audio"===P.recordType&&(i["Strict Audio Recorded Layers"]+=1),"screen"===P.recordType&&(i["Screen Recorded Layers"]+=1),"screen-video"===P.recordType&&(i["Video Recorded During Screen Record Layers"]+=1),"screen-audio"===P.recordType&&(i["Audio Recorded During Screen Record Layers"]+=1),P.preemptiveDownloadError&&(i["Preemptive Download Error Detected"]=!0),P.addedFromMediaLibrary&&(i["Uses Media Library"]=!0),P.locked&&(i["Has a Locked Layer"]=!0),"rectangle"===P.shapeType&&P.borderRadius&&"0"!==P.borderRadius.relative&&(i["Has Rounded Rectangles"]=!0),P.isZoomed&&(i["Uses Zoom"]=!0),P.detachedAudioId&&(i["Detached Video"]=!0),P.audioEffect&&"fade"===P.audioEffect&&("audio"===P.type&&(i["Used Audio Fade"]=!0),"video"===P.type&&(i["Used Audio Fade for Video Layer"]=!0)),P.volume&&P.volume>1&&(i["Set Volume > 100%"]=!0),"number"==typeof P.size&&(i["Total Uploaded File Size (MB)"]+=P.size/1e6),!A&&o.teams.activeBrandkit&&((null==(l=o.teams.activeBrandkit)?void 0:l.cmlIds)&&P.cmlFileId&&o.teams.activeBrandkit.cmlIds.includes(P.cmlFileId)||P.color&&o.teams.activeBrandkit.colors.includes({value:P.color,default:!1})||P.backgroundColor&&o.teams.activeBrandkit.colors.includes({value:P.backgroundColor,default:!1})||P.fontFamily&&o.teams.activeBrandkit.fonts.some((e=>e.fontFamily===P.fontFamily)))&&(i["Used Brandkit Asset"]=!0,A=!0),!j&&o.teams.activeBrandkit){if(P.asset_id){const e=null==(d=o.assets.byId[P.asset_id])?void 0:d.input_url;(null==e?void 0:e.includes("asset.brandfetch.io"))&&(i["Used Prepopulated Brandkit Asset"]=!0,j=!0)}(P.color&&o.teams.activeBrandkit.colors.includes({value:P.color,default:!1,isPrepopulated:!0})||P.backgroundColor&&o.teams.activeBrandkit.colors.includes({value:P.backgroundColor,default:!1,isPrepopulated:!0})||P.fontFamily&&o.teams.activeBrandkit.fonts.some((e=>e.fontFamily===P.fontFamily&&e.isPrepopulated)))&&(i["Used Prepopulated Brandkit Asset"]=!0,j=!0)}P.hasAudio&&(v.add(P.asset_id),_.add(P.id))}if(i["Audible Assets"]=v.size,i["Audible Layers"]=_.size,i["GLTransitions Used"]=[...w],e.ratio&&(i.Ratio=e.ratio),e.audio&&e.audio.url&&(i["Has Audio"]=!0),i["Scene Count"]=1,e.scenes&&e.scenes.length>1&&(i["Scene Count"]=e.scenes.length),e.scenes){const t=e.scenes.map((e=>e.layers.filter((e=>"video"===e.type)).length)),o=Math.max(...t);i["Max Video Layers in Single Scene"]=o}if(e.groups&&Object.values(e.groups).filter((e=>e.saved)).length>0&&(i["Has a Group"]=!0),e.contextMenuUsed&&(i["Opened Context Menu"]=e.contextMenuUsed),null===e.duration&&(i["Null Duration"]=!0),void 0===e.duration&&(i["Undefined Duration"]=!0),(null==(c=o.projectSessionSettings.trimWithTranscriptAnalytics)?void 0:c.secondsRemoved)&&(i["Trim With Transcript - Seconds Removed"]=Math.ceil(o.projectSessionSettings.trimWithTranscriptAnalytics.secondsRemoved)),Object.values(t.magicSubtitles||{}).some((e=>null==e?void 0:e.enabled))){const e=Object.entries(t.magicSubtitles||{}).filter((([e,t])=>null==t?void 0:t.enabled)).map((([e])=>e)),a=new Set,s=new Set;for(const t of e){const e=IA(t)(o),i=e.transitionId||Yl.None,{wordByWordAnimations:n}=e;if(n&&n.animationId!==Yl.None&&n.animationName!==Yl.None){const{animationId:e,animationName:t}=n,o=`${e}:${t}`;a.add(o)}i!==Yl.None&&s.add(i)}const n=[...s],r=[...a];n.length&&(i["Magic Subtitle Transitions"]=n.join(" ")),r.length&&(i["Magic Subtitle Animations"]=r.join(" "));for(const l of e){const e=null==(u=t.magicSubtitles)?void 0:u[l];if(!e)continue;e.transcriptionSource&&"transcription"!==e.transcriptionSource||(i["Used Magic Autogenerate"]=!0),e.translatedLanguageCode&&(i["Used Magic Translate"]=!0);const a=DA(l)(o),s=!!(null==a?void 0:a.some((e=>e&&e.words.some((e=>e.styles&&Object.keys(e.styles).length>1)))));i["Used Magic Subtitles Inline Styling"]=s;const n=SU();if(n){const e=T[n.presetId],t=!!x[n.presetId],a=kg(n),i=n.projectId!==o.studio.projectId;b("Used Magic Subtitles Custom Preset",!a&&!i),b("Reused Magic Subtitles Custom Preset",!a&&i),b("Used Magic Subtitles Brandkit Preset",t),b("Used Magic Subtitles Brandkit Preset From Another User",t&&!e),b("Used Magic Subtitles Default Preset",a),a&&b("Magic Subtitles Default Preset ID",n.presetId)}}}let N=!1;if(t.keyframing){let e=0,o=0;Object.values(t.keyframing).forEach((t=>{let a=!1;Object.entries(t).forEach((([t,o])=>{const{keyframes:s}=o;if(!s.length)return;const n=`Total ${t} Keyframes`;e+=s.length,a=!0,i[n]||(i[n]=0),i[n]+=s.length})),a&&(o+=1)})),e&&(N=!0,i["Total Keyframe Count"]=e,i["Total Keyframed Layer Count"]=o)}i["Has Keyframes"]=N;const R=mF.getMetrics();R&&Object.assign(i,R)}(t,o,s,a,r);r["Trim And Drag Onboarding Overlay Active"]=n;const{interval:c,status:u}=await gM(),m=Hu(),p=au();r["Team ID"]=m?m._id:"None",r["Current Plan"]=p.name,r["Monthly/Annual"]=c,r["Subscription Status"]=u,r["Number of Workspace Members"]=m?null==(i=null==m?void 0:m.users)?void 0:i.length:0,r["Is Team Member"]=Em(t.teamId??""),r["Is Project Owner"]=Sm(t.creatorId??""),r["Brand Kit Pre-Populated"]=Nm(),r["Subtitle Edits"]=Object.values(o.transcriptionEditCounts||{}).reduce(((e,t)=>e+t),0),Fm(ym.CREATE_VIDEO,r),bl("Create Video")}({exportLocation:e,video:t,studioState:o,processedOnClient:a})}catch(IGe){console.error(IGe),R(IGe)}}async function yae({callToAction:e,template:t,originOverride:o}){var a;const{state:i}=sr(),{currentUser:s,templateSource:n}=i,r=o||i.studio.origin,l={"Call to Action":e};if(l["Landing Page"]=r,!(null==l?void 0:l["Landing Page"]))switch(e){case Rm.GetStarted:l["Landing Page"]="Home Page",l["Landing Page URL"]="https://www.kapwing.com/";break;case Rm.NewContentWorkspace:l["Landing Page"]="Workspace",l["Landing Page URL"]="https://www.kapwing.com/folder";break;case Rm.EditThisTemplate:l["Landing Page"]=(null==t?void 0:t.title)||"Unknown",l["Landing Page URL"]=`https://www.kapwing.com/explore/${null==t?void 0:t.slug}`;break;default:l["Landing Page"]="undefined",l["Landing Page URL"]="undefined"}n&&(l["Template Source"]=n),s&&s.user&&(l["Project Owner Email"]=s.user.email),l["Trim And Drag Onboarding Overlay Active"]=!1;const{interval:d,status:c}=await gM(),u=Hu(),m=au();l["Team ID"]=u?u._id:"None",l["Current Plan"]=m.name,l["Monthly/Annual"]=d,l["Subscription Status"]=c,l["Quantity Legacy Members"]=0,l["Number of Workspace Members"]=(null==(a=null==u?void 0:u.users)?void 0:a.length)||0,Fm(ym.STARTED_EDITING,l),bl("Started Editing")}async function vae(e,t){const{interval:o,status:a}=await gM(),i=Hu(),s=au();Fm(ym.DOWNLOAD_FILE,{"Is Signed In":e,"Team ID":i?i._id:"None","Current Plan":s.type,"Monthly/Annual":o,"Subscription Status":a,"Quantity Legacy Members":0,"Number of Workspace Members":i?i.users.length:0,"Entry Point":t})}function _ae(){Fm(ym.CLICKED_SIGN_IN_TO_EXPORT)}const wae=(e,t)=>{const o=t.scenes.reduce(((e,{layers:t})=>(t.forEach((t=>{e[t.id]=t})),e)),{}),a=t.animations.byId;Object.entries(e.studio.keyframing||{}).forEach((([e,i])=>{var s,n,r;const l=o[e];if(!l)return;const d=null==(s=t.backgroundLayers)?void 0:s.find((({originalLayerId:e})=>e===l.id));if(null==(n=l.animation)?void 0:n.constant)for(const t of l.animation.constant){const e=a[t];if(null==e?void 0:e.keyframeChannels)return d&&(d.animation={constant:[t]}),void(e.keyframeChannels=i)}const c={animationName:"Keyframes",id:P(),speed:"default",isCrossTransition:!1,layerId:e,keyframeChannels:i};t.animations.byId[c.id]=c,t.animations.allIds.push(c.id);const u=(null==(r=l.animation)?void 0:r.constant)||[],m={...l.animation,constant:[...u,c.id]};l.animation=m,d&&(d.animation={constant:[c.id]}),t.allLayers.byId[l.id].animation=m}))},bae=(e,t,o,a)=>{var i;const s=e.startTime||0,n=(null==(i=e.animation)?void 0:i.duration)||e.endTime;let r;r=o?(o-s)/(n-s):0,function(e,t){if("background"!==t.progressBarStyle)return;const o=q2(t);if(!o)return;e.fillStyle=o.backgroundStyleColor,e.fillRect(0,0,t.position.pixel_width,t.position.pixel_height)}(t,e),function(e,t){if("glowing"!==t.progressBarStyle)return;const o=q2(t);if(!o)return;e.shadowColor=o.glowingStyleColor,e.shadowBlur=70}(t,e),function(e,t,o){const a=q2(e);if(!a)return;switch(e.progressBarStyle){case"gradient":{const i=t.createLinearGradient(0,0,e.position.pixel_width*o,e.position.pixel_height);i.addColorStop(0,a.gradientStyleColor),i.addColorStop(1,a.background),t.fillStyle=i;break}default:t.fillStyle=a.background}}(e,t,r),t.fillRect(0,0,e.position.pixel_width*r,e.position.pixel_height),function(e,t,o,a){if(parseFloat(e)<=0)return;t.lineWidth=e,t.strokeStyle=o.stroke,t.beginPath(),t.moveTo(0,0),t.lineTo(o.position.pixel_width*a,0),t.stroke(),t.moveTo(0,0),t.lineTo(0,o.position.pixel_height),t.lineTo(o.position.pixel_width*a,o.position.pixel_height),t.stroke()}(a,t,e,r)};const Tae=(e,t,o,a,i=W[0],s,n,r)=>{const l=e.getContext("webgl")||e.getContext("experimental-webgl");l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0);const d=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array([-1,-1,-1,4,4,-1]),l.STATIC_DRAW),l.viewport(0,0,e.width,e.height);const c=Xt(l,t);c.minFilter=l.LINEAR,c.magFilter=l.LINEAR;const u=Xt(l,o);u.minFilter=l.LINEAR,u.magFilter=l.LINEAR,Qt(l,i).draw(a,c,u,s,n,r)},xae=(e,t,o,a,i,s,n,r=1)=>{e.save();let l=0;let d=o;s>1&&(d=o*s),i&&(l=t,d=o),e.globalAlpha=r||1,n&&(e.globalCompositeOperation=n);const c=e.createLinearGradient(l,0,0,d);for(let u=0;u<a.length;u+=1){const e=a[u];c.addColorStop(e.start,e.color)}e.fillStyle=c,e.fillRect(0,0,t,o),e.restore()};const Sae=50,Eae=50,Iae=159,Cae=830,kae=async(e,t=0,o=null,a=[],i=!1,s="original",n=6,r=!1,l=0,d)=>{let c,u;if(d)c=d.Image,u=d.createCanvas;else{if("undefined"==typeof Image)throw Error("CanvasInterface not set.");c=Image,u=(e,t)=>{const o=document.createElement("canvas");return o.width=e,o.height=t,o}}const m="rgba(-255,-255,-255,0)",p="string"!=typeof s;try{const i=(e,t,o,a)=>{let i;if("top"===a)i=o;else i=e.height-t-o;return i},d=t=>{const o=parseFloat(Math.min(1,Math.max(t.height,t.width)/3160)),a=Iae*o,s=Cae*o,n=Sae*o,r=Eae*o,l=t.width-s-n,d=e.alignWatermark||"bottom";return[l,i(t,a,r,d),s,a]},h=async(t,o)=>{t.save();const[a,i,s,n]=d(o),r=await b(e.watermark_img,!0,s,n);t.imageSmoothingEnabled=!0,t.drawImage(r,a,i,s,n),t.restore()},g=(t,o,a,i,s)=>{let n="";const r=XT(o,e.animations),l=r?cx(o,r,s):o.filters,d=t.canvas.clientWidth||t.canvas.width,c=t.canvas.clientHeight||t.canvas.height;if(l)for(const e in l){switch(e){case"contrast":case"brightness":case"saturate":n+=`${e}(${l[e]/100})`;break;case"opacity":n+=`opacity(${l[e]}%)`;break;case"blur":void 0===l.blurPercent&&(n+=`blur(${parseFloat(l[e])/1e3*Math.max(d,c)}px)`);break;case"blurPercent":n+=`blur(${Math.min(d,c)*l[e]/100}px)`;break;case"blurBackground":n+=`blur(${Math.min(a,i)*l[e]/100}px)`;break}n+=" "}t.filter=n},f=(t,o,a,i)=>{const s=XT(a,e.animations),n=cx(a,s,i);if(n.blur){const e=o.width+500,t=o.height+500,s=u(e,t),n=s.getContext("2d");g(n,a,o.width,o.height,i),n.drawImage(o,0,0,o.width,o.height,e/2-o.width/2,t/2-o.height/2,o.width,o.height);const r=u(o.width,o.height);r.getContext("2d").drawImage(s,e/2-o.width/2,t/2-o.height/2,o.width,o.height,0,0,o.width,o.height),o=r}else if(n.blurBackground){const e=Math.min(o.width,o.height),t=a.filters.blurBackground*e/100,s=u(o.width,o.height),n=s.getContext("2d"),[r,l]=a2({blurPixels:t,image:o,createCanvas:u});g(n,a,o.width,o.height,i),n.drawImage(r,-l,-l,r.width,r.height),o=s}else g(t,a,o.width,o.height,i);return o},y=(e,t,o)=>{const{crop_x:a,crop_y:i,crop_width:s,crop_height:n,file_width:r,file_height:l,pixel_width:d,pixel_height:c,adjusted_width:u,adjusted_height:m}=t.position;if(!t.crop&&!qS(t))return{x:a,y:i,width:s,height:n};if(!qS(t))return{x:a+t.crop.x/100*e.width,y:i+t.crop.y/100*e.height,width:s,height:n};const p=XS(t),h=YS(p,o),g=JS(t.crop,h),f=r*(g.width/100),y=l*(g.height/100),v=f*d/u,_=y*c/m;return{x:g.x/100*e.width+(f-v)/2,y:g.y/100*e.height+(y-_)/2,width:v,height:_}},v=(e,t,o,a,i)=>{const{chromaKeyValThreshold:s}=i;return Math.sqrt((Math.pow(e-a.R,2)+Math.pow(t-a.G,2)+Math.pow(o-a.B,2))/195075)<s},_=(e,t)=>{if("colorKey"===t.chromaKeyChannel&&t.chromaKeyColor===m)return e;let o;if("colorKey"===t.chromaKeyChannel&&t.chromaKeyColor){o={R:parseInt(t.chromaKeyColor.slice(1,3),16),G:parseInt(t.chromaKeyColor.slice(3,5),16),B:parseInt(t.chromaKeyColor.slice(5,7),16)}}else"green"===t.chromaKeyChannel?o={R:0,G:255,B:0}:"blue"===t.chromaKeyChannel&&(o={R:0,G:0,B:255});const a=u(e.width,e.height),i=a.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),n=s.data;for(let r=0;r<n.length;r+=4)v(n[r],n[r+1],n[r+2],o,t)&&(n[r+3]=0);return i.clearRect(0,0,e.width,e.width),i.putImageData(s,0,0),e=a},w=(e,t,o)=>{const a=u(e.width,e.height),i=a.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=Buffer.from(t.mask_base64_img.split(",")[1],"base64"),n=Zt.decode(s).data,r=i.getImageData(0,0,e.width,e.height),l=r.data,d=t.maskBitValuesToKeep[o]||[],c=[4,244,4,255];for(let u=0;u<l.length;u+=4){const e=n[u],t=n[u+1],o=n[u+2],a=n[u+3];d.some((i=>o2(i,[e,t,o,a])))||(l[u]=c[0],l[u+1]=c[1],l[u+2]=c[2],l[u+3]=c[3])}return i.clearRect(0,0,e.width,e.width),i.putImageData(r,0,0),e=a},b=async(e,t=!0,o,a)=>{if(!e)throw Error("Missing image source");const i=new c(o,a);return await new Promise(((a,s)=>{i.onload=()=>a(),t&&(i.onerror=e=>{s(e)}),i.src=e,(i.complete||!o&&i.width>0)&&a()})),i},T=(e,t,o,a)=>{var i,s;const n=t.split(","),r=Buffer.from(n[1]??"","base64"),l=(new DOMParser).parseFromString(r,"text/xml").documentElement,d=l.hasAttribute("width")&&!(null==(i=l.getAttribute("width"))?void 0:i.includes("100%")),c=l.hasAttribute("height")&&!(null==(s=l.getAttribute("height"))?void 0:s.includes("100%"));if(d||c)return 1;const u=e.canvas.clientHeight||e.canvas.height,m=e.canvas.clientWidth||e.canvas.width;return o/a>m/u?m/o:u/a},x=(e,t,o,a)=>{const i=t.width+1e3,s=t.height+1e3,n=u(i,s),r=n.getContext("2d"),l=o.imageShadowDist||0,d=(o.imageShadowRot||0)*Math.PI/180,c=100*l*Math.cos(d),m=100*l*Math.sin(d);return r.shadowColor=o.imageEffectColor,r.shadowBlur=50*o.imageShadowBlur,r.shadowOffsetX=c,r.shadowOffsetY=m,r.drawImage(t,a.x,a.y,a.width,a.height,50,50,o.position.pixel_width,o.position.pixel_height),e.drawImage(n,-50,-50,n.width,n.height),n},S=async(o,a,i)=>{let s;o.save(),s=await b(a.base64_img,!1);const n=XT(a,e.animations);a.chromaKey&&(s=_(s,a)),a.presetFilter&&!a.preProcessed&&(s=((e,t,o)=>{if(!t.presetFilter)return e;if("Original"===t.presetFilter.name)return e;const a=t.presetFilter,i=o(e.width,e.height),s=i.getContext("2d");if(!s)return;a.background&&xae(s,e.width,e.height,a.background,a.backgroundAngle,a.backgroundGradientEnd),s.globalCompositeOperation=a.backgroundBlendMode,s.filter=a.styles,s.save(),s.globalAlpha=a.opacity,s.drawImage(e,0,0,e.width,e.height),s.restore(),a.foreground&&xae(s,e.width,e.height,a.foreground,a.foregroundAngle,a.foregroundGradientEnd,a.foregroundBlendMode,a.foregroundOpacity);const n=o(e.width,e.height),r=n.getContext("2d");return r&&(r.drawImage(e,0,0,e.width,e.height),r.globalCompositeOperation="source-in",r.drawImage(i,0,0,e.width,e.height)),n})(s,a,u)),(a.filters||(e=>!!e&&("opacity"in e||"brightness"in e||"contrast"in e||"saturate"in e||"blurPercent"in e))(n))&&(s=f(o,s,a,i)),a.isSieveRemoveBackground&&(s=w(s,a,t));const{xPos:r,yPos:l,width:d,height:c}=lx(a,e,i,o.canvas.clientWidth||o.canvas.width,o.canvas.clientHeight||o.canvas.height),m=r+a.position.pixel_width/2,p=l+a.position.pixel_height/2;o.translate(m,p);let h=!1,g=!1;if(a.position.flip){const{x:e,y:t}=a.position.flip,i=e?-1:1,s=t?-1:1;h=e,g=t,o.scale(i,s)}if(a.position.rotation){const{rotation:e}=a.position;let t=null;!h&&!g||h&&g||(t=360-e),o.rotate((t||e)*Math.PI/180)}o.translate(-m,-p),o.translate(r,l);const v=o.canvas.clientHeight||o.canvas.height;qT(a,e.animations)&&ZT(e.animations,a,o,i);let S=y(s,a,i);if("image/svg+xml"===a.mime||"image/svg+xml"===a.mime_type){const e=T(o,a.base64_img,a.position.file_width,a.position.file_height);S={x:S.x*e,y:S.y*e,width:S.width*e,height:S.height*e}}else o.imageSmoothingEnabled=!0;const E=(a.objectFit||"cover").toLowerCase(),I=a.lineWidth?parseFloat(a.lineWidth)/100*v:a.lineWidth,C=a.stroke||"#000000";a.borderRadius&&"0%"!==a.borderRadius.relative&&(a.preProcessed||Pk(o,a,I,C)),!E||["cover","crop"].includes(E)?("dropShadow"!==a.imageEffect||a.preProcessed||a.borderRadius&&"0%"!==a.borderRadius.relative?o.drawImage(s,S.x,S.y,S.width,S.height,0,0,d,c):x(o,s,a,S),I>0&&(!a.borderRadius||"0%"===a.borderRadius.relative)&&(o.lineWidth=I,o.strokeStyle=C,o.strokeRect(-I/2,-I/2,d+I,c+I))):o.drawImage(s,0,0,d,c),o.restore()},E=(e,t,o,a)=>{e.lineCap="butt";const i=3*a,s=3*a,n=2*Math.PI,r=o.length;let l,d;l=o[r-2]-o[r-4],d=o[r-1]-o[r-3];const c=(Math.atan2(d,l)+n)%n;e.fillStyle=t.stroke,e.lineCap=t.lineCap,e.lineJoin=t.lineCap,e.save(),e.beginPath(),e.translate(o[r-2],o[r-1]),e.rotate(c),e.moveTo(0,0),"open"===t.lineArrow?(e.moveTo(-s,i/2),e.lineTo(0,0),e.lineTo(-s,-i/2)):(e.lineTo(-s,i/2),e.lineTo(-s,-i/2),e.closePath(),e.fill()),e.restore(),t.pointerAtBeginning&&(e.save(),e.translate(o[0],o[1]),l=o[2]-o[0],d=o[3]-o[1],e.rotate((Math.atan2(-d,-l)+n)%n),e.moveTo(0,0),e.lineTo(-s,i/2),e.lineTo(-s,-i/2),e.closePath(),e.restore()),e.setLineDash([]),e.stroke()},I=(e,t)=>{switch(e){case"big dash":return[4*t,2*t];case"small dash":return[2*t];case"dotted":return[0,t+t/2];default:return[]}},C=(e,t,o,a,i)=>{const s=new Path2D,n=i/2,r=("vertical"===t.lineRightAngle?i:o)-n,l=("horizontal"===t.lineRightAngle?i:a)-n,d={topLeft:[n,n,r,l],topRight:[r,n,n,l],bottomLeft:[n,l,r,n],bottomRight:[r,l,n,n]}[t.linePointStartCorner||"topLeft"],[c,u,m,p]=d,h=I(t.lineStyle||"solid",i);e.setLineDash(h),s.moveTo(c,u),s.lineTo(m,p),e.lineWidth=i,e.stroke(s),t.lineArrow&&E(e,t,d,i)},k=(e,t,o,a,i,s)=>{e.save(),e.scale(a,i);const n=new Path2D(s);e.fill(n),parseFloat(t.lineWidth)>0&&(e.lineWidth=o/a,e.stroke(n)),e.restore()},A=(t,o,a)=>{const i=XT(o,e.animations),{xPos:s,yPos:n,width:r,height:l}=lx(o,e,a,t.canvas.clientWidth||t.canvas.width,t.canvas.clientHeight||t.canvas.height),{pixel_width:d,pixel_height:c}=o.position;if("placeholder"!==o.converted_type){let u=1,m=1;o.position.svg_width&&o.position.svg_height&&(u=r/o.position.svg_width,m=l/o.position.svg_height);const{lineWidth:p}=o,h=t.canvas.clientHeight||t.canvas.height,g=isNaN(p)?parseFloat(p)/100*h:p;t.save(),t.fillStyle=dx(o,i,a),t.strokeStyle=o.stroke,t.lineWidth=o.lineWidth,"number"==typeof o.globalAlpha&&(t.globalAlpha=o.globalAlpha),i&&i.opacity&&(t.globalAlpha=cx(o,i,a).opacity/100);const f=s+d/2,y=n+c/2;"ellipse"===o.shapeType?t.translate(s,n):t.translate(f,y),o.position.rotation&&t.rotate(o.position.rotation*Math.PI/180),"ellipse"!==o.shapeType?(t.translate(-f,-y),t.translate(s,n)):t.translate(-d/2,-c/2),"progressBar"!==o.shapeType&&qT(o,e.animations)&&ZT(e.animations,o,t,a),"progressBar"===o.shapeType&&qT(o,e.animations)?bae(o,t,a,g):"rectangle"===o.shapeType?(Pk(t,o,g,t.strokeStyle),t.fill()):["line","arrow"].includes(o.shapeType)?(t.lineCap=o.lineCap||"square",C(t,o,r,l,g)):"ellipse"===o.shapeType?(t.translate(d/2,c/2),t.beginPath(),t.ellipse(0,0,r/2,l/2,0,0,2*Math.PI),t.save(),t.clip(),t.fill(),t.restore(),parseFloat(p)>0&&(t.lineWidth=g,t.stroke())):o.svgData?k(t,o,g,u,m,o.svgData):o.svgChildren&&o.svgChildren.forEach((({type:e,props:a})=>{if("path"===e){const{d:e}=a;k(t,o,g,u,m,e)}else if("circle"===e){const{cx:e,cy:o,r:i}=a;t.save(),t.scale(u,m),t.beginPath(),t.arc(e,o,i,0,2*Math.PI),t.closePath(),t.stroke(),t.fill(),t.restore()}}))}else{if(t.save(),o.position.rotation){const e=s+o.position.pixel_width/2,a=n+o.position.pixel_height/2;t.translate(e,a),t.rotate(o.position.rotation*Math.PI/180),t.translate(-e,-a)}t.translate(s,n);const e=new Path2D;e.rect(0,0,r,l),t.fillStyle=o.background,t.lineWidth=1,t.strokeStyle=o.borderColor||"black",t.setLineDash([10,5]),t.fill(e),t.stroke(e),t.setLineDash([])}t.restore()},j=({ctx:e,i:t,frequency:o,width:a,height:i})=>{const s=Math.floor(.004*a)||1,n=t*s;if(n>a)return;const r=i-i/2,l=o/255*i*.3;e.fillRect(n,r+1,s,-l),e.fillRect(n,r-1,s,l)},N=({ctx:e,i:t,frequency:o,width:a,height:i})=>{const s=Math.floor(.005*a)||1,n=t*(2*s);if(n>a)return;const r=i,l=-(o/255)*i*.8;e.fillRect(n,r,s,l)},R=(e,t,o)=>{e.save(),e.fillStyle=t.color;const a=e.canvas.clientHeight||e.canvas.height,i=e.canvas.clientWidth||e.canvas.width,s=parseFloat(t.position.width)/100*i,r=parseFloat(t.position.height)/100*a,l=parseFloat(t.position.x)/100*i,d=parseFloat(t.position.y)/100*a,c=parseFloat(t.position.rotation),u=parseInt(o,10),m=Math.floor(u/n),p=s,h=t.fft_data||[];let g;if("audiogramFrameData"in h)g=h.audiogramFrameData;else if(g=h[m],!g){const e=Object.values(h);g=e[e.length-1]}if(c){const t=l+s/2,o=d+r/2;e.translate(t,o),e.rotate(c*Math.PI/180),e.translate(-t,-o)}e.translate(l,d);for(let n=0;n<p;n++){const o={ctx:e,i:n,frequency:g&&g[n]?g[n]:0,width:s,height:r};"wave"===t.waveformStyle?j(o):"bar"===t.waveformStyle&&N(o)}e.restore()},P=async(t,o,a,i,s)=>{const n=a.converted_type||a.type;let d=i/s;switch(r&&(d=l),n){case"text":sA(t,a,d,function(e,t,o){const{baseWidth:a,position:i}=o,s=parseFloat(null==i?void 0:i.width);return null==a||isNaN(s)?e.height/(t.sceneHeight||1):e.width*s/100/a}(o,e,a),e.animations);break;case"placeholder":case"progressBar":case"shape":A(t,a,d);break;case"audio":a.isAudiogram&&R(t,a,i);break;default:await S(t,a,d)}};let D;p?D=s:(document.body.style.margin="0px",D=document.getElementById(s),D.width=e.adjusted_width,D.height=e.adjusted_height);const O=D.getContext("2d",{alpha:!0});O.imageSmoothingEnabled=!1;const L=e.sceneBackground===m,F=["gif","image","webp"].includes(e.videoType);if(!L||e.sceneDuration&&!F?(O.fillStyle=L?"#ffffff":e.sceneBackground,O.fillRect(0,0,D.width,D.height)):O.clearRect(0,0,D.width,D.height),o){const e=await b(o);O.drawImage(e,0,0,D.width,D.height)}const M={},U=e.animations&&e.animations.byId?Object.values(e.animations.byId).filter((e=>W.map((({name:e})=>e)).includes(e.animationName))):[];for(let o=0;o<U.length;o++){const i=U[o],s=e=>{const t=a.findIndex((t=>t.id===e));return[t,t>=0?a[t]:null]},n=([e,{animation:t,...o}])=>[e,o],{introLayerId:r,outroLayerId:l,animationName:d}=i,c=W.find((e=>e.name===d)),m=[s(l),s(r)];if(null==t||!m.some((e=>e[1])))continue;let p,h,g=-1,f=-1,y=0,v=ex(i,e.animations);const _=m[0],w=m[1];if(null==_?void 0:_[1])if(null==w?void 0:w[1]){const[e,t]=m.map(n);e&&([f,h]=e),t&&([g,p]=t),y=cm(p).start;v=cm(h).end-y}else{[f,h]=n(_);y=cm(h).end-v;const o=(t/e.maxFramerate-y)/v;if(o<0||o>1)continue}else{[g,p]=n(w),y=cm(p).start;const o=(t/e.maxFramerate-y)/v;if(o<0||o>1)continue}const b=Math.max(f,g),T=t/e.maxFramerate,x=u(D.width,D.height),S=u(D.width,D.height),E=u(D.width,D.height),I=x.getContext("2d",{alpha:!0});I.imageSmoothingEnabled=!1;const C=E.getContext("2d",{alpha:!0});C.imageSmoothingEnabled=!1;const k=(T-y)/v;k<0||k>1||(h&&h.base64_img&&await P(I,x,h,t,e.maxFramerate),p&&p.base64_img&&await P(C,E,p,t,e.maxFramerate),Tae(S,x,E,k,c,D.width,D.height,{}),M[b]=S)}let B=!1;for(let o=0;o<a.length;o++){const i=a[o];if("audio"===i.converted_type&&!i.isAudiogram)continue;i.isMagicSubtitle&&!B&&(B=!0,e.watermark&&await h(O,D));const s=e.sceneDuration||0;if(null!=t&&e.maxFramerate&&s&&!gm(i,t,{duration:s,maxFramerate:e.maxFramerate}))continue;if(r&&s>0&&!fm(i,l,{duration:s}))continue;await P(O,D,i,t,e.maxFramerate);const n=M[o];n&&O.drawImage(n,0,0,D.width,D.height)}e.watermark&&!B&&await h(O,D);const V=`image/${e.frameExt||"png"}`;return r?D:D.toDataURL(V,1)}catch(h){throw console.error("Failed to draw canvas",h.toString()),h}},Aae={AUTO:0,"480p":848,"720p":1280,"1080p":1920,"4K":3840},jae={SD:"480p",HD:"720p",FHD:"1080p"},Nae=e=>jae[e]||e,Rae=e=>{if(!e.hasCustomOutput||(e=>{var t;return(e.duration||0)>0||!!((null==(t=e.scenes)?void 0:t.length)||[].length>1)})(e)){const t=Nae(e.exportResolution);return Aae[t]||Aae["4K"]}const t=e.customOutputHeight||0,o=e.customOutputWidth||0;return Math.max(o,t,Aae["4K"])},Pae=e=>2*Math.ceil(Number(e)/2),Dae=e=>Math.ceil(e),Oae=(e,t,o)=>{let a=o;const i=Math.abs(e),s=Math.abs(t);if(!s||!i)return[i,s];let n=i,r=s;const l=s/i,d=i/s;i>=s?(n=Math.min(Math.max(i,0),i),r=l*n):(r=Math.min(Math.max(s,0),s),n=d*r),["1:1","9:16","16:9","5:4","4:5"].includes(o)||(a=`${Pae(n)}:${Pae(r)}`);const[c,u]=((e,t,o)=>{let a=e,i=t;if("1:1"===o){const e=Math.max(a,i);return[e,e]}const s=o.split(":").map((e=>parseInt(e))),n=s[0]??1,r=s[1]??1;return a=Pae(a),i=Pae(i),a/i>n/r?(a=Math.ceil(a/n)*n,i=a*r/n):a/i<n/r&&(i=Math.ceil(i/r)*r,a=i*n/r),a%2==0&&i%2==0||(a+=n,i+=r),[a,i]})(n,r,a);return n=c,r=u,r=Pae(r),n=Pae(n),[n,r]},Lae=(e,t,o)=>{if(!e)return[-1,-1];if(!(null==e?void 0:e.height)||!(null==e?void 0:e.width))return[-1,-1];let a=1,i=1;const[s,n]=((e,t)=>{const o=1280;let a=0,i=0,s=Math.abs(e.customOutputWidth||0),n=Math.abs(e.customOutputHeight||0),r=!0;for(const l of t){if(["placeholder","shape","text","audio"].includes(l.type))continue;if(r=!1,!(null==l?void 0:l.position))return[0,0];const t=null==l?void 0:l.position;if(!t)return[0,0];for(const e of["width","height"])t[e]||(t[e]=0);const o=(null==t?void 0:t.width)||"100%",s=(null==t?void 0:t.height)||"100%",n=Number(String(s).replace("%",""))/100,d=Number(String(o).replace("%",""))/100,c=l.height||0,u=l.width||0;a=Math.max(a,c/(n||1)),i=Math.max(i,u/(d||1));const{ratio:m}=e;m&&([i,a]=Oae(i,a,m))}if(0!==i&&0!==a||(a=e.height||o,i=e.width||o),e.hasCustomOutput&&s&&n)return s<n&&s<10?n=10*n/s:n<s&&n<10&&(s=10*s/n),[s,n];return r?i>a?[o,o*a/i]:[o*i/a,o]:[i,a]})(e,t);let r=s,l=n;0!==e.height&&0!==e.width||(e.width=r,e.height=l),e.height&&e.width&&(a=e.height/e.width,i=e.width/e.height);const d=((e,t)=>{const o=Rae(e),a=t?Aae["4K"]:Aae["720p"];return o>a?a:o})(e,o),c=(e=>e.hasCustomOutput?0:100)(e);let{exportResolution:u}=e;u=Nae(u);return["480p","720p","1080p","4K"].includes(u)?e.width>=e.height?(r=Aae[u],l=a*r):(l=Aae[u],r=i*l):e.width>=e.height?(r=Math.min(Math.max(r,c),d,Aae["1080p"]),l=a*r):(l=Math.min(Math.max(l,c),d,Aae["1080p"]),r=i*l),l=Dae(l),r=Dae(r),[r,l]},Fae=e=>{for(const t of e){if(!["image","video"].includes(t.type))continue;const{width:e=0,height:o=0}=t;if(e<2e3||o<2e3)return!0}return!1};function Mae(e,t){const o=t.position||QE(t),a=t.converted_type||t.type,i=t.objectFit||"";if("0%"!==o.width&&"0%"!==o.height){if(o.adjusted_x=(o.float_x||0)*e.adjusted_width/100,o.adjusted_y=(o.float_y||0)*e.adjusted_height/100,["placeholder","shape","text"].includes(a))return o.adjusted_height=o.pixel_height,void(o.adjusted_width=o.pixel_width);["contain","fit"].includes(i)?function(e){const t=e.position||QE(e),o=t.file_height||1,a=t.file_width||1,i=t.pixel_height||1,s=t.pixel_width||1,n=a/o;if(n<s/i){t.adjusted_height=i;const e=t.adjusted_height*n;t.adjusted_width=e,t.adjusted_x=(t.adjusted_x||0)+(s-e)/2}else{t.adjusted_width=s;const{adjusted_y:e}=t,n=t.adjusted_width*o/a;t.adjusted_height=n,t.adjusted_y=(e||0)+(i-n)/2}}(t):function(e){const t=e.position||QE(e);let o=t.file_height||1,a=t.file_width||1;e.crop&&(o=o*(e.crop.height||100)/100,a=a*(e.crop.width||100)/100);const i=t.pixel_height||1,s=t.pixel_width||1,n=a/o,r=n<s/i;t.adjusted_width=r?s:i*n,t.adjusted_height=r?s*o/a:i,t.crop_width=a*s/t.adjusted_width,t.crop_height=o*i/t.adjusted_height,t.crop_x=(a-t.crop_width)/2,t.crop_y=(o-t.crop_height)/2}(t)}}function Uae(e,t){const o=t.position||QE(t);for(const a of["width","height","x","y"]){const e=a;e in o&&(o[e]=o[e].toString().replace("NaN","0"))}o.float_width=parseFloat(o.width.toString().replace("%","")),o.float_height=parseFloat(o.height.toString().replace("%","")),o.float_x=parseFloat(o.x.toString().replace("%","")),o.float_y=parseFloat(o.y.toString().replace("%","")),o.pixel_width=o.float_width*e.adjusted_width*.01,o.pixel_height=o.float_height*e.adjusted_height*.01,Mae(e,t)}function Bae(e,t,o,a=!0){let i=t,s=e;if(!i||!s)return{outputWidth:s,outputHeight:i};const n=i/s;s<i?s=s/i*i:i=n*s;let r=o;["1:1","9:16","16:9","5:4","4:5"].includes(o)||(r=`${s}:${i}`);const l=function(e,t,o,a=!0){if("1:1"===o){const o=Math.max(e,t);return{outputWidth:o,outputHeight:o}}const[i=1,s=1]=o.split(":").map((e=>parseInt(e,10)));let n=t,r=e;return r/t>i/s?(r=Math.ceil(r/i)*i,n=r*s/i):r/t<i/s&&(n=Math.ceil(n/s)*s,r=n*i/s),r%2==0&&n%2==0||!a||(r+=i,n+=s),{outputWidth:r,outputHeight:n}}(s,i,r,a);return s=l.outputWidth,i=l.outputHeight,{outputWidth:s,outputHeight:i}}function Vae(e){return"standard"===e.quality?1280:e.hasCustomOutput&&0===e.duration&&Math.max(e.customOutputWidth,e.customOutputHeight)>1920?Math.max(e.customOutputWidth,e.customOutputHeight):1920}function Wae(e){return e.hasCustomOutput?0:100}async function Gae(e,t=!0,o){let a=[];if("scenes"in e)for(const d of e.scenes)a=a.concat(d.layers);else a=e.layers||[];for(const d of a){const e=d.converted_type||d.type;if(["placeholder","shape","text"].includes(e))continue;if(!d.position)continue;if(!d.base64_img)continue;if(void 0!==d.width&&void 0!==d.height){d.position.file_height=d.height,d.position.file_width=d.width;continue}const t=new Promise((e=>{const t=new Image;t.onload=()=>{d.position&&(d.position.file_height=t.height,d.position.file_width=t.width),e()},t.src=String(d.base64_img)}));await yH({actionDescription:"Extracting image dimensions",timeoutMs:5e3,promise:t})}const[i,s]=Lae(e,a,o);let n=1,r=1;e.height=e.height||0,e.width=e.width||0;const l=function(e,t=!0){let o=e.height||0,a=e.width||0,i=[];if("scenes"in e)for(const n of e.scenes)i=i.concat(n.layers);else i=e.layers||[];let s=!0;for(const n of i){const i=n.converted_type||n.type;if(["placeholder","shape","text"].includes(i))continue;s=!1;const r=n.position||{},l=parseFloat((r.height||"100%").toString().replace("%",""))/100,d=parseFloat((r.width||"100%").toString().replace("%",""))/100;o=Math.max(o,(r.file_height||0)/(l||1)),a=Math.max(a,(r.file_width||0)/(d||1));const{ratio:c}=e;if(c){const{outputWidth:e,outputHeight:i}=Bae(a,o,c,t);a=e,o=i}}if(0!==a&&0!==o||(o=e.height||0,a=e.width||0),e.hasCustomOutput)return{adjusted_width:e.customOutputWidth,adjusted_height:e.customOutputHeight};return s?a>o?{adjusted_width:1280,adjusted_height:1280*o/a}:{adjusted_width:1280*a/o,adjusted_height:1280}:{adjusted_width:a,adjusted_height:o}}(e,t);e.adjusted_width=l.adjusted_width,e.adjusted_height=l.adjusted_height,0!==e.height&&0!==e.width||(e.width=e.adjusted_width,e.height=e.adjusted_height),e.height&&e.width&&(n=e.height/e.width,r=e.width/e.height),e.width>=e.height?(e.adjusted_width=Math.min(Math.max(e.adjusted_width,Wae(e)),Vae(e)),e.adjusted_height=n*e.adjusted_width):(e.adjusted_height=Math.min(Math.max(e.adjusted_height,Wae(e)),Vae(e)),e.adjusted_width=r*e.adjusted_height),e.adjusted_width=Math.round(e.adjusted_width),e.adjusted_height=Math.round(e.adjusted_height),e.adjusted_width=i,e.adjusted_height=s;for(const d of e.scenes)d.adjusted_width=e.adjusted_width,d.adjusted_height=e.adjusted_height,d.width=e.width,d.height=e.height}function Hae(e){if(e.position){const{width:t,height:o,x:a,y:i}=e.position,s={x:UE(a),y:UE(i),width:UE(t),height:UE(o)};return 100===s.width&&100===s.height&&0===s.x&&0===s.y}return!1}async function $ae(e,t=!1){const o=await c(e,{mode:"no-cors"}),a=await o.blob();return o.ok?t?a:(i=a,new Promise(((e,t)=>{const o=new FileReader;o.readAsDataURL(i),o.onload=()=>{o.result?e(o.result):t(new Error("Reader result was empty"))},o.onerror=e=>t(e)}))):"FAIL";var i}const Kae=async(e,t)=>{var o,a;if(!uz(e,t))return e.base64_img="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",null;const i=k0(e,void 0,"original"),{type:s}=e;return i&&"image"===s?e.base64_img=await $ae(i):i&&"video"===s?e.base64_img=await zae(e,t):"text"===e.type&&e.fontFamily&&await MY({fontToLoad:e}),!e.mime&&(null==(a=null==(o=null==e?void 0:e.base64_img)?void 0:o.includes)?void 0:a.call(o,"image/svg+xml"))&&(e.mime="image/svg+xml"),null},zae=(e,t)=>{const{state:o}=sr(),a=o.studioLocal.layerTempValues[e.id]||{},{removeBgPreviewUrl:i}=a;if((e.removeBg||e.blurBg)&&i)return $ae(i);const s=document.createElement("video");return s.src=e.url??e.local_url??"",s.crossOrigin="anonymous",new Promise(((o,a)=>{let i=!1;s.onloadedmetadata=async()=>{try{s.pause(),s.volume=0,await yH({actionDescription:"drawFrameToCanvas setVideoTime",timeoutMs:5e3,promise:v1(e,s,t)})}catch(n){if(i)return;return i=!0,console.error("Video doesn't auto play"),void a(n)}setTimeout((()=>{if(i)return;i=!0;const t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width??s.videoWidth,t.height=e.height??s.videoHeight,t.width&&t.height?(n&&n.drawImage(s,0,0,t.width,t.height),s.pause(),o(t.toDataURL("image/jpeg"))):a(new Error("Canvas width or height is 0"))}),60)},s.onerror=e=>{i||(i=!0,console.error(`video ${s.src} failed to load`),a(e))}}))},Yae=e=>{e.sourceVideo&&e.sourceVideo.base64_img&&delete e.sourceVideo.base64_img;for(const t of e.scenes)for(const e of t.layers)e&&e.base64_img&&delete e.base64_img},Jae=async(e,t=Rv.None)=>{let o;try{const{state:a,dispatch:i}=sr(),{studio:n}=a,{imageType:r}=n,l=bE();o=s.cloneDeep(e),o.scenes&&o.scenes[0].layers&&(o.scenes[0].layers=o.scenes[0].layers.filter((e=>(e.isHidden&&delete o.allLayers.byId[e.id],!e.isHidden))));const d=RU(Bl.HIGH_QUALITY);t!==Rv.Thumbnail&&i(Eb(d?"high":"standard"));const c=ij(a);let u;if(n.canvasBlur){const e=Hz(a.studio.scenes[0].layers);if(e.length>0){let t=e[0];e.forEach((e=>{l>=e.startTime&&l<=e.endTime&&(t=e)})),(null==t?void 0:t.layer)&&(u=[{...null==t?void 0:t.layer}])}}const m={backgroundLayers:u,magicSubtitleExportInfo:c};if(m.magicSubtitleExportInfo){const{animations:e,magicSubtitlesOnExport:t}=m.magicSubtitleExportInfo;o.animations.allIds.push(...e.allIds),o.animations.byId={...o.animations.byId,...e.byId},o.scenes[0].layers.push(...Object.values(t).flat().filter((e=>e.startTime<=l&&e.endTime>l)))}m.backgroundLayers&&(o.scenes[0].layers=[...m.backgroundLayers,...o.scenes[0].layers]),o.animations&&wae(a,o),await(async e=>{const t=bE(),o=[];for(const a of e.scenes)for(const e of a.layers)o.push(Kae(e,t));return(await Promise.all(o)).some((e=>"FAIL"===e))?Promise.reject(new Error("A media layer failed to fetch!")):Promise.resolve()})(o),await Gae(o,!1,d),function(e){e&&e.scenes&&e.scenes[0].layers&&e.scenes[0].layers[0]&&!e.scenes[0].layers[0].position&&(e.scenes[0].layers[0].position={x:"0%",y:"0%",width:"100%",height:"100%",file_height:e.height,file_width:e.width})}(o),function(e){for(const t of e.scenes)for(const o of t.layers)Uae(e,o)}(o),o.watermark&&(o.watermark_img=await $ae("https://cdn-useast1.kapwing.com/static/watermark.png"));const{alignWatermark:p,scenes:h,videoType:g,watermark:f,watermark_img:y,animations:v}=o,_=h[0];let w=dY();"webp"!==r||qg()||(w="webp");const{adjusted_height:b,adjusted_width:T,background:x,duration:S,height:E,layers:I,maxFramerate:C,width:k}=_;(e=>{for(const t of e)t.isAudiogram&&("wave"===t.waveformStyle?t.fft_data=l2:t.fft_data=r2)})(I);const A={videoArgs:{adjusted_height:b,adjusted_width:T,alignWatermark:p,animations:v,frameExt:w,maxFramerate:C,sceneBackground:x,sceneDuration:S,sceneHeight:E,sceneWidth:k,videoType:g,watermark_img:y,watermark:f},frame:0,finalImageDataUrl:null,currentLayers:I,lastBatch:!0,div:"canvas-scratchpad",numThreads:6,eyedropperMode:!1,studioTime:l};if(t===Rv.EyedropperMode){A.eyedropperMode=!0;const e=await kae(A.videoArgs,A.frame,A.finalImageDataUrl,A.currentLayers,A.lastBatch,A.div,A.numThreads,A.eyedropperMode,A.studioTime);return Yae(o),e}let j;if(t===Rv.ImageExport){A.eyedropperMode=!0;const e=await kae(A.videoArgs,A.frame,A.finalImageDataUrl,A.currentLayers,A.lastBatch,A.div,A.numThreads,A.eyedropperMode,A.studioTime),t=`image/${A.videoArgs.frameExt||"png"}`;j=e.toDataURL(t,1)}else if(t===Rv.Thumbnail){A.eyedropperMode=!0;const e=await kae(A.videoArgs,A.frame,A.finalImageDataUrl,A.currentLayers,A.lastBatch,A.div,A.numThreads,A.eyedropperMode,A.studioTime),t=`image/${A.videoArgs.frameExt||"png"}`;j=e.toDataURL(t,1)}else j=await kae(A.videoArgs,A.frame,A.finalImageDataUrl,A.currentLayers,A.lastBatch,A.div,A.numThreads,A.eyedropperMode,A.studioTime);Yae(o);return[{id:P(),source:"local",name:t===Rv.Thumbnail?`video_image.${w}`:`${(o.projectName||"Untitled Export").substring(0,50)}.${w}`,local_url:j},j]}catch(a){console.error(a),Yae(o);const{message:e}=ph(a);throw"Attempt to draw background removed video when no preview is calculated"!==e&&console.error("An error occurred when processing the client side image.",a),a}};let qae=!1;function Xae(e,t,o){let a,i=!1;return e.isStopMotionVideo?a=function(e,t){const o=wc(e.currentUser)?e.currentUser.user._id:void 0;if(e.duration/e.stopMotionClipRate*e.stopMotionSpeed>60)throw new Error("Your final video cannot be longer than 1 min. Please trim the video or adjust the clip rate and speed.");const a=e.projectName||"Stop Motion Project";return e.projectName=a,{isStopMotionVideo:!0,stopMotionClipRate:e.stopMotionClipRate,stopMotionSpeed:e.stopMotionSpeed,reverseStopMotion:e.reverseStopMotion,...tK(e),watermark:t,startTime:e.startTime,endTime:e.endTime,withCustomWatermark:e.withCustomWatermark,watermarkPos:e.watermarkPos,watermarkText:e.watermarkText,watermarkFont:z6(e.watermarkFont),watermarkColor:e.watermarkColor,watermarkImg:e.watermarkImg,watermarkMedium:e.watermarkMedium,creatorId:o}}(e,o):e.isLooped?a=function(e,t){if((e.endTime-e.startTime)*e.numLoops>7200)throw new Error("The output video must be less than 2 hour long. Choose a fewer number of loops.");const o=wc(e.currentUser)?e.currentUser.user._id:void 0,a=e.projectName||"Looped Video Project";return e.projectName=a,{isLooped:!0,numLoops:e.numLoops,...tK(e),watermark:t,withCustomWatermark:e.withCustomWatermark,watermarkPos:e.watermarkPos,watermarkText:e.watermarkText,watermarkFont:z6(e.watermarkFont),watermarkColor:e.watermarkColor,watermarkImg:e.watermarkImg,watermarkMedium:e.watermarkMedium,startTime:e.startTime,endTime:e.endTime,creatorId:o}}(e,o):(a=nK(e,t),i=!0),[a,i]}function Qae(e){var t;if(!e.isStudio||qae)return;const{studio:{_id:o,scenes:a=[]},uploadStatuses:i={}}=e;try{let s,n,r,l,d,c,u=!1,m=!1,p=0,h=!1,g=Number.MAX_SAFE_INTEGER;for(const o of a)for(const a of o.layers){const o=BB(a);if(!o)continue;p+=1;const f=a.uploadId?i[a.uploadId]:null;if(f){const{progress:e=0,stage:t,stageStarted:i}=f;e<1&&(u=!0),e>=99&&(m=!0),t<g&&(g=t,s=o,n=a.mime,r=a.url?fB(a.url):null,l=performance.now()-i>1e4)}a.asset_id&&(d=null==(t=e.assets.byId[a.asset_id])?void 0:t.status,c=a.asset_id),a.addedFromMediaLibrary&&(h=!0)}const f={"Stuck at 0%":u,"Stuck at 99%":m,"Num Pending Uploads":p,"Added from Media Library":h,Stage:Sv[g]||"missing","Stuck at Stage":l,"Still Uploading Reason":s,Mimetype:n,Extension:r,"Asset Status":d,"Asset ID":c};o&&(f["Video ID"]=o,f["Link to Video"]=`kapwing.com/videos/${o}`),Fm(ym.EXPORT_BLOCKED_BY_REMAINING_UPLOAD,f),qae=!0}catch(IGe){console.error(IGe),R(IGe)}}async function Zae({currentUser:e,publish:t=!0,auto:o=!1,createLocation:a="NA",processedOnClient:i=!1}){const{dispatch:s,state:n}=sr(),{token:r,user:l}=e||{},{_id:d}=l||{},c=!wc(e),{selectedTeamId:u}=n.teams,{isBrandKitTemplate:m}=n.studio;if(!o&&HB(n)){const e=new Error("Your content is still uploading. Please try again in a few seconds.");return e.statusCode=425,Qae(n),Promise.reject(e)}const[p,h]=Xae(n,t,c);p.createLocation=a,p.workspaceId=(n.workspaces||{}).selectedWorkspace,p.teamId=u;const g=_c(u),y=$c((null==g?void 0:g.planTier)||Cl.Free);p.creatorHasLicense=y.isPaid,p.keyframing=n.studio.keyframing||{};const v=await QX(Object.values(n.studio.allLayers.byId));v.length>0&&(p.soundStripeCodes=v),function(e,t){let o;if(t.studio.canvasBlur){const e=Hz(t.studio.scenes[0].layers);e.length>0&&(o=e.map((e=>e.layer)).filter(Ir))}let a;e.animations&&(a=ij(t));const i={backgroundLayers:o,magicSubtitleExportInfo:a};i.backgroundLayers&&(e.backgroundLayers=i.backgroundLayers);if(i.magicSubtitleExportInfo){const{animations:t,magicSubtitlesOnExport:o}=i.magicSubtitleExportInfo;e.animations.allIds.push(...t.allIds),e.animations.byId={...e.animations.byId,...t.byId},e.magicSubtitlesOnExport=o}e.animations&&(wae(t,e),(e=>{try{if(!e.scenes||!e.animations)return;const t=[];let o=e.scenes.map((({layers:e})=>e)).flat().map((({id:e})=>e));const a=Object.values(e.magicSubtitlesOnExport||{}).map((e=>{var t;return null==(t=e[0])?void 0:t.id})).filter((e=>!!e));o=o.concat(a);for(const i of e.animations.allIds){const a=e.animations.byId[i];a&&(["layerId","introLayerId","outroLayerId"].some((e=>o.includes(a[e])))&&t.push(a.id))}e.animations.allIds=t,e.animations.byId=t.reduce(((t,o)=>(t[o]=e.animations.byId[o],t)),{})}catch(IGe){f("Unable to clean video animations",{extra:{video:e.id,__FORCE_SAMPLE:!0}})}})(e))}(p,n),p.isStudio&&"/studio/editor"!==p.editorPath&&f("Studio video but non studio editor!!"),t&&(function(e,t,o){try{fae({exportLocation:"studio",video:t,studioState:e.studio,processedOnClient:o})}catch(IGe){console.error("Failed to log createVideo")}}(n,p,i),(e=>{const t=e.assetTranscriptions.byId,o=e.assets.byId,a=e.studio.magicSubtitles||{},i=e.studio.magicSubtitleFramesByAsset||{};Object.entries(e.studio.transcriptionEditCounts).forEach((([e,s])=>{var n;const r=a[e],l=null==(n=i[e])?void 0:n.byId,d=o[e],c=t[e];if(!(d&&c&&r&&l))return;const{languageKey:u}=r;if(!u)return;const{languageCode:m,translateCode:p}=$A(u);if(!c[u])return;const h=Object.values(l).reduce(((e,t)=>t?e+t.words.length:e),0),g=d.duration&&s/(d.duration/60),f=s/h;Fm(ym.SUBTITLE_CHANGES_EXPORTED,{changeCount:s,changesPerWord:f,changesPerAssetMinute:g,translationLanguage:p,transcriptionLanguage:m})}))})(n),p._id&&async function(e){try{const{dispatch:t}=sr(),[o,a]=await Jae(e,Rv.Thumbnail);eq([hB(o,a)],{eventHandlers:{handleFinish:o=>{t(tie(o.url));const[a,i]=O$(o.url),s={image_url:o.url,thumbnail_blob_name:i};aie(e._id,s)}},uploadOptions:{analyticsUploadSource:"Thumbnail upload",omitFromIDB:!0,isThumbnail:!0,skipUploadStatusUpdates:!0,uploadSourceComponent:"Export"}})}catch(t){console.error(t)}}(p));const _=!p._id;if(!_&&!t&&h)return p;let w;w=_?"/api/v1/videos":t?"/api/v1/videos/publish":"/api/v1/videos/save";return async function(e,t,o,a){a&&(t(o?fD({...e,done:!1}):vD(!0)),function(e,t,o){t(eie(e._id)),t((a=e.projectId||"",{type:"SET_PROJECT_ID",projectId:a})),t({type:"SET_VIDEO_DRAFT_INFO",draft:!o&&e.draft,done:e.done,createdAt:e.createdAt,lastSaved:e.lastSaved});var a}(e,t,o));return e}(await Jr(w,{body:{publish:t,processedOnClient:i,token:r,userId:d,video:p,selectedTeamId:u,isBrandKitTemplate:m}}),s,t,h)}function eie(e){return{type:"SET_VIDEO_ID",_id:e}}function tie(e){return{type:"SET_IMAGE_URL",image_url:e}}async function oie(e){const{state:t}=sr(),{currentUser:o,isStudio:a,studio:i,editorPath:s}=t,{token:n}=o||{};if(!e){u({category:"Bad Trigger Lambda",message:`isStudio: ${a} videoId ${i._id} editorPath ${s}`});const e=new Error("triggerLambda run with no video!");R(e)}return function(e,t){return Jr("/api/v1/videos/triggerLambda",{body:{token:t,video:e}}).then((()=>e)).catch((e=>(console.error(e),e)))}(e,n)}async function aie(e,t){const{token:o}=sr().state.currentUser||{};return qr(`/api/v1/videos/${e}`,{params:{clientVersion:"0.9"},body:t,headers:{"x-access-token":o},parseJSON:!1})}const iie="GenericBlock-module_genericContainer_mgpDY",sie="GenericBlock-module_horizontalContainer_MSe08",nie="GenericBlock-module_content_XQG7Y",rie="GenericBlock-module_buttonWrapper_b15gp",lie="GenericBlock-module_img_2ESKP",die="GenericBlock-module_genericBlockContainer_nLr9u",cie="GenericBlock-module_hasImg_TJcRj",uie="GenericBlock-module_contentContainer_nGFHZ",mie="GenericBlock-module_heading_qzdFQ",pie="GenericBlock-module_withClose_A-83i",hie="GenericBlock-module_body_fTcX-",gie="GenericBlock-module_close_CWm3o",fie=_.memo((({body:e,heading:t,button:o,img:a,className:i="",headingClassName:s="",bodyClassName:n="",testId:r="",horizontal:l=!1,onDismiss:d})=>l?w.jsxs("div",{className:`${iie} ${sie} ${a?cie:""} ${i}`,"data-cy":r,children:[a&&w.jsx("img",{src:a.imgSrc,alt:a.imgAlt,className:`${lie} ${a.className}`}),w.jsxs("div",{className:nie,children:[t&&w.jsx("div",{className:`${mie} ${s}`,children:t}),e&&w.jsx("div",{className:`${hie} ${n}`,children:e})]}),w.jsx("div",{className:rie,children:o})]}):w.jsxs("div",{className:`${iie} ${die} ${a?cie:""} ${i}`,"data-cy":r,"data-testid":r,children:[w.jsxs("div",{className:uie,children:[a&&w.jsx("img",{src:a.imgSrc,alt:a.imgAlt,className:`${lie} ${a.className}`}),w.jsxs("div",{className:nie,children:[t&&w.jsxs("div",{className:`${mie} ${void 0!==d?pie:""} ${s}`,children:[t,d&&w.jsx("div",{className:gie,onClick:d,"data-cy":`${r} close`,"data-testid":`${r} close`,children:w.jsx(ve,{})})]}),e&&w.jsx("div",{className:`${hie} ${n}`,children:e})]})]}),o]}))),yie="UpsellBlock-module_upsellBlock_sCLzk",vie="UpsellBlock-module_horizontalWrapper_17PU7",_ie="UpsellBlock-module_button_QqETY",wie="UpsellBlock-module_wrapper_pX-Bc",bie="UpsellBlock-module_topLeftImg_g1fHG",Tie="GenericButton-module_disabled_AYYOH",xie="GenericButton-module_genericButton_OMRjJ",Sie="GenericButton-module_genericButtonIcon_IgArA",Eie="GenericButton-module_linkWrapper_7tPQ7",Iie=_.memo((({icon:e,buttonText:t="",className:o="",onClick:a=(()=>{}),testId:i,disabled:s=!1,href:n})=>n?w.jsx("a",{className:Eie,href:n,target:"_blank",rel:"noreferrer",children:w.jsxs("div",{className:`${xie} ${o}`,onClick:a,"data-testid":i,"data-cy":i,children:[t,w.jsx("div",{className:Sie,children:e})]})}):w.jsxs("div",{className:`${xie} ${o} ${s?Tie:""}`,onClick:a,"data-testid":i,"data-cy":i,children:[t,w.jsx("div",{className:Sie,children:e})]}))),Cie="UpsellButton-module_upsellButton_faS-2",kie="UpsellButton-module_darkUpsellButton_V2qDu",Aie="UpsellButton-module_lightSparkle_xstp-",jie=_.memo((({action:e,onPaywallSuccess:t=(()=>{}),hasIcon:o=!0,buttonText:a="Upgrade",className:i="",testId:s="upsell",team:n,darkStyle:r,immediateRedirectPathname:l})=>{const d=il(),c=bW(),u=Ve(),m=Ac(),p=tl((e=>nu(e))),g=h.useCallback((o=>{p?"Reactivate"===a?u.push(`/team/${m._id}/billing`):c(t,{action:e,teamId:(null==n?void 0:n._id)||m._id,immediateRedirectPathname:l})():d({type:"SHOW_SIGN_IN"}),o.stopPropagation()}),[e,a,m._id,d,u,t,c,null==n?void 0:n._id,p,l]),f=h.useMemo((()=>w.jsx(EW,{className:`${r?Aie:null}`})),[r]);return w.jsx(Iie,{className:`${Cie} ${i} ${r?kie:""}`,buttonText:a,icon:o?f:null,onClick:g,testId:`${s}-button`})})),Nie=_.memo((e=>{const t=Ac(),{img:o,upsellBlockHeading:a,upsellBlockBody:i,buttonText:s}=Hc(e.action),n=e.topLeftImg?bie:e.imgClassName,r=h.useMemo((()=>e.buttonText||s?w.jsx(jie,{className:_ie,onPaywallSuccess:e.onPaywallSuccess,action:e.action,buttonText:e.buttonText||s,team:t,testId:e.testId}):null),[s,t,e.action,e.buttonText,e.onPaywallSuccess,e.testId]),l=h.useMemo((()=>({...o,className:n,imgSrc:e.imgSrc||o.imgSrc})),[o,n,e.imgSrc]);return w.jsx("div",{className:wie,children:w.jsx(fie,{className:`${yie} ${e.horizontal?vie:""}`,img:e.noImg?null:l,heading:a,body:i,horizontal:e.horizontal,button:r,testId:e.testId})})}));var Rie=(e=>(e.REMOVE_WATERMARK="removeWatermark",e.EXPORT_VIDEO="export",e.OPEN_EXPORT_PANEL="exportPanel",e.COMMENT="comment",e))(Rie||{});const Pie={kapwingButton:"KapwingButton-module_kapwingButton_OIGXh",disabled:"KapwingButton-module_disabled_tv63Q",lightWeight:"KapwingButton-module_lightWeight_XSb2K",blueColor:"KapwingButton-module_blueColor_SAh6B",blackColor:"KapwingButton-module_blackColor_hR2Ff",noTranslate:"KapwingButton-module_noTranslate_tgQom",fullWidth:"KapwingButton-module_fullWidth_6EJfa",noPadding:"KapwingButton-module_noPadding_5M3iq",smallButton:"KapwingButton-module_smallButton_vgohY",largeButton:"KapwingButton-module_largeButton_I1pYU",cyanColor:"KapwingButton-module_cyanColor_V5h4O",lightBlueColor:"KapwingButton-module_lightBlueColor_WIEgE",mediumBlueColor:"KapwingButton-module_mediumBlueColor_iEVtF",grayColor:"KapwingButton-module_grayColor_RxMpU",redColor:"KapwingButton-module_redColor_VKTCX",studioColor:"KapwingButton-module_studioColor_kwAFJ",darkStudioColor:"KapwingButton-module_darkStudioColor_Py5Rb",inverseColor:"KapwingButton-module_inverseColor_QxahF",brownColor:"KapwingButton-module_brownColor_cpaI9",loading:"KapwingButton-module_loading_nSP6k",spin:"KapwingButton-module_spin_EnC9K",buttonsContainer:"KapwingButton-module_buttonsContainer_08lgq",header:"KapwingButton-module_header_S9MxU",progressContainer:"KapwingButton-module_progressContainer_avoR3",bottomRadius:"KapwingButton-module_bottomRadius_zAJO1",progressBar:"KapwingButton-module_progressBar_ZlG2h",buttonContents:"KapwingButton-module_buttonContents_PRG0-"},Die=_.memo((e=>{const t=[Pie.kapwingButton,e.lightWeight?Pie.lightWeight:"",e.noPadding?Pie.noPadding:e.small?Pie.smallButton:Pie.largeButton];return e.fullWidth&&t.push(Pie.fullWidth),e.disabled&&t.push(Pie.disabled),e.noTranslate&&t.push(Pie.noTranslate),t.push(e.overrideColor?Pie[`${e.overrideColor}Color`]:Pie.blueColor),e.progress&&!isNaN(e.progress)&&e.progress>0?w.jsx("div",{children:w.jsx("div",{className:`${Pie.progressContainer} ${e.bottomRadius?Pie.bottomRadius:""}`,children:w.jsxs("button",{type:"button",className:t.join(" "),onClick:e.onClick,"data-cy":e.testId,children:[w.jsx("div",{className:Pie.buttonContents,children:e.children}),w.jsx("div",{className:Pie.progressBar,style:{height:`${e.progress}%`}})]})})}):w.jsxs("button",{type:"button",disabled:e.disabled,onClick:e.onClick,className:t.join(" "),"data-cy":e.testId,children:[e.children,e.loading&&w.jsx("div",{className:Pie.loading})]})})),Oie="RemoveWatermark-module_upsellBlock_A-Myi",Lie="RemoveWatermark-module_override_NlJdb",Fie=async(e,t,o="First Trim")=>{let{name:a}=e;const i=[e.startTime||0,e.endTime||e.duration];a||(a="input.mp4");const s={},n=i[1]-i[0];if(n<=0)throw new Error("Bad duration, sending to backend");s.trimsDuration=n,s.buildType="fixed memory";try{s.status="Initializing";const r=new LD,l=Date.now();await r.initialize();const d=Date.now(),c=(e=>{let t=e.replaceAll(" ","");return"mp4"!==t.split(".").pop()&&(t=`${t.split(".")[0]}.mp4`),t})(a),u=`trimmed-${P()}-${c}`;let m={},p="";const h=window.navigator.hardwareConcurrency;if("First Trim"===o&&e.ffprobeData&&e.ffprobeData.avg_frame_rate===e.ffprobeData.r_frame_rate)s.trimType="Quick Trim",p=Mie(c,u,i,h);else if(e.ffprobeData&&e.ffprobeData.avg_frame_rate===e.ffprobeData.r_frame_rate||"First Trim"!==o){if(!("Slow Trim Mismatched Duration"===o&&n<=60))throw new Error("Quick trim failed and duration >1min, send to backend");s.trimType="Slow Trim after Quick Trim",p=Uie(c,u,i,h)}else s.trimType="Slow Trim Mismatched Framerate",p=Uie(c,u,i,h);if(s.command=p,m=await r.runCommandOnFile(p,t,c,u),!m)throw new Error("no output blob");s.status="Finished running command";const g=Date.now();if(s.status="Read output file",s.initTime=(d-l)/1e3,s.timeToRunCommand=(g-d)/1e3,s.newVideoDuration=await gH(m),s.durationsMatch=Math.abs(s.newVideoDuration-n)<=.5,!s.durationsMatch){if("First Trim"===o&&s.newVideoDuration<=60)return await Fie(e,t,"Slow Trim Mismatched Duration");throw new Error("Slow trim failed and duration > 60, send to backend")}return s.browser=(new D.UAParser).getBrowser(),s.device=(new D.UAParser).getDevice().type,s.hardwareConcurrency=navigator.hardwareConcurrency,s.origVideoDuration=n,s.origVideoHeight=e.height,s.origVideoWidth=e.width,s.origVideoSize=e.size,{outputBlob:m,ffmpegData:s}}catch(IGe){throw s.error=IGe,IGe}},Mie=(e,t,o,a)=>`-ss ${o[0]} -i ${e} -t ${o[1]-o[0]} -c copy -threads ${a/2} ${t}`,Uie=(e,t,o,a)=>`-ss ${o[0]} -i ${e} -t ${o[1]-o[0]} -threads ${a/2} ${t}`;async function Bie(e){let t,o,a;"undefined"!=typeof window&&(t=await yc((()=>import("./index-e18ac07b.js")),["assets/index-e18ac07b.js","assets/vendor-3b0a39e0.js"]));const i=Tu(e);if(t&&i&&(a=await t.getAsset(i)),"image"===(null==a?void 0:a.type)&&a.file_v2)o=a.file_v2;else if("audio"===(null==a?void 0:a.type)&&a.file)o=a.file;else if("video"===(null==a?void 0:a.type)&&(a.file_v2||a.file))o=a.file_v2.file||a.file;else{const t=k0(e,"url","original"),a=await fetch(t),i=await a.blob();o=new File([i],e.name||"",{type:e.mime??void 0})}o.id=P(),o.local_url=URL.createObjectURL(o);return{file:o,fileData:{id:e.id,local_url:o.local_url}}}const Vie="Static Image",Wie="No Changes Video",Gie="Trimmed Only Video";function Hie(e,t,o="videoState",a=!1,i){let{studio:s}=e;!s&&e.scenes&&(s=e);const{videoType:n}=s;if(n!==Kn.IMAGE)return!1;const r=Object.keys(s.magicSubtitles||{}).length>0;let l=!1;if(Qg())l=!1;else if(zz(s,t,a))l=!0;else if(pae(e,o)){if(r)return!1;const e=s.scenes[0].layers[0];if(!s.width||!s.height)return!1;const t=s.width/s.height;if("mp4"!==n&&"mp4_convert"!==n?l=!1:uae(e,t,s.ratio,{exportQuality:s.exportQuality,exportResolution:s.exportResolution})&&i&&!rK(s.duration)&&(l=!0),mae(e,t)&&$g()&&i&&Tc(i)){if(r)return!1;l=!0}}else l=!1;return l}const $ie=async(e,t,o,a=!1,i)=>{const{dispatch:s}=sr();let{studio:n}=t;!n&&t.scenes&&(n=t),await aie(n._id,{done:!1}),!n&&t.scenes&&(n=t);const r=function(e,t,o=!1,a="videoState"){let{studio:i}=e;!i&&e.scenes&&(i=e);let s="";if(zz(i,t,o))s=Vie;else if(pae(e,a)){const e=i.scenes[0].layers[0],t=i.width/i.height;uae(e,t,i.ratio,{exportQuality:i.exportQuality,exportResolution:i.exportResolution})&&(s=Wie),mae(e,t)&&(s=Gie)}return s}(t,o,a,i);let l,d,c,u=!0;switch(r){case Vie:try{n.watermark=rK(n.duration);const[e,t]=a?await Jae(n,Rv.ImageExport):await Jae(n),o=hB(e,t);l=o,d=URL.createObjectURL(l),s(bb(Kn.IMAGE))}catch(m){console.debug("Can't process image on client, send to server"),u=!1}break;case Wie:case Gie:try{const e=n.scenes[0].layers[0],t=await(async(e,t,o)=>{const{dispatch:a,history:i,state:s}=sr(),{currentUser:n}=s;let r=o,l={},d={};switch(e){case Wie:try{l=(await Bie(t)).file}catch(IGe){throw console.debug("Can't process no changes video on client, send to server"),r&&await aie(r,{progressText:"Client side video error, sending job to server..."}),IGe}break;case Gie:try{let e=3e3;if(!r){const t=await Zae({currentUser:n,publish:!1,auto:!1,createLocation:"trim-save"});r=t._id,e=100}const o={submittedAt:new Date};await aie(r,o),a(yD(o)),setTimeout((()=>{null==i||i.push(`/videos/${r}`)}),e);const s=await Bie(t),c=await Fie(t,s.file);c.outputBlob.id=P(),c.outputBlob.local_url=window.URL.createObjectURL(c.outputBlob),l=c.outputBlob,d=c.ffmpegData}catch(IGe){throw console.debug("Can't trim video on client, send to server"),r&&await aie(r,{clientSideProcessingInProgress:!1,progressText:"Client side trim error, sending job to server..."}),IGe}}return{files:l,ffmpegData:d}})(r,e,n._id);l=t.files,d=t.files.local_url,c=t.ffmpegData,s(bb(Kn.MP4))}catch(m){console.error(m),u=!1}break;default:u=!1}if(u&&l&&!window.Cypress){const t=wc(e)&&e.user.defaultPrivacy===Ln.private,o=P(),a=await Zz(l,{uploadId:o});return new Promise((e=>{const o=new wP({analyticsUploadSource:"Client Side Processing",file:l,isPrivate:t,onFinish:async(t,o,a)=>{const i=await((e,t,o,a)=>{const{dispatch:i,state:s}=sr(),{studio:n}=s,r=t||n._id,l={clientSideProcessingInProgress:!1,pendingProcessOnClient:!1};if(!e)return i(yD(l)),r&&aie(r,l),null;const d=e.match(/\.([0-9a-z]+)(?:[?#]|$)/i),c=d?d[1]:"";i({type:"SET_FULL_PATH",fullPath:e});const u={...n.build||{},outputExt:c,outputByteSize:a.size,success:!0},[m,p]=O$(e),h={fullPath:e,blob_name:p,progressText:"Processed on client",build:u,done:!0,draft:!1,...l};if(h.url=e,o===Vie&&(h.image_url=e,h.thumbnail_blob_name=p,i(tie(e))),i(yD(h)),r&&aie(r,h),n._id)return uK({...nK(s,!1),fullPath:e,blob_name:p,build:u},!0);return null})(o,n._id,r,a);return e({files:l,processed:u,newUrl:d,ffmpegData:c,read_uri:o,buildInfo:i.content.build})},origin:"client side processing",uploadSourceComponent:"client-side-processing",layer:a});o.upload()}))}return{files:l,processed:u,newUrl:d,ffmpegData:c}},Kie=_.memo((({video:e,afterExport:t=(()=>{})})=>{const o=be(),a=Ve(),i=ou(),n=NU(Bl.EXPORT_ALL_WITHOUT_WATERMARK),r=NU(Bl.EXPORT_30_SEC_WITHOUT_WATERMARK),l=tl((e=>e.currentUser)),[d,c]=h.useState(!1),u=h.useCallback((async()=>{if(!e._id)throw new Error("Video must have an id");c(!0);try{const o=e.duration||0;if(Hie(e,o,"videoBuild"))await $ie(l,e,o,!1,"videoBuild"),await aie(e._id,{done:!0,draft:!1,watermark:!1}),t();else{const t=await async function(e,t=""){const{dispatch:o,state:a}=sr(),{currentUser:i,workspaces:n}=a,{token:r,user:l}=i||{},{_id:d}=l||{},{selectedWorkspace:c}=n||{};if(s.isEmpty(e)){const e=new Error("No video found. Please try again later.");return Promise.reject(e)}const{_id:u,...m}=e;c&&Object.assign(m,{workspaceId:c}),Object.assign(m,{done:!1,finishedAt:void 0,fullPath:void 0,local_url:void 0,image_url:void 0,processedOnClient:void 0,blob_name:void 0,thumbnail_blob_name:void 0,lastSeen:new Date,paymentOption:t,progressText:"Loading ... Removing watermark ...",submittedAt:new Date,watermark:!1});const p=await Jr("/api/v1/videos",{body:{publish:!0,token:r,userId:d,video:m}});return o(fD(p)),p}(e);a.push(`/videos/${t._id}`)}}catch(o){mh({description:"Failed to remove watermark",error:o}),c(!1)}}),[e,a,t,l]);h.useEffect((()=>{const e=new URLSearchParams(o.search);wc(l)&&r&&"true"===e.get(Rie.REMOVE_WATERMARK)&&!d&&u()}),[l,o.search,u,d,r]);const m=h.useMemo((()=>w.jsx(Die,{onClick:u,overrideColor:"lightBlue",children:"Re-export without a watermark"})),[u]),p=h.useMemo((()=>({imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp",imgAlt:`Welcome to Kapwing ${i.name}, re-export to remove our watermark from your projects.`})),[i.name]),g=((null==e?void 0:e.duration)||0)<30;return e.watermark?n||g&&r?w.jsx(fie,{heading:"Re-export to remove the watermark",body:`Welcome to Kapwing ${i.name}, re-export to remove the watermark`,button:m,className:`${Oie} ${Lie}`,img:p,testId:"remove-watermark-upsell-block"}):w.jsx("div",{className:Oie,children:w.jsx(Nie,{action:g?Vl.REMOVE_30_SEC_WATERMARK:Vl.REMOVE_WATERMARK,onPaywallSuccess:u,testId:"remove-watermark-upsell-block"})}):null})),zie="SubscriptionStateBlock-module_errorBlock_0kzPV",Yie="SubscriptionStateBlock-module_errorBlockHeading_eP7ZK",Jie="SubscriptionStateBlock-module_errorButton_N32og",qie="SubscriptionStateBlock-module_reactivateBlock_79PEw",Xie="SubscriptionStateBlock-module_reactivateButton_z4jPw",Qie="SubscriptionStateBlock-module_pastDueBody_iPkzS",Zie=w.jsx(EW,{}),ese=w.jsxs("div",{className:Qie,children:["Your current payment is ",w.jsx("strong",{children:"incomplete."})," Please update your payment details to avoid losing access to PRO."]}),tse=_.memo((({className:e=""})=>{const t=Ve(),o=Ac(),{subscription:a}=pM(),i=ou(),s=h.useCallback((()=>{t.push(`/team/${o._id}/billing`)}),[o._id,t]),n=h.useMemo((()=>w.jsx(Iie,{className:Xie,buttonText:"Visit Billing to Reactivate",onClick:s,icon:Zie})),[s]),r=h.useMemo((()=>w.jsx(Iie,{className:Jie,buttonText:"Update payment details",onClick:s})),[s]);if(!a)return null;if(Xu(a))return(()=>{const t=a?l(1e3*a.current_period_end).format("ddd, MMMM Do, YYYY"):"";return w.jsx(fie,{className:`${qie} ${e}`,heading:`Your access to ${i.name} is ending`,body:`${t} is the last day you’ll have access to ${i.name} features including watermark-free projects ${i.hasPermission(Bl.HIGH_QUALITY)?" and HD video quality":""}. Reactivate to avoid losing access.`,button:n})})();const{isPastDue:d}=Ju(a);return d&&function(){var e;const{teams:t,currentUser:o}=sr().state,{user:a}=o,i=a._id,{selectedTeamId:s}=t,n=_c(s),r=null==(e=null==n?void 0:n.users)?void 0:e.find((e=>e.userId===i));if(!r)return!1;const{role:l}=r;return!!l&&l===kl.Admin}()?w.jsx(fie,{className:`${zie} ${e}`,heading:"Payment incomplete",headingClassName:Yie,body:ese,button:r}):null})),ose="ShareButton-module_tooltip_6GrU2",ase="ShareButton-module_shareButtonTooltip_duKu8",ise="ShareButton-module_shareButton_GeWEo",sse="ShareButton-module_shareButtonIcon_gcQXq",nse="ShareButton-module_shareButtonText_BsVtc",rse=g.connect((e=>({currentUser:e.currentUser,videoId:e.studio._id,creatorEmail:e.studio.creatorEmail,videoSaving:e.videoSaving,editorPath:e.editorPath,canWrite:e.userPermissions.canWrite}))),lse=_.memo(je(rse((e=>{const[t,o]=h.useState(!1),[a,i]=h.useState(!1),s=ke(),n=h.useCallback((()=>{o(!1)}),[]),r=h.useCallback((async t=>{const{currentUser:s,creatorEmail:n,videoSaving:r}=e,{user:l}=s||{};if(t&&t.stopPropagation(),!wc(e.currentUser))return void o(!0);if(a)return;if(e.videoId){const t=n??l.email;((e,t,o)=>{const a={"Project Owner Email":o,"Sharer Email":e.email,"Video ID":t};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Project Share Dialog Opened",a)})(l,e.videoId,t)}i(!0);const{videoId:d}=e;!d&&r?(await(async()=>new Promise(((e,t)=>{const o=setInterval((()=>{sr().state.studio._id&&(clearInterval(o),e())}),250)})))(),o(!1),eE("/studio/editor/share")):d?(o(!1),eE("/studio/editor/share")):await Zae({currentUser:s,publish:!1,auto:!1,createLocation:"studio-share"}).then((()=>{o(!1),eE("/studio/editor/share")})).catch((e=>(o(!1),mh({description:"Failed to share video",error:e}),null))),i(!1)}),[e,a]),l=h.useCallback((()=>{e.onSignin&&e.onSignin(),r()}),[e,r]),d=()=>{var t;const{canWrite:o}=e;o&&((null==(t=s.path)?void 0:t.endsWith("/share"))?eE(e.editorPath):r())};return w.jsxs(w.Fragment,{children:[(()=>{const{canWrite:t}=e;return t?w.jsxs("div",{className:`${ose} ${ise}`,onClick:d,"data-cy":"share-button","data-testid":"studio-header-share-button",children:[w.jsx(eo,{className:sse})," ",w.jsx("span",{className:nse,children:"Share"}),w.jsxs("span",{className:ase,children:["Share this project to invite ",w.jsx("br",{})," others to collaborate with you"]})]}):null})(),t&&w.jsx(bV,{hideSignIn:n,onSuccess:l,description:"Kapwing works better if you're signed in. Sign in to share your project with people and edit collaboratively in real time.",immediateRedirectPathname:"/studio/editor/share"})]})}))));class dse extends Error{constructor(e){super(e),this.name="CancelledError"}}const cse=new Set(["a","to","the","and","of","in","for","on","with","that","by","this","can","will","at","be","are","is","from","as","it","has","an","or","if","your","you","their","they","them","its"]),use=["dreamstime.com"],mse=[{author:{name:"eckskwisit",url:"https://open.spotify.com/artist/5c1yPkyqe6CGC7eZ9Fo0ZV?si=y7hi5iN4T9GG_dHav9uvbg"},metadata:{duration:320.500344},source:"https://cdn-useast1.kapwing.com/static/audio/Hustle%20Muscle%20-%20Unminus.com.mp3",tags:["trap","badass","bad","gangsta","gangster","hip-hop","hip_hop","trip","hustle","grimy","energy","rap","beat","drive","free_instrumental","strong","hard","cool","driveby"],title:"Hustle Muscle",type:"unminus"},{author:{name:"JNGS",url:"https://open.spotify.com/artist/6pvJuusRJQn0SM6BEWKczZ?si=2M-UdGseT5SnyKsEOZ_Zbg"},metadata:{duration:240.068525},source:"https://cdn-useast1.kapwing.com/static/audio/Midpoint.-%20Unminus.com.mp3",tags:["grimy","dark","trap","hip_hop","gangster","heavy","strong","bad","steel_drums","hip-hop","badass"],title:"Midpoint.",type:"unminus"},{author:{name:"Ezequiel Marotte",url:"https://soundcloud.com/ezequielmarotte"},metadata:{duration:560.461189},source:"https://cdn-useast1.kapwing.com/static/audio/Bad%20Behaviors%20www.wowa.me.mp3",tags:["heavy","electro","edm","free","hard","techno","bad","grimy"],title:"Bad Behaviors",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=MjhmYjhiOTBkN2FkMjM2OGUyNmI4Njc1ZGY5YWJhOTJhNDU1NjkxYixSc0h3MlU5aQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162248618982%2Fpiratos&m=0&ts=1625757493"},metadata:{duration:117.106938},source:"https://cdn-useast1.kapwing.com/static/audio/Piratos%20www.wowa.me.mp3",tags:["pirate","marsch","drama","pirates","caribean","trumpet","horn","attack","war","dark","movie","presentation","mockup","free","cc0","soundtrack","gema_frei","downloadable","power","grimy","heavy","energy"],title:"Piratos",type:"unminus"},{author:{name:"Kevin Shrout",url:"https://soundcloud.com/Kevin-Shrout"},metadata:{duration:148.666878},source:"https://cdn-useast1.kapwing.com/static/audio/The%20Intro%20we%20have%20been%20waiting%20for%20-%20Kevin%20Shrout%20Unminus.com.mp3",tags:["happy","energy","edm","background","electro","fresh","motion","effects","sunny","instrumental","chillout","cool"],title:"The Intro We Have Been Waiting For",type:"unminus"},{author:{name:"Wowa",url:"https://open.spotify.com/artist/6zZPxLiRfbGUnoEAJmfJJN?si=WDq_5dZoTmmsN95o_HinNQ"},metadata:{duration:297.929756},source:"https://cdn-useast1.kapwing.com/static/audio/Autumn%20Allure%20unminus.com.mp3",tags:["calm","chill","chilled","relax","autumn","classic","classical","no_vocals","no_drums","strings","cello","nature","peace","trees","water","birds","happy","travel","fly","harp","royal","orchestra"],title:"Autumn Allure",type:"unminus"},{author:{name:"starfrosch",url:"https://href.li/?https://starfrosch.com"},metadata:{duration:242.0277},source:"https://cdn-useast1.kapwing.com/static/audio/Deadfro5h%20-%20Unminus.com.mp3",tags:["frog","happy","energy","synthi","electronic","elctro","edm","dance","space","stars","pluck","chill","chilled","house","simple","no_vocals","background","fly","instrumental"],title:"deadfro5h",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3DWDq_5dZoTmmsN95o_HinNQ&t=NjI2NmY3ZGNiZDdhYzkxMThmY2E1MjY0MWE4Y2U3MDQ2NjQyMDQzYyxoR0FlVzROVg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F611334050473492480%2Fhangtime&m=0&ts=1625758050"},metadata:{duration:182.756689},source:"https://cdn-useast1.kapwing.com/static/audio/Hangtime%20-%20unminus.com.mp3",tags:["happy","energy","cool","jump","fly","bass","hip_hop","guitar","organ","free","snowboard","gopro","gangster","yeah","fresh","nice","skateboard","bmx","sport","trap","synthi","no_vocals","drums","action","motivation","cinematic","motivational","fun","street","power"],title:"Hangtime",type:"unminus"},{author:{name:"housefrau.me",url:"https://href.li/?https://housefrau.me/"},metadata:{duration:362.191781},source:"https://cdn-useast1.kapwing.com/static/audio/Berlin%20Dream%20-%20Unminus.com.mp3",tags:["happy","chilled","edm","berlin","dream","dreamy","synthi","no_vocals","ambient","electro","chillout","relax","lounge","instrumental"],title:"Berlin Dream",type:"unminus"},{author:{name:"JNGS",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6pvJuusRJQn0SM6BEWKczZ%3Fsi%3DbP7ZoMl-SV6NuHhr0lH6Yw&t=ZDU2ZDgzYTdmNmM3OWQwYmMyYjQzOGY2MzZmMzZhN2I2MWZhYThiMywySk9UY2JUNQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F178424744077%2Fpalmtrees&m=0&ts=1625758054"},metadata:{duration:180.272667},source:"https://cdn-useast1.kapwing.com/static/audio/Palmtrees%20www.wowa.me.mp3",tags:["palms","palmtree","freemusic","cc0","nocopyright","unsplash","jngs","instrumental","fresh","chill","happy","chilled"],title:"Palmtrees",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=ZWU3Zjc5YWExZjI3MGUyNmY0OTY1YjFjM2FiYzRkZmJjYWQ4ZjI1NSxXTUl2UnpyUg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F163446305972%2Feasy&m=0&ts=1625758054"},metadata:{duration:118.935542},source:"https://cdn-useast1.kapwing.com/static/audio/Easy%20wowa.me%20CC0%20Free%20Beautiful%20Music.mp3",tags:["easy","motivation","happy","mobile","iphone","production","garageband","fresh","fly","keys","synth","synthi","piano","beat","drums","copyright_free_music","chilled","sad"],title:"Easy",type:"unminus"},{author:{name:"Pipo & Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=ZWZlNTVjYjZkZWI2ZWRhZTFjMmRmYjFlNjliYjVjMjMwZjM2MDRmNSx1VTZtRG45Zw%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162526528202%2Fpipo-interludo&m=0&ts=1625758054"},metadata:{duration:82.07675},source:"https://cdn-useast1.kapwing.com/static/audio/Pipo%20Interludo%20www.wowa.me.mp3",tags:["guitar","happy","intro","strings","chill","pipo","cc0","cc","no_copyright","unsplash","free","chilled"],title:"Pipo Interludo",type:"unminus"},{author:{name:"Pipo & Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3DWDq_5dZoTmmsN95o_HinNQ&t=OTI1ZjI4ZWMxODhlMzJlZDU1NTYyMTUxYTYwZWQ3MTljYjhlNmE0NyxhTlZpUldHdA%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F157456168112%2Fthey-say&m=0&ts=1625758056"},metadata:{duration:156.581178},source:"https://cdn-useast1.kapwing.com/static/audio/They%20Say%20unminus.com.mp3",tags:["guitar","chill","peace","sad","melancholic","melody","ukulele","background","lounge","calm","slow","bpm_93","love","happy","song","songwriter","free","download","public_domain","cc0","creative_commons","high","quality","fresh","relax","fireplace","couple","baby","child","way"],title:"They Say",type:"unminus"},{author:{name:"Wowa & eckskwisit",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=YzA0NTgwZTg4ZWE0NDEzODIzYjdjZDEwN2RiZTFjMTJiNzNhMjA3MCx5Ym9QZGs0TQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F156714087877%2Fjust-cool&m=0&ts=1625758056"},metadata:{duration:188.05551},source:"https://cdn-useast1.kapwing.com/static/audio/Just%20Cool%20www.wowa.me.mp3",tags:["cool","free","wild","fresh","just","synthi","synth","hip_hop","hipster","rap","rnb","soul","bass","happy","funny","party","dance","west_coast","california","sunny","sun","warm","summer","holiday","energy"],title:"Just Cool",type:"unminus"},{author:{name:"Ryan Craig Martin",url:"https://www.linkedin.com/in/ryancraigmartin/"},metadata:{duration:386.328938},source:"https://cdn-useast1.kapwing.com/static/audio/Majesty%20Electro-House%20Music%20for%20Your%20Projects.mp3",tags:["electro","house","edm","dance","happy","energy","travel","ride","drive","motivation","jump","lucky","party","synthi","youtube","fast","run","speed"],title:"Majesty",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3D6c-Ta96IT169fNxVTXJzpw&t=MjM4ZDMwYzNjMzFlNTQyNGQ1ZjQ3NGJjZDZiNzk5YWYyZGY5MTk1MSxQOUJCbWNrQQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F178425430612%2Fruns&m=0&ts=1625758129"},metadata:{duration:155.381667},source:"https://cdn-useast1.kapwing.com/static/audio/Runs%20-%20Unminus.com.mp3",tags:["wowa","motivation","running","freemusic","publicdomain","gemafrei","instrumental","trap","run","energy","hip-hop"],title:"Runs",type:"unminus"},{author:{name:"JNGS",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6pvJuusRJQn0SM6BEWKczZ%3Fsi%3D2M-UdGseT5SnyKsEOZ_Zbg&t=ZjBkZDgyNWQ2NDJkMTMwOWIwNDIxZmYwYzlhZTY0YWNmOWNjYzcyZiwxMlloM05jNg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F181956501407%2Flit&m=0&ts=1625758129"},metadata:{duration:222.563275},source:"https://cdn-useast1.kapwing.com/static/audio/Lit%20www.wowa.me.mp3",tags:["lit","happy","energy","dance","latin","salsa","smile","nice","sun","party","beach","guitar","spanish"],title:"Lit",type:"unminus"},{author:{name:"JNGS",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6pvJuusRJQn0SM6BEWKczZ%3Fsi%3DbP7ZoMl-SV6NuHhr0lH6Yw&t=MjUyMGE1M2EwMDZkZDE4MWYxZjJhZTBiZWU5MjYwOTAwNTE2ZmQyYSx0ZUZvUnFTcQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F178424982477%2Fbowers-wilkins&m=0&ts=1625758129"},metadata:{duration:224.626956},source:"https://cdn-useast1.kapwing.com/static/audio/Bowers%20%26%20Wilkins%20www.wowa.me.mp3",tags:["freemusic","nocopyright","cc0","wowa","publicdomain","gemafrei","bowerswilkins","bowersandwilkins","instrumental","hip_hop","energy"],title:"Bowers & Wilkins",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=OWY3MmUxMTg2ODZhNjk0ZjY5ZmI5ZTJhMDRiMWMyNzFiM2NiYzZmNCw2U0Y1bXJvWg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F163444563422%2Ftrumpetz&m=0&ts=1625758131"},metadata:{duration:105.404082},source:"https://cdn-useast1.kapwing.com/static/audio/Trumpets%20in%20Your%20Ears%20wowa.me.mp3",tags:["trumpets","energy","loud","cc0","stock","no_copyright","motivation","stress","punchy","hard","action","fast","heavy"],title:"Trumpetz",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=NTA4Y2U2OTMyYmEzYmMwMzhmOTAzMzY4NzZmYjcxNWJjMDU4NzI3YSxwYkFBc3U2Ng%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162249374517%2Fvoisin&m=0&ts=1625758131"},metadata:{duration:69.12},source:"https://cdn-useast1.kapwing.com/static/audio/Voisin%20www.wowa.me.mp3",tags:["chill","calm","synthi","melody","free","chilled","energy"],title:"Voisin",type:"unminus"},{author:{name:"Neph da Menace / Hospitalized",url:"https://soundcloud.com/NephDaMenace"},metadata:{duration:260.466958},source:"https://cdn-useast1.kapwing.com/static/audio/Hospitalized%20-%20All%20Alone%20Dubstep%20138%20BPM%20wowa.me.mp3",tags:["dubstep","free","publicdomain","cc0","hard","gemafrei","freemusic","heavy","grimy"],title:"All Alone",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=NDAxYTE1Yjc4YzczMmFmOTllZGM2OGM1MjA5NzI1MzdiNWMyMGU0MCxpSG5XMkllOQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F163444962322%2Fbluesky&m=0&ts=1625758166"},metadata:{duration:55.118333},source:"https://cdn-useast1.kapwing.com/static/audio/Blue%20Sky%20www.wowa.me.mp3",tags:["blue","sky","heaven","fly","melancholic","melancho","synthi","strings","love","free_music","royalty_free","public_domain","stock_music","action","nocopyright","heavy","sad"],title:"Blue Sky",type:"unminus"},{author:{name:"Emescii",url:"https://soundcloud.com/emescii"},metadata:{duration:147.074756},source:"https://cdn-useast1.kapwing.com/static/audio/waveform%20-%20by%20Emescii%20Unminus.com.mp3",tags:["hip_hop","chillout","chilled","dark","city","hard","gangsta","gangster","lights","freaky","spooky","lofi","free_music","royalty_free_music","freedownload","moves","dance","synthi","trap","instrumental","cool","calm"],title:"waveform",type:"unminus"},{author:{name:"Pelayo",url:"https://soundcloud.com/pelayo"},metadata:{duration:162.016792},source:"https://cdn-useast1.kapwing.com/static/audio/Neuron%20Parking%20-%20Unminus.com%20MP3%20Full.mp3",tags:["cozy","sad","chill","chilled","neuron","melancholic","ice","winter","instrumental","chill_hop","drums","synthi","calm","chillout"],title:"Neuron Parking",type:"unminus"},{author:{name:"HaTom",url:"https://href.li/?https://www.youtube.com/channel/UC0JeACmSYU4Mt_Vozs4bFoQ"},metadata:{duration:248.533},source:"https://cdn-useast1.kapwing.com/static/audio/Naya%20-%20Unminus.com.mp3",tags:["tropical","world","chilled","motivation","calm","vocals","jungle","sun","smile","palm","beach","summer","chillout","relax"],title:"Naya",type:"unminus"},{author:{name:"JNGS",url:"https://open.spotify.com/artist/6pvJuusRJQn0SM6BEWKczZ?si=2M-UdGseT5SnyKsEOZ_Zbg"},metadata:{duration:267.079938},source:"https://cdn-useast1.kapwing.com/static/audio/Sad%20Circus%20unminus.com.mp3",tags:["sad","circus","trauriger_zirkus","chilled","calm","melancholic","complex","deep"],title:"Sad Circus",type:"unminus"},{author:{name:"Shock of Daylight",url:"https://href.li/?https://shockofdaylight.com/"},metadata:{duration:504.137143},source:"https://cdn-useast1.kapwing.com/static/audio/Kosu%20-%20Unminus.com.mp3",tags:["ambient","electro","melancholic","sad","chilled","strange","no_drums","depression","spooky"],title:"Kosu",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3DGvbyqdr_SgSnmFzVfJbvnw&t=OWJhNWU4ZDU2MDJiZmZmNTQzZDZmMzQ4Njc3NjAwYmU5Njg3MzUxZCxKcWlEWEdibw%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162489352477%2Fplease-wait&m=0&ts=1625758223"},metadata:{duration:287.425281},source:"https://cdn-useast1.kapwing.com/static/audio/Please%20Wait%20www.wowa.me.mp3",tags:["classic","drama","motivation","melancho","love","cc0","cc","instrumental","sad","strings","orchestra","movie","slow","chilled"],title:"Please Wait",type:"unminus"},{author:{url:"https://pixabay.com/music/beats-madirfan-both-of-us-14037",name:"Pixabay"},title:"madiRFAN - Both of Us",tags:["beats","beautiful plays","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/01/12/audio_45cacdef8f.mp3?filename=madirfan-both-of-us-14037.mp3",type:"Pixabay",metadata:{duration:168}},{author:{url:"https://pixabay.com/music/beats-milk-shake-116330/",name:"Pixabay"},title:"Milk Shake",tags:["electronic","beats"],source:"https://cdn.pixabay.com/download/audio/2022/08/03/audio_54ca0ffa52.mp3?filename=milk-shake-116330.mp3",type:"Pixabay",metadata:{duration:133}},{author:{url:"https://pixabay.com/music/beats-fun-life-112188/",name:"Pixabay"},title:"Fun Life",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/05/27/audio_ed655fa73a.mp3?filename=fun-life-112188.mp3",type:"Pixabay",metadata:{duration:109}},{author:{url:"https://pixabay.com/music/beats-guitar-electro-sport-trailer-115571",name:"Pixabay"},title:"Guitar Electro Sport Trailer",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/07/25/audio_3266b47d61.mp3?filename=guitar-electro-sport-trailer-115571.mp3",type:"Pixabay",metadata:{duration:118}},{author:{url:"https://pixabay.com/music/upbeat-clapping-music-for-typographic-video-version-2-112975",name:"Pixabay"},title:"Clapping Music For Typographic Video (Version 2)",tags:["upbeat","main title"],source:"https://cdn.pixabay.com/download/audio/2022/06/09/audio_9d22c770be.mp3?filename=clapping-music-for-typographic-video-version-2-112975.mp3",type:"Pixabay",metadata:{duration:29}},{author:{url:"https://pixabay.com/music/beautiful-plays-documentary-background-119940",name:"Pixabay"},title:"Documentary Background",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/14/audio_e5aba53171.mp3?filename=documentary-background-119940.mp3",type:"Pixabay",metadata:{duration:128}},{author:{url:"https://pixabay.com/music/beautiful-plays-price-of-freedom-33106",name:"Pixabay"},title:"Price of Freedom",tags:["beautiful plays","main title","modern classical","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/03/10/audio_b195486a22.mp3?filename=price-of-freedom-33106.mp3",type:"Pixabay",metadata:{duration:307}},{author:{url:"https://pixabay.com/music/beats-lofi-study-112191/",name:"Pixabay"},title:"Lofi Study",tags:["electronic","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112191.mp3",type:"Pixabay",metadata:{duration:147}},{author:{url:"https://pixabay.com/music/beats-sexy-fashion-beats-simulate-11176",name:"Pixabay"},title:"Sexy Fashion Beats (Simulate)",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2021/11/24/audio_c3dfe250e3.mp3?filename=sexy-fashion-beats-simulate-11176.mp3",type:"Pixabay",metadata:{duration:91}},{author:{url:"https://pixabay.com/music/beats-tuesday-glitch-soft-hip-hop-118327/",name:"Pixabay"},title:"Tuesday (Glitch Soft Hip-hop)",tags:["electronic","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/25/audio_4f3b0a816e.mp3?filename=tuesday-glitch-soft-hip-hop-118327.mp3",type:"Pixabay",metadata:{duration:127}},{author:{url:"https://pixabay.com/music/meditationspiritual-peaceful-garden-healing-light-piano-for-meditation-zen-landscapes-112199",name:"Pixabay"},title:"Peaceful Garden - Healing Light Piano for meditation, z",tags:["beautiful plays","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/05/28/audio_b79a40aa49.mp3?filename=peaceful-garden-healing-light-piano-for-meditation-zen-landscapes-112199.mp3",type:"Pixabay",metadata:{duration:179}},{author:{url:"https://pixabay.com/music/beats-best-time-112194/",name:"Pixabay"},title:"Best Time",tags:["electronic","upbeat","beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/27/audio_5b08ce8e20.mp3?filename=best-time-112194.mp3",type:"Pixabay",metadata:{duration:128}},{author:{url:"https://pixabay.com/music/upbeat-catch-it-117676",name:"Pixabay"},title:"Catch It",tags:["upbeat","main title","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/20/audio_55aa207a92.mp3?filename=catch-it-117676.mp3",type:"Pixabay",metadata:{duration:88}},{author:{url:"https://pixabay.com/music/beats-the-podcast-intro-111863/",name:"Pixabay"},title:"The Podcast Intro",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/23/audio_e341a2c57a.mp3?filename=the-podcast-intro-111863.mp3",type:"Pixabay",metadata:{duration:111}},{author:{url:"https://pixabay.com/music/beats-stylish-rock-beat-trailer-116346/",name:"Pixabay"},title:"Stylish Rock Beat Trailer",tags:["electronic","beats","main title","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/03/audio_626ecbb571.mp3?filename=stylish-rock-beat-trailer-116346.mp3",type:"Pixabay",metadata:{duration:90}},{author:{url:"https://pixabay.com/music/beautiful-plays-ambient-piano-ampamp-strings-10711",name:"Pixabay"},title:"Ambient Piano & Strings",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2021/11/13/audio_cb4f1212a9.mp3?filename=ambient-piano-ampamp-strings-10711.mp3",type:"Pixabay",metadata:{duration:217}},{author:{url:"https://pixabay.com/music/build-up-scenes-ethno-landscape-119949",name:"Pixabay"},title:"Ethno Landscape",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/14/audio_16e26e568b.mp3?filename=ethno-landscape-119949.mp3",type:"Pixabay",metadata:{duration:140}},{author:{url:"https://pixabay.com/music/ambient-mindfulness-relaxation-amp-meditation-music-22174",name:"Pixabay"},title:"Mindfulness Relaxation & Meditation Music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/03/07/audio_48408439d8.mp3?filename=mindfulness-relaxation-amp-meditation-music-22174.mp3",type:"Pixabay",metadata:{duration:240}},{author:{url:"https://pixabay.com/music/rock-stomping-rock-four-shots-111444",name:"Pixabay"},title:"Stomping Rock (Four Shots)",tags:["vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/05/17/audio_407815a564.mp3?filename=stomping-rock-four-shots-111444.mp3",type:"Pixabay",metadata:{duration:119}},{author:{url:"https://pixabay.com/music/meditationspiritual-endless-by-prabajithk-118998",name:"Pixabay"},title:"Endless by PrabajithK",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/03/audio_7e44a45464.mp3?filename=endless-by-prabajithk-118998.mp3",type:"Pixabay",metadata:{duration:640}},{author:{url:"https://pixabay.com/music/ambient-valley-of-hope-ambient-meditation-study-sleep-music-115453",name:"Pixabay"},title:"Valley of Hope ambient meditation study sleep music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/07/22/audio_58b0125cb0.mp3?filename=valley-of-hope-ambient-meditation-study-sleep-music-115453.mp3",type:"Pixabay",metadata:{duration:1330}},{author:{url:"https://pixabay.com/music/future-bass-electronic-future-beats-117997/",name:"Pixabay"},title:"Electronic Future Beats",tags:["electronic","beats","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_d16737dc28.mp3?filename=electronic-future-beats-117997.mp3",type:"Pixabay",metadata:{duration:126}},{author:{url:"https://pixabay.com/music/main-title-cinematic-fairy-tale-story-main-8697",name:"Pixabay"},title:"Cinematic Fairy Tale Story (Main)",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2021/09/25/audio_153f263349.mp3?filename=cinematic-fairy-tale-story-main-8697.mp3",type:"Pixabay",metadata:{duration:127}},{author:{url:"https://pixabay.com/music/beautiful-plays-inspiring-uplifting-cinematic-piano-119523",name:"Pixabay"},title:"Inspiring Uplifting Cinematic Piano",tags:["main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/09/audio_8b49bbfbc3.mp3?filename=inspiring-uplifting-cinematic-piano-119523.mp3",type:"Pixabay",metadata:{duration:164}},{author:{url:"https://pixabay.com/music/beats-into-the-night-20928",name:"Pixabay"},title:"Into The Night",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/02/15/audio_1e79dbf2b9.mp3?filename=into-the-night-20928.mp3",type:"Pixabay",metadata:{duration:140}},{author:{url:"https://pixabay.com/music/modern-classical-the-introvert-michael-kobrin-10959",name:"Pixabay"},title:"The Introvert - Michael Kobrin",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2021/11/20/audio_447ff1bec8.mp3?filename=the-introvert-michael-kobrin-10959.mp3",type:"Pixabay",metadata:{duration:139}},{author:{url:"https://pixabay.com/music/acoustic-group-morning-garden-acoustic-chill-15013",name:"Pixabay"},title:"Morning Garden - Acoustic Chill",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/01/18/audio_ea75bab6d8.mp3?filename=morning-garden-acoustic-chill-15013.mp3",type:"Pixabay",metadata:{duration:233}},{author:{url:"https://pixabay.com/music/solo-guitar-the-cradle-of-your-soul-15700",name:"Pixabay"},title:"The Cradle of Your Soul",tags:["beautiful plays"],source:"https://cdn.pixabay.com/download/audio/2022/01/26/audio_d0c6ff1bdd.mp3?filename=the-cradle-of-your-soul-15700.mp3",type:"Pixabay",metadata:{duration:177}},{author:{url:"https://pixabay.com/music/soft-house-happy-summer-116584",name:"Pixabay"},title:"Happy Summer",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2022/08/07/audio_232269676a.mp3?filename=happy-summer-116584.mp3",type:"Pixabay",metadata:{duration:157}},{author:{url:"https://pixabay.com/music/build-up-scenes-stomp-117637",name:"Pixabay"},title:"Stomp",tags:["upbeat","main title","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/19/audio_e4bc494bba.mp3?filename=stomp-117637.mp3",type:"Pixabay",metadata:{duration:98}},{author:{url:"https://pixabay.com/music/acoustic-group-forest-lullaby-110624",name:"Pixabay"},title:"Forest Lullaby",tags:["beautiful plays","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/05/audio_1395e7800f.mp3?filename=forest-lullaby-110624.mp3",type:"Pixabay",metadata:{duration:138}},{author:{url:"https://pixabay.com/music/beautiful-plays-spirit-landscape-118015",name:"Pixabay"},title:"Spirit Landscape",tags:["beautiful plays","main title","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_23da5d387d.mp3?filename=spirit-landscape-118015.mp3",type:"Pixabay",metadata:{duration:154}},{author:{url:"https://pixabay.com/music/beats-spirit-blossom-15285",name:"Pixabay"},title:"Spirit Blossom",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/01/21/audio_31743c58bd.mp3?filename=spirit-blossom-15285.mp3",type:"Pixabay",metadata:{duration:108}},{author:{url:"https://pixabay.com/music/upbeat-chilled-ambient-minimal-119323",name:"Pixabay"},title:"Chilled Ambient Minimal",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/07/audio_dffc4fa57e.mp3?filename=chilled-ambient-minimal-119323.mp3",type:"Pixabay",metadata:{duration:144}},{author:{url:"https://pixabay.com/music/main-title-epicaly-113907",name:"Pixabay"},title:"Epicaly",tags:["beautiful plays","main title"],source:"https://cdn.pixabay.com/download/audio/2022/06/25/audio_944aab53cf.mp3?filename=epicaly-113907.mp3",type:"Pixabay",metadata:{duration:123}},{author:{url:"https://pixabay.com/music/ambient-relaxing-music-119247",name:"Pixabay"},title:"Relaxing Music",tags:["beautiful plays","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/06/audio_eacbcf15ac.mp3?filename=relaxing-music-119247.mp3",type:"Pixabay",metadata:{duration:1324}},{author:{url:"https://pixabay.com/music/upbeat-the-weekend-117427/",name:"Pixabay"},title:"The Weekend",tags:["electronic","upbeat","beautiful plays","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/17/audio_eb3864cceb.mp3?filename=the-weekend-117427.mp3",type:"Pixabay",metadata:{duration:145}},{author:{url:"https://pixabay.com/music/beautiful-plays-smooth-waters-115977",name:"Pixabay"},title:"Smooth Waters",tags:["beautiful plays","main title","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/07/30/audio_0fea22d728.mp3?filename=smooth-waters-115977.mp3",type:"Pixabay",metadata:{duration:299}},{author:{url:"https://pixabay.com/music/beats-soft-beat-115017",name:"Pixabay"},title:"Soft Beat",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/07/15/audio_bec711a8d2.mp3?filename=soft-beat-115017.mp3",type:"Pixabay",metadata:{duration:69}},{author:{url:"https://pixabay.com/music/meditationspiritual-soothing-music-120090",name:"Pixabay"},title:"Soothing Music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/16/audio_f84220790a.mp3?filename=soothing-music-120090.mp3",type:"Pixabay",metadata:{duration:1393}},{author:{url:"https://pixabay.com/music/modern-classical-rhythmic-strings-overly-attached-intro-119894",name:"Pixabay"},title:"Rhythmic Strings - Overly attached - Intro",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/14/audio_5a200a36c2.mp3?filename=rhythmic-strings-overly-attached-intro-119894.mp3",type:"Pixabay",metadata:{duration:60}},{author:{url:"https://pixabay.com/music/beats-jazzy-abstract-beat-11254",name:"Pixabay"},title:"Jazzy Abstract Beat",tags:["beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2021/11/25/audio_91b32e02f9.mp3?filename=jazzy-abstract-beat-11254.mp3",type:"Pixabay",metadata:{duration:85}},{author:{url:"https://pixabay.com/music/upbeat-chill-abstract-intention-12099",name:"Pixabay"},title:"Chill Abstract (Intention)",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2021/12/13/audio_b9c0dc9e48.mp3?filename=chill-abstract-intention-12099.mp3",type:"Pixabay",metadata:{duration:88}},{author:{url:"https://pixabay.com/music/main-title-winning-elevation-111355",name:"Pixabay"},title:"Winning Elevation",tags:["beautiful plays","main title"],source:"https://cdn.pixabay.com/download/audio/2022/05/16/audio_db6591201e.mp3?filename=winning-elevation-111355.mp3",type:"Pixabay",metadata:{duration:121}},{author:{url:"https://pixabay.com/music/beautiful-plays-cinematic-documentary-115669/",name:"Pixabay"},title:"Cinematic Documentary",tags:["electronic","beautiful plays","main title","ambient","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/07/26/audio_ed0c111294.mp3?filename=cinematic-documentary-115669.mp3",type:"Pixabay",metadata:{duration:131}},{author:{url:"https://pixabay.com/music/adventure-this-is-epic-115231",name:"Pixabay"},title:"This Is Epic",tags:["beautiful plays","main title"],source:"https://cdn.pixabay.com/download/audio/2022/07/18/audio_604ae0002a.mp3?filename=this-is-epic-115231.mp3",type:"Pixabay",metadata:{duration:139}},{author:{url:"https://pixabay.com/music/beautiful-plays-out-of-time-15474",name:"Pixabay"},title:"Out of Time",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/01/23/audio_64fe965d5a.mp3?filename=out-of-time-15474.mp3",type:"Pixabay",metadata:{duration:306}},{author:{url:"https://pixabay.com/music/build-up-scenes-inspiring-cinematic-piano-116957",name:"Pixabay"},title:"Inspiring Cinematic Piano",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/10/audio_158527cbab.mp3?filename=inspiring-cinematic-piano-116957.mp3",type:"Pixabay",metadata:{duration:141}},{author:{url:"https://pixabay.com/music/acoustic-group-sedative-110241",name:"Pixabay"},title:"Sedative",tags:["beautiful plays"],source:"https://cdn.pixabay.com/download/audio/2022/04/27/audio_30ff2fdf22.mp3?filename=sedative-110241.mp3",type:"Pixabay",metadata:{duration:181}},{author:{url:"https://pixabay.com/music/beats-goldn-116392/",name:"Pixabay"},title:"Goldn",tags:["electronic","beats","alternative hip-hop","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/08/04/audio_2dde668d05.mp3?filename=goldn-116392.mp3",type:"Pixabay",metadata:{duration:159}},{author:{url:"https://pixabay.com/music/main-title-inspiring-cinematic-asia-116200",name:"Pixabay"},title:"Inspiring Cinematic Asia",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/02/audio_2d7a52e350.mp3?filename=inspiring-cinematic-asia-116200.mp3",type:"Pixabay",metadata:{duration:169}},{author:{url:"https://pixabay.com/music/soft-house-vocal-deep-house-your-love-to-borrow-emotional-summer-deep-house-119571",name:"Pixabay"},title:"Vocal Deep House - Your Love To Borrow (Emotional Summer Deep Ho",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2022/09/10/audio_03d2eaa5e7.mp3?filename=vocal-deep-house-your-love-to-borrow-emotional-summer-deep-house-119571.mp3",type:"Pixabay",metadata:{duration:224}},{author:{url:"https://pixabay.com/music/corporate-relaxing-light-background-116686",name:"Pixabay"},title:"Relaxing Light Background",tags:["upbeat","beautiful plays"],source:"https://cdn.pixabay.com/download/audio/2022/08/08/audio_0627597b4f.mp3?filename=relaxing-light-background-116686.mp3",type:"Pixabay",metadata:{duration:151}},{author:{url:"https://pixabay.com/music/corporate-happy-day-113985/",name:"Pixabay"},title:"Happy Day",tags:["electronic","upbeat","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/06/27/audio_d1eeb72cda.mp3?filename=happy-day-113985.mp3",type:"Pixabay",metadata:{duration:170}},{author:{url:"https://pixabay.com/music/adventure-asia-travel-118018",name:"Pixabay"},title:"Asia Travel",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_f811efdcf5.mp3?filename=asia-travel-118018.mp3",type:"Pixabay",metadata:{duration:155}},{author:{url:"https://pixabay.com/music/meditationspiritual-calming-music-119753",name:"Pixabay"},title:"Calming Music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/13/audio_3aa2a5f847.mp3?filename=calming-music-119753.mp3",type:"Pixabay",metadata:{duration:1356}},{author:{url:"https://pixabay.com/music/beats-madirfan-circles-2020-circles-119751",name:"Pixabay"},title:"madiRFAN - Circles - 2020 - Circles",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/09/13/audio_e13fd42abf.mp3?filename=madirfan-circles-2020-circles-119751.mp3",type:"Pixabay",metadata:{duration:163}},{author:{url:"https://pixabay.com/music/beautiful-plays-cinematic-ambient-piano-118668",name:"Pixabay"},title:"Cinematic Ambient Piano",tags:["beautiful plays","main title","modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/30/audio_cfe7e03a4e.mp3?filename=cinematic-ambient-piano-118668.mp3",type:"Pixabay",metadata:{duration:106}},{author:{url:"https://pixabay.com/music/rock-powerful-stylish-stomp-rock-lets-go-114255",name:"Pixabay"},title:"Powerful Stylish Stomp Rock (Lets Go)",tags:["upbeat","main title","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/07/03/audio_8938382846.mp3?filename=powerful-stylish-stomp-rock-lets-go-114255.mp3",type:"Pixabay",metadata:{duration:136}},{author:{url:"https://pixabay.com/music/corporate-motivational-day-112790/",name:"Pixabay"},title:"Motivational Day",tags:["electronic","upbeat","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/06/06/audio_6e6377ef2d.mp3?filename=motivational-day-112790.mp3",type:"Pixabay",metadata:{duration:152}},{author:{url:"https://pixabay.com/music/future-bass-leonell-cassio-chapter-two-ft-carrie-114909/",name:"Pixabay"},title:"Leonell Cassio - Chapter Two (ft. Carrie)",tags:["electronic","beats","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/07/14/audio_b2e1adaa25.mp3?filename=leonell-cassio-chapter-two-ft-carrie-114909.mp3",type:"Pixabay",metadata:{duration:240}},{author:{url:"https://pixabay.com/music/modern-classical-touch-and-sound-113676",name:"Pixabay"},title:"Touch and Sound",tags:["modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/06/21/audio_cf29d2c16c.mp3?filename=touch-and-sound-113676.mp3",type:"Pixabay",metadata:{duration:261}},{author:{url:"https://pixabay.com/music/future-bass-order-99518/",name:"Pixabay"},title:"Order",tags:["electronic","beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/03/23/audio_07b2a04be3.mp3?filename=order-99518.mp3",type:"Pixabay",metadata:{duration:104}},{author:{url:"https://pixabay.com/music/beautiful-plays-inspiring-cinematic-ambient-116199",name:"Pixabay"},title:"Inspiring Cinematic Ambient",tags:["beautiful plays","modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/02/audio_884fe92c21.mp3?filename=inspiring-cinematic-ambient-116199.mp3",type:"Pixabay",metadata:{duration:189}},{author:{url:"https://pixabay.com/music/modern-classical-inspiring-emotional-uplifting-piano-112623",name:"Pixabay"},title:"Inspiring Emotional Uplifting Piano",tags:["beautiful plays","main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/06/03/audio_c3d218496a.mp3?filename=inspiring-emotional-uplifting-piano-112623.mp3",type:"Pixabay",metadata:{duration:158}},{author:{url:"https://pixabay.com/music/upbeat-own-117683",name:"Pixabay"},title:"Own",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2022/08/20/audio_53e3aedf91.mp3?filename=own-117683.mp3",type:"Pixabay",metadata:{duration:126}},{author:{url:"https://pixabay.com/music/beats-trailer-sport-stylish-16073",name:"Pixabay"},title:"Trailer Sport Stylish",tags:["beats","alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/01/31/audio_0f2416122a.mp3?filename=trailer-sport-stylish-16073.mp3",type:"Pixabay",metadata:{duration:181}},{author:{url:"https://pixabay.com/music/solo-piano-piano-moment-9835",name:"Pixabay"},title:"Piano Moment",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2021/10/25/audio_05570f2464.mp3?filename=piano-moment-9835.mp3",type:"Pixabay",metadata:{duration:273}},{author:{url:"https://pixabay.com/music/beats-hip-hop-rock-beats-118000/",name:"Pixabay"},title:"Hip Hop Rock Beats",tags:["electronic","upbeat","beats","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_8d07c2f3af.mp3?filename=hip-hop-rock-beats-118000.mp3",type:"Pixabay",metadata:{duration:79}},{author:{url:"https://pixabay.com/music/main-title-cinematic-time-lapse-115672",name:"Pixabay"},title:"Cinematic Time Lapse",tags:["beautiful plays","main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/07/26/audio_112f2d606c.mp3?filename=cinematic-time-lapse-115672.mp3",type:"Pixabay",metadata:{duration:121}},{author:{url:"https://pixabay.com/music/beautiful-plays-inspirational-sentimental-romantic-116955",name:"Pixabay"},title:"Inspirational Sentimental Romantic",tags:["beautiful plays","main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/10/audio_2014b63921.mp3?filename=inspirational-sentimental-romantic-116955.mp3",type:"Pixabay",metadata:{duration:188}},{author:{url:"https://pixabay.com/music/upbeat-bounce-114024/",name:"Pixabay"},title:"Bounce",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/06/28/audio_ffe4e508f3.mp3?filename=bounce-114024.mp3",type:"Pixabay",metadata:{duration:95}},{author:{url:"https://pixabay.com/music/future-bass-leonell-cassio-the-blackest-bouquet-118766/",name:"Pixabay"},title:"Leonell Cassio - The Blackest Bouquet",tags:["electronic","beats","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/08/31/audio_419263fc12.mp3?filename=leonell-cassio-the-blackest-bouquet-118766.mp3",type:"Pixabay",metadata:{duration:221}},{author:{url:"https://pixabay.com/music/beats-toxic-love-117607",name:"Pixabay"},title:"Toxic Love",tags:["beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/19/audio_783a242e3a.mp3?filename=toxic-love-117607.mp3",type:"Pixabay",metadata:{duration:165}},{author:{url:"https://pixabay.com/music/beats-fashion-upbeat-electronica-117535",name:"Pixabay"},title:"Fashion Upbeat Electronica",tags:["upbeat","alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/08/18/audio_5ba7ef59dc.mp3?filename=fashion-upbeat-electronica-117535.mp3",type:"Pixabay",metadata:{duration:66}},{author:{url:"https://pixabay.com/music/beautiful-plays-field-grass-115973",name:"Pixabay"},title:"Field Grass",tags:["main title","modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/07/30/audio_14f618bbd4.mp3?filename=field-grass-115973.mp3",type:"Pixabay",metadata:{duration:264}},{author:{url:"https://pixabay.com/music/main-title-epic-dramatic-action-trailer-99525",name:"Pixabay"},title:"Epic Dramatic Action Trailer",tags:["upbeat","main title"],source:"https://cdn.pixabay.com/download/audio/2022/03/23/audio_860cea5baa.mp3?filename=epic-dramatic-action-trailer-99525.mp3",type:"Pixabay",metadata:{duration:121}},{author:{url:"https://pixabay.com/music/modern-classical-uplifting-piano-is-112841",name:"Pixabay"},title:"Uplifting Piano Is",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/06/07/audio_7998efb548.mp3?filename=uplifting-piano-is-112841.mp3",type:"Pixabay",metadata:{duration:70}},{author:{url:"https://pixabay.com/music/build-up-scenes-epic-cinematic-trailer-113981",name:"Pixabay"},title:"Epic Cinematic Trailer",tags:["main title"],source:"https://cdn.pixabay.com/download/audio/2022/06/27/audio_896b171c42.mp3?filename=epic-cinematic-trailer-113981.mp3",type:"Pixabay",metadata:{duration:147}},{author:{url:"https://pixabay.com/music/meditationspiritual-meditative-rain-114484",name:"Pixabay"},title:"Meditative Rain",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/07/06/audio_bafec9fdb3.mp3?filename=meditative-rain-114484.mp3",type:"Pixabay",metadata:{duration:540}},{author:{url:"https://pixabay.com/music/beats-electronic-rock-king-around-here-15045/",name:"Pixabay"},title:"Electronic Rock (King Around Here)",tags:["electronic","beats","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/01/18/audio_d0a13f69d2.mp3?filename=electronic-rock-king-around-here-15045.mp3",type:"Pixabay",metadata:{duration:110}},{author:{url:"https://pixabay.com/music/meditationspiritual-a-meditation-118554",name:"Pixabay"},title:"A Meditation",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/29/audio_38be17baf6.mp3?filename=a-meditation-118554.mp3",type:"Pixabay",metadata:{duration:489}},{author:{url:"https://pixabay.com/music/ambient-deep-in-the-ocean-116172",name:"Pixabay"},title:"Deep In The Ocean",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/02/audio_5ac24f323d.mp3?filename=deep-in-the-ocean-116172.mp3",type:"Pixabay",metadata:{duration:539}},{author:{url:"https://pixabay.com/music/beats-whip-110235/",name:"Pixabay"},title:"Whip",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/04/27/audio_67bcf729cf.mp3?filename=whip-110235.mp3",type:"Pixabay",metadata:{duration:164}}],pse=["Upbeat","Chill","Inspiring","Cinematic","Happy","Epic","Hopeful","Hip Hop","Fun","Soundtrack","Atmospheric","Calm"];async function hse(e){try{return await Yr(`/api/v2/ai/jobs/${e}`)}catch(IGe){return console.error(IGe),null}}async function gse(e,t){const o=await async function(e,t){var o;try{const a=await Yr("/api/v1/ai/music-keyword",{params:{keywords:e,passage:t,teamId:null==(o=Hu())?void 0:o._id}});return a.succeeded?(Qr("music_keyword",{body:{id:a.id}}).catch((e=>{console.error(e)})),a.id):(console.error(a.message),null)}catch(IGe){return console.error(IGe),null}}(pse.toString(),e);if(!o)throw new Error("Failed to initialize music keyword fetch");let a=0;for(;;){if(t.cancelled)return null;const e=await hse(o);if(t.cancelled)return null;if(!e)return null;if(a>30)throw new Error("Getting a response is taking longer than expected.");if("complete"===e.status)return e.keyword;if("error"===e.status)throw new Error(e.error);a+=1,await new Promise((e=>setTimeout(e,4e3)))}}function fse(e,t){let o=mse.filter((t=>t.metadata.duration>e));if(0===o.length&&(o=mse),t){const e=o.filter((e=>e.tags.includes(t)));e.length>0&&(o=e)}const a=o.sort((()=>Math.random()-.5))[0];if(!a)throw new Error("Could not find a song that fits the duration");return a}function yse(e,t=1/0){const o=[];for(const a of mse){if(!a.title.includes(e)&&!a.tags.includes(e)&&""!==e)continue;const i={id:a.title,title:a.title,source:a.source,artist:a.author.name,duration:a.metadata.duration,isFree:!0,isSoundEffect:!1};if(o.push(i),o.length>=t)return o}return o}const vse=[["starting a business",{duration:786,ext:"mp4",height:720,isDirectLink:!1,originalUrl:"https://www.youtube.com/watch?v=zwUsFN__jtE",soundUrl:null,thumbnailUrl:"https://i.ytimg.com/vi_webp/zwUsFN__jtE/maxresdefault.webp",url:"https://rr5---sn-nx57ynss.googlevideo.com/videoplayback?expire=1689313397&ei=FYywZNbdG7iVsfIPjLmT6A8&ip=73.157.41.225&id=o-AMNWzHvAoY9a0Pvx1EvOr80iPVNA1YZkDCpSfAA3-A7_&itag=22&source=youtube&requiressl=yes&mh=j0&mm=31%2C29&mn=sn-nx57ynss%2Csn-nx5s7n76&ms=au%2Crdu&mv=m&mvi=5&pl=23&initcwndbps=1936250&spc=Ul2Sq-fjblATixkna2_qvTt1ULnH86E&vprv=1&svpuc=1&mime=video%2Fmp4&cnr=14&ratebypass=yes&dur=785.879&lmt=1653740265399128&mt=1689291470&fvip=1&fexp=24007246&beids=24350017&c=ANDROID&txp=4432434&sparams=expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cspc%2Cvprv%2Csvpuc%2Cmime%2Ccnr%2Cratebypass%2Cdur%2Clmt&sig=AOq0QJ8wRgIhALZCYiS0uF0yFt0FqnRvGI_ctLUs01DNYpQ7p1d9rEDCAiEAw5MvPmq06NLpmHLWrojClIC81F4mlm09ETcRdDv5K9Y%3D&lsparams=mh%2Cmm%2Cmn%2Cms%2Cmv%2Cmvi%2Cpl%2Cinitcwndbps&lsig=AG3C_xAwRAIgAqd396WnVRdc3sDw714j4LAoAgACqDYWgNdyH_AZqFsCIFR9j4iP7W_xISCKvLStpMB3Cen7UKcd_rH-fSOvB7KO",width:1280,yt_channel:"ROYALTY FREE 4K VIDEOS"}]],_se=.3,wse=class e{constructor(t,{backgroundOpacity:o,fontBackgroundColor:a,fontDefaultColor:s,fontHighlightColor:n,fontFamily:r,aspectRatio:l,duration:d}={},c=!1){i(this,"analyticsType","video"),i(this,"topic"),i(this,"outline",null),i(this,"usedUrls",new Set),i(this,"aspectRatio","9:16"),i(this,"backgroundOpacity",.9),i(this,"fontBackgroundColor","#000000"),i(this,"fontDefaultColor","#ffffff"),i(this,"fontHighlightColor","#FFCD1D"),i(this,"fontFamily","Montserrat"),i(this,"videoSearchByKeyword",new Map),i(this,"videoSearchByTopic",new Map(vse)),i(this,"attributionByVideoUrl",new Map),i(this,"numClipsExtracted",0),i(this,"timelineOffsetSeconds",0),i(this,"cancellationSource",new CH),i(this,"targetDuration"),i(this,"usingPastPrompt"),i(this,"generate",(async t=>{if(window.abc=t,!e.isValidOutline(t))throw new Error("Invalid outline");return this.outline=t,this.main()})),this.topic=t,this.targetDuration=d||60,s&&(this.fontDefaultColor=s),a&&(this.fontBackgroundColor=a),n&&(this.fontHighlightColor=n),r&&(this.fontFamily=r),o&&(this.backgroundOpacity=o),l&&(this.aspectRatio=l),this.usingPastPrompt=c}cancel(){this.cancellationSource.cancel()}static isValidOutline(e){if("object"!=typeof e)return!1;if(!e)return!1;if(!("slides"in e))return!1;if("video_keyword"in e&&"string"!=typeof e.video_keyword)return!1;if(!Array.isArray(e.slides))return!1;for(const t of e.slides){if("object"!=typeof t)return!1;if(!t)return!1;if(!("text"in t))return!1;if("string"!=typeof t.text)return!1}return!0}static async getPreciseDuration(e){return new Promise((t=>{const o=document.createElement("video");o.src=e,o.preload="auto",o.onerror=()=>{o.remove(),t(Number.NaN)},o.ondurationchange=()=>{o.remove(),t(o.duration)},o.muted=!0,setTimeout((()=>{t(Number.NaN),o.remove()}),5e3),document.body.appendChild(o),o.width=0,o.height=0,o.style.visibility="hidden",o.style.position="absolute",o.style.left="-10000px",o.style.top="-10000px",o.load()}))}addTextHighlights(e){let t=[""];this.topic&&(t=this.topic.toLowerCase().split(" "));for(const o of e){if(o.type!==zl.Text)continue;const e=re.convertToRaw(re.ContentState.createFromText(o.text));if(!e.blocks[0])continue;let a=0,i=0,s=!0;for(const n of o.text.toLowerCase().split(" "))!cse.has(n)&&t.includes(n)?s&&(e.blocks[0].inlineStyleRanges.push({offset:i,length:a-i,style:`COLOR_${this.fontDefaultColor}`}),s=!1,i=a):s||(e.blocks[0].inlineStyleRanges.push({offset:i,length:a-i,style:`COLOR_${this.fontHighlightColor}`}),s=!0,i=a),a+=n.length+1;if(0===e.blocks[0].inlineStyleRanges.length){const t=o.text.split(" ");if(Math.round(Math.random()))e.blocks[0].inlineStyleRanges.push({offset:0,length:t.slice(0,3).join(" ").length,style:`COLOR_${this.fontHighlightColor}`}),s=!0,a=t.slice(0,3).join(" ").length+1,i=a;else{const n=t.slice(-3).join(" ").length;e.blocks[0].inlineStyleRanges.push({offset:0,length:o.text.length-n-1,style:`COLOR_${this.fontDefaultColor}`}),s=!1,a=o.text.length-n,i=a}}e.blocks[0].inlineStyleRanges.push({offset:i,length:o.text.length-i,style:s?`COLOR_${this.fontDefaultColor}`:`COLOR_${this.fontHighlightColor}`}),e.blocks[0].inlineStyleRanges.push({offset:0,length:o.text.length,style:"BOLD"}),o.draftJSTextTree=e}}async getAudioLayer(e){const{dispatch:t}=sr(),o=fse(e),{asset:a,cmlFile:i}=await B$(o.source);Mz(a,i);const s=await eY(o.source,{source:a.status===On.uploaded?"upload":"pastedLink",asset_id:a._id,url:a.status===On.uploaded?a.url:void 0,pastedUrl:o.source,cmlFileId:null==i?void 0:i.id,duration:o.metadata.duration,type:zl.Audio,isTrimmed:!0,startTime:0,endTime:e,videoDelay:this.timelineOffsetSeconds,timelineRow:3},{mediaInfo:{duration:o.metadata.duration,hasAudio:!0,type:zl.Audio,height:0,width:0}});return t(yu({assetId:a._id,mediaCacheId:oe.v4()})),s}static getKeyFrameAnimation(e,t){const o=.1*Math.random()+.05;return{id:"moving-zoom",name:"Moving Zoom",transitions:[{duration:t-e,easingFuncID:"linear",endValues:{bottomRight:{x:1-o,y:1-o},topLeft:{x:o,y:o}},startValues:{bottomRight:{x:1,y:1},topLeft:{x:0,y:0}},startTime:e,id:"moving-zoom-transition"}]}}async getVideoUrl(t,{targetDuration:o=0}={}){if(this.videoSearchByTopic.has(this.topic))return this.videoSearchByTopic.get(this.topic);if(this.videoSearchByKeyword.has(t))return this.videoSearchByKeyword.get(t);const a=new Promise((a=>{(async function(e){try{const t=await Qr("yt_search",{body:{term:e}});return function(e){return"number"==typeof e.duration&&"number"==typeof e.height&&"string"==typeof e.originalUrl&&"string"==typeof e.url&&"number"==typeof e.width&&"string"==typeof e.yt_channel}(t)?(console.debug(`searchYoutube response for ${e}:`,t),t):(console.error("searchYoutube response is malformed:",t),null)}catch(t){return console.error(t),null}})(t).then((t=>{t?e.getPreciseDuration(t.url).then((e=>!Number.isNaN(e)&&o<e?a({...t,duration:e}):a(null))).catch((()=>{a(null)})):a(null)})).catch((()=>{a(null)}))}));return this.videoSearchByKeyword.set(t,a),a}getLayerTiming(e,t,o){var a;const i=e*((this.numClipsExtracted+1)/((null==(a=this.outline)?void 0:a.slides.length)||3));return this.numClipsExtracted+=1,{startTime:i,endTime:i+(o-t),videoDelay:t}}async getVideoLayer({startTime:e,endTime:t}){if(!this.outline||!this.outline.video_keyword)return null;const{dispatch:o}=sr(),a=await this.getVideoUrl(this.outline.video_keyword,{targetDuration:t-e});if(this.cancellationSource.cancelled)return null;if(!a)return null;this.attributionByVideoUrl.set(a.originalUrl,a.yt_channel);const{asset:i,cmlFile:s}=await U$(a.originalUrl);if(this.cancellationSource.cancelled)return null;Mz(i,s);const n=i.status===On.uploaded&&i.url||a.url,r=await eY(n,{source:i.status===On.uploaded?"upload":"pastedLink",...this.getLayerTiming(a.duration,e,t),isTrimmed:!0,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},crop:{x:0,y:0,width:100,height:100},pastedUrl:a.originalUrl,timelineRow:1,asset_id:i._id,volume:0},{mediaInfo:{duration:a.duration,hasAudio:!0,type:zl.Video,height:a.height,width:a.width}});return o(yu({assetId:i._id,mediaCacheId:oe.v4()})),r}async getImageLayer({keyword:t,startTime:o,endTime:a}){const{dispatch:i}=sr(),s=await this.getImageLayerUrl(t);if(this.cancellationSource.cancelled)throw new dse;const{asset:n,cmlFile:r}=await B$(s);Mz(n,r);const l=n.status===On.uploaded&&n.url||s,d=await eY(l,{source:n.status===On.uploaded?"upload":"pastedLink",startTime:o,endTime:a,isTrimmed:!0,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},crop:{x:0,y:0,width:100,height:100},pastedUrl:s,keyframeAnimation:e.getKeyFrameAnimation(o,a),timelineRow:1,asset_id:n._id,volume:0},{mediaInfo:{type:zl.Image}});if(this.cancellationSource.cancelled)throw new dse;return i(yu({assetId:n._id,mediaCacheId:oe.v4()})),d}async getImageLayerUrl(t){const o=await PX(`${t} photography`,{useGoogleOnly:!0});for(const i of o.google)if(!this.usedUrls.has(i.url)&&await e.isCorsOk(i.url)){if(this.usedUrls.has(i.url))continue;return this.usedUrls.add(i.url),i.url}const a=o.google[0];return(null==a?void 0:a.url)||""}async getVisualLayer({keyword:e,startTime:t,endTime:o,isVideoEligible:a=!1}){if(a){const e=await this.getVideoLayer({startTime:t,endTime:o});if(this.cancellationSource.cancelled)throw new dse;if(e)return e}return this.getImageLayer({keyword:e,startTime:t,endTime:o})}getTextPosition(){let e=0,t=90,o=20,a=Math.random()*(35-o)+55;switch(this.aspectRatio){case"9:16":t=76.5,o=15,e=0,a=54.5;break;case"16:9":t=55,o=30,e=5;break;case"1:1":e=5,t=60,o=25;break;case"4:5":e=0,t=80,o=25;break;case"5:4":e=0,t=70,o=25}return{x:`${3+e}%`,width:`${t}%`,height:`${o}%`,y:`${a}%`,rotation:0}}checkTimelineForOverlap(){const{studio:e}=sr().state,[t]=e.scenes;if(!t)return;const{duration:o}=uC(t,lT(e));this.timelineOffsetSeconds=o}async updateProjectName(){const{dispatch:e}=sr(),{studio:t,currentUser:o}=sr().state,a=XX(this.topic,25);if(e(SK(a)),t.projectId)try{await TK(t.projectId,{name:a},o)}catch(IGe){}}async main(){const{dispatch:e}=sr();if(!this.outline)return;this.checkTimelineForOverlap();let t=0;const o=[],a=[],i=[];let s=0;const n=this.outline.slides.reduce(((e,t)=>e+t.text.split(" ").length),0),r=this.targetDuration/n;for(const m of this.outline.slides){const{text:e,title:n}=m,l=e.split(" ").length*r,d=oe.v4(),c=oe.v4();a.push({id:c,animationName:Yl.Reveal,transitionDuration:2,isCrossTransition:!1,layerId:d});const u=this.getTextPosition();o.push({type:zl.Text,startTime:this.timelineOffsetSeconds+t,endTime:this.timelineOffsetSeconds+t+l,id:d,text:e||n,backgroundColor:iT(this.fontBackgroundColor,.7),color:"#FFFFFF",fontFamily:this.fontFamily,timelineRow:0,isTrimmed:!0,source:"pastedLink",textShadow:"transparent",position:u,textAlign:"left",animation:{outro:[],intro:[c],constant:[]},globalAlpha:1,textPadding:10,lineHeight:1.15,fontWeight:"bold"}),i.push(this.getVisualLayer({keyword:m.keyword||this.outline.video_keyword,startTime:this.timelineOffsetSeconds+t,endTime:this.timelineOffsetSeconds+t+l,isVideoEligible:s%2==1})),t+=l,s+=1}this.addTextHighlights(o),i.push(this.getAudioLayer(t));const[l,...d]=await Promise.allSettled([MY({fontToLoad:{type:"default",fontFamily:this.fontFamily}}),...i]);if(this.cancellationSource.cancelled)return;const c=d.map((e=>"rejected"===e.status?null:e.value)).filter((e=>null!==e)),u=[];for(const m of c)if(m.type!==zl.Audio){const[e,t]=TS(m),o=new URL(m.pastedUrl);u.push({type:zl.Text,startTime:e,endTime:t,fontFamily:"Open Sans",text:this.attributionByVideoUrl.get(m.pastedUrl)||o.hostname,color:"#FFFFFF",globalAlpha:.8,position:{x:"10%",width:"88%",y:"3%",height:"2%",rotation:0},isTrimmed:!0,textAlign:"right",timelineRow:2,id:oe.v4(),backgroundColor:"rgba(-255,-255,-255,0)",textShadow:"#555555",lineHeight:1.15,fontWeight:"bold"})}g.batch((()=>{e({type:"SHOW_STUDIO_CANVAS"}),e(bb(Kn.MP4)),e(lS(this.aspectRatio)),this.updateProjectName(),"video"===this.analyticsType?e(Tp({usedGenerateVideo:!0,usedGenerateVideoPastPrompt:this.usingPastPrompt})):"document"===this.analyticsType&&e(Tp({usedGenerateVideoFromDocument:!0,usedGenerateVideoFromDocumentPastPrompt:this.usingPastPrompt})),a.forEach((t=>{e(Pv(t))})),e(Fv({layers:[...c,...u,...o],isUndoable:!0})),TE(this.timelineOffsetSeconds)}));for(const m of c)m.asset_id&&HJ(m)&&JJ({assetId:m.asset_id,source:"AI Video Generation"})}};i(wse,"isCorsOk",s.memoize((async e=>{try{const t=new URL(e);if(use.some((e=>t.hostname.includes(e))))return Promise.resolve(null)}catch(IGe){return Promise.resolve(null)}return new Promise((t=>{const o=new Image,a=setTimeout((()=>t(null)),5e3);o.onload=()=>{clearTimeout(a),t({width:o.width,height:o.height})},o.onerror=()=>{clearTimeout(a),t(null)},o.src=e}))})));let bse=wse;const Tse=[{label:"Classic Dark",className:"classicDark",styles:{backgroundAlpha:.5,backgroundColor:"#000000",fontFamily:"Montserrat",highlightTextColor:"#ffcd1d",textColor:"#ffffff"}},{label:"Classic Light",className:"classicLight",styles:{backgroundAlpha:.7,backgroundColor:"#ffffff",fontFamily:"Montserrat",highlightTextColor:"#0083E2",textColor:"#000000"}},{label:"Highlight",className:"highlight",styles:{backgroundAlpha:1,backgroundColor:"#ffcd1d",fontFamily:"Raleway",highlightTextColor:"#0044aa",textColor:"#000000"}},{label:"Typewriter",className:"typewriter",styles:{backgroundAlpha:1,backgroundColor:"#ffffff",fontFamily:"Roboto Mono",highlightTextColor:"#ff4163",textColor:"#000000"}},{label:"New Leaf",className:"newLeaf",styles:{backgroundAlpha:1,backgroundColor:"#cdeebd",fontFamily:"Raleway",highlightTextColor:"#122609",textColor:"#2d531c"}}],xse="UpsellWarningBlock-module_upsellWarningBlockContainer_wf2ua",Sse="UpsellWarningBlock-module_warning_dxw7f",Ese="UpsellWarningBlock-module_iconWrapper_t8RBo",Ise="UpsellWarningBlock-module_button_3oDiB",Cse=()=>{},kse=_.memo((({action:e,onPaywallSuccess:t=Cse,warning:o=null,body:a=null,buttonText:i,className:s="",immediateRedirectPathname:n})=>w.jsxs("div",{className:`${xse} ${s}`,"data-cy":"upsell-warning-block",children:[o&&w.jsxs("div",{className:Sse,children:[w.jsx("div",{className:Ese,children:w.jsx(to,{})}),o]}),w.jsx("span",{children:a}),i&&w.jsx(jie,{className:Ise,action:e,onPaywallSuccess:t,buttonText:i,hasIcon:!0,immediateRedirectPathname:n})]}))),Ase={wrapper:"GenerateSlideshow-module_wrapper_A2veB",controls:"GenerateSlideshow-module_controls_N2h3C",controlsSmall:"GenerateSlideshow-module_controlsSmall_hzDiB",promptRow:"GenerateSlideshow-module_promptRow_SQRsA",charCount:"GenerateSlideshow-module_charCount_OYY5c",row:"GenerateSlideshow-module_row_ULZjA",promptDropdownDiv:"GenerateSlideshow-module_promptDropdownDiv_dbg8I",label:"GenerateSlideshow-module_label_BpIhK",input:"GenerateSlideshow-module_input_TSN3g",textAreaWrapper:"GenerateSlideshow-module_textAreaWrapper_s4fjS",textarea:"GenerateSlideshow-module_textarea_QZveK",previewWrapper:"GenerateSlideshow-module_previewWrapper_-Ob6Q",resultsWrapper:"GenerateSlideshow-module_resultsWrapper_iQuu3",previewHint:"GenerateSlideshow-module_previewHint_IhcsO",previewContainer:"GenerateSlideshow-module_previewContainer_QmovV",preview:"GenerateSlideshow-module_preview_e99st",previewBlur:"GenerateSlideshow-module_previewBlur_mulVN",previewText:"GenerateSlideshow-module_previewText_MuvKn",generateContainer:"GenerateSlideshow-module_generateContainer_Wuhk9",generateButton:"GenerateSlideshow-module_generateButton_Sd1Kx",disabled:"GenerateSlideshow-module_disabled_Mne36",loader:"GenerateSlideshow-module_loader_CTKLD",spin:"GenerateSlideshow-module_spin_NgQWs",darkLoader:"GenerateSlideshow-module_darkLoader_Q3TNh",resultsContainer:"GenerateSlideshow-module_resultsContainer_azfGY",emptyState:"GenerateSlideshow-module_emptyState_FmTA7",upsellContainer:"GenerateSlideshow-module_upsellContainer_1jt5X",examplesWrapper:"GenerateSlideshow-module_examplesWrapper_RZvuf",example:"GenerateSlideshow-module_example_ysm-E",oneOne:"GenerateSlideshow-module_oneOne_yQGv0",nineSixteen:"GenerateSlideshow-module_nineSixteen_dFRGY",sixteenNine:"GenerateSlideshow-module_sixteenNine_QO1cB",fourFive:"GenerateSlideshow-module_fourFive_j1tkX",fiveFour:"GenerateSlideshow-module_fiveFour_U9Q2Z",sizeWrapper:"GenerateSlideshow-module_sizeWrapper_XSIzl",sizeContainer:"GenerateSlideshow-module_sizeContainer_yFUXW",sizePreviewBackground:"GenerateSlideshow-module_sizePreviewBackground_rO4h3",optionLabel:"GenerateSlideshow-module_optionLabel_RxqFF",sizePreview:"GenerateSlideshow-module_sizePreview_5l4Yx",textStylesWrapper:"GenerateSlideshow-module_textStylesWrapper_EMTYB",textStylesContainer:"GenerateSlideshow-module_textStylesContainer_AJCa5",textStylesPreviewBackground:"GenerateSlideshow-module_textStylesPreviewBackground_Fa7RI",textPreview:"GenerateSlideshow-module_textPreview_ODwU6",classicDark:"GenerateSlideshow-module_classicDark_RQtqb",highlightedText:"GenerateSlideshow-module_highlightedText_t2wq7",classicLight:"GenerateSlideshow-module_classicLight_Bjqw7",highlight:"GenerateSlideshow-module_highlight_jSaxg",typewriter:"GenerateSlideshow-module_typewriter_JCYnM",newLeaf:"GenerateSlideshow-module_newLeaf_uJXyd",typeWrapper:"GenerateSlideshow-module_typeWrapper_IVbn0",typeContainer:"GenerateSlideshow-module_typeContainer_AkIxL",typePreviewBackground:"GenerateSlideshow-module_typePreviewBackground_XAXru",type:"GenerateSlideshow-module_type_YX4-0",active:"GenerateSlideshow-module_active_ZgXZc"};class jse extends Error{constructor(e){super(e),this.name="NotJSONError"}}function Nse(e){window.outline=e;const t=e.indexOf("{"),o=e.indexOf("["),a=e.lastIndexOf("}"),i=e.lastIndexOf("]");if(-1===t||-1===o)throw new jse(e);const s=Math.min(t,o),n=Math.max(a,i);let r=e.slice(s);return r=r.slice(0,n-s+1),r.startsWith("{")||(r=`{ "slides": ${r} }`),r=r.replace(/"$/gm,'",'),r=r.replace(/,(?!\s*?[{["'\w])/g,""),JSON.parse(r)}async function Rse(e,t){var o;try{const{duration:a,tab:i,selectedSize:s,selectedTextStyle:n}=t,r=await Yr("/api/v2/ai/generate-video",{params:{topic:e,teamId:null==(o=Hu())?void 0:o._id,tab:i,selectedSize:JSON.stringify(s),selectedTextStyle:JSON.stringify(n),duration:a}});if(!r.succeeded)return console.error(r.message),null;const{numSlides:l,maxTotalWords:d}=(e=>{if(!e)return{numSlides:void 0,maxTotalWords:void 0};const t=Math.floor((e+2)/7);return{numSlides:t,maxTotalWords:Math.floor((e-(2*t-1))/_se)}})(a);Qr("generate_video",{body:{topic:e,numSlides:l,maxTotalWords:d,id:r.id,version:2}}).catch((e=>{console.error(e)}));const{dispatch:c}=sr();return c({type:"INCREMENT_AI_USAGE",feature:"generatedVideos"}),r.id}catch(IGe){return console.error(IGe),null}}async function Pse(e){try{return await Yr(`/api/v2/ai/jobs/${e}`)}catch(IGe){return console.error(IGe),null}}async function Dse(e,t,o){const a=await Rse(e,o);if(!a)return null;let i=0;for(;;){if(t.cancelled)return null;const e=await Pse(a);if(t.cancelled)return null;if(!e)return null;if(i>30)throw new jse("Getting a response is taking longer than expected. Please try again later.");if("complete"===e.status)return Nse(e.outline);if("error"===e.status)throw new jse(e.error);i+=1,await new Promise((e=>setTimeout(e,4e3)))}}var Ose=(e=>(e.VIDEO="video",e.SLIDESHOW="slideshow",e.IMAGE="image",e.MEME="meme",e.SCRIPT="script",e.VIDEO_FROM_DOCUMENT="video from document",e.VIDEO_FROM_SCRIPT="video from script",e))(Ose||{});const Lse=(e,t)=>{const o=au().name;if(t>0){return`You can generate ${rW(t,`more ${e}`)} for free. Upgrade for increased generations.`}return`You have reached the ${o} limit for ${e} generations. Upgrade for increased generations.`},Fse=[{seconds:15,label:"15s"},{seconds:30,label:"30s"},{label:"1m",seconds:60},{label:"2m",seconds:120},{label:"5m",seconds:300}],Mse="optionStyles-module_label_LnM-l",Use="optionStyles-module_typeWrapper_ys9Dv",Bse="optionStyles-module_typeContainer_auPFM",Vse="optionStyles-module_typePreviewBackground_Wn3jV",Wse="optionStyles-module_type_pHxq1",Gse="optionStyles-module_active_-9eNM",Hse="optionStyles-module_optionIcon_XcuKf",$se="optionStyles-module_optionLabel_ACWg4",Kse="optionStyles-module_sparkle_ieI03",zse=_.memo((({label:e,seconds:t,selectedDuration:o,setSelectedDuration:a})=>{const i=ou().isFree,s=TW((()=>n()),{action:Vl.GENERATE_LONG_DURATION_AI,if:i&&t>=120}),n=h.useCallback((()=>{a(t)}),[a,t]);return w.jsx("div",{className:Bse,onClick:s,children:w.jsx("div",{className:mt(Vse,{[Gse]:t===o}),children:w.jsxs("div",{className:Wse,children:[e,i&&t>=120&&w.jsx(EW,{className:Kse})]})})})})),Yse=_.memo((function({label:e,selectedDuration:t,setSelectedDuration:o}){return w.jsxs("div",{children:[w.jsx("div",{className:Mse,children:e}),w.jsx("div",{className:Use,children:Fse.map((({label:e,seconds:a})=>w.jsx(zse,{label:e,seconds:a,selectedDuration:t,setSelectedDuration:o},a)))})]})})),Jse={wrapper:"SizeOptions-module_wrapper_QcAWy",controls:"SizeOptions-module_controls_8PNy4",controlsSmall:"SizeOptions-module_controlsSmall_2fZXw",promptRow:"SizeOptions-module_promptRow_GToZB",charCount:"SizeOptions-module_charCount_MLqNg",row:"SizeOptions-module_row_AGasG",promptDropdownDiv:"SizeOptions-module_promptDropdownDiv_do8WT",label:"SizeOptions-module_label_ustCO",input:"SizeOptions-module_input_N4pLz",textAreaWrapper:"SizeOptions-module_textAreaWrapper_hCz6B",textarea:"SizeOptions-module_textarea_LsDyf",previewWrapper:"SizeOptions-module_previewWrapper_gVicO",resultsWrapper:"SizeOptions-module_resultsWrapper_Tq0jp",previewHint:"SizeOptions-module_previewHint_23fkz",previewContainer:"SizeOptions-module_previewContainer_ek66l",preview:"SizeOptions-module_preview_5JZrx",previewBlur:"SizeOptions-module_previewBlur_vPLPH",previewText:"SizeOptions-module_previewText_3W7aj",generateContainer:"SizeOptions-module_generateContainer_22--4",generateButton:"SizeOptions-module_generateButton_HN9wJ",disabled:"SizeOptions-module_disabled_9-Bh-",loader:"SizeOptions-module_loader_h2Dev",spin:"SizeOptions-module_spin_Cstgh",darkLoader:"SizeOptions-module_darkLoader_12i8-",resultsContainer:"SizeOptions-module_resultsContainer_O-DPS",emptyState:"SizeOptions-module_emptyState_w5pJF",upsellContainer:"SizeOptions-module_upsellContainer_GCcjS",examplesWrapper:"SizeOptions-module_examplesWrapper_qmqi4",example:"SizeOptions-module_example_5dyh4",oneOne:"SizeOptions-module_oneOne_PqFcc",nineSixteen:"SizeOptions-module_nineSixteen_exK9b",sixteenNine:"SizeOptions-module_sixteenNine_a0yW0",fourFive:"SizeOptions-module_fourFive_KrDCI",fiveFour:"SizeOptions-module_fiveFour_ngTGM",container:"SizeOptions-module_container_5vF8z",sizeWrapper:"SizeOptions-module_sizeWrapper_cVUCk",sizeContainer:"SizeOptions-module_sizeContainer_OEZwK",sizePreviewBackground:"SizeOptions-module_sizePreviewBackground_OZ-8v",optionLabel:"SizeOptions-module_optionLabel_M66Gt",sizePreview:"SizeOptions-module_sizePreview_l7W6g",active:"SizeOptions-module_active_SMQIW"};var qse=(e=>(e.TikTok="TikTok",e.Youtube="YouTube",e.Reels="Reels",e.Shorts="Shorts",e))(qse||{});const Xse=[{key:"1:1",className:"oneOne"},{key:"9:16",className:"nineSixteen"},{key:"16:9",className:"sixteenNine"},{key:"4:5",className:"fourFive"},{key:"5:4",className:"fiveFour"}],Qse=[Xse[1],Xse[0],Xse[2],Xse[3],Xse[4]];function Zse(e){switch(e.key){case"9:16":return qse.TikTok;case"1:1":return qse.Reels;default:return qse.Youtube}}function ene({size:e,isSelected:t,setSelectedSize:o,setSelectedPlatform:a}){const{key:i,className:s}=e,n=h.useCallback((()=>{o(e),a&&a(Zse(e))}),[a,o,e]);return w.jsxs("div",{className:Jse.sizeContainer,onClick:n,children:[w.jsx("div",{className:mt(Jse.sizePreviewBackground,{[Jse.active]:t}),children:w.jsx("div",{className:mt(Jse[s],Jse.sizePreview)})}),w.jsx("div",{className:Jse.optionLabel,children:i})]})}const tne=_.memo((function({setSelectedSize:e,selectedSize:t,setSelectedPlatform:o}){return w.jsxs("div",{className:Jse.container,children:[w.jsx("div",{className:Jse.label,children:"Size"}),w.jsx("div",{className:Jse.sizeWrapper,children:Qse.map((a=>w.jsx(ene,{size:a,isSelected:t.key===a.key,setSelectedSize:e,setSelectedPlatform:o},a.key)))})]})}));var one=(e=>(e.Video="Video",e.Slideshow="Slideshow",e.Image="Image",e.Meme="Meme",e.Script="Script",e.DocumentToVideo="DocumentToVideo",e.ArticleToVideo="ArticleToVideo",e.ScriptToVideo="ScriptToVideo",e))(one||{});const ane={"generate-video":"Video","generate-slideshow":"Slideshow","generate-images":"Image","generate-memes":"Meme","generate-script":"Script","convert-document-to-video":"DocumentToVideo","convert-article-to-video":"ArticleToVideo","convert-script-to-video":"ScriptToVideo"},ine=[{tab:"Video",icon:w.jsx(oo,{}),header:"Create Video"},{tab:"ScriptToVideo",icon:w.jsx(ao,{}),header:"Script to Video"},{tab:"Script",icon:w.jsx(io,{}),header:"Create Script"},{tab:"Meme",icon:w.jsx(so,{}),header:"Meme Generator"},{tab:"Slideshow",icon:w.jsx(no,{}),header:"Create Slideshow"},{tab:"ArticleToVideo",icon:w.jsx(ro,{}),header:"Article to Video"},{tab:"Image",icon:w.jsx(lo,{}),header:"Create Image"},{tab:"DocumentToVideo",icon:w.jsx(co,{}),header:"Document to Video"}],sne="tabStyles-module_promptRow_mlLAs",nne="tabStyles-module_charCount_vg75f",rne="tabStyles-module_row_pBmVH",lne="tabStyles-module_promptDropdownDiv_XsAYO",dne="tabStyles-module_label_rBKa-",cne="tabStyles-module_textAreaWrapper_SAUGQ",une="tabStyles-module_textarea_VaUXP",mne="SamplePrompts-module_sampleButton_RRy8p",pne=_.memo((function({samplePrompts:e,setPrompt:t}){const[o,a]=h.useState(Math.floor(Math.random()*((null==e?void 0:e.length)||0)));return(null==e?void 0:e.length)?w.jsx("div",{className:mne,onClick:function(){if(!(null==e?void 0:e.length))return;const i=e[o];a((o+1)%e.length),i&&t(i)},children:"Try a sample!"}):null})),hne="HistoryButton-module_historyButton_M1dkg",gne="HistoryButton-module_historyButtonDisabled_SdXHc",fne=_.memo((({setShowing:e,className:t,bumpLeft:o,disabled:a})=>w.jsx(sU,{message:a?"No Matching Past Prompts":"View Past Prompts",children:w.jsx("button",{style:o?{right:105.5}:{},className:`${t||""} ${hne} ${a?gne:""}`,onClick:t=>{t.preventDefault(),e((e=>!e))},children:w.jsx(uo,{})})}))),yne="PastPromptDropDown-module_pastPrompt_qtfWE",vne="PastPromptDropDown-module_selectedPastPrompt_426y1",_ne="PastPromptDropDown-module_delete_5IgN9",wne="PastPromptDropDown-module_icon_shf3-",bne="PastPromptDropDown-module_left_PwjAV",Tne="PastPromptDropDown-module_title_c7TYr",xne="PastPromptDropDown-module_dropDown_JuOWi",Sne="PastPromptDropDown-module_pastPromptText_cIJTA",Ene="PastPromptDropDown-module_topBar_9onvj",Ine="PastPromptDropDown-module_exitButton_QIXY9",Cne=(e,t)=>t in e?String(e[t]):"";const kne=_.memo((function({setPromptFromPastJob:e,promptKey:t,inputRef:o,showing:a,setShowing:i,setHavePromptsToShow:s,requirePastJobsToMatchTab:n,tab:r,type:l,havePromptsToShow:d,value:c}){const[u,m]=h.useState([]),[p,g]=h.useState(-1),f=_.useRef(null);h.useEffect((function(){!async function(){const e=await Yr(`/api/v1/ai/pastJobs/${l}`,{params:n?{tab:r}:{}}),{pastJobs:o}=e,a=o.filter(((e,o,a)=>a.findIndex((o=>Cne(o,t)===Cne(e,t)))===o));m(a||[]),s(!!a.length)}()}),[r,t,l,m,n,s]);const y=h.useCallback((t=>{Fm(ym.SELECTED_PAST_PROMPT,{type:l,tab:r}),e(t),i(!1)}),[e,i,r,l]),v=h.useCallback((e=>{zr("/api/v1/ai/jobs",{body:{jobId:String(e._id)}}),m((t=>t.filter((t=>t._id!==e._id))))}),[]),b=h.useCallback((()=>{const e=o.current;if(e&&e!==document.activeElement){const t=e.value.length;e.focus(),e.selectionStart=t,o.current.selectionEnd=t}}),[o]),T=h.useMemo((()=>u.length?mo.go(c||"",u,{key:String(t),limit:10,all:!0}):[]),[u,t,c]);h.useEffect((function(){T.length?s(!0):s(!1)}),[T,s]);const x=cE((function(e){var t,a;const s=null==(t=f.current)?void 0:t.getBoundingClientRect(),n=null==(a=o.current)?void 0:a.getBoundingClientRect(),r=s&&s.left<=e.clientX&&e.clientX<=s.right&&s.top<=e.clientY&&e.clientY<=s.bottom,l=n&&n.left<=e.clientX&&e.clientX<=n.right&&n.top<=e.clientY&&e.clientY<=n.bottom;(l||r)&&b(),r||l||i(!1)})),S=cE((function(e){if("ArrowUp"===e.key&&(e.preventDefault(),g((e=>-1===e?u.length-1:e-1))),"ArrowDown"===e.key&&(e.preventDefault(),g((e=>e===u.length-1?-1:e+1))),"Enter"===e.key){e.preventDefault();const t=u[p];t&&y(t);const o=document.activeElement;(o instanceof HTMLTextAreaElement||o instanceof HTMLInputElement)&&o.blur()}}));return h.useEffect((function(){return document.addEventListener("click",x),document.addEventListener("keydown",S),()=>{document.removeEventListener("click",x),document.removeEventListener("keydown",S)}}),[x,S]),a&&d?w.jsxs("div",{className:xne,ref:f,children:[w.jsxs("div",{className:Ene,children:[w.jsx("div",{className:Tne,children:"Past prompts"})," ",w.jsx("button",{type:"button",className:Ine,onClick:()=>i(!1),children:w.jsx(po,{})})]}),T.map(((e,o)=>{const a=e.obj;return w.jsxs("div",{className:p===o?vne:yne,onClick:()=>{y(a)},children:[w.jsxs("div",{className:bne,children:[w.jsx(ho,{className:wne}),w.jsx("div",{className:Sne,children:c.length?mo.highlight(e,(e=>w.jsx("b",{children:e}))):Cne(a,t)})]}),w.jsx("div",{className:_ne,onClick:e=>{e.stopPropagation(),v(a)},children:w.jsx(po,{})})]},Cne(a,t))}))]}):null})),Ane=_.memo((({value:e,placeholder:t,tab:o,promptKey:a,type:i,setPrompt:s,setPromptFromPastJob:n,title:r,maxCharLength:l,samplePrompts:d,disabled:c,requirePastJobsToMatchTab:u,disablePastPrompt:m,rows:p,rowClass:g,className:f,buttonClass:y,textWrapperClass:v})=>{const _=h.useRef(null),[b,T]=h.useState(!1),[x,S]=h.useState(!1);return w.jsxs(w.Fragment,{children:[" ",w.jsxs("div",{className:g||rne,children:[w.jsxs("div",{className:sne,children:[r&&w.jsx("div",{className:dne,children:r}),l?w.jsxs("div",{className:nne,style:e.length>l?{color:"red"}:{},children:[e.length,"/",l]}):null]}),w.jsxs("div",{className:v||cne,children:[w.jsx("textarea",{ref:_,className:f||une,placeholder:t,value:e,onChange:e=>s(e.target.value),rows:p,disabled:c}),!m&&w.jsx(fne,{setShowing:S,className:y,disabled:!b,bumpLeft:!!(null==d?void 0:d.length)}),!!(null==d?void 0:d.length)&&w.jsx(pne,{setPrompt:s,samplePrompts:d})]})]}),w.jsx("div",{className:lne,children:!m&&w.jsx(kne,{value:e,type:i,tab:o,requirePastJobsToMatchTab:u,setPromptFromPastJob:n,promptKey:a,inputRef:_,setShowing:S,setHavePromptsToShow:T,havePromptsToShow:b,showing:x})})]})})),jne=["Michael Jordan","how to cook broccoli","starting a business","hiking in Patagonia"];const Nne=_.memo((function({setLoading:e,onClose:t,setCancelFn:o,enforceSignIn:a,setLoadingTime:i}){const s=il(),n=tl((e=>e.studioLocal.ai.slideshowGeneratorPrompt||"")),[r,l]=h.useState(Xse[0]),[d,c]=h.useState(Tse[0]),[u,m]=h.useState(30),[p,g]=h.useState(!1),f=NU(Bl.GENERATE_VIDEO),y=bW(),v=wQ(),_=tl((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedVideos}))||0,b=h.useCallback((async()=>{e(!0),i(30);const a=await(async({selectedTextStyle:e,topic:t,duration:o,selectedSize:a,setCancelFn:i,usingPastPrompt:s})=>{const{dispatch:n}=sr();try{Fm(ym.STARTED_VIDEO_GENERATOR,{Style:e.label,"Aspect Ratio":a.key,Topic:t,Duration:o,"Used Past Prompt":s});const r=new CH;i&&i((()=>()=>{r.cancel(),n(cw({slideshowGeneratorPrompt:""}))}));const l=await Dse(t,r,{duration:o,tab:one.Slideshow,selectedTextStyle:e,selectedSize:a});if(r.cancelled)return!1;const d=new bse(t,{backgroundOpacity:e.styles.backgroundAlpha,fontBackgroundColor:e.styles.backgroundColor,fontDefaultColor:e.styles.textColor,fontFamily:e.styles.fontFamily,fontHighlightColor:e.styles.highlightTextColor,aspectRatio:a.key,duration:o},s);i&&i((()=>()=>d.cancel())),window.slideshowGenerator=d;try{return await d.generate(l),!0}catch(IGe){const{message:t}=ph(IGe);return Fm(ym.VIDEO_GENERATOR_FAILED,{Error:t}),mh({description:"Failed to generate video.",error:IGe}),!1}}catch(IGe){if(IGe instanceof jse)n(wl({type:"warning",description:IGe.message}));else{const{message:t}=ph(IGe);Fm(ym.VIDEO_GENERATOR_FAILED,{Error:t}),mh({description:"Received an unexpected GPT response.",error:IGe})}return!1}})({selectedSize:r,selectedTextStyle:d,duration:u,topic:n,setCancelFn:o,usingPastPrompt:p});a&&(PP({[Oc.AI_GENERATE]:1}),t()),e(!1)}),[e,i,r,d,u,n,o,p,t]),T=v(y((()=>b()),{action:Vl.GENERATE_VIDEO,if:_>=2}),{[Oc.AI_GENERATE]:1}),x=()=>{if(f)return null;const e=Math.max(2-_,0);if(e>1)return null;const t=Lse(Ose.SLIDESHOW,e);return w.jsx("div",{className:Ase.upsellContainer,children:w.jsx(kse,{warning:t,action:Vl.GENERATE_VIDEO,buttonText:"Upgrade"})})},S=h.useCallback((e=>{"generate-video"===e.type&&(s(cw({slideshowGeneratorPrompt:e.topic})),e.selectedTextStyle&&c(e.selectedTextStyle),e.selectedSize&&l(e.selectedSize),e.duration&&m(Number(e.duration)),g(!0))}),[s]);return w.jsxs("div",{className:Ase.wrapper,children:[w.jsxs("div",{className:Ase.controls,children:[w.jsx(Ane,{title:"Slideshow topic",placeholder:"Generate a slideshow about...",value:n,tab:one.Slideshow,setPrompt:function(e){s(cw({slideshowGeneratorPrompt:e}))},type:"generate-video",promptKey:"topic",setPromptFromPastJob:S,samplePrompts:jne,maxCharLength:1e3,requirePastJobsToMatchTab:!0}),w.jsx(tne,{selectedSize:r,setSelectedSize:l}),w.jsxs("div",{className:Ase.row,children:[w.jsx("div",{className:Ase.label,children:"Text Style"}),w.jsx("div",{className:Ase.textStylesWrapper,children:Tse.map((e=>{const{label:t,className:o}=e;let a=Ase.textStylesPreviewBackground;return t===d.label&&(a+=` ${Ase.active}`),w.jsxs("div",{className:Ase.textStylesContainer,onClick:()=>c(e),children:[w.jsx("div",{className:a,children:w.jsxs("div",{className:`${Ase[o]} ${Ase.textPreview}`,children:["Your"," ",w.jsx("span",{className:Ase.highlightedText,children:"AI-generated"})," ","captions here"]})}),w.jsx("div",{className:Ase.optionLabel,children:t})]},o)}))})]}),w.jsx("div",{className:Ase.row,children:w.jsx(Yse,{label:"Approximate Duration",selectedDuration:u,setSelectedDuration:m})}),w.jsx("div",{className:Ase.row})]}),w.jsxs("div",{className:Ase.previewWrapper,children:[w.jsx("div",{className:Ase.previewHint,children:"This is just a preview of the size and style of your video. Click Generate Video to start the creation process."}),(()=>{let e={width:"80%",aspectRatio:"1/1"};switch(r.key){case"9:16":e={width:"55%",aspectRatio:"9/16"};break;case"16:9":e={width:"100%",aspectRatio:"16/9"};break;case"4:5":e={width:"80%",aspectRatio:"4/5"};break;case"5:4":e={width:"100%",aspectRatio:"5/4"}}return w.jsx("div",{className:Ase.previewContainer,children:w.jsx("div",{className:Ase.preview,style:e,children:w.jsx("div",{className:Ase.previewBlur,children:w.jsxs("div",{className:`${Ase.previewText} ${Ase[d.className]}`,children:["Kapwing AI will"," ",w.jsxs("span",{className:Ase.highlightedText,children:["generate a ",r.key," video"]})," ","about ",w.jsx("span",{children:Ys(n)||"anything you'd like!"})]})})})})})(),n?w.jsxs("div",{className:Ase.generateContainer,children:[x(),w.jsx("div",{className:Ase.generateButton,onClick:a(T),children:"Generate Video"})]}):w.jsxs("div",{className:Ase.generateContainer,children:[x(),w.jsx("div",{className:`${Ase.generateButton} ${Ase.disabled}`,children:"Generate Video"})]})]})]})}));class Rne extends Error{constructor(e){super(e),this.name="SafetyError"}}const Pne=async e=>{var t;const o=await qr(`/api/v3/generate/images?prompt=${e}`,{body:{teamId:null==(t=Hu())?void 0:t._id}}),a=await async function(e,{secondsToTimeout:t}){const o=performance.now();for(;performance.now()-o<1e3*t;){const t=await Yr(`/api/v3/generate/images/${e}`);if("pending"!==t.job.status)return t.job;await new Promise((e=>setTimeout(e,3e3)))}return null}(o.id,{secondsToTimeout:120});if(!a)throw new Error("Generating your images is taking longer than expected. Please try again later.");if("error"===a.status)throw new Error("An error occurred while generating your images.");return a.images};async function Dne(e){try{await PP({[Oc.AI_GENERATE]:1,[e]:1})}catch(IGe){console.error(IGe)}}const One={wrapper:"Images-module_wrapper_tHC8u",controls:"Images-module_controls_CIyAd",controlsSmall:"Images-module_controlsSmall_y5156",promptRow:"Images-module_promptRow_gjfFK",charCount:"Images-module_charCount_Bf2ob",row:"Images-module_row_cnENZ",promptDropdownDiv:"Images-module_promptDropdownDiv_utGUh",label:"Images-module_label_zGJ-F",input:"Images-module_input_wKuIT",textAreaWrapper:"Images-module_textAreaWrapper_UJXAk",textarea:"Images-module_textarea_MO8pQ",previewWrapper:"Images-module_previewWrapper_rqNCB",resultsWrapper:"Images-module_resultsWrapper_ihxgK",previewHint:"Images-module_previewHint_iIkYr",previewContainer:"Images-module_previewContainer_Mbkey",preview:"Images-module_preview_ZYfXS",previewBlur:"Images-module_previewBlur_P7T2I",previewText:"Images-module_previewText_YUOGz",generateContainer:"Images-module_generateContainer_4Id7R",generateButton:"Images-module_generateButton_xBu2t",disabled:"Images-module_disabled_RnaWO",loader:"Images-module_loader_wrosF",spin:"Images-module_spin_rbQO2",darkLoader:"Images-module_darkLoader_ZmcWJ",resultsContainer:"Images-module_resultsContainer_fXENF",emptyState:"Images-module_emptyState_hR47k",upsellContainer:"Images-module_upsellContainer_Oqa2q",examplesWrapper:"Images-module_examplesWrapper_BADqw",example:"Images-module_example_9Huo4",sizeWrapper:"Images-module_sizeWrapper_8I1qm",sizeContainer:"Images-module_sizeContainer_RNCYe",sizePreviewBackground:"Images-module_sizePreviewBackground_DncUa",optionLabel:"Images-module_optionLabel_WhkUx",sizePreview:"Images-module_sizePreview_DSzO4",oneOne:"Images-module_oneOne_uZTba",nineSixteen:"Images-module_nineSixteen_INEif",sixteenNine:"Images-module_sixteenNine_eCdEa",fourFive:"Images-module_fourFive_e-R-p",fiveFour:"Images-module_fiveFour_y8SEu",active:"Images-module_active_DyGda",imagesWrapper:"Images-module_imagesWrapper_FsJDK",imagesContainer:"Images-module_imagesContainer_a2nti",instructions:"Images-module_instructions_1qpdj",loadingInstructionsText:"Images-module_loadingInstructionsText_yivSh",imageContainer:"Images-module_imageContainer_ASzET",image:"Images-module_image_qPHzS",loadingImageContainer:"Images-module_loadingImageContainer_bTajc",loadingImage:"Images-module_loadingImage_cqmBU",shimmer:"Images-module_shimmer_u-bvu",emptyStateImage:"Images-module_emptyStateImage_R8DC4",sparkle:"Images-module_sparkle_us3tW"},Lne=[{label:"lake sunset",query:"Ultrawide, lake of Annecy with golden ratio style, 4K, foreground is prairie, light is Golden hour, sky with red Clouds, ultrarealistic, CinémaScope, ultra wide format, ratio 16/9, 1/1000 sec, maximum resolution, Sharp details",urls:["https://cdn-useast1.kapwing.com/static/Igw-lake7.webp","https://cdn-useast1.kapwing.com/static/7RE-lake8.webp","https://cdn-useast1.kapwing.com/static/4v2-lake1.webp","https://cdn-useast1.kapwing.com/static/cj7-lake2.webp","https://cdn-useast1.kapwing.com/static/SVX-lake3.webp","https://cdn-useast1.kapwing.com/static/76Z-lake0.webp","https://cdn-useast1.kapwing.com/static/hF8-lake5.webp","https://cdn-useast1.kapwing.com/static/eaK-lake6.webp","https://cdn-useast1.kapwing.com/static/u6h-lake4.webp","https://cdn-useast1.kapwing.com/static/1J3-lake-b.webp","https://cdn-useast1.kapwing.com/static/ycT-lake-c.webp","https://cdn-useast1.kapwing.com/static/3bW-lake-a.webp","https://cdn-useast1.kapwing.com/static/SB5-lake-d.webp"]},{label:"race car",query:"Synthwave halloween formula 1 car racing on a night road in Singapore",urls:["https://cdn-useast1.kapwing.com/static/h6E-racecar1.webp","https://cdn-useast1.kapwing.com/static/6F1-racecar6.webp","https://cdn-useast1.kapwing.com/static/4bj-racecar5.webp","https://cdn-useast1.kapwing.com/static/ig7-racecar3.webp","https://cdn-useast1.kapwing.com/static/zQU-racecar4.webp","https://cdn-useast1.kapwing.com/static/Izb-racecar2.webp","https://cdn-useast1.kapwing.com/static/nnD-racecar0.webp","https://cdn-useast1.kapwing.com/static/Dt3-racecar10.webp","https://cdn-useast1.kapwing.com/static/ZtU-racecar7.webp","https://cdn-useast1.kapwing.com/static/t6c-racecar9.webp","https://cdn-useast1.kapwing.com/static/c77-racecar11.webp","https://cdn-useast1.kapwing.com/static/ncw-racecar8.webp"]},{label:"modern home",query:"hyper realistic photo of a high end futuristic single-level house where walls are made of windows, light coming through the window, mid century modern style, cinematic lighting",urls:["https://cdn-useast1.kapwing.com/static/rRr-home2.webp","https://cdn-useast1.kapwing.com/static/Fih-house8.webp","https://cdn-useast1.kapwing.com/static/Z25-home7.webp","https://cdn-useast1.kapwing.com/static/CVq-home.webp","https://cdn-useast1.kapwing.com/static/3YG-home6.webp","https://cdn-useast1.kapwing.com/static/KlA-home5.webp","https://cdn-useast1.kapwing.com/static/5q5-home4.webp","https://cdn-useast1.kapwing.com/static/SaH-house9.webp","https://cdn-useast1.kapwing.com/static/PC4-house10.webp","https://cdn-useast1.kapwing.com/static/R9g-house7.webp","https://cdn-useast1.kapwing.com/static/KJO-home4.webp","https://cdn-useast1.kapwing.com/static/MfH-home1.webp","https://cdn-useast1.kapwing.com/static/AgA-home3.webp"]}],Fne=_.memo((({onClose:e,setCancelFn:t,enforceSignIn:o})=>{const a=wQ(),i=il(),{topic:s,images:n=[]}=tl((e=>({topic:e.studioLocal.ai.imageGeneratorPrompt||"",images:e.studioLocal.ai.imageGeneratorResults})),ol),[r,l]=h.useState(!1),[d,c]=h.useState(!1),u=bW(),m=NU(Bl.GENERATE_IMAGES),[p,g]=h.useState(!1),f=h.useCallback((e=>{if("generate-image"!==e.type)return;const{prompt:t}=e;i(cw({imageGeneratorPrompt:t})),g(!0)}),[i]),y=h.useCallback((async()=>{l(!0);try{Fm(ym.STARTED_IMAGE_GENERATOR,{Topic:s,"Used Past Prompt":p});const e=new CH;t((()=>()=>{e.cancel(),i(cw({imageGeneratorPrompt:""}))}));const o=await Pne(s);if(Dne("generatedImages"),e.cancelled)return void l(!1);o.length?i(cw({imageGeneratorResults:o.map((e=>e.url))})):i(wl({type:"warning",description:"Unable to generate image."}))}catch(IGe){if(IGe instanceof Rne)i(wl({type:"warning",description:IGe.message}));else{const{message:t}=ph(IGe);Fm(ym.IMAGE_GENERATOR_FAILED,{Error:t}),mh({description:"Received an unexpected Dall-E response.",error:IGe})}}l(!1)}),[s,p,t,i]),v=u((()=>y()),{action:Vl.GENERATE_IMAGES}),_=a((()=>{const e=Lne.find((e=>e.query===s));if(e){const{urls:t}=e,o=t.sort((()=>.5-Math.random())).slice(0,4);i(cw({imageGeneratorResults:o}))}else v()}),{[Oc.AI_GENERATE]:1}),b=h.useCallback((e=>{i(cw({imageGeneratorPrompt:e}))}),[i]);return w.jsxs("div",{className:One.wrapper,children:[w.jsxs("div",{className:One.controlsSmall,children:[w.jsxs("div",{children:[w.jsx(Ane,{title:"Topic",tab:one.Image,className:One.textarea,rows:4,placeholder:"Describe your image...",value:s,setPrompt:b,type:"generate-image",setPromptFromPastJob:f,promptKey:"prompt"}),w.jsxs("div",{className:One.row,children:[w.jsx("div",{className:One.label,children:"Try an example"}),w.jsx("div",{className:One.examplesWrapper,children:Lne.map((({label:e,query:t})=>w.jsx("div",{className:One.example,onClick:()=>{i(cw({imageGeneratorPrompt:t}))},children:e},e)))})]})]}),(()=>{const e=r||!s,t=Lne.some((e=>e.query===s)),a=!m&&!t;return w.jsx("div",{className:One.generateContainer,children:w.jsxs("button",{type:"button",className:[One.generateButton,e?One.disabled:""].join(" "),disabled:e,onClick:o(_),children:[w.jsx("span",{children:r?"Generating Images...":"Generate Images"}),w.jsx("span",{children:a?w.jsx(EW,{className:One.sparkle}):null})]})})})()]}),w.jsx("div",{className:One.resultsWrapper,children:r?w.jsx("div",{className:One.imagesWrapper,children:w.jsxs("div",{className:One.imagesContainer,children:[w.jsx("div",{className:One.instructions,children:w.jsx("div",{className:One.loadingInstructionsText,children:"Generating images ... please wait. This may take a minute."})}),[0,1,2,3].map((e=>w.jsx("div",{className:One.loadingImageContainer,children:w.jsx("div",{className:One.loadingImage})},e)))]})}):n&&n.length?w.jsx("div",{className:One.imagesWrapper,children:w.jsxs("div",{className:One.imagesContainer,children:[w.jsx("div",{className:One.instructions,children:d?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:One.darkLoader}),w.jsx("div",{className:One.loadingInstructionsText,children:"Adding image to project..."})]}):w.jsx("div",{className:One.loadingInstructionsText,children:"Click on an image to add it to your Kapwing project."})}),n.map((t=>w.jsx("div",{className:One.imageContainer,onClick:()=>{(async t=>{c(!0);const o={height:1024,width:1024,name:s};await LX({url:t,options:{layerProperties:o}}),i(Tp({usedGenerateImage:!0,usedGenerateImagePastPrompt:p})),c(!1),e()})(t)},children:w.jsx("img",{src:t,className:One.image,alt:s})},t)))]})}):w.jsx("div",{className:One.resultsContainer,children:w.jsxs("div",{className:One.emptyState,children:["Type a prompt to generate, and your results will appear here once the generation is complete.",w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/1IJ-SFoNenOA-image.webp",alt:"AI Generation preview",className:One.emptyStateImage})]})})})]})})),Mne=class e{constructor(t){i(this,"data",null),i(this,"topic"),i(this,"hydratedMemeSubscribers",[]),i(this,"_hydratedMemes",null),i(this,"generate",(async t=>{if(!e.isValidMemes(t))throw new Error("Invalid meme");return this.data=t,this.main()})),i(this,"subscribe",(e=>{this._hydratedMemes?e(this._hydratedMemes):this.hydratedMemeSubscribers.push(e)})),this.topic=t}set hydratedMemes(e){this._hydratedMemes=e;for(const t of this.hydratedMemeSubscribers)t(e)}static async getImageLayer({url:e,width:t,height:o},a){const{dispatch:i}=sr(),{asset:s,cmlFile:n}=await B$(e);Mz(s,n);const r=s.status===On.uploaded&&s.url||e,l=await eY(r,{source:s.status===On.uploaded?"upload":"pastedLink",position:{x:"0%",y:"20%",width:"100%",height:"80%",rotation:0},crop:{x:0,y:0,width:100,height:100},pastedUrl:e,asset_id:s._id,volume:0},{mediaInfo:{type:zl.Image,width:t,height:o}});return i(yu({assetId:s._id,mediaCacheId:oe.v4()})),i(Tp({usedGenerateMeme:!0,usedGenerateMemePastPrompt:a})),l}async getImageLayerUrl(e){const t=e.replace(/-/g," ").trim(),o=await PX(`${t} blank meme template`,{useGoogleOnly:!0});for(const i of o.google){const e=await bse.isCorsOk(i.url);if(e)return{url:i.url,width:e.width,height:e.height}}const a=o.google[0];return{url:(null==a?void 0:a.url)||"",width:500,height:500}}async main(){if(!this.data)return;const e=this.data.memes.map((async e=>{const t=await this.getImageLayerUrl(e.keyword);return{...e,...t}}));this.hydratedMemes={memes:await Promise.all(e)}}};i(Mne,"isValidMemes",(e=>{if(!e)return!1;if(!("memes"in e))return!1;for(const t of e.memes){if(!("text"in t))return!1;if(!("keyword"in t))return!1;if("string"!=typeof t.text)return!1;if("string"!=typeof t.keyword)return!1}return!0})),i(Mne,"addMemeToProject",(async(e,t)=>{const{dispatch:o}=sr(),{width:a,height:i}=e,s=1.2*i,n=Math.min(a,s),r=`${a/n}:${s/n}`,l=await Mne.getImageLayer({url:e.url,width:a,height:e.height},t),d={id:oe.v4(),backgroundColor:"rgba(-255,-255,-255,0)",color:"#000000",fontFamily:"Arial",globalAlpha:1,lineHeight:1.15,text:e.text,textAlign:"left",textShadow:"transparent",type:zl.Text,fontWeight:"normal",position:{x:"3%",y:"1%",width:"94%",height:"19%",rotation:0}};g.batch((()=>{o({type:"SHOW_STUDIO_CANVAS"}),o(lS(r)),o(Tp({usedGenerateMeme:!0,usedGenerateMemePastPrompt:t})),o(Fv({layers:[l,d]}))}))}));let Une=Mne;function Bne(e){const t=e.indexOf("{"),o=e.indexOf("["),a=e.lastIndexOf("}"),i=e.lastIndexOf("]");if(-1===t||-1===o)throw new jse(e);const s=Math.min(t,o),n=Math.max(a,i);let r=e.slice(s);return r=r.slice(0,n-s+1),r.startsWith("{")||(r=`{ "memes": ${r} }`),r=r.replace(/"$/gm,'",'),r=r.replace(/,(?!\s*?[{["'\w])/g,""),JSON.parse(r)}async function Vne(e){try{return await Yr(`/api/v2/ai/jobs/${e}`)}catch(IGe){return console.error(IGe),null}}async function Wne(e,t){const o=await async function(e){var t;try{const o=await Yr("/api/v2/ai/generate-meme",{params:{topic:e,teamId:null==(t=Hu())?void 0:t._id}});return o.succeeded?(Qr("generate_meme",{body:{topic:e,id:o.id}}).catch((e=>{console.error(e)})),o.id):(console.error(o.message),null)}catch(IGe){return console.error(IGe),null}}(e);if(!o)return null;let a=0;for(;;){if(t.cancelled)return null;const e=await Vne(o);if(t.cancelled)return null;if(!e)return null;if(a>30)throw new jse("Getting a response is taking longer than expected. Please try again later.");if("complete"===e.status)return Bne(e.memes);if("error"===e.status)throw new jse(e.error);a+=1,await new Promise((e=>setTimeout(e,4e3)))}}const Gne={wrapper:"Memes-module_wrapper_jnqKC",controls:"Memes-module_controls_7-P-E",controlsSmall:"Memes-module_controlsSmall_FZS-R",promptRow:"Memes-module_promptRow_yxeKP",charCount:"Memes-module_charCount_5bb3h",row:"Memes-module_row_5evlo",promptDropdownDiv:"Memes-module_promptDropdownDiv_1mCVo",label:"Memes-module_label_ZOX87",input:"Memes-module_input_RfhpL",textAreaWrapper:"Memes-module_textAreaWrapper_i4Xt9",textarea:"Memes-module_textarea_Si5Mx",previewWrapper:"Memes-module_previewWrapper_BvtwV",resultsWrapper:"Memes-module_resultsWrapper_dmP2Z",previewHint:"Memes-module_previewHint_SAsW0",previewContainer:"Memes-module_previewContainer_HOuct",preview:"Memes-module_preview_5Dp3L",previewBlur:"Memes-module_previewBlur_UmN8s",previewText:"Memes-module_previewText_M92vn",generateContainer:"Memes-module_generateContainer_MKu47",generateButton:"Memes-module_generateButton_G76-s",disabled:"Memes-module_disabled_YQNzu",loader:"Memes-module_loader_XBBOQ",spin:"Memes-module_spin_hjVfR",darkLoader:"Memes-module_darkLoader_asYP4",resultsContainer:"Memes-module_resultsContainer_WOjkc",emptyState:"Memes-module_emptyState_9jE87",upsellContainer:"Memes-module_upsellContainer_CWMIm",examplesWrapper:"Memes-module_examplesWrapper_Xk4hs",example:"Memes-module_example_2qVt0",typeWrapper:"Memes-module_typeWrapper_HXDAg",typeContainer:"Memes-module_typeContainer_8Vo1O",typePreviewBackground:"Memes-module_typePreviewBackground_nsBui",type:"Memes-module_type_Ij3rA",optionLabel:"Memes-module_optionLabel_iWTnq",typePreview:"Memes-module_typePreview_TBz1k",active:"Memes-module_active_h4JSW",imagesWrapper:"Memes-module_imagesWrapper_At80E",memeWrapper:"Memes-module_memeWrapper_eTIOy",meme:"Memes-module_meme_l7nFy",memeText:"Memes-module_memeText_3Lozg",loadingInstructionsText:"Memes-module_loadingInstructionsText_iS-db",imagesContainer:"Memes-module_imagesContainer_JfULW",imageContainer:"Memes-module_imageContainer_khQib",image:"Memes-module_image_7UmAP",instructions:"Memes-module_instructions_UcEyl",loadingImageContainer:"Memes-module_loadingImageContainer_n005x",loadingImage:"Memes-module_loadingImage_YAJRA",shimmer:"Memes-module_shimmer_7HKKI",form:"Memes-module_form_u-Zlr"},Hne=[{query:"studying"},{query:"watching tv"},{query:"basketball"}],$ne=_.memo((({onClose:e,setCancelFn:t,enforceSignIn:o})=>{const a=wQ(),i=il(),{topic:s,numMemesGenerated:n,previewMemes:r=[]}=tl((e=>{var t;return{topic:e.studioLocal.ai.memeGeneratorPrompt||"",numMemesGenerated:(null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedMemes)||0,previewMemes:e.studioLocal.ai.memeGeneratorResults}}),ol),[l,d]=h.useState(!1),c=bW(),u=NU(Bl.GENERATE_MEME),[m,p]=h.useState(!1),[g,f]=h.useState(!1),y=h.useCallback((async()=>{d(!0);try{const e=new CH;t((()=>()=>{e.cancel(),i(cw({memeGeneratorPrompt:""}))})),Fm(ym.STARTED_MEME_GENERATOR,{Topic:s,"Used Past Prompt":g});const o=await Wne(s,e);if(e.cancelled)return void d(!1);const a=new Une(s);a.subscribe((e=>{i(cw({memeGeneratorResults:e.memes}))})),await a.generate(o),Dne("generatedMemes")}catch(IGe){mh({description:"Received an unexpected GPT response.",error:IGe})}d(!1)}),[t,s,g,i]),v=h.useCallback((e=>{if("generate-memes"!==e.type)return;const{topic:t}=e;i(cw({memeGeneratorPrompt:t})),f(!0)}),[i]),_=()=>{if(u)return null;const e=Math.max(2-n,0);if(e>1)return null;const t=Lse(Ose.MEME,e);return w.jsx("div",{className:Gne.upsellContainer,children:w.jsx(kse,{warning:t,action:Vl.GENERARATE_MEME,buttonText:"Upgrade"})})},b=h.useCallback((e=>{i(cw({memeGeneratorPrompt:e}))}),[i]);return w.jsxs("div",{className:Gne.wrapper,children:[w.jsx("div",{className:Gne.controlsSmall,children:w.jsxs("form",{className:Gne.form,onSubmit:e=>{e.preventDefault();const t=c((()=>y()),{action:Vl.GENERARATE_MEME,if:n>=2});return o(a(t,{[Oc.AI_GENERATE]:1}))()},children:[w.jsxs("div",{children:[w.jsx(Ane,{title:"Make memes about:",tab:one.Meme,placeholder:"Generate memes about...",value:s,setPrompt:b,type:"generate-memes",setPromptFromPastJob:v,promptKey:"topic"}),w.jsxs("div",{className:Gne.row,children:[w.jsx("div",{className:Gne.label,children:"Try an example"}),w.jsx("div",{className:Gne.examplesWrapper,children:Hne.map((({query:e})=>w.jsx("div",{className:Gne.example,onClick:()=>{i(cw({memeGeneratorPrompt:e}))},children:e},e)))})]})]}),(()=>{const e=l?"Generating memes ...":r.length?"Generate more memes":"Generate memes",t=l||!s;return w.jsxs("div",{className:Gne.generateContainer,children:[_(),w.jsx("button",{className:[Gne.generateButton,t&&Gne.disabled].join(" "),type:"submit",disabled:t,children:e})]})})()]})}),w.jsx("div",{className:Gne.resultsWrapper,children:l?w.jsx("div",{className:Gne.imagesWrapper,children:w.jsxs("div",{className:Gne.imagesContainer,children:[w.jsx("div",{className:Gne.instructions,children:w.jsx("div",{className:Gne.loadingInstructionsText,children:"Generating memes ... please wait"})}),[0,1,2,3].map((e=>w.jsx("div",{className:Gne.loadingImageContainer,children:w.jsx("div",{className:Gne.loadingImage})},e)))]})}):r&&r.length?w.jsx("div",{className:Gne.imagesWrapper,children:w.jsxs("div",{className:Gne.imagesContainer,children:[w.jsx("div",{className:Gne.instructions,children:m?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:Gne.darkLoader}),w.jsx("div",{className:Gne.loadingInstructionsText,children:"Adding meme to project..."})]}):w.jsx("div",{className:Gne.loadingInstructionsText,children:"Click on an meme to add it to your Kapwing project."})}),r.map((t=>w.jsx("div",{className:Gne.memeWrapper,onClick:()=>{p(!0),Une.addMemeToProject(t,g).then((()=>{p(!1),e()}))},children:w.jsxs("div",{className:Gne.meme,children:[w.jsx("div",{className:Gne.memeText,children:t.text}),w.jsx("div",{className:Gne.imageContainer,children:w.jsx("img",{src:t.url,className:Gne.image,alt:t.keyword})})]})},t.text)))]})}):w.jsx("div",{className:Gne.resultsContainer,children:w.jsx("div",{className:Gne.emptyState,children:"Type a prompt to generate, and your memes will appear here once the generation is complete."})})})]})})),Kne="Script-module_wrapper_VdaDT",zne="Script-module_controlsSmall_Fbh9e",Yne="Script-module_row_rsLcI",Jne="Script-module_resultsWrapper_DWvlc",qne="Script-module_generateContainer_ANky8",Xne="Script-module_generateButton_XOh4B",Qne="Script-module_disabled_dXtGV",Zne="Script-module_resultsContainer_-Cead",ere="Script-module_emptyState_pBmbF",tre="Script-module_upsellContainer_oWODb",ore="Script-module_scriptLoading_csJvA",are="Script-module_script_oeAeM",ire="Script-module_scriptContainer_tc--Z",sre="Script-module_resultButtonsContainer_O9yHz",nre="Script-module_openTeleprompter_E3yqw",rre="Script-module_scriptToVideoButton_Wys0k",lre="Script-module_regenerateWrapper_Fe28l",dre="Script-module_regenerateHeader_IUqL-",cre="Script-module_regenerateCancel_eAqPt",ure="Script-module_descriptorRow_b9zQq",mre="Script-module_descriptorButtons_gDATg",pre="Script-module_descriptor_HjRq1",hre="Script-module_selectedDescriptor_kY3Xy",gre="Script-module_regenerateConfirmButton_vOo7C",fre=[{name:qse.TikTok,icon:w.jsx(go,{})},{name:qse.Youtube,icon:w.jsx(fo,{})},{name:qse.Reels,icon:w.jsx(yo,{})},{name:qse.Shorts,icon:w.jsx(vo,{})}];function yre({selectedPlatform:e,setSelectedPlatform:t}){return w.jsxs("div",{children:[w.jsx("div",{className:Mse,children:"Target platform"}),w.jsx("div",{className:Use,children:fre.map((({name:o,icon:a})=>{let i=Vse;return o===e&&(i+=` ${Gse}`),w.jsxs("div",{className:Bse,onClick:()=>{t(o)},children:[w.jsx("div",{className:i,children:w.jsx("div",{className:Hse,children:a})}),w.jsx("div",{className:$se,children:o})]},o)}))})]})}async function vre(e){try{return await Yr(`/api/v2/ai/jobs/${e}`)}catch(IGe){return console.error(IGe),null}}async function _re(e,t,o){const a=await async function(e,t){var o;const{selectedSize:a,selectedLanguage:i,selectedVoice:s,selectedPreset:n,selectedDuration:r,selectedPlatform:l,tab:d}=t;try{const t=await Yr("/api/v2/ai/generate-script",{params:{idea:e,platform:l,duration:r,teamId:null==(o=Hu())?void 0:o._id,selectedSize:JSON.stringify(a),selectedLanguage:JSON.stringify(i),selectedVoice:JSON.stringify(s),selectedPreset:JSON.stringify(n),tab:d}});return t.succeeded?(Qr("generate_script",{body:{id:t.id}}).catch((e=>{console.error(e)})),t.id):(console.error(t.message),null)}catch(IGe){return console.error(IGe),null}}(e,o);if(!a)throw new Error("Failed to initialize script generation");let i=0;for(;;){if(t.cancelled)return null;const e=await vre(a);if(t.cancelled)return null;if(!e)return null;if(i>30)throw new jse("Getting a response is taking longer than expected. Please try again later.");if("complete"===e.status)return e.script;if("error"===e.status)throw new Error(e.error);i+=1,await new Promise((e=>setTimeout(e,4e3)))}}const wre=async e=>{const{setCancelFn:t,scriptToVideo:o,topic:a}=e,{dispatch:i}=sr();try{const s=new CH;t((()=>()=>{s.cancel(),i(cw({scriptGeneratorPrompt:""})),i(cw({videoGeneratorPrompt:""}))}));const n=await _re(a,s,e);if(s.cancelled)return;if(!n)return;return i(cw({scriptGeneratorResults:n})),o&&i(cw({scriptToVideoPrompt:n})),n}catch(IGe){console.error({e:IGe}),mh({description:"Received an unexpected GPT response.",error:IGe})}};async function bre(e){try{return await Yr(`/api/v2/ai/jobs/${e}`)}catch(IGe){return console.error(IGe),null}}async function Tre(e,t,o,a){const i=await async function(e,t,o){var a;try{const i=await Yr("/api/v2/ai/regenerate-script",{params:{topic:e,duration:t,descriptor:o,teamId:null==(a=Hu())?void 0:a._id}});return i.succeeded?(Qr("regenerate_script",{body:{id:i.id}}).catch((e=>{console.error(e)})),i.id):(console.error(i.message),null)}catch(IGe){return console.error(IGe),null}}(e,t,o);if(!i)throw new Error("Failed to initialize script regeneration");let s=0;for(;;){if(a.cancelled)return null;const e=await bre(i);if(a.cancelled)return null;if(!e)return null;if(s>30)throw new jse("Getting a response is taking longer than expected. Please try again later.");if("complete"===e.status)return e.script;if("error"===e.status)throw new Error(e.error);s+=1,await new Promise((e=>setTimeout(e,4e3)))}}const xre=["weird facts","lunch recipes","summer outfits"],Sre=["Formal","Casual","Funny","Informative","Creative"],Ere=_.memo((({setCancelFn:e,enforceSignIn:t})=>{const o=wQ(),a=il(),{topic:i,script:s}=tl((e=>({topic:e.studioLocal.ai.scriptGeneratorPrompt||"",script:e.studioLocal.ai.scriptGeneratorResults})),ol),[n,r]=h.useState(!1),[l,d]=h.useState(30),[c,u]=h.useState(fre[0].name),[m,p]=h.useState(""),[g,f]=h.useState(!0),[y,v]=h.useState(!1),_=bW(),b=NU(Bl.GENERATE_SCRIPT),{setTeleprompterOpen:T,setTeleprompterText:x}=Aq(),S=tl((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedScripts}))||0,E=h.useCallback((async()=>{v(!0),Fm(ym.STARTED_SCRIPT_GENERATOR,{Topic:i,Platform:c,Duration:l,Tab:one.Script,"Used Past Prompt":n});try{await wre({topic:i,tab:one.Script,selectedPlatform:c,selectedDuration:l,setCancelFn:e,scriptToVideo:!1}),Dne("generatedScripts")}catch(IGe){mh({description:"An error occurred while generating your script.",error:IGe})}v(!1)}),[l,c,e,i,n]),I=h.useCallback((async()=>{if(v(!0),i){Fm(ym.STARTED_SCRIPT_REGENERATION,{Topic:i,Descriptor:m});try{await(async(e,t,o,a)=>{const{dispatch:i}=sr();try{const s=new CH;a((()=>()=>s.cancel()));const n=await Tre(e,t,o,s);if(s.cancelled)return;if(!n)return;return i(cw({scriptGeneratorResults:n})),n}catch(IGe){console.error({e:IGe}),mh({description:"Received an unexpected GPT response.",error:IGe})}})(i,l,m,e)}catch(IGe){mh({description:"An error occurred while regenerating your script.",error:IGe})}}v(!1)}),[i,m,l,e]),C=o(_((()=>E()),{action:Vl.GENERATE_SCRIPT,if:S>=2}),{[Oc.AI_GENERATE]:1}),k=()=>{if(b)return null;const e=Math.max(2-S,0);if(e>1)return null;const t=Lse(Ose.SCRIPT,e);return w.jsx("div",{className:tre,children:w.jsx(kse,{warning:t,action:Vl.GENERATE_SCRIPT,buttonText:"Upgrade"})})},A=()=>{a(cw({scriptToVideoPrompt:s})),a(cw({selectedTab:one.ScriptToVideo}))},j=h.useCallback((e=>{if("generate-script"!==e.type)return;r(!0);const{duration:t,platform:o,topic:i}=e;o&&u(o),t&&d(e.duration),a(cw({scriptGeneratorPrompt:i}))}),[a]);return w.jsxs("div",{className:Kne,children:[w.jsxs("div",{className:zne,children:[w.jsxs("div",{children:[w.jsx(Ane,{title:"Make a video script about:",placeholder:"Generate a video script about...",value:i,tab:one.Script,setPrompt:function(e){a(cw({scriptGeneratorPrompt:e}))},setPromptFromPastJob:j,promptKey:"topic",type:"generate-script",maxCharLength:1e3,requirePastJobsToMatchTab:!0,samplePrompts:xre}),w.jsx("div",{className:Yne,children:w.jsx(Yse,{label:"Approximate Script Duration",selectedDuration:l,setSelectedDuration:d})}),w.jsx("div",{className:Yne,children:w.jsx(yre,{selectedPlatform:c,setSelectedPlatform:u})})]}),(()=>{const e=!i||y||i.length>1e3;return w.jsxs("div",{className:qne,children:[k(),w.jsx("button",{type:"button",className:mt(Xne,{[Qne]:e}),disabled:e,onClick:t(C),children:y?"Generating Script...":"Generate Script"})]})})()]}),w.jsx("div",{className:Jne,children:s?w.jsxs("div",{className:ire,children:[w.jsxs("div",{className:sre,children:[w.jsx("button",{className:mt(nre,{[Qne]:y}),type:"button",onClick:()=>{x(s),T(!0,"AI Script Generator"),eE("studio/editor/record"),eE("/studio/editor/overlay/record/screen",{autoOn:!0})},children:"Open In Teleprompter"}),w.jsx("button",{className:mt(rre,{[Qne]:y}),type:"button",onClick:A,children:"Generate video from script"})]}),y?w.jsx("div",{className:ore}):w.jsxs(w.Fragment,{children:[w.jsx("div",{contentEditable:!0,suppressContentEditableWarning:!0,onBlur:e=>{const{target:t}=e;t instanceof HTMLDivElement&&a(cw({scriptGeneratorResults:t.textContent||""}))},className:are,children:s}),g?w.jsxs("div",{className:lre,children:[w.jsx("div",{className:cre,onClick:()=>f(!1),children:w.jsx(ve,{})}),w.jsx("div",{className:dre,children:"Regenerate a script that is more..."}),w.jsxs("div",{className:ure,children:[w.jsx("div",{className:mre,children:Sre.map((e=>w.jsx("div",{className:m===e?hre:pre,onClick:()=>p(e),children:e},e)))}),w.jsx("div",{className:mt(gre,{[Qne]:""===m}),onClick:()=>I(),children:"Go"})]})]}):w.jsx("button",{className:nre,type:"button",onClick:()=>{f(!0)},children:"Regenerate Script"})]})]}):y?w.jsxs("div",{className:ire,children:[w.jsx("div",{className:ere,children:"Generating script... please wait"}),w.jsx("div",{className:ore})]}):w.jsx("div",{className:Zne,children:w.jsx("div",{className:ere,children:"Type a prompt to generate, and your script will appear here once the generation is complete."})})})]})})),Ire={gender:"FEMALE",label:"Glinda (Female)",name:"eleven-labs-glinda",languageCode:"en-US",sampleURL:"https://cdn-useast1.kapwing.com/static/Q70-ElevenLabs_2023-11-28T17_36_10_Glinda_pre_s50_sb75_se0_b_m2.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},Cre={"English (US)":[{gender:"FEMALE",label:"Bethany (Female)",name:"en-US-Neural2-G",languageCode:"en-US",sampleURL:"https://cdn-useast1.kapwing.com/static/40O-English_US_Female.mp3"},{gender:"MALE",label:"Jacob (Male)",name:"en-US-Neural2-J",languageCode:"en-US",sampleURL:"https://cdn-useast1.kapwing.com/static/YOo-English_US_Male.mp3"},Ire,{gender:"MALE",label:"Adam (Male)",name:"eleven-labs-adam",languageCode:"en-US",sampleURL:"https://cdn-useast1.kapwing.com/static/JwY-ElevenLabsAdam.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"},{gender:"FEMALE",label:"Matilda (Female)",name:"eleven-labs-matilda",languageCode:"en-US",sampleURL:"https://cdn-useast1.kapwing.com/static/EBv-ElevenLabsMatilda.mp3",elevenLabsId:"XrExE9yKIg1WjnnlVkGX"},{gender:"MALE",label:"Josh (Male)",name:"eleven-labs-josh",languageCode:"en-US",sampleURL:"https://cdn-useast1.kapwing.com/static/BN6-ElevenLabsJosh.mp3",elevenLabsId:"TxGEqnHWrfWFTfGW9XjX"}],"English (UK)":[{gender:"FEMALE",label:"Ella (Female)",name:"en-GB-Neural2-A",languageCode:"en-GB",sampleURL:"https://cdn-useast1.kapwing.com/static/xGG-English_UK_Female.mp3"},{gender:"MALE",label:"Benjamin (Male)",name:"en-GB-Neural2-B",languageCode:"en-GB",sampleURL:"https://cdn-useast1.kapwing.com/static/gzP-English_UK_Male.mp3"},{gender:"FEMALE",label:"Dorothy (Female)",name:"eleven-labs-dorothy",languageCode:"en-GB",sampleURL:"https://cdn-useast1.kapwing.com/static/MIt-ElevenLabsDorothy.mp3",elevenLabsId:"ThT5KcBeYPX3keUQqHPh"},{gender:"MALE",label:"Daniel (Male)",name:"eleven-labs-daniel",languageCode:"en-GB",sampleURL:"https://cdn-useast1.kapwing.com/static/RtU-ElevenLabsDaniel.mp3",elevenLabsId:"onwK4e9ZLuTAKqWW03F9"}],"English (Australia)":[{gender:"FEMALE",label:"Mia (Female)",name:"en-AU-News-E",languageCode:"en-AU",sampleURL:"https://cdn-useast1.kapwing.com/static/BXD-English_AU_Female.mp3"},{gender:"MALE",label:"Levi (Male)",name:"en-AU-News-G",languageCode:"en-AU",sampleURL:"https://cdn-useast1.kapwing.com/static/ZQD-English_AU_Male.mp3"},{gender:"FEMALE",label:"Phoebe (Female)",name:"eleven-labs-phoebe",languageCode:"en-AU",sampleURL:"https://cdn-useast1.kapwing.com/static/_KS-ElevenLabsPhoebe.mp3",elevenLabsId:"osbVljxvZFJtloRtBf41"},{gender:"MALE",label:"Charlie (Male)",name:"eleven-labs-charlie",languageCode:"en-AU",sampleURL:"https://cdn-useast1.kapwing.com/static/_gY-ElevenLabsCharlie.mp3",elevenLabsId:"IKne3meq5aSn9XLyUdCD"}],"Arabic (Multi-Region)":[{gender:"FEMALE",label:"زَيْنَب (Female)",name:"ar-XA-Wavenet-D",languageCode:"ar-XA",sampleURL:"https://cdn-useast1.kapwing.com/static/W65-Arabic_Female.mp3"},{gender:"MALE",label:"أَحْمَد (Male)",name:"ar-XA-Wavenet-B",languageCode:"ar-XA",sampleURL:"https://cdn-useast1.kapwing.com/static/eGZ-Arabic_Male.mp3"},{gender:"FEMALE",label:"جَنَى (Female)",name:"eleven-labs-multilingual-female-arabic",languageCode:"ar-XA",sampleURL:"https://cdn-useast1.kapwing.com/static/K2c-Multilingual_Arabic_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"حَسَن (Male)",name:"eleven-labs-multilingual-male-arabic",languageCode:"ar-XA",sampleURL:"https://cdn-useast1.kapwing.com/static/K58-Multilingual_Arabic_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],"Chinese (Mandarin)":[{gender:"FEMALE",label:"晴瑾 (Female)",name:"cmn-CN-Wavenet-A",languageCode:"cmn-CN",sampleURL:"https://cdn-useast1.kapwing.com/static/Edg-Chinese_Female.mp3"},{gender:"MALE",label:"浩宇 (Male)",name:"cmn-CN-Wavenet-B",languageCode:"cmn-CN",sampleURL:"https://cdn-useast1.kapwing.com/static/Vo8-Chinese_Male.mp3"}],Czech:[{gender:"FEMALE",label:"Lenka (Female)",name:"cs-CZ-Wavenet-A",languageCode:"cs-CZ",sampleURL:"https://cdn-useast1.kapwing.com/static/8g2-Czech_Female.mp3"}],Danish:[{gender:"FEMALE",label:"Clara (Female)",name:"da-DK-Wavenet-A",languageCode:"da-DK",sampleURL:"https://cdn-useast1.kapwing.com/static/jh9-Danish_Female.mp3"},{gender:"MALE",label:"Mathias (Male)",name:"da-DK-Wavenet-C",languageCode:"da-DK",sampleURL:"https://cdn-useast1.kapwing.com/static/LE6-Danish_Male.mp3"}],Dutch:[{gender:"FEMALE",label:"Sara (Female)",name:"nl-NL-Wavenet-E",languageCode:"nl-NL",sampleURL:"https://cdn-useast1.kapwing.com/static/Ne8-Dutch_Female.mp3"},{gender:"MALE",label:"Noah (Male)",name:"nl-NL-Wavenet-C",languageCode:"nl-NL",sampleURL:"https://cdn-useast1.kapwing.com/static/IkX-Dutch_Male.mp3"}],"Filipino (Tagalog)":[{gender:"FEMALE",label:"Sofia (Female)",name:"fil-ph-Neural2-A",languageCode:"fil-PH",sampleURL:"https://cdn-useast1.kapwing.com/static/idX-Filipino_Female.mp3"},{gender:"MALE",label:"Benjie (Male)",name:"fil-ph-Neural2-D",languageCode:"fil-PH",sampleURL:"https://cdn-useast1.kapwing.com/static/FlU-Filipino_Male.mp3"}],French:[{gender:"FEMALE",label:"Elise (Female)",name:"fr-FR-Neural2-A",languageCode:"fr-FR",sampleURL:"https://cdn-useast1.kapwing.com/static/RAK-French_Female-(1).mp3"},{gender:"MALE",label:"Louis (Male)",name:"fr-FR-Neural2-B",languageCode:"fr-FR",sampleURL:"https://cdn-useast1.kapwing.com/static/88b-French_Male.mp3"},{gender:"FEMALE",label:"Marie (Female)",name:"eleven-labs-multilingual-female-french",languageCode:"fr-FR",sampleURL:"https://cdn-useast1.kapwing.com/static/jdK-Multilingual_French_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"Julien (Male)",name:"eleven-labs-multilingual-male-french",languageCode:"fr-FR",sampleURL:"https://cdn-useast1.kapwing.com/static/Mxd-Multilingual_French_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],German:[{gender:"FEMALE",label:"Elisabeth (Female)",name:"de-DE-Neural2-F",languageCode:"de-DE",sampleURL:"https://cdn-useast1.kapwing.com/static/5zW-German_Female.mp3"},{gender:"MALE",label:"Max (Male)",name:"de-DE-Neural2-D",languageCode:"de-DE",sampleURL:"https://cdn-useast1.kapwing.com/static/HAB-German_Male.mp3"},{gender:"FEMALE",label:"Emma (Female)",name:"eleven-labs-multilingual-female-german",languageCode:"de-DE",sampleURL:"https://cdn-useast1.kapwing.com/static/gdh-Multilingual_German_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"Felix (Male)",name:"eleven-labs-multilingual-male-german",languageCode:"de-DE",sampleURL:"https://cdn-useast1.kapwing.com/static/RH8-Multilingual_German_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],Greek:[{gender:"FEMALE",label:"Rhea (Female)",name:"el-GR-Wavenet-A",languageCode:"el-GR",sampleURL:"https://cdn-useast1.kapwing.com/static/y44-Greek_Female.mp3"}],Hebrew:[{gender:"FEMALE",label:"לֵאָה (Female)",name:"he-IL-Wavenet-A",languageCode:"he-IL",sampleURL:"https://cdn-useast1.kapwing.com/static/16Z-Hebrew_Female.mp3"},{gender:"MALE",label:"רוֹן (Male)",name:"he-IL-Wavenet-B",languageCode:"he-IL",sampleURL:"https://cdn-useast1.kapwing.com/static/wsu-Hebrew_Male-(1).mp3"}],Hindi:[{gender:"FEMALE",label:"साना (Female)",name:"hi-IN-Neural2-D",languageCode:"hi-IN",sampleURL:"https://cdn-useast1.kapwing.com/static/_RM-Hindi_Female.mp3"},{gender:"MALE",label:"श्रय (Male)",name:"hi-IN-Neural2-C",languageCode:"hi-IN",sampleURL:"https://cdn-useast1.kapwing.com/static/9tD-Hindi_Male.mp3"},{gender:"FEMALE",label:"मीरा (Female)",name:"eleven-labs-multilingual-female-hindi",languageCode:"hi-IN",sampleURL:"https://cdn-useast1.kapwing.com/static/1Hi-Multilingual_Hindi_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"पार्थ (Male)",name:"eleven-labs-multilingual-male-hindi",languageCode:"hi-IN",sampleURL:"https://cdn-useast1.kapwing.com/static/7Lw-Multilingual_Hindi_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],Hungarian:[{gender:"FEMALE",label:"Hanna (Female)",name:"hu-HU-Wavenet-A",languageCode:"hu-HU",sampleURL:"https://cdn-useast1.kapwing.com/static/e3L-Hungarian_Female.mp3"}],Indonesian:[{gender:"MALE",label:"Taman (Male)",name:"id-ID-Wavenet-B",languageCode:"id-ID",sampleURL:"https://cdn-useast1.kapwing.com/static/TKJ-Indonesian_Male.mp3"},{gender:"FEMALE",label:"Nova (Female)",name:"id-ID-Wavenet-A",languageCode:"id-ID",sampleURL:"https://cdn-useast1.kapwing.com/static/RUz-Indonesian_Female.mp3"}],Italian:[{gender:"FEMALE",label:"Lucia (Female)",name:"it-IT-Neural2-A",languageCode:"it-IT",sampleURL:"https://cdn-useast1.kapwing.com/static/yux-Italian_Female.mp3"},{gender:"MALE",label:"Antonio (Male)",name:"it-IT-Neural2-C",languageCode:"it-IT",sampleURL:"https://cdn-useast1.kapwing.com/static/TO_-Italian_Male.mp3"},{gender:"FEMALE",label:"Bianca (Female)",name:"eleven-labs-multilingual-female-italian",languageCode:"it-IT",sampleURL:"https://cdn-useast1.kapwing.com/static/D3f-Multilingual_Italian_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"Marco (Male)",name:"eleven-labs-multilingual-male-italian",languageCode:"it-IT",sampleURL:"https://cdn-useast1.kapwing.com/static/T4l-Multilingual_Italian_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],Japanese:[{gender:"FEMALE",label:"芽依 (Female)",name:"ja-JP-Neural2-B",languageCode:"ja-JP",sampleURL:"https://cdn-useast1.kapwing.com/static/eRF-Japanese_Female.mp3"},{gender:"MALE",label:"大翔 (Male)",name:"ja-JP-Neural2-C",languageCode:"ja-JP",sampleURL:"https://cdn-useast1.kapwing.com/static/qmu-Japanese_Male.mp3"}],Norwegian:[{gender:"FEMALE",label:"Astrid (Female)",name:"nb-NO-Wavenet-E",languageCode:"nb-NO",sampleURL:"https://cdn-useast1.kapwing.com/static/0uW-Norwegian_Female.mp4"},{gender:"MALE",label:"Erik (Male)",name:"nb-NO-Wavenet-D",languageCode:"nb-NO",sampleURL:"https://cdn-useast1.kapwing.com/static/kTb-Norwegian_Male.mp4"}],Polish:[{gender:"FEMALE",label:"Julia (Female)",name:"pl-PL-Wavenet-A",languageCode:"pl-PL",sampleURL:"https://cdn-useast1.kapwing.com/static/4sS-Polish_Female.mp3"},{gender:"MALE",label:"Filip (Male)",name:"pl-PL-Wavenet-B",languageCode:"pl-PL",sampleURL:"https://cdn-useast1.kapwing.com/static/ylW-Polish_Male.mp3"},{gender:"FEMALE",label:"Celina (Female)",name:"eleven-labs-multilingual-female-polish",languageCode:"pl-PL",sampleURL:"https://cdn-useast1.kapwing.com/static/W6P-ElevenLabsPolishFemale.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"Antoni (Male)",name:"eleven-labs-multilingual-male-polish",languageCode:"pl-PL",sampleURL:"https://cdn-useast1.kapwing.com/static/oc_-ElevenLabsPolishMale.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],Portuguese:[{gender:"FEMALE",label:"Francisca (Female)",name:"pt-BR-Neural2-A",languageCode:"pt-BR",sampleURL:"https://cdn-useast1.kapwing.com/static/XBm-Portuguese_Female.mp3"},{gender:"MALE",label:"Pedro (Male)",name:"pt-BR-Neural2-B",languageCode:"pt-BR",sampleURL:"https://cdn-useast1.kapwing.com/static/kJK-Portuguese_Male.mp3"},{gender:"FEMALE",label:"Catarina (Female)",name:"eleven-labs-multilingual-female-portuguese",languageCode:"pt-BR",sampleURL:"https://cdn-useast1.kapwing.com/static/oqy-Multilingual_Portuguese_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"Diogo (Male)",name:"eleven-labs-multilingual-male-portuguese",languageCode:"pt-BR",sampleURL:"https://cdn-useast1.kapwing.com/static/AC6-Multilingual_Portuguese_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],"Spanish (Spain)":[{gender:"FEMALE",label:"Elena (Female)",name:"es-ES-Neural2-C",languageCode:"es-ES",sampleURL:"https://cdn-useast1.kapwing.com/static/nqk-Spanish_Spain_Female.mp3"},{gender:"MALE",label:"Hugo (Male)",name:"es-ES-Neural2-F",languageCode:"es-ES",sampleURL:"https://cdn-useast1.kapwing.com/static/L8O-Spanish_Spain_Male.mp3"},{gender:"FEMALE",label:"Alejandra (Female)",name:"eleven-labs-multilingual-female-spanish-spain",languageCode:"es-ES",sampleURL:"https://cdn-useast1.kapwing.com/static/m9H-Multilingual_Spanish_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"Javier (Male)",name:"eleven-labs-multilingual-male-spanish-spain",languageCode:"es-ES",sampleURL:"https://cdn-useast1.kapwing.com/static/ghs-Multilingual_Spanish_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],"Spanish (Mexico)":[{gender:"FEMALE",label:"Ana (Female)",name:"es-US-Neural2-A",languageCode:"es-US",sampleURL:"https://cdn-useast1.kapwing.com/static/kWb-Spanish_Mexico_Female.mp3"},{gender:"MALE",label:"Emilio (Male)",name:"es-US-Neural2-B",languageCode:"es-US",sampleURL:"https://cdn-useast1.kapwing.com/static/g-U-Spanish_Mexico_Male.mp3"},{gender:"FEMALE",label:"Gabriela (Female)",name:"eleven-labs-multilingual-female-spanish",languageCode:"es-US",sampleURL:"https://cdn-useast1.kapwing.com/static/m9H-Multilingual_Spanish_Female.mp3",elevenLabsId:"z9fAnlkpzviPz146aGWa"},{gender:"MALE",label:"Luis (Male)",name:"eleven-labs-multilingual-male-spanish-mexico",languageCode:"es-US",sampleURL:"https://cdn-useast1.kapwing.com/static/ghs-Multilingual_Spanish_Male.mp3",elevenLabsId:"pNInz6obpgDQGcFmaJgB"}],Swedish:[{gender:"FEMALE",label:"Louisa (Female)",name:"sv-SE-Wavenet-D",languageCode:"sv-SE",sampleURL:"https://cdn-useast1.kapwing.com/static/_Va-Swedish-Female.mp3"},{gender:"MALE",label:"Oscar (Male)",name:"sv-SE-Wavenet-E",languageCode:"sv-SE",sampleURL:"https://cdn-useast1.kapwing.com/static/XM0-Swedish_Male.mp3"}]},kre={"English (US)":"https://cdn-useast1.kapwing.com/static/OF_-us-flag.webp","English (UK)":"https://cdn-useast1.kapwing.com/static/bTA-uk-flag.webp","English (Australia)":"https://cdn-useast1.kapwing.com/static/Pe0-as-flag.webp","Arabic (Multi-Region)":"https://cdn-useast1.kapwing.com/static/j7k-eg-flag.webp","Chinese (Mandarin)":"https://cdn-useast1.kapwing.com/static/Pjq-ch-flag.webp",Czech:"https://cdn-useast1.kapwing.com/static/fET-ez-flag.webp",Danish:"https://cdn-useast1.kapwing.com/static/OLP-da-flag.webp",Dutch:"https://cdn-useast1.kapwing.com/static/P9E-nl-flag.webp","Filipino (Tagalog)":"https://cdn-useast1.kapwing.com/static/jT3-rp-flag.webp",French:"https://cdn-useast1.kapwing.com/static/tSu-fr-flag.webp",German:"https://cdn-useast1.kapwing.com/static/r0J-gm-flag.webp",Greek:"https://cdn-useast1.kapwing.com/static/i9a-gr-flag.webp",Hebrew:"https://cdn-useast1.kapwing.com/static/TYM-is-flag.webp",Hindi:"https://cdn-useast1.kapwing.com/static/cAt-in-flag.webp",Hungarian:"https://cdn-useast1.kapwing.com/static/SCa-hu-flag.webp",Indonesian:"https://cdn-useast1.kapwing.com/static/JzI-id-flag.webp",Italian:"https://cdn-useast1.kapwing.com/static/-ob-it-flag.webp",Japanese:"https://cdn-useast1.kapwing.com/static/Qe6-ja-flag.webp",Norwegian:"https://cdn-useast1.kapwing.com/static/3uF-no-flag.webp",Polish:"https://cdn-useast1.kapwing.com/static/ILb-pl-flag.webp",Portuguese:"https://cdn-useast1.kapwing.com/static/JV2-po-flag.webp","Spanish (Spain)":"https://cdn-useast1.kapwing.com/static/HHd-sp-flag.webp","Spanish (Mexico)":"https://cdn-useast1.kapwing.com/static/ys_-mx-flag.webp",Swedish:"https://cdn-useast1.kapwing.com/static/RPB-sw-flag.webp"},Are=e=>"Hebrew"!==e&&"Hungarian"!==e&&"Norwegian"!==e,jre=Object.keys(Cre),Nre=["nb","no","nn"],Rre=["cmn","zh"],Pre=["fil","tl"];function Dre(e="en"){const t=function(e="en"){return Nre.includes(e)?"nb":Rre.includes(e)?"cmn":Pre.includes(e)?"fil":e}(e);return jre.filter((e=>Cre[e].some((e=>e.languageCode.startsWith(t)))))}function Ore({assetId:e,languageKey:t,translateCode:o,preset:a,resetFramesDirectly:i}){const{dispatch:s,state:n}=sr(),r=IA(e)(n),l=r.languageKey===t;ff.execInUndoBatch((()=>g.batch((()=>{r.enabled&&l||s(_C(e,{languageKey:t,transcriptionSource:"transcription",translated:!!o,...fU(a)})),l||(i?U5(!0):E5({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:e,frames:null})),"dubbing"!==n.toolTip&&s(l_({type:"magicSubtitle",frames:[]}))}))))}const Lre=e=>e.video.small;async function Fre({layerProperties:e,forceNoAudio:t,skipCML:o,skipStudioAddLayer:a,video:i,videoEl:s,useCustomVideoDelay:n,idOfLayerToReplace:r}){const l="GETTY"===i.type,d="GETTY"===i.type?Lre(i):i.video.large;let c,u;const m=i.dimensions.width>i.dimensions.height;if(s){m===s.videoWidth>s.videoHeight?(c=i.dimensions.width,u=i.dimensions.height):(c=i.dimensions.height,u=i.dimensions.width)}const p={layerProperties:{...e,type:zl.Video,usedProFeatures:l?["premium-assets"]:void 0},mediaInfo:"GETTY"===i.type?void 0:{duration:(null==s?void 0:s.duration)??i.dimensions.duration,hasAudio:!t&&await SB(s||function(){const e=document.createElement("video");return e.src=Lre(i),e}()),type:zl.Video,height:u,width:c},skipCML:o,skipStudioAddLayer:a,useCustomVideoDelay:n,idOfLayerToReplace:r};if("GETTY"===i.type){if(!i.id||!i.dimensions)throw Error("Missing getty image info");p.sourceInfo={sourceName:"GETTY",sourceType:"video",sourceId:i.id,sourceDimensions:{width:i.dimensions.width,height:i.dimensions.height}}}return await LX({url:d,options:p})}async function Mre({image:e,isPremiumAsset:t,layerProperties:o,skipCML:a,skipStudioAddLayer:i,idOfLayerToReplace:s,useCustomVideoDelay:n}){var r,l,d,c;const u=void 0===t?"GETTY"===e.type:t,m={mediaInfo:"dimensions"in e&&(null==(r=e.dimensions)?void 0:r.width)&&(null==(l=e.dimensions)?void 0:l.height)?{type:zl.Image,height:null==(d=e.dimensions)?void 0:d.height,width:null==(c=e.dimensions)?void 0:c.width}:void 0,layerProperties:{...o,name:e.name,type:zl.Image,usedProFeatures:u?["premium-assets"]:void 0},skipCML:a,skipStudioAddLayer:i,idOfLayerToReplace:s,useCustomVideoDelay:n};if("GETTY"===e.type){if(!e.id||!e.dimensions)throw Error("Missing getty image info");m.sourceInfo={sourceName:"GETTY",sourceType:"image",sourceId:e.id||"",sourceDimensions:{height:e.dimensions.height,width:e.dimensions.width}}}let p="";switch(e.type){case"DALLE":case"GIPHY":case"GOOGLE":p=e.url;break;case"PEXELS":case"GETTY":p=e.images.download}return await LX({url:p,options:m})}function Ure(e){let t={};try{t=JSON.parse(e)}catch(IGe){const a=function(e){const t=e.indexOf("{"),o=e.indexOf("["),a=e.lastIndexOf("}"),i=e.lastIndexOf("]");if(-1===t)throw new jse(e);if(-1===o)return"{}";const s=Math.min(t,o),n=Math.max(a,i);let r=e.slice(s);return r=r.slice(0,n-s+1),r=r.replace(/"$/gm,'",'),r=r.replace(/,(?!\s*?[{["'\w])/g,""),r=function(e){let t=`${e}`,o=t.indexOf('["');for(;-1!==o;){const e=t.indexOf('"]',o),a=t.slice(o+2,e);let i=t.indexOf('",',o);a.includes('",')||(i=e);let s=t.slice(o+2,i).replace(/\"/g,'"');s=s.replace(/"/g,'\\"'),t=t.slice(0,o+2)+s+t.slice(i),o=t.indexOf('["',i)}return t}(r),"}"!==r[r.length-1]&&(r=function(e){let t=`${e}`,o=0,a=0;for(let i=0;i<t.length;i++){const e=t[i];"{"===e?o+=1:"}"===e&&(a+=1)}for(;o>a;)t.endsWith(",")&&(t=t.slice(0,t.length-1)),t+="}",a+=1;return t}(r)),r=r.replace(/\/\/.*/g,""),r}(e);t=JSON.parse(a)}const o={};return Object.keys(t).forEach((e=>{const a=t[e];if(!a)return;const i={};try{Object.keys(a).forEach((e=>{try{const[t,o]=a[e];"string"==typeof t&&"string"==typeof o&&(i[e]=[t,o])}catch(IGe){}})),o[e]=i}catch(IGe){hh({description:"Failed to parse bRoll",sentryMessage:"BRoll - parse json error",extra:{jsonItem:a}}),console.error(IGe,a)}})),o}async function Bre(e,t){try{const o=await Yr("/api/v1/ai/transcript-keywords",{params:{asset_id:e,video_id:t}});if(o){let e=0,t=0;const a=o.transcriptKeywords.map((o=>{let a={};try{a=Ure(o.keywords),e+=1}catch(IGe){t+=1,hh({description:"There was an error getting the transcript keywords. Please try again.",sentryMessage:"BRoll - parse keywords error",extra:{keywords:o.keywords}}),console.error("Failed to parse transcript keywords",IGe,o.keywords)}return{...o,keywords:a}}));return Fm(ym.BROLL_PARSE_TRANSCRIPT_KEYWORDS,{successCount:e,failCount:t}),a}}catch(IGe){mh({description:"There was an error getting the transcript keywords. Please try again.",error:IGe})}return null}async function Vre(e){try{return await Yr(`/api/v2/ai/jobs/${e}`)}catch(IGe){return console.error(IGe),null}}async function Wre({asset_id:e,video_id:t,cancellationSource:o,startTime:a,endTime:i,forceReload:s=!1,topic:n}){if(-1===a||-1===i)return console.error("asset layer start times not found",{asset_id:e,video_id:t,startTime:a,endTime:i}),null;if(!s){const o=await Bre(e,t);if(o&&o.length>0)return o}const r=await async function({asset_id:e,video_id:t,startTime:o,endTime:a,topic:i}){var s;try{const n=await Yr("/api/v1/ai/generate-broll",{params:{asset_id:e,video_id:t,teamId:null==(s=Hu())?void 0:s._id}});if(!n.succeeded)return console.error(n.message),null;const r={asset_id:e,video_id:t,job_id:n.id,startTime:o,endTime:a,topic:i};return await Qr("generate_broll",{body:r}).catch((e=>{console.error(e)})),n.id}catch(IGe){return mh({description:"Failed to generate b-roll. Please try again.",error:IGe}),console.error(IGe),null}}({asset_id:e,video_id:t,startTime:a,endTime:i,topic:n});if(!r)return null;let l=0;for(;;){if(o.cancelled)return null;const a=await Vre(r);if(o.cancelled)return null;if(!a)return null;if(l>135)throw hh({description:"Generating the b-roll is taking longer than expected. Please try again later.",sentryMessage:"BRoll - timeout",extra:{jobId:r,videoId:t,assetId:e}}),new jse("Getting a response is taking longer than expected. Please try again later.");if("complete"===a.status){const o=await Bre(e,t);if(o)return o}if("error"===a.status){f("BRoll - job error",{extra:{jobId:r,videoId:t,assetId:e}});const o=await Bre(e,t);if(o)return mh({description:"There was an error analyzing the entire transcript. Please try again.",error:a.error}),o;throw mh({description:"There was an error analyzing the transcript. Please try again.",error:a.error}),new jse(a.error)}l+=1,await new Promise((e=>setTimeout(e,4e3)))}}const Gre="Analyzing Transcript",Hre="Searching for Media",$re="Adding Layer to Project",Kre="Adding Layers to Project",zre=e=>{const{state:t}=sr();if(!t.studio.magicSubtitleFramesByAsset)return null;const o=t.studio.magicSubtitleFramesByAsset[e];if(!o)return null;if(!o.byId)return null;return Object.values(o.byId).flatMap((e=>{if(!(null==e?void 0:e.words))return[];const{start:t,end:o}=e,a=(o-t)/e.words.length;return e.words.map(((e,o)=>{const{text:i}=e;let{start:s,end:n}=e;s&&n||(s=t+o*a,n=s+a);return{start_time:s,end_time:n,word:i}}))})).sort(((e,t)=>e.start_time-t.start_time))},Yre=e=>new Promise((t=>{const o=new Image,a=setTimeout((()=>t(null)),5e3);o.onload=()=>{clearTimeout(a),t({width:o.width,height:o.height})},o.onerror=()=>{clearTimeout(a),t(null)},o.src=e})),Jre=["jpg","jpeg","png","gif","webp"],qre=e=>{const t=e.split(".").pop();return!!t&&Jre.includes(t.toLowerCase())},Xre=e=>{const t=e.split(".").pop();return t?Jre.find((e=>t.toLowerCase().includes(e))):null};async function Qre({keyword:e,source:t,aspectRatio:o,noFallback:a,royaltyFree:i}){var s;const{dispatch:n}=sr(),r=e.replace(/-/g," ").trim(),l=[];if("giphy"===t){const{state:e}=sr(),{GIPHY_SEARCH_KEY:t}=e.config;try{const e=new _o.GiphyFetch(t),o=r,i=await e.search(o,{offset:0,type:"stickers",rating:"y"});for(const t of i.data){const e=null==(s=null==t?void 0:t.images)?void 0:s.original,o=Xre(e.url);e&&o&&l.push({originalSearchResult:{dimensions:{width:e.width,height:e.height},name:t.title,type:"GIPHY",url:e.url},url:e.url,width:e.width,height:e.height,source:"giphy",type:"image"})}if(l.length>0||a)return l;n(wl({description:"No GIPHY results found. Using Google Images instead.",type:"warning"}))}catch(IGe){mh({description:"Failed to search giphy",error:IGe})}}const d=await PX(`${r}`,{useGoogleOnly:"google"===t,aspectRatio:o,includeGetty:"getty-images"===t,royaltyFree:i});if("pexels-images"===t){for(const e of d.pexels)l.push({url:e.images.large,width:e.dimensions.width,height:e.dimensions.height,source:"pexels-images",type:"image",originalSearchResult:e});if(l.length>0||a)return l;n(wl({description:"No Pexels Image results found. Using Google Images instead.",type:"warning"}))}if("getty-images"===t){for(const e of d.getty)l.push({url:e.images.large,width:e.dimensions.width,height:e.dimensions.height,source:"getty-images",type:"image",imageId:e.id,originalSearchResult:e});if(l.length>0||a)return l;n(wl({description:"No Getty Image results found. Using Google Images instead.",type:"warning"}))}for(const c of d.google){let e=0,t=0;if(qre(c.url)){if(0===l.length){const o=await Yre(c.url);if(o&&({width:e,height:t}=o),!e||!t)continue}l.push({url:c.url,width:e,height:t,source:"google",type:"image",originalSearchResult:c})}}return l}async function Zre({keyword:e,aspectRatio:t,includeGetty:o,royaltyFree:a}){const i=e.replace(/-/g," ").trim(),s=await MX(`${i}`,{includeGetty:o});function n(e,t){const o=[];for(const a of e){const{video:e,dimensions:i}=a,{width:s,height:n,duration:r}=i;o.push({originalSearchResult:a,url:"getty-videos"===t?e.small:e.large,thumbnailUrl:e.poster,width:s,height:n,duration:r,source:t,type:"video",videoId:a.id})}return o}const r=[...n(s.pexels,"pexels"),...n(s.pixabay,"pixabay")];if(o){const e=n(s.getty,"getty-videos");if(a)return e;r.push(...e)}return r.sort(((e,o)=>{const a=e.width/e.height,i=o.width/o.height;return"tall"===t?i-a:"wide"===t?a-i:Math.abs(1-a)-Math.abs(1-i)}))}function ele(e=100,t=100,o="center"){const{state:a}=sr(),{width:i=100,height:s=100}=a.studio;let n,r,l=40,d=40,c=l/100*i,u=d/100*s;e>t?(u=t/e*c,d=u/s*100):(c=e/t*u,l=c/i*100);const m=5*i/100,p=5*s/100;switch(o){case"topLeft":n=m,r=p;break;case"topRight":n=i-c-m,r=p;break;case"bottomLeft":n=m,r=s-u-p;break;case"bottomRight":n=i-c-m,r=s-u-p;break;default:l=100,d=100,c=i,u=s,e>t?(u=t/e*i,d=u/s*100):(c=e/t*s,l=c/i*100),n=(i-c)/2,r=(s-u)/2}return{x:`${n/i*100}%`,y:`${r/s*100}%`,width:`${l}%`,height:`${d}%`,rotation:0}}const tle=(e,t)=>{const{assetId:o,startTime:a,endTime:i}=e;let s=-1,n=-1;return t.forEach((e=>{if(e.asset_id!==o)return;if(-1!==s&&-1!==n)return;const{startTime:t,endTime:r,videoDelay:l,playbackRate:d}=dm(e);r&&(t<=a&&r>=i&&(s=l+a-t,n=l+i-t),t>a&&r>=i&&(s=l,n=l+i-t,n-s<1&&(n=-1,s=-1)),t<=a&&r<i&&(s=l+a-t,n=l+r-t,n-s<1&&(n=-1,s=-1)),-1!==s&&-1!==n&&(s/=d,n/=d))})),{...e,timelineStartTime:s,timelineEndTime:n}},ole=async(e,t)=>{let{timelineStartTime:o,timelineEndTime:a}=e;const i=e=>-1===e||void 0===e;if(i(o)||i(a))return hh({description:"Failed to create layer",sentryMessage:"BRoll - create layer invalid times",extra:{timelineStartTime:o,timelineEndTime:a}}),null;o=wS(o),a=wS(a);const s=a-o,{searchResults:n,searchIndex:r}=e,l=null==n?void 0:n[r||0];if(!l)return null;const{source:d,type:c,url:u}=l;let{width:m,height:p}=l;if("video"===c){const a="getty-videos"===d;return await Fre({forceNoAudio:!0,layerProperties:{position:ele(m,p,t),crop:{x:0,y:0,width:100,height:100},type:zl.Video,volume:0,startTime:0,endTime:s,videoDelay:o,isTrimmed:!0,bRollLayerSource:d||"pexels",usedProFeatures:a?["premium-assets"]:void 0,hasAudio:!1,name:`${e.keyword} video`},skipCML:!0,skipStudioAddLayer:!0,video:l.originalSearchResult})}if(!m||!p){const e=await Yre(u);e&&({width:m,height:p}=e)}return await Mre({image:l.originalSearchResult,layerProperties:{position:ele(m,p,t),crop:{x:0,y:0,width:100,height:100},type:zl.Image,startTime:o,endTime:a,isTrimmed:!0,bRollLayerSource:d||"google",keyframeAnimation:"center"===t?bse.getKeyFrameAnimation(o,a):void 0},skipCML:!0,skipStudioAddLayer:!0})},ale=(e,t,o=!1)=>{if(!e)return null;const a=[],i=[];t.forEach((e=>{if(e.wordCount>=3)i.push(e);else if(o){const t={bRollId:oe.v4(),assetId:e.assetId,keyword:e.text,image:e.text,video:"",startTime:e.startTime,endTime:e.endTime};a.push(t)}}));const s=new Set;for(const n of e){const{asset_id:e,keywords:t,start_time:o,end_time:r}=n,l=[];let d=0;for(const a of i){const{startTime:e,endTime:t}=a;e>=o&&t<=r&&l.push(a),l.length<1&&(d+=1)}for(let i=0;i<l.length;i+=1){const o=l[i],n=t[`${i+1}`];if(!n)continue;const r=Object.keys(n).sort(((e,t)=>o.text.indexOf(e)-o.text.indexOf(t))),c=(o.endTime-o.startTime)/r.length;let{startTime:u}=o,m=u+c;for(const t of r){const[o,r]=n[t],l={bRollId:oe.v4(),assetId:e,keyword:t,image:o,video:r,startTime:u,endTime:m};a.push(l),u=m,m=u+c,s.add(d+i)}}}if(o){i.filter(((e,t)=>!s.has(t))).forEach((e=>{const t={bRollId:oe.v4(),assetId:e.assetId,keyword:e.text,image:e.text,video:"",startTime:e.startTime,endTime:e.endTime};a.push(t)}))}return a},ile=e=>{const t=(e=>{const{state:t}=sr(),o=t.studio.scenes[0];if(!o)return[];const{layers:a}=o;return a.filter((t=>t.asset_id===e))})(e);let o=-1,a=-1;return t.forEach((e=>{const t=e.startTime||0,i=e.endTime||e.duration||0;(-1===o||t<o)&&(o=t),(-1===a||i>a)&&(a=i)})),{startTime:o,endTime:a}},sle=async({forceReload:e=!1,fillGaps:t=!1,cancellationSource:o=new CH,aspectRatio:a,includeGetty:i=!1,royaltyFree:s=!1,topic:n})=>{var r;const{state:l,dispatch:d}=sr();if(d(Tp({usedGenerateBRoll:!0})),l.bRoll.bRollLoadingMsg)return;const c=Date.now();hle(Gre);const u=(()=>{const{state:e}=sr(),t=new Set;Object.values(e.studio.allLayers.byId).map((e=>null==e?void 0:e.asset_id)).forEach((e=>{e&&t.add(e)}));const o=Object.keys(e.assetTranscriptions.byId).filter((e=>t.has(e))),a={};return o.forEach((t=>{const o=e.assetTranscriptions.byId[t];let i,s;if(Object.keys(o).forEach((e=>{var t;const a=o[e];"completed"===(null==a?void 0:a.state)&&(null==(t=null==a?void 0:a.words)?void 0:t.length)>0&&(i=e,"en"!==i&&"en-US"!==i||(s=i))})),s&&(i=s),!i)return void console.error("no asset transcription for asset",t);const n=o[i];if("completed"!==(null==n?void 0:n.state))return;const{languageCode:r,translateCode:l}=$A(i),d=X.isRtlLang(l??r??null),c=YA(t)(e);let{words:u}=n;const m=zre(t);m&&(u=m);const p=[];let h=null;u.forEach((e=>{h?(h.endTime=e.end_time,d?h.text=e.word+c+h.text:h.text+=c+e.word,h.wordCount+=1):h={assetId:t,startTime:e.start_time,endTime:e.end_time,text:e.word,wordCount:1},zT(e.word)&&(p.push(h),h=null)})),h&&p.push(h),a[t]=p})),a})();if(!Object.keys(u).some((e=>{const t=u[e];return t&&t.length>0})))return d(wl({description:"Please upload a file with speech. Cannot generate auto image overlays without a transcript.",type:"warning"})),hle(""),void d(YD({tabId:"",tabContainerId:"image"}));e&&d(yv({bRollLayerData:[]}));const m=new Set(l.bRoll.bRollLayerData.map((({assetId:e})=>e)));if(!Object.keys(u).some((t=>!!e||!m.has(t))))return void hle("");let p=0,h=0,g=0;const f=[],y=[];for(const _ in u){const t=u[_];if(!t||0===t.length)continue;if(p+=1,!e&&m.has(_)){const e=[];l.bRoll.bRollLayerData.forEach((t=>{const{assetId:o}=t;o===_&&e.push({...t})})),f.push(...e),h+=1,g+=t.length;continue}const{startTime:a,endTime:i}=ile(_),s={asset_id:_,video_id:l.studio._id||"",cancellationSource:o,startTime:a,endTime:i,forceReload:e,topic:n};y.push(s)}const v=[];for(let _=0;_<y.length;_+=8){const e=y.slice(_,_+8),t=await Promise.all(e.map(Wre));v.push(...t)}for(let _=0;_<v.length;_+=1){const e=v[_],o=null==(r=null==e?void 0:e[0])?void 0:r.asset_id;if(!e||!o)continue;const a=u[o];if(!a||0===a.length)continue;const i=ale(e,a,t);i&&(f.push(...i),h+=1,g+=a.length)}f.forEach(((e,t)=>{const o=t%2==0,a=e.video.length>0,i=o&&a;e.source=i?"pexels":"google"})),await mle({source:s?"getty-images":"google",existingBRollLayerData:f,aspectRatio:a,includeGetty:i,royaltyFree:s}),hle(""),Fm(ym.B_ROLL_GENERATION_RESULT,{duration:Date.now()-c,forceReload:e,assetsWithBRoll:h,assetsWithTranscriptions:p,layerDataCount:f.length,totalSentences:g,fillGaps:t,includeGetty:i})},nle=e=>["pexels","pixabay","getty-videos"].includes(e),rle=(e,t="google")=>{const{keyword:o,image:a,video:i,source:s=t}=e;return nle(s)?i:"giphy"===s?o:a},lle=async({layerData:e,source:t,aspectRatio:o,includeGetty:a,royaltyFree:i})=>{const s=rle(e,t),n=e.source||t;let r=e.searchResults||[],l=!1;try{if(nle(n))r=await Zre({keyword:s,aspectRatio:o,includeGetty:a,royaltyFree:i});else{const e=t;r=await Qre({keyword:s,source:e,aspectRatio:o,noFallback:!0,royaltyFree:i})}if(0===r.length&&i&&(r=await(async({layerData:e,aspectRatio:t})=>{const o=[[e.image,"getty-images"],[e.image,"pexels-images"],[e.keyword,"getty-images"],[e.keyword,"pexels-images"],[e.video,"getty-images"],[e.video,"pexels-images"]];let a=[];for(const[i,s]of o)if(a=await Qre({keyword:i,source:s,aspectRatio:t,noFallback:!0,royaltyFree:!0}),a.length>0)break;return a})({layerData:e,aspectRatio:o}),0===r.length&&(r=await(async({layerData:e,aspectRatio:t})=>{const o=[e.video,e.keyword,e.image];let a=[];for(const i of o)if(a=await Zre({keyword:i,aspectRatio:t,includeGetty:!0,royaltyFree:!0}),a.length>0)break;return a})({layerData:e,aspectRatio:o}))),0===r.length){if(i){const{dispatch:e}=sr();e(wl({description:"No royalty free results found. Using Google Images instead.",type:"warning"}))}r=await Qre({keyword:e.image,source:"google",aspectRatio:o})}}catch(IGe){l=!0,console.error(IGe)}return{...e,searchErrored:l,searchResults:r,searchIndex:0}},dle=async e=>{const{dispatch:t}=sr(),{searchIndex:o,searchResults:a}=e,i=void 0!==o?o+1:0,s=null==a?void 0:a[i];if(a&&s){const o=[...a],n={...s};if(!("image"!==n.type||n.width&&n.height)){const e=await Yre(s.url);if(e){const{width:t,height:o}=e;n.width=t,n.height=o}}o[i]=n;const r={...e,searchResults:o,searchIndex:i};return t(wv({bRollLayerData:r,undoable:!0})),r}},cle=async({layerData:e,source:t,includeGetty:o,royaltyFree:a})=>{const{dispatch:i}=sr(),s="dall-e"===t?await ple(e):await lle({layerData:e,source:t,includeGetty:o,royaltyFree:a});return i(wv({bRollLayerData:s,undoable:!0})),s};function ule(e,t,o,a){const i=t[e];if("video"===(null==i?void 0:i.type)){const{duration:s,url:n}=i;if(s&&s<a||o.has(n))return ule(e+1,t,o,a)}return Math.min(e,t.length-1)}const mle=async({source:e,existingBRollLayerData:t,aspectRatio:o,includeGetty:a,royaltyFree:i})=>{var s,n,r,l,d;hle(Hre);const{state:c,dispatch:u}=sr(),m=t||c.bRoll.bRollLayerData,p=new Set,h=[];for(let w=0;w<m.length;w+=1){const t=m[w];if(!t)continue;const o=rle(t,e);p.has(o)||(p.add(o),h.push(w))}const g=[];let f=[];h.forEach(((e,t)=>{f.push(e),(f.length>=20||t===h.length-1)&&(g.push(f),f=[])}));const y={};for(const w of g){(await Promise.all(w.map((t=>lle({layerData:m[t],source:e,aspectRatio:o,includeGetty:a,royaltyFree:i}))))).forEach((t=>{const o=rle(t,e);y[o]=t}))}const v=new Set,_=[];for(const w of m){const t=rle(w,e),c=y[t];if(!c){console.error("searchForAllBRollImages no newLayerData",{searchTerm:t,layerData:w}),_.push(w);continue}let{searchIndex:u=0,searchResults:m}=c,p=null==(s=null==m?void 0:m[u])?void 0:s.url;for(;p&&v.has(p);){u+=1;const e=null==m?void 0:m[u];p=null==e?void 0:e.url}p&&v.add(p);const h=10;for(let e=0;e<h;e+=1){const e=null==m?void 0:m[u];if(!e)break;const{width:t,height:o,url:a}=e;if(t&&o){v.add(a);break}if("video"===e.type)continue;const i=await Yre(a);if(i&&i.width&&i.height){e.width=i.width,e.height=i.height,v.add(a);break}for(u+=1,p=null==(n=null==m?void 0:m[u])?void 0:n.url;p&&v.has(p);)u+=1,p=null==(r=null==m?void 0:m[u])?void 0:r.url}if(m){u=ule(u,m,v,w.endTime-w.startTime);const e=m[u];if(p=null==e?void 0:e.url,p)if("video"===(null==e?void 0:e.type)&&v.has(p)){const e=await lle({layerData:{...w,source:"google"},source:"google",aspectRatio:o,includeGetty:a,royaltyFree:i});for(u=0,m=e.searchResults,p=null==(l=null==m?void 0:m[u])?void 0:l.url;p&&v.has(p);)u+=1,p=null==(d=null==m?void 0:m[u])?void 0:d.url;const t=null==m?void 0:m[u];if(t){const e=await Yre(t.url);e&&e.width&&e.height&&(t.width=e.width,t.height=e.height,v.add(t.url))}}else v.add(p)}_.push({...w,searchTerm:t,searchIndex:u,searchResults:m,searchErrored:c.searchErrored})}u(yv({bRollLayerData:_})),hle("")},ple=async e=>{const{image:t}=e;let o=e.searchResults||[],a=!1;try{o=(await Pne(t)).map((({url:e})=>({url:e,width:1024,height:1024,source:"dall-e",type:"image",originalSearchResult:{url:e,dimensions:{width:1024,height:1024},name:t,type:"DALLE"}})))}catch(IGe){a=!0,mh({description:"Failed to generate images",error:IGe})}return{...e,searchErrored:a,searchResults:o,searchIndex:0}},hle=e=>{const{dispatch:t}=sr();t(gv({bRollLoadingMsg:e}))};function gle(e){Fm(ym.B_ROLL_ADD_LAYERS,e)}const fle=async e=>{const{dispatch:t,state:o}=sr(),{bRollAlignment:a}=o.bRoll,i=a||"center",{timelineStartTime:s,timelineEndTime:n}=e;hle($re);const r=e=>-1!==e&&void 0!==e;if(!r(s)||!r(n))return hh({description:"Failed to add image to project",sentryMessage:"BRoll - add image layer invalid times",extra:{timelineStartTime:s,timelineEndTime:n}}),void hle("");const l=await ole(e,i);if(!l)return hh({description:"Failed to add layer to project"}),void hle("");t(Fv({layers:[l],isUndoable:!0})),hle("");const{searchResults:d,searchIndex:c}=e,{source:u="google"}=(null==d?void 0:d[c||0])||{};gle({alignment:i,layerCount:1,isAddAll:!1,googleSourceCount:"google"===u?1:0,giphySourceCount:"giphy"===u?1:0,dalleSourceCount:"dall-e"===u?1:0,gettyImagesSourceCount:"getty-images"===u?1:0,pexelsImagesSourceCount:"pexels-images"===u?1:0,pexelsSourceCount:"pexels"===u?1:0,pixabaySourceCount:"pixabay"===u?1:0,gettyVideosSourceCount:"getty-videos"===u?1:0})},yle=async e=>{var t;const{assetIdSet:o,timelineRow:a,cancellationSource:i,addInBatches:s}=e||{},{dispatch:n,state:r}=sr(),l=r.bRoll.bRollAlignment||"center",{bRollLayerData:d}=r.bRoll,c=o||new Set(d.map((({assetId:e})=>e))),u=((null==(t=r.studio.scenes[0])?void 0:t.layers)||[]).filter((e=>c.has(e.asset_id||"")));hle(Kre);try{const e=new Map,t=4,o=[];let r=[];for(let a=0;a<d.length;a+=1){if(null==i?void 0:i.cancelled)return;const s=d[a],n=tle(s,u);if(-1===n.timelineStartTime||-1===n.timelineEndTime)continue;if(n.searchErrored)continue;r.push(n),r.length>=t&&(o.push(r),r=[]);const{searchResults:l,searchIndex:c}=n,{source:m="google"}=(null==l?void 0:l[c||0])||{};e.set(m,(e.get(m)||0)+1)}r.length>0&&o.push(r);const c=[];for(let d=0;d<o.length;d+=1){if(null==i?void 0:i.cancelled)return;const e=o[d];if(!e)continue;const t=await Promise.all(e.map((e=>ole(e,l).catch((e=>{console.error("Failed to create bRoll layer",e)}))))),r=[];t.forEach((e=>{e&&(a&&(e.timelineRow=a),c.push(e),r.push(e))})),s&&ff.execInUndoBatch((()=>{n(Fv({layers:r,isUndoable:!0}))}))}s||ff.execInUndoBatch((()=>{n(Fv({layers:c,isUndoable:!0}))})),gle({alignment:l,layerCount:c.length,isAddAll:!0,googleSourceCount:e.get("google")||0,giphySourceCount:e.get("giphy")||0,dalleSourceCount:e.get("dall-e")||0,gettyImagesSourceCount:e.get("getty-images")||0,pexelsImagesSourceCount:e.get("pexels-images")||0,pexelsSourceCount:e.get("pexels")||0,pixabaySourceCount:e.get("pixabay")||0,gettyVideosSourceCount:e.get("getty-videos")||0})}catch(IGe){mh({description:"Failed to add layers to your project",error:IGe})}hle("")},vle=()=>(tl((e=>{var t,o;return null==(o=null==(t=e.bRoll)?void 0:t.bRollLayerData)?void 0:o.length}))||0)>0,_le=m((e=>e.bRoll.hoveredBRollId),(e=>e.bRoll.bRollLayerData),((e,t)=>null==t?void 0:t.find((({bRollId:t})=>t===e)))),wle=()=>tl(_le),ble=m(bk,(e=>e.assets.layerIdsByAssetId),(e=>e.studio.allLayers.byId),((e,t,o)=>e.filter((e=>{const a=t[e];if(!a)return!1;return a.some((e=>{const t=o[e];return!!t&&(ql(t)||t.hasAudio&&t.volume)}))})))),Tle=()=>tl(ble),xle=m(ble,(e=>e.assetTranscriptions),((e,t)=>e.filter((e=>{const o=t.byId[e];return!o||(0===Object.keys(o).length||!!Object.values(o).every((e=>"failed"===(null==e?void 0:e.state))))})))),Sle=()=>{const{state:e}=sr();return xle(e)},Ele=(e,t)=>{const{layer:o}=e,{layer:a}=t,{videoDelay:i=0}=o,{videoDelay:s=0}=a;return i<s?-1:i>s?1:0},Ile=async(e,t)=>{const o=`${e.replace(/-/g," ").trim()}`,a=await MX(o,{includeGetty:!0}),{getty:i}=a,n=i.filter((e=>(t.forEach((t=>{if("id"in t&&e.id===t.id)return!1})),!0)));if(n.length>2)return{videos:s.shuffle(n),fallbackContent:[]};const r=await PX(o),{pexels:l,getty:d}=r,c=l.slice(0,10);c.concat(d.slice(0,10));return{videos:n,fallbackContent:c.filter((e=>(t.forEach((t=>{if("images"in t&&e.images.large===t.images.large)return!1})),!0)))}},Cle=async({query:e,video:t,startTime:o,endTime:a,timelineRow:i,usedArray:s})=>{const{width:n,height:r}=t.dimensions;s.push(t),await Fre({forceNoAudio:!0,layerProperties:{position:ele(n,r,"center"),crop:{x:0,y:0,width:100,height:100},type:zl.Video,volume:0,startTime:0,endTime:a-o,videoDelay:o,timelineRow:i,isTrimmed:!0,bRollLayerSource:"getty-videos",aiGeneratorQuery:e,usedProFeatures:["premium-assets"],hasAudio:!1,name:`${e} video`},skipCML:!0,video:t,useCustomVideoDelay:o})},kle=async({query:e,image:t,startTime:o,endTime:a,timelineRow:i,usedArray:s})=>{const{width:n,height:r}=t.dimensions;s.push(t),await Mre({image:t,layerProperties:{position:ele(n,r,"center"),crop:{x:0,y:0,width:100,height:100},name:`${e} image`,type:zl.Image,startTime:o,endTime:a,timelineRow:i,isTrimmed:!0,aiGeneratorQuery:e,bRollLayerSource:"PEXELS"===t.type?"pexels-images":"getty-images",keyframeAnimation:bse.getKeyFrameAnimation(o,a)},skipCML:!0,useCustomVideoDelay:o})},Ale=async(e,t,o,a,i,s,n)=>{const r=t[0],l=i-a;if(r&&t.length)if(r&&r.dimensions.duration>=l)await Cle({query:e,video:r,startTime:a,endTime:i,timelineRow:s,usedArray:n});else{const d=r.dimensions.duration>=l/2?a+l/2:r.dimensions.duration;if(await Cle({query:e,video:r,startTime:a,endTime:d,timelineRow:s,usedArray:n}),t.length>1&&t[1]){const o=t[1];await Cle({query:e,video:o,startTime:d,endTime:o.dimensions.duration>=i-d?i:d+o.dimensions.duration,timelineRow:s,usedArray:n})}else o[0]&&await kle({query:e,image:o[0],startTime:d,endTime:i,timelineRow:s,usedArray:n})}else if(o.length>1&&l>=7)o[0]&&o[1]&&(await kle({query:e,image:o[0],startTime:a,endTime:a+l/2,timelineRow:s,usedArray:n}),await kle({query:e,image:o[1],startTime:a+l/2,endTime:i,timelineRow:s,usedArray:n}));else{if(!o[0])throw new Error("no videos or images found");await kle({query:e,image:o[0],startTime:a,endTime:i,timelineRow:s,usedArray:n})}},jle=async({script:e,transcriptAssetIds:t,languageCode:o,timelineRow:a,cancellationSource:i})=>{const{state:s}=sr(),n=s.studio.allLayers.byId,r=Object.values(n).filter((e=>(null==e?void 0:e.asset_id)&&t.includes(e.asset_id))),l=[];for(let y=0;y<t.length;y+=1){const e=t[y];if(!e)continue;const a=r.find((t=>t.asset_id===e));if(!a)continue;const i=s.assetTranscriptions.byId[e];if(!i||!i[o])continue;const n=i[o];n&&"completed"===n.state&&l.push({transcript:n,layer:a})}l.sort(Ele);const d=(e=>{const t=[];for(let o=0;o<e.length;o+=1){const a=e[o];if(!a)continue;const{transcript:i,layer:s}=a,{words:n}=i;for(const e of n){const{word:o,start_time:a,end_time:i}=e,n=s.videoDelay||0;t.push({...e,start_time:a+n,end_time:i+n})}}return t})(l),c=new Intl.Segmenter(o,{granularity:"sentence"});let u=Array.from(c.segment(e),(e=>e.segment));const m=(({sentenceArray:e,allWordsWithTimings:t})=>{const o=[];let a=0,i=sr().state.studio.duration??0;for(let s=0;s<e.length;s+=1){const n=e[s];if(!n)continue;const r=t[a],l=t[a+n.trim().split(" ").length-1];if(!r||!l)continue;const{start_time:d}=r,{end_time:c}=l,u=Math.min(d,i);i=c,o.push({sentence:n,startTime:u,endTime:c}),a+=n.trim().split(" ").length}return o})({sentenceArray:u,allWordsWithTimings:d});u=Array.from(m,(e=>e.sentence.trim()));const p=await(async e=>{let t=1;const o=[];for(const r of e)o.push(`${t}) ${r}`),t+=1;const a=await Qr("generate_visual_queries",{body:{sentenceArray:o}}).catch((e=>{mh({description:"Something went wrong when analyzing your script",error:e})})),{queries:i}=a,s=[],n=i.split("\n");for(let r=0;r<n.length;r+=1){const t=n[r].replace(/^\d+\)\s*/,""),o=(e[r]||"").trim();o&&t&&s.push({query:t,sentence:o})}return s})(u);u=Array.from(p,(e=>e.sentence.trim()));const h=Array.from(p,(e=>e.query.trim())),g=[];let f=[];for(let y=0;y<h.length;y+=1){if(i.cancelled)return;const e=h[y];if(!e)continue;const t=await Ile(e,g),{videos:o,fallbackContent:s}=t,n=m[y];if(!n){const e=new Error("timing issue");throw mh({description:"Something went wrong when generating your b-roll",error:e}),e}{const{startTime:t,endTime:i}=n;f.push(Ale(e,o,s,t,i,a,g))}f.length>=4&&(await Promise.all(f),f=[])}f.length>0&&await Promise.all(f)};function Nle(e,t){const o=[];if(e.length<=t)return[e];let a=t;for(let n=t-1;n>t/2;n-=1){const t=e.charAt(n),o=e.charAt(n+1);if((" "===o||"\n"===o)&&zT(t)){a=n+2;break}}const i=e.substring(0,a),s=e.substring(a);return o.push(i),o.push(...Nle(s,t)),o}function Rle(e){return e.replace(/\[.*?\]/g,"").replaceAll("-\n","-").replaceAll(".\n",". ").replaceAll(". \n",". ").replaceAll("\n\n","\n").replaceAll("\n",". ").replaceAll(". .",". ").replaceAll("?.","?").replaceAll("!.","!").replaceAll(",.",",").replaceAll("-.","-").replaceAll(";.",";").replaceAll(":.",":").replaceAll("  .","").replaceAll(" .","").replaceAll("  "," ").replaceAll("```",'"').trim()}const Ple=["blurBg","chromaKey","converted_gif","chromaKeyChannel","chromaKeyThreshold","chromaKeyColor","chromaKeyHueThreshold","chromaKeySatThreshold","chromaKeyValThreshold","removeBg"],Dle=e=>Math.round(100*e)/100;function Ole(e,t){const{x:o,y:a}=e,{x:i,y:s}=t,n=Dle(parseFloat(o)),r=Dle(parseFloat(a)),l=Dle(parseFloat(i)),d=Dle(parseFloat(s));return n===l&&r===d}const Lle=ff.withUndoBatch(((e,t={})=>{const{state:o,dispatch:a}=sr(),{studio:i,studioLocal:s}=o,n=ef(o),{duration:r}=i,{detachAudio:l=!1,position:d={},positionOffset:c=!0,splitTime:u}=t;let m,p=(e.timelineRow||0)+1;const h=i.scenes[0];let g,f=0;h.layers.forEach(((t,o)=>{t.timelineRow&&t.timelineRow>f&&(f=t.timelineRow),t.id===e.id&&(m=o)})),p=f+1,g=void 0!==m?m+1:h.layers.length;const y={...e,id:oe.v4(),timelineRow:p};if(e.position){let t=0;if(c&&!r){const o=h.layers.filter((t=>t.type===e.type&&t.name===e.name));for(let a=0;a<35;a++){t=3*(1+a);const i={...e.position,x:`${parseFloat(e.position.x)+t}%`,y:`${parseFloat(e.position.y)+t}%`,...d};if(!o.some((e=>e.position&&Ole(e.position,i))))break}}y.position={...e.position,x:`${parseFloat(e.position.x)+t}%`,y:`${parseFloat(e.position.y)+t}%`,...d}}if(!l&&fI(e.id)&&a(OE(e.id,y.id)),nm(y)){y.animation={intro:[],constant:[],outro:[]};const t=Lx(e);["intro","constant","outro"].forEach((e=>{var o,i;if(l)return;const s=t[e][0];if(!s||s.id===Yl.None||s.isCrossTransition)return;const n={id:oe.v4(),animationName:s.id,isCrossTransition:!1,layerId:y.id,transitionDuration:s.transitionDuration||.5};null==(i=null==(o=y.animation)?void 0:o[e])||i.push(n.id),a(Pv(n))}))}if(l){y.type=zl.Audio,y.detachedAudioId=oe.v4(),y.timelineRow=(e.timelineRow||0)+1,y.videoDelay=e.videoDelay||0,y.startTime=e.startTime||0,y.endTime=e.endTime||e.duration;for(const e of Ple)delete y[e]}else"timeline"===s.selectedEditorPane&&lz(y,!0);return u&&(y.startTime=t.splitTime,y.isTrimmed=!0),n||a(r_(!0)),gz(y,{undoable:!0,layerIndex:g,knownTimelineRow:l}),a(l_({id:y.id,type:"layer"})),y})),Fle=()=>{const e=B5();e&&Lle(e,{positionOffset:!0})};class Mle{constructor(e){i(this,"cancellationSource",new CH),i(this,"options"),i(this,"initialVideoDelay",0),i(this,"musicSource"),this.options=e,this.musicSource="default"}cancel(){this.cancellationSource.cancel()}async updateProjectName(){const{dispatch:e,state:t}=sr(),{studio:o,currentUser:a}=t,i=this.options.topic?XX(this.options.topic,25):XX(this.options.script,25);if(e(SK(i)),o.projectId)try{await TK(o.projectId,{name:i},a)}catch(IGe){}}setInitialVideoDelay(){const{state:e}=sr(),[t]=e.studio.scenes;if(!t)return;const{duration:o}=uC(t,lT(e.studio));if(this.initialVideoDelay=o,o>0){const e=.001;this.initialVideoDelay+=e}}async createTTSAudioAndSubtitleLayers(){const{dispatch:e}=sr(),t="isClone"in this.options.voice&&this.options.voice.isClone,o=Nle(this.options.script,t?250:500);if(this.cancellationSource.cancelled)return null;const a=o.map((e=>YX({language:this.options.language,voiceOption:this.options.voice,text:e,withSubtitles:!0,fromMediaSidebar:!1,cancellationSource:this.cancellationSource}))),i=await Promise.all(a);if(i.includes(void 0))return null;const s=i.filter((e=>void 0!==e));let n=this.initialVideoDelay;const r=s.map((e=>{const t={...e.layer,videoDelay:n,usedProFeatures:[],timelineRow:0};return n+=(e.layer.endTime||0)-(e.layer.startTime||0),t}));if(this.cancellationSource.cancelled)return null;g.batch((()=>{e(Fv({layers:r,isUndoable:!0})),s.forEach((({layer:t,transcription:o})=>{e(nN([{assetId:t.asset_id,languageKey:this.options.voice.languageCode,status:{assetTranscriptionId:o._id,state:"completed",languageKey:this.options.voice.languageCode,words:o.words,job_params:o.job_params}}]))}))}));const l=[];for(const{layer:d,transcription:c}of s){if(!d||!c)continue;const e="9:16"===this.options.size.key,t={...this.options.preset,style:{...this.options.preset.style,verticalAlign:"bottom",fontSize:e?32:this.options.preset.style.fontSize},isSafezoneAware:e};d.asset_id&&(Ore({assetId:d.asset_id,translateCode:void 0,languageKey:this.options.voice.languageCode,preset:t,resetFramesDirectly:!0}),l.push(d.asset_id))}return{scriptDuration:n-this.initialVideoDelay,newAssetIds:l}}async createMusicLayer(e,t,o){const{dispatch:a}=sr();let i,s;try{const e=XX(this.options.script,100);i=await gse(e,this.cancellationSource)}catch(IGe){console.error("Failed to fetch music keyword",IGe)}const n=i??"",r=await WX(n,""),l=Math.floor(Math.random()*r.sounds.length);if(s=r.sounds[l],this.musicSource="soundstripe",!s){const e=fse(t,i);s={id:e.source,title:e.title,source:e.source,artist:e.author.name,duration:e.metadata.duration},this.musicSource="default"}const d=await LX({url:s.source,options:{skipCML:!0,layerProperties:{duration:s.duration,type:zl.Audio,isTrimmed:!0,startTime:0,endTime:t<s.duration?t:s.duration,videoDelay:e,volume:.1,timelineRow:o,soundStripeID:"soundstripe"===this.musicSource?s.id:void 0},mediaInfo:{hasAudio:!0,type:zl.Audio},useCustomVideoDelay:e}});let c=s.duration;const u={};for(;c<t;){const e=Lle(d);if(u[e.id]={timelineRow:o,endTime:t-c>s.duration?s.duration:t-c,videoDelay:c},!(null==e?void 0:e.asset_id))return void hh({description:"Failed to add second music layer",sentryMessage:"ScriptToVideo: Failed to add music layer",extra:{song:s}});c+=s.duration}if(OI(u,"layers.tsx",!1),!(null==d?void 0:d.asset_id))return void hh({description:"Failed to add music layer",sentryMessage:"ScriptToVideo: Failed to add music layer",extra:{song:s}});const m=this.options.voice.languageCode;a(nN([{assetId:d.asset_id,languageKey:m,status:{state:"pending",languageKey:m,assetDuration:t,assetId:d.asset_id,progress:{conformed:!1,done:!1,downloaded:!1,extracted:!1,speech:0,trimmed:!1},transcriptionId:""}}])),a(nN([{assetId:d.asset_id,languageKey:m,status:{assetTranscriptionId:"",state:"completed",languageKey:m,words:[],job_params:{keep_whole:!0,speaker_labels:!0,provider_id:"music"}}}]))}getMaxTimelineRowForAssets(e){let t=0;const o=new Set(e);if(o.size>0){const{state:e}=sr(),a=Object.values(e.studio.allLayers.byId).filter((e=>e.asset_id&&o.has(e.asset_id)));t=Math.max(...a.map((e=>e.timelineRow||0)))}return t}async generate(){var e;const t=Date.now(),{dispatch:o}=sr();this.setInitialVideoDelay(),this.updateProjectName(),g.batch((()=>{o(bb(Kn.MP4)),o(lS(this.options.size.key)),o({type:"SHOW_STUDIO_CANVAS"}),o(mC(!0)),o(Tp(this.options.topic?{usedGenerateTTSVideo:!0,usedGenerateTTSVideoPastPrompt:this.options.usingPastPrompt}:{usedGenerateVideoFromScript:!0,usedGenerateVideoFromScriptPastPrompt:this.options.usingPastPrompt}))}));let a=0,i=[];const s=Date.now();try{const e=await this.createTTSAudioAndSubtitleLayers();if(!e)return;({scriptDuration:a,newAssetIds:i}=e)}catch(IGe){throw console.error(IGe),hh({description:"Failed to create tts layers",sentryMessage:"ScriptToVideo: failed to create tts layers"}),new Error("Failed to create tts layers")}const n=Date.now(),r=this.getMaxTimelineRowForAssets(i);[].push(Jr("/api/v1/ai/script-to-video-job",{body:{...this.options,teamId:null==(e=Hu())?void 0:e._id}}));const l=Date.now();await this.createMusicLayer(this.initialVideoDelay,a,r+1).catch((e=>{throw console.error(e),hh({description:"Failed to create music layer",sentryMessage:"ScriptToVideo: failed to create music layer",extra:{scriptDuration:a}}),new Error("Failed to create music layer")})),await jle({script:this.options.script,transcriptAssetIds:i,languageCode:this.options.voice.languageCode,timelineRow:r+2,cancellationSource:this.cancellationSource});const d=Date.now(),c=Date.now();Fm(ym.AI_GENERATION_TIMES,{"Subtitle Duration":n-s,"Subtitle Type":this.options.voice.elevenLabsId?"elevenlabs":"google","Music and Broll Duration":d-l,"Music Type":this.musicSource,"Total Duration":c-t}),rR({time:0})}}const Ule="GenerateVideoButton-module_generateButton_RhsgN",Ble="GenerateVideoButton-module_disabledButton_L1a1n";function Vle({onClick:e,disabled:t,text:o}){return w.jsx("button",{className:t?Ble:Ule,onClick:t?void 0:e,disabled:t,children:o})}const Wle="SubtitleStyles-module_label_ACoAw",Gle="SubtitleStyles-module_container_b-NjG",Hle="SubtitleStyles-module_presets_iTwTt",$le="SubtitleStyles-module_presetContainer_G6QqZ",Kle="SubtitleStyles-module_content_XhNDw",zle="SubtitleStyles-module_scrollButtonRight_xJrQz",Yle="SubtitleStyles-module_scrollButtonLeft_NWZpB";function Jle({preset:e,isSelected:t,setSelectedPreset:o}){const a=h.useCallback((()=>{o(e)}),[e,o]);return w.jsx("div",{className:$le,children:w.jsx(sZ,{preset:e,isSelected:t,onClickPreset:a,viewOnly:!0})})}const qle=hg,Xle=_.memo((function({setSelectedPreset:e,selectedPreset:t}){var o;const a=h.useRef(null),[i,n]=h.useState(0),[r,l]=h.useState(10),{presets:d,brandkitPresets:c}=xU(),u=[...c,...d].filter((e=>e.presetId!==qle.presetId)),m=[qle,...u],p=h.useMemo((()=>s.debounce((()=>{if(!a.current)return;const{scrollLeft:e,scrollWidth:t,clientWidth:o}=a.current,i=t-e-o;n(e),l(i)}),150)),[]),g=((null==(o=a.current)?void 0:o.clientWidth)||256)-30,f=h.useCallback((()=>{const e=a.current;if(!e)return;const{scrollLeft:t}=e,o=t+g;e.scroll({left:o,behavior:"smooth"})}),[g]),y=h.useCallback((()=>{const e=a.current;if(!e)return;const{scrollLeft:t}=e,o=t-g;e.scroll({left:o>0?o:0,behavior:"smooth"})}),[g]);return w.jsxs("div",{className:Gle,children:[w.jsx("span",{className:Wle,children:"Styles"}),w.jsxs("div",{className:Kle,children:[w.jsx("div",{className:Hle,ref:a,onScroll:p,children:m.map((o=>w.jsx(Jle,{preset:o,isSelected:o.presetId===t.presetId,setSelectedPreset:e},o.presetId)))}),i>5&&w.jsx("div",{className:Yle,onClick:y,children:w.jsx(wo,{size:18})}),r>5&&w.jsx("div",{className:zle,onClick:f,children:w.jsx(bo,{size:18})})]})]})})),Qle="VoiceOptions-module_label_z8yqM",Zle="VoiceOptions-module_labelRow_t6iIV",ede="VoiceOptions-module_voiceWrapper_wJ2EA",tde="VoiceOptions-module_dropdownContainer_A1XB-",ode="VoiceOptions-module_dropdownMenu_f1L3p",ade="PreviewAudioButton-module_previewButton_bzd7i";function ide({selectedVoice:e,tab:t}){const{prompt:o,script:a}=tl((e=>({prompt:e.studioLocal.ai.videoGeneratorPrompt||"",script:e.studioLocal.ai.scriptToVideoPrompt||""})),ol),i="Video"===t?o:a,[s,n]=h.useState(!1),r=HW(),l=h.useCallback((async()=>{if(s)r.pause(),r.currentTime=0,n(!1);else{n(!0);(""===Rle(i)||e.elevenLabsId)&&(r.src=e.sampleURL||""),Fm(ym.TEXT_TO_SPEECH_AUDIO_PREVIEW,{Voice:e.label,Source:"AI Overlay"}),r.onended=()=>{n(!1)},r.play()}}),[s,r,i,e]);if(e.sampleURL)return w.jsx("div",{className:ade,onClick:l,children:s?w.jsx(To,{}):w.jsx(xo,{})})}const sde=jre.map((e=>({label:e,value:e})));function nde({setSelectedLanguage:e,setSelectedVoice:t,selectedLanguage:o,selectedVoice:a,tab:i}){const{activeBrandkit:s}=tl((e=>({activeBrandkit:e.teams.activeBrandkit})),ol),n=h.useMemo((()=>{var e;const t=Cre[o].map((e=>({label:e.label,value:e.name})));if(Are(o)){return[...(null==(e=null==s?void 0:s.clonedVoices)?void 0:e.map((e=>({label:e.name,value:`eleven-labs-clone-${e.name}`}))))||[],...t]}return t}),[null==s?void 0:s.clonedVoices,o]),r=h.useCallback((o=>{const a=o;e(a),t(Cre[a][0])}),[e,t]),l=h.useCallback((e=>{var a;const i=Are(o)&&(null==(a=null==s?void 0:s.clonedVoices)?void 0:a.find((t=>e===`eleven-labs-clone-${t.name}`)));if(i){const e={label:i.name,name:`eleven-labs-clone-${i.name}`,languageCode:"fr-FR",elevenLabsId:i.voiceId,isClone:!0};t(e)}else{const a=Cre[o],i=a.findIndex((t=>t.name===e)),s=a[i]||a[0];t(s)}}),[null==s?void 0:s.clonedVoices,o,t]);return w.jsx("div",{children:w.jsxs("div",{className:ede,children:[w.jsxs("div",{className:tde,children:[w.jsx("div",{className:Zle,children:w.jsx("div",{className:Qle,children:"Language of Text Input"})}),w.jsx(bQ,{className:ode,value:o,listItems:sde,onChange:r})]}),w.jsxs("div",{className:tde,children:[w.jsxs("div",{className:Zle,children:[w.jsx("div",{className:Qle,children:"Narration Voice"}),w.jsx(ide,{selectedVoice:a,tab:i})]}),w.jsx(bQ,{className:ode,value:a.name,listItems:n,onChange:l})]})]})})}const rde="Preview-module_preview_Baf3Q",lde="Preview-module_previewBlur_AgEK9",dde="Preview-module_container_SJvyd",cde="Preview-module_text_CUmgc";function ude({selectedSize:e,selectedPreset:t}){let o={width:"80%",aspectRatio:"1/1"},a="50%";switch(e.key){case"9:16":o={width:"55%",aspectRatio:"9/16"},a="70%";break;case"16:9":o={width:"100%",aspectRatio:"16/9"},a="30%";break;case"4:5":o={width:"80%",aspectRatio:"4/5"},a="70%";break;case"5:4":o={width:"100%",aspectRatio:"5/4"},a="50%"}return w.jsxs("div",{className:dde,children:[w.jsx("div",{className:rde,style:o,children:w.jsx("div",{className:lde})}),w.jsx("div",{className:cde,style:{marginTop:a},children:w.jsx(tZ,{preset:t,width:100,height:100})})]})}const mde={wrapper:"ScriptToVideo-module_wrapper_ztg5-",controls:"ScriptToVideo-module_controls_suzaU",controlsSmall:"ScriptToVideo-module_controlsSmall_3rQeE",promptRow:"ScriptToVideo-module_promptRow_EAZfO",charCount:"ScriptToVideo-module_charCount_Fq0Ub",row:"ScriptToVideo-module_row_uHlnZ",promptDropdownDiv:"ScriptToVideo-module_promptDropdownDiv_RmWJG",label:"ScriptToVideo-module_label_bm-Kd",input:"ScriptToVideo-module_input_fC98a",textAreaWrapper:"ScriptToVideo-module_textAreaWrapper_8915z",textarea:"ScriptToVideo-module_textarea_O0Kgx",previewWrapper:"ScriptToVideo-module_previewWrapper_Z4GPj",resultsWrapper:"ScriptToVideo-module_resultsWrapper_I5DtK",previewHint:"ScriptToVideo-module_previewHint_MoKuL",previewContainer:"ScriptToVideo-module_previewContainer_ospQq",preview:"ScriptToVideo-module_preview_N9clN",previewBlur:"ScriptToVideo-module_previewBlur_yf-kD",previewText:"ScriptToVideo-module_previewText_uBE59",generateContainer:"ScriptToVideo-module_generateContainer_LjFmB",generateButton:"ScriptToVideo-module_generateButton_6vwEe",disabled:"ScriptToVideo-module_disabled_N8tib",loader:"ScriptToVideo-module_loader_3kA3i",spin:"ScriptToVideo-module_spin_bB79G",darkLoader:"ScriptToVideo-module_darkLoader_LxNmS",resultsContainer:"ScriptToVideo-module_resultsContainer_p-xIp",emptyState:"ScriptToVideo-module_emptyState_S8AOV",upsellContainer:"ScriptToVideo-module_upsellContainer_tx34N",examplesWrapper:"ScriptToVideo-module_examplesWrapper_llpdq",example:"ScriptToVideo-module_example_MMBOi",container:"ScriptToVideo-module_container_ZxnCv",toggleSpace:"ScriptToVideo-module_toggleSpace_7GnMt",toggleContainer:"ScriptToVideo-module_toggleContainer_3QhbN",toggleText:"ScriptToVideo-module_toggleText_qJ-Q3",selected:"ScriptToVideo-module_selected_s3pgU",textRow:"ScriptToVideo-module_textRow_uefs4",textArea:"ScriptToVideo-module_textArea_xXfKM"},pde="KapwingToggle-module_toggleOff_q7jFs",hde="KapwingToggle-module_toggleOn_TmAXQ",gde="KapwingToggle-module_sliderOff_y0WaS",fde="KapwingToggle-module_sliderOn_WEJhJ",yde="KapwingToggle-module_label_8qRQo",vde="KapwingToggle-module_container_trUV8",_de="KapwingToggle-module_grayBg_7q4Xs",wde="KapwingToggle-module_whiteBg_nGrab",bde=_.memo((({toggled:e,onClick:t,children:o,theme:a,testId:i})=>{const s=a===RF.Workspace?`${pde} ${_de}`:pde,n=a===RF.Workspace?`${gde} ${wde}`:gde;return w.jsxs("div",{className:vde,children:[w.jsx("div",{className:yde,children:o}),w.jsx("div",{className:e?hde:s,onClick:t,"data-testid":`${i}-kapwing-toggle`,children:w.jsx("div",{className:e?fde:n})})]})})),Tde="RoyaltyFreeToggle-module_sparkle_0jfGg",xde="RoyaltyFreeToggle-module_container_xWuwR";function Sde(){var e;const t=NU(Bl.ROYALTY_FREE),o=tl((e=>e.currentUser));return t&&!!(null==(e=null==o?void 0:o.user)?void 0:e.royaltyFreePreference)}function Ede(){const e=bW(),t=NU(Bl.ROYALTY_FREE),o=Sde(),a=h.useCallback((()=>{if(t)mp(!o);else{e((()=>mp(!o)),{action:Vl.ROYALTY_FREE})()}}),[t,e,o]);return w.jsx("div",{className:xde,children:w.jsxs(bde,{toggled:o,onClick:a,children:["Royalty-free only",!t&&w.jsx(EW,{className:Tde})]})})}const Ide=_.memo((({onClose:e,setLoading:t,setCancelFn:o,enforceSignIn:a,setLoadingTime:i})=>{const[s,n]=h.useState(!1),[r,l]=h.useState(!1),d=wQ(),c=il(),u=h.useCallback((e=>{if("generate-script"!==e.type)return;l(!0);const{duration:t,platform:o,topic:a}=e;o&&j(o),t&&k(e.duration),c(cw({scriptGeneratorPrompt:a}))}),[c]),{script:m}=tl((e=>({script:e.studioLocal.ai.scriptToVideoPrompt||""})),ol),p=h.useCallback((e=>{c(cw({scriptToVideoPrompt:e}))}),[c]),[g,f]=h.useState(function(){const{state:e}=sr(),{ratio:t}=e.studio;return Xse.find((e=>e.key===t))||Xse[1]}()),[y,v]=h.useState("English (US)"),[_,b]=h.useState(Cre[y][0]),[T,x]=h.useState(function(){var e;const{state:t}=sr();return(null==(e=t.studio.magicSubtitlesGlobal)?void 0:e.preset)||qle}()),[S,E]=h.useState(!1),{topic:I}=tl((e=>({topic:e.studioLocal.ai.scriptGeneratorPrompt||""})),ol),[C,k]=h.useState(30),[A,j]=h.useState(fre[0].name),[N,R]=h.useState(!1),P=NU(Bl.GENERATE_SCRIPT_TO_VIDEO),D=NU(Bl.ROYALTY_FREE),O=Sde(),L=_Q(),F=!P&&(!L[Oc.TTS]||m.length/750>=L[Oc.TTS].remainingUsage),M=bW(),U=tl((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedScriptToVideo}))||0,B=tl((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedScriptsInScriptToVideo}))||0,V=h.useCallback((()=>{const e=Rle(m);return 0===e.length?(hh({description:"Please enter a script to generate a video."}),null):e}),[m]),W=S||0===m.length||m.trim().length>=5e3||F,G=h.useCallback((async()=>{const a=V();if(!W&&a){_.elevenLabsId?i(140):i(70),t(!0),Fm(ym.STARTED_SCRIPT_TO_VIDEO_GENERATOR,{"Script Length":a.length,"Script Preview":XX(a,100),"Aspect Ratio":g.key,Voice:`${_.label} - ${_.languageCode} - ${_.name}`,"Premium Voice":void 0!==_.elevenLabsId,"Preset ID":T.presetId,"Used Past Prompt":s});try{const t=new Mle({script:a,size:g,language:y,voice:_,preset:T,includeGetty:D,royaltyFree:O,tab:one.ScriptToVideo,usingPastPrompt:s});o((()=>()=>t.cancel())),await t.generate(),PP({[Oc.TTS]:a.length/750}),Dne("generatedScriptToVideo"),e()}catch(IGe){const{message:t}=ph(IGe);Fm(ym.SCRIPT_TO_VIDEO_GENERATOR_FAILED,{Error:t}),mh({description:"Failed to generate script to video.",error:IGe})}t(!1)}}),[V,W,_,t,g,T,i,y,D,O,s,o,e]),H=d(M((()=>G()),{action:Vl.GENERATE_SCRIPT_TO_VIDEO,if:U>=2}),{[Oc.AI_GENERATE]:1}),$=h.useCallback((async()=>{R(!0),Fm(ym.STARTED_SCRIPT_GENERATOR,{Topic:I,Platform:A,Duration:C,Tab:one.ScriptToVideo,"Used Past Prompt":r});try{await wre({topic:I,selectedPlatform:A,selectedDuration:C,setCancelFn:o,scriptToVideo:!0,tab:one.Script}),Dne("generatedScriptsInScriptToVideo")}catch(IGe){mh({description:"Failed to generate script.",error:IGe})}"YouTube"===A&&f(Xse[2]),R(!1),E(!1)}),[C,A,o,I,r]),K=d(M((()=>$()),{action:Vl.GENERATE_SCRIPT_IN_SCRIPT_TO_VIDEO,if:B>=2}),{[Oc.AI_GENERATE]:1});const z=h.useCallback((e=>{if("script-to-video"!==e.type)return;n(!0);const{script:t,voice:o,preset:a,size:i,language:s}=e;t&&p(t),o&&b(o),a&&x(a),i&&f(i),s&&v(s)}),[p]);return w.jsxs("div",{className:mde.container,children:[w.jsxs("div",{className:`${mde.controls} ${mde.toggleSpace}`,children:[w.jsxs("div",{className:mde.toggleContainer,children:[w.jsx("div",{className:S?mde.toggleText:`${mde.toggleText} ${mde.selected}`,onClick:()=>E(!1),children:"Paste a script"}),w.jsx("div",{className:S?`${mde.toggleText} ${mde.selected}`:mde.toggleText,onClick:()=>E(!0),children:"Generate new script"})]}),S?w.jsxs("div",{children:[w.jsx(Ane,{title:"Script Topic",placeholder:"Generate a video script about...",value:I||"",tab:one.Script,setPrompt:function(e){c(cw({scriptGeneratorPrompt:e}))},setPromptFromPastJob:u,type:"generate-script",promptKey:"topic",maxCharLength:1e3,samplePrompts:xre,requirePastJobsToMatchTab:!0}),w.jsx("div",{className:mde.row,children:w.jsx(Yse,{label:"Approximate Script Duration",selectedDuration:C,setSelectedDuration:k})}),w.jsx("div",{className:mde.row,children:w.jsx(yre,{selectedPlatform:A,setSelectedPlatform:j})}),(()=>{if(P)return null;const e=Math.max(2-B,0);if(e>1)return null;const t=Lse(Ose.SCRIPT,e);return w.jsx("div",{className:mde.upsellContainer,children:w.jsx(kse,{warning:t,action:Vl.GENERATE_SCRIPT_IN_SCRIPT_TO_VIDEO,buttonText:"Upgrade"})})})(),w.jsx("button",{type:"button",className:[mde.generateButton,(!I||N)&&mde.disabled].join(" "),disabled:!I||N||I.length>1e3,onClick:a(K),children:N?"Generating Script...":"Generate Script"})]}):w.jsxs(w.Fragment,{children:[w.jsx(Ane,{setPrompt:p,value:m,type:"script-to-video",promptKey:"script",setPromptFromPastJob:z,tab:one.ScriptToVideo,requirePastJobsToMatchTab:!0,placeholder:"Copy and paste your script here, and Kapwing AI will create a video from your script. For best results, use a script with at least 500 characters.",maxCharLength:5e3,rowClass:mde.textRow,textWrapperClass:mde.textAreaWrapper,className:mde.textArea}),w.jsx(nde,{selectedVoice:_,selectedLanguage:y,setSelectedVoice:b,setSelectedLanguage:v,tab:"scriptToVideo"}),w.jsx(tne,{selectedSize:g,setSelectedSize:f}),w.jsx(Xle,{selectedPreset:T,setSelectedPreset:x})]})]}),w.jsxs("div",{className:mde.previewWrapper,children:[w.jsx("div",{className:mde.previewHint,children:"This is just a preview of the size and style of your video. click Generate Video to start the creation process."}),w.jsx("div",{className:mde.previewContainer,children:w.jsx(ude,{selectedSize:g,selectedPreset:T})}),!S&&(()=>{if(P){if(L[Oc.AI_GENERATE]&&L[Oc.AI_GENERATE].hasConsumedLimit){const e=Lse(Ose.VIDEO_FROM_SCRIPT,0);return w.jsx("div",{className:mde.upsellContainer,children:w.jsx(kse,{warning:e,action:Vl.GENERATE_SCRIPT_TO_VIDEO,buttonText:"Upgrade"})})}return}const e=Math.max(2-U,0);if(0===e){const e=Lse(Ose.VIDEO_FROM_SCRIPT,0);return w.jsx("div",{className:mde.upsellContainer,children:w.jsx(kse,{warning:e,action:Vl.GENERATE_SCRIPT_TO_VIDEO,buttonText:"Upgrade"})})}if(F)return w.jsx("div",{className:mde.upsellContainer,children:w.jsx(kse,{warning:"This generation would exceed the free limit for text to speech minutes. Upgrade for increased minutes.",action:Vl.TEXT_TO_SPEECH,buttonText:"Upgrade"})});if(e>0&&e<=2){const t=Lse(Ose.VIDEO_FROM_SCRIPT,e);return w.jsx("div",{className:mde.upsellContainer,children:w.jsx(kse,{warning:t,action:Vl.GENERATE_SCRIPT_TO_VIDEO,buttonText:"Upgrade"})})}})(),w.jsx(Vle,{disabled:W,onClick:a(H),text:"Generate Video from Script"})]})]})})),Cde={wrapper:"Document-module_wrapper_-C4XK",controls:"Document-module_controls_n41xD",controlsSmall:"Document-module_controlsSmall_-VDKr",promptRow:"Document-module_promptRow_jxMK3",charCount:"Document-module_charCount_jLrVQ",row:"Document-module_row_XHvHn",promptDropdownDiv:"Document-module_promptDropdownDiv_IXrM6",label:"Document-module_label_tK31f",input:"Document-module_input_oh3qz",textAreaWrapper:"Document-module_textAreaWrapper_4Q-Cm",textarea:"Document-module_textarea_5teTd",previewWrapper:"Document-module_previewWrapper_ajYam",resultsWrapper:"Document-module_resultsWrapper_NnHd3",previewHint:"Document-module_previewHint_2gQlm",previewContainer:"Document-module_previewContainer_R4An6",preview:"Document-module_preview_2OwFC",previewBlur:"Document-module_previewBlur_zo97p",previewText:"Document-module_previewText_NAyw4",generateContainer:"Document-module_generateContainer_gIrvZ",generateButton:"Document-module_generateButton_qs98B",disabled:"Document-module_disabled_dKCyU",loader:"Document-module_loader_YzJBX",spin:"Document-module_spin_QslJ-",darkLoader:"Document-module_darkLoader_fQt77",resultsContainer:"Document-module_resultsContainer_bHxni",emptyState:"Document-module_emptyState_tohp3",upsellContainer:"Document-module_upsellContainer_HJLeK",examplesWrapper:"Document-module_examplesWrapper_OAsVP",example:"Document-module_example_GzG9p",oneOne:"Document-module_oneOne_4D2qA",nineSixteen:"Document-module_nineSixteen_H3Bgi",sixteenNine:"Document-module_sixteenNine_NuiJZ",fourFive:"Document-module_fourFive_3GqtH",fiveFour:"Document-module_fiveFour_tsP0y",sizeWrapper:"Document-module_sizeWrapper_CMRli",sizeContainer:"Document-module_sizeContainer_E3-gQ",sizePreviewBackground:"Document-module_sizePreviewBackground_7yNue",optionLabel:"Document-module_optionLabel_h6CkP",sizePreview:"Document-module_sizePreview_KwMvi",textStylesWrapper:"Document-module_textStylesWrapper_DE4Wi",textStylesContainer:"Document-module_textStylesContainer_mj6kM",textStylesPreviewBackground:"Document-module_textStylesPreviewBackground_re8-G",textPreview:"Document-module_textPreview_-EUfX",classicDark:"Document-module_classicDark_Qk7NO",highlightedText:"Document-module_highlightedText_vAPnG",classicLight:"Document-module_classicLight_x2NF2",highlight:"Document-module_highlight_E8H0X",typewriter:"Document-module_typewriter_g6IJa",newLeaf:"Document-module_newLeaf_M07QC",active:"Document-module_active_xNNep"},kde=_.memo((({setLoading:e,onClose:t,setCancelFn:o,enforceSignIn:a})=>{const i=il(),[s,n]=h.useState(!1),r=tl((e=>e.studioLocal.ai.documentToVideoPrompt)),[l,d]=h.useState(Xse[0]),[c,u]=h.useState(Tse[0]),[m,p]=h.useState(!1),g=bW(),f=NU(Bl.GENERATE_DOCUMENT_TO_VIDEO),y=tl((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedDocumentToVideo}))||0,v=wQ(),_=h.useCallback((async()=>{var a;if(r&&r.trim()){Fm(ym.STARTED_DOCUMENT_TO_VIDEO_GENERATOR,{Style:c.label,"Aspect Ratio":l.key,Document:r.slice(0,40),"Used Past Prompt":s}),p(!0),e(!0);try{const s=await Jr("/api/v1/ai/summarize",{body:{document:r,teamId:null==(a=Hu())?void 0:a._id,selectedTextStyle:c,selectedSize:l}});if(!s||!s.summary)throw new Error("Received an unexpected GPT response.");const{summary:n}=s;window.summary=n;try{const a=new CH;o((()=>()=>{a.cancel(),i(cw({documentToVideoPrompt:""}))}));const s=await Dse(n,a,{tab:one.DocumentToVideo});if(a.cancelled)return p(!1),void e(!1);const d="string"==typeof n?n.slice(0,40):r.slice(0,40),u=new bse(d,{backgroundOpacity:c.styles.backgroundAlpha,fontBackgroundColor:c.styles.backgroundColor,fontDefaultColor:c.styles.textColor,fontFamily:c.styles.fontFamily,fontHighlightColor:c.styles.highlightTextColor,aspectRatio:l.key});o((()=>()=>{u.cancel(),i(cw({documentToVideoPrompt:""}))})),u.analyticsType="document",await u.generate(s),Dne("generatedDocumentToVideo"),t()}catch(IGe){IGe instanceof jse?i(wl({type:"warning",description:IGe.message})):(console.error({e:IGe}),mh({description:"Received an unexpected GPT response.",error:IGe}))}}catch(IGe){mh({description:"Could not preprocess your document. Please try again.",error:IGe})}e(!1),p(!1)}else i(wl({type:"warning",description:"Enter your text to convert a document to to video. For best results, use at least 500 characters."}))}),[r,c,l,s,e,i,o,t]),b=v(g((()=>_()),{action:Vl.GENERATE_DOCUMENT_TO_VIDEO,if:y>=2}),{[Oc.AI_GENERATE]:1}),T=()=>{if(f)return null;const e=Math.max(2-y,0);if(e>1)return null;const t=Lse(Ose.VIDEO_FROM_DOCUMENT,e);return w.jsx("div",{className:Cde.upsellContainer,children:w.jsx(kse,{warning:t,action:Vl.GENERATE_DOCUMENT_TO_VIDEO,buttonText:"Upgrade"})})},x=h.useCallback((e=>{if("summarize"!==e.type)return;const{selectedSize:t,selectedStyle:o,document:a}=e;o&&u(o),t&&d(t),i(cw({documentToVideoPrompt:a})),n(!0)}),[i]),S=h.useCallback((e=>{i(cw({documentToVideoPrompt:e}))}),[i]);return w.jsxs("div",{className:Cde.wrapper,children:[w.jsxs("div",{className:Cde.controls,children:[w.jsx(Ane,{title:"Topic",tab:one.DocumentToVideo,type:"summarize",setPromptFromPastJob:x,promptKey:"document",setPrompt:S,className:Cde.textarea,placeholder:"Copy and paste the contents of your document here, and Kapwing AI will create a video from your document. For best results, use a document with at least 500 characters.",value:r||"",rows:20}),w.jsxs("div",{className:Cde.row,children:[w.jsx("div",{className:Cde.label,children:"Size"}),w.jsx("div",{className:Cde.sizeWrapper,children:Xse.map((e=>{const{key:t,className:o}=e;let a=Cde.sizePreviewBackground;return t===l.key&&(a+=` ${Cde.active}`),w.jsxs("div",{className:Cde.sizeContainer,onClick:()=>{d(e)},children:[w.jsx("div",{className:a,children:w.jsx("div",{className:`${Cde[o]} ${Cde.sizePreview}`})}),w.jsx("div",{className:Cde.optionLabel,children:t})]},t)}))})]}),w.jsxs("div",{className:Cde.row,children:[w.jsx("div",{className:Cde.label,children:"Text Style"}),w.jsx("div",{className:Cde.textStylesWrapper,children:Tse.map((e=>{const{label:t,className:o}=e;let a=Cde.textStylesPreviewBackground;return t===c.label&&(a+=` ${Cde.active}`),w.jsxs("div",{className:Cde.textStylesContainer,onClick:()=>u(e),children:[w.jsx("div",{className:a,children:w.jsxs("div",{className:`${Cde[o]} ${Cde.textPreview}`,children:["Your"," ",w.jsx("span",{className:Cde.highlightedText,children:"AI-generated"})," ","captions here"]})}),w.jsx("div",{className:Cde.optionLabel,children:t})]},o)}))})]})]}),w.jsxs("div",{className:Cde.previewWrapper,children:[w.jsx("div",{className:Cde.previewHint,children:"This is just a preview of the size and style of your video. Click Generate Video to start the creation process."}),(()=>{let e={width:"80%",aspectRatio:"1/1"};switch(l.key){case"9:16":e={width:"55%",aspectRatio:"9/16"};break;case"16:9":e={width:"100%",aspectRatio:"16/9"};break;case"4:5":e={width:"80%",aspectRatio:"4/5"};break;case"5:4":e={width:"100%",aspectRatio:"5/4"}}return w.jsx("div",{className:Cde.previewContainer,children:w.jsx("div",{className:Cde.preview,style:e,children:w.jsx("div",{className:Cde.previewBlur,children:w.jsxs("div",{className:`${Cde.previewText} ${Cde[c.className]}`,children:["Kapwing AI will"," ",w.jsxs("span",{className:Cde.highlightedText,children:["generate a ",l.key," video"]})," ","from your document."]})})})})})(),m?w.jsxs("div",{className:Cde.generateContainer,children:[T(),w.jsxs("div",{className:`${Cde.generateButton} ${Cde.disabled}`,children:[w.jsx("span",{children:"Generating video ..."}),w.jsx("div",{className:Cde.loader})]})]}):w.jsxs("div",{className:Cde.generateContainer,children:[T(),w.jsx("button",{type:"button",className:[Cde.generateButton,r?"":Cde.disabled].join(" "),disabled:!r,onClick:a(b),children:"Generate Video from Document"})]})]})]})})),Ade="AiOverlay-module_background_-RaFH",jde="AiOverlay-module_wrapper_OfMsw",Nde="AiOverlay-module_modal_JJXJY",Rde="AiOverlay-module_loadingWrapper_UWXsY",Pde="AiOverlay-module_grid_8OsJX",Dde="AiOverlay-module_container_WgC14",Ode="AiOverlay-module_header_aEecZ",Lde="AiOverlay-module_headerIcon_ElzuD",Fde="AiOverlay-module_headerText_wCBjK",Mde="AiOverlay-module_close_rQTQH",Ude="AiOverlay-module_beta_w-uS6",Bde="AiOverlay-module_tabs_-TXHC",Vde="AiOverlay-module_tab_vuMXJ",Wde="AiOverlay-module_active_yFmuK",Gde="AiOverlay-module_tabIcon_0KhOz",Hde="AiOverlay-module_tabHeader_eivMq",$de={container:"InputBar-module_container_u95A0",input:"InputBar-module_input_ScrVD",icon:"InputBar-module_icon_IuHy5",button:"InputBar-module_button_VRN7H",title:"InputBar-module_title_haULU",beta:"InputBar-module_beta_SbmjS",dropdown:"InputBar-module_dropdown_I5zy5",collapsed:"InputBar-module_collapsed_U1dNf",option:"InputBar-module_option_Vklct",selected:"InputBar-module_selected_Ozuyg",dropUpContainer:"InputBar-module_dropUpContainer_YoCIK",dropUpItem:"InputBar-module_dropUpItem_2w1Sd",chevron:"InputBar-module_chevron_4Xow0",dropUpItemSelected:"InputBar-module_dropUpItemSelected_5iSiR",query:"InputBar-module_query_Zhe7L",returnIcon:"InputBar-module_returnIcon_101gZ",itemIcon:"InputBar-module_itemIcon_ipvES"},Kde=[{key:"aiVideoGenerator",label:"Create a video about",placeholder:"Create a video about...",icon:w.jsx(oo,{className:$de.itemIcon}),showTopicPreview:!0,tab:one.Video},{key:"aiImageGenerator",label:"Create an image about",placeholder:"Create an image about...",icon:w.jsx(lo,{className:$de.itemIcon}),showTopicPreview:!0,tab:one.Image},{key:"aiMemeGenerator",label:"Create a meme about",placeholder:"Create a meme about...",icon:w.jsx(so,{className:$de.itemIcon}),showTopicPreview:!0,tab:one.Meme},{key:"aiScriptGenerator",label:"Create a video script about",placeholder:"Create a video script about...",icon:w.jsx(io,{className:$de.itemIcon}),showTopicPreview:!0,tab:one.Script},{key:"aiScriptToVideoGenerator",label:"Script to Video",icon:w.jsx(ao,{className:$de.itemIcon}),showTopicPreview:!1,tab:one.ScriptToVideo},{key:"aiDocumentToVideo",label:"Document to Video",icon:w.jsx(co,{className:$de.itemIcon}),showTopicPreview:!1,tab:one.DocumentToVideo},{key:"aiArticleToVideo",label:"Article to Video",icon:w.jsx(ro,{className:$de.itemIcon}),showTopicPreview:!1,tab:one.ArticleToVideo}],zde=e=>{let t=Kde.find((t=>t.key===e));return t||(t=Kde[0]),t},Yde=(e,t)=>{const{ogUrl:o,ogImage:a}=e,i={...e};try{const e=new URL(t).hostname;if(o&&!o.startsWith("http")){let t=o;t=o.startsWith("/")?`https://${e}${o}`:`https://${e}/${o}`,i.ogUrl=t}const s=[];if(a&&a.length>0)for(const t of a)t.url&&!t.url.startsWith("http")&&(t.url.startsWith("/")?t.url=`https://${e}${t.url}`:t.url=`https://${e}/${t.url}`),s.push(t)}catch(IGe){return i}return i},Jde=(e,t)=>{try{const o=[],a=new URL(t).hostname;for(const t of e){const{imgUrl:e}=t;a&&e&&!e.startsWith("http")&&(t.imgUrl.startsWith("/")?t.imgUrl=`https://${a}${e}`:t.imgUrl=`https://${a}/${e}`),o.push(t)}return o}catch(IGe){return e}},qde="OGPreview-module_wrapper_lUYMZ",Xde="OGPreview-module_container_zmTDH",Qde="OGPreview-module_image_WQZTE",Zde="OGPreview-module_text_oDbaT",ece="OGPreview-module_title_rQ2P3",tce="OGPreview-module_description_tdn56",oce="OGPreview-module_url_lhceo",ace="OGPreview-module_close_1WyAB",ice=({str:e,maxLen:t,separator:o=" "})=>e?e.length<=t?e:`${e.substr(0,e.lastIndexOf(o,t))}...`:"",sce=_.memo((({fallbackUrl:e,handleReset:t})=>{var o;const a=tl((e=>e.studioLocal.articleToVideo.ogTags)),{ogUrl:i,ogTitle:s,ogDescription:n,ogImage:r}=Yde(a,e),l=null==(o=null==r?void 0:r[0])?void 0:o.url,d=ice({str:s,maxLen:90}),c=ice({str:n,maxLen:150});let u=e;try{u=new URL(i||e).hostname.replace("www.","")}catch(IGe){}return w.jsxs("div",{className:qde,children:[w.jsx("div",{className:ace,onClick:t,children:w.jsx(ve,{})}),w.jsxs("a",{href:i||e,target:"_blank",rel:"noopener noreferrer",className:Xde,children:[w.jsx("img",{src:l||"https://placekitten.com/g/1200/630",alt:s,className:Qde}),w.jsxs("div",{className:Zde,children:[u&&w.jsx("div",{className:oce,children:u}),d&&w.jsx("div",{className:ece,children:d}),w.jsx("div",{className:tce,children:c||e})]})]})]})}));class nce{constructor(e,{backgroundOpacity:t,fontBackgroundColor:o,fontDefaultColor:a,fontHighlightColor:s,fontFamily:n,aspectRatio:r,duration:l,usedPastPrompt:d}={usedPastPrompt:!1}){i(this,"outline",null),i(this,"topic"),i(this,"aspectRatio","16:9"),i(this,"backgroundOpacity",.9),i(this,"fontBackgroundColor","#000000"),i(this,"fontDefaultColor","#ffffff"),i(this,"fontHighlightColor","#FFCD1D"),i(this,"fontFamily","Montserrat"),i(this,"timelineOffsetSeconds",0),i(this,"usedPastPrompt"),i(this,"cancellationSource",new CH),i(this,"targetDuration"),i(this,"generate",(async()=>{if(!nce.isValidOutline(this.outline))throw new Error("Invalid article outline");const{dispatch:e}=sr();if(!this.outline)return;this.checkTimelineForOverlap();let t=0;const o=[],a=[],i=[],s=this.outline.reduce(((e,t)=>e+t.text.split(" ").length),0),n=this.targetDuration/s;for(const c of this.outline){const{text:e}=c,s=e.split(" ").length*n,r=oe.v4(),l=oe.v4();a.push({id:l,animationName:Yl.Reveal,transitionDuration:2,isCrossTransition:!1,layerId:r});const d=this.getTextPosition();o.push({type:zl.Text,startTime:this.timelineOffsetSeconds+t,endTime:this.timelineOffsetSeconds+t+s,id:r,text:e,backgroundColor:iT(this.fontBackgroundColor,.7),color:"#FFFFFF",fontFamily:this.fontFamily,timelineRow:0,isTrimmed:!0,textShadow:"transparent",position:d,textAlign:"left",animation:{outro:[],intro:[l],constant:[]},globalAlpha:1,textPadding:10,lineHeight:1.15,fontWeight:"bold"}),i.push(this.addImageFromUrl({imageUrl:c.imageUrl,startTime:this.timelineOffsetSeconds+t,endTime:this.timelineOffsetSeconds+t+s})),t+=s}this.addTextHighlights(o),i.push(this.getAudioLayer(t));const[r,...l]=await Promise.allSettled([MY({fontToLoad:{type:"default",fontFamily:this.fontFamily}}),...i]);if(this.cancellationSource.cancelled)return;const d=l.map((e=>"rejected"===e.status?null:e.value)).filter((e=>null!==e));g.batch((()=>{e({type:"SHOW_STUDIO_CANVAS"}),e(bb(Kn.MP4)),e(lS(this.aspectRatio)),this.updateProjectName(),e(Tp({usedGenerateVideoFromArticle:!0,usedGenerateVideoFromArticlePastPrompt:this.usedPastPrompt})),a.forEach((t=>{e(Pv(t))})),e(Fv({layers:[...d,...o],isUndoable:!0})),TE(this.timelineOffsetSeconds)}));for(const c of d)c.asset_id&&HJ(c)&&JJ({assetId:c.asset_id,source:"Article to Video Generation"})})),this.usedPastPrompt=d,this.outline=e,this.targetDuration=l||60,this.topic="",e[0]&&e[0].text&&(this.topic=e[0].text),a&&(this.fontDefaultColor=a),o&&(this.fontBackgroundColor=o),s&&(this.fontHighlightColor=s),n&&(this.fontFamily=n),t&&(this.backgroundOpacity=t),r&&(this.aspectRatio=r)}cancel(){this.cancellationSource.cancel()}static isValidOutline(e){if(!e)return!1;if(!Array.isArray(e))return!1;for(const t of e){if("object"!=typeof t)return!1;if(!t)return!1;if(!("text"in t))return!1;if("string"!=typeof t.text)return!1}return!0}addTextHighlights(e){let t=[""];this.outline&&(t=(e=>{let t=[];for(const o of e){const e=o.keyword.toLowerCase().split(" ");t=t.concat(e)}return t})(this.outline));for(const o of e){if(o.type!==zl.Text)continue;const e=re.convertToRaw(re.ContentState.createFromText(o.text));if(!e.blocks[0])continue;let a=0,i=0,s=!0;for(const n of o.text.toLowerCase().split(" "))!cse.has(n)&&t.includes(n)?s&&(e.blocks[0].inlineStyleRanges.push({offset:i,length:a-i,style:`COLOR_${this.fontDefaultColor}`}),s=!1,i=a):s||(e.blocks[0].inlineStyleRanges.push({offset:i,length:a-i,style:`COLOR_${this.fontHighlightColor}`}),s=!0,i=a),a+=n.length+1;if(0===e.blocks[0].inlineStyleRanges.length){const t=o.text.split(" ");if(Math.round(Math.random()))e.blocks[0].inlineStyleRanges.push({offset:0,length:t.slice(0,3).join(" ").length,style:`COLOR_${this.fontHighlightColor}`}),s=!0,a=t.slice(0,3).join(" ").length+1,i=a;else{const n=t.slice(-3).join(" ").length;e.blocks[0].inlineStyleRanges.push({offset:0,length:o.text.length-n-1,style:`COLOR_${this.fontDefaultColor}`}),s=!1,a=o.text.length-n,i=a}}e.blocks[0].inlineStyleRanges.push({offset:i,length:o.text.length-i,style:s?`COLOR_${this.fontDefaultColor}`:`COLOR_${this.fontHighlightColor}`}),e.blocks[0].inlineStyleRanges.push({offset:0,length:o.text.length,style:"BOLD"}),o.draftJSTextTree=e}}async getAudioLayer(e){const{dispatch:t}=sr(),o=fse(e),{asset:a,cmlFile:i}=await B$(o.source);Mz(a,i);const s=await eY(o.source,{source:a.status===On.uploaded?"upload":"pastedLink",asset_id:a._id,url:a.status===On.uploaded?a.url:void 0,pastedUrl:o.source,cmlFileId:null==i?void 0:i.id,duration:o.metadata.duration,type:zl.Audio,isTrimmed:!0,startTime:0,endTime:e,videoDelay:this.timelineOffsetSeconds,timelineRow:2},{mediaInfo:{duration:o.metadata.duration,hasAudio:!0,type:zl.Audio,height:0,width:0}});return t(yu({assetId:a._id,mediaCacheId:oe.v4()})),s}static getKeyFrameAnimation(e,t){const o=.1*Math.random()+.05;return{id:"moving-zoom",name:"Moving Zoom",transitions:[{duration:t-e,easingFuncID:"linear",endValues:{bottomRight:{x:1-o,y:1-o},topLeft:{x:o,y:o}},startValues:{bottomRight:{x:1,y:1},topLeft:{x:0,y:0}},startTime:e,id:"moving-zoom-transition"}]}}async addImageFromUrl({imageUrl:e,startTime:t,endTime:o}){const{dispatch:a}=sr();if(this.cancellationSource.cancelled)throw new dse;const{asset:i,cmlFile:s}=await B$(e);Mz(i,s);const n=i.status===On.uploaded&&i.url||e,r=await eY(n,{source:i.status===On.uploaded?"upload":"pastedLink",startTime:t,endTime:o,isTrimmed:!0,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},crop:{x:0,y:0,width:100,height:100},pastedUrl:e,keyframeAnimation:nce.getKeyFrameAnimation(t,o),timelineRow:1,asset_id:i._id,volume:0},{mediaInfo:{type:zl.Image}});if(this.cancellationSource.cancelled)throw new dse;return a(yu({assetId:i._id,mediaCacheId:oe.v4()})),r}getTextPosition(){let e=0,t=90,o=20,a=Math.random()*(35-o)+55;switch(this.aspectRatio){case"9:16":t=76.5,o=15,e=0,a=54.5;break;case"16:9":t=55,o=30,e=5;break;case"1:1":e=5,t=60,o=25;break;case"4:5":e=0,t=80,o=25;break;case"5:4":e=0,t=70,o=25}return{x:`${3+e}%`,width:`${t}%`,height:`${o}%`,y:`${a}%`,rotation:0}}checkTimelineForOverlap(){const{studio:e}=sr().state,[t]=e.scenes;if(!t)return;const{duration:o}=uC(t,lT(e));this.timelineOffsetSeconds=o}async updateProjectName(){const{dispatch:e}=sr(),{studio:t,currentUser:o}=sr().state,a=XX(this.topic,25);if(e(SK(a)),t.projectId)try{await TK(t.projectId,{name:a},o)}catch(IGe){}}}const rce="OutlineImage-module_loading_2nMR8",lce="OutlineImage-module_loader_lS30j",dce="OutlineImage-module_imageContainer_tqRf8",cce="OutlineImage-module_image_TPpHe",uce="OutlineImage-module_refreshButton_CWG1q",mce="OutlineImage-module_refreshIcon_sP5dk",pce=_.memo((({slide:e,slideIndex:t})=>{const{outline:o,markdownImages:a}=tl((e=>({outline:e.studioLocal.articleToVideo.outline,markdownImages:e.studioLocal.articleToVideo.markdownImages})),ol),i=il(),{imageUrl:s,keyword:n}=e,r=h.useRef(!1),[l,d]=h.useState(!1),c=async()=>{d(!0);try{const l=e=>!!e&&o.some((t=>t.imageUrl===e));let c={...e,imageUrl:"https://cdn-useast1.kapwing.com/static/YdK-black-square.webp"};if(!r.current)for(let o=0;o<a.length;o+=1){const n=a[o];if(!n)continue;const{imgUrl:u,placeholderUrl:m}=n;if(!l(u)&&m===s)return c={...e,imageUrl:u},r.current=!0,d(!1),void i(mw({slideIndex:t,newSlide:c}))}const u=await PX(n+" photography",{useGoogleOnly:!0}),m=(e,t)=>Math.floor(Math.random()*(t-e+1)+e);let p=m(0,Math.min(10,u.google.length-1)),h=0,g=u.google[p];const f=Math.min(25,u.google.length-1);for(;h<f&&g&&g.url&&l(g.url)&&g.url===c.imageUrl;)h+=1,p=m(0,Math.min(25,u.google.length-1)),g=u.google[p];g&&g.url&&(c={...e,imageUrl:g.url}),d(!1),i(mw({slideIndex:t,newSlide:c}))}catch(l){d(!1),mh({description:"Error refetching image.",error:l})}};return w.jsxs("div",{className:dce,children:[s&&!l?w.jsx("img",{src:s,alt:n,onError:c,className:cce}):w.jsx("div",{className:rce,children:w.jsx("div",{className:lce})}),w.jsx("div",{className:uce,onClick:c,children:w.jsx(So,{className:mce})})]})})),hce={oneOne:"Outline-module_oneOne_JIydT",nineSixteen:"Outline-module_nineSixteen_XpF0B",sixteenNine:"Outline-module_sixteenNine_KLoso",fourFive:"Outline-module_fourFive_7tW8j",fiveFour:"Outline-module_fiveFour_avCZz",header:"Outline-module_header_4AD-s",title:"Outline-module_title_onLbe",helper:"Outline-module_helper_ivPoI",wrapper:"Outline-module_wrapper_-w3Th",container:"Outline-module_container_1iOgh",row:"Outline-module_row_SAMfc",actions:"Outline-module_actions_elDcA",actionButtons:"Outline-module_actionButtons_smL79",resetButton:"Outline-module_resetButton_wyZ-d",generateButton:"Outline-module_generateButton_L4mr7",disabled:"Outline-module_disabled_xIGIf",icon:"Outline-module_icon_VLJvM",leftIcon:"Outline-module_leftIcon_DHOTc",loader:"Outline-module_loader_BYl-N",load8:"Outline-module_load8_Tnuzq",optionsHeader:"Outline-module_optionsHeader_z6aw7",actionSingleRow:"Outline-module_actionSingleRow_p9yFT",sizeOptions:"Outline-module_sizeOptions_qIfDH",sizeOption:"Outline-module_sizeOption_9jZBN",selectedSizeOption:"Outline-module_selectedSizeOption_ioX9Q",sizePreviewBackground:"Outline-module_sizePreviewBackground_1sfgi",sizeText:"Outline-module_sizeText_TY8dQ"},gce="OutlineText-module_container_1bBUu",fce="OutlineText-module_textarea_1mLDu",yce="OutlineText-module_text_MwXDS",vce=_.memo((({slide:e,slideIndex:t})=>{const o=il(),{text:a}=e,i=h.useRef(null),[s,n]=h.useState(!1),[r,l]=h.useState(a);h.useEffect((function(){l(e.text)}),[e.text]),h.useEffect((function(){const a=a=>{if(i&&i.current&&a.target instanceof Element&&!i.current.contains(a.target)&&r){n(!1);const a={...e,text:r};o(mw({slideIndex:t,newSlide:a}))}};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}}),[i,o,e,t,r]);const d=()=>{n(!0)},c=e=>{const{target:t}=e;if(t&&t.value){const t=e.target.value;e.target.value="",e.target.value=t}},u=e=>{l(e.target.value)};return w.jsx("div",{className:gce,children:s?w.jsx("textarea",{className:fce,value:r,ref:i,autoFocus:!0,onFocus:c,onChange:u,children:r}):w.jsx("div",{onClick:d,className:yce,children:a})})})),_ce=_.memo((({reset:e,onClose:t,usedPastPrompt:o})=>{const a=il(),{outline:i,originalOutline:s}=tl((e=>({outline:e.studioLocal.articleToVideo.outline,originalOutline:e.studioLocal.articleToVideo.originalOutline})),ol),[n,r]=h.useState(!1),[l,d]=h.useState(!1),[c,u]=h.useState(Xse[2]);return w.jsxs("div",{className:hce.wrapper,children:[w.jsxs("div",{className:hce.container,children:[w.jsxs("div",{className:hce.header,children:[w.jsx("div",{className:hce.title,children:"Article to Video"}),w.jsx("div",{className:hce.helper,children:"We’ve parsed your article into a video outline. Review and edit the following outlined sections, and when you’re ready, click generate to create a finalized video based on the content below."})]}),l?null:w.jsx(w.Fragment,{children:i.map(((e,t)=>w.jsxs("div",{className:hce.row,children:[w.jsx(pce,{slide:e,slideIndex:t}),w.jsx(vce,{slide:e,slideIndex:t})]},t)))})]}),w.jsxs("div",{className:hce.actions,children:[w.jsx("div",{children:w.jsxs(w.Fragment,{children:[w.jsx("div",{className:hce.optionsHeader,children:"Video Size:"}),w.jsx("div",{className:hce.sizeOptions,children:Xse.map((e=>{let t=hce.sizeOption;return e.key===c.key&&(t=hce.selectedSizeOption),w.jsxs("div",{className:t,onClick:()=>u(e),children:[w.jsx("div",{className:`${hce.sizePreviewBackground} ${hce[e.className]}`}),w.jsx("div",{className:hce.sizeText,children:e.key})]},e.key)}))})]})}),w.jsxs("div",{className:hce.actionButtons,children:[w.jsxs("div",{className:hce.actionSingleRow,children:[w.jsxs("div",{className:hce.resetButton,onClick:e,children:[w.jsx(Eo,{className:hce.leftIcon})," Start Over"]}),w.jsx("div",{className:hce.resetButton,onClick:()=>{d(!0),a(uw({outline:s})),d(!1)},children:"Reset all changes"})]}),n?w.jsxs("div",{className:`${hce.generateButton} ${hce.disabled}`,children:[w.jsx("div",{className:hce.loader}),w.jsx("span",{children:"Loading... please wait"})," ",w.jsx(Io,{className:hce.icon})]}):w.jsxs("div",{className:hce.generateButton,onClick:async()=>{Fm(ym.ARTICLE_TO_VIDEO_GENERATOR_ADD_VIDEO_TO_CANVAS,{"Aspect Ratio":c.key}),r(!0);const e=new nce(i,{aspectRatio:c.key,usedPastPrompt:o});try{await e.generate(),t()}catch(IGe){mh({description:"Failed to generate video.",error:IGe})}r(!1)},children:["Generate video ",w.jsx(Io,{className:hce.icon})]})]})]})]})})),wce={markdown:'```\nHow Will GPT Change Video Editing\n\n![How Will GPT Change Video Editing](ogImage.jpg)\n\nAnnouncements\n\nMuch has been said about ChatGPT and new AI technologies that will change the ways people work. But how will it change video editing? Today, we introduced GPT tech into Kapwing. In this article, CEO Julia Enthoven shares her predictions for the future of Video Editing + AI.\n\n![How Will GPT Change Video Editing](0.jpg)\n\nSilicon Valley hasn’t been so active in years! We find ourselves in the center of a new hype cycle around Generative AI. In the last few weeks, we have changed our whole process to sprint on new GPT-powered features, and it’s been a long time when I’ve felt so energized about our product roadmap.\n\n*In case you don\'t want to read this article, Kapwing used AI to generate a summary video for you:*\n\nVideo edited on Kapwing\n\nCreate content faster with Kapwing\'s online video editor →\n\nWe’ve known since 2018 that AI would changed the way we do work. Last year, in 2022, we added 8 new ML-powered APIs into our video editing platform to automate tedious editing tasks. Creative teams love these features, and they represent our most popular and highly-retentive features on the website.\n\nToday, we’re introducing a set of 5 Generative AI features powered by GPT-4. Hundreds of people are using them already. Make videos from just a topic description, generate images, get meme ideas, transform documents into summary videos, and create a social media video script. Try them for free on Kapwing.\n\n![Image](1.jpg)\n\nThis is just the beginning. There’s so much more to come with the help of OpenAI’s LLM. In this article, I’ll share my perspective on how GPT and Generative AI change the game for creators and how we envision this taking shape at Kapwing.\n\nAI for Video Editing\n--------------------\n\nGPT-4 unlocks a new horizon for AI applications. I envision that it will change video editing in these key ways:\n\n**1) Creative Brainstorming.** AI helps to address the blank canvas, giving you a starting place to iterate from and new perspectives to consider. It will:\n\n*   Suggest new ideas and combinations for edit (fonts, sounds, face filters, effects, and more). Get inspired if you get stuck and experiment with new layouts, animations, and cuts.\n*   Help find stock media and generate original assets to incorporate into projects. You say "Barack Obama", and there\'s already a PNG overlay of his face available for you. You can browse songs with the right tempo and duration for your project. Sound effect suggestions immediately appear over jump cuts.\n*   Supply caption ideas for your social media posts, including memes, and thumbnails to cover them\n*   Curate trends and new formats you might enjoy\n*   Clip highlights in a long-form video\n*   Convert from one medium to another. AI can generate a visual to accompany your podcast, or a voiceover representation for a text article. File types become more versatile and transformable.\n\n![Image](2.jpg)\n\n2)  **Personalized automations:** Less repetitive work as AI remembers your actions, assists, and automates. AI will:\n\n*   Detect bounding boxes so you can edit each subject within a video and pull a video apart into its layers, retroactivley\n*   Recognize objects to find timestamps from text prompts, recognizing both the timeline (searching for keywords in a webinar, for example) and the canvas (like tracking a person\'s face)\n*   Auto-level the volume across your video and clean it up by removing background noise\n\n![Image](3.jpg)\n\n*   Remember your preferences, like your default output size or your intro sequence, and suggesting them in new projects\n*   Power recording tools like a smart teleprompter that moves forward as you speak and a computational camera that beautifies the speaker\'s face and enhances their voice as it captures\n*   Translate between languages with dubbed voiceovers and/or closed captions in other languages\n\n3) **Command interfaces** that transform text prompts into precise timeline UI. AI will:\n\n*   Use quotations and scene changes to make cuts and clips, editing like a Google Doc ++.\n*   Converse with you to reverse mistakes, catch errors, and refine changes, just like you would a virtual assistant\n*   Chain sequences of actions together (like "make this text appear for one second every three seconds" or "optimize for TikTok")\n*   Generate scripts, shot lists, and storyboards from text descriptions\n\nWhat Doesn’t Change\n-------------------\n\n**Storytelling and authorship:** Humans love videos partly because it gives us a connection to another relatable person, making us feel less alone and closer to mankind. Outside of *Westworld*, we don’t have the same connection with machines; computers are too forgetful, infinite, objective, and perfectly reasonable for us to relate to and feel understood by. When I browse on TikTok, authentic storytelling represents most of the stories in my feed. It’s my belief that humans will tell stories better than machines for a long time, because it’s the human aspect that we relate to. So, Generative AI won’t replace TikTokers, musicians, poets, influencers, and performers, although it will certainly make them faster and help them to come up with new content ideas. Coming up with relatable stories, filming experiences, and crafting a narrative will still be the bulk of a creator’s work.\n\n![Image](4.jpg)\n\n"TikTokers making videos in their home studio, photorealistic" generated images\n\n**Originality**: Similarly, AI won’t change the fact that people will want to insert their own personality and voice into videos they produce. Generative AI is good at coming up with average answers, but not good at coming up with a highly original spin on a topic. It can give you suggestions for memes, but creators will still want to put their own spin on it. That’s why it’s essential for AI to be baked into the tools themselves, so that all AI suggestions can be modified and curated.\n\n![Image](5.jpg)\n\n**The Art of Filmmaking**: There are many ways to cut and tell a story, and AI certainly does not get us 100% of the way there. Video editors, digital storytellers, and media entrepreneurs need suggestive AI tools that can supplement their workflow with recommendations rather than prescriptive software that tries to replace their jobs. Prescriptive AI is doomed to fail. Instead, video makers need the ability to customize, change, remix, and refine AI suggestions to bring a creative vision to life.\n\nWhat Does Change\n----------------\n\n**Investment in ML performance**: We know from experience that fast, accurate AI workflows are essential for saving creators time. Video makers rely on responsive, fast interfaces in the creative process and will give up on slow, clunky processes. For example, last year, we improved the performance of our automatic remove background from video feature and saw a 6% uptick in weekly active users immediately after launch. We are increasing our investment in performance and will continue to rigorously compare available AI technologies on real videos/use cases.\n\n![Image](6.jpg)\n\n**Text as an input**: The popularity of ChatGPT and Microsoft’s Copilot has changed the way consumers think about chat interfaces and productivity. Video editing is visual, but some commands demand a lot of precision and accuracy that’s hard to achieve with a mouse or trackpad. Video editing software of the future will leverage embedded text prompts to automate repeated workflows and guide users and text input to inspire and spark new ideas. Clippy reborn!\n\n**AI Development Velocity:** Silicon Valley is seeing an unprecedented velocity around new AI products, and video-related AI is evolving quickly. But there’s still a lot that machines can’t do well. For example, machines have a lot to learn when it comes to drawing a bounding box around objects. Lacking a sense of object permanent, computer vision fails when a moving subject disappears momentarily, for example. As a result, we haven’t yet found an object tracking API that provides reliable enough results for an automated “pinning” solution. Our engineering team stays plugged in to recent developments through a close relationship with the Chrome team, and we’re thrilled at the AI developments that have moved into hyper speed in the last few months.\n\nToday, we launched 5 products that we started development on less than two weeks ago. There’s much more to come. Stay tuned at kapwing.com/ai and sign up for email updates.\n\n![Image](7.jpg)\n\nConclusion\n----------\n\nCreators and technologists alike are dreaming about how AI will change video editing workflows for the better and help creators get more efficient when telling stories and making content. We’ve had hundreds of people fill out our interest survey, telling us they’re interested in every area of video creation:\n\n![Image](8.jpg)\n\nWe’re using this survey and feedback, ideas, and requests from creators to guide our roadmap, so please reach out over email, LinkedIn or Twitter to let us know your thoughts. Stay tuned as we add new AI products into the Kapwing editor and chip away at the repetitive workflows that have haunted creators for decades.\n\nIf you’re a marketing, communications, or media team interested in leveraging AI to speed up content operations, reach out for a demo to see how you can put AI to work for your creative team.\n```',images:[{imgUrl:"https://www.kapwing.com/blog/content/images/2022/08/App-Cover.jpg",placeholderUrl:"0.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/AI-Modal.png",placeholderUrl:"1.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/Screen-Shot-2023-04-05-at-9.22.33-AM.png",placeholderUrl:"2.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/Volume-adusted-in-timeline-annotated.png",placeholderUrl:"3.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/Studio_Project--7-.png",placeholderUrl:"4.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/Screen-Shot-2023-04-11-at-4.24.23-PM-1.png",placeholderUrl:"5.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/Remove-Background-Video-Performance.png",placeholderUrl:"6.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/How_it_started_script_generator_-1--1.jpeg",placeholderUrl:"7.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/Interest-in-AI---Video-Editing-.png",placeholderUrl:"8.jpg"},{imgUrl:"https://www.kapwing.com/blog/content/images/2023/04/Studio_Project--16-.jpeg",placeholderUrl:"ogImage.jpg"}],ogTags:{ogSiteName:"Kapwing Company Blog",ogType:"article",ogTitle:"How Will GPT Change Video Editing",ogDescription:"Much has been said about ChatGPT and new AI technologies that will change the ways people work. But how will it change video editing? Today, we introduced GPT tech into Kapwing. In this article, CEO Julia Enthoven shares her predictions for the future of Video Editing + AI.",ogUrl:"https://www.kapwing.com/blog/how-will-gpt-change-video-editing/",articlePublishedTime:"2023-04-12T17:22:37.000Z",articleModifiedTime:"2023-04-12T18:40:08.000Z",articleTag:"Announcements",articlePublisher:"https://www.facebook.com/KapwingVideos",twitterCard:"summary_large_image",twitterTitle:"How Will GPT Change Video Editing",twitterDescription:"Much has been said about ChatGPT and new AI technologies that will change the ways people work. But how will it change video editing? Today, we introduced GPT tech into Kapwing. In this article, CEO Julia Enthoven shares her predictions for the future of Video Editing + AI.",twitterUrl:"https://www.kapwing.com/blog/how-will-gpt-change-video-editing/",twitterSite:"@KapwingApp",ogImage:[{height:"876",url:"https://www.kapwing.com/blog/content/images/2023/04/Studio_Project--16-.jpeg",width:"1668",type:"jpeg"}],twitterImage:[{url:"https://www.kapwing.com/blog/content/images/2023/04/Studio_Project--16-.jpeg"}],ogLocale:"en",ogDate:"2023-04-12",favicon:"https://www.kapwing.com/blog/content/images/size/w256h256/2022/06/logo512.png",charset:"utf-8",success:!0},outline:[{text:"GPT-4 and Generative AI have the potential to revolutionize video editing by providing new ideas, perspectives, and assets for creators.",imageUrl:"ogImage.jpg",keyword:"GPT-4 video editing"},{text:"AI-powered features can assist video editors with tasks like suggesting new edits, finding stock media, and generating social media captions.",imageUrl:"0.jpg",keyword:"AI-powered video editing"},{text:"Generative AI can automate repetitive tasks, enable personalized automations, and provide assistance in various aspects of video editing.",imageUrl:"1.jpg",keyword:"Generative AI video editing"},{text:"Command interfaces powered by AI can transform text prompts into precise timeline UI, making editing more intuitive and efficient.",imageUrl:"2.jpg",keyword:"AI command interfaces"},{text:"Humans will still excel at storytelling and bringing originality to videos, while AI can enhance the creative process and provide recommendations.",imageUrl:"4.jpg",keyword:"Human storytelling vs AI"},{text:"Investment in ML performance and leveraging text as input are key areas of improvement in AI-powered video editing.",imageUrl:"6.jpg",keyword:"ML performance and text input"},{text:"AI development in video editing is progressing rapidly, but there are still challenges to overcome in areas like object tracking.",imageUrl:"7.jpg",keyword:"AI development challenges"},{text:"AI will continue to shape the future of video editing, with new products and features being developed to aid creators in their workflows.",imageUrl:"8.jpg",keyword:"Future of AI in video editing"}]},bce={url:"https://www.kapwing.com/blog/how-will-gpt-change-video-editing/",ogTags:wce.ogTags,markdown:wce.markdown,markdownImages:wce.images,outline:wce.outline,originalOutline:wce.outline},Tce={wrapper:"ArticleToVideo-module_wrapper_Unoqq",leftContainer:"ArticleToVideo-module_leftContainer_52Y9i",leftContainerSmall:"ArticleToVideo-module_leftContainerSmall_naM3-",rightContainer:"ArticleToVideo-module_rightContainer_ujc-u",rightContainerSmall:"ArticleToVideo-module_rightContainerSmall_gasT2",label:"ArticleToVideo-module_label_4gaPT",description:"ArticleToVideo-module_description_ewARx",input:"ArticleToVideo-module_input_SFP4g",pastPromptButton:"ArticleToVideo-module_pastPromptButton_uCI2n",loader:"ArticleToVideo-module_loader_58jTU",load8:"ArticleToVideo-module_load8_VbWvk",form:"ArticleToVideo-module_form_vWg-y",row:"ArticleToVideo-module_row_hHQ1o",loadingOgTags:"ArticleToVideo-module_loadingOgTags_sngoN",cancelLink:"ArticleToVideo-module_cancelLink_XUH4k",resetArticleLink:"ArticleToVideo-module_resetArticleLink_-pp0J",buttons:"ArticleToVideo-module_buttons_OLhfh",resetButton:"ArticleToVideo-module_resetButton_-B0Nw",generateButton:"ArticleToVideo-module_generateButton_peQS2",disabled:"ArticleToVideo-module_disabled_2x43B",body:"ArticleToVideo-module_body_l4db8",noPastedUrl:"ArticleToVideo-module_noPastedUrl_-ykwi",ogPreview:"ArticleToVideo-module_ogPreview_pNich",ogLoadingText:"ArticleToVideo-module_ogLoadingText_O5K3Z",ogLoaderContainer:"ArticleToVideo-module_ogLoaderContainer_E-ISN",buttonsWithUpsell:"ArticleToVideo-module_buttonsWithUpsell_Zbyim",sample:"ArticleToVideo-module_sample_c-js1",sampleButton:"ArticleToVideo-module_sampleButton_cvgjf",previewVideo:"ArticleToVideo-module_previewVideo_fcL2s"};function xce(e){try{const t=JSON.parse(e),{slideshow:o}=t;return o}catch(IGe){throw new jse("The job completed, but the outline was malformatted.")}}async function Sce(e){try{return await Yr(`/api/v2/ai/jobs/${e}`)}catch(IGe){return console.error(IGe),null}}async function Ece(e,t,o,a){const i=await async function(e,t,o,a){var i;try{const s=await Jr("/api/v2/ai/create-job/article-to-video",{body:{markdown:e,teamId:null==(i=Hu())?void 0:i._id,url:t,ogTags:o,images:a}});return s.succeeded?(Qr("generate_article_to_video",{body:{markdown:e,id:s.id}}).catch((e=>{console.error(e)})),s.id):(console.error(s.message),null)}catch(IGe){return console.error(IGe),null}}(e,t,o,a);if(!i)return null;console.debug("Running Article to Video job",i);let s=0;for(;;){const e=await Sce(i);if(!e)return null;if(s>30)throw new jse("Getting a response is taking longer than expected. Please try again later.");if("complete"===e.status)return xce(e.outline);if("error"===e.status)throw new jse(e.error);s+=1,await new Promise((e=>setTimeout(e,4e3)))}}const Ice=_.memo((({setLoading:e,onClose:t,enforceSignIn:o})=>{const a=il(),{pastedUrl:i,ogTags:n,markdown:r,outline:l}=tl((e=>({pastedUrl:e.studioLocal.articleToVideo.url,ogTags:e.studioLocal.articleToVideo.ogTags,markdown:e.studioLocal.articleToVideo.markdown,outline:e.studioLocal.articleToVideo.outline})),ol),[d,c]=h.useState(!1),[u,m]=h.useState(!1),[p,g]=h.useState(!1),f=tl((e=>e.studioLocal.articleToVideo.markdownImages)),y=wQ(),v=bW(),_=NU(Bl.GENERATE_ARTICLE_TO_VIDEO),b=tl((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedArticleToVideo}))||0,[T,x]=h.useState(!1),S=()=>{c(!1),g(!1),a(uw({url:"",ogTags:{},markdown:"",markdownImages:[],outline:[],originalOutline:[]}))},E=()=>{c(!1),g(!0),a(uw({...bce,outline:[],originalOutline:[]}))},I=async e=>{try{if(!P6(e))return void(e.length>0&&(a(wl({type:"warning",description:`Please paste a valid URL. You entered "${e}".`})),S()));a(uw({url:e})),c(!0);const t=await Qr("article_info",{body:{url:e}});Fm(ym.ARTICLE_TO_VIDEO_GENERATOR_PASTED_LINK,{Url:e});const o=((e,t)=>{const{images:o,ogTags:a}=e;return{...e,images:Jde(o,t),ogTags:Yde(a,t)}})(t,e),{markdown:i,images:s,ogTags:n}=o;a(uw({ogTags:n,markdownImages:s,markdown:i})),c(!1)}catch(IGe){S(),mh({description:"Couldn't fetch that page, please try a different link.",error:IGe})}},C=h.useCallback((async()=>{if(p)return void a(uw(bce));let t=i;try{(null==t?void 0:t.startsWith("http"))||(t=`//${t}`),t=new URL(t).href}catch(IGe){return void a(wl({type:"warning",description:"Please enter a valid URL."}))}if(r){Fm(ym.ARTICLE_TO_VIDEO_GENERATOR_GENERATE_OUTLINE,{Url:i,"Used Past Prompt":T}),m(!0);try{const e=await Ece(r,t,n,f);if(!e)throw new Error("Received an unexpected GPT response.");Dne("generatedArticleToVideo"),a(uw({outline:e,originalOutline:e})),m(!1)}catch(IGe){m(!1),mh({description:"Could not preprocess your article. Please try again.",error:IGe})}e(!1),m(!1)}else a(wl({type:"warning",description:"Couldn't parse this article. Please try a different article."}))}),[p,i,r,T,e,a,n,f]),k=h.useCallback((()=>{a(uw({outline:[],originalOutline:[]}))}),[a]),A=y(v((()=>C()),{action:Vl.GENERATE_ARTICLE_TO_VIDEO,if:b>=2}),{[Oc.AI_GENERATE]:1}),j=()=>{if(_)return null;const e=`You can generate ${rW(Math.max(2-b,0),"more video")} for free. Upgrade to create more videos from articles.`;return w.jsx(kse,{warning:e,action:Vl.GENERATE_ARTICLE_TO_VIDEO,buttonText:"Upgrade"})},N=h.useCallback((e=>{if("article-to-video"!==e.type)return;const{input:{markdown:t},ogTags:o,images:i,url:s}=e;x(!0),a(uw({ogTags:o,markdownImages:i,markdown:t,url:s}))}),[a]);return l&&!s.isEmpty(l)?w.jsx(_ce,{reset:k,onClose:t,usedPastPrompt:T}):w.jsxs("div",{className:Tce.wrapper,children:[w.jsxs("div",{className:[Tce.leftContainer,i?Tce.leftContainerSmall:""].join(" "),children:[w.jsx("div",{className:Tce.label,children:"Article to Video"}),w.jsx("div",{className:Tce.description,children:"Use this tool to convert an article into a video. Paste a link to an article below, and Kapwing will create a video about the article in just a few clicks."}),w.jsx("form",{className:Tce.form,onSubmit:e=>{e.preventDefault()},children:w.jsx("div",{className:Tce.row,children:w.jsx(Ane,{rows:1,disabled:!!(null==i?void 0:i.length),type:"article-to-video",promptKey:"url",className:Tce.input,placeholder:"Paste a link to an article here",value:i||"",setPromptFromPastJob:N,setPrompt:I,tab:one.ArticleToVideo,disablePastPrompt:!!(null==i?void 0:i.length),buttonClass:Tce.pastPromptButton})})}),d||i?null:w.jsx("div",{className:Tce.sample,children:w.jsx("button",{className:Tce.sampleButton,type:"button",onClick:E,children:"Try a sample"})})]}),w.jsx("div",{className:[Tce.rightContainer,i?"":Tce.rightContainerSmall].join(" "),children:i?d?w.jsxs("div",{className:Tce.noPastedUrl,children:[w.jsx("div",{className:Tce.ogPreview,children:w.jsxs("div",{className:Tce.ogLoadingText,children:[w.jsxs("div",{children:["Loading a preview for your article ... please be patient as this may take a few seconds."," "]}),w.jsx("div",{className:Tce.ogLoaderContainer,children:w.jsx("div",{className:Tce.loader})})]})}),w.jsxs("div",{className:Tce.buttons,children:[w.jsx("div",{className:Tce.resetButton,onClick:S,children:"Cancel"}),w.jsx("div",{className:[Tce.generateButton,Tce.disabled].join(" "),children:"Loading article preview..."})]})]}):!n||s.isEmpty(n)?w.jsxs("div",{className:Tce.noPastedUrl,children:[w.jsx("div",{className:Tce.ogPreview,children:w.jsxs("div",{children:[w.jsx("span",{children:"Something went wrong and Kapwing was unable to fetch your article. Is the URL publicly accessible?"}),w.jsx("div",{className:Tce.resetArticleLink,onClick:S,children:"Reset url and try again"})]})}),w.jsxs("div",{className:Tce.buttons,children:[w.jsx("div",{className:Tce.resetButton,onClick:S,children:"Cancel"}),w.jsx("div",{className:[Tce.generateButton,Tce.disabled].join(" "),children:"Generate video from this article"})]})]}):w.jsxs("div",{className:Tce.body,children:[w.jsx("div",{children:w.jsx(sce,{fallbackUrl:i,handleReset:S})}),u?w.jsxs("div",{className:Tce.buttonsWithUpsell,children:[j(),w.jsxs("div",{className:Tce.buttons,children:[w.jsx("div",{className:[Tce.resetButton,Tce.disabled].join(" "),children:"Cancel"}),w.jsxs("div",{className:`${Tce.generateButton} ${Tce.disabled}`,children:[w.jsx("span",{children:"Generating outline ... please wait"}),w.jsx("div",{className:Tce.loader})]})]})]}):w.jsxs("div",{className:Tce.buttonsWithUpsell,children:[j(),w.jsxs("div",{className:Tce.buttons,children:[w.jsx("button",{type:"button",className:Tce.resetButton,onClick:S,children:"Cancel"}),w.jsx("button",{type:"button",className:[Tce.generateButton,i?"":Tce.disabled].join(" "),disabled:!i,onClick:o(A),children:"Generate video from this article"})]})]})]}):w.jsxs("div",{className:Tce.noPastedUrl,children:[w.jsx("div",{className:Tce.ogPreview,children:"Paste a link using the form on left and Kapwing will create a preview of your article here."}),w.jsxs("div",{className:Tce.buttons,children:[w.jsx("div",{className:[Tce.resetButton,Tce.disabled].join(" "),children:"Cancel"}),w.jsx("div",{className:[Tce.generateButton,Tce.disabled].join(" "),children:"Generate video from this article"})]})]})})]})})),Cce={loading:"AiLoading-module_loading_1ndR1","fade-in":"AiLoading-module_fade-in_vu4pN",loader:"AiLoading-module_loader_j8HsU",spin:"AiLoading-module_spin_fp4El",loaderRow:"AiLoading-module_loaderRow_fxVQ-",loadingText:"AiLoading-module_loadingText_baVXC",progressWrapper:"AiLoading-module_progressWrapper_Tmwcf",loadingPrompt:"AiLoading-module_loadingPrompt_DPlhM",clickableImageContainer:"AiLoading-module_clickableImageContainer_WnaWQ",imageContainer:"AiLoading-module_imageContainer_lRW5m",loadingImage:"AiLoading-module_loadingImage_9cOmq",playButton:"AiLoading-module_playButton_Wchj-",playContainer:"AiLoading-module_playContainer_3rG2Y",cancelButtons:"AiLoading-module_cancelButtons_vw-VX",cancelButtonsHidden:"AiLoading-module_cancelButtonsHidden_ZSx-v",cancelButton:"AiLoading-module_cancelButton_4R-5g",red:"AiLoading-module_red_thjUO"},kce="EstimatedProgressBar-module_container_hb3VV",Ace="EstimatedProgressBar-module_ProgressRoot_fx7FX",jce="EstimatedProgressBar-module_ProgressIndicator_E889C",Nce=[0,100];const Rce=_.memo((function({jobDuration:e,progressRange:t=Nce}){const[o,a]=h.useState(0),[i,s]=t,n=Math.round(i/100*e),r=Math.round(s/100*e),l=h.useMemo((()=>0===e?0:Math.round(o/e*100)),[e,o]);h.useEffect((()=>{const e=setInterval((()=>{o>r||a((e=>Math.max(n,e+1)))}),1e3);return()=>clearInterval(e)}),[r,n,o]);const d=Ru(l,i,s),c=h.useMemo((()=>({transform:`translateX(-${100-l}%)`})),[l]);return w.jsx("div",{className:kce,children:w.jsx(Co,{className:Ace,value:d,max:100,children:w.jsx(ko,{className:jce,style:c})})})})),Pce=["youtubeTip","mascotTip","originTip","smartCutTip","trimTranscriptTip","autoSubtitlesTip"],Dce={text:"Looking to improve your content? Check out Kapwing's official Youtube channel for more tips and tricks.",imgsrc:"https://cdn-useast1.kapwing.com/static/VoQ-how-to-use-kapwing.webp",alt:"Kapwing Youtube Plug",clickableLink:"https://www.youtube.com/watch?v=ehqwoScTXho"},Oce=()=>{const e=Pce[Math.floor(Math.random()*Pce.length)];return e||"youtubeTip"},Lce=_.memo((e=>{const[t,o]=h.useState(!1),{confirmingClose:a=t,setConfirmingClose:i=o,estimatedJobDuration:s,estimatedProgressRange:n,handleCancel:r,jobDescription:l,loadingMessage:d,currentTab:c}=e,u=h.useMemo((()=>(e=>{let t=e;switch(t||(t=Oce()),t){default:return Dce;case"youtubeTip":return{text:"Looking to improve your content? Check out Kapwing's official Youtube channel for more tips and tricks.",imgsrc:"https://cdn-useast1.kapwing.com/static/VoQ-how-to-use-kapwing.webp",alt:"Kapwing Youtube Plug",clickableLink:"https://www.youtube.com/watch?v=ehqwoScTXho"};case"mascotTip":return{text:"Did you know? The two Kapwing mascots are named Kitten and Bobtail, or Kit and Bob for short!",imgsrc:"https://cdn-useast1.kapwing.com/static/y7j-kapwing-mascots-colorful.webp",alt:"Kapwing Mascot Names Tip"};case"originTip":return{text:"Did you know? The name “Kapwing” is an onomatopoeia that was used in a Calvin and Hobbes comic strip!",imgsrc:"https://cdn-useast1.kapwing.com/static/FtO-kapwing-name-origin.webp",alt:"Kapwing Name Origin Tip"};case"smartCutTip":return{text:"Tool Tip: Use Smart Cut to automatically remove the silences from your videos in just a couple clicks.",imgsrc:"https://cdn-useast1.kapwing.com/static/Zq8-conversions_64b1d687089e172351fbd6d1_conversion_V1.webp",alt:"Kapwing Smart Cut Tip"};case"trimTranscriptTip":return{text:"Tool Tip: Try using Trim with Transcript to edit your project! Simply delete unwanted sections from your video’s transcript, and Kapwing will cut it accordingly.",imgsrc:"https://cdn-useast1.kapwing.com/static/hab-conversions_64b1d687089e172351fbd6d1_conversion_V2.webp",alt:"Trim with Transcript Tip"};case"autoSubtitlesTip":return{text:"Tool Tip: Use Auto Subtitles to generate fully customizable animated captions that are automatically synced to your project.",imgsrc:"https://cdn-useast1.kapwing.com/static/RCP-conversions_64b1d687089e172351fbd6d1_conversion_V3.webp",alt:"Auto Subtitles Tip"}}})()),[]),m=h.useCallback((()=>{c&&Fm(ym.AI_GENERATOR_CANCELLED,{Tab:c}),r()}),[c,r]),p=h.useCallback((()=>{window.open(u.clickableLink,"_blank")}),[u]);return w.jsxs("div",{className:Cce.loading,children:[w.jsxs("div",{className:Cce.loaderRow,children:[w.jsx("div",{className:Cce.loader}),a?w.jsxs("div",{className:Cce.loadingText,children:["We're almost done ",l,". Are you sure you want to cancel?"]}):w.jsx("div",{className:Cce.loadingText,children:w.jsx("span",{children:d})})]}),w.jsx("div",{className:Cce.progressWrapper,children:w.jsx(Rce,{jobDuration:s,progressRange:n})}),w.jsx("div",{className:Cce.loadingPrompt,children:u.text}),u.clickableLink?w.jsxs("div",{className:Cce.clickableImageContainer,onClick:p,children:[w.jsx("img",{src:u.imgsrc,alt:u.alt,className:Cce.loadingImage}),w.jsx("div",{className:Cce.playContainer,children:w.jsx("div",{className:Cce.playButton})})]}):w.jsx("div",{className:Cce.imageContainer,children:w.jsx("img",{src:u.imgsrc,alt:u.alt,className:Cce.loadingImage})}),w.jsxs("div",{className:a?Cce.cancelButtons:Cce.cancelButtonsHidden,children:[w.jsx("div",{className:[Cce.cancelButton,Cce.red].join(" "),onClick:m,children:"Yes, cancel"}),w.jsx("div",{className:Cce.cancelButton,onClick:()=>i(!1),children:"No, continue"})]}),w.jsx("div",{className:a?Cce.cancelButtonsHidden:Cce.cancelButtons,children:w.jsx("div",{className:Cce.cancelButton,onClick:()=>i(!0),children:"Cancel"})})]})})),Fce="GenerateVideo-module_controls_c5gdi",Mce="GenerateVideo-module_row_sQ2gC",Uce="GenerateVideo-module_previewWrapper_3uSON",Bce="GenerateVideo-module_previewHint_s50uO",Vce="GenerateVideo-module_previewContainer_mbXvn",Wce="GenerateVideo-module_upsellContainer_OFciS",Gce="GenerateVideo-module_container_rqwfz",Hce="GenerateVideo-module_toggleSpace_XXSHS",$ce=["The top 5 sites to visit in San Francisco","How to make social media content more engaging","An advertisement for an organic skincare company"];const Kce=_.memo((function({setLoading:e,onClose:t,setCancelFn:o,enforceSignIn:a,setLoadingTime:i}){const s=il(),[n,r]=h.useState(function(){const{state:e}=sr(),{ratio:t}=e.studio;return Xse.find((e=>e.key===t))||Xse[1]}()),[l,d]=h.useState("English (US)"),[c,u]=h.useState(Cre[l][0]),[m,p]=h.useState(!1),{brandkitPresets:g}=xU(),[f,y]=h.useState(qle);h.useEffect((()=>{g[0]&&y(g[0])}),[g]);const{topic:v}=tl((e=>({topic:e.studioLocal.ai.videoGeneratorPrompt||""})),ol),[_,b]=h.useState(30),[T,x]=h.useState(Zse(n)),S=NU(Bl.ROYALTY_FREE),E=Sde(),I=bW(),C=wQ(),k=NU(Bl.GENERATE_TTS_VIDEO),A=tl((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedTTSVideos}))||0,j=_Q(),N=!k&&(!j[Oc.TTS]||_/60>=j[Oc.TTS].remainingUsage),R=0===v.length||v.length>1e3||N,P=h.useCallback((async()=>{c.elevenLabsId?i(140):i(70),e(!0),Fm(ym.STARTED_TTS_VIDEO_GENERATOR,{Topic:v,"Aspect Ratio":n.key,Voice:`${c.label} - ${c.languageCode} - ${c.name}`,"Premium Voice":void 0!==c.elevenLabsId,"Preset ID":f.presetId,Duration:_,"Used Past Prompt":m});const a=await wre({topic:v,selectedPlatform:T,selectedDuration:_,setCancelFn:o,selectedSize:n,selectedLanguage:l,selectedVoice:c,selectedPreset:f,tab:one.Video,scriptToVideo:!0});if(!a)return;const r=Rle(a);try{const e=new Mle({script:r,size:n,language:l,voice:c,preset:f,includeGetty:S,royaltyFree:E,topic:v,tab:one.Video,usingPastPrompt:m});o((()=>()=>{e.cancel(),s(cw({videoGeneratorPrompt:""}))})),await e.generate(),PP({[Oc.TTS]:r.length/750}),Dne("generatedTTSVideos"),t()}catch(IGe){const{message:t}=ph(IGe);Fm(ym.TTS_VIDEO_GENERATOR_FAILED,{Error:t}),mh({description:"Failed to generate video.",error:IGe})}e(!1)}),[s,S,E,t,_,l,T,f,n,c,o,e,i,v,m]),D=h.useCallback((e=>{if("generate-script"!==e.type)return;p(!0);const{topic:t,duration:o,selectedLanguage:a,selectedPreset:i,selectedSize:n,selectedVoice:l}=e;s(cw({videoGeneratorPrompt:t})),n&&(r(n),x(Zse(n))),o&&b(o),i&&y(i),a&&d(a),l&&u(l)}),[s]),O=C(I((()=>P()),{action:Vl.GENERATE_TTS_VIDEO,if:A>=2}),{[Oc.AI_GENERATE]:1});return w.jsxs("div",{className:Gce,children:[w.jsxs("div",{className:`${Fce} ${Hce}`,children:[w.jsx(Ane,{title:"Video topic",placeholder:"Generate a video about...",value:v,tab:one.Video,setPrompt:function(e){s(cw({videoGeneratorPrompt:e}))},type:"generate-script",promptKey:"topic",setPromptFromPastJob:D,maxCharLength:1e3,samplePrompts:$ce,requirePastJobsToMatchTab:!0}),w.jsx(tne,{selectedSize:n,setSelectedSize:r,setSelectedPlatform:x}),w.jsx(nde,{selectedVoice:c,selectedLanguage:l,setSelectedVoice:u,setSelectedLanguage:d,tab:"Video"}),w.jsx(Xle,{selectedPreset:f,setSelectedPreset:y}),w.jsx("div",{className:Mce,children:w.jsx(Yse,{label:"Approximate Duration",selectedDuration:_,setSelectedDuration:b})})]}),w.jsxs("div",{className:Uce,children:[w.jsx("div",{className:Bce,children:"This is just a preview of the size and style of your video. Click Generate Video to start the creation process."}),w.jsx("div",{className:Vce,children:w.jsx(ude,{selectedSize:n,selectedPreset:f})}),(()=>{if(k){if(j[Oc.AI_GENERATE]&&j[Oc.AI_GENERATE].hasConsumedLimit){const e=Lse(Ose.VIDEO_FROM_SCRIPT,0);return w.jsx("div",{className:Wce,children:w.jsx(kse,{warning:e,action:Vl.GENERATE_SCRIPT_TO_VIDEO,buttonText:"Upgrade"})})}return}const e=Math.max(2-A,0);if(0===e){const e=Lse(Ose.VIDEO,0);return w.jsx("div",{className:Wce,children:w.jsx(kse,{warning:e,action:Vl.GENERATE_TTS_VIDEO,buttonText:"Upgrade"})})}if(N)return w.jsx("div",{className:Wce,children:w.jsx(kse,{warning:"This generation would exceed the free limit for text to speech minutes. Upgrade for increased minutes.",action:Vl.TEXT_TO_SPEECH,buttonText:"Upgrade"})});if(e>0&&e<=2){const t=Lse(Ose.VIDEO,e);return w.jsx("div",{className:Wce,children:w.jsx(kse,{warning:t,action:Vl.GENERATE_TTS_VIDEO,buttonText:"Upgrade"})})}})(),w.jsx(Vle,{disabled:R,onClick:a(O),text:"Generate Video"})]})]})}));function zce(){eE("/studio/editor/ai-tools")}function Yce(){eE("/studio/editor")}const Jce=_.memo((()=>{const e=il(),t=tl((e=>e.toolTip)),o=tl((e=>e.studioLocal.ai.selectedTab))||zde(t).tab||one.ArticleToVideo,[a,i]=h.useState(!1),[s,n]=h.useState(!1),[r,l]=h.useState((()=>()=>{})),[d,c]=h.useState(!1),[u,m]=h.useState(60),p=tl((e=>e.bRoll.bRollLoadingMsg)),g=h.useMemo((()=>{switch(p){case Gre:return[0,75];case Hre:return[75,90];case Kre:return[90,99];default:return[0,100]}}),[p]),f=h.useCallback((function(e){const{state:t}=sr();return nu(t)?e:()=>(sh.set("AI_DATA",sr().state.studioLocal.ai),c(!0),null)}),[]),y=h.useCallback((()=>{r(),i(!1),n(!1)}),[r]),v=()=>{a?n(!0):(r(),Yce())},_=h.useCallback((()=>{if(!a)return r(),void Yce();!a||s?a&&s&&(r(),Yce()):n(!0)}),[r,a,s]),b=h.useCallback((e=>{"Escape"===e.key&&_()}),[_]);h.useEffect((()=>(document.addEventListener("keydown",b,!1),()=>{document.removeEventListener("keydown",b,!1)})),[b]);const T=h.useCallback((()=>{sh.getAndUnset("AI_DATA"),c(!1)}),[]),x=h.useCallback((()=>{sh.getAndUnset("AI_DATA")}),[]),S=()=>{switch(o){case one.Video:return w.jsx(Kce,{setLoading:i,onClose:_,setCancelFn:l,enforceSignIn:f,setLoadingTime:m});case one.Slideshow:return w.jsx(Nne,{setLoading:i,onClose:_,setCancelFn:l,enforceSignIn:f,setLoadingTime:m});case one.Image:return w.jsx(Fne,{onClose:_,setCancelFn:l,enforceSignIn:f});case one.Meme:return w.jsx($ne,{onClose:_,setCancelFn:l,enforceSignIn:f});case one.Script:return w.jsx(Ere,{setCancelFn:l,enforceSignIn:f});case one.ScriptToVideo:return w.jsx(Ide,{setLoading:i,onClose:_,setCancelFn:l,enforceSignIn:f,setLoadingTime:m});case one.DocumentToVideo:return w.jsx(kde,{setLoading:i,onClose:_,setCancelFn:l,enforceSignIn:f});case one.ArticleToVideo:return w.jsx(Ice,{enforceSignIn:f,onClose:_,setLoading:i});default:return w.jsx(Nne,{setLoading:i,onClose:_,setCancelFn:l,enforceSignIn:f,setLoadingTime:m})}};return Ao.createPortal(w.jsxs(w.Fragment,{children:[d&&w.jsx(bV,{hideSignIn:T,onSuccess:x}),w.jsxs("div",{className:jde,children:[w.jsx("div",{className:Ade,onClick:v}),a?w.jsx("div",{className:Rde,children:w.jsx(Lce,{handleCancel:y,confirmingClose:s,estimatedJobDuration:u,estimatedProgressRange:g,setConfirmingClose:n,loadingMessage:p||"Generating video ... please wait. This may take a moment.",jobDescription:"generating your video",currentTab:o})}):w.jsxs("div",{className:Nde,children:[w.jsx("div",{className:Mde,onClick:_,children:w.jsx(ve,{})}),w.jsx("div",{className:Pde,children:w.jsxs("div",{className:Dde,children:[w.jsxs("div",{className:Bde,children:[w.jsx("div",{className:Ode,children:w.jsxs("div",{className:Fde,children:[w.jsx(jo,{className:Lde})," ","Kapwing AI ",w.jsx("span",{className:Ude,children:"Beta"})]})}),ine.map((t=>{let a=Vde;return t.tab===o&&(a+=` ${Wde}`),w.jsxs("div",{className:a,onClick:()=>{e(cw({selectedTab:t.tab}))},children:[w.jsx("div",{className:Gde,children:t.icon}),w.jsx("div",{className:Hde,children:t.header})]},t.header)}))]}),S()]})})]})]})]}),sM())})),qce="LandingPageTooltipAnchor-module_popoverContent_gn3mG",Xce="LandingPageTooltipAnchor-module_toolTipContent_vfe6a",Qce="LandingPageTooltipAnchor-module_large_yCl-n",Zce="LandingPageTooltipAnchor-module_arrow_ES-rL",eue="LandingPageTooltipAnchor-module_headerText_PIwRX",tue="LandingPageTooltipAnchor-module_iconWrapper_FCkYH",oue="LandingPageTooltipAnchor-module_subtextContainer_tdODa",aue="LandingPageTooltipAnchor-module_headerContainer_MTtS0",iue="LandingPageTooltipAnchor-module_exit_nup1B",sue="limitToolTips-module_nobr_mCop0",nue=_.memo((()=>{const[e,t]=h.useState(!1),o=h.useCallback((()=>{t(!1)}),[]);return w.jsxs(w.Fragment,{children:[e&&w.jsx(gW,{action:Vl.SINGLE_VIDEO_DURATION_LIMIT,onClose:o}),w.jsx("span",{children:"Your video is longer than"})," ",4," minutes. Trim your video or upgrade to export longer videos."]})})),rue=_.memo((()=>{const[e,t]=h.useState(!1),o=h.useCallback((()=>{t(!1)}),[]);return w.jsxs(w.Fragment,{children:[e&&w.jsx(gW,{action:Vl.UPLOAD_LIMIT,onClose:o}),w.jsx("span",{children:"Upgrade to export projects containing files larger than"})," ",w.jsxs("span",{className:sue,children:[250," MB."]})]})})),lue=_.memo((()=>w.jsxs(w.Fragment,{children:["Your project is above the"," ",w.jsxs("span",{style:{fontWeight:"bold"},children:[2," hour limit"]}),". Trim your video to export it successfully."]}))),due=_.memo((()=>w.jsx(w.Fragment,{children:"This project contains a layer with Clean Audio applied. Upgrade or remove this layer to export."}))),cue=_.memo((()=>w.jsx(w.Fragment,{children:"This project contains layers edited with Smart Cut. Upgrade or remove these layers to export."}))),uue=_.memo((()=>w.jsx(w.Fragment,{children:"This project contains a video layer that uses Remove Background. Upgrade or remove this layer to export."}))),mue=_.memo((()=>w.jsx(w.Fragment,{children:"This project contains an audio Waveform layer. Upgrade or remove the waveform layer to export."}))),pue=_.memo((()=>w.jsx(w.Fragment,{children:"This project contains a premium asset. Upgrade now or delete this layer to export."}))),hue={top:"44px",right:"74px"},gue={freeUserDurationLimit:{header:"Duration Limit Exceeded",subtext:w.jsx(nue,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.SINGLE_VIDEO_DURATION_LIMIT},freeUserSizeLimit:{header:"File Size Limit Exceeded",subtext:w.jsx(rue,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.UPLOAD_LIMIT},proUserDurationLimit:{header:"Export Limit Exceeded",subtext:w.jsx(lue,{}),position:hue,arrowPosition:"topCenter"},cleanAudioUsed:{header:"Clean Audio Used",subtext:w.jsx(due,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.CLEAN_AUDIO},videoSmartCutUsed:{header:"Smart Cut Used",subtext:w.jsx(cue,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.SMART_CUT_VIDEO},audioSmartCutUsed:{header:"Smart Cut Used",subtext:w.jsx(cue,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.SMART_CUT_AUDIO},removeVideoBackgroundUsed:{header:"Video Background Removed",subtext:w.jsx(uue,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.REMOVE_VIDEO_BACKGROUND},audiogramUsed:{header:"Waveform Added",subtext:w.jsx(mue,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.AUDIOGRAM_BAR},premiumAssetsUsed:{header:"Premium Asset Used",subtext:w.jsx(pue,{}),position:hue,arrowPosition:"topCenter",upsellAction:Vl.PREMIUM_ASSETS},enhancedImageUsed:{header:"Used Enhance Image",subtext:"This project contains a layer with Image Enhancements applied. Upgrade or remove this layer to export.",position:hue,arrowPosition:"topCenter",upsellAction:Vl.ENHANCE_IMAGE}},fue={[BK.AI_ARTICLE_TO_VIDEO]:"aiArticleToVideo",[BK.AI_AUDIO_ENHANCER]:"removeBackgroundNoise",[BK.AI_AUTO_SPEAKER_FOCUS]:"speakerFocus",[BK.AI_BLOG_TO_VIDEO]:"aiArticleToVideo",[BK.AI_CLIP_MAKER]:"trim-video",[BK.AI_CLIP_MAKER_PODCAST]:"trim-video",[BK.AI_CLIP_MAKER_TIKTOK]:"trim-video",[BK.AI_DUBBING]:"dubbing",[BK.AI_IMAGE_ENHANCER]:"enhanceImage",[BK.AI_IMAGE_GENERATOR]:"aiImageGenerator",[BK.AI_MAGIC_FILL]:"magicFill",[BK.AI_OVERVIEW]:"aiVideoGenerator",[BK.AI_TEXT_TO_VIDEO]:"aiVideoGenerator",[BK.AI_VIDEO_GENERATOR]:"aiVideoGenerator",[BK.AI_VIDEO_SCRIPT_GENERATOR]:"aiScriptGenerator",[BK.AI_VIDEO_SCRIPT_GENERATOR_PODCAST]:"aiScriptGenerator",[BK.AI_VOICE_CLONING]:"aiVoiceCloning",[BK.AI_VOICE_OVER_GENERATOR]:"text-to-speech",[BK.AI_VOICE_OVER_GENERATOR_FEMALE]:"text-to-speech",[BK.AI_VOICE_OVER_GENERATOR_MALE]:"text-to-speech",[BK.B_ROLL_GENERATOR]:"bRollGenerator",[BK.GIF_MAKER]:"gifMaker",[BK.MUTE_VIDEO]:"volume",[BK.SUBTITLES]:"subtitles",[BK.SUBTITLES_ADD_SUBTITLES]:"subtitles",[BK.SUBTITLES_AUTO_GENERATOR]:"subtitles",[BK.SUBTITLES_TRANSLATOR]:"translate",[BK.TEAMS_CREATIVE_AGENCIES]:"fallback",[BK.TEAMS_MARKETING]:"fallback",[BK.TEAMS_TRAINING]:"fallback",[BK.TOOLS_ADD_AUDIO]:"add-audio",[BK.TOOLS_ADD_AUDIO_SOUND_EFFECTS]:"add-audio",[BK.TOOLS_ADD_EFFECTS_WAVEFORM]:"waveform",[BK.TOOLS_ADD_IMAGE]:"timeline",[BK.TOOLS_ADD_TEXT]:"text",[BK.TOOLS_AUDIIO_EDITOR_EXTRACT]:"extract",[BK.TOOLS_AUDIO_EDITOR_AUDIO_ENHANCER]:"removeBackgroundNoise",[BK.TOOLS_COMPRESS]:"compressVideo",[BK.TOOLS_COMPRESS_GIF]:"compressVideo",[BK.TOOLS_CONVERT]:"convert",[BK.TOOLS_CROP]:"crop",[BK.TOOLS_MAKE_VIDEO_CLIP]:"trim-video",[BK.TOOLS_MAKE_VOICE_OVER]:"text-to-speech",[BK.TOOLS_MAKE_VIDEO_MONTAGE]:"timeline",[BK.TOOLS_MERGE_IMAGE]:"timeline",[BK.TOOLS_REMOVE_BACKGROUND]:"remove-video-background",[BK.TOOLS_REMOVE_BACKGROUND_NOISE]:"removeBackgroundNoise",[BK.TOOLS_RESIZE]:"resize",[BK.TOOLS_RESIZE_IMAGE]:"resize",[BK.TOOLS_RESIZE_TIKTOK]:"resize",[BK.TOOLS_SMART_CUT_FILLER_WORDS]:"trimWithTranscript",[BK.TOOLS_TEXT_TO_SPEECH]:"text-to-speech",[BK.TOOLS_TRANSCRIBE]:"transcribe",[BK.TOOLS_TRANSCRIBE_MP4_TO_TEXT]:"transcribe",[BK.TOOLS_TRANSCRIPTION]:"transcribe",[BK.TOOLS_TRANSLATE]:"translate",[BK.TOOLS_TRIM]:"trim-video",[BK.VIDEO_EDITOR]:"fallback"},yue={"add-audio":{generic:{header:"Add Audio",subtext:"Add audio to your project from the left sidebar."},video:{header:"Add Audio",subtext:"Add audio to your project from the left sidebar."}},adjust:{generic:{header:"Adjust",subtext:"First, upload your file, then adjust video quality and settings in the sidebar."},video:{header:"Adjust video",subtext:"Adjust video quality and settings here."},image:{header:"Adjust image",subtext:"Adjust image quality and settings here."}},animatedText:{generic:{header:"Animated Text",subtext:"Either upload your own image, GIF, or video, or use the GIPHY TEXT plugin to create animated text."},image:{header:"Animated Text",subtext:"Either upload your own image, GIF, or video, or use the GIPHY TEXT plugin to create animated text."},video:{header:"Animated Text",subtext:"Either upload your own image, GIF, or video, or use the GIPHY TEXT plugin to create animated text."}},"add-border":{generic:{header:"Add Border",subtext:"First upload your content, then use the 'Expand Padding' section in the right-hand sidebar to add a border."},image:{header:"Add Border",subtext:"Click elsewhere on the canvas to de-select your content, then use the 'Expand Padding' section to add a border."},video:{header:"Add Border",subtext:"Click elsewhere on the canvas to de-select your content, then use the 'Expand Padding' section to add a border."}},aiVoiceCloning:{generic:{header:"Voice cloning",subtext:"Open the Voice dropdown and click on “Add a new voice.” Then, record or upload a voice sample to clone."}},blur:{generic:{header:"Blur",subtext:"First upload an image or video, then use the controls in the sidebar to adjust blur levels."},image:{header:"Add Blur",subtext:"Use the controls to add blur to your image."},video:{header:"Add Blur",subtext:"Use the controls to add blur to your video."}},blurVideoBackground:{generic:{header:"Blur Video Background",subtext:"First upload a video, then use the controls in the sidebar to blur the background."},image:{header:"Blur Image",subtext:"Use the controls to add a blur effect to your image."},video:{header:"Blur Video Background",subtext:"Use the controls to blur the background of your video."}},bRollGenerator:{generic:{header:"B-Roll Generator",subtext:"First upload the video that you'd like to add b-roll for. Then, use Smart B-Roll to create clips for your video."},video:{header:"B-Roll Generator",subtext:"Select Smart B-Roll to start generating b-roll clips for your video."}},censor:{image:{header:"Add an Element",subtext:"Open the 'Elements' tab and choose a shape to censor your content"},video:{header:"Add an Element",subtext:"Open the 'Elements' tab and choose a shape to censor your content"},generic:{header:"Censor",subtext:"Upload your content, then use the `Elements` tab to cover parts of your content."}},collage:{generic:{header:"Make a collage",subtext:"Upload your files here, then rearrange them into the perfect collage."}},"color-changing":{generic:{header:"Make Color Changing GIF",subtext:"Upload a GIF, then click the EFFECTS tab and select 'Hue Rotate' to add a rainbow effect."},image:{header:"Color Change",subtext:"Click on EFFECTS to add a Hue Rotate effect to your gif"}},compressVideo:{generic:{header:"Compress",subtext:"Upload your content, then adjust the Compression Level in the export settings."},video:{header:"Compress video",subtext:"Open the Export Settings to adjust the compression Level."}},convert:{generic:{header:"Convert",subtext:"First upload the content that you want to convert. Then you will be able to export in different formats."},image:{header:"Convert to Video",subtext:"If you want to convert your image to a video, add a duration to your project. Otherwise, hit Export to choose a conversion type."},mobile:{header:"Convert",subtext:"First upload your content, then click export to choose the format you want to export."},video:{header:"Convert",subtext:"Click Export, then choose the format you want to convert your video to."},audio:{header:"Convert",subtext:"Click Export, then choose the format you want to convert your audio to."}},crop:{generic:{header:"Crop",subtext:"First, upload your file. Then, in the sidebar, use the controls to crop your content to the desired size."},image:{header:"Select Crop",subtext:"Click the CROP button to crop your image to a desired size."},video:{header:"Select Crop",subtext:"Click the CROP button to crop your video to a desired size."}},dubbing:{generic:{header:"Dubbing",subtext:"Upload the video or audio file you’d like to translate."},audio:{header:"Dubbing",subtext:"To dub your video, you need to 1) Generate subtitles, 2) Choose translation language, 3) Generate translated audio"},video:{header:"Dubbing",subtext:"To dub your video, you need to 1) Generate subtitles, 2) Choose translation language, 3) Generate translated audio"}},extract:{generic:{header:"Extract Audio",subtext:"Upload a video or paste a youtube link. Then, in the timeline, right-click the video layer and select Detach Audio."}},fallback:{generic:{header:"Upload your content",subtext:"Upload a file here, or use the controls to the left to get started."}},filter:{generic:{header:"Filter and adjust",subtext:"First, upload your file, then click the ADJUST tab in the sidebar."},image:{header:"Filter and Adjust",subtext:"Click on Filter to add a filter to your image, or Adjust to tweak adjustments."},video:{header:"Filter and Adjust",subtext:"Click on Filter to add a filter to your video, or Adjust to tweak adjustments."}},"freeze-frame":{generic:{header:"Freeze Frame",subtext:"Upload your video first, then use the sidebar to create a Freeze Frame"},video:{header:"Freeze Frame",subtext:"Use the TIMING tab to generate a Freeze Frame of your video"}},gifMaker:{generic:{header:"Make a GIF",subtext:"Upload a video or image here, then choose Export as a GIF when you're ready."},image:{header:"Convert to GIF",subtext:"You need to convert your image to a video in order to export it as an animated GIF. Choose a duration here."},video:{header:"Make a GIF",subtext:"When you're ready, click Export and then choose GIF."}},glitch:{generic:{header:"Glitch",subtext:"Upload your video, then create a split where you want the glitch effect to be."},video:{header:"Add Transitions",subtext:"In the 'Transitions' tab, drag and drop “Glitch Displace” or “Glitch Memories” between layers."}},"ken-burns":{generic:{header:"Add Ken Burns Effect",subtext:"Upload a video, open the right sidebar, and select 'Moving Zoom' under 'Animation'."}},keyframing:{generic:{header:"Add Keyframes to Video",subtext:"First upload your video, then add a keyframe with the “◇” button next to keyframable properties within the right sidebar."}},link:{generic:{header:"Make a Link",subtext:"Upload a video or image here, then export your project to get your shareable link."}},magicFill:{generic:{header:"Magic Fill",subtext:"Upload an image, and Kapwing will help you extend the background using AI."},image:{header:"Magic Fill",subtext:"Click Magic Fill to extend your image using AI."}},musicVideo:{generic:{header:"Create a music video",subtext:"Upload a video here, or use the controls to the left to get started."},video:{header:"Add Music",subtext:"Upload your own music, or browse from 1000+ songs and sound effects to add to your video."}},removeBackgroundNoise:{generic:{header:"Remove Noise",subtext:"First, upload a video, then use the Clean Audio button in the sidebar to remove background noise."},audio:{header:"Remove Noise",subtext:"Click to remove background noise."},image:{header:"Erase background",subtext:"Click to remove the image background"},video:{header:"Remove Noise",subtext:"Click to remove background noise."}},"remove-image-background":{generic:{header:"Erase Image Background",subtext:"Upload an image, then use the ERASE button in the sidebar to remove the background."},image:{header:"Erase background",subtext:"Click to remove the image background"},video:{header:"Remove background",subtext:"Click to remove the video background"}},"remove-video-background":{generic:{header:"Erase Video Background",subtext:"Upload a video, then click the EFFECTS tab in the sidebar to remove the background."},image:{header:"Erase background",subtext:"Click to remove the image background"},video:{header:"Remove background",subtext:"Click to remove the video background"}},speakerFocus:{generic:{header:"Upload a video with 1+ active speakers.",subtext:"Upload a video, then click the EFFECTS tab in the sidebar to remove the background."},canvas:{header:"Apply Speaker Focus",subtext:"Open “Resize Canvas,” and select Speaker Focus."}},chromakey:{generic:{header:"Chroma Key",subtext:"Upload a video, then use the controls in the sidebar to apply a chroma key effect / edit the green screen."},video:{header:"Chroma Key Effect",subtext:"Click the EFFECTS tab to apply a chroma key / green screen effect"}},podcast:{generic:{header:"Edit Audio for Podcasts",subtext:"Upload your audio and get started!"}},progressBar:{generic:{header:"Progress Bar",subtext:"Upload your content, then use the `Elements` tab to add a progress bar."},video:{header:"Progress Bar",subtext:"Click the ELEMENTS tab, then click one of the progress bar styles."}},"record-screen":{generic:{header:"Record",subtext:"Use the record tab in the sidebar to record your screen, camera, or audio."}},resize:{generic:{header:"Resize",subtext:"First, upload your file. Then, in the sidebar, use the controls to adjust the size of your content."},image:{header:"Resize",subtext:"Use the CROP button to crop your image, or deselect your image to resize the canvas."},video:{header:"Resize",subtext:"Click the CROP button to crop your video to a desired size. Or, de-select the video to resize the entire canvas."}},"safe-zone":{generic:{header:"Use Safe Zone",subtext:"Upload your content, then under the 'Canvas' tab, use the 'Safe Zones' section to resize your canvas."}},speed:{audio:{header:"Change Speed",subtext:"Use -/+ to increase or decrease the speed of your audio clip"},generic:{header:"Change Video Speed",subtext:"First, upload a file, then use the sidebar controls to change its speed."},video:{header:"Change Speed",subtext:"Use -/+ to increase or decrease the speed of your video"}},slowMotion:{generic:{header:"Upload",subtext:"First, upload the video you want to slow down. Then use the sidebar controls to change its speed."},video:{header:"Slow down video",subtext:"Use - to slow down your video."}},subtitles:{generic:{header:"Add Subtitles",subtext:"Upload a video, then you'll be able to use the controls to add subtitles to your content."},image:{header:"Choose a video",subtext:"You'll have to upload a video or audio file to add subtitles to your project."},video:{header:"Subtitle your video",subtext:"First auto-generate subtitles for your video, then you'll be able to edit them in your project."},audio:{header:"Create subtitles",subtext:"Auto-generate subtitles for your audio, then you'll be able to edit the project."},mobile:{header:"Create subtitles",subtext:"Auto-generate subtitles for your audio, then you'll be able to edit the project."}},text:{generic:{header:"Add text",subtext:"First, upload a video, then use the TEXT tab to add text to your video."},image:{header:"Use TEXT",subtext:"Click the TEXT button to add text to your image"},video:{header:"Use TEXT",subtext:"Click the TEXT button to add text to your video"}},timeline:{generic:{header:"Upload your content",subtext:"Upload video, images, or audio files and start editing them within the Kapwing editor."},image:{header:"Convert image to video",subtext:"If you want to make a video from this image, use the duration selector to change the duration of your image video."},video:{header:"Edit your video",subtext:"Use timeline to trim, merge, and edit your videos. Drag and drop files into Kapwing to start."},audio:{header:"Edit your audio",subtext:"Use timeline to trim, merge, and edit your audio files. Drag and drop files into Kapwing to start."}},"text-to-speech":{generic:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."},video:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."},audio:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."},text:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."}},transitions:{generic:{header:"Add Transitions",subtext:"First upload two videos, then click the 'Transitions' tab on the left sidebar to drag transitions onto your video."},image:{header:"Add Transitions",subtext:"Upload a video, then use the 'Transitions' tab to drag transitions onto your video."},video:{header:"Add Transitions",subtext:"Upload another video, then use the 'Transitions' tab to drag transitions onto your video."}},translate:{generic:{header:"Translate",subtext:"First, upload your content here. You can generate translated subtitles afterward."},audio:{header:"Translate",subtext:"Click the Translate button to start generating subtitles."},video:{header:"Translate",subtext:"Click the Translate button to start generating subtitles."}},"trim-video":{generic:{header:"Trim",subtext:"Upload your content, then use the timeline that appears to trim your video."},video:{header:"Trim Video",subtext:"Use the handlers at each end of the track to trim the video. Drag the track to change when it starts."}},"tv-static":{generic:{header:"Add TV Static",subtext:"Upload a video and start editing"},video:{header:"Apply TV Static",subtext:"When you're ready, select the 'Transitions' tab and search for the TV Static transition"}},youtubeThumbnail:{generic:{header:"Create a Youtube Thumbnail",subtext:"Paste the link to your Youtube Video below, then click Export to create a single frame of the video."},image:{header:"Make a thumbnail",subtext:"Click the CROP button to crop your image to a Youtube Thumbnail size."},video:{header:"Youtube Thumbnail",subtext:"Click Export, then select JPG to create an image thumbnail of your video."}},rotate:{video:{header:"Rotate Video",subtext:"Use the rotation controls to rotate, flip, or mirror your video."},image:{header:"Rotate Image",subtext:"Use the controls to rotate, mirror, or flip your image."},generic:{header:"Rotate",subtext:"First, upload a file, then use the sidebar controls to rotate your image or video."}},aiScriptGenerator:{generic:{header:"Create an AI Script",subtext:"Type an idea for a script that you'd like to generate, and Kapwing AI will take care of the rest."},image:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."},video:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."},audio:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."},mobile:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."}},aiVideoGenerator:{generic:{header:"Create a video with AI",subtext:"Type an idea for a video, and Kapwing AI will take care of the rest."},image:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."},video:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."},audio:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."},mobile:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."}},aiImageGenerator:{generic:{header:"Create an image with AI",subtext:"Type an idea for a image, and Kapwing AI will take care of the rest."},image:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."},video:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."},audio:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."},mobile:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."}},aiDocumentToVideo:{generic:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},image:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},video:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},audio:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},mobile:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."}},aiArticleToVideo:{generic:{header:"Article to Video",subtext:"Open Kapwing AI, then use the article to video tool to turn an article into a video."},image:{header:"Article to Video",subtext:"Open Kapwing AI, then use the article to video tool to turn an article into a video."},video:{header:"Article to Video",subtext:"Open Kapwing AI, then use the article to video tool to turn an article into a video."},audio:{header:"Article to Video",subtext:"Open Kapwing AI, then use the article to video tool to turn an article into a video."},mobile:{header:"Article to Video",subtext:"Open Kapwing AI, then use the article to video tool to turn an article into a video."}},aiMemeGenerator:{generic:{header:"Create memes with AI",subtext:"Enter what you want to make memes about, and Kapwing AI will take care of the rest."},image:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."},video:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."},audio:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."},mobile:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."}},transcribe:{generic:{header:"Create a transcription",subtext:"First upload your video, then use the controls to create and download a transcription."},video:{header:"Transcribe your video",subtext:"Auto-generate subtitles for your video, then you'll be able to download the full transcript."},audio:{header:"Transcribe your audio",subtext:"Auto-generate subtitles for your audio, then you'll be able to download the full transcript."},image:{header:"Create a transcription",subtext:"You'll have to upload a video or audio file to use the transcription tool."},mobile:{header:"Create a transcription",subtext:"First upload your video, then use the controls to create and download a transcription."}},trimWithTranscript:{generic:{header:"Edit video by editing text",subtext:"Get started by uploading the video or audio file that you'd like to edit."},video:{header:"Edit your video by editing text",subtext:"First transcribe your video, then you'll be able to split, trim, and edit using the words spoken in your video."},audio:{header:"Edit your audio by editing text",subtext:"First transcribe your audio, then you'll be able to split, trim, and edit using the words spoken in your audio."}},vttFile:{generic:{header:"Create a VTT File",subtext:"First upload your video, then use the controls to create and download a VTT file for your video."},video:{header:"Create your VTT file",subtext:"Auto-generate subtitles for your video, then you'll be able to download the complete VTT file."},audio:{header:"Create your VTT file",subtext:"Auto-generate subtitles for your audio, then you'll be able to download the complete VTT file."},image:{header:"Upload a video",subtext:"You'll have to upload a video or audio file to use the VTT file maker tool."},mobile:{header:"Create a VTT File",subtext:"First upload your video, then use the controls to create and download a VTT file for your video."}},"silence-remover":{audio:{header:"Apply Smart Cut",subtext:"Use Smart Cut to automatically remove silences from your audio."},generic:{header:"Remove silences",subtext:'Upload your audio, then use "Smart Cut" in the sidebar controls to remove silences'},video:{header:"Apply Smart Cut",subtext:"Use Smart Cut to automatically remove silences from your video."}},"smart-cut":{generic:{header:"Smart Cut",subtext:'First, upload your file. Then, in the sidebar to select "Smart Cut".'},video:{header:"Smart Cut",subtext:"Use Smart Cut to automatically trim your video to remove silence and unwanted footage."}},srtFile:{generic:{header:"Create an SRT File",subtext:"First upload your video, then use the controls to create and download a SRT file for your video."},video:{header:"Create your SRT file",subtext:"Auto-generate subtitles for your video, then you'll be able to download the complete SRT file."},audio:{header:"Create your SRT file",subtext:"Auto-generate subtitles for your audio, then you'll be able to download the complete SRT file."},image:{header:"Upload a video",subtext:"You'll have to upload a video or audio file to use the SRT file maker tool."},mobile:{header:"Create an SRT File",subtext:"First upload your video, then use the controls to create and download a SRT file for your video."}},"trim-audio":{audio:{header:"Trim",subtext:"Use the handlers at each end of the track to trim the audio. Drag the track to change when it starts."},generic:{header:"Trim Audio",subtext:"Upload your content here, then use the timeline that appears to trim your audio."},video:{header:"Trim",subtext:"Use the handlers at each end of the track to trim the audio. Drag the track to change when it starts."}},record:{generic:{header:"Record",subtext:"Use the record tab in the sidebar to record your screen, camera, or audio."}},reverse:{generic:{header:"Reverse",subtext:"Upload your content, then use the controls in the right-hand sidebar to reverse your video or gif."},video:{header:"Reverse Video",subtext:"Use this checkbox to reverse your video."}},repurpose:{canvas:{header:"Resize",subtext:"Click the Resize Canvas button to change the size of your project."}},pinning:{image:{header:"Pin Object with Keyframes",subtext:"Click on the “◇” button to mark its starting position then drag the seeker along the timeline and move your layer to the position of the object you are tracking in the video. Repeat this process to create a pinning effect."},video:{header:"Pin Object with Keyframes",subtext:"First, add a text, shape, or image layer. Move it to the object you would like to track on your video then click on the “◇” button to mark its starting position."}},slideshow:{generic:{header:"Make a slideshow",subtext:"Upload images and videos to get started."},image:{header:"Add duration",subtext:"Add duration to your images to create a slideshow."}},srtEditor:{generic:{header:"Upload a video",subtext:"First, upload the video you'd like to add subtitles to. You can upload an SRT file in the next step."},mobile:{header:"Upload a video",subtext:"First, upload the video you'd like to add subtitles to. You can upload an SRT file in the next step."},video:{header:"Upload SRT file",subtext:"Upload an SRT file to edit your subtitles directly from the SRT file editor that will appear."}},vhs:{generic:{header:"Add a VHS Effect",subtext:"Open the 'Images' tab and search for VHS effects to add to your content"}},volume:{video:{header:"Adjust Volume",subtext:"Use this slider to adjust the volume of your video."},audio:{header:"Adjust Volume",subtext:"Use this slider to adjust the volume of your audio."}},waveform:{generic:{header:"Add a waveform / audiogram",subtext:"First, upload a file, then click on 'Elements' in the sidebar to add a waveform."},image:{header:"Add Waveform",subtext:"Open the ELEMENTS tab, then click one of the waveform patterns."},video:{header:"Add Waveform",subtext:"Open the ELEMENTS tab, then click one of the waveform patterns."}},webcam:{generic:{header:"Test your webcam",subtext:"Allow Kapwing access in order to test your webcam. You can also record a video."}},enhanceImage:{generic:{header:"Enhance Image",subtext:"Upload an image, then use the Enhance Image button in the sidebar to enhance your image."},image:{header:"Enhance Image",subtext:"Click this button to enhance your image."}}};function vue({hasLayers:e,isMobile:t,selectedLayerType:o,toolTip:a}){if(!(a in yue))return null;const i=yue[a];if(!i)return null;if(t)return i.mobile?{data:i.mobile,type:"mobile"}:null;if(!o)return e?i.canvas?{data:i.canvas,type:"canvas"}:null:i.generic?{data:i.generic,type:"generic"}:null;const s=i[o];return s?{data:s,type:o}:null}const _ue=({mobileToolTip:e,toolTip:t})=>{let o={};return t in gue&&(o=gue[t]),e&&(o={}),o};function wue(e){const{isOpen:t,currentStep:o,userBeganTour:a,tour:i,source:s}=tl((t=>{const o=t.studioTour.isOpen,a=t.studioTour.currentStep,i=t.studioTour.userBeganTour,s=t.studioTour.tour;return{isOpen:e?o&&yL[s][a]===e&&i:o,currentStep:a,userBeganTour:i,tour:t.studioTour.tour,source:t.studioTour.source}}),ol),n=yL[i];return{isOpen:t,isFirstStep:0===o,isLastStep:o===n.length-1,steps:n,currentStep:o,userBeganTour:a,tour:i,source:s}}const bue=_.memo((({align:e="start",children:t,portal:o,position:a="top",sideOffset:i=2,tooltips:s})=>{const{isOpen:n}=wue(),r=h.useRef(!1),l=h.useRef(null),d=ku(),c=il(),u=tl((e=>e.toolTip)),m=tl((e=>{if(e.studio.selectedItem&&"layer"===e.studio.selectedItem.type){const t=e.studio.allLayers.byId[e.studio.selectedItem.id];if(t)return t.type}return null})),p=tl((e=>Object.keys(e.studio.allLayers.byId).length>0)),g=h.useCallback((e=>{c(fS("")),e.stopPropagation()}),[c]);h.useLayoutEffect((function(){const e=()=>{},t=l.current;if(!t)return e;if(!("scrollIntoView"in t))return e;if(r.current)return e;let o=setTimeout((function e(){r.current||(null==t||t.scrollIntoView({block:"center",behavior:"smooth"}),o=setTimeout(e,750))}),200);const a=new IntersectionObserver((e=>{var t;!0===(null==(t=e[0])?void 0:t.isIntersecting)&&(r.current=!0,clearTimeout(o))}),{threshold:[1]});return a.observe(t),()=>{a.disconnect(),clearTimeout(o)}}),[]);const f=w.jsx(w.Fragment,{children:t});if(n)return f;if(!u)return f;let y=u in s?s[u]:null,v=vue({hasLayers:p,toolTip:u,selectedLayerType:m,isMobile:d});if(!v&&"fallback"in s){const e=_ue({layersLength:p?1:0,mobileToolTip:d,toolTip:u});Object.keys(e||{}).length>0||(v=vue({hasLayers:p,toolTip:"fallback",selectedLayerType:m,isMobile:d}),y=s.fallback)}if(!v)return f;const{data:b,type:T}=v;if(!y||!y.includes(T))return f;const{subtext:x,header:S,large:E}=b,I=o?No:_.Fragment;return w.jsxs(Ro,{open:!0,children:[w.jsx(Po,{asChild:!0,ref:l,children:t}),w.jsx(I,{children:w.jsxs(Do,{side:a,align:e,alignOffset:-40,arrowPadding:20,collisionPadding:12,sideOffset:i,className:`${qce}`,children:[w.jsxs("div",{className:`${Xce} ${E?Qce:""}`,"data-cy":`${u}-tool-tip-container`,children:[w.jsxs("div",{className:aue,children:[S&&w.jsx("div",{className:eue,children:S}),w.jsx(Oo,{asChild:!0,onClick:g,children:w.jsx("span",{className:iue,"data-cy":`${u}-tool-tip-exit`,children:w.jsx("div",{className:tue,children:w.jsx(ve,{})})})})]}),w.jsx("div",{className:oue,children:x})]}),w.jsx(Lo,{className:Zce,width:14,height:7})]})})]})})),Tue="HeaderAiButton-module_disabled_NxSk-",xue="HeaderAiButton-module_headerButtonContainer_3s6M3",Sue="HeaderAiButton-module_headerButtonIcon_mgxEX",Eue="HeaderAiButton-module_headerAiButtonContainer_kuK5f",Iue="HeaderAiButton-module_headerAiTooltip_zaJw-",Cue="ReplaceBrollOverlay-module_wrapper_E8Yse",kue="ReplaceBrollOverlay-module_textarea_sNXvD",Aue="ReplaceBrollOverlay-module_background_m7-WU",jue="ReplaceBrollOverlay-module_modal_-pyx9",Nue="ReplaceBrollOverlay-module_container_-scMD",Rue="ReplaceBrollOverlay-module_header_TQu7Y",Pue="ReplaceBrollOverlay-module_headerIcon_vf6OQ",Due="ReplaceBrollOverlay-module_headerText_3aGoH",Oue="ReplaceBrollOverlay-module_tabRow_dDtme",Lue="ReplaceBrollOverlay-module_tab_Pgs5T",Fue="ReplaceBrollOverlay-module_selectedTab_B1rXc",Mue="ReplaceBrollOverlay-module_inputRow_KDZ3x",Uue="ReplaceBrollOverlay-module_searchIcon_wN4VE",Bue="ReplaceBrollOverlay-module_searchButton_eRILE",Vue="ReplaceBrollOverlay-module_imageGrid_gwJXN",Wue="ReplaceBrollOverlay-module_shimmerDiv_zKx8z",Gue="ReplaceBrollOverlay-module_imageContainer_0cfHQ",Hue="ReplaceBrollOverlay-module_imageChecked_vDkIx",$ue="ReplaceBrollOverlay-module_image_chUM8",Kue="ReplaceBrollOverlay-module_addIcon_5HxTs",zue="ReplaceBrollOverlay-module_addText_CfE34",Yue="ReplaceBrollOverlay-module_infiniteScrollSensor_C0sC8",Jue="ReplaceBrollOverlay-module_spinner_hxfZt",que="ReplaceBrollOverlay-module_noMoreResults_Ei6Xg",Xue="ReplaceBrollOverlay-module_close_SJVOT",Que="LoadingSpinner-module_spinnerWrapper_sY-yh",Zue="LoadingSpinner-module_spinner_HkeKv",eme=_.memo((({fontSize:e=16})=>{const t=h.useMemo((()=>({fontSize:e})),[e]);return w.jsx("div",{className:Que,children:w.jsx(Fo,{className:Zue,style:t})})}));function tme(){eE("/studio/editor/replace-broll-overlay")}function ome(){const{dispatch:e}=sr();e(hv({newBrollLayer:void 0})),eE("/studio/editor")}const ame=async(e,t)=>{const o=[],a=await PX(e,{pageNumber:t,includeGetty:!0});return a.pexels.slice(0,10).forEach((e=>{o.push({name:e.name,preview:e.images.small,url:e.images.download,dimensions:e.dimensions,type:"pexels",object:e})})),a.getty.slice(0,10).forEach((e=>{o.push({name:e.name,preview:e.images.small,url:e.images.download,dimensions:e.dimensions,type:"getty",object:e})})),o},ime=async(e,t)=>{const o=[],a=await MX(e,{pageNumber:t,includeGetty:!0});return a.pixabay.slice(0,10).forEach((e=>{o.push({name:e.attribution.url,preview:e.video.small,url:e.video.small,dimensions:e.dimensions,type:"pixabay",object:e})})),a.pexels.slice(0,10).forEach((e=>{o.push({name:e.attribution.url,preview:e.video.small,url:e.video.small,dimensions:e.dimensions,type:"pexels",object:e})})),a.getty.slice(0,10).forEach((e=>{o.push({name:e.attribution.url,preview:e.video.small,url:e.video.small,dimensions:e.dimensions,type:"getty",object:e})})),o},sme=_.memo((()=>{const[e,t]=h.useState(!1),[o,a]=h.useState(!1),[i,s]=h.useState(!1),[n,r]=h.useState(!1),l=tl((e=>e.bRoll.replacingBrollLayer)),d=dz(l||""),[c,u]=h.useState((null==d?void 0:d.aiGeneratorQuery)||""),[m,p]=h.useState((null==d?void 0:d.type)===zl.Image),[g,f]=h.useState([]),[y,v]=h.useState(null),[_,b]=h.useState(1),T=h.useCallback((async(e,o)=>{1===e?a(!0):t(!0);let i=[];o?(i=i.concat(await ame(c,e)),b(_+1),1===e&&i.length<=12&&(i=i.concat(await ame(c,e+1)),b(_+2))):(i=i.concat(await ime(c,e)),b(_+1),1===e&&i.length<=12&&(i=i.concat(await ime(c,e+1)),b(_+2))),0===i.length&&s(!0),1===e?(f(i),a(!1)):(f([...g,...i]),t(!1))}),[_,g,c]);h.useEffect((function(){""!==c&&T(1,m)}),[]),h.useEffect((function(){if(!y)return()=>{};let e=!1;const t=new IntersectionObserver((t=>{t[0].intersectionRatio>=0&&(e?T(_,m):e=!0)}));return t.observe(y),()=>{t.disconnect()}}),[_,y,m,T]);const x=()=>{e||ome(),e&&n&&ome(),e&&r(!0)},S=h.useCallback((e=>{"Escape"===e.key&&ome()}),[]),E=h.useCallback((e=>{"Enter"===e.key&&(e.preventDefault(),T(1,m),b(1))}),[m,T]),I=cE((()=>(document.addEventListener("keydown",S,!1),()=>{document.removeEventListener("keydown",S,!1)}))),C=cE((()=>(document.addEventListener("keydown",E,!1),()=>{document.removeEventListener("keydown",E,!1)})));h.useEffect((function(){I(),C()}),[C,I]);const k=()=>null==g?void 0:g.map((e=>w.jsxs("div",{className:Gue,onClick:()=>(async e=>{if(!e||!d)return;const{state:t}=sr(),o=d.type===zl.Image;let a;if(m){const{width:t,height:i}=e.dimensions,s=o?d.startTime:d.videoDelay;let n=d.endTime;o||(n=d.videoDelay&&d.endTime?d.videoDelay+d.endTime:void 0),a=await Mre({layerProperties:{position:ele(t,i,"center"),crop:{x:0,y:0,width:100,height:100},name:`${c} image`,type:zl.Image,startTime:s,endTime:n,timelineRow:d.timelineRow,isTrimmed:!0,aiGeneratorQuery:c,bRollLayerSource:"pexels"===e.type?"pexels-images":"getty-images",keyframeAnimation:s&&n?bse.getKeyFrameAnimation(s,n):void 0},skipCML:!0,skipStudioAddLayer:!0,image:e.object,useCustomVideoDelay:o?d.startTime:d.videoDelay})}else{const{width:t,height:i,duration:s}=e.dimensions;if(void 0===d.startTime||void 0===d.endTime)return;a=await Fre({forceNoAudio:!0,layerProperties:{position:ele(t,i,"center"),crop:{x:0,y:0,width:100,height:100},type:zl.Video,volume:0,startTime:0,endTime:o?d.endTime-d.startTime:d.endTime,duration:s,videoDelay:o?d.startTime:d.videoDelay,timelineRow:d.timelineRow,isTrimmed:!0,bRollLayerSource:"getty-videos",aiGeneratorQuery:c,usedProFeatures:["premium-assets"],hasAudio:!1,name:`${c} video`},skipCML:!0,skipStudioAddLayer:!0,video:e.object,useCustomVideoDelay:d.startTime})}a&&(fz(a,d,{knownTimelineRow:!0,sceneId:t.studio.scenes[0].id,undoable:!0}),ome())})(e),children:[w.jsxs("div",{className:Hue,children:[w.jsx(St,{className:Kue}),w.jsx("span",{className:zue,children:"Use this asset"})]}),m?w.jsx("img",{className:$ue,src:e.preview,alt:`${e.url}`,draggable:!1}):w.jsx("video",{className:$ue,controls:!1,muted:!0,src:e.preview})]},e.url))),A=()=>{p(!m),b(1),T(1,!m)},j=()=>w.jsx(w.Fragment,{children:w.jsxs("div",{className:Cue,children:[w.jsx("div",{className:Aue,onClick:x}),w.jsxs("div",{className:jue,children:[w.jsx("div",{className:Xue,onClick:ome,children:w.jsx(ve,{})}),w.jsxs("div",{className:Nue,children:[w.jsx("div",{className:Rue,children:w.jsxs("div",{className:Due,children:[w.jsx(Mo,{className:Pue}),"Replace B-Roll"]})}),w.jsxs("div",{className:Oue,children:[w.jsx("div",{className:m?Fue:Lue,onClick:m?void 0:A,children:"Images"}),w.jsx("div",{className:m?Lue:Fue,onClick:m?A:void 0,children:"Videos"})]}),w.jsxs("div",{className:Mue,children:[w.jsx(Uo,{className:Uue}),w.jsx("textarea",{className:kue,autoFocus:!0,placeholder:"Generate a video about...",value:c,onChange:e=>u(e.target.value)}),w.jsx("div",{className:Bue,onClick:()=>T(1,m),children:"Search"})]}),w.jsx("div",{className:Vue,children:o?[...Array(12).keys()].map((e=>w.jsx("div",{className:Wue},e))):w.jsxs(w.Fragment,{children:[k(),i&&w.jsx("div",{className:que,children:"No more results: try another query"}),!i&&!e&&w.jsx("div",{className:Yue,ref:e=>v(e)}),e&&w.jsx("div",{className:Jue,children:w.jsx(eme,{})})]})})]})]})]})}),N=".app-container",R=document.querySelector(N);return R?Ao.createPortal(j(),R):(console.error(`Expected ${N} to exist in the DOM`),j())})),nme={aiScriptGenerator:["image","video","audio","mobile"],aiVideoGenerator:["image","video","audio","mobile"],aiImageGenerator:["image","video","audio","mobile"],aiDocumentToVideo:["generic","image","video","audio","mobile"],aiArticleToVideo:["generic","image","video","audio","mobile"],aiMemeGenerator:["image","video","audio","mobile"]},rme=_.memo((({disabled:e})=>{const t=il(),o=be(),a=Ve(),i=o.pathname.includes("/ai-tools"),s=o.pathname.includes("/replace-broll-overlay"),n=new URLSearchParams(o.search),r=n.get("tab");if(r&&r in ane){t(cw({selectedTab:ane[r]})),n.delete("tab"),a.replace({search:n.toString()})}return w.jsxs(w.Fragment,{children:[w.jsx(bue,{tooltips:nme,children:w.jsxs("div",{className:`${xue}\n        ${Eue}\n        ${e?Tue:""}`,onClick:zce,"data-cy":"header-ai-button",children:[w.jsx(jo,{className:Sue}),w.jsx("span",{className:Iue,children:"Create with Kapwing AI"})]})}),i?w.jsx(Jce,{}):null,s?w.jsx(sme,{}):null]})})),lme=()=>{const[e,t]=h.useState(Ps);return h.useEffect((()=>Os((()=>t(!0)))),[]),e},dme="ProfilerDashboard-module_portal_q41dD",cme="ProfilerDashboard-module_devDashboard_E-viJ",ume="ProfilerDashboard-module_hidden_n9vIU",mme="ProfilerDashboard-module_tabs_xBI-W",pme="ProfilerDashboard-module_data_vJsxM",hme="ProfilerDashboard-module_disabled_0vE4w",gme="ProfilerDashboard-module_header_svdlE",fme="ProfilerDashboard-module_status_3UAZd",yme="ProfilerDashboard-module_devDashboardButton_QM9UW",vme="ProfilerDashboard-module_warningFlag_jtC42",_me="ProfilerDashboard-module_title_CVYl9",wme=Intl.NumberFormat(void 0,{maximumFractionDigits:0}),bme=Intl.NumberFormat(void 0,{maximumFractionDigits:1}),Tme=e=>`${wme.format(e)}ms`,xme=e=>`${bme.format(e/Math.pow(2,20))}mb`,Sme="reports-module_reports_wE3nG",Eme="reports-module_fetchTable_pkjW-",Ime="reports-module_elementTable_okG1T",Cme="reports-module_caret_Z57sj",kme="reports-module_expanded_t5yzt",Ame="reports-module_profilerTree_wDsPU",jme="reports-module_subcategory_S6nQz",Nme="reports-module_timing_fosLr",Rme="reports-module_userEventTimings_5EpmX",Pme="reports-module_pointerPosition_4y6IP",Dme=e=>{let t=0,o=0,a=0,i=0,s=0,n=0;for(const r of e)s+=1,i+=r.transferSize,n+=r.responseEnd-r.fetchStart,"fetch"!==r.initiatorType&&"xmlhttprequest"!==r.initiatorType||(t+=1,o+=r.transferSize,a+=r.responseEnd-r.fetchStart);return{fetches:t,fetchedBytes:o,fetchTime:a,totalRequests:s,totalBytes:i,totalTime:n}},Ome=_.memo((({setWarningStates:e,clear:t})=>{const[{fetches:o,fetchedBytes:a,fetchTime:i,totalBytes:s,totalRequests:n,totalTime:r},l]=h.useState((()=>Dme(performance.getEntriesByType("resource"))));h.useEffect((()=>()=>{l(Dme([]))}),[t]),h.useEffect((()=>{e((e=>({...e,"fetches over 100":o>100})))}),[e,o]),h.useEffect((()=>{const e=new PerformanceObserver((e=>{l((t=>{const o=Dme(e.getEntries());return{fetches:t.fetches+o.fetches,fetchedBytes:t.fetchedBytes+o.fetchedBytes,fetchTime:t.fetchTime+o.fetchTime,totalRequests:t.totalRequests+o.totalRequests,totalBytes:t.totalBytes+o.totalBytes,totalTime:t.totalTime+o.totalTime}}))}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[]);const d="For chrome reasons. this is annoying to support the other 2 pieces of data";return w.jsxs("div",{className:Eme,children:[w.jsx("div",{}),w.jsx("div",{children:"Count"}),w.jsx("div",{title:`1mb is 2^20 (${Math.pow(2,20)}) bytes`,children:"Bytes"}),w.jsx("div",{title:"Timing may overlap with one another",children:"Time"}),w.jsx("div",{children:"Fetches"}),w.jsx("div",{children:wme.format(o)}),w.jsx("div",{children:xme(a)}),w.jsx("div",{children:gr(i)}),w.jsx("div",{children:"Total"}),w.jsx("div",{children:wme.format(n)}),w.jsx("div",{children:xme(s)}),w.jsx("div",{children:gr(r)}),w.jsx("div",{title:d,children:"WebSockets"}),w.jsx("div",{title:d,children:Vs})]})}));function Lme(e){const[t,o]=h.useState(e);return[t,h.useCallback((e=>{o((t=>{const o="function"==typeof e?e(t):e;return!1===ol(t,o)?o:t}))}),[])]}const Fme=_.memo((({setWarningStates:e,shouldThrottle:t})=>{const[o,a]=Lme({}),[i,s]=Lme({}),[n,r]=Lme({}),l=tl((e=>e.studio.allLayers.byId)),d=tl((e=>e.studioLocal.layerTempValues)),c=tl((e=>e.studioLocal.assetTempValues));return h.useEffect((function(){null!=i&&null!=n&&e((e=>({...e,"audio not local blob":!Zr.remotePlayback&&!!o.nonLocalBlobs,"image not local blob":!Zr.remotePlayback&&!!n.nonLocalBlobs,"video not local blob":!Zr.remotePlayback&&!!i.nonLocalBlobs,"audio error":!!o.errors,"image loading":!!n.errors,"video error":!!i.errors})))}),[e,i,n,o]),h.useEffect((function(){e(Object.values(l).filter((e=>"video"===e.type)),s);e(Object.values(l).filter((e=>"image"===e.type)),r);function e(e,t){var o,a,i;let s=0;for(const n of e)n.local_url||(s+=1);if("video"===(null==(o=e[0])?void 0:o.type))for(const n of e){const e=null==(a=d[n.id])?void 0:a.trackPreviewLocalUrl,t=n.asset_id&&(null==(i=c[n.asset_id])?void 0:i.thumbnailSheetLocalInfo);d[n.id]&&(e||t)||(s+=1)}t((t=>({...t,layerCount:e.length,nonLocalBlobs:s})))}e(Object.values(l).filter((e=>"audio"===e.type)),a)}),[l,d]),h.useEffect((()=>{const e=t?2e3:200;let o;const i=()=>{const t=document.getElementsByTagName("video"),n=t.length,l=[...t].filter((e=>e.error)).length,d=document.getElementsByTagName("img"),c=d.length,u=[...d].filter((e=>!e.complete||!e.naturalWidth||!e.naturalHeight)).length,m=document.getElementsByTagName("audio"),p=m.length,h=[...m].filter((e=>e.error)).length;s((e=>({...e,elements:n,errors:l}))),r((e=>({...e,elements:c,errors:u}))),a((e=>({...e,elements:p,errors:h}))),o=setTimeout(i,e)};return i(),()=>{o&&clearTimeout(o)}}),[t]),null==i||null==n?null:w.jsxs("div",{className:Ime,children:[w.jsx("div",{}),w.jsx("div",{children:"Elements"}),w.jsx("div",{children:"Errors"}),w.jsx("div",{children:"Layers"}),w.jsx("div",{children:"Local files"}),w.jsx("div",{children:"Videos"}),w.jsx("div",{children:i.elements}),w.jsx("div",{title:`${i.errors} have errors`,children:i.errors?"❌💩":"✅"}),w.jsx("div",{children:i.layerCount}),w.jsx("div",{title:`${i.nonLocalBlobs} videos not using local urls`,children:i.nonLocalBlobs?"❌💩":"✅"}),w.jsx("div",{children:"Audio"}),w.jsx("div",{}),w.jsx("div",{title:`${o.errors} have errors`,children:o.errors?"❌💩":"✅"}),w.jsx("div",{children:o.layerCount}),w.jsx("div",{title:`${o.nonLocalBlobs} audio elements not using local urls`,children:o.nonLocalBlobs?"❌💩":"✅"}),w.jsx("div",{children:"Images"}),w.jsx("div",{children:n.elements}),w.jsx("div",{title:`${n.errors} are still loading`,children:n.errors?"❌💩":"✅"}),w.jsx("div",{children:n.layerCount}),w.jsx("div",{title:`${n.nonLocalBlobs} images not using local urls`,children:n.nonLocalBlobs?"❌💩":"✅"})]})})),Mme=_.memo((function({expanded:e}){return w.jsx("div",{className:`${Cme} ${e?kme:""}`})})),Ume=({shouldThrottle:e,clear:t})=>{const[o,a]=h.useState({}),[i,s]=h.useState((()=>Fs.getSortedCategories()));h.useEffect((()=>()=>{a({}),Fs.clear(),s(Fs.getSortedCategories())}),[t]);return h.useEffect((()=>{if(e)return()=>{};const t=()=>{setTimeout((()=>{s(Fs.getSortedCategories())}),0)};return t(),Fs.addEventListener("update",t),()=>{Fs.removeEventListener("update",t)}}),[e]),w.jsx("div",{className:Ame,children:[...i].map((([e,t])=>w.jsxs(h.Fragment,{children:[w.jsxs("div",{onClick:()=>(e=>a((t=>({...t,[e]:!t[e]}))))(e),children:[e,w.jsx(Mme,{expanded:o[e]})]}),w.jsxs("div",{className:Nme,children:["(",Tme(t.total.time),"/",wme.format(t.total.hits).padEnd(3," "),")"]}),o[e]&&[...t.totalByKey].map((([t,o])=>w.jsxs(h.Fragment,{children:[w.jsx("div",{className:jme,children:t}),w.jsxs("span",{className:Nme,children:["(",Tme(o.time),"/",wme.format(o.hits).padEnd(3," "),")"]})]},`${e}${t}`)))]},e)))})};Ume.ignoreProfile=!0;const Bme=_.memo(Ume),Vme=_.memo((({shouldThrottle:e,clear:t})=>{const o=h.useRef([]),[a,i]=h.useState(0),[s,n]=h.useState(),r=h.useRef(),[l]=h.useState((()=>{const e=document.getElementById("userEventsPortal");if(e)return e;const t=document.createElement("div");return t.id="userEventsPortal",document.body.appendChild(t),t}));h.useEffect((()=>()=>l.remove()),[l]),h.useEffect((()=>()=>{o.current=[]}),[t]);const d=cE((()=>{e||r.current||(r.current=setTimeout((()=>{r.current=void 0,i((e=>e+1))}),100))}));return h.useEffect((()=>{const e=e=>{const t={};t.time=performance.now();const a=o.current[0];if(a?(t.index=1+a.index,t.timeSincePrevious=t.time-a.time):t.index=1,e instanceof KeyboardEvent)" "===e.key?t.name="space":t.name=e.key;else if(e instanceof PointerEvent){const o=["left","middle","right","back","forward"][e.button];t.name=`${o} click`,t.mouseEvent={x:e.pageX,y:e.pageY}}o.current.unshift(t),o.current.length>20&&o.current.pop(),d()};return document.addEventListener("keydown",e,{capture:!0,passive:!0}),document.addEventListener("pointerdown",e,{capture:!0,passive:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",e,{capture:!0})}}),[d]),w.jsxs("div",{className:Rme,children:[o.current.map((({name:e,timeSincePrevious:t,index:o,mouseEvent:a})=>w.jsxs(h.Fragment,{children:[w.jsxs("div",{onPointerOver:()=>n(a),onPointerOut:()=>n(void 0),children:[o,") ",e]}),w.jsx("div",{className:Nme,children:t?Tme(t):""})]},o))),s&&_e.createPortal(w.jsx("div",{className:Pme,style:{top:s.y,left:s.x}}),l)]})})),Wme=_.memo((({className:e,clear:t,disabled:o,setWarningStates:a})=>w.jsxs("div",{className:mt(e,Sme),children:[w.jsx(Fme,{shouldThrottle:o,setWarningStates:a}),w.jsx(Ome,{clear:t,setWarningStates:a}),w.jsx(Vme,{clear:t,shouldThrottle:o}),w.jsx(Bme,{clear:t,shouldThrottle:o})]}))),Gme="assets-module_videos_vvVwU",Hme=async(e,t)=>{if(Hme.cache.has(e))return Hme.cache.get(e);const o=await fetch(e,{headers:{Range:"bytes=0-100000"},signal:t});if(null==o)return null;const a=await o.arrayBuffer(),i=[];return(()=>{const e={};let t=!1,o=0,s=!1;for(;o<a.byteLength&&!s;){const i={size:(n=new DataView(a,o,8)).getUint32(0),type:String.fromCharCode(n.getUint8(4),n.getUint8(5),n.getUint8(6),n.getUint8(7))};switch(i.type){case"ftyp":break;case"moov":e.mdat||(t=!0);break;default:s=!0}o+=i.size,e[i.type]?e[i.type]+=1:e[i.type]=1}var n;e.ftyp?(i.push("mp4"),e.sidx?i.push("fragmented"):t&&i.push("faststart")):i.push("not mp4")})(),Hme.cache.set(e,i),i};Hme.cache=new Map;const $me=ll((e=>e.studio.allLayers.byId),(e=>{const t=Object.values(e).filter((e=>"video"===e.type&&null!=e.asset_id));return s.uniqBy(t,"asset_id")})),Kme=_.memo((({className:e,clear:t,setWarningStates:o})=>{const a=tl($me),[i]=h.useState((()=>new AbortController)),[s,n]=h.useState({}),r=h.useRef({});return h.useEffect((()=>{Hme.cache.clear(),r.current={},n({})}),[t]),h.useEffect((()=>{for(const e of a){const t=k0(e);null==r.current[t]&&(r.current[t]=(async()=>{const e=await Hme(t,i.signal);n((o=>({...o,[t]:e})))})())}}),[a,i]),h.useEffect((()=>{const e=a.some((e=>e.optimization_failed));o((t=>({...t,"optimize failed":e})))}),[a,o]),w.jsx("div",{className:e,children:w.jsxs("div",{className:Gme,children:[w.jsx("div",{children:"Asset id"}),w.jsx("div",{children:"Name"}),w.jsx("div",{children:"Size"}),w.jsx("div",{children:"Optimized"}),w.jsx("div",{children:"Local file"}),w.jsx("div",{children:"flags"}),a.map((e=>{var t;let o;return o=e.optimization_failed?"❌ Failed":null!=e.preview?"Yes":"No",w.jsxs(h.Fragment,{children:[w.jsx("div",{children:e.asset_id}),w.jsx("div",{children:e.originalName??e.name}),w.jsxs("div",{children:[e.width,"x",e.height]}),w.jsx("div",{children:o}),w.jsx("div",{children:e.local_url?"Yes":"No"}),w.jsx("div",{children:null==(t=s[k0(e)])?void 0:t.join(",")})]},e.asset_id)}))]})})})),zme=new EventTarget,Yme=e=>{Object.assign(Zr,e),sh.set("devModeDebugFlags",Zr),zme.dispatchEvent(new Event("update"))},Jme=e=>{const[t,o]=h.useState(Ps),[a,i]=h.useState(Zr[e]??null);return h.useEffect((()=>Os((()=>o(!0)))),[]),h.useEffect((()=>{const t=()=>i(Zr[e]??null);return zme.addEventListener("update",t),()=>{zme.removeEventListener("update",t)}}),[e]),t?a:null},qme="utilities-module_utilities_Uzz0V",Xme=_.memo((({className:e})=>w.jsxs("div",{"data-draggable":!0,className:mt(qme,e),children:[w.jsxs("label",{children:[w.jsx("input",{type:"checkbox",title:"Don't download any assets",defaultChecked:Zr.remotePlayback??!1,onChange:e=>Yme({remotePlayback:e.target.checked})}),"Force remote playback"]}),w.jsxs("label",{children:[w.jsx("input",{type:"checkbox",title:"Delete the indexdb on a page load",defaultChecked:Zr.clearDbOnLoad??!1,onChange:e=>Yme({clearDbOnLoad:e.target.checked})}),"Clear DB on load"]}),w.jsxs("label",{children:[w.jsx("input",{type:"checkbox",title:"Ignore any de-duplication logic",defaultChecked:Zr.forceNewAssets??!1,onChange:e=>Yme({forceNewAssets:e.target.checked})}),"Force new assets"]}),w.jsxs("label",{children:[w.jsx("input",{type:"checkbox",title:"Show export preview canvas",defaultChecked:Zr.showExportPreviewCanvas??!1,onChange:e=>Yme({showExportPreviewCanvas:e.target.checked})}),"Show export preview canvas"]}),w.jsxs("label",{children:[w.jsx("input",{type:"checkbox",title:"Adds additional checks to make sure code is run fast",defaultChecked:Zr.strictSelectors??!1,onChange:e=>Yme({strictSelectors:e.target.checked})}),"Strict selectors"]})]}))),Qme=_.memo((()=>{const e=h.useRef(null),[t,o]=h.useState(0),[a,i]=h.useState(!1),[s,n]=h.useState({}),[r,l]=h.useState("reports"),[d]=h.useState((()=>{const e="profiler-portal";let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,t.className=dme,document.body.appendChild(t),t)})),c=h.useRef(),u=h.useRef({left:.5,top:.5});h.useEffect((()=>{function t(){e.current&&(e.current.style.left=100*u.current.left+"%",e.current.style.top=100*u.current.top+"%")}t();let o=!1;function a(e){o=!(e.target instanceof HTMLElement&&!e.target.dataset.draggable),o&&(c.current={left:e.clientX,top:e.clientY},document.addEventListener("pointermove",i))}function i(e){if(!c.current)return;const o=(e.clientX-c.current.left)/window.innerWidth,a=(e.clientY-c.current.top)/window.innerHeight;c.current={left:e.clientX,top:e.clientY},u.current.left+=o,u.current.top+=a,t()}function s(){c.current=void 0,document.removeEventListener("pointermove",i)}return document.addEventListener("pointerdown",a,{passive:!0}),document.addEventListener("pointerup",s,{passive:!0}),()=>{document.removeEventListener("pointerdown",a),document.removeEventListener("pointermove",i),document.removeEventListener("pointerup",s)}}),[]);const m=Object.values(s).some((e=>e));return w.jsxs(w.Fragment,{children:[w.jsx("button",{type:"button",className:`${yme} ${m?vme:""}`,onClick:()=>i((e=>!e)),children:"🚀"}),_e.createPortal(w.jsxs("div",{ref:e,className:mt(cme,!a&&ume),"data-draggable":!0,children:[w.jsxs("div",{className:gme,"data-draggable":!0,children:[w.jsx("div",{className:_me,"data-draggable":!0,children:"Dev Dashboard"}),w.jsx("button",{type:"button",onClick:()=>o((e=>e+1)),children:"🚮"}),w.jsx("button",{type:"button",onClick:()=>i(!1),children:"🆇"})]}),w.jsxs("div",{className:mme,"data-draggable":!0,children:[w.jsx("button",{type:"button",onClick:()=>l("reports"),children:"Reports"}),w.jsx("button",{type:"button",onClick:()=>l("assets"),children:"Assets"}),w.jsx("button",{type:"button",onClick:()=>l("utils"),children:"Utils"})]}),w.jsx(Wme,{className:mt(pme,"reports"!==r&&hme),disabled:!a||"reports"!==r,clear:t,setWarningStates:n}),w.jsx(Kme,{className:mt(pme,"assets"!==r&&hme),disabled:!a||"assets"!==r,clear:t,setWarningStates:n}),w.jsx(Xme,{className:mt(pme,"utils"!==r&&hme),disabled:!a||"utils"!==r,clear:t,setWarningStates:n}),w.jsxs("div",{className:fme,children:["Warnings:"," ",Object.entries(s).filter((([e,t])=>t)).map((([e])=>`"${e}"`)).join(", ")]})]}),d)]})})),Zme=_.memo(h.memo((()=>lme()?w.jsx(Qme,{}):null)));async function epe(e){if(!e)return null;return(await Yr(`/api/v1/users/getUserById?id=${e}`)).user}const tpe="RequestToEditButton-module_overlayContainer_Pb8g5",ope="RequestToEditButton-module_leftCol_puP-8",ape="RequestToEditButton-module_rightCol_uCq4I",ipe="RequestToEditButton-module_picture_1eeJm",spe="RequestToEditButton-module_header_43brn",npe="RequestToEditButton-module_contentContainer_yTwnF",rpe="RequestToEditButton-module_content_OgC8z",lpe="RequestToEditButton-module_bold_nMgVa",dpe="RequestToEditButton-module_button_jfXug",cpe="RequestToEditButton-module_altButton_v9pX9",upe="RequestToEditButton-module_altDisabled_kZJhv",mpe=e=>{e&&"object"==typeof e&&"message"in e&&"No seats available"===(null==e?void 0:e.message)?hh({description:"No seats available. Please contact your team admin to add more seats."}):mh({description:"There was an issue joining the team, please try again",error:e})};var ppe=(e=>(e.LINK="Copied Link",e.EMAIL="Email Invite Link",e))(ppe||{}),hpe=(e=>(e.WORKSPACE_DROPDOWN="Workspace Dropdown",e.ONBOARDING_MODAL="Onboarding Modal",e.LINK="Copied Link",e.EMAIL="Email Invite Link",e.VIDEO="Video",e))(hpe||{});function gpe(){const e=il(),{currentUser:t,userTeamInvites:o}=tl((e=>{var t;return{currentUser:e.currentUser,userTeamInvites:null==(t=e.teams)?void 0:t.userTeamInvites}}),ol),[a,i]=h.useState(!1);return{acceptInvite:async function(a,s,n){const{user:r}=t||{},{email:l}=r||{},d=async o=>{try{await Op(),e(Ip(o.teamId)),e(ib(""));const a=await Fp(o.teamId,t);(async(e,t,o,a,i)=>{var s;const n=$s(o,t),{status:r,interval:l}=await gM(),d=su(i),c={"Team ID":i._id,"Team Owner Email":t,"Team Collaborator Email":e.email,"Owner And Collaborator Domain Match":n,"Entry Point":a,"Current Plan":d.type,"Subscription Status":r,"Monthly/Annual":l,"Number of Workspace Members":(null==(s=i.users)?void 0:s.length)||1};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Team Joined",c)})(r,o.inviterEmail,l,s,a)}catch(a){mpe(a),i(!1)}(null==n?void 0:n.withoutToast)||e(wl({description:"Invite accepted.",type:"success"})),(null==n?void 0:n.onSuccess)&&await(null==n?void 0:n.onSuccess()),i(!1)};i(!0);try{if("Copied Link"===s){const e=await(async e=>Jr("/api/v1/team-invite-links/accept",{body:{linkId:e}}))(a);e.teamId&&await d(e)}else{const t=await(async e=>Jr("/api/v1/invites/teams/accept",{body:{inviteKey:e}}))(a);t.teamId&&(o&&e(Ap([...o].filter((e=>e.inviteKey!==a)))),await d(t))}}catch(c){mpe(c),i(!1)}},acceptingInvite:a}}const fpe={maxWidth:550},ype=_.memo((({invite:e})=>{const{currentUser:t,currentVideo:o,videoId:a}=tl((e=>({currentUser:e.currentUser,currentVideo:e.currentVideo,videoId:e.studio._id})),ol),{acceptInvite:i}=gpe(),[s,n]=h.useState(),[r,l]=h.useState(!0),[d,c]=h.useState(),[u,m]=h.useState();h.useEffect((()=>{if(t.user)try{(async()=>{const e=await epe(o.creatorId);e&&n(e)})()}catch(IGe){console.error("Failed to fetch video creator",IGe),mh({description:"Failed to fetch video creator",error:IGe})}return()=>{n(void 0)}}),[o.creatorId,t.user]),h.useEffect((()=>((async()=>{if(o.workspaceId){const{name:e,teamId:t}=await sD(o.workspaceId);e&&c(e),t&&m(t)}})(),()=>{c(void 0)})),[o.workspaceId]);const p=(s&&s.firstName)??Sc(s),g=h.useCallback((()=>{l(!1)}),[]),f=h.useCallback((async()=>{u&&(l(!1),await i(e.inviteKey,hpe.VIDEO),a&&await GO(a))}),[i,e.inviteKey,u,a]);return w.jsxs(w.Fragment,{children:[u&&w.jsx("button",{type:"button",className:cpe,onClick:()=>{l(!0)},children:"Accept invite"}),r&&w.jsx(nM,{unsetCancelModal:g,usePortal:!0,noPadding:!0,noScrollBar:!0,style:fpe,children:w.jsxs("div",{className:tpe,children:[w.jsx("div",{className:ope,children:w.jsx(b9,{user:s,absoluteHeight:80,absoluteWidth:80,className:ipe})}),w.jsxs("div",{className:ape,children:[w.jsxs("div",{className:npe,children:[w.jsxs("div",{className:spe,children:["Accept your invite to"," ",p?`${p}'s team!`:w.jsx("span",{children:"the team!"})]}),w.jsxs("div",{className:rpe,children:[w.jsx("span",{children:p??"A Kapwing User"})," has invited you to join ",w.jsx("b",{children:d}),". If you accept their invite, you'll be able to edit, comment on, and share this project!"]})]}),w.jsx(Iie,{buttonText:"Accept invite",className:dpe,onClick:f})]})]})})]})})),vpe={maxWidth:550},_pe=_.memo((()=>{const{currentUser:e,currentVideo:t,showRequestEditModal:o}=tl((e=>({currentUser:e.currentUser,currentVideo:e.currentVideo,showRequestEditModal:e.sessionValues.showRequestEditModal})),ol),a=il(),i=ku(),[s,n]=h.useState(),[r,l]=h.useState(!1),[d,c]=h.useState(),[u,m]=h.useState(!1),[p,g]=h.useState([]),[f,y]=h.useState();h.useEffect((()=>{if(e.user)try{(async()=>{const e=await epe(t.creatorId);e&&n(e)})()}catch(IGe){console.error("Failed to fetch video creator",IGe)}return()=>{n(void 0)}}),[t.creatorId,e.user]),h.useEffect((()=>((async()=>{if(t.workspaceId){const{name:e,teamId:o}=await sD(t.workspaceId);e&&c(e),o&&y(o)}})(),()=>{c(void 0)})),[t.workspaceId]);const v=wc(e);h.useEffect((function(){return(async()=>{if(!v)return;const e=await nD();e&&g(e.map((e=>e.teamId)))})(),()=>{g([])}}),[v]),h.useEffect((function(){o&&(l(!0),a(ml(!1)))}),[o,a]);const _=f&&p.includes(f),b=(s&&s.firstName)??Sc(s),T=i?"Sent":"Request sent",x=i?"Edit":"Request to edit",S=h.useCallback((()=>m(!1)),[]),E=h.useCallback((()=>{a(ml(!0))}),[a]),I=h.useCallback((()=>{l(!1)}),[]),C=h.useCallback((()=>{f&&(oD(f,t._id),g((e=>[...e,f])),l(!1))}),[f,t._id]);return w.jsxs(w.Fragment,{children:[f&&w.jsx("button",{type:"button",className:`${cpe} ${_?upe:""}`,onClick:()=>{wc(e)?l(!0):m(!0),(async(e,t)=>{Fm(ym.REQUEST_TO_EDIT_BUTTON_CLICKED,{"Team ID":t,"Video ID":e})})(t._id,f)},children:_?w.jsx("span",{children:T}):w.jsx("span",{children:x})}),u&&w.jsx(bV,{hideSignIn:S,onSuccess:E,customTitle:"Sign in to request to edit this project",customImage:"https://cdn-useast1.kapwing.com/static/aJo-group_604.webp"}),r&&w.jsx(nM,{unsetCancelModal:I,usePortal:!0,noScrollBar:!0,noPadding:!0,style:vpe,children:w.jsxs("div",{className:tpe,children:[w.jsx("div",{className:ope,children:w.jsx(b9,{user:s,absoluteHeight:80,absoluteWidth:80,className:ipe})}),w.jsxs("div",{className:ape,children:[w.jsxs("div",{className:npe,children:[w.jsxs("div",{className:spe,children:["Collaborate with ",b," in Kapwing!"]}),w.jsxs("div",{className:rpe,children:["Request edit access to"," ",b?`${b}'s`:w.jsx("span",{children:"this"})," project. If approved, you will also be added to"," ",b?`${b}'s`:w.jsx("span",{children:"the"})," team"," ",w.jsx("span",{className:lpe,children:d}),"."]})]}),w.jsx(Iie,{buttonText:"Request edit access",className:dpe,onClick:C})]})]})})]})})),wpe="ProjectName-module_projectNameContainer_FJ0U0",bpe="ProjectName-module_hiddenSpan_zvycS";class Tpe extends h.Component{constructor(e){super(e),i(this,"inputRef",null),i(this,"spanRef",null),i(this,"fetchProjectName",(async e=>{const t=await async function(e){return(await Yr(`/api/v1/projectname/${e}`)).projectName}(e),{dispatch:o}=sr();o(SK(t)),this.setState({projectName:t})})),i(this,"projectNameOnChange",(e=>{this.setState({projectName:e.target.value})})),i(this,"projectNameOnSubmit",(()=>{const{setProjectName:e,updateProjectName:t,projectId:o,currentUser:a}=this.props,{projectName:i}=this.state;null!=i&&(e(i),o&&t({projectId:o,name:i})),o&&TK(o,{name:i},a)})),i(this,"getDefaultName",(()=>{const e=this.state.editorPath;return this.props.isBrandKitTemplate?"Untitled Template":zU[e]||An})),i(this,"onEnterPressed",(e=>{var t;"Enter"===e.code&&!1===e.shiftKey&&(e.preventDefault(),null==(t=this.inputRef)||t.blur())})),this.state={editorPath:"",projectName:"",width:0}}componentDidMount(){var e;const{projectName:t}=this.props;this.setState({projectName:t,width:(null==(e=this.spanRef)?void 0:e.offsetWidth)||0}),this.props.projectId&&this.fetchProjectName(this.props.projectId)}componentDidUpdate(e,t){var o;const{projectName:a,projectId:i,currentUser:s}=this.props;this.state.projectName!==t.projectName&&this.setState({width:(null==(o=this.spanRef)?void 0:o.offsetWidth)||0}),a!==e.projectName&&(this.setState({projectName:a}),""===a&&i&&TK(i,{name:a},s)),i!==e.projectId&&i&&this.fetchProjectName(i)}render(){const{projectName:e,width:t}=this.state,o=e||this.getDefaultName(),a=`${o} — Kapwing`;return w.jsxs(w.Fragment,{children:[w.jsx(Mt,{children:w.jsx("title",{children:a})}),w.jsx("span",{className:bpe,ref:e=>{this.spanRef=e},children:o}),w.jsx("input",{ref:e=>{this.inputRef=e},disabled:this.props.disabled,className:wpe,style:{width:t},"data-cy":"studio-project-name-field",onChange:this.projectNameOnChange,onBlur:this.projectNameOnSubmit,onKeyDown:this.onEnterPressed,placeholder:this.getDefaultName(),value:e})]})}}const xpe=g.connect((e=>({projectName:e.projectName,projectId:e.studio.projectId,currentUser:e.currentUser,isBrandKitTemplate:e.studio.isBrandKitTemplate,editorPath:e.editorPath})),(e=>ye({setProjectName:SK,updateProjectName:hO},e)))(Tpe),Spe=async e=>{const{state:t,dispatch:o}=sr(),{currentUser:a}=t;if(!wc(a))return;o(Vf(e));const i=await Yr(`/api/v2/snapshots/${e}/exports?fetchRunningExports`);t.exports.runningExports.length>i.length&&await Epe(e),o(Wf({snapshots:i,finishPendingExport:t.exports.runningExports.length!==i.length}))},Epe=async(e,t)=>{const{dispatch:o,state:a}=sr(),{currentUser:i}=a;if(!wc(i))return;o(Hf());const s=await Yr(`/api/v2/snapshots/${e}/exportHistory?fetchSnapshots`);o(Gf({snapshots:s,finishPendingExport:t}))},Ipe=(e,t)=>!e||t,Cpe=async(e,t="",o=!1)=>{const{dispatch:a,state:i}=sr(),{studio:s,currentUser:n,videoSaving:r,projectName:l}=i,{_id:d,projectId:c,scenes:u,videoType:m,duration:p}=s,{pathname:h}=window.location,g=()=>window.location.pathname!==h;if("gif"===(t||m)&&p>60)return a(wl({description:"Max GIF duration is 60 seconds. Please trim your video or switch output to mp4.",type:"error"})),{success:!1};if(((e,t,o)=>e&&!t||!e&&o)(d,e,r))return a(wl({description:"Saving your work - please wait a second and try again.",type:"error"})),{success:!1};if(!(e=>{for(const t of e)for(const e of t.layers){if("begun"===e.videoConvertedState)return console.error("Layer still converting:",e),eE("/studio/editor/conversion-warning"),!1;if("image/webp"===e.mime&&"unknown"===e.webpType)return console.error("Layer still processing image:",e),eE("/studio/editor/image-processing-warning"),!1}return!0})(u))return a(wl({description:"A layer is still converting. Please try again later.",type:"error"})),{success:!1};o||a(Sb(-1)),m!==Kn.MP3||t||a(bb(Kn.MP4));const f=Hie(i,p,"videoState",o,n);let y,v,_=!1,w={};const b=Date.now(),T="Failed to client side process video";a($f({name:i.projectName,clientSide:f}));try{if(f)try{const e=await $ie(n,i,p,o,"videoState");if(g())return d&&await aie(d,{done:!0,draft:!1}),a(Kf()),{success:!0,processOnClient:f};if((!e.processed||!e.newUrl)&&s.duration>0)throw Error(T);_=e.processed,y=e.read_uri,v=e.ffmpegData,w=e.buildInfo}catch(IGe){throw Error(T)}c&&n&&l&&await TK(c,{name:l},n),await(async()=>{const{state:e,dispatch:t}=sr(),o=TA(e);if(o.length<0)return;const a=async o=>{if(!tj({assetId:o,filterEmpty:!0,filterInvalid:!0,canvasHeight:e.studio.height,canvasWidth:e.studio.width,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY,fontSizeOverride:null})(e).length)return;const{preset:a,style:i,wordByWordAnimations:s,transitionId:n,transitionDuration:r,transitionOverlapDuration:l,transitionSpeed:d}=IA(o)(e),c=a||_U(i,s,n?{transitionId:n,transitionDuration:r,transitionOverlapDuration:l,transitionSpeed:d}:void 0,`preset-${P()}`,e.projectName);!c.projectId&&e.studio.projectId&&(c.projectId=e.studio.projectId),t(bC({updates:{preset:c},undoable:!1})),(null==c?void 0:c.teamId)&&await dU({...c,sortNdx:0}),t(Ff({preset:c}))};try{await Promise.all(o.map(a))}catch(IGe){console.error(IGe)}})(),function(){const{state:e}=sr(),{allLayers:t}=e.studio,o=Object.values(t.byId).filter((e=>e&&e.type===zl.Text&&!e.fromTextDefaults));0!==o.length&&xZ(o)}();const e=t||o?"studio-publish-dropdown":"studio-publish",r=await Zae({currentUser:n,publish:!0,auto:!1,createLocation:e,processedOnClient:_});if(g())return await aie(r._id,{done:!0,draft:!1}),a(Kf()),{success:!0,processOnClient:f};if(_){const[e,t]=O$(y);a(yD({local_url:y,fullPath:y,image_url:y,blob_name:t,thumbnail_blob_name:t})),await aie(r._id,{done:!0,draft:!1}),Epe(r._id,!0);const o=r.scenes[0].layers.some((e=>"video"===e.type));window.Cypress&&o?await aie(r._id,{done:!0,draft:!1}):((e,t,o,a,i)=>{const s=wc(e)?e.user._id:null,n=Date.now();let r=0,l=0;t.scenes.forEach((e=>{r+=e.layers.length,l+=e.duration}));const d={...i,buildDuration:(n-o)/1e3,layerDuration:l,layerCount:r,outputDuration:t.duration??null,sceneCount:t.scenes.length};a&&(d.ffmpegData=a),aie(t._id,{build:d}),"mp4"===t.videoType&&Fm(ym.VIDEO_PROCCESSED,{clientSideProcessed:!0,creatorId:s,isStudio:!0})})(n,r,b,v,w)}return f&&await aie(r._id,{processedOnClient:_}),{success:!0,processOnClient:f}}catch(x){if(!x||"object"!=typeof x)return mh({description:"Failed to export",error:x}),{success:!1};if("statusCode"in x&&425===x.statusCode)return eE("/studio/editor/upload-warning"),{success:!1};const{message:e}=ph(x);return e===T&&d?(console.error(T),await kpe(d,"Error"),{success:!1}):(mh({description:"Failed to export",error:x}),{success:!1})}},kpe=async(e,t)=>{const{state:o}=sr(),{currentUser:a}=o;await Zae({currentUser:a,publish:!0,auto:!1,createLocation:"studio-publish",processedOnClient:!1}),await aie(e,{pendingProcessOnClient:!1,clientSideProcessingInProgress:!1}),Fm(ym.CREATE_FAILED_CLIENT_SIDE_VIDEO,{videoId:e,Reason:t})},Ape="PublishContainer-module_disabled_IPIcO",jpe="PublishContainer-module_createButton_RiHLs",Npe="PublishContainer-module_createButtonDisabled_llU9O",Rpe="PublishContainer-module_createButtonWarning_mGShM",Ppe="PublishContainer-module_buttonContainer_HL-ly",Dpe="PublishContainer-module_exportIcon_lDu4V",Ope="PublishContainer-module_shortButtonName_1dDzb",Lpe="PublishContainer-module_longButtonName_u55DI",Fpe="PublishContainer-module_displayNone_KPyJE",Mpe="PublishOverlay-module_blueButton_G-bG6",Upe="PublishOverlay-module_exportAnywayButton_6a9CT",Bpe="PublishOverlay-module_greenButton_qvdKy",Vpe="PublishOverlay-module_header_1ABTD",Wpe="PublishOverlay-module_primaryImage_2RGo1",Gpe="PublishOverlay-module_description_xSsYO",Hpe="PublishOverlay-module_descriptionGray_MncCf",$pe="PublishOverlay-module_descriptionScrollBox_9XkTn",Kpe="PublishOverlay-module_buttonContainer_evD-N",zpe=_.memo((e=>{const{onClose:t,onContinue:o,overlappingSubtitle:a}=e,i=il();return w.jsxs(XV,{onClose:t,children:[w.jsx("div",{className:Vpe,children:"Heads up! Overlapping Subtitles"}),w.jsx("div",{className:Gpe,children:"Your project has overlapping subtitles. This is likely unintentional. Please consider addressing this before exporting your project."}),w.jsxs("div",{className:Kpe,children:[w.jsx("div",{className:Bpe,onClick:()=>o(),children:"Export anyway"}),w.jsx("div",{className:Mpe,onClick:e=>{i(YD({tabId:Gg.subtitles,tabContainerId:"media-sidebar"}));const{layer:o}=a,{start:s}=o.frame;TE(s+.01),t(),e.stopPropagation()},children:"Fix overlapping subtitles"})]})]})})),Ype=()=>{const{state:e}=sr(),{layers:t}=e.studio.scenes[0],{studio:{selectedTimelineRows:o}}=e,a=o[0],i=[...Qpe(a,t),...Zpe(a,t)],s={};i.forEach((e=>{s[e.id]={timelineRow:e.timelineRow+1}})),OI(s,"timeline.ts",!0)},Jpe=()=>eE("/studio/editor/delete-row"),qpe=()=>{const{state:e,dispatch:t}=sr(),{layers:o}=e.studio.scenes[0],{studio:{selectedTimelineRows:a}}=e;let i=[];for(let c=0;c<a.length;c+=1){const e=a[c],t=Qpe(e,o);i=[...i,...t]}const s=a.sort(((e,t)=>e-t)),n=s[0],r=s[s.length-1],l=[...ehe(n,r,a,o),...Zpe(r,o)],d={};for(let c=n,u=0;c<=r;c+=1)c===s[u]&&(u+=1),d[c]=u;ff.withUndoBatch((()=>{g.batch((()=>{const e=i.map((e=>e.id));Az({layerIds:e});const t={};l.forEach((e=>{const{timelineRow:o=0}=e,a=o>r?d[r]:d[o];t[e.id]={timelineRow:o-a}})),OI(t,"timeline.ts",!0)}))}))(),t(i_([]))},Xpe=(e,t)=>{const{state:o}=sr(),{layers:a}=o.studio.scenes[0];let i,s,n;[i,s,n]=e<t?[e,t,-1]:[t,e,1];const r=Qpe(e,a);let l=[];for(let c=i;c<=s;c+=1)c!==e&&(l=[...l,...Qpe(c,a)]);const d={};r.forEach((e=>{d[e.id]={timelineRow:t}})),l.forEach((e=>{d[e.id]={timelineRow:e.timelineRow+n}})),OI(d,"timeline.ts",!0)},Qpe=(e,t)=>{const o=[];return t.every((t=>void 0===t.timelineRow||t.timelineRow!==e||(o.push(t),!0))),o},Zpe=(e,t)=>{const o=[];return t.every((t=>!(void 0!==t.timelineRow&&t.timelineRow>e)||(o.push(t),!0))),o},ehe=(e,t,o,a)=>a.filter((({timelineRow:a})=>void 0!==a&&e<a&&a<t&&!o.includes(a))),the=e=>{const{layers:t}=e.studio.scenes[0],{duration:o}=e.studio;if(0===o)return[];const a=[...t];a.sort(((e,t)=>TS(e,0)[0]-TS(t,0)[0]));const i=[{startTime:0,endTime:0}];if(a.forEach((e=>{const[t,o]=TS(e,0),a=i[i.length-1];t-.01<=a.endTime?i[i.length-1].endTime=Math.max(o,a.endTime):i.push({startTime:t,endTime:o})})),1===i.length)return[];const s=[];return i.forEach(((e,t)=>{const o=i[t+1];t!==i.length-1&&s.push({startTime:e.endTime,endTime:o.startTime})})),s};function ohe(){const{dispatch:e,state:t}=sr(),o=zN(t),{timelineContainerWidth:a}=t.timeline,i=a/(1.1*o);e(PL.setUseCSSTransitions(!0)),a>0&&e(sc(i)),e(PL.setScrollTimelineToStart(!0))}const ahe=_.memo((e=>{const{onClose:t,onExportAnyway:o}=e,{gapsInTimeline:a}=tl((e=>({gapsInTimeline:the(e)})),ol),i=il();return w.jsxs(XV,{onClose:t,children:[w.jsx("div",{className:Vpe,children:"Empty Frames Detected In Your Video"}),w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/dFU-gapsInTimeline.png",className:Wpe,alt:"Gaps in timeline"}),w.jsx("div",{className:Hpe,children:"We found gaps in your project! Did you mean for this to happen? Add media or adjust your timing to avoid empty space in your final project."}),w.jsxs("div",{className:Hpe,children:[w.jsx("div",{children:w.jsx("b",{children:"Empty frames detected in your project"})}),w.jsx("div",{className:$pe,children:a.map(((e,t)=>w.jsx("div",{children:`${cr(e.startTime)} -- ${cr(e.endTime)}`},t)))})]}),w.jsxs("div",{className:Kpe,children:[w.jsx("div",{className:Upe,onClick:()=>{t(),o()},children:"Export anyway"}),w.jsx("div",{className:Mpe,onClick:()=>{eE("/studio/editor"),i(hl(!1));const e=a[0];e&&aR(e.startTime),i(v_(!0)),t()},children:"Check the timeline"})]})]})})),ihe=e=>Math.round(1e3*e)/1e3;function she(e,t){for(let o=0;o<e.length-1;o+=1){const a=e[o],i=e[o+1];if((!(null==a?void 0:a.frame)||!(null==i?void 0:i.frame)||a.frame.id!==i.frame.id)&&(a&&ihe(a.endTime)-t>ihe(i.startTime)))return a}}const nhe=m((e=>e.studio.allLayers.byId),(e=>Object.values(e).filter((e=>e.preemptiveDownloadError)))),rhe=()=>{var e,t,o,a,i,s,n;const r=tl(nhe),l=tl((e=>HB(e))),{byId:d}=tl((e=>e.assets)),c=tl((e=>e.studio.scenes),ol),u=NU(Bl.REMOVE_BACKGROUND),m=!u&&(null==(e=c[0])?void 0:e.layers.some((e=>{var t;return e.backgroundRemoved||e.asset_id&&"remove-background"===(null==(t=d[e.asset_id])?void 0:t.usedProFeature)}))),p=!u&&(null==(t=c[0])?void 0:t.layers.some((e=>{var t;return null==(t=e.usedProFeatures)?void 0:t.includes("remove-video-background")}))),h=!NU(Bl.CLEAN_AUDIO)&&(null==(o=c[0])?void 0:o.layers.some((e=>{var t;return e.asset_id&&"clean-audio"===(null==(t=d[e.asset_id])?void 0:t.usedProFeature)}))),g=NU(Bl.SMART_CUT),f=!g&&(null==(a=c[0])?void 0:a.layers.some((e=>{var t;return(null==(t=e.usedProFeatures)?void 0:t.includes("smart-cut"))&&e.type===zl.Video}))),y=!g&&(null==(i=c[0])?void 0:i.layers.some((e=>{var t;return(null==(t=e.usedProFeatures)?void 0:t.includes("smart-cut"))&&e.type===zl.Audio}))),v=!NU(Bl.AUDIOGRAM)&&(null==(s=c[0])?void 0:s.layers.some((e=>{var t;return null==(t=e.usedProFeatures)?void 0:t.includes("audiogram")}))),_=NU(Bl.UNLIMITED_EXPORT_DURATION_LIMIT),w=tl((e=>e.studio.duration>240)),b=!_&&w,T=NU(Bl.UNLIMITED_UPLOAD_SIZE_LIMIT),x=tl((e=>!T&&yK(e))),S=!NU(Bl.PREMIUM_ASSETS)&&(null==(n=c[0])?void 0:n.layers.some((e=>{var t;return null==(t=e.usedProFeatures)?void 0:t.includes("premium-assets")})));let E;m?E=Vl.BACKGROUND_IMAGE_ERASE:x?E=Vl.UPLOAD_LIMIT:b?E=Vl.SINGLE_VIDEO_DURATION_LIMIT:h?E=Vl.CLEAN_AUDIO:f?E=Vl.SMART_CUT_VIDEO:y?E=Vl.SMART_CUT_AUDIO:p?E=Vl.REMOVE_VIDEO_BACKGROUND:v?E=Vl.AUDIOGRAM_BAR:S?E=Vl.PREMIUM_ASSETS:gK()?E=Vl.SINGLE_VIDEO_DURATION_LIMIT:fK()&&(E=Vl.DEFAULT);const I=(()=>{const e=TA(sr().state);for(const t of e){const e=JA({assetId:t,filterEmpty:!0,filterInvalid:!0})(sr().state);e.sort(((e,t)=>e.startTime-t.startTime));const o=she(e,0);if(o)return o}})();let C;return I&&(C={layer:I}),{exportBlockedAction:E,overlappingSubtitle:C,pendingUploads:l,layersFailedToDownload:r}},lhe="StudioPopover-module_content_VosDv",dhe="StudioPopover-module_small_y8vPz",che="StudioPopover-module_header_xCWJS",uhe="StudioPopover-module_description_JU2d4",mhe="StudioPopover-module_iconWrapper_4IKBK",phe="StudioPopover-module_trigger_QpSk9",hhe="StudioPopover-module_rainbowBorder_KO9Pq",ghe="StudioPopover-module_arrow_V4PNZ",fhe=_.memo((({children:e,content:t,header:o,onClose:a=(()=>{}),open:i=!1,side:s="right",align:n="center",alignOffset:r=0,sideOffset:l=0,withRainbowBorder:d=!0,rainbowBorderOptions:c={borderRadius:5,borderWidth:2},size:u="large"})=>{const{borderRadius:m,borderWidth:p}=c;return i?w.jsxs(Ro,{open:i,children:[w.jsx(Po,{asChild:!0,children:w.jsxs("div",{className:phe,children:[w.jsx("div",{children:e}),d&&w.jsx("div",{className:hhe,style:{borderRadius:`${m}px`,margin:`-${p}px`,borderWidth:`${p}px`}})]})}),w.jsx(No,{container:sM(),children:w.jsxs(Do,{side:s,align:n,className:mt(lhe,{[dhe]:"small"===u}),collisionPadding:16,alignOffset:r,sideOffset:l,hideWhenDetached:!0,children:[w.jsx("div",{className:che,children:o}),w.jsx("div",{className:uhe,children:t}),w.jsx("button",{className:mhe,onClick:()=>a(),"data-testid":"studio-popover-close",children:w.jsx(ve,{size:"small"===u?18:24})}),w.jsx(Lo,{className:ghe,width:12,height:12})]})})]}):w.jsx(w.Fragment,{children:e})})),yhe={popoverContent:"StudioTour-module_popoverContent_x7y4u",actions:"StudioTour-module_actions_qyy-q",studioTourButtons:"StudioTour-module_studioTourButtons_m4--L",dots:"StudioTour-module_dots_4u1-w",dot:"StudioTour-module_dot_TWQd2",selected:"StudioTour-module_selected_08kod",hidden:"StudioTour-module_hidden_Xgc6I",back:"StudioTour-module_back_hJxxs",defer:"StudioTour-module_defer_LCvuV",confirm:"StudioTour-module_confirm_y6AYj",next:"StudioTour-module_next_QbBnf"};function vhe(){const{isFirstStep:e,isLastStep:t,steps:o,currentStep:a,tour:i}=wue(),s=()=>{const e=yL[i][a];e&&ez(e)};return w.jsxs("div",{className:yhe.studioTourButtons,children:[w.jsx("button",{className:`${yhe.back} ${e&&yhe.hidden}`,onClick:tz,"data-testid":"studio-tour-back-button",children:"Back"}),w.jsx("div",{className:yhe.dots,"data-testid":"studio-tour-dots",children:o.map(((e,t)=>w.jsx("div",{className:`${yhe.dot} ${a===t&&yhe.selected}`,onClick:()=>(e=>{const{dispatch:t}=sr();t(wL(e))})(t)},t)))}),w.jsx("button",{className:yhe.next,onClick:s,"data-testid":"studio-tour-next-button",children:t?"Done":"Next"})]})}const _he=_.memo((()=>(h.useEffect((function(){Fm(ym.STUDIO_TOUR_EXPORT)}),[]),w.jsxs("div",{className:yhe.popoverContent,"data-testid":"export-popover",children:[w.jsx("p",{children:'Click on the "Export Project" button at the top of the editor to export and download your project.'}),w.jsx(vhe,{})]})))),whe={header:"Export",content:w.jsx(_he,{})},bhe={gifMaker:["video"],youtubeThumbnail:["video"]},The=_.memo((({submitting:e,handleClick:t,exportBlocked:o,isBrandKitTemplate:a,exportBlockedOnDurationPro:i,shrinkCreateButton:s})=>{const{exportBlockedAction:n}=rhe(),r=tl((e=>e.userPermissions.canWrite)),l=tl((e=>{var t;return"exportPanel"===(null==(t=e.projectSessionSettings.overlay)?void 0:t.key)})),{isOpen:d}=wue(gL.EXPORT),{buttonName:c,buttonIcon:u,shortButtonName:m}=((e,t,o,a)=>{let i=w.jsx(Bo,{className:Dpe}),s="Export Project";return e&&(s="published"===e?"Published to Workspace":"Publish to Workspace"),"published"===e&&(s="Published to Workspace"),t&&(i=null,s=e?"Publish":"Export"),o&&!a&&(i=w.jsx(EW,{})),{buttonName:s,shortButtonName:e?"Publish":"Export",buttonIcon:i}})(a,s,o,i);if(e)return w.jsx("div",{className:`${jpe} ${Npe}`,"data-cy":"loading-create-button",children:"Loading..."});const p=()=>w.jsx(bue,{tooltips:bhe,children:w.jsxs("div",{className:`${jpe}\n          ${n||o&&!i?Rpe:""}\n          ${l||!r?Ape:""}\n          ${i?Npe:""}\n          ${a?Fpe:""}`,"data-cy":"create-button",onClick:e=>{e.stopPropagation(),ez(gL.EXPORT),t()},children:[w.jsx("span",{className:Lpe,children:c}),w.jsx("span",{className:Ope,children:m}),u]})});return d?w.jsx(fhe,{...whe,side:"bottom",align:"center",open:d,onClose:YK,children:p()}):p()})),xhe=(e,t,o=!0)=>{const a=(()=>{const[e,t]=h.useState(!document.hidden);return h.useEffect((()=>{const e=()=>t(!document.hidden);return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)}),[]),e})(),i=h.useRef(),s=cE(e);h.useEffect((function(){const e=setInterval(a?s:()=>null,t);return i.current=e,()=>clearInterval(e)}),[s,t,a]),h.useEffect((function(){o&&a&&s()}),[o,a,s])},She=[5,11,17,23,30,40,50,66,85,100,125,155,178,200,250],Ehe=[30,30,30,5,5],Ihe=15,Che=({createdAt:e,progressDict:t})=>{if(!t)return 15;const{stageNum:o,numStages:a,stagePercentage:i}=t;if(a!==Ehe.length)return 15;const s=Ehe[o-1];if(!s)return 15;const n=i*(s/100),r=Ehe.slice(0,o-1).reduce(((e,t)=>e+t),0),l=Math.round(isNaN(r+n)?0:r+n);if(l>=She.length)return Math.round(l);const d=((new Date).getTime()-new Date(e).getTime())/1e3;let c=15;for(let u=15;u<She.length+15;u++){const e=She[u-15];if(!e)return Math.max(15,l);if(!(d>=e))break;c+=1}return Math.max(l,c,15)},khe="ExportProgressButton-module_buttonWrapper_Lenyy",Ahe="ExportProgressButton-module_innerButtonWrapper_CVZWC",jhe="ExportProgressButton-module_progressNum_g7F6x",Nhe="ExportProgressButton-module_progressPercent_7B7X5",Rhe="ExportProgressButton-module_icon_aejxg",Phe=_.memo((()=>{const{progress:e,isDisabled:t,pendingExport:o,runningExportsLength:a}=(()=>{const e=il(),t=tl((e=>e.currentUser.user.muteExportCompleteNotificationSound)),o=tl((e=>e.studio._id)),a=tl((e=>e.userPermissions.canWrite)),i=tl((e=>e.exports.pendingExport)),s=tl((e=>{var t;return"exportPanel"===(null==(t=e.projectSessionSettings.overlay)?void 0:t.key)})),{runningExportsLength:n,exportProgress:r}=tl((e=>{const t=e.exports.runningExports.filter((e=>e.videoId===o));if(t.length>0){const e=[...t].sort(((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()))[0];if(e)return{runningExportsLength:t.length,exportProgress:Che({progressDict:e.progressDict,createdAt:e.createdAt})}}return{runningExportsLength:t.length,exportProgress:0}}),ol),[l,d]=h.useState(n),[c,u]=h.useState(r),[m,p]=h.useState(l);h.useEffect((function(){return e(Xf()),o&&Spe(o),()=>{e(Xf())}}),[e,o]),h.useEffect((()=>{u(r)}),[r]),h.useEffect((()=>{d(n)}),[n]),h.useEffect((()=>{l<m&&(u(101),setTimeout((()=>u(0)),1e4),o&&Epe(o),!t)&&new Audio("/export-notification-chime.mp3").play(),p(l)}),[l,o,e,m,t]);const g=h.useCallback((()=>{o&&(n||i)&&Spe(o)}),[o,n,i]);return xhe(g,6e3,!0),xhe((()=>{o&&Spe(o)}),6e4),{progress:c,isDisabled:s||!a,pendingExport:i,runningExportsLength:n}})(),i=h.useCallback((()=>{kj(Iv.HISTORY)}),[]);return w.jsx("div",{className:khe,children:w.jsx(Die,{progress:e,noPadding:!0,onClick:i,overrideColor:RF.Studio,disabled:t,children:w.jsx("div",{className:Ahe,children:e||o||a?e>=100?w.jsx(Wo,{className:Rhe}):a||!(e<=0)&&e?w.jsxs("span",{className:jhe,children:[e,w.jsx("span",{className:Nhe,children:"%"})]}):w.jsx(eme,{}):w.jsx(Vo,{className:Rhe})})})})})),Dhe=m((e=>e.studio.videoType),(e=>e.studio.duration),(e=>e.studio.scenes),((e,t,o)=>{const a=e.toLowerCase();let i="";return t?i="gif"===a?"GIF":"Video":"gif"===a?i="GIF":(e=>{for(const t of e)for(const e of t.layers)if("video"===e.type&&!e.converted_gif)return!0;return!1})(o)||(i="Image"),i}));let Ohe=[];const Lhe={convert:["mobile"]},Fhe={convert:["mobile","video","audio"],compressVideo:["video"]},Mhe=kt((e=>({layer:e})));class Uhe extends h.Component{constructor(e){super(e),i(this,"_mounted",!1),i(this,"validationStageModals",[{stage:"gapInTimeline",render:()=>w.jsx(ahe,{onClose:this.bailOnExportValidation,onExportAnyway:this.advanceToNextValidationStage})},{stage:"magicOverlap",render:()=>w.jsx(zpe,{onClose:this.handleOverlappingSubtitlesClose,onContinue:this.advanceToNextValidationStage,overlappingSubtitle:Mhe(this.state.overlappingMagicSubtitle)})}]),i(this,"setSubmitting",(e=>{this.setState({submitting:e})})),i(this,"handleClick",(()=>{const{overlayWithHeader:e,exportBlocked:t,exportBlockedAction:o,exportBlockedOnDurationPro:a,canWrite:i,dispatch:s,allExportBlockingActions:n}=this.props;if(i){if(!a)return t?(Fm(ym.PAYWALLED_EXPORT_CLICKED,{"Limit Source":$m(o)}),void TW((()=>{}),{action:o,extraAmplitudeEventProperties:{"All Blocking Actions":n}})()):void(gK()?eE("/studio/editor/warning"):fK()?eE("Scenes"===e?"/studio/editor/scenes/upgrade":"/studio/editor/upgrade"):this.advanceValidationStage(0));s(fS("proUserDurationLimit"))}})),i(this,"handleExport",(async(e="")=>{const{videoFetched:t}=this.props;try{this.setSubmitting(!0),await Cpe(t,e)}catch(o){console.error(o)}finally{this._mounted&&this.setSubmitting(!1)}})),i(this,"nextStage",(()=>(this.state.exportStageNdx??0)+1)),i(this,"advanceToNextValidationStage",(()=>{this.advanceValidationStage(this.nextStage())})),i(this,"handleOverlappingSubtitlesClose",(()=>{this.bailOnExportValidation(),sr().dispatch(l_({type:"magicSubtitle",frames:[]})),eE("/studio/editor/subtitles")})),i(this,"advanceValidationStage",(e=>{var t;if(null===e)return void this.advanceValidationStage(0);const o=null==(t=this.validationStageModals[e])?void 0:t.stage;if(!o)return this.setState({exportStageNdx:null}),void kj();switch(o){case"gapInTimeline":if(the(sr().state).length>0)return void this.setState({exportStageNdx:e});break}this.advanceValidationStage(e+1)})),i(this,"bailOnExportValidation",(()=>{this.setState({exportStageNdx:null,overlappingMagicSubtitle:void 0})})),this.state={exportStageNdx:null}}componentDidMount(){const{signedOut:e,location:t,canWrite:o}=this.props;o&&(this.showTooltipIfPremiumAssetsUsed(),this.showTooltipIfFreeLimitExceeded(),this.showTooltipIfProLimitExceeded(),this.showTooltipIfCleanAudioUsed(),this.showTooltipIfSmartCutUsed(),this.showTooltipIfRemoveVideoBackgroundUsed(),this.showTooltipIfAudiogramUsed());const a=new URLSearchParams(t.search);e||("true"===a.get(Rie.EXPORT_VIDEO)?this.handleExport():"true"===a.get(Rie.OPEN_EXPORT_PANEL)&&kj(Iv.SETTINGS)),this._mounted=!0}componentDidUpdate(e){const{dispatch:t,exportBlocked:o,canWrite:a}=this.props;e.exportBlocked&&!o&&al((()=>{t(Ib("premiumAssetsUsed",!1)),t(Ib("freeUserFileSizeLimitWarned",!1)),t(Ib("freeUserDurationLimitWarned",!1)),t(Ib("cleanAudioUsed",!1)),t(Ib("smartCutUsed",!1)),t(Ib("removeVideoBackgroundUsed",!1)),t(Ib("audiogramUsed",!1)),t(Ib("enhancedImageUsed",!1))})),a&&(this.showTooltipIfPremiumAssetsUsed(),this.showTooltipIfFreeLimitExceeded(),this.showTooltipIfProLimitExceeded(),this.showTooltipIfCleanAudioUsed(),this.showTooltipIfSmartCutUsed(),this.showTooltipIfRemoveVideoBackgroundUsed(),this.showTooltipIfAudiogramUsed(),this.showTooltipIfEnhancedImageUsed())}componentWillUnmount(){this._mounted=!1}showTooltipIfFreeLimitExceeded(){const{dispatch:e,exportBlocked:t,exportBlockedOnDuration:o,exportBlockedOnFilesize:a,freeUserDurationLimitWarned:i,freeUserFileSizeLimitWarned:s,isProjectFetched:n,showingTooltip:r}=this.props;n&&(o&&!i?(e(fS("freeUserDurationLimit")),e(Ib("freeUserDurationLimitWarned",!0))):a&&!s?(e(fS("freeUserSizeLimit")),e(Ib("freeUserFileSizeLimitWarned",!0))):t||"freeUserDurationLimit"!==r&&"freeUserSizeLimit"!==r||e(fS("")))}showTooltipIfProLimitExceeded(){const{dispatch:e,exportBlockedOnDurationPro:t,showingTooltip:o,proUserDurationLimitWarned:a}=this.props;t&&!a?(e(fS("proUserDurationLimit")),e(Ib("proUserDurationLimitWarned",!0))):t||"proUserDurationLimit"!==o||e(fS(""))}showTooltipIfCleanAudioUsed(){const{dispatch:e,exportBlockedOnCleanAudio:t,cleanAudioFeatureUsedWarned:o,showingTooltip:a}=this.props;t&&!o?(e(fS("cleanAudioUsed")),e(Ib("cleanAudioUsed",!0))):t||"cleanAudioUsed"!==a||e(fS(""))}showTooltipIfSmartCutUsed(){const{dispatch:e,exportBlockedOnSmartCutAudio:t,exportBlockedOnSmartCutVideo:o,smartCutFeatureUsedWarned:a,showingTooltip:i}=this.props,s=t||o;if(s&&!a){e(fS(o?"videoSmartCutUsed":"audioSmartCutUsed")),e(Ib("smartCutUsed",!0))}else s||"videoSmartCutUsed"!==i&&"audioSmartCutUsed"!==i||e(fS(""))}showTooltipIfRemoveVideoBackgroundUsed(){const{dispatch:e,exportBlockedOnRemoveVideoBackground:t,removeVideoBackgroundUsedWarned:o,showingTooltip:a}=this.props;t&&!o?(e(fS("removeVideoBackgroundUsed")),e(Ib("removeVideoBackgroundUsed",!0))):t||"removeVideoBackgroundUsed"!==a||e(fS(""))}showTooltipIfAudiogramUsed(){const{dispatch:e,exportBlockedOnAudiogram:t,audiogramUsedWarned:o,showingTooltip:a}=this.props;t&&!o?(e(fS("audiogramUsed")),e(Ib("audiogramUsed",!0))):t||"audiogramUsed"!==a||e(fS(""))}showTooltipIfEnhancedImageUsed(){const{dispatch:e,exportBlockedOnEnhanceImage:t,showingTooltip:o,enhanceImageUsedWarned:a}=this.props;t&&!a?(e(fS("enhancedImageUsed")),e(Ib("enhancedImageUsed",!0))):t||"enhancedImage"!==o||e(fS(""))}showTooltipIfPremiumAssetsUsed(){const{dispatch:e,exportBlockedAction:t,premiumAssetsUsedWarned:o,showingTooltip:a}=this.props,i=t===Vl.PREMIUM_ASSETS;i&&!o?(e(fS("premiumAssetsUsed")),e(Ib("premiumAssetsUsed",!0))):i||"premiumAssetsUsed"!==a||e(fS(""))}render(){const{disabled:e,shrinkCreateButton:t,isBrandKitTemplate:o,exportBlocked:a,canWrite:i}=this.props,{exportStageNdx:s}=this.state;if(!i)return null;const n=o?"Publish":"Export",r=o?"Publish to Workspace":"Export Project";if(e)return w.jsxs(w.Fragment,{children:[w.jsx(bue,{tooltips:Lhe,position:"bottom",children:w.jsx("div",{className:`${jpe} ${Npe} ${o?Fpe:""}`,children:t?n:r})}),this.props.videoId&&!o&&!this.props.isDraft&&w.jsx(Phe,{videoId:this.props.videoId,handleClick:this.handleClick})]});const l=null!==s?this.validationStageModals[s]:null,d=e?w.jsx("div",{className:`${jpe} ${Npe} ${o?Fpe:""}`,children:t?n:r}):w.jsxs("div",{className:Ppe,children:[l&&l.render(),w.jsx(The,{submitting:!!this.state.submitting,handleClick:this.handleClick,exportBlocked:!!a,isBrandKitTemplate:!!o,exportBlockedOnDurationPro:this.props.exportBlockedOnDurationPro,shrinkCreateButton:!!t}),this.props.videoId&&!o&&w.jsx(Phe,{videoId:this.props.videoId,handleClick:this.handleClick})]});return w.jsx(bue,{tooltips:Fhe,position:"bottom",children:d})}}const Bhe=je(g.connect((e=>{var t,o,a,i,s,n,r,l;const{studio:d,currentUser:c,assets:{byId:u}}=e,{scenes:m}=d,p=!c.token,h=!RU(Bl.ENHANCE_IMAGE)&&(null==(t=m[0])?void 0:t.layers.some((e=>{var t;return e.isEnhancedImage||e.asset_id&&"enhanced-image"===(null==(t=u[e.asset_id])?void 0:t.usedProFeature)}))),f=RU(Bl.REMOVE_BACKGROUND),y=!f&&(null==(o=m[0])?void 0:o.layers.some((e=>{var t;return e.backgroundRemoved||e.asset_id&&"remove-background"===(null==(t=u[e.asset_id])?void 0:t.usedProFeature)}))),v=!f&&(null==(a=m[0])?void 0:a.layers.some((e=>{var t;return null==(t=e.usedProFeatures)?void 0:t.includes("remove-video-background")}))),_=!RU(Bl.CLEAN_AUDIO)&&(null==(i=m[0])?void 0:i.layers.some((e=>{var t;return e.asset_id&&"clean-audio"===(null==(t=u[e.asset_id])?void 0:t.usedProFeature)}))),w=RU(Bl.SMART_CUT),b=!w&&(null==(s=m[0])?void 0:s.layers.some((e=>{var t;return(null==(t=e.usedProFeatures)?void 0:t.includes("smart-cut"))&&e.type===zl.Video}))),T=!w&&(null==(n=m[0])?void 0:n.layers.some((e=>{var t;return(null==(t=e.usedProFeatures)?void 0:t.includes("smart-cut"))&&e.type===zl.Audio}))),x=!RU(Bl.AUDIOGRAM)&&(null==(r=m[0])?void 0:r.layers.some((e=>{var t;return null==(t=e.usedProFeatures)?void 0:t.includes("audiogram")}))),S=!RU(Bl.UNLIMITED_EXPORT_DURATION_LIMIT)&&d.duration>240,E=!RU(Bl.UNLIMITED_UPLOAD_SIZE_LIMIT)&&yK(e),I=!RU(Bl.PREMIUM_ASSETS)&&(null==(l=m[0])?void 0:l.layers.some((e=>{var t;return null==(t=e.usedProFeatures)?void 0:t.includes("premium-assets")}))),C=d.duration>7200,k=I||S||C||E||y||_||T||b||v||x||h;let A=[];return y&&A.push(Vl.BACKGROUND_IMAGE_ERASE),I&&A.push(Vl.PREMIUM_ASSETS),E&&A.push(Vl.UPLOAD_LIMIT),S&&A.push(Vl.SINGLE_VIDEO_DURATION_LIMIT),_&&A.push(Vl.CLEAN_AUDIO),b&&A.push(Vl.SMART_CUT_VIDEO),T&&A.push(Vl.SMART_CUT_AUDIO),v&&A.push(Vl.REMOVE_VIDEO_BACKGROUND),x&&A.push(Vl.AUDIOGRAM_BAR),h&&A.push(Vl.ENHANCE_IMAGE),0===A.length&&(A=[Vl.DEFAULT]),g.shallowEqual(A,Ohe)?A=Ohe:Ohe=A,{type:Dhe(e),exportBlocked:k,exportBlockedAction:A[0]||Vl.DEFAULT,allExportBlockingActions:A,exportBlockedOnRemoveBg:y,exportBlockedOnCleanAudio:_,exportBlockedOnEnhanceImage:h,exportBlockedOnSmartCutAudio:T,exportBlockedOnSmartCutVideo:b,exportBlockedOnAudiogram:x,exportBlockedOnRemoveVideoBackground:v,exportBlockedOnDuration:S,exportBlockedOnDurationPro:C,exportBlockedOnFilesize:E,freeUserDurationLimitWarned:nf(e,"freeUserDurationLimitWarned"),freeUserFileSizeLimitWarned:nf(e,"freeUserFileSizeLimitWarned"),proUserDurationLimitWarned:nf(e,"proUserDurationLimitWarned"),cleanAudioFeatureUsedWarned:nf(e,"cleanAudioUsed"),smartCutFeatureUsedWarned:nf(e,"smartCutUsed"),removeVideoBackgroundUsedWarned:nf(e,"removeVideoBackgroundUsed"),audiogramUsedWarned:nf(e,"audiogramUsed"),premiumAssetsUsedWarned:nf(e,"premiumAssetsUsed"),enhanceImageUsedWarned:nf(e,"enhancedImageUsed"),isProjectFetched:e.studioLocal.isProjectFetched,overlayWithHeader:d.overlayWithHeader,showingTooltip:e.toolTip,signedOut:p,isBrandKitTemplate:e.studio.isBrandKitTemplate,brandkitTemplates:e.teams.brandkitTemplates,videoId:e.studio._id,canWrite:e.userPermissions.canWrite,isDraft:e.studio.draft}}))(Uhe)),Vhe="Header-module_disabled_LhZ0P",Whe="Header-module_logo_xESyj",Ghe="Header-module_headerContainer_RrHY4",Hhe="Header-module_impersonating_JikJn",$he="Header-module_headerLeft_EG9z0",Khe="Header-module_headerCenter_uKoNh",zhe="Header-module_headerRight_7wFRV",Yhe="Header-module_headerButtonContainer_zZNYX",Jhe="Header-module_commentsLabel_yp6vG",qhe="Header-module_selectedCommentsLabel_ChtfY",Xhe="Header-module_headerButtonIcon_o7HhI",Qhe="Header-module_accountButton_0kzGN",Zhe="Header-module_headerLogoContainer_ph4oL",ege="Header-module_signInButton_iafs6",tge="Header-module_breadcrumbContainer_fsVUd",oge="Header-module_breadcrumbLink_-MM7g",age="Header-module_upgradeLabel_g6s9W",ige="Header-module_presenceIconContainer_BWWNU",sge="Header-module_presenceIconWrapper_W2fBp",nge="Header-module_presenceIcon_heHaB",rge="Header-module_presenceHoverText_fN9cH",lge="Header-module_plusIcon_uWwzN",dge="Header-module_projectName_nFOnW",cge="Header-module_noEvents_V9leN",uge="Header-module_settingsButtonIcon_GD7-G",mge="Header-module_impersonationWarning_n-t3Y",pge="Header-module_headerUploadButtonContainer_5jmhN",hge="Header-module_headerButtonTooltip_8qmPx",gge="Header-module_headerSubtitlesButtonContainer_Qd8we",fge="Header-module_headerSubtitlesTooltip_-2O5k",yge="Header-module_headerSettingsButtonContainer_zVBTs",vge="Header-module_headerSettingsTooltip_1ZgFQ",_ge="Header-module_headerCommentsButtonContainer_lSiRM",wge="Header-module_headerCommentsTooltip_OLlwb",bge="Header-module_commentsIcon_64rNH",Tge="OnlineStatus-module_onlineStatusContainer_gjuCw",xge="OnlineStatus-module_containerUserNoLicense_g9v3x";const Sge={marginRight:5,marginTop:2},Ege=_.memo((()=>{const e=(Og(5e3),window.navigator.onLine),t=(Og(15e3),tl(Vg)||!e),{timeOfLastSyncSuccess:o}=tl((e=>({timeOfLastSyncSuccess:e.studioLocal.lastSyncedUserFacing})),ol),a=ou(),i=tl(nu),s=il();let n="";if(o){n=`Last ${t?"saved":"edited"} ${Z.duration(-Z().diff(Z(o))).humanize(!0)} `}const r=h.useCallback((()=>{s(YD({tabId:KD.Versions,tabContainerId:"controls"}))}),[s]);return i&&n?w.jsx("div",{className:`${Tge} ${a.type!==Cl.Free?"":xge}`,onClick:r,children:t?w.jsxs(w.Fragment,{children:[w.jsx(Go,{color:"grey",size:14,style:Sge}),n]}):n}):null})),Ige=_.memo((()=>{const e=tl((e=>e.studio.workflowId)),[t,o]=h.useState("");return h.useEffect((function(){e&&async function(){const t=await Yr(`/api/v2/workflows/highlights/${e}/name`);o(t.name)}().catch(console.error)}),[e]),e?w.jsxs("div",{className:tge,children:[w.jsx(Ft,{to:`/repurpose/${e}`,className:oge,children:t}),w.jsx(Io,{})]}):null})),Cge=async e=>{const{state:t,dispatch:o}=sr(),{workspaces:a}=t,{selectedTeamId:i}=t.teams;try{let t=e??a.selectedWorkspace;if(t===Vn){const e=(()=>{const{currentUser:e,teams:t}=sr().state,{allTeams:o}=t,{user:a}=e;return o.find((e=>e.primary&&e.creatorId===a._id))})(),s=xP(a.allWorkspaces,(null==e?void 0:e._id)||i)[0];if(s)t=s._id;else{t=(await GP("New Folder",kn.team,null==e?void 0:e._id))._id}o(ib(t))}}catch(s){console.error(s)}},kge=async e=>{const{state:t,dispatch:o}=sr(),{currentUser:a,currentVideo:i,workspaces:s}=t;try{if(!i.isStudio||!wc(a))return void ir.push(`/editor/videos/${i._id}`);let t=s.selectedWorkspace;if(wc(a)){const e=lD(t);if(!((null==e?void 0:e.creatorId)===a.user._id)){const e=s.allWorkspaces.find((e=>e.creatorId===a.user._id));e&&(t=e._id)}}Cge(t);const{copiedProject:n}=await wK(i.projectId,{entryPoint:e});i._id&&o(pS("re-edit")),ir.push(`/${n.videoId}/studio/editor`)}catch(n){console.error(n)}},Age=async(e,t)=>{const{state:o}=sr(),{workspaces:a}=o;try{const{copiedProject:o}=await wK(t,{destinationFolderId:a.selectedWorkspace,setAsTemplate:!0,entryPoint:e});ir.push(`/${o.videoId}/studio/editor`)}catch(i){console.error(i)}},jge=async e=>{const{dispatch:t,state:o}=sr(),{selectedWorkspace:a}=o.workspaces,{currentUser:i}=o;try{await async function(e,t){const{token:o,user:a}=t||{};return zr("/api/v1/projects/",{parseJSON:!1,params:{token:o,userId:a&&a._id},body:{projectIds:e}})}(e,i),g.batch((()=>e.forEach((e=>{t(cO({projectId:e,folderId:a}))})))),t(wl({description:`Your ${Nc("project has","projects have",e.length)} been successfully deleted`,type:"success"}))}catch(IGe){mh({description:"Failed to delete projects",error:IGe})}},Nge=async e=>{const{dispatch:t}=sr(),o=(await Yr("/api/v1/home",{params:e})).projects||[];if(!o)return;const{workspaceId:a}=e;t(dO({projects:o,folderId:a.toString()}))},Rge=()=>{const e=il();return h.useCallback(((t,o)=>new Promise(((a,i)=>{_h({modalType:gh.MOVE_PROJECT,projectIds:t,onSubmit:async i=>{const s=await function(e,t){return Jr("/api/v1/projects/move",{body:{projectIds:e,destinationFolderId:t}})}(t,i);s.destinationFolder&&s.movedProjects&&(e({type:mO,payload:s}),Nge({workspaceId:s.destinationFolder._id,teamId:s.destinationFolder.teamId})),Fm(ym.MOVE_PROJECT,{"Project Action":pd.MOVE,"Number of Projects":t.length,"Entry Point":o}),a(s)},onCancel:i})}))),[e])},Pge=()=>{const e=xh(),t=bc();return h.useCallback(((o,a)=>new Promise(((i,s)=>{const n=async e=>{try{i(await wK(o,e))}catch(IGe){mh({description:"Failed to copy project",error:IGe}),s(IGe)}};t?e&&t&&!a.destinationFolderId&&!a.duplicate?_h({modalType:gh.COPY_PROJECT,projectId:o,onSubmit:async e=>{await n({name:e.name||a.name,destinationFolderId:e.destinationFolderId,entryPoint:a.entryPoint})},onCancel:s}):n(a):(async()=>{try{await kge(a.entryPoint),Fm(ym.COPY_PROJECT,{"Project Action":pd.COPY,"Entry Point":a.entryPoint})}catch(IGe){mh({description:"Failed to copy project",error:IGe}),s(IGe)}})()}))),[e,t])},Dge=()=>{const e=xh();return h.useCallback(((t,o,a)=>new Promise(((i,s)=>{const n=async e=>{try{i(await async function(e,t){try{return await Jr(`/api/v2/project/${e}/snapshot-copy`,{body:t})}catch(IGe){throw console.error(IGe),IGe}}(t,e))}catch(IGe){mh({description:"Failed to make a copy",error:IGe}),s(IGe)}};if(!e||a.destinationFolderId)return void n(a);_h({modalType:gh.COPY_PROJECT,name:a.name,projectId:o,onSubmit:async e=>{await n({name:e.name||a.name,destinationFolderId:e.destinationFolderId,entryPoint:a.entryPoint})},onCancel:s})}))),[e])};var Oge=(e=>(e.FINAL_VIDEO_PAGE="Final Video Page",e.SNAPSHOT_PAGE="Snapshot Page",e.VERSION_HISTORY="Version History",e.EXPORT_HISTORY="Export History",e))(Oge||{}),Lge=(e=>(e.VERSION_HISTORY="Version History",e.PROJECT_DROPDOWN="Project Dropdown",e.STUDIO_HEADER="Studio Header",e.FINAL_VIDEO_PAGE="Final Video Page",e.ADMIN_DEBUG_PAGE="Admin Debug Page",e.RESIZE="Resize Overlay",e.TUTORIAL="Tutorial Project",e.FIND_HIGHLIGHTS="Find Highlights",e))(Lge||{}),Fge=(e=>(e.PROJECT_DROPDOWN="Project Dropdown",e.WORKSPACE_BULK_MOVE="Workspace Bulk Move",e))(Fge||{}),Mge=(e=>(e.THROTTLED_THUMBNAIL_GENERATOR="Throttled Thumbnail Generator",e.ON_EXIT="On Exit",e.FIRST_SAVE="First Save",e))(Mge||{});function Uge(e,t,o="mousedown"){h.useEffect((()=>{const a=o=>{e.current&&!e.current.contains(o.target)&&t(o)};return document.addEventListener(o,a),document.addEventListener("touchstart",a),()=>{document.removeEventListener(o,a),document.removeEventListener("touchstart",a)}}),[e,t,o])}const Bge="HeaderOverflow-module_headerOverflowContainer_annIJ",Vge="HeaderOverflow-module_headerOverflowIcon_ADqXM",Wge="HeaderOverflow-module_headerOverflowDropdownMenu_K0-rF",Gge="HeaderOverflow-module_headerOverflowDropdownItem_j8E2W",Hge="DeleteDialog-module_deleteDialogBackground_KjRMs",$ge="DeleteDialog-module_deleteButton_--UFm",Kge="DeleteDialog-module_override_8SR2y",zge="DeleteDialog-module_deleteDialogContainer_ErvIj",Yge="DeleteDialog-module_dark_WXXot",Jge="DeleteDialog-module_header_Ex1yj",qge="DeleteDialog-module_description_l93jw",Xge="DeleteDialog-module_deleteCloseContainer_S3Gqz",Qge="DeleteDialog-module_buttonsContainer_oBRrT",Zge=(e,{plural:t=!1,extraText:o=""}={})=>`Are you sure you want to delete ${t?"these":"this"} ${e}? ${o}`,efe=_.memo((({hideDelete:e,delete:t,headerTitle:o,description:a,theme:i="light",confirmButtonText:s="Delete"})=>{const[n,r]=h.useState(!1),l=async()=>{r(!0),await t(),e()};return _e.createPortal(w.jsxs(w.Fragment,{children:[w.jsx("div",{className:Hge,onClick:e}),w.jsxs("div",{className:`${zge} ${"dark"===i?Yge:""}`,children:[w.jsx("div",{className:Xge,onClick:e,children:w.jsx(ve,{})}),w.jsx("div",{className:Jge,children:o}),w.jsx("div",{className:qge,children:a}),w.jsx("div",{className:Qge,children:w.jsx(GF,{cancelFn:e,confirmFn:l,confirmText:s,cancelText:"Cancel",loadingMsg:n?"Deleting...":void 0,confirmButtonClassName:`${$ge} ${Kge}`})})]})]}),sM())})),tfe="Dialog-module_dialog_arPk5",ofe="Dialog-module_header_5P603",afe="Dialog-module_description_R5jpq",ife="Dialog-module_deleteButton_Q4Cll",sfe="Dialog-module_override_rPOA5",nfe=(e,t=(()=>{}))=>{_h({modalType:gh.DELETE_PROJECT,projectIds:e,onSubmit:t})},rfe=_.memo(je((({projectIds:e,onSubmit:t=(()=>{})})=>{const[o,a]=h.useState(!1),i=e.length>1,s={extraText:"You will not be able to edit or download a project after it has been deleted."},n=`Delete ${e.length} ${Nc("project","projects",e.length)}?`,r=i?Zge("projects",{...s,plural:!0}):Zge("project",{...s}),l=h.useCallback((async()=>{a(!0),await jge(e),t(),vh()}),[t,e]);return w.jsxs("div",{className:tfe,children:[w.jsx("div",{className:ofe,children:n}),w.jsx("div",{className:afe,children:r}),w.jsx(GF,{cancelFn:vh,confirmFn:l,confirmText:"Delete",cancelText:"Cancel",loadingMsg:o?"Deleting...":void 0,confirmButtonClassName:`${ife} ${sfe}`})]})}))),lfe=_.memo((()=>{const e=h.useRef(null);Uge(e,(()=>d(!1)));const{currentUser:t,isBrandKitTemplate:o,video:a,canWrite:i}=tl((e=>({currentUser:e.currentUser,isBrandKitTemplate:!!e.studio.isBrandKitTemplate,video:e.currentVideo,canWrite:e.userPermissions.canWrite})),ol),s=tl((e=>e.workspaces.selectedWorkspace===Vn||!e.workspaces.allWorkspaces.find((t=>t._id===e.workspaces.selectedWorkspace)))),n=NU(Bl.BRANDKIT),r=wc(t),[l,d]=h.useState(!1),[c,u]=h.useState(!1),m=bW(),p=Pge(),g=h.useCallback((()=>{r?(Fm(ym.MAKE_A_BRAND_TEMPLATE_WITHIN_THE_STUDIO),a.projectId&&Age(Lge.STUDIO_HEADER,a.projectId)):u(!0)}),[r,u,a.projectId]),f=h.useCallback((()=>{n?g():m(g,{action:Vl.BRANDKIT})()}),[n,g,m]),y=h.useCallback((async()=>{if(r){if(a.projectId){if(!wc(t)||o)return void(await kge(Lge.STUDIO_HEADER));const{copiedProject:e}=await p(a.projectId,{entryPoint:Lge.STUDIO_HEADER});window.location.href=`/${e.videoId}/studio/editor`}}else u(!0)}),[u,t,p,o,r,a.projectId]),v=h.useCallback((()=>{if(!a.projectId||!a.workspaceId)return;const{workspaceId:e,projectId:t}=a;nfe([t],(()=>k9(e)))}),[a]),_=h.useCallback((()=>{d(!l)}),[l]),b=h.useCallback((()=>{u(!1)}),[]),T=i&&a.projectId&&a.workspaceId;return w.jsxs("div",{ref:e,className:Bge,children:[w.jsx(xt,{className:Vge,onClick:_,"data-cy":"header-overflow-icon"}),l&&w.jsxs("div",{className:Wge,children:[o?w.jsxs("div",{className:Gge,onClick:()=>{m((()=>{r?(Fm(ym.NEW_BRAND_TEMPLATE_STUDIO),window.open("/studio/editor/new-brand-template/","_blank")):u(!0)}),{if:!n,action:Vl.BRANDKIT})()},children:["Start new brand template",!n&&w.jsx(EW,{})]}):w.jsx("div",{className:Gge,onClick:()=>{r?(Fm(ym.NEW_PROJECT_STUDIO),window.open("/studio/editor","_blank")):u(!0)},children:"Start a new project"}),w.jsx("div",{className:Gge,"data-cy":"header-overflow-copy",onClick:y,children:"Make copy"}),!o&&!s&&w.jsxs("div",{className:Gge,onClick:f,children:["Save as Brand Template ",!n&&w.jsx(EW,{})]}),T&&w.jsx("div",{className:Gge,"data-cy":"header-overflow-delete",onClick:v,children:"Delete this project"})]}),c?w.jsx(bV,{hideSignIn:b}):null]})})),dfe=({videoFetched:e})=>{const t=ku(),o=il(),{currentUser:a,currentFolderId:i,isCollaborating:s,presence:n,presentUserId:r,shouldHidePreview:l,isBrandKitTemplate:d,videoFolder:c,canWrite:u,userTeamInvites:m,folderId:p,videoTeamId:g}=tl((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,showCanvas:e.studio.showCanvas,isCollaborating:e.studio.isCollaborating,presence:e.studio.presence,presentUserId:e.studio.presentUserId,shouldHidePreview:lf(e),isBrandKitTemplate:e.studio.isBrandKitTemplate,videoFolder:e.videoFolder,canWrite:e.userPermissions.canWrite,userTeamInvites:e.teams.userTeamInvites,folderId:e.studio.workspaceId,videoTeamId:e.studio.teamId})),ol),f=Kp(a),{isRecording:y}=Aq(),{showUpgrades:v}=ou(),[_,b]=h.useState(),T=null==m?void 0:m.find((e=>e.team._id===g)),x=_===kn.personal,S=!u&&(T||!x),E=h.useCallback((async()=>{try{if(await ah(),p&&!u){const e=await HP(p);b(e)}}catch(IGe){console.error(IGe)}}),[u,p]);h.useEffect((()=>{E()}),[E]);const I=e=>{e.stopPropagation()};return w.jsxs("div",{className:Ghe+(f?` ${Hhe}`:""),onClick:()=>o(l_(null)),children:[wc(a)&&w.jsx(Y9,{className:mge}),w.jsxs("div",{className:$he,children:[w.jsx(ffe,{currentFolderId:i}),w.jsxs("div",{className:tge,"data-cy":"breadcrumbs",children:[wc(a)?d?w.jsx(Ft,{to:"/brandkit",onClick:I,className:oge,children:"Brand Templates"}):w.jsx(Ft,{to:"Shared with Me"===c.name?"/shared-with-me":`/folder/${c._id}`,onClick:I,className:oge,"data-testid":"header-breadcrumb-link",translate:"no",children:c.name}):w.jsx(Ft,{to:"/",onClick:I,className:oge,children:"Kapwing"}),w.jsx(Io,{})]}),w.jsx(Ige,{}),w.jsxs("span",{className:dge,children:[w.jsx(xpe,{disabled:!u}),w.jsx(lfe,{})]}),u&&w.jsxs(w.Fragment,{children:[w.jsx(gfe,{disabled:!u}),w.jsx(pfe,{disabled:!u})]}),u&&w.jsx(rme,{}),v&&u&&w.jsx(p9,{className:age,action:Vl.STUDIO}),wc(a)&&w.jsx(y9,{className:age})]}),S&&w.jsx("div",{className:Khe,children:T?w.jsx(ype,{invite:T}):!x&&w.jsx(_pe,{})}),w.jsxs("div",{className:zhe,children:[w.jsx(Ege,{}),s&&n&&!t&&w.jsx(cfe,{presence:n,presentUserId:r}),w.jsx(ufe,{isMobile:t}),u&&w.jsx(mfe,{disabled:!u}),w.jsx(lse,{}),w.jsx(Bhe,{videoFetched:e,disabled:l||y,shrinkCreateButton:t}),w.jsx(Zme,{}),w.jsx(hfe,{currentUser:a})]})]})},cfe=({presence:e,presentUserId:t})=>{const o=[],a=ku(),[i,s]=h.useState(3);h.useEffect((function(){s(a?2:3)}),[e,a]),Object.entries(e).forEach((([e,t])=>{eh(t.heartbeat)&&o.push(e)}));const n=t=>{var o,a,i;return(null==(o=e[t])?void 0:o.profileImg)?null==(a=e[t])?void 0:a.profileImg:function(e,t){var o;let a;const i=document.createElement("canvas"),s=e;i.width=s,i.height=s;const n=i.getContext("2d");if(n){n.fillStyle="#78909C",n.fillRect(0,0,s,s),n.font=`normal ${s/2}px sans-serif`,n.textAlign="center",n.textBaseline="middle",n.fillStyle="white";const e=(null==(o=null==t?void 0:t.split(" ")[0])?void 0:o[0])??"";n.fillText(e,s/2,s/2),a=i.toDataURL("image/png")}return a}(20,(null==(i=e[t])?void 0:i.name)||"")},r=t=>{var o;return{border:`2px solid ${null==(o=e[t])?void 0:o.color}`}};return w.jsxs("div",{className:ige,children:[o.map(((o,a)=>{var s;return a<i?w.jsxs("div",{className:sge,children:[w.jsx("img",{src:n(o),alt:"User icon",className:nge,style:r(o)}),w.jsx("span",{className:rge,children:o===t?"You":null==(s=e[o])?void 0:s.name})]},o):null})),o.length>i&&w.jsxs("div",{className:sge,children:[w.jsx(zo,{className:lge}),w.jsxs("span",{className:rge,children:["+ ",o.length-i," more"]})]})]})},ufe=_.memo((({isMobile:e})=>{const{commentsOpen:t,userPermissions:o,canWrite:a}=tl((e=>({commentsOpen:e.comments.commentsOpen,userPermissions:e.userPermissions,canWrite:e.userPermissions.canWrite})),ol),i=il(),s=be(),n=h.useRef(null);h.useEffect((()=>{const e=Object.keys(o).length>0,t=new URLSearchParams(s.search);(e&&!o.canWrite||"true"===t.get(Rie.COMMENT))&&i(Qb(!0))}),[i,s.search,o,e]);return a?w.jsxs("div",{className:`${t?qhe:Jhe} ${_ge} ${a?"":cge}`,onClick:()=>{a&&(i(Qb(!t)),e&&i(hl(!t)))},ref:n,"data-cy":"header-comments-button",children:[w.jsx(Ho,{className:bge}),w.jsx("span",{className:wge,children:"Comments"})]}):null})),mfe=_.memo((({disabled:e=!1})=>w.jsxs("div",{className:`${Yhe}\n      ${yge}\n      ${e?Vhe:""}`,onClick:t=>{e||(eE("/studio/editor/settings"),t.stopPropagation())},"data-cy":"header-settings-button",children:[w.jsx($o,{className:uge}),w.jsx("span",{className:vge,children:"Settings"})]}))),pfe=_.memo((({disabled:e})=>w.jsxs("div",{className:`${Yhe}\n      ${gge}\n      ${e?Vhe:""}`,onClick:t=>{e||(L5(),t.stopPropagation())},"data-cy":"header-subtitler-button",children:[w.jsx(Ko,{className:Xhe}),w.jsx("span",{className:fge,children:"Add Subtitles"})]}))),hfe=e=>{const{currentUser:t}=e,o=tl((e=>e.currentUser)),a=t||o,[i,s]=h.useState(!1),n=Ve(),{redirectSource:r}=_oe(),l=r===voe.REQUEST_TO_EDIT,d=h.useCallback((()=>{s(!1)}),[]);return wc(a)?w.jsx("div",{className:Qhe,onClick:e=>{n.push({pathname:"/home",state:{openModal:c9.account,redirectSource:l?voe.REQUEST_TO_EDIT:void 0}}),e.stopPropagation()},"data-cy":"account-nav-button",children:w.jsx(b9,{absoluteWidth:30,absoluteHeight:30})}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:`${Yhe} ${ege}`,onClick:()=>{s(!0)},onTouchStart:()=>{s(!0)},"data-cy":"signin-nav-button",children:"Sign In"}),i&&w.jsx(bV,{hideSignIn:d,onSuccess:aL})]})},gfe=_.memo((({disabled:e})=>w.jsxs("div",{className:`${Yhe}\n      ${pge}\n      ${e?Vhe:""}`,onClick:t=>{e||(eE("/studio/editor/overlay/upload"),t.stopPropagation())},"data-cy":"header-upload-button",children:[w.jsx(vt,{className:Xhe}),w.jsx("span",{className:hge,children:"Upload"})]}))),ffe=({currentFolderId:e})=>{let t="/home";const o=Ve(),{redirectSource:a,pushWithSource:i}=_oe(),s=tl((e=>e.currentUser.user.onboarding)),n=!((null==s?void 0:s.skipped)||(null==s?void 0:s.survey));return h.useEffect((function(){(async()=>{a===voe.REQUEST_TO_EDIT&&(yae({callToAction:Rm.RequestToEditEmail}),n&&(await FK({skipped:!0}),await np()))})()}),[n,a]),e&&!n&&(t=`/folder/${e}`),w.jsx("div",{className:Zhe,onClick:e=>{a===voe.REQUEST_TO_EDIT?i(t,a):o.push(t),e.stopPropagation()},children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/gdu-kapwing-logo-transparent.webp",className:Whe,alt:"Kapwing Logo","data-cy":"studio-header-logo"})})},yfe="KapwingInput-module_inputText_ECzwK",vfe="KapwingInput-module_text_ly3QW",_fe="KapwingInput-module_editPencil_x2W85",wfe="KapwingInput-module_inputEl_2ljqq",bfe="KapwingInput-module_tooltipName_SKd6d",Tfe=_.memo((({onEdit:e,onSave:t,value:o,showPencil:a,showTooltip:i})=>{const[s,n]=h.useState(!1),[r,l]=h.useState(o);h.useEffect((()=>{l(o)}),[o]);const d=async()=>{const e=r.trim();n(!1),e&&e.length&&e!==o?t(e):l(o)};return s?w.jsx("input",{onKeyUp:e=>{"Enter"===e.key&&d()},className:wfe,value:r,onChange:e=>l(e.target.value),onBlur:d,autoFocus:!0}):w.jsxs(T,{delayDuration:0,children:[w.jsx(C,{asChild:!0,children:w.jsxs("div",{className:yfe,onClick:()=>{e&&e(),n(!0)},children:[w.jsx("span",{className:vfe,children:r}),a&&w.jsx("div",{className:_fe,children:w.jsx(Yo,{})})]})}),i&&w.jsx(S,{children:w.jsx(E,{children:w.jsx("div",{className:bfe,children:r})})})]})})),xfe=()=>{const e=h.useRef(new AbortController);return h.useEffect((()=>{const t=e.current;return()=>t.abort()}),[]),e.current},Sfe=(e,t=20)=>{const[o,a]=h.useState({take:t,skip:0}),i=xfe(),[s,n]=h.useState(!1),[r,l]=h.useState(),[d,c]=h.useState(),u=h.useCallback((async()=>{n(!0);try{const t=await Yr(e,{signal:i.signal,params:{skip:o.skip,take:o.take}});l(t),n(!1)}catch(t){let e="An error occurred";t&&"object"==typeof t&&"error"in t?e=String(t.error):t instanceof Error?e=t.message:t&&(e=String(t)),c(e),n(!1)}}),[e,i.signal,o.take,o.skip]);h.useEffect((()=>{u()}),[u]);const m=h.useCallback((async()=>{s||await u()}),[s,u]);return h.useEffect((()=>{a({take:t,skip:0})}),[e,t]),{isLoading:s,error:d,refetch:m,data:r,pagination:{paginationDisplay:(null==r?void 0:r.totalCount)?`${o.skip+1}-${Math.min(o.skip+o.take,(null==r?void 0:r.totalCount)||0)} of ${null==r?void 0:r.totalCount}`:void 0,paginationOptions:o,firstPage:()=>{a((e=>({...e,skip:0})))},lastPage:()=>{a((e=>({...e,skip:(null==r?void 0:r.totalCount)?Math.floor((r.totalCount-1)/e.take)*e.take:0})))},nextPage:()=>{a((e=>({...e,skip:e.skip+e.take})))},prevPage:()=>{a((e=>({...e,skip:e.skip-e.take})))},gotoPage:e=>{e<1||e>Math.ceil(((null==r?void 0:r.totalCount)||0)/t||0)?a((e=>({...e,skip:0}))):a((t=>({...t,skip:(e-1)*t.take})))}}}},Efe=(e,t)=>{const o=xfe(),[a,i]=h.useState(!1),[s,n]=h.useState(),[r,l]=h.useState(),d=h.useCallback((async()=>{if(e){i(!0);try{const a=await Yr(e,{params:{query:t},signal:o.signal});n(a),i(!1)}catch(a){let e="An error occurred";a&&"object"==typeof a&&"error"in a?e=String(a.error):a instanceof Error?e=a.message:a&&(e=String(a)),l(e),i(!1)}}}),[e,o.signal,t]);h.useEffect((()=>{d()}),[d]);const c=h.useCallback((async()=>{a||await d()}),[a,d]);return{isLoading:a,data:s,error:r,refetch:c}},Ife="FinalVideoHeader-module_wrapper_yD-7a",Cfe="FinalVideoHeader-module_brand_-WaEu",kfe="FinalVideoHeader-module_kapwing_mJmoE",Afe="FinalVideoHeader-module_displayedProjectName_2GeX-",jfe="FinalVideoHeader-module_projectName_IoVI1",Nfe="FinalVideoHeader-module_headerContainer_ye2YZ",Rfe="FinalVideoHeader-module_requestToEditButton_LrazX",Pfe=_.memo((()=>{var e;const[t,o]=h.useState(!0),{currentVideo:a,currentUser:i,canWrite:s,videoId:n}=tl((e=>({currentVideo:e.currentVideo,videoId:e.currentVideo._id,currentUser:e.currentUser,canWrite:e.userPermissions.canWrite})),ol),[r,l]=h.useState(),{data:d,refetch:c,isLoading:u,error:m}=(({videoId:e,snapshotId:t})=>{const o=t?`/api/v2/snapshots/${t}/snapshotPreview`:`/api/v2/videos/${e}/snapshotPreview`,{isLoading:a,data:i,error:s,refetch:n}=Efe(e||t?o:void 0);return{isLoading:a,data:i,error:s,refetch:n}})({videoId:n,snapshotId:r});h.useEffect((function(){var e;(null==(e=null==d?void 0:d.snapshot)?void 0:e._id)&&l(d.snapshot._id)}),[null==(e=null==d?void 0:d.snapshot)?void 0:e._id]),h.useEffect((()=>{let e=!0;return(async()=>{if(a.workspaceId){const t=await HP(a.workspaceId);e&&o(t===kn.personal)}})(),()=>{e=!1}}),[a.workspaceId]);const p=a.isStudio&&a.creatorId&&s,g=(m||(null==d?void 0:d.snapshot))&&!p&&!t,f=h.useCallback((async e=>{await Jr(`/api/v2/snapshots/${null==d?void 0:d.snapshot._id}/rename`,{body:{name:e}}),c()}),[null==d?void 0:d.snapshot._id,c]);return w.jsxs("div",{className:Ife,children:[w.jsxs("div",{className:Cfe,children:[w.jsx(ffe,{}),w.jsx(Ft,{className:kfe,to:"/",children:"KAPWING"})]}),w.jsx("div",{className:Ife,children:w.jsxs("div",{className:jfe,"data-cy":"displayed-project-name",children:[m?w.jsx("span",{children:a.projectName}):!u||m||(null==d?void 0:d.snapshot)?g?w.jsx("span",{children:(null==d?void 0:d.snapshot)?d.snapshot.name||"Untitled Export":a.projectName}):(null==d?void 0:d.snapshot)?w.jsx(Tfe,{value:d.snapshot.name||"Untitled Export",onSave:f}):w.jsx("span",{children:a.projectName}):w.jsx(eme,{}),g&&w.jsx("div",{className:Rfe,children:w.jsx(_pe,{})})]})}),w.jsx("div",{children:w.jsx(hfe,{currentUser:i})})]})}));function Dfe(){return{type:"RESET_STATE_PRESERVE_USER"}}function Ofe(e){return{type:"UPDATE_ENTIRE_STATE",newStateProperties:e}}const Lfe=e=>{const t={};if((null==e?void 0:e.build)&&!q.isEmpty(null==e?void 0:e.build)){const{outputByteSize:o,outputExt:a,outputWidth:i,outputHeight:s}=e.build,{exportQuality:n}=e;if(!o||!a)return null;t.filesize=(e=>{const t=e/1e3;if(t<1e3)return`${(Math.round(10*t)/10).toFixed(1)} KB`;const o=t/1e3;if(o<1e3)return`${(Math.round(10*o)/10).toFixed(1)} MB`;const a=o/1e3;return`${(Math.round(10*a)/10).toFixed(1)} GB`})(o),t.format=a.toUpperCase(),"mp3"!==a&&i&&s&&(t.resolution=`${i}x${s}`),t.quality=n}return t},Ffe="VideoPrivacyOptions-module_container_cbXry",Mfe="VideoPrivacyOptions-module_inVideoContainer_LoSh3",Ufe="VideoPrivacyOptions-module_currentPrivacy_VJSp4",Bfe="VideoPrivacyOptions-module_changePrivacy_Khz-X",Vfe="VideoPrivacyOptions-module_privacyIcon_IVDeO",Wfe=_.memo((({videoId:e,userHasAccess:t,privacy:o,inVideoContainer:a,downloadUrl:i})=>{const s=il(),n=bW(),r=NU(Bl.CHANGE_PRIVACY);if(!t)return null;const l=Tm(i);return w.jsxs("div",{className:a?Mfe:Ffe,children:[w.jsxs("div",{className:Ufe,children:[o?w.jsx(Jo,{className:Vfe,color:"white"}):w.jsx(qo,{className:Vfe,color:"white"}),`This ${l} is ${o===Ln.private?Fn.private:Fn.unlisted}`]}),w.jsxs("div",{className:Bfe,onClick:async()=>{if(!r)return void n((()=>null),{action:Vl.PRIVACY})();const t=o===Ln.private?Ln.unlisted:Ln.private;try{const o=await oK(e,t);s(fD(o))}catch(IGe){mh({description:"Error changing video privacy",error:IGe})}},children:[`Make ${l} ${o===Ln.private?Fn.unlisted:Fn.private}`,!r&&w.jsx(EW,{})]})]})})),Gfe={home:"VideoContainer-module_home_vETFx",homeHowBackgroundWhite:"VideoContainer-module_homeHowBackgroundWhite_xUNro",largeButton:"VideoContainer-module_largeButton_8dU5G",sectionContent:"VideoContainer-module_sectionContent_r4SDQ",sectionHeader:"VideoContainer-module_sectionHeader_Jpb2G",spacer:"VideoContainer-module_spacer_P2Cri",chevron:"VideoContainer-module_chevron_wtOP0",splashText:"VideoContainer-module_splashText_y0TlB",splashSubtext:"VideoContainer-module_splashSubtext_hpFoO",aboutSection:"VideoContainer-module_aboutSection_GvCac",mobile:"VideoContainer-module_mobile_ETFyI",desktop:"VideoContainer-module_desktop_CFpyx",screenReaderOnlyLabel:"VideoContainer-module_screenReaderOnlyLabel_xQIVF",disabled:"VideoContainer-module_disabled_iVGkq",noScrollBar:"VideoContainer-module_noScrollBar_IyWON",textOverflowEllipsis:"VideoContainer-module_textOverflowEllipsis_-8PpN",disableTextHighlight:"VideoContainer-module_disableTextHighlight_d1Imw",genericButtonBlue:"VideoContainer-module_genericButtonBlue_A5Opa",wrapper:"VideoContainer-module_wrapper_jTNOz",mobileCommentsWrapper:"VideoContainer-module_mobileCommentsWrapper_Po8OY",container:"VideoContainer-module_container_4yrzu",mobileCommentsContainer:"VideoContainer-module_mobileCommentsContainer_A4H-5",header:"VideoContainer-module_header_JML-D",metaDataContainer:"VideoContainer-module_metaDataContainer_fHszF",metaDataRow:"VideoContainer-module_metaDataRow_SsKO2",metaDataLabel:"VideoContainer-module_metaDataLabel_d79EI",metaDataDescription:"VideoContainer-module_metaDataDescription_t2IO3",actions:"VideoContainer-module_actions_KnIel",videoActionButtonWrapper:"VideoContainer-module_videoActionButtonWrapper_cQ9sD",actionButton:"VideoContainer-module_actionButton_WBruA",videoActionButton:"VideoContainer-module_videoActionButton_E4ZMo",actionIcon:"VideoContainer-module_actionIcon_uYB7L",description:"VideoContainer-module_description_Gs8Fb",reportAProblemButton:"VideoContainer-module_reportAProblemButton_9lPUX",openInStudio:"VideoContainer-module_openInStudio_xwI51",upsellBlock:"VideoContainer-module_upsellBlock_btc9R",buttonWrapper:"VideoContainer-module_buttonWrapper_kh9Fo",overlay:"VideoContainer-module_overlay_x1GzY",overlayBackground:"VideoContainer-module_overlayBackground_vhcxF",finalVideoContainer:"VideoContainer-module_finalVideoContainer_-snrS",finalVideoPreviewContainer:"VideoContainer-module_finalVideoPreviewContainer_XqKGP",socialDescription:"VideoContainer-module_socialDescription_p0WPR",youtubeChannelLink:"VideoContainer-module_youtubeChannelLink_-NVGO",viewAndOptionsContainer:"VideoContainer-module_viewAndOptionsContainer_oDlgG",loadingWrapper:"VideoContainer-module_loadingWrapper_qW6py",finalVideoVideoContainer:"VideoContainer-module_finalVideoVideoContainer_4GNCk",commentsFinalVideoContainer:"VideoContainer-module_commentsFinalVideoContainer_-mG8R",topEditButtonContainer:"VideoContainer-module_topEditButtonContainer_L1S-s",privacyAndSocialWrapper:"VideoContainer-module_privacyAndSocialWrapper_JSqWY",topEditLeft:"VideoContainer-module_topEditLeft_rnVLD",topEditRight:"VideoContainer-module_topEditRight_tnjnu",commentsMetaDataIconContainer:"VideoContainer-module_commentsMetaDataIconContainer_K1zoz",commentsMetaDataFileSize:"VideoContainer-module_commentsMetaDataFileSize_E7zW4",commentsMetaDataIcon:"VideoContainer-module_commentsMetaDataIcon_hR10J",commentsMetaDataContainer:"VideoContainer-module_commentsMetaDataContainer_-Bl-H",topTooltip:"VideoContainer-module_topTooltip_qknIa",commentsContainerWrapper:"VideoContainer-module_commentsContainerWrapper_6KkLk",commentsSharingWrapper:"VideoContainer-module_commentsSharingWrapper_GJ6Fw",videoContainerContent:"VideoContainer-module_videoContainerContent_kYsvH",commentingVideoContainerContent:"VideoContainer-module_commentingVideoContainerContent_dyij1",adminSectionWrapper:"VideoContainer-module_adminSectionWrapper_ikRiy",emailMessageContainer:"VideoContainer-module_emailMessageContainer_pfbva",emailMessageDiv:"VideoContainer-module_emailMessageDiv_2CVRr",watermarkUpsell:"VideoContainer-module_watermarkUpsell_fALh5",blackBackground:"VideoContainer-module_blackBackground_uilU9",tabsHolder:"VideoContainer-module_tabsHolder_u67Vj",tab:"VideoContainer-module_tab_uFvtg"},Hfe="VideoPageButton-module_actionButton_-OxGR",$fe="VideoPageButton-module_actionButtonText_xXwn9",Kfe=_.memo((({label:e,icon:t,onClick:o,disabled:a,dataCy:i})=>w.jsxs("button",{type:"button",className:Hfe,onClick:o,disabled:a,"data-cy":i,children:[w.jsx("span",{children:t}),w.jsx("span",{className:$fe,children:e})]}))),zfe=w.jsx(Xo,{}),Yfe=_.memo((()=>{const e=Ve(),t=il(),{origin:o,editorPath:a}=tl((e=>({origin:e.currentVideo.origin,editorPath:e.currentVideo.editorPath})),ol),i=h.useCallback((()=>{if(!o)return a&&KU.includes(a)?"/studio/editor":a;if(["","edit-in-studio","re-edit"].includes(o))return a;if("video-maker"===o)return"/video-maker";if("memeMaker"===o)return"/meme-maker";const e=(e=>{let t;t="addText"===e?"/tools/add-text":"addImageVideo"===e?"/tools/add-image":`/tools/${(e=>{const t=e[0];if(!t)return e;let o=t.toLowerCase()+e.slice(1);return o=o.replace("GIF","Gif"),o.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))})(e)}`;const o=v7.find((e=>e.url===t));return(o||!!o)&&t})(o);return e||a}),[a,o]),s=h.useCallback((()=>{t({type:"RESET_STUDIO"}),Fm(ym.START_NEW_PROJECT_FROM_FINAL_VIDEO)}),[t]),n=h.useCallback((()=>{s();const t=i()||"/";e.push(t)}),[i,e,s]);return w.jsx(Kfe,{label:"Start a new project",icon:zfe,dataCy:"start-new-project",onClick:n})})),Jfe="OptionsContainer-module_wrapper_8vlNC",qfe="OptionsContainer-module_mobileCommentsWrapper_cT5hy",Xfe="OptionsContainer-module_container_f7sEv",Qfe="OptionsContainer-module_mobileCommentsContainer_KNypL",Zfe="OptionsContainer-module_metaDataContainer_Tw--1",eye="OptionsContainer-module_metaDataRow_aOAOd",tye="OptionsContainer-module_metaDataLabel_rFGA1",oye="OptionsContainer-module_metaDataDescription_2zhXY",aye="OptionsContainer-module_actionButton_AUJMV",iye="OptionsContainer-module_actionIcon_3woF7",sye="OptionsContainer-module_description_AUQtk",nye="OptionsContainer-module_reportAProblemButton_6ekr-",rye="OptionsContainer-module_upsellBlock_AptWG",lye="OptionsContainer-module_buttonWrapper_5PB8F",dye=_.memo((({text:e,commentingView:t,projectId:o,entryPoint:a,isCopyDisabled:i})=>{const s=Ve(),n=Pge();return w.jsxs("button",{type:"button",className:`${i?k8.disabled:""} edit-video-menu-link ${t?Gfe.videoActionButton:aye}`,onClick:async()=>{const{copiedProject:e}=await n(o,{entryPoint:a});s.push(`/${e.videoId}/studio/editor`)},disabled:i,"data-cy":"copy-and-edit-button",children:[w.jsx(Qo,{className:t?Gfe.actionIcon:iye}),w.jsx("span",{children:e})]})})),cye=w.jsx(Zo,{}),uye=w.jsx(ea,{}),mye=_.memo((({isEditDisabled:e,videoId:t,setReEditOrigin:o,commentingView:a})=>{const i=Ve(),s=h.useCallback((()=>{o&&o(),i.push(`/${t}/studio/editor`)}),[i,o,t]);return w.jsx(Kfe,{label:"Edit this project",icon:a?cye:uye,dataCy:"edit-video-button",disabled:e,onClick:s})})),pye=async e=>{if(e)try{const t=document.createElement("a");t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(t){mh({description:"Error downloading the file, please try again later",error:t})}},hye=w.jsx(ta,{}),gye=_.memo((({onDownload:e,downloadUrl:t,entryPoint:o})=>{const a=il(),{currentUser:i,currentVideo:s}=tl((e=>({currentUser:e.currentUser,currentVideo:e.currentVideo})),ol),n=h.useCallback((n=>{if(!wc(i))return n.preventDefault(),void a({type:"SHOW_SIGN_IN"});pye(t||k0(s,"fullPath")),vae(wc(i),o),e&&e()}),[i,s,a,t,o,e]);return w.jsx(Kfe,{label:"Download file",icon:hye,dataCy:"download-final-video-button",onClick:n})})),fye=(e,t)=>{if(!e||!t)return null;const o=null==e?void 0:e.find((e=>e._id===t));return(null==o?void 0:o.parentId)||(null==o?void 0:o._id)},yye=e=>{if(!e||s.isEmpty(e))return null;const t=[{label:"Format",value:e.format||""}];return"MP4"!==e.format&&"GIF"!==e.format||!e.quality||t.push({label:"Quality",value:e.quality}),"MP3"!==e.format&&e.resolution&&t.push({label:"Resolution",value:e.resolution}),e.filesize&&t.push({label:"File Size",value:e.filesize}),t},vye=e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain");if(window.getSelection){const e=window.getSelection();if((null==e?void 0:e.getRangeAt)&&e.rangeCount){const o=e.getRangeAt(0);o.deleteContents(),o.insertNode(document.createTextNode(t)),o.collapse(!1)}}},_ye=async e=>{const{dispatch:t}=sr(),o=await wye(e);o&&t(qb(o))};async function wye(e){let t,o=[];try{for(;;){const a={pageSize:500};t&&(a.lastId=t);const i=await Yr(`/api/v1/videos/${e}/comments`,{params:a});if(!(null==i?void 0:i.length))break;if(t=i[i.length-1]._id,o=[...i,...o],i.length<500)break}}catch(IGe){const t=IGe instanceof Error?IGe.message:"";console.error(`Error while fetching comments: ${t}`)}return o}const bye=()=>{const{dispatch:e,state:t}=sr();t.userPermissions.canWrite&&(e(Xb("")),e(Qb(!1)))},Tye=e=>{var t;return!!(null==(t=e.comments.comments)?void 0:t.length)},xye=e=>e.user?null:{name:"Deleted user"},Sye=_.memo((({metadata:e,tooltipPosition:t="bottom"})=>{const[o,a]=h.useState(!1),i=yye(e),s=h.useCallback((()=>{a(!1)}),[]),n=h.useCallback((()=>{a(!0)}),[]);return w.jsxs("div",{className:Gfe.commentsMetaDataIconContainer,children:[w.jsx("div",{className:Gfe.commentsMetaDataFileSize,children:(null==e?void 0:e.filesize)||""}),w.jsx(oa,{className:Gfe.commentsMetaDataIcon,onMouseEnter:n,onMouseLeave:s}),o&&i&&w.jsx("div",{className:`${Gfe.commentsMetaDataContainer} ${"top"===t&&Gfe.topTooltip}`,children:i.map((({label:e,value:t})=>w.jsxs("div",{className:eye,children:[w.jsx("div",{className:tye,children:`${e}:`}),w.jsx("div",{className:oye,children:t})]},e)))})]})}));class Eye extends h.Component{constructor(){super(...arguments),i(this,"state",{loading:!1}),i(this,"setReEditOrigin",(()=>{const{currentVideo:e}=this.props;e._id&&this.props.setOrigin("re-edit")})),i(this,"isCopyDisabled",(()=>{if(this.state.loading)return!0;const{currentVideo:e}=this.props;return!(!e.editorPath||!KU.includes(e.editorPath))}))}render(){const{currentVideo:e,commentingView:t,onDownload:o,local_url:a,canWrite:i}=this.props,{creatorId:s}=e,n=!e._id||this.state.loading,r=e.isStudio&&s&&i;let l=r?"Copy project and edit":"Edit a copy";if(t&&(l="Make a copy"),t){const i=Lfe(e);return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:Gfe.topEditLeft,children:[r&&e._id?w.jsx("div",{className:Gfe.buttonWrapper,children:w.jsx(mye,{videoId:e._id,setReEditOrigin:this.setReEditOrigin,isEditDisabled:n,commentingView:t})}):null,e.projectId&&w.jsx(dye,{isCopyDisabled:this.isCopyDisabled(),text:l,commentingView:t,projectId:e.projectId,entryPoint:Lge.FINAL_VIDEO_PAGE}),w.jsx(Yfe,{})]}),w.jsxs("div",{className:Gfe.topEditRight,children:[i&&w.jsx(Sye,{metadata:i}),e.fullPath&&w.jsx(gye,{onDownload:o,downloadUrl:a,entryPoint:Oge.FINAL_VIDEO_PAGE})]})]})}return!r&&e.projectId?w.jsx(dye,{isCopyDisabled:this.isCopyDisabled(),text:l,commentingView:t,projectId:e.projectId,entryPoint:Lge.FINAL_VIDEO_PAGE}):w.jsxs(w.Fragment,{children:[!!e._id&&w.jsx("div",{className:Gfe.buttonWrapper,children:w.jsx(mye,{videoId:e._id,setReEditOrigin:this.setReEditOrigin,isEditDisabled:n,commentingView:t})}),e.projectId&&w.jsx(dye,{isCopyDisabled:this.isCopyDisabled(),text:l,commentingView:t,projectId:e.projectId,entryPoint:Lge.FINAL_VIDEO_PAGE})]})}}const Iye=je(g.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,workspaces:e.workspaces,currentFolderId:e.workspaces.selectedWorkspace,selectedTeamId:e.teams.selectedTeamId,canWrite:e.userPermissions.canWrite})),(e=>ye({setOrigin:pS,setCurrentFolder:ib},e)))(Eye));function Cye(e,t){Fm(ym.SHARE_FINAL_VIDEO,{type:t,"Entry Point":Oge.FINAL_VIDEO_PAGE})}function kye(e,t=!1){const{token:o,user:a}=sr().state.currentUser||{},{_id:i}=a||{};return qr(`/api/v2/videos/${e}/share`,{body:{token:o,userId:i,write:t}})}const Aye="Sharing-module_container_5srG3",jye="Sharing-module_commentViewContainer_E1YFf",Nye="Sharing-module_header_vzZb-",Rye="Sharing-module_copyLinkButton_4kRMS",Pye="Sharing-module_input_eIlfs",Dye="Sharing-module_moreContainer_zdB4V",Oye="Sharing-module_embedButton_3tra-",Lye="Sharing-module_embedButtonIcon_YWWH0",Fye="Sharing-module_socialMediaButtons_VEL7u",Mye="Sharing-module_socialOptionIcon_jsbGH",Uye=["kapwing"],Bye=_.memo((e=>{const{showEmbedModal:t,inCommentView:o}=e,[a,i]=h.useState(!1),s=h.useRef(null),n=il(),r=tl((e=>e.currentVideo)),l=tl((e=>e.projectName)),d=`https://www.kapwing.com/videos/${r._id}`;h.useEffect((()=>{const e=window.location.search,t=new URLSearchParams(e).get("tiktokstatus");t&&n(wl("success"===t?{description:"Shared succesfully - Check the TikTok app to finish posting your video",type:"success"}:{description:`Something went wrong. ${t}`,type:"error"}))}),[n]);const c=()=>{const{_id:e}=r||{};return e&&Cye(0,"Twitter"),Promise.resolve()},u=()=>{const{_id:e}=r||{};return e&&Cye(0,"Facebook"),Promise.resolve()},m=(e,t=navigator.language)=>{const[o,...a]=e;return void 0===o?e:o.toLocaleUpperCase(t)+a.join("")};return r&&r._id?w.jsxs("div",{className:o?jye:Aye,children:[w.jsxs("div",{className:Nye,children:[w.jsx("div",{children:"Share this"}),w.jsx("div",{children:w.jsx("div",{className:Rye,onClick:()=>{i(!0),setTimeout((()=>{i(!1)}),1500);const{_id:e}=r||{};e&&Cye(0,"Link");navigator.clipboard.writeText(d).then((()=>{var e;if(s.current){const t=s.current;null==(e=null==window?void 0:window.getSelection())||e.selectAllChildren(t)}}))},children:a?"Copied!":"Copy link"})})]}),w.jsx("div",{className:Pye,ref:s,children:d}),w.jsxs("div",{className:Dye,children:[w.jsxs("div",{className:Fye,children:[(()=>{const e=m(l);return w.jsx(Vt,{beforeOnClick:c,hashtags:Uye,title:`${e} made with Kapwing`,url:d,via:"kapwingapp",children:w.jsx(ia,{className:Mye})})})(),(()=>{const e=m(l);return w.jsx(Ut,{beforeOnClick:u,"data-cy":"facebook-share-button",quote:`${e} made with Kapwing`,url:d,children:w.jsx(sa,{className:Mye})})})()]}),w.jsxs("div",{className:Oye,onClick:()=>{const{_id:e}=r||{};t(),e&&Cye(0,"Embed")},children:[w.jsx(aa,{className:Lye})," Embed"]})]})]}):null})),Vye="ExportNotificationOptions-module_exportNotificationOptionsContainer_KS-0K",Wye="ExportNotificationOptions-module_bellIcon_5Sq-i",Gye="ExportNotificationOptions-module_bellIconRightSidebar_n65KN",Hye="ExportNotificationOptions-module_changeOption_lN9FM",$ye=_.memo((({inRightSidebar:e=!1})=>{const t=tl((e=>e.currentUser)),{muteExportCompleteNotificationSound:o}=t.user,a=o?na:ra,i=`A notification chime will${o?" not":""} play when the export finishes`,s=o?"Turn it on":"Turn it off";return w.jsxs("div",{className:Vye,children:[w.jsxs("div",{children:[w.jsx(a,{className:e?Gye:Wye}),i]}),w.jsx("div",{className:Hye,onClick:()=>function(e){const{state:t,dispatch:o}=sr(),{user:a}=t.currentUser||{};return o(rp({...a,muteExportCompleteNotificationSound:e})),a._id?Jr("/api/v1/users/updateProfile/muteExportCompleteNotificationSound",{body:{muteExportCompleteNotificationSound:e},parseJSON:!1}).then((()=>np())):new Promise((()=>{}))}(!o),children:s})]})})),Kye=["isTrimmedOnly"];class zye extends h.Component{constructor(){super(...arguments),i(this,"resetCreator",(async()=>{var e;const{currentVideo:t}=this.props;if(this.props.resetStatePreserveUser(),this.props.setOrigin("edit-in-studio"),Kye.some((e=>e in t))){if(null==(e=t.sourceVideo)?void 0:e.url){const{url:e}=t.sourceVideo,o=e.split("?",1)[0].split("/").pop(),a=await eY(e,{name:o});aY(a,{selectLayerInCreator:!1})}}else if("mp3"===t.convertOption)(async(e={})=>{const{asset:t,cmlFile:o}=await M$(e._id);Mz(t,o);const{dispatch:a}=sr();a(lS("400:400")),a({type:"SHOW_STUDIO_CANVAS"}),rE()})(t);else if(t.fullPath){const{asset:e,cmlFile:o}=await M$(t._id);Mz(e,o);const{blob_name:a}=e,i=await i2(e),s=await eY(i,{name:a,asset_id:e._id});o&&(s.cmlFileId=o.id),aY(s)}})),i(this,"resetProject",(()=>{const{resetStudio:e}=this.props;e(),Fm(ym.START_NEW_PROJECT_FROM_FINAL_VIDEO)})),i(this,"renderBackToWorkspace",(()=>{const{currentUser:e}=this.props;return w.jsx(Ft,{to:"/",onClick:this.resetProject,children:w.jsxs("div",{className:aye,children:[w.jsx(la,{className:iye}),w.jsx("span",{children:wc(e)?"Return to workspace":"Return to Kapwing"})]})})})),i(this,"renderDescription",(()=>{const{showReportIssueModal:e}=this.props,t=RU(Bl.REPORT_ISSUE);return w.jsxs("div",{className:sye,children:["Tag ",w.jsx("strong",{children:"#kapwing"})," so we can find you on social media!"," ",t&&w.jsxs("span",{children:["Any issues?"," ",w.jsx("button",{type:"button",className:nye,onClick:()=>e(),children:"Report a problem"})," ","and let us know."]})]})}))}renderOpenInStudio(){return w.jsx(Ft,{to:"/studio/editor",onClick:this.resetCreator,children:w.jsxs("button",{type:"button",className:aye,children:[w.jsx(da,{className:iye}),"Open in Studio"]})})}renderMetaData(){const e=Lfe(this.props.currentVideo),t=yye(e);return t?w.jsx("div",{className:Zfe,children:t.map((({label:e,value:t},o)=>w.jsxs("div",{className:eye,children:[w.jsx("div",{className:tye,children:`${e}:`}),w.jsx("div",{className:oye,children:t})]},o)))}):null}render(){const{currentUser:e,currentVideo:t,showEmbedModal:o,showTikTokModal:a,local_url:i,mobileCommentsView:n}=this.props;let r=!1;return s.isEmpty(t)||t.isCreator&&t.isStudio||t.editorPath&&KU.includes(t.editorPath)||(r=!0),w.jsx("div",{className:n?qfe:Jfe,"data-cy":"options-container",children:w.jsxs("div",{className:n?Qfe:Xfe,children:[w.jsx("div",{className:rye,children:w.jsx(Kie,{video:t,afterExport:this.props.afterRemoveWatermark})}),w.jsx(tse,{className:rye}),w.jsx(Bye,{showEmbedModal:o,showTikTokModal:a}),w.jsx(Iye,{local_url:i}),w.jsx("div",{className:lye,children:t.fullPath&&w.jsx(gye,{onDownload:this.props.onDownload,downloadUrl:this.props.local_url,inRightSidebar:!0,entryPoint:Oge.FINAL_VIDEO_PAGE})}),w.jsx("div",{children:(null==t?void 0:t._id)&&t.fullPath&&w.jsx(Wfe,{videoId:t._id,privacy:t.privacy,downloadUrl:t.fullPath,userHasAccess:!!t.workspaceId&&OP(t.workspaceId)})}),r?this.renderOpenInStudio():null,w.jsx("div",{className:lye,children:w.jsx(Yfe,{})}),this.renderBackToWorkspace(),w.jsx($ye,{inRightSidebar:!0}),this.renderDescription(),this.renderMetaData(),Tc(e)?w.jsx(nae,{}):null]})})}}const Yye=je(g.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,projectName:e.projectName,imageType:e.studio.imageType})),(e=>ye({setOrigin:pS,resetStatePreserveUser:Dfe,resetStudio:uD},e)))(zye));function Jye(e=!0){const{hostname:t}=window.location;return function(e,t=!0){return"localhost"===e?t?"localhost:5000":"kapwing-dev.com":e}(t,e)}function qye(e,t="c",o=!0){const{protocol:a}=window.location;return`${a}//${Jye(o)}/${t}/${e}`}function Xye(e){if(null==e||!e.length)throw new Error("Missing short code for sharing.");const{protocol:t}=window.location;return`${t}//${function(e=!0){let{hostname:t}=window.location;return"localhost"===t&&(t=e?"localhost:5000":"www.kapwing-dev.com"),t}()}/e/${e}`}const Qye="ShareEmbed-module_container_O0ZG3",Zye="ShareEmbed-module_closeContainer_UE6SZ",eve="ShareEmbed-module_title_PsHo9",tve="ShareEmbed-module_description_r6vpF",ove="ShareEmbed-module_contentContainer_6Z0uj",ave="ShareEmbed-module_copyContainer_S9hDz",ive="ShareEmbed-module_linkContainer_aD1BY",sve="ShareEmbed-module_linkText_ueJke",nve="ShareEmbed-module_copyLink_oNI9z",rve="ShareEmbed-module_optionsContainer_UdM-V";class lve extends h.Component{constructor(e){super(e),i(this,"copyTimeout"),i(this,"getEmbedText",(()=>{const{_id:e,height:t=1,width:o=1}=this.props.currentVideo||{},a=Xye(e),i=t/o*100;let s=`height: 0; padding-bottom: ${`calc(${i.toFixed(2)}%)`}; position:relative; width: 100%;`;if(i>100){const e=300;s=`height: ${(e*t/o).toFixed(2)}px; width: ${e.toFixed(2)}px; position:relative;`}return`<div style="${s}">${`<iframe allow="autoplay; gyroscope;" allowfullscreen height="100%" referrerpolicy="strict-origin" src="${a}" style="border:0; height:100%; left:0; overflow:hidden; position:absolute; top:0; width:100%" title="Embedded content made on Kapwing" width="100%"></iframe>`}</div><p style="font-size: 12px; text-align: right;">Video edited on <a href="https://www.kapwing.com/video-editor">Kapwing</a></p>`})),i(this,"onCopied",(()=>{this.setState({copiedEmbed:!0}),setTimeout((()=>this.setState({copiedEmbed:!1})),3e3)})),i(this,"onClickCopyContent",(e=>{e.target.setSelectionRange(0,e.target.value.length)})),i(this,"renderClose",(()=>w.jsx("div",{className:Zye,children:w.jsx(ve,{onClick:this.props.hideOverlay})}))),this.state={copiedEmbed:!1}}componentWillUnmount(){this.copyTimeout&&clearTimeout(this.copyTimeout)}renderCopyEmbed(){const{copiedEmbed:e}=this.state,t=this.getEmbedText();return w.jsx("div",{className:ave,children:w.jsxs("div",{className:ive,children:[w.jsx("textarea",{className:sve,id:"embed-text",onClick:this.onClickCopyContent,value:t,readOnly:!0}),w.jsx("div",{className:rve,children:w.jsx(ca,{className:nve,"data-clipboard-target":"#embed-text",onSuccess:this.onCopied,children:e?"Copied!":"Copy"})})]})})}renderContent(){return w.jsx("div",{className:ove,children:this.renderCopyEmbed()})}renderDescription(){return w.jsx("div",{className:tve,children:"Copy and paste the following code into your website or blog to embed this video."})}render(){return w.jsxs("div",{className:Qye,children:[this.renderClose(),w.jsx("div",{className:eve,children:"Embed Content"}),this.renderDescription(),this.renderContent()]})}}const dve=g.connect((e=>({currentVideo:e.currentVideo})))(lve),cve="ShareLink-module_container_45cOO",uve="ShareLink-module_loadingContainer_SEZGJ",mve="ShareLink-module_loader_2ehy3",pve="ShareLink-module_closeContainer_6WCvs",hve="ShareLink-module_title_WPALv",gve="ShareLink-module_contentContainer_OZc9b",fve="ShareLink-module_linkContainer_NGdcl",yve="ShareLink-module_linkText_ifgbp",vve="ShareLink-module_copyLink_j-lXz";class _ve extends h.Component{constructor(e){super(e),i(this,"copyTimeout"),i(this,"getShortLink",(()=>{const{currentVideo:e}=this.props,{code:t}=e||{};try{return qye(t)}catch(o){return mh({description:"Failed to get share link",error:o}),"n/a"}})),i(this,"onCopied",(()=>{this.setState({copiedShortLink:!0}),setTimeout((()=>this.setState({copiedShortLink:!1})),3e3)})),i(this,"onClickLink",(e=>{e.target.setSelectionRange(0,e.target.value.length)})),i(this,"renderClose",(()=>w.jsx("div",{className:pve,children:w.jsx(ve,{onClick:this.props.hideOverlay})}))),this.state={copiedShortLink:!1}}componentWillUnmount(){this.copyTimeout&&clearTimeout(this.copyTimeout)}renderShortLink(){const{copiedShortLink:e}=this.state;return w.jsx("div",{children:w.jsxs("div",{className:fve,children:[w.jsx("input",{className:yve,id:"short-link",onClick:this.onClickLink,readOnly:!0,value:this.getShortLink()}),w.jsx(ca,{className:vve,"data-clipboard-target":"#short-link",onSuccess:this.onCopied,children:e?"Copied":"Copy"})]})})}renderContent(){return w.jsx("div",{className:gve,children:this.renderShortLink()})}render(){const{code:e}=this.props.currentVideo||{};return null==e?w.jsxs("div",{className:uve,children:[this.renderClose(),w.jsx("div",{className:mve,children:w.jsx(MU,{})})]}):w.jsxs("div",{className:cve,children:[this.renderClose(),w.jsx("div",{className:hve,children:"Share a link"}),this.renderContent()]})}}const wve=g.connect((e=>({currentVideo:e.currentVideo})))(_ve),bve="VideoPlayer-module_videoPlayerContainer_-xB76",Tve="VideoPlayer-module_videoPlayerLandscape_tQRnz",xve="VideoPlayer-module_videoPlayerPortrait_LNLpK",Sve="VideoPlayer-module_videoPlayerImage_HfG6k",Eve={color:"#eee",fontWeight:600},Ive=_.memo((({autoPlay:e=!0,currentVideo:t,local_url:o,loop:a=!1,maxHeight:i,maxWidth:s,minHeight:n,muted:r=!1,showControls:l=!0,setCurrentVideoRef:d})=>{const{isProjectFetched:c}=tl((e=>({isProjectFetched:e.studioLocal.isProjectFetched})),g.shallowEqual),[u,m]=h.useState(!0),[p,f]=h.useState(!1),y=h.useRef(null),[v,_]=h.useState(!1),b=h.useRef(""),T=ua(),x=be(),S={};i&&(S.maxHeight=600,S.height="100%"),s&&(S.maxWidth=600,S.width="100%");const E=Tm(t.fullPath);h.useEffect((()=>{y.current&&(null==d||d(y))}),[p,d]);return h.useEffect((()=>{if(t._id===T.id){if(b.current.startsWith("blob:"))return;b.current=k0(t,"fullPath"),m(!1)}}),[t,c,T.id]),u?w.jsx(MU,{text:"Getting url...",textStyles:Eve}):w.jsx("div",{className:bve,children:"image"===E||"gif"===E||t.isImage?(()=>{const e={};return n&&(e.minHeight=n),w.jsx("img",{alt:"Final",src:o||k0(t,"fullPath"),style:e,className:Sve,"data-cy":"final-image",loading:"lazy",onError:()=>Fm(ym.ACCESS_EXPIRED_EXPORT,{"Video ID":t._id,"Entry Point":Oge.FINAL_VIDEO_PAGE})})})():w.jsx("video",{id:"final-video","data-cy":"final-video",onLoadedMetadata:()=>{if(console.debug("onloadedmetadata"),!y.current)return;if(!("videoWidth"in y.current))return;const{videoWidth:e,videoHeight:t}=y.current;t>e&&_(!0);if("true"===new URLSearchParams(x.search).get(Rie.COMMENT)){const e=sh.get("VIDEO_TIME_BEFORE_SIGN_IN",{disabled:0});e&&(y.current.currentTime=Number(e),console.debug("about to remove video time",e),sh.remove("VIDEO_TIME_BEFORE_SIGN_IN"))}},ref:e=>{y.current=e,f(!0)},autoPlay:e,className:(()=>{let e="";return e+=v?` ${xve}`:` ${Tve}`,e})(),controls:l,loop:a,muted:r,playsInline:!0,preload:"auto",src:t.fullPath,style:S,controlsList:"nodownload",onError:()=>Fm(ym.ACCESS_EXPIRED_EXPORT,{"Video ID":t._id,"Entry Point":Oge.FINAL_VIDEO_PAGE})})})}));var Cve=(e=>(e.DOWNLOAD="download",e))(Cve||{});const kve="VideoProgress-module_proBadge_qakM6",Ave="VideoProgress-module_videoProgressWrapper_4WpNs",jve="VideoProgress-module_videoProgressContainer_2sVh-",Nve="VideoProgress-module_videoProgressBg_1HUcb",Rve="VideoProgress-module_videoBgThumbnail_QotEq",Pve="VideoProgress-module_progressOverlay_M1ceQ",Dve="VideoProgress-module_topProcessingText_DmGha",Ove="VideoProgress-module_bottomProcessingText_-Pxhc",Lve="VideoProgress-module_processingTextLine_pfrZA",Fve="VideoProgress-module_processingLink_7aBM-",Mve="VideoProgress-module_processingTextHeader_W0LFH",Uve="VideoProgress-module_progressContainer_N-Mj3",Bve="VideoProgress-module_progressPercentage_f9MN5",Vve="VideoProgress-module_progressBarWrapper_yMpGY",Wve="VideoProgress-module_checkmark_fhTPm",Gve="VideoProgress-module_progressBar_tuAUp",Hve="VideoProgress-module_errorIcon_Eubye",$ve="VideoProgress-module_videoErrorContainer_-sGRX",Kve="VideoProgress-module_videoErrorTop_Bd83q",zve="VideoProgress-module_videoErrorBottom_ZmGDY",Yve="VideoProgress-module_videoErrorContainerRight_QwZPY",Jve="VideoProgress-module_videoErrorHeader_HDthA",qve="VideoProgress-module_videoErrorDescription_ynvFj",Xve="VideoProgress-module_errorButtonContainer_m6sy6",Qve="VideoProgress-module_studioBackButton_J-tLG",Zve="VideoProgress-module_reportProblemButton_WAGD-",e_e="VideoProgress-module_progressInfo_77uL2",t_e=e=>{const{progressDict:t}=e,{stageNum:o,numStages:a,stagePercentage:i,stageName:s}=t,n=o/a*100-100/a+i/100*(100/a);return w.jsx("div",{className:Vve,children:w.jsxs(w.Fragment,{children:[w.jsx("div",{className:Bve,style:{marginLeft:"clamp(2%, 3%, 87%)",width:`clamp(2%, ${n}%, 95%)`,minWidth:220},children:w.jsxs("div",{className:e_e,children:[w.jsxs("div",{children:["Stage ",w.jsx("span",{children:o||1})," of"," ",w.jsx("span",{children:a||1}),": ",w.jsx("span",{children:s||""})]}),w.jsxs("div",{children:[w.jsx("span",{translate:"no",children:Math.min(99,Math.ceil(i)||51)}),"% complete"]})]})}),w.jsx("div",{className:Uve,id:"progress-container",children:w.jsx("div",{className:Gve,style:{display:"block",width:`${n}%`,height:"100%"}})})]})})},o_e={maxWidth:550,fontSize:"large"},a_e={maxWidth:"250px"},i_e=je((({currentVideo:e,currentUser:t,currentFolderId:o,thumbnailUrl:a,onFirstProgressLoad:i,onFinishedVideo:s,match:n})=>{const r=il(),[l,d]=h.useState(null),[c,u]=h.useState(!1),[m,p]=h.useState(!1),g=h.useRef(e.pendingProcessOnClient),f=h.useRef(null),y=h.useRef(!1),v=ou(),_=NU(Bl.FAST_EXPORT),b=["Loading ...","Initializing servers ...","Setting up connection ...","Getting your export ready ...","Reaching server ...","Checking settings ...","mp3"===e.videoType?"Arranging bits ... ":"Lining up pixels ..."];let T=0;const[x,S]=h.useState(b[T]||"Loading ..."),E=cE((t=>{e._id===n.params.id&&e.clientSideProcessingInProgress&&(t.preventDefault(),t.returnValue="Are you sure you want to leave the page? Your current progress will be lost.")})),I=h.useCallback((()=>{f.current&&clearInterval(f.current),f.current=null}),[]),C=cE((async()=>{if(e._id&&y.current){S(b[T%b.length]||"Loading ..."),T+=1;try{const o=await(t=e._id,Yr(`/api/v1/videos/${t}/progress`,{params:{id:t}}));if(j(o))return s(),u(!0),void I();if(o.hasError)return s(),p(!0),void I();if(o.done)return I(),d({stageNum:5,numStages:5,stagePercentage:100,stageName:"Upload"}),void(await A());if(console.debug("Checking progress!"),o.progressDict){l||i();const e=JSON.parse(o.progressDict);d({...e})}}catch(o){console.error(o)}var t}})),k=h.useCallback((()=>{I(),f.current=window.setInterval(C,3500)}),[C,I]);h.useEffect((function(){return y.current=!0,e.local_url||k(),window.addEventListener("beforeunload",E),()=>{I(),window.removeEventListener("beforeunload",E),y.current=!1}}),[k,I,e.local_url,E]),h.useEffect((function(){!e.pendingProcessOnClient&&g.current&&k()}),[k,e.pendingProcessOnClient,l]);const A=async()=>{I();try{await AD({id:e._id,preserveId:!0}),s()}catch(t){if(t&&"object"==typeof t&&"statusCode"in t&&"number"==typeof t.statusCode&&[403,404,410].includes(t.statusCode)){const{message:e}=ph(t);r(wl({description:e,type:"error"}))}else k()}},j=t=>{var o,a;if(!t.hasError||!e.isCreator)return!1;if(t.explainedErrorKind===Cve.DOWNLOAD){if(null==(a=null==(o=t.explainedErrorParams)?void 0:o.layer_ids)?void 0:a.length){const o=tC(e.scenes??[],t.explainedErrorParams.layer_ids);if(o.length)return Y$(o,!1),!0}return!1}return!1};return w.jsx("div",{className:Ave,children:w.jsxs("div",{className:jve,"data-cy":"video-progress-container",children:[w.jsx("div",{className:Nve,children:a&&w.jsx("img",{className:Rve,src:a,alt:"Project thumbnail"})}),w.jsxs("div",{className:Pve,children:[w.jsxs("div",{className:Dve,children:[!wc(t)&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:Mve,children:"Just a minute..."}),w.jsx("div",{className:Lve,children:"Your content is being exported and will appear here automatically when complete."})]}),v.type===Cl.Pro&&w.jsx("div",{className:kve,children:"PRO"}),_&&w.jsxs("div",{className:Lve,children:[w.jsx(Wo,{className:Wve}),"Fast processing"]}),!e.watermark&&w.jsxs("div",{className:Lve,children:[w.jsx(Wo,{className:Wve}),"Watermark-free"]})]}),(()=>{if(e.clientSideProcessingInProgress)return w.jsx(MU,{text:"Hang tight.",secondaryText:"Please don't refresh or close this tab.",textStyles:o_e,wrapperStyles:a_e});if(c||m){const t=c?"Looks like there's an invalid layer.":"Oops, an error occurred with your video.",o=c?" There was an issue fully downloading one of your provided media files. Go back to Studio to remove the layer and try re-exporting.":"";return w.jsxs("div",{className:$ve,children:[w.jsxs("div",{className:Kve,children:[w.jsx("div",{children:w.jsx(pa,{className:Hve})}),w.jsxs("div",{className:Yve,children:[w.jsx("div",{className:Jve,children:t}),w.jsx("div",{className:qve,children:o})]})]}),w.jsxs("div",{className:zve,children:[w.jsx("a",{href:"https://www.kapwing.com/help/export-troubleshooting-tips/",target:"_blank",rel:"noopener noreferrer",children:w.jsx("div",{className:Xve,children:w.jsx("div",{className:Zve,children:"Video Troubleshooting"})})}),c&&w.jsx("div",{className:Xve,children:w.jsx(Ft,{to:`/editor/videos/${e._id}`,children:w.jsx("div",{className:Qve,children:"Back to Studio"})})})]})]})}return l?w.jsx(t_e,{progressDict:l}):w.jsx(MU,{textStyles:o_e,text:x})})(),w.jsx("div",{className:Ove,children:wc(t)&&o&&!e.clientSideProcessingInProgress?w.jsxs("div",{className:Lve,children:["This content will be saved to your"," ",w.jsx(Ft,{className:Fve,to:`/folder/${o}`,children:"Workspace"}),"."]}):w.jsxs("div",{className:Lve,children:["Want to learn more about editing on Kapwing? Check out the Kapwing"," ",w.jsx("a",{className:Fve,href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1",target:"blank",rel:"noopener noreferrer",children:"Youtube Channel"})," ",w.jsx(ma,{})]})})]})]})})})),s_e="ReportIssueModal-module_prompt_5DH6w",n_e="ReportIssueModal-module_issueSelect_SN3dt",r_e="ReportIssueModal-module_commentArea_Eih4Q",l_e="ReportIssueModal-module_emailInput_ddkLa",d_e=["Can’t download or play video.","Wrong duration or timing issues.","Text size, position or appearance is wrong.","Audio is missing or is out of sync.","Quality or resolution of output isn’t correct.","Image, shape or video position/appearance is wrong.","Can’t upload media.","Issue saving work or progress.","Layers (e.g. image, video, text, subtitles) are missing.","Subscription or billing issue.","Sharing or managing a Team.","Issues with our Brand Kit.","Finding a project.","Other"],c_e=g.connect((e=>({state:e,currentUser:e.currentUser,currentVideo:e.currentVideo})),(e=>ye({showToast:wl},e))),u_e=h.memo(c_e((({hide:e,currentUser:t,state:o,currentVideo:a,videoId:i,showToast:s,fromVideoProgress:n=!1,fromWorkspace:r})=>{var l,d;const{currentFolderId:c}=tl((e=>({currentFolderId:e.workspaces.selectedWorkspace})),ol),{user:u}=t,m=Ac(),p=ou(),g=nK(o,!1),[f,y]=h.useState(""),[v,_]=h.useState(""),[b,T]=h.useState(""),[x,S]=h.useState(!1),E=null==(l=null==a?void 0:a.build)?void 0:l.canaryCluster,I=h.useCallback((async()=>{var o;S(!0);const l={selectedIssue:f,comment:v,email:b,fromVideoProgress:n,pageURL:window.location.href,currentUser:t,snapshotVideo:g,teamId:m._id,currentFolderId:c},d=(null==u?void 0:u.email)??b;try{Fm(ym.REPORT_A_PROBLEM,{Email:d,"Signed In":!!u,"Pro User":p.isPaid&&!(p instanceof Jc),"Video ID":i,"Link to Video":`kapwing.com/videos/${i}`,"Video Finished":a.done,"Video Build Error":null==(o=a.build)?void 0:o.error,"Error Reason":f,Details:v,Timestamp:(new Date).toISOString(),"From Video Progress":n,"Run On Canary":E,"Current Plan":m.planTier,"Folder ID":c}),r?await Jr("/api/v1/videos/reportProblem",{body:l}):await Jr(`/api/v1/videos/${i}/reportProblem`,{body:l}),s({description:"This issue has been logged and our team will look into it. We’ll follow up with you at the email address associated with your account.",link:{text:"Read our Video Processing FAQ for troubleshooting advice.",href:"https://www.kapwing.com/help/video-processing-faq/"},type:"success"})}catch(IGe){mh({description:"Failed to submit report",error:IGe})}e()}),[E,v,c,p,m._id,m.planTier,t,null==(d=a.build)?void 0:d.error,a.done,b,n,r,e,f,s,g,u,i]),C=f&&((null==u?void 0:u._id)||b.includes("@"))&&!x&&v.length>0,k=h.useMemo((()=>({confirmFn:I,disabled:!C,confirmText:"Submit"})),[I,C]);return w.jsxs(nM,{unsetCancelModal:x?void 0:e,confirmButtonOptions:k,children:[w.jsx(nM.Header,{children:"Report a Problem"}),w.jsxs("label",{className:s_e,children:["What went wrong?",w.jsxs("select",{className:n_e,value:f,onChange:e=>y(e.target.value),children:[w.jsx("option",{value:"",children:"Select an Issue"}),d_e.map((e=>w.jsx("option",{value:e,children:e},e)))]})]}),!(null==u?void 0:u._id)&&w.jsxs("label",{className:s_e,children:["Email",w.jsx("input",{className:l_e,type:"email",value:b,onChange:e=>T(e.target.value)})]}),w.jsxs("label",{className:s_e,children:["Details",w.jsx("textarea",{value:v,onChange:e=>_(e.target.value),placeholder:"Please add as much information (including any steps we can use to reproduce your issue) as possible.",className:r_e})]})]})}))),m_e="ShareTikTok-module_container_AJ3Xd",p_e="ShareTikTok-module_closeContainer_3ozxp",h_e="ShareTikTok-module_contentContainer_Lucoi",g_e="ShareTikTok-module_title_EdbbH",f_e="ShareTikTok-module_icon_eH2VA",y_e="ShareTikTok-module_context_sFzTX",v_e="ShareTikTok-module_button_UKE07",__e=_.memo((({hideOverlay:e})=>{let t;const o=()=>{const{location:{protocol:e,host:o,pathname:a}={}}=window;t=`${e}//${o}${a}${(null==a?void 0:a.endsWith("/"))?"":"/"}logintiktok`,window.location.href=t};return w.jsxs("div",{className:m_e,children:[w.jsx("img",{src:"https://i.imgur.com/Axk8BiL.png",alt:"Kapwing and TikTok"}),w.jsx("div",{className:p_e,children:w.jsx(ve,{onClick:e})}),w.jsxs("div",{className:h_e,children:[w.jsx("div",{className:g_e,children:"Share to TikTok"}),w.jsx("div",{className:y_e,children:"After clicking the share button you will be redirected to TikTok's website, where you will be prompted to sign in and then authorize Kapwing to share videos for you. Then, you will be able to complete sharing from the TikTok app."}),w.jsxs("button",{type:"button",className:v_e,onClick:o,children:[w.jsx(go,{className:f_e})," Share to TikTok"]})]})]})})),w_e="FollowUsOnTwitter-module_container_L8NU6",b_e="FollowUsOnTwitter-module_closeContainer_TvtZD",T_e="FollowUsOnTwitter-module_contentContainer_bexQN",x_e="FollowUsOnTwitter-module_title_9CFvO",S_e="FollowUsOnTwitter-module_icon_e1CLr",E_e="FollowUsOnTwitter-module_context_cVGau",I_e="FollowUsOnTwitter-module_twitterButton_gMTFv",C_e="FollowUsOnTwitter-module_followButton_hUy9P",k_e=_.memo((({hideOverlay:e})=>{h.useEffect((()=>{const e=document.createElement("script");e.src="https://platform.twitter.com/widgets.js",e.charset="utf-8",document.body.appendChild(e)}),[]);return w.jsxs("div",{className:w_e,children:[w.jsx("div",{className:b_e,children:w.jsx(ve,{onClick:e})}),w.jsxs("div",{className:x_e,children:[w.jsx(ha,{className:S_e})," Your download has started!"]}),w.jsx("div",{className:T_e,children:w.jsxs(w.Fragment,{children:[w.jsx("div",{className:E_e,children:"Your content has started downloading. Please check your downloads folder for your exported file."}),w.jsx("div",{className:E_e,children:"We'd love to connect with you on social media. Follow us to get the latest information on product changes, feature updates, and social media trends."}),w.jsx("div",{className:C_e,children:w.jsx("a",{href:"https://twitter.com/KapwingApp?ref_src=twsrc%5Etfw",className:`twitter-follow-button ${I_e}`,"data-size":"large","data-show-count":"false",children:"Follow @KapwingApp"})})]})})]})})),A_e="CommentSection-module_commentSection_XqVp7",j_e="CommentSection-module_mobileCommentSection_E-5Ff",N_e="CommentSection-module_studioCommentSection_LLY3e",R_e="CommentSection-module_commentsTitle_-tDSv",P_e="CommentSection-module_emptyCommentMessage_mT1aX",D_e="CommentSection-module_commentsContent_RqN-c",O_e="CommentSection-module_selectedCommentsContent_YCFF0",L_e="CommentSection-module_videoCommentsContent_JFT65",F_e="CommentSection-module_videoCommentSection_JM301",M_e="CommentSection-module_commentPostContainer_plgkT",U_e="CommentSection-module_selectedCommentPostContainer_6B-Kb",B_e="CommentSection-module_commentThreadContainer_bsn99",V_e="CommentSection-module_fillMaxHeight_dz4SB",W_e="CommentSection-module_signInLink_BFHBN",G_e="CommentSection-module_emptyCommentContainer_-kuet",H_e={container:"Checkbox-module_container_c3Bcr",checkboxContainer:"Checkbox-module_checkboxContainer_Ar3UK",studioTheme:"Checkbox-module_studioTheme_2m7-h",workspaceTheme:"Checkbox-module_workspaceTheme_M5n9f",label:"Checkbox-module_label_WMgyx",studioLabel:"Checkbox-module_studioLabel_wP3yK",workspaceLabel:"Checkbox-module_workspaceLabel_1mi6k",preventSelect:"Checkbox-module_preventSelect_SJeg0"},$_e=_.memo((({label:e,labelSize:t,checked:o,onChange:a,disabled:i,color:s})=>{const n=h.useMemo((()=>({opacity:o?1:0})),[o]);return w.jsxs("div",{className:`${H_e.container} ${H_e.preventSelect}`,onClick:()=>!i&&a(!o),style:{opacity:i?.5:1},children:[w.jsx("div",{className:`${H_e.checkboxContainer} ${H_e[`${s}Theme`]}`,children:w.jsx(wt,{size:16,style:n})}),w.jsx("div",{className:`${H_e.label} ${H_e[`${s}Label`]}`,style:{fontSize:`${t||11}px`},children:e})]})})),K_e="Timestamp-module_timestamp_3o0bP",z_e="Timestamp-module_staticTimestamp_taL8V",Y_e="Timestamp-module_timestampContainer_ticJR",J_e="Timestamp-module_timestampEditableContainer_1-9nG",q_e="Timestamp-module_staticTimestampInEditContainer_eQIjO",X_e="Timestamp-module_disabledTimestampContainer_EPdfn",Q_e="Timestamp-module_staticTimestampContainer_4ufKX",Z_e="Timestamp-module_timestampEditable_pOXSY",ewe=_.memo((({videoTimestamp:e,isEditable:t,maxTime:o,disabled:a,inEditModeComment:i,seekOnCurrentVideo:s})=>{const{hours:n,minutes:r,seconds:l}=(e=>{let t=e;const o=Math.floor(t/3600);return t%=3600,{hours:o,minutes:Math.floor(t/60),seconds:Math.floor(t%60)}})(e),d=e=>{e.target.type="text",e.target.setSelectionRange(0,e.target.value.length),e.target.type="number"},c=(e,t)=>{const a=parseInt(e.target.value),i=("seconds"===t?a:l)+60*("minutes"===t?a:r)+3600*("hours"===t?a:n),d=Math.min(i,o);s(d)};return t?w.jsxs("div",{className:`${J_e} ${a?X_e:""}`,"data-cy":"comment-post-timestamp",children:[!!n&&w.jsxs(w.Fragment,{children:[w.jsx("input",{className:Z_e,type:"number",name:"hours",value:n.toString().padStart(2,"0"),placeholder:n.toString(),onFocus:d,onChange:e=>c(e,"hours"),"data-cy":"comment-post-timestamp-hours"}),w.jsx("span",{className:K_e,children:":"})]}),w.jsx("input",{className:Z_e,type:"number",name:"minutes",value:r.toString().padStart(2,"0"),placeholder:r.toString(),onFocus:d,onChange:e=>c(e,"minutes"),"data-cy":"comment-post-timestamp-seconds"}),w.jsx("span",{className:K_e,children:":"}),w.jsx("input",{className:Z_e,type:"number",name:"seconds",value:l.toString().padStart(2,"0"),placeholder:l.toString(),onFocus:d,onChange:e=>c(e,"seconds"),"data-cy":"comment-post-timestamp-seconds"})]}):w.jsx("div",{className:`${Y_e} ${i?q_e:Q_e} ${a?X_e:""}`,onClick:t=>{t.stopPropagation(),s(e)},children:w.jsxs("div",{className:z_e,children:[!!n&&`${n.toString().padStart(2,"0")}:`,r.toString().padStart(2,"0"),":",l.toString().padStart(2,"0")]})})})),twe="CommentPost-module_commentPostContainer_vy9lg",owe="CommentPost-module_replyPostContainer_GEP9e",awe="CommentPost-module_commentPostRow_FpBer",iwe="CommentPost-module_commentPostRow2_-0CaE",swe="CommentPost-module_commentPostContainerInputFocused_xa4qj",nwe="CommentPost-module_timeStampAndInputContainer_qRvs7",rwe="CommentPost-module_postTextBox_xlPKW",lwe="CommentPost-module_disabledPostTextBox_mexvv",dwe="CommentPost-module_postTextBoxWithTimestamp_MJanO",cwe="CommentPost-module_postTextBoxWithLongTimestamp_sob2Y",uwe="CommentPost-module_checkboxContainer_ZEcpy",mwe="CommentPost-module_postButton_A5lUy",pwe="CommentPost-module_disabledPostButton_Y0gkn",hwe="CommentPost-module_inlinePostButton_6u0CQ",gwe="CommentPost-module_invisibleTranslatablePlaceholder_eNauQ",fwe="CommentPost-module_mobilePostTextBox_o-q1u",ywe=_.memo((({currentVideoTime:e,userCanPostComment:t,maxTime:o,disabled:a,mobileView:i,replyPost:s,onPostSuccess:n,location:r,seekOnCurrentVideo:l,commentContainerRef:d,inputBoxRef:c,setCommentFromLocalStorage:u,handleSignInToComment:m})=>{var p;const{selectedCommentParentId:g,currentVideo:f,currentUser:y}=tl((e=>{const{selectedCommentId:t,comments:o}=e.comments;return{selectedCommentParentId:fye(o,t),currentVideo:e.currentVideo,currentUser:e.currentUser}}),ol),v=s?g:void 0,[_,b]=h.useState(!1),[T,x]=h.useState(!1),[S,E]=h.useState(!1),[I,C]=h.useState(!s),k=h.useRef(null),A=il(),j=be(),N=a||!S||T;h.useEffect((function(){"true"===new URLSearchParams(j.search).get(Rie.COMMENT)&&c.current&&(u(),E(!!c.current.innerText.trim()))}),[c,j.search,u]);const R=async()=>{if(!wc(y))return void m(!1);x(!0);const t=c.current.innerText.trim();if(!t)return void A(wl({description:"Please enter a comment.",type:"error"}));const o=f._id;if(o){try{const a={content:t,videoTime:I?e:void 0,submittedAt:f.submittedAt,location:r,parentId:v},s=await Jr(`/api/v1/videos/${o}/addComment`,{body:a});tp(v?"reply":"new comment",r,{includeTimestamp:I,teamId:f.teamId,creatorId:f.creatorId}),i&&c.current&&c.current.blur(),A(eT(s.newComment)),null==n||n(),v&&A(Xb(s.newComment._id))}catch(IGe){mh({description:"Failed to post comment.",error:IGe})}c.current&&(c.current.innerText="",E(!1)),x(!1)}else A(wl({description:"There was an error with getting the id of the current video.",type:"error"}))};let P=v?"Type your reply":"Add a comment...";t?a&&(P="Exporting in progress... you can leave a comment after the export is complete"):P="Sign in to comment.";const D=h.useCallback((()=>{c.current.blur(),m(!0,ym.INPUT_CLICK)}),[m,c]),O=h.useCallback((()=>{!i&&!s||t?C(!I):D()}),[D,I,i,s,t]),L=[];L.push([!a&&t?rwe:lwe]),void 0!==e&&I&&(e>=3600?L.push(cwe):L.push(dwe)),i&&L.push(fwe);const F=w.jsx("div",{className:N?pwe:mwe,"data-cy":"comment-post-button","data-testid":"comment-post-button",onClick:R,children:s?"Reply":"Comment"});return w.jsxs("div",{className:`${s?owe:twe} ${i&&_?swe:""}`,ref:e=>{if(e&&s){if(!d.current)return;const t=d.current.getBoundingClientRect(),o=e.getBoundingClientRect();(o.bottom>t.bottom||o.top<t.top)&&e.scrollIntoView({block:"end",behavior:"smooth"})}},"data-cy":s?"comment-reply-box":"comment-post-box",children:[w.jsx("div",{className:gwe,ref:k,translate:"yes",children:P}),w.jsxs("div",{className:awe,children:[w.jsxs("div",{className:nwe,children:[void 0!==e&&I&&w.jsx(ewe,{videoTimestamp:e,isEditable:!a,maxTime:o,seekOnCurrentVideo:l},"commentTimeStamp"),w.jsx("div",{className:L.join(" "),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),R())},onKeyUp:e=>{const t=e.target.innerText||"";E(!!t.trim().length)},onBlur:e=>{e.target.innerText.trim().length||(e.target.innerText=""),i&&b(!1)},onClick:()=>{!i&&!s||t?_V(ym.INPUT_CLICK):D()},ref:c,"data-placeholder":(null==(p=k.current)?void 0:p.textContent)||P,contentEditable:!a,onPaste:e=>{a||vye(e)},"data-cy":"comments-input-field","data-testid":"comments-input-field"})]}),(void 0===e||s)&&w.jsx("div",{className:hwe,children:F})]}),void 0!==e&&!s&&w.jsxs("div",{className:iwe,children:[w.jsx("div",{className:uwe,children:w.jsx($_e,{disabled:a,label:"Include timestamp",checked:I,onChange:O})}),F]})]})})),vwe="CommentElement-module_commentContainer_qXF8U",_we="CommentElement-module_selectedCommentContainer_KqbuK",wwe="CommentElement-module_commentLeft_qF9o1",bwe="CommentElement-module_commentRight_hHv6N",Twe="CommentElement-module_threadParentComment_du-w2",xwe="CommentElement-module_childCommentContainer_l-gVR",Swe="CommentElement-module_commentHeader_J1VYT",Ewe="CommentElement-module_timestampAndCommentContainer_grCab",Iwe="CommentElement-module_editingTimestampAndCommentContainer_tm4X5",Cwe="CommentElement-module_commentContent_z4IMo",kwe="CommentElement-module_userNameContainer_caHek",Awe="CommentElement-module_userName_EWcnK",jwe="CommentElement-module_profilePic_8p5FX",Nwe="CommentElement-module_dateText_ia47-",Rwe="CommentElement-module_line_rv4CL",Pwe="MoreOptions-module_moreOptions_93QzE",Dwe="MoreOptions-module_moreOptionsIcon_VVJh9",Owe="MoreOptions-module_buttonContainer_oRiF2",Lwe="MoreOptions-module_buttonLabel_SLQvg",Fwe="MoreOptions-module_buttonText_gVjm9",Mwe="MoreOptions-module_buttonIcon_hjLoZ",Uwe=_.memo((({handleEditing:e,handleDeleteComment:t,handleReply:o})=>{const[a,i]=h.useState(!1),s=h.useRef(null),n=h.useRef(null),r=e=>{e.stopPropagation(),i((e=>!e))},l=h.useCallback((e=>{r(e)}),[]);return h.useEffect((function(){const e=e=>{var t,o;(null==(t=n.current)?void 0:t.contains(e.target))||(null==(o=s.current)?void 0:o.contains(e.target))||i(!1)};if(a)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[a]),w.jsxs("div",{ref:s,className:Pwe,children:[w.jsx(ga,{className:Dwe,onClick:l,"data-cy":"comment-options-toggle"}),a&&s.current&&w.jsxs("div",{className:Owe,ref:e=>{null==e||e.scrollIntoView({block:"nearest"}),n.current=e},children:[t&&w.jsxs("div",{className:Lwe,onClick:e=>{r(e),t()},"data-cy":"delete-comment-button",children:[w.jsx(fa,{className:Mwe}),w.jsx("span",{className:Fwe,children:"Delete"})]}),e&&w.jsxs("div",{className:Lwe,onClick:t=>{r(t),e()},"data-cy":"edit-comment-button",children:[w.jsx(ya,{className:Mwe}),w.jsx("span",{className:Fwe,children:"Edit"})]}),o&&w.jsxs("div",{className:Lwe,onClick:e=>{r(e),o()},"data-cy":"reply-comment-button",children:[w.jsx(va,{className:Mwe}),w.jsx("span",{className:Fwe,children:"Reply"})]})]})]})})),Bwe="CommentEdit-module_editTextBox_gMXmK",Vwe="CommentEdit-module_editTextBoxLongTimestamp_Q3wjB",Wwe="CommentEdit-module_editButtonsContainer_G8-tI",Gwe="CommentEdit-module_saveButton_S69Q6",Hwe="CommentEdit-module_cancelButton_6FJFJ",$we="CommentEdit-module_buttonText_IFvqV",Kwe="CommentEdit-module_disabledSaveButton_6SVDO",zwe=_.memo((({comment:e,setEditMode:t,location:o})=>{const a=il(),i=h.useRef(!1),[s,n]=h.useState(e.content);async function r(){try{await qr(`/api/v1/comments/${e._id}`,{body:{content:s}}),tp("edited comment",o),a(tT({commentId:e._id,updates:{content:s}})),t(!1)}catch(IGe){mh({description:"Failed to edit the comment",error:IGe})}}const l=s.trim().length>0;return w.jsxs(w.Fragment,{children:[w.jsx("div",{className:`${Bwe} ${(e.videoTime||0)>=3600?Vwe:""}`,onKeyUp:e=>{n(e.target.innerText)},onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),r())},ref:e=>{if(e&&i.current){null==e||e.focus();const t=document.createRange();t.selectNodeContents(e),t.collapse(!1);const o=window.getSelection();o&&(o.removeAllRanges(),o.addRange(t)),i.current=!1}},onPaste:vye,contentEditable:!0,suppressContentEditableWarning:!0,children:e.content}),w.jsxs("div",{className:Wwe,ref:e=>{null==e||e.scrollIntoView({block:"nearest",behavior:"smooth"})},children:[w.jsx("button",{className:Hwe,type:"submit",onClick:o=>{o.stopPropagation(),n(e.content),t(!1)},children:w.jsx("span",{className:$we,children:"Cancel"})}),w.jsx("button",{className:`${Gwe} ${l?"":Kwe}`,type:"submit",disabled:!l,onClick:e=>{e.stopPropagation(),l&&r()},children:w.jsx("span",{className:$we,children:"Save"})})]})]})})),Ywe="DeleteCommentDialog-module_deleteDialogContainer_jUz0E",Jwe="DeleteCommentDialog-module_header_c-s1v",qwe="DeleteCommentDialog-module_description_Ioldc",Xwe="DeleteCommentDialog-module_buttonsContainer_yJ-Vf",Qwe={color:"black"},Zwe=_.memo((({onDelete:e,hideDelete:t,hasReplies:o})=>{const[a,i]=h.useState(!1),s=h.useCallback((async()=>{i(!0),e(),i(!1),t()}),[t,e]);let n="Delete Comment",r="Are you sure you want to delete this comment?";return o&&(n+=" Thread",r+=" Deleting this comment will delete all replies in the thread."),w.jsx(nM,{unsetCancelModal:t,overlayContainerSmaller:!0,usePortal:!0,children:w.jsxs("div",{className:Ywe,children:[w.jsx("div",{className:Jwe,children:n}),w.jsx("div",{className:qwe,children:r}),w.jsx("div",{className:Xwe,children:w.jsx(GF,{cancelFn:t,confirmFn:s,loadingMsg:a?"Deleting...":void 0,stopClickPropogation:!0,cancelStyle:Qwe})})]})})})),ebe="CommentReplyCount-module_container_TAje5",tbe="CommentReplyCount-module_profilePic_4R9dC",obe=_.memo((({commentReplies:e})=>{const t=[],o=new Set;for(const{_id:a,user:i}of e){const e=null==i?void 0:i.picture;if(e){if(o.has(e))continue;if(t.push(w.jsx(b9,{user:i,className:tbe},a)),o.add(e),t.length>3)break}}return w.jsxs("div",{className:ebe,children:[t,w.jsx("span",{children:e.length>1?`${e.length} replies`:"1 reply"})]})})),abe=_.memo((({comment:e,replies:t,maxTime:o,disableTimeStamp:a,isChild:i,location:s,onCommentSelected:n,onCommentEditStart:r,seekOnCurrentVideo:d,threadParent:c})=>{var u;const{selectedCommentId:m,currentUser:p,currentVideo:g}=tl((e=>({selectedCommentId:e.comments.selectedCommentId,currentUser:e.currentUser,currentVideo:e.currentVideo})),ol),f=m===e._id,[y,v]=h.useState(!1),[_,b]=h.useState(!1),T=h.useRef(!1),x=il();h.useEffect((function(){f&&null!==e.videoTime&&d(e.videoTime)}),[]);const S=e.creatorId===p.user._id,E=S||!!g.creatorId&&g.creatorId===p.user._id,I=h.useCallback((()=>{r(e.videoTime),T.current=!0,v(!0)}),[e.videoTime,r]),C=h.useCallback((async()=>{try{await zr(`/api/v1/comments/${e._id}`,{}),tp("deleted comment",s,{teamId:g.teamId,creatorId:g.creatorId}),x(oT(e._id))}catch(IGe){mh({description:"Failed to delete comment",error:IGe})}}),[e._id,g.creatorId,g.teamId,x,s]),k=Object.keys(e.user??{}).length>0?null==(u=e.user)?void 0:u.name:"Deleted user",A=h.useCallback((()=>{x(Xb(e._id)),n(e._id,e.videoTime)}),[e._id,e.videoTime,x,n]),j=h.useCallback((()=>{b(!0)}),[]),N=h.useCallback((()=>{b(!1)}),[]);return w.jsxs(w.Fragment,{children:[!i&&w.jsx("div",{className:Rwe}),w.jsxs("div",{className:(()=>{const e=[vwe];return i&&e.push(xwe),f&&e.push(_we),c&&e.push(Twe),e.join(" ")})(),onClick:()=>{f?x(Xb("")):(x(Xb(e._id)),n(e._id,e.videoTime))},spellCheck:!1,"data-cy":"video-comment",children:[w.jsx("div",{className:wwe,children:w.jsx(b9,{user:e.user,className:jwe,custom:xye(e)})}),w.jsxs("div",{className:bwe,children:[w.jsxs("div",{className:Swe,children:[w.jsxs("div",{className:kwe,children:[w.jsx("div",{className:Awe,translate:"no",children:k}),w.jsx("span",{className:Nwe,children:(R=e.createdAt,l(R).format("h:mma MMMM Do"))})]}),w.jsx(Uwe,{handleEditing:S?I:void 0,handleDeleteComment:E?j:void 0,handleReply:A})]}),w.jsxs("div",{className:`${Ewe} ${y?Iwe:""}`,children:[null!==e.videoTime&&w.jsx(ewe,{videoTimestamp:e.videoTime,isEditable:!1,maxTime:o,disabled:a,inEditModeComment:y,seekOnCurrentVideo:d}),w.jsx("span",{translate:"no",children:y?w.jsx(zwe,{comment:e,setEditMode:v,location:s}):w.jsx("div",{className:Cwe,children:e.content})})]}),(null==t?void 0:t.length)&&w.jsx(obe,{commentReplies:t})]}),_&&w.jsx(Zwe,{hideDelete:N,onDelete:C,hasReplies:!!(null==t?void 0:t.length)})]},e._id)," "]});var R})),ibe="CommentThread-module_commentList_XIyop",sbe=_.memo((({parentComment:e,replies:t,onCommentSelected:o,onCommentEditStart:a,maxTime:i,seekOnCurrentVideo:s,location:n})=>w.jsxs("div",{className:ibe,children:[w.jsx(abe,{comment:e,disableTimeStamp:!!(e.videoTime&&e.videoTime>i),maxTime:i,onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:s,threadParent:!0,location:n},e._id),null==t?void 0:t.map((e=>w.jsx(abe,{comment:e,disableTimeStamp:!!(e.videoTime&&e.videoTime>i),maxTime:i,isChild:!0,onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:s,location:n},e._id)))]}))),nbe="MobileSelectedCommentHeader-module_commentsThreadHeader_v4seU",rbe="MobileSelectedCommentHeader-module_commentsThreadHeaderLeft_YgaqH",lbe="MobileSelectedCommentHeader-module_commentsThreadHeaderRight_UIeKO",dbe="MobileSelectedCommentHeader-module_commentsThreadBackIcon_gWJft",cbe="MobileSelectedCommentHeader-module_disabled_NxyTE",ube=_.memo((()=>{const{selectedCommentId:e,comments:t}=tl((e=>({selectedCommentId:e.comments.selectedCommentId,comments:e.comments.comments})),ol),o=il(),[a,i]=h.useState([]),[s,n]=h.useState(0);h.useEffect((function(){const o=fye(t,e),a=(null==t?void 0:t.filter((e=>!e.parentId)))||[];i(a.map((({_id:e})=>e))),n(a.findIndex((({_id:e})=>e===o)))}),[t,e]);const r=h.useCallback((()=>{const e=s-1;e>=0&&o(Xb(a[e]))}),[a,o,s]),l=h.useCallback((()=>{const e=s+1;e<a.length&&o(Xb(a[e]))}),[a,o,s]);return w.jsxs("div",{className:nbe,"data-cy":"mobile-selected-comment-header",children:[w.jsxs("div",{className:rbe,onClick:()=>{o(Xb())},children:[w.jsx(_a,{size:22,className:dbe}),"All Comments"]}),a.length>1&&s+1<=a.length&&w.jsxs("div",{className:lbe,children:[w.jsx(wa,{size:22,className:0===s?cbe:"",onClick:r}),s+1," of ",a.length,w.jsx(ba,{size:22,className:s+1===a.length?cbe:"",onClick:l})]})]})})),mbe={marginTop:20},pbe=_.memo((({maxTime:e,currentVideoTime:t,onCommentEditStart:o,onCommentSelected:a,contentExporting:i,userCanPostComment:s,mobileView:n,location:r,onCommentPostSuccess:l,seekOnCurrentVideo:d,commentsLoading:c})=>{const u=il(),m=ku(),{comments:p,selectedCommentId:g,selectedComment:f}=tl((e=>{const{comments:t,selectedCommentId:o}=e.comments,a=null==t?void 0:t.find((e=>e._id===o));return{comments:t,selectedCommentId:o,selectedComment:a}}),ol),[y,v]=h.useState([]),[_,b]=h.useState({}),T=h.useRef(null),[x,S]=h.useState(!1),E=be(),I=h.useRef(null),C=h.useRef(null),k=h.useRef(null);Uge(I,(()=>u(Xb(""))),"mouseup");const A=(null==f?void 0:f.parentId)||(null==f?void 0:f._id);h.useEffect((function(){const e=[],t={};null==p||p.forEach((o=>{var a;const{parentId:i}=o;i?(t[i]||(t[i]=[]),null==(a=t[i])||a.push(o)):e.push(o)})),v(e),b(t)}),[p]);const j=()=>{T.current&&T.current.scrollTo({top:T.current.scrollHeight,behavior:"smooth"})},N=h.useCallback((()=>{setTimeout(j,0),null==l||l()}),[l]),R=h.useCallback((()=>{const e=sh.get("COMMENT_BEFORE_SIGN_IN",{disabled:""});e&&C.current&&(C.current.innerText=e,sh.remove("COMMENT_BEFORE_SIGN_IN"))}),[C]),P=h.useCallback(((e=!1,o)=>{var a,i,s;e&&o&&_V(o),(null==(i=null==(a=C.current)?void 0:a.innerText)?void 0:i.trim().length)&&sh.set("COMMENT_BEFORE_SIGN_IN",null==(s=C.current)?void 0:s.innerText.trim()),t&&sh.set("VIDEO_TIME_BEFORE_SIGN_IN",t),S(!0)}),[t]),D=h.useCallback((()=>{R()}),[R]),O=h.useCallback((()=>S(!1)),[]),L=!!(n&&g&&f);return w.jsxs("div",{className:`${n?j_e:A_e} ${r===_d.Studio?N_e:F_e}`,"data-cy":"comments-section","data-testid":"comment-section",children:[!n&&w.jsx("div",{className:R_e,children:"COMMENTS"}),L&&w.jsx(ube,{}),w.jsxs("div",{className:L?O_e:r===_d.Studio?D_e:L_e,ref:T,"data-cy":"comments-list-div",id:"comments-content-list",children:[c&&w.jsx(MU,{wrapperStyles:mbe}),!c&&L&&w.jsx("div",{className:B_e,children:w.jsx(sbe,{maxTime:e,parentComment:f,replies:_[g],onCommentSelected:a,onCommentEditStart:o,seekOnCurrentVideo:d,location:r})}),!c&&!L&&(y.length?y.map((i=>i._id===A?w.jsxs("div",{ref:I,children:[w.jsx(sbe,{maxTime:e,parentComment:i,replies:_[i._id],onCommentSelected:a,onCommentEditStart:o,seekOnCurrentVideo:d,location:r}),w.jsx("div",{children:w.jsx(ywe,{currentVideoTime:t,userCanPostComment:s,maxTime:e,mobileView:n,location:r,replyPost:!0,onPostSuccess:l,seekOnCurrentVideo:d,commentContainerRef:T,inputBoxRef:k,setCommentFromLocalStorage:R,handleSignInToComment:P,setShowSignIn:S})})]},i._id):w.jsx(abe,{location:r,comment:i,maxTime:e,replies:_[i._id],onCommentSelected:a,onCommentEditStart:o,seekOnCurrentVideo:d},i._id))):s?w.jsx("div",{className:P_e,children:"No comments yet."}):w.jsxs("div",{className:G_e,children:[!m&&w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/KVH-comment-bubbles.webp",alt:"comment-bubble"}),w.jsxs("div",{className:P_e,children:["No comments yet."," ",w.jsx("span",{className:W_e,onClick:()=>P(!0,ym.EMPTY_COMMENT_PANE),"data-testid":"comments-sign-in-link",children:"Sign in"})," ","and be the first to say something!"]})]})),n&&w.jsx("div",{className:V_e})]}),w.jsx("div",{className:n&&g?U_e:M_e,children:w.jsx(ywe,{currentVideoTime:t,disabled:i,userCanPostComment:s,maxTime:e,mobileView:n,onPostSuccess:N,location:r,replyPost:L,seekOnCurrentVideo:d,commentContainerRef:T,inputBoxRef:C,setCommentFromLocalStorage:R,handleSignInToComment:P,setShowSignIn:S})}),x&&w.jsx(bV,{hideSignIn:O,onSuccess:D,immediateRedirectPathname:`${E.pathname}?comment=true`})]})})),hbe=_.memo((({currentVideoRef:e,contentExporting:t,mobileView:o})=>{var a,i,s;const{id:n,commentId:r}=ua(),l=il(),d=wc(tl((e=>e.currentUser))),c=h.useRef(!1),u=h.useRef(!1),[m,p]=h.useState(null==(a=null==e?void 0:e.current)?void 0:a.currentTime);h.useEffect((function(){return c.current=!0,()=>{c.current=!1}}),[]),h.useEffect((function(){function t(e){p(this.currentTime)}if(null==e?void 0:e.current){const o=e.current;return o.addEventListener("timeupdate",t),()=>{o.removeEventListener("timeupdate",t)}}return()=>{}}),[e]);const g=h.useCallback((async()=>{if(!n||u.current)return;u.current=!0;const e=await wye(n);c.current&&(l(qb(e)),u.current=!1)}),[l,n]);h.useEffect((function(){g()}),[n,d]),h.useEffect((function(){l(Xb(r))}),[r]);const f=h.useCallback(((t,o)=>{var a,i;void 0!==(null==(a=null==e?void 0:e.current)?void 0:a.currentTime)&&void 0!==(null==(i=null==e?void 0:e.current)?void 0:i.duration)&&(e.current.currentTime="number"!=typeof e.current.duration||isNaN(e.current.duration)?t:Math.min(t,e.current.duration),o&&e.current.pause())}),[e]),y=(null==(i=null==e?void 0:e.current)?void 0:i.duration)||0,v=h.useCallback(((e,t)=>{"number"==typeof t&&f(t)}),[f]),_=h.useCallback((e=>{"number"==typeof e&&f(e,!0)}),[f]),b=h.useCallback((e=>{e<=y&&f(e)}),[y,f]);return w.jsx(pbe,{maxTime:(null==(s=null==e?void 0:e.current)?void 0:s.duration)||0,currentVideoTime:m,contentExporting:t,userCanPostComment:d,mobileView:o,onCommentSelected:v,onCommentEditStart:_,onCommentPostSuccess:g,seekOnCurrentVideo:b,location:_d.Export})})),gbe="ProductHuntAnnouncement-module_container_At2vc",fbe="ProductHuntAnnouncement-module_closeContainer_OZxbB",ybe="ProductHuntAnnouncement-module_contentContainer_uqChs",vbe="ProductHuntAnnouncement-module_title_LGphD",_be="ProductHuntAnnouncement-module_icon_U7p-g",wbe="ProductHuntAnnouncement-module_context_HuiYS",bbe="ProductHuntAnnouncement-module_button_8CR3A",Tbe="ProductHuntAnnouncement-module_buttonText_DTYHf",xbe="ProductHuntAnnouncement-module_buttonIcon_WFJiZ",Sbe="ProductHuntAnnouncement-module_image_E6t-b",Ebe=_.memo((({hideOverlay:e})=>w.jsxs("div",{className:gbe,children:[w.jsx("div",{className:fbe,children:w.jsx(ve,{onClick:e})}),w.jsxs("div",{className:vbe,children:[w.jsx(ha,{className:_be})," Your download has started!"]}),w.jsx("div",{className:ybe,children:(()=>{const e="https://www.producthunt.com/posts/magic-subtitles";return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:wbe,children:["By the way, we launched ",w.jsx("b",{children:"Magic Subtitles"})," on Product Hunt!"]}),w.jsx("div",{className:wbe,children:w.jsx("a",{href:e,target:"_blank",rel:"noreferrer",children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/RWR-4k-g0zxE-image.webp",alt:"Magic Subtitles Launch",className:Sbe})})}),w.jsx("div",{className:wbe,children:"If you enjoy using Kapwing, would you please consider supporting us on Product Hunt?"}),w.jsx("div",{children:w.jsx("a",{href:e,target:"_blank",rel:"noreferrer",children:w.jsxs("div",{className:bbe,children:[w.jsxs("span",{className:Tbe,children:["Support us on Product Hunt"," "]}),w.jsx(Ta,{className:xbe})]})})})]})})()})]}))),Ibe={height:630,width:1200},Cbe={},kbe={color:"#eee",fontWeight:600};class Abe extends h.Component{constructor(e){super(e),i(this,"_mounted",!1),i(this,"serverProcessedVideoShown",!1),i(this,"sensor",null),i(this,"startedCheckingExportNotif",!1),i(this,"exportCheckCondition"),i(this,"getVideoLockStatus",(async e=>{if(e)try{(await Yr("/api/v1/videos/locked",{params:{id:e}})).locked&&this.setState({locked:!0})}catch(IGe){console.error("Error getting video lock status:",IGe)}})),i(this,"fetchVideo",(async()=>{const{match:e,history:t,showToast:o}=this.props,{isLoading:a}=this.state,i=e.params.id;if(!a&&i){this.setState({isLoading:!0});try{const e=await AD({id:i,preserveId:!0});this.setState({isLoading:!1}),(async e=>{const{state:t}=sr(),{workspaces:o}=t,a=e.workspaceId,i=o.allWorkspaces.find((e=>e._id===a));let s,n=null==i?void 0:i.type;try{!i&&a&&(n=await HP(a))}catch(IGe){console.error("Failed to fetch folder type",IGe)}switch(n){case kn.personal:s="Private";break;case kn.team:s="Team"}const r={"Is Team Member":Em(e.teamId??""),"Is Project Owner":Sm(e.creatorId??"")};s&&(r["Project Location"]=s),Fm(ym.ACCESS_FINAL_VIDEO_PAGE,r)})(e),vM(e),e._id&&(this.getVideoLockStatus(e._id),await GO(i))}catch(s){let e;this.setState({isLoading:!1});let a=!1;if(s instanceof Hr)switch(s.status){case 403:e=s.message,a=!0;break;case 404:e="Content couldn't be found.",a=!0;break;case 410:e="Content has been deleted.",a=!0}a&&(o({description:e||ph(s).message,type:"error"}),t.push("/"))}}})),i(this,"hideOverlay",(()=>{this.setState({overlay:void 0})})),i(this,"showOverlay",(e=>{this.setState({overlay:e})})),i(this,"hideReportIssueModal",(()=>{this.setState({showReportIssueModal:!1})})),i(this,"showReportIssueModal",(e=>{this.setState({showReportIssueModal:!0,showReportIssueSource:e})})),i(this,"onDownload",(()=>{const{currentUser:e}=this.props,t=au();!function(e){if(!wc(e))return!1;const{accountType:t}=e.user;return t===Mn.student}(e)&&t.isFree&&Math.floor(11*Math.random())>=6&&this.showOverlay("follow-us-on-twitter")})),i(this,"showLinkModal",(()=>{this.showOverlay("share-link")})),i(this,"showEmbedModal",(()=>{this.showOverlay("share-embed")})),i(this,"showTikTokModal",(()=>{this.showOverlay("share-tik-tok")})),i(this,"setCurrentVideoRef",(e=>{this.setState({currentVideoRef:e})})),i(this,"checkShowExportEmailMessage",(async()=>{var e,t;const o=null==(e=this.props.currentVideo)?void 0:e._id,a=!!(null==(t=this.props.currentUser.user.optOutEmails)?void 0:t.includes(xl.Export));if(this.startedCheckingExportNotif||!wc(this.props.currentUser)||a||!o)return;this.startedCheckingExportNotif=!0;const i=async e=>{const t=(new Date).getTime();if("stop"===this.exportCheckCondition||t-e>18e4)return;let a="lastCheck"!==this.exportCheckCondition;try{const{jobExists:e,userExporter:t}=await Yr(`/api/v1/videos/${o}/emailOnExport`);t&&this.setState({showEmailMessage:!0}),(t||e)&&(a=!1)}catch(IGe){console.error("Error while checking show export email message",IGe)}a&&setTimeout((()=>i(e)),5e3)};i((new Date).getTime())})),i(this,"showProgressReportIssueModal",(()=>{this.showReportIssueModal("progress")})),i(this,"showOptionsReportIssueModal",(()=>{this.showReportIssueModal("options")})),i(this,"handleOnFinishedVideo",(()=>{const{currentUser:e}=this.props;if(!e.user.muteExportCompleteNotificationSound){new Audio("/export-notification-chime.mp3").play()}this.exportCheckCondition="stop"})),i(this,"handleOnFirstProgressLoad",(()=>{this.exportCheckCondition="lastCheck"})),this.state={showReportIssueModal:!1,showReportIssueSource:"",currentVideoRef:null,showEmailMessage:!1,locked:!1,isLoading:!1}}componentDidMount(){const{resetCurrentVideo:e,selectTab:t,location:o}=this.props,a=window.innerWidth<=1024;this.setState({commentsMobileSize:a}),e(),this.fetchVideo(),this._mounted=!0,this.sensor=new xa.ResizeSensor(document.body,(()=>{this.setState({commentsMobileSize:window.innerWidth<=1024})}));const i=new URLSearchParams(o.search);(this.props.match.params.commentId||"true"===i.get(Rie.COMMENT))&&t({tabId:"Comments",tabContainerId:"mobile-options-container"})}componentDidUpdate(e,t){var o,a;const{match:i,currentVideo:s={},userPermissions:n}=this.props;s._id!==i.params.id&&this.fetchVideo(),s._id&&!(null==(o=e.currentVideo)?void 0:o._id)&&vM(s),0===Object.keys(n).length&&s._id&&GO(s._id),!s.done&&(null==(a=e.currentVideo)?void 0:a.done)&&(this.serverProcessedVideoShown=!1),this.state.commentsMobileSize&&!t.commentsMobileSize&&this.props.match.params.commentId&&YD({tabId:"Comments",tabContainerId:"mobile-options-container"})}componentWillUnmount(){var e;const{resetState:t}=this.props;t(),null==(e=this.sensor)||e.detach(),this._mounted=!1}getGifDimensions(){const{adjusted_height:e,adjusted_width:t,height:o,width:a}=this.props.currentVideo||{};let i=o||e||1,s=a||t||1;return s>=i?(i=200*i/s,s=200):(s=200*s/i,i=200),[i,s]}getVideoDimensions(){const{adjusted_height:e,adjusted_width:t,height:o,width:a}=this.props.currentVideo||{},i=o||e||1,s=a||t||1;let n=Math.min(Math.max(1280,i),1920),r=Math.min(Math.max(1280,s),1920);return r>=n?n=r*i/s:r=n*s/i,[n,r]}getHelmetDimensions(e){const{privacy:t}=this.props.currentVideo||{};if(t)return Ibe;const[o,a]="gif"===e?this.getGifDimensions():this.getVideoDimensions();return{height:o,width:a}}getUrl(){let{hostDomain:e}=this.props;const{currentVideo:t={}}=this.props,{_id:o}=t;return e||(e=document&&document.domain),`https://${e}/videos/${o}`}getImageUrl(){const{currentVideo:e={}}=this.props,{privacy:t}=e;return t?"https://cdn-useast1.kapwing.com/static/jQ9-og-image-(1).webp":k0(e,"image_url")}getVideoUrl(e){const{currentVideo:t}=this.props,{privacy:o,video_url:a}=t||{};if("image"!==e&&!o)return"gif"===e&&a?a:k0(t,"fullPath")}getImageTags({height:e,width:t}){const o=this.getImageUrl();return[w.jsx("meta",{property:"og:image",content:o},"ogImage"),w.jsx("meta",{property:"og:image:height",content:e},"ogImageHeight"),w.jsx("meta",{property:"og:image:secure_url",content:o},"ogImageSecureUrl"),w.jsx("meta",{property:"og:image:url",content:o},"ogImageUrl"),w.jsx("meta",{property:"og:image:width",content:t},"ogImageWidth"),w.jsx("meta",{property:"twitter:image",content:o},"twitterImage")]}getVideoTags({content:e="video/mp4",height:t,outputType:o,width:a}){const i=this.getVideoUrl(o);return i?[w.jsx("meta",{property:"og:type",content:"video"},"ogType"),w.jsx("meta",{property:"og:video",content:i},"ogVideo"),w.jsx("meta",{property:"og:video:height",content:t},"ogVideoHeight"),w.jsx("meta",{property:"og:video:secure_url",content:i},"ogVideoSecureUrl"),w.jsx("meta",{property:"og:video:type",content:e},"ogVideoType"),w.jsx("meta",{property:"og:video:width",content:a},"ogVideoWidth")]:null}showingVideoProgress(e,t){const{convertOption:o,currentVideo:a={},ffmpegReducer:i}=e,{isLoading:s,local_url:n}=t;return!(n||a.done||this.serverProcessedVideoShown||"FULFILLED"===i.ffmpegStatus&&void 0!==i.outputFileUrl&&"mp4"===o||s)}renderHelmet(){const{currentVideo:e={},facebookAppId:t,projectName:o}=this.props,{fullPath:a}=e,i=Tm(a),{height:s,width:n}=this.getHelmetDimensions(i),r=e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)};let l=`${r(i)} — Kapwing`;o&&(l=`${o} — Kapwing`);const d=`${r(i)} made on Kapwing`;return w.jsxs(Mt,{children:[w.jsx("title",{children:l}),w.jsx("meta",{name:"description",content:d}),w.jsx("meta",{property:"fb:app_id",content:t}),w.jsx("meta",{property:"og:description",content:d}),w.jsx("meta",{property:"og:title",content:o}),w.jsx("meta",{property:"og:url",content:this.getUrl()}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"}),this.getImageTags({height:s,width:n}),this.getVideoTags({height:s,outputType:i,width:n})]})}renderFinalVideo(e){const{currentVideo:t=Cbe}=this.props;return w.jsx(Ive,{autoPlay:!1,setCurrentVideoRef:this.setCurrentVideoRef,currentVideo:t,local_url:e})}renderVideoProgress(){const{currentUser:e,currentVideo:t,currentFolderId:o,thumbnailUrl:a}=this.props;return w.jsx(i_e,{currentUser:e,currentVideo:t||Cbe,currentFolderId:o,hideReportIssueModal:this.hideReportIssueModal,showReportIssueModal:this.showProgressReportIssueModal,thumbnailUrl:a,onFinishedVideo:this.handleOnFinishedVideo,onFirstProgressLoad:this.handleOnFirstProgressLoad})}renderBody(){const{convertOption:e,currentVideo:t={},ffmpegReducer:o,currentUser:a,canWrite:i}=this.props,{isLoading:s,local_url:n,currentVideoRef:r,commentsMobileSize:l=!1,showEmailMessage:d}=this.state,c=au(),u=void 0===i;let m,p=!1,h=!1;const g=t.creatorId===a.user._id,f=w.jsx("div",{className:Gfe.loadingWrapper,children:w.jsx(MU,{text:"Loading content...",textStyles:kbe})});t.done?(m=this.renderFinalVideo(),p=!0,this.serverProcessedVideoShown=!0,p=!0):"FULFILLED"===o.ffmpegStatus&&void 0!==o.outputFileUrl&&"mp4"===e?(m=this.renderFinalVideo(o.outputFileUrl),p=!0):s?(m=f,h=!0):m=this.renderVideoProgress();let y=null,v=!1;if(t._id&&!t.creatorId)y=w.jsx(Yye,{afterRemoveWatermark:this.fetchVideo,hideOverlay:this.hideOverlay,local_url:n,onDownload:this.onDownload,showEmbedModal:this.showEmbedModal,showLinkModal:this.showLinkModal,showReportIssueModal:this.showOptionsReportIssueModal,showTikTokModal:this.showTikTokModal});else if(u)y=w.jsx("div",{className:Gfe.commentsContainerWrapper,children:w.jsx("div",{className:Xfe})});else if(l){const e=g?["actions","comments"]:["comments","actions"];y=w.jsxs(Sa,{defaultValue:e[0],children:[w.jsx(Ea,{className:Gfe.tabsHolder,children:e.map((e=>w.jsx(Ia,{value:e,className:Gfe.tab,"data-cy":`mobile-options-container-tab-${e}`,children:e},e)))}),w.jsx(Ca,{value:"actions",children:w.jsx(Yye,{afterRemoveWatermark:this.fetchVideo,hideOverlay:this.hideOverlay,local_url:n,onDownload:this.onDownload,showEmbedModal:this.showEmbedModal,showLinkModal:this.showLinkModal,showReportIssueModal:this.showOptionsReportIssueModal,showTikTokModal:this.showTikTokModal,mobileCommentsView:!0})}),w.jsx(Ca,{value:"comments",children:w.jsx(hbe,{currentVideoRef:r,contentExporting:!p,mobileView:!0})})]})}else v=!h,y=w.jsxs("div",{className:Gfe.commentsContainerWrapper,children:[w.jsxs("div",{className:Gfe.commentsSharingWrapper,children:[w.jsx(Kie,{video:t,afterExport:this.fetchVideo}),w.jsx(tse,{className:Gfe.upsellBlock}),w.jsx(Bye,{showEmbedModal:this.showEmbedModal,showTikTokModal:this.showTikTokModal,inCommentView:!0})]}),w.jsx(hbe,{currentVideoRef:r,contentExporting:!p}),Tc(a)?w.jsx("div",{className:Gfe.adminSectionWrapper,children:w.jsx(nae,{commentingView:!0})}):null]});return w.jsxs("div",{className:Gfe.finalVideoContainer,children:[w.jsxs("div",{className:Gfe.finalVideoPreviewContainer,children:[v&&w.jsx("div",{className:Gfe.topEditButtonContainer,children:w.jsx(Iye,{local_url:n,onDownload:this.onDownload,commentingView:!0})}),w.jsx("div",{className:Gfe.commentsFinalVideoContainer,children:w.jsx("div",{className:v?Gfe.commentingVideoContainerContent:Gfe.videoContainerContent,children:m})}),d&&this.showingVideoProgress(this.props,this.state)&&this.renderEmailMessage(),v&&w.jsxs("div",{className:Gfe.privacyAndSocialWrapper,children:[w.jsx("div",{children:t._id&&t.fullPath&&w.jsx(Wfe,{videoId:t._id,downloadUrl:t.fullPath,privacy:t.privacy,userHasAccess:!!t.workspaceId&&OP(t.workspaceId),inVideoContainer:!0})}),w.jsxs("div",{className:`${sye} ${Gfe.socialDescription}`,children:["Tag ",w.jsx("strong",{children:"#kapwing"})," so we can find you on social media!"," ",c.isPaid&&w.jsxs("span",{children:["Any issues?"," ",w.jsx("button",{type:"button",className:nye,onClick:()=>this.showReportIssueModal("options"),children:"Report a problem"})," ","and let us know."]})]})]})]}),y]})}renderOverlay(){let e;switch(this.state.overlay){case"share-embed":e=w.jsx(dve,{hideOverlay:this.hideOverlay});break;case"share-link":e=w.jsx(wve,{hideOverlay:this.hideOverlay});break;case"share-tik-tok":e=w.jsx(__e,{hideOverlay:this.hideOverlay});break;case"follow-us-on-twitter":e=w.jsx(k_e,{hideOverlay:this.hideOverlay});break;case"product-hunt-announcement":e=w.jsx(Ebe,{hideOverlay:this.hideOverlay});break;default:return null}return w.jsxs("div",{className:Gfe.overlay,children:[w.jsx("div",{className:Gfe.overlayBackground,onClick:this.hideOverlay}),e]})}renderEmailMessage(){return w.jsx("div",{className:Gfe.emailMessageContainer,children:w.jsxs("div",{className:Gfe.emailMessageDiv,children:[w.jsx("p",{children:w.jsx("b",{children:"Taking too long? You can close this page."})}),w.jsx("p",{children:"We will send you an email with a download link when your project is ready."})]})})}renderLocked(){const{locked:e}=this.state;if(!e)return null;const t={action:Vl.STORAGE_LIMIT,closeable:!1};return w.jsx(gW,{...t})}render(){const{match:e}=this.props,{showReportIssueModal:t,showReportIssueSource:o}=this.state,a="progress"===o;return w.jsxs("div",{children:[this.renderHelmet(),w.jsx(Pfe,{}),this.renderBody(),this.renderLocked(),w.jsx(h8,{}),this.renderOverlay(),t&&w.jsx(u_e,{hide:this.hideReportIssueModal,videoId:e.params.id,fromVideoProgress:a})]})}}const jbe=je(g.connect(((e,t)=>{const{match:o}=t,{id:a}=o.params,i=e.currentVideo._id&&e.currentVideo._id===a,s=e.studio._id&&e.studio._id===a;let n;return i?n=e.currentVideo:s&&(n=e.studio),{currentUser:e.currentUser,currentVideo:n,currentFolderId:e.workspaces.selectedWorkspace,facebookAppId:e.config.FACEBOOK_APP_ID,projectName:e.projectName,editorPath:e.editorPath,projectId:null==n?void 0:n.projectId,ffmpegReducer:e.ffmpegReducer,convertOption:e.convertOption,thumbnailUrl:e.studio.image_url,surveyEligible:s,canWrite:e.userPermissions.canWrite,userPermissions:e.userPermissions}}),(e=>ye({updateCurrentVideo:yD,resetState:UD,resetCurrentVideo:wD,selectTab:YD,showToast:wl},e)))(Abe)),Nbe="Snapshots-module_actionButton_lPAz7",Rbe="Snapshots-module_actionIcon_Yg5zF",Pbe="Snapshots-module_actions_jRx9w",Dbe="Snapshots-module_background_LweQL",Obe="Snapshots-module_snapshotTile_VEGp6",Lbe="Snapshots-module_mediaContainer_sLXJV",Fbe=_.memo(je((({match:e,snapshot:t,history:o,showDelete:a,projectId:i})=>{const s=Dge(),n=e.params.id,r=k0(t,"fullPath"),l={maxWidth:300,maxHeight:300},d=t.created_on||"unknown",c=t.content.scenes.length,u=t.content.scenes.reduce(((e,t)=>e+t.layers.length),0),m=1===c?"scene":"scenes",p=1===u?"layer":"layers";return w.jsxs("div",{className:Obe,children:[w.jsx("div",{className:Lbe,children:(()=>{var e,o;if(null==(o=null==(e=t.content)?void 0:e.fullPath)?void 0:o.endsWith("mp4"))return w.jsx("video",{src:r,style:l,controls:!0,playsInline:!0,preload:"auto"});const{image_url:a}=t.content;return a?w.jsx("img",{src:a,style:l,alt:""}):w.jsx(ka,{size:300})})()}),w.jsxs("div",{className:Pbe,children:[w.jsxs("div",{children:["Snapshot Type: ",t.snapshot_type]}),w.jsxs("div",{children:["Version Number: ",t.version_number]}),w.jsxs("div",{children:["Exported: ",t.export.toString()]}),"Created on ",d,w.jsxs("div",{children:[c," ",m," / ",u," ",p]}),w.jsx("div",{onClick:async()=>{const{copiedProject:e}=await s(t.id,i,{entryPoint:Lge.ADMIN_DEBUG_PAGE});e&&o.push(`/${e.videoId}/studio/editor`)},children:w.jsxs("button",{type:"button",className:Nbe,children:[w.jsx(Qo,{className:Rbe}),"Fork"]})}),w.jsx("div",{onClick:async()=>{o.push(`/videos/${n}/snapshots/${t.id}/debug`)},children:w.jsxs("button",{type:"button",className:Nbe,children:[w.jsx(Qo,{className:Rbe}),"View Debug Page"]})}),w.jsx("div",{onClick:()=>a(t.id),children:w.jsxs("button",{type:"button",className:Nbe,children:[w.jsx(Qo,{className:Rbe}),"Delete"]})})]})]})}))),Mbe=_.memo(je((({onDelete:e,onHide:t})=>{const[o,a]=h.useState(!1),i=Zge("export",{extraText:"You will not be able to edit or download this export after it has been deleted."}),s=h.useCallback((()=>{t(),vh()}),[t]),n=h.useCallback((async()=>{a(!0),e(),a(!1),s()}),[s,e]);return w.jsx(nM,{unsetCancelModal:s,usePortal:!0,children:w.jsxs("div",{className:tfe,children:[w.jsx("div",{className:ofe,children:"Delete Export?"}),w.jsx("div",{className:afe,children:i}),w.jsx(GF,{cancelFn:s,confirmFn:n,confirmText:"Delete",cancelText:"Cancel",loadingMsg:o?"Deleting...":void 0,confirmButtonClassName:`${ife} ${sfe}`})]})})}))),Ube=_.memo(je((e=>{var t,o;const{match:a}=e,i=a.params.id,[s,n]=h.useState(!0),[r,l]=h.useState(null),[d,c]=h.useState([]),[u,m]=h.useState(""),[p,g]=h.useState(!1),f=e=>{m(e),g(!0)},y=h.useCallback((()=>{m(""),g(!1)}),[]),v=h.useCallback((async()=>{await async function(e,t){try{return await zr(`/api/v1/snapshots/${e}/${t}`)}catch(IGe){throw console.error(IGe),IGe}}(i,u);const e=await dK(i);c(e.reverse()),y()}),[y,u,i]);h.useEffect((()=>{dK(i).then((e=>c(e.reverse()))).catch((e=>{console.error(e),l(e)})).finally((()=>n(!1)))}),[]);const _=null==(o=null==(t=d.find((e=>{var t;return null==(t=e.content)?void 0:t.projectId})))?void 0:t.content)?void 0:o.projectId;return w.jsxs("div",{className:Dbe,children:[w.jsx("h1",{children:"Snapshots"}),s&&w.jsx("div",{children:"Loading snapshots..."}),!s&&0===d.length&&w.jsx("div",{children:"No snapshots found"}),r&&w.jsxs("div",{children:["Error: ",JSON.stringify(r)]}),d.map(((e,t)=>w.jsx(Fbe,{projectId:_,snapshot:e,showDelete:f},t))),p&&w.jsx(Mbe,{onDelete:v,onHide:y})]})})));function Bbe(e){return{type:"SET_CONFIG",config:e}}const Vbe="LogoRedesigns-module_wrapper_5Er59",Wbe="LogoRedesigns-module_container_8iWJM",Gbe="LogoRedesigns-module_content_4IcCx",Hbe="LogoRedesigns-module_headerImage_UsZ8C",$be="LogoRedesigns-module_date_RkkN1",Kbe="LogoRedesigns-module_header_mF84A",zbe="LogoRedesigns-module_firstP_5Ls7w",Ybe="LogoRedesigns-module_p_pnYqE",Jbe=()=>{const e="A strong logo can undergo a revamp without losing its essence. But can it resist being dominated by one of graphic design's cornerstone styles? To find out, we've recreated six iconic logos in six essential art styles.";return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Logo Redesigns — Kapwing"}),w.jsx("meta",{name:"description",content:e}),w.jsx("meta",{name:"keywords",content:"logo redesign, graphic design, art styles, logo styles"}),w.jsx("meta",{property:"og:title",content:"Logo Redesigns — Kapwing"}),w.jsx("meta",{property:"og:description",content:e}),w.jsx("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/neomam/logo-og-image.jpeg"}),w.jsx("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/neomam/logo-og-image.jpeg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/logo-redesigns"})]}),w.jsx(Q9,{}),w.jsx("div",{className:Vbe,children:w.jsx("div",{className:Wbe,children:w.jsxs("div",{className:Gbe,children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Header_6-Famous-Logos-Designed-In-6-Graphic-Design-Styles.a38085c9.png",alt:"Trading in Trademarks",className:Hbe}),w.jsx("div",{className:$be,children:"16 January 2022"}),w.jsx("h1",{className:Kbe,children:"Six Famous Logos Designed in Six Graphic Design Styles"}),w.jsxs("p",{className:zbe,children:["A brand's logo has a lot of heavy lifting to do. The logo should hint at the product type and ooze the brand's spirit. It should be stylish yet timeless. And it should do all this without looking quite like"," ",w.jsx("a",{href:"https://www.creativebloq.com/features/8-famous-logos-that-look-unbelievably-similar",target:"_blank",rel:"noopener noreferrer",children:"anything else"}),"."]}),w.jsx("p",{className:Ybe,children:"Yet a logo needs to be light as a feather. If the consumer needs to think about it, it's dead in the water. A logo should be eloquent, effortless, effervescent."}),w.jsxs("p",{className:Ybe,children:["When a graphic designer begins a new logo, they balance the need for originality against the need for instant recognition. Rather than choosing a graphic design style, they should wield a"," ",w.jsx("a",{href:"https://99designs.co.uk/blog/logo-branding/famous-logos/",target:"_blank",rel:"noopener noreferrer",children:"deep knowledge"})," ","of the looks that have gone before and understand the connotations of those styles today."]}),w.jsxs("p",{className:Ybe,children:["A strong logo can undergo a revamp without losing its essence. But can it resist being dominated by one of graphic design's cornerstone styles? To find out — and provide a graphic design style primer — the team at"," ",w.jsx("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer",children:"Kapwing"}),", has recreated ",w.jsx("strong",{children:"six iconic logos"})," in these"," ",w.jsx("strong",{children:"six essential styles"}),":"," "]}),w.jsxs("ul",{children:[w.jsxs("li",{children:[w.jsx("strong",{children:"Art nouveau."})," An elegant, sinuous, romantic style from the turn of the 20th century."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"Bauhaus."})," An avant-garde design school that favored functionalism, geometrics, and space."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"Psychedelic."})," Acid-colored patterns and stream-of-conscious lines that have bedazzled beholders since the 1960s."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"Pop art."})," Kitsch, comic-style pop culture references channeling 1950s Americana through Andy Warhol's eyes."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"Retro '80s."})," The grids, vector curves, clipart, and blocky fonts of 1980s computer graphics sprinkled with that weird '80s sense of glamor."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"3D design."})," Playful renders popping out of the screen with more or less fidelity to realism."]})]}),w.jsx("p",{className:Ybe,children:"Scroll on for a closer look at each brand logo."}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/01_Famous-Logos-Designed-In-Graphic-Design-Styles_Poster.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{alt:"Famous Logos Redesigned",src:"https://cdn-useast1.kapwing.com/static/neomam/01_Famous-Logos-Designed-In-Graphic-Design-Styles_Poster.png"})}),w.jsx("h2",{id:"Apple",children:"Apple"}),w.jsxs("p",{className:Ybe,children:["The apple: so simple, you don't even need typography. There are many theories for that bite, though. It could reference Alan Turing, the gay war hero who invented \"",w.jsx("a",{href:"https://www.newscientist.com/people/alan-turing/",target:"_blank",rel:"noreferrer noopener",children:"the computer"}),'" and who ate an apple laced with poison after the feds chemically castrated him. Or it could reference the forbidden knowledge of actually opening up a Mac to see how it works. However, designer Touraj Saberivand'," ",w.jsx("a",{href:"https://inkbotdesign.com/apple-logo-design/",target:"_blank",rel:"noreferrer noopener",children:"explains"}),': "to make it look more like an apple and not some other round fruit, I did what one does with an apple. I took a bite out of it."']}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/02_Apple-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/02_Apple-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Apple Logo"})}),w.jsxs("p",{className:Ybe,children:["Our art nouveau take on the Apple logo is not far from the brand's original 1976 artwork — a woodblock print of an apple gravitating towards Isaac Newton's head with the words “Apple Computer Co.” wrapped around it. But the Bauhaus version most clearly articulates Steve Jobs' vision: clear, artistic —"," ",w.jsx("a",{href:"https://www.forbes.com/sites/stevedenning/2011/11/17/the-lost-interview-steve-jobs-tells-us-what-really-matters",target:"_blank",rel:"noreferrer noopener",children:"a tool to amplify your abilities"}),"."]}),w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Apple-compressed-animation.a2530daa.gif",alt:"Apple animation"}),w.jsx("h2",{id:"McDonald's",children:"McDonald's"}),w.jsxs("p",{className:Ybe,children:["It's hard to imagine McDonald's without the golden arches. But when it was just the McDonald brothers in their shack with a fryer, they favored a jaunty comic script atop their then-mascot, the troubling burger chef,"," ",w.jsx("a",{href:"https://www.creativebloq.com/logo-design/mcdonalds-logo-short-11135325",target:"_blank",rel:"noreferrer noopener",children:"Speedee"}),". Troubling because Speedee was both a burger and a chef."," "]}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/03_McDonalds-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/03_McDonalds-Logo-Designed-In-Graphic-Design-Styles.png",alt:"McDonald's Logo"})}),w.jsxs("p",{className:Ybe,children:["The ghost of Speedee haunts the rock 'n roll quiffed burger boy of our 1950s pop art style McD's logo. But the versions that retain prominent arches demonstrate the power of a simple motif to conjure a brand's aftertaste in your mouth. McDonald's is going through a big"," ",w.jsx("a",{href:"https://www.vox.com/22736636/mcdonalds-design-aesthetic-look-buildings",target:"_blank",rel:"noreferrer noopener",children:"identity crisis"})," ","lately, not least"," ",w.jsx("a",{href:"https://www.mashed.com/680053/the-hilarious-reason-mcdonalds-just-changed-its-twitter-handle/",target:"_blank",rel:"noreferrer noopener",children:"rebranding its Twitter handle"})," ","in the style of South Korean boy band phenomenon BTS. Can the arches bear the strain?"]}),w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/McDonalds-compressed-animation.f2ecf0b5.gif",alt:"McDonald's animation"}),w.jsx("h2",{id:"Instagram",children:"Instagram"}),w.jsxs("p",{className:Ybe,children:["Cole Rise threw the old Instagram logo together in under 45 minutes. Deadline met, he refined it over the next few months. The polished version represented the app for five years. Rise's 2010 design followed the"," ",w.jsx("a",{href:"https://blog.hubspot.com/website/skeuomorphism",target:"_blank",rel:"noreferrer noopener",children:"skeuomorphic"})," ","design trend of the day, making the logo look like an actual Instamatic camera (actually a Bell & Howell)."]}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/04_Instagram-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/04_Instagram-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Instagram Logo"})}),w.jsxs("p",{className:Ybe,children:["When Instagram decided it was time to simplify and"," ",w.jsx("a",{href:"https://www.interaction-design.org/literature/topics/flat-design",target:"_blank",rel:"noreferrer noopener",children:'"flatten"'})," ","its logo like everyone else, they asked every staff member to draw Rise's logo from memory. “That gave us a sense of what was burned in,”"," ",w.jsx("a",{href:"https://www.fastcompany.com/3059740/an-exclusive-look-at-instagrams-new-app-icon",target:"_blank",rel:"noreferrer noopener",children:"said Ian Spalter"}),", head of design. Our re-styled versions demonstrate just how hot the square-and-concentric-circles brand burns."]}),w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Instagram-compressed-animation.75de683f.gif",alt:"Instagram animation"}),w.jsx("h2",{id:"Google",children:"Google"}),w.jsxs("p",{className:Ybe,children:["The Google brand has thrived on minimalism even as the company explores ever more diverse avenues (its next move is"," ",w.jsx("a",{href:"https://www.nytimes.com/2021/04/30/technology/google-back-to-office-workers.html",target:"_blank",rel:"noreferrer noopener",children:"“Ikea meets Lego”"}),"). The uncluttered search page and no-frills logo are as much an element of Google's early success as its algorithms. But the original logo featured an exclamation mark and a"," ",w.jsx("a",{href:"https://sweeney.agency/shedding-some-light-on-the-drop-shadow/",target:"_blank",rel:"noreferrer noopener",children:"drop shadow"})," ","that'll make you cry. Not so much 'simple' as 'basic.'"]}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/05_Google-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/05_Google-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Google Logo"})}),w.jsxs("p",{className:Ybe,children:["The simplicity of the post-exclamation, post-drop shadow logo has allowed for infinite variations via the regularly-changing"," ",w.jsx("a",{href:"https://www.google.com/doodles/about",target:"_blank",rel:"noreferrer noopener",children:"Google Doodle"}),". So, while none of our redesigns look implausible, the two that are most evocative are those that imagine Google in a realistic alternative timeline: either the vaporwave look of our"," ",w.jsx("a",{href:"https://www.rediscoverthe80s.com/2020/02/what-the-internet-was-like-in-the-80s.html",target:"_blank",rel:"noreferrer noopener",children:"dial-up era"})," ","1980s logo or the augmented-reality bubbles of the 3D version."]}),w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Google-compressed-animation.180e4c5b.gif",alt:"Google animation"}),w.jsx("h2",{id:"NASA",children:"NASA"}),w.jsx("p",{className:Ybe,children:"The NASA logo is pretty busy by today's standards, but when your main beholders are space aliens, it makes sense to communicate your purpose in full. The planet-shaped, star-studded, red aeronautics-themed dash logo has a mundane nickname among Earth-dwellers, even at NASA: the meatball."}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/06_NASA-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/06_NASA-Logo-Designed-In-Graphic-Design-Styles.png",alt:"NASA Logo"})}),w.jsxs("p",{className:Ybe,children:["NASA already has a '1980s version' of its logo. Their"," ",w.jsx("a",{href:"https://www.nasa.gov/audience/forstudents/5-8/features/symbols-of-nasa.html",target:"_blank",rel:"noreferrer noopener",children:"looping, red, text-only logo"})," ","known as the 'worm' did most of the work between 1975 — 1992 (and recently made another comeback). So our 1980s version imagines the best of both worlds: a meatball in the decade that gave us the bubblegum heroics of ",w.jsx("i",{children:"Explorers and Flight of the Navigator"}),"."]}),w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/NASA-compressed-animation.15def524.gif",alt:"NASA animation"}),w.jsx("h2",{id:"WWF",children:"WWF"}),w.jsx("p",{className:Ybe,children:"The choice of a panda for WWF’s icon is a masterstroke of clear thinking. The simplicity of a black and white design that works in silhouette; the precarity of the panda as symbolic of World Wildlife Fund’s efforts; and the cute factor that convinces supporters to part with their money. The panda design has prevailed almost unchanged since 1961 (thankfully the World Wrestling Federation didn’t choose a panda for its logo)."}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/07_WWF-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/07_WWF-Logo-Designed-In-Graphic-Design-Styles.png",alt:"WWF Logo"})}),w.jsxs("p",{className:Ybe,children:["Our Bauhaus-style redesign of the WWF logo adds a splash of color while simplifying the form. And it maintains the cuteness without resorting to the child appeal of our 1980s version. Scientists say the power of cute can be used to ‘",w.jsx("a",{href:"https://www.ox.ac.uk/research/how-cute-things-hijack-our-brains-and-drive-behaviour",target:"_blank",rel:"noreferrer noopener",children:"hijack our brains"}),",’ which makes it a useful tool for marketing – but it’s essential not to"," ",w.jsx("a",{href:"https://99designs.co.uk/blog/creative-inspiration/cute-logos/",target:"_blank",rel:"noreferrer noopener",children:"compromise"})," ","the seriousness of your brand."]}),w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/WWF-compressed-animation.c7be7ece.gif",alt:"WWF animation"}),w.jsxs("p",{className:Ybe,children:["When"," ",w.jsx("a",{href:"https://www.creativebloq.com/features/5-logos-by-famous-designers-and-why-they-work",target:"_blank",rel:"noreferrer noopener",children:"Chupa Chups"})," ","needed a logo, the boss asked his friend Salvador Dali to sketch one on an old newspaper that was lying around. Yet a logo needn't be high art. Right now, supermarket brands are giving"," ",w.jsx("a",{href:"https://www.designweek.co.uk/what-is-normcore-and-how-will-it-affect-design/",target:"_blank",rel:"noreferrer noopener",children:"normcore"})," ","its"," ",w.jsx("a",{href:"https://plato.stanford.edu/entries/postmodernism/",target:"_blank",rel:"noreferrer noopener",children:"post-modernist"})," ","moment, splashing their basic but powerful logos over nerdy knits to create"," ",w.jsx("a",{href:"https://www.theguardian.com/lifeandstyle/2021/dec/04/how-the-mundane-trend-is-bringing-some-christmas-sparkle-for-everyday-brands",target:"_blank",rel:"noreferrer noopener",children:"highly coveted"}),", semi-ironic streetwear. They may be ugly, but they carry a lot of emotional baggage."]}),w.jsx("p",{className:Ybe,children:"The lesson for logo designers? Draw inspiration from style movements but remain boldly true to the brand. It takes integrity and flair to create an icon that sears itself into the world's retinas."}),w.jsx("hr",{}),w.jsxs("p",{className:Ybe,children:["Did you enjoy this collection of logo redesigns? Our team at Kapwing, an"," ",w.jsx("a",{href:"https://www.kapwing.com/video-editor",target:"_blank",rel:"noreferrer noopener",children:"online video editor"}),", loves putting out amazing content related to visual design. Learn and read much more on our"," ",w.jsx("a",{href:"https://www.kapwing.com/resources",target:"_blank",rel:"noreferrer noopener",children:"resources section"})," ","and"," ",w.jsx("a",{href:"https://www.kapwing.com/blog",target:"_blank",rel:"noreferrer noopener",children:"blog"}),"."]})]})})}),w.jsx(h8,{})]})},qbe="TwitchStreamers-module_wrapper_NJGqb",Xbe="TwitchStreamers-module_container_M3p03",Qbe="TwitchStreamers-module_content_9kfTu",Zbe="TwitchStreamers-module_headerImage_K7nx9",eTe="TwitchStreamers-module_date_pmO97",tTe="TwitchStreamers-module_header_zbyx0",oTe="TwitchStreamers-module_firstP_D1c2V",aTe="TwitchStreamers-module_p_qY6qC",iTe="TwitchStreamers-module_iframeContainer_jo6-0",sTe="TwitchStreamers-module_iframe_pN7av",nTe="TwitchStreamers-module_bannerImage_REcA4",rTe="TwitchStreamers-module_longIframe_tzqyt",lTe=()=>{const e="Enter your annual salary into this interactive tool, and we’ll compare your meager earnings to that of Twitch’s highest earner, RanbooLive. Then, while you’re drying your tears, scroll on to see the rest of our comparisons.";return w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:"Which Twitch Streamers Earn the Most per Hour? — Kapwing"}),w.jsx("meta",{name:"description",content:e}),w.jsx("meta",{name:"keywords",content:"twitch earnings, streamers income, twitch salary"}),w.jsx("meta",{property:"og:title",content:"Which Twitch Streamers Earn the Most per Hour? — Kapwing"}),w.jsx("meta",{property:"og:description",content:e}),w.jsx("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/neomam/twitch/twitch-og-image-min.jpeg"}),w.jsx("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/neomam/twitch/twitch-og-image-min.jpeg"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/how-much-twitch-streamers-make"})]}),w.jsx(Q9,{}),w.jsx("div",{className:qbe,children:w.jsx("div",{className:Xbe,children:w.jsxs("div",{className:Qbe,children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/Header_Highest-Earning-Twitch-Streamers.86c050a1.png",alt:"Twitch Revenue Streams",className:Zbe}),w.jsx("div",{className:eTe,children:"24 January 2022"}),w.jsx("h1",{className:tTe,children:"Which Twitch Streamers Earn the Most per Hour?"}),w.jsxs("p",{className:oTe,children:["Enter your annual salary into this interactive tool, and we’ll compare your meager earnings to that of Twitch’s highest earner,"," ",w.jsx("a",{href:"https://www.twitch.tv/ranboolive",target:"_blank",rel:"noopener noreferrer",children:"RanbooLive"}),". Then, while you’re drying your tears, scroll on to see the rest of our comparisons."]}),w.jsx("div",{className:iTe,children:w.jsx("iframe",{title:"Twitch Income Calculator",frameBorder:0,src:"https://nnm-twitch-streamers.netlify.app/calculator/",scrolling:"no",className:sTe})}),w.jsxs("p",{className:aTe,children:["Twitch is Amazon’s hugely popular games streaming platform. It’s a closed universe where semi-anonymous teens become low-key celebrities off the back of their charm and gaming prowess. But curtain-twitchers saw how the platform rewards its personalities when hackers stole a bunch of ‘",w.jsx("a",{href:"https://blog.twitch.tv/en/2021/10/15/updates-on-the-twitch-security-incident/",target:"_blank",rel:"noopener noreferrer",children:"creator payout data"}),"’ from the site in October 2021."]}),w.jsxs("p",{className:aTe,children:["The leak seems to reveal that half of the streamer earnings on Twitch go to just"," ",w.jsx("a",{href:"https://techcrunch.com/2021/10/07/twitch-streamers-respond-after-huge-leak-of-creator-payout-data/",target:"_blank",rel:"noopener noreferrer",children:"10% of the streamers"}),". According to some creators, this indicates that Twitch is more invested in driving viewers to superstar channels than boosting discoverability for up-and-coming talent – including marginalized groups."]}),w.jsxs("p",{className:aTe,children:["But those outside of the story are dizzied by the mindboggling earnings of the top streamers compared to the hours they spend streaming. For example,"," ",w.jsx("a",{href:"https://www.twitch.tv/pokimane",target:"_blank",rel:"noopener noreferrer",children:"pokimane"})," ","spent 2,177 hours online in the 15 months leading to October 2020, earning $1.53m – which works out at $702.02 per hour. A teacher would need to work 29 hours for every pokimane hour to earn that much."]}),w.jsxs("p",{className:aTe,children:["Well, nobody said that celebrities are supposed to earn normal salaries. But, our team at"," ",w.jsx("a",{href:"https://www.kapwing.com",children:"Kapwing"})," got curious about how these figures compare to more regular modes of employment. So, we figured out the effective hourly rates of Twitch’s 100 biggest earners and made some tools to help you visualize them."]}),w.jsx("h2",{id:"ranboolives-hourly-wage",children:"RanbooLive has Twitch’s Highest ‘Hourly Wage’"}),w.jsxs("p",{className:aTe,children:["When news of the Twitch leak dropped, Ranboo tweeted an image of some masking tape with the caption, “",w.jsx("a",{href:"https://twitter.com/ranboosaysstuff/status/1445763636849348609?lang=en",target:"_blank",rel:"noopener noreferrer",children:"Dont worry everyone ill fix the leak."}),"” With Twitch earnings of $2,401,021.84, he can afford a million rolls of tape if he even cares that folk know his income."]}),w.jsxs("p",{className:aTe,children:["Little else is known about the Minecraft-playing Twitch star, who wears a monochrome mask and shades to protect his privacy and cope with dysmorphia. However, he has teased a big reveal at 5 million followers (",w.jsx("a",{href:"https://twitter.com/Ranboosaysstuff/status/1465015825622962179",target:"_blank",rel:"noopener noreferrer",children:"he’s just reached 4m"}),"). Divided across his 1,001 hours of streaming, Ranboo earns $2,398.62/hour."]}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/twitch/01_Highest-Earning-Twitch-Streamers_Static_Top-20.2b421d3a.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{alt:"Which Twitch Streamers Earn the Most per Hour?",src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/01_Highest-Earning-Twitch-Streamers_Static_Top-20.2b421d3a.png",className:nTe})}),w.jsx("p",{className:aTe,children:"Twitch’s 10 highest earners earn an average of $1,477 per hour of streaming. Even when you even the earnings out across the top 50, you still get an average rate of $732/hour. The top 10 streamed for an average of 2,709 hours (1st Aug 2019 - 1st Oct 2020), while the top 50 worked an average of 3,719 hours."}),w.jsxs("p",{className:aTe,children:["Twitch’s partner scheme offers"," ",w.jsx("a",{href:"https://www.businessinsider.com/twitch-raises-incentives-for-creators-2017-4?r=US&IR=T",target:"_blank",rel:"noopener noreferrer",children:"varying"})," ","splits on subscription earnings, depending on the popularity of the streamer. Some claim that highly popular streamers can negotiate this split, which may be how the highest earners capitalize on streaming for relatively few hours."]}),w.jsx("h2",{id:"it-takes-a-doctor-67-hours",children:"RanbooLive has Twitch’s Highest ‘Hourly Wage’"}),w.jsx("p",{className:aTe,children:"Next, we figured out how RanbooLive’s effective hourly rate compares to that of more common American jobs. For example, a doctor earns $35.90/hour on average. They would need to work 67 hours to match what Ranboo earns from an hour of streaming. Looked at another way, in the time it takes Ranboo to earn $35.90, a doctor earns just 54 cents."}),w.jsx("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/twitch/02_Highest-Earning-Twitch-Streamers_Static_Table-US.e07e6a40.png",target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{alt:"Hourly Pay of Twitch's Top Streamer vs. Common US Professions",src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/02_Highest-Earning-Twitch-Streamers_Static_Table-US.e07e6a40.png",className:nTe})}),w.jsxs("p",{className:aTe,children:["And that’s for a doctor. Waiting staff earn an average of $15/hour, so they’d need to work 160 hours to match Ranboo. Teachers – trusted with the future of our children and our culture – need to put in 99 hours at $24.34 to earn a Ranboo hour. The problem is not so much the freak earnings of Ranboo, but the low compensation to the mass of America’s workers,"," ",w.jsx("a",{href:"https://www.brookings.edu/blog/the-avenue/2019/11/21/low-wage-work-is-more-pervasive-than-you-think-and-there-arent-enough-good-jobs-to-go-around/",target:"_blank",rel:"noopener noreferrer",children:"nearly half"})," ","of whom earn less than it takes to achieve ‘economic security.’"]}),w.jsx("h2",{id:"the-boss-of-it-all",children:"The Boss of It All"}),w.jsx("p",{className:aTe,children:"The highest earner in the Twitchosphere is the owner of its parent company, Amazon. But does anyone care what Jeff Bezos earns anymore? Like picturing the universe, imagining Bezos’ income is an tough task."}),w.jsxs("p",{className:aTe,children:["Still, Amazon’s payroll remains of interest. Not just the company’s"," ",w.jsx("a",{href:"https://www.nytimes.com/2021/10/24/technology/amazon-employee-leave-errors.html",target:"_blank",rel:"noopener noreferrer",children:"failure"})," ","to honor even the low wages of its regular workers, but the distribution of wealth and opportunity across Twitch’s creator community. And what it means for the rest of us average Joe’s, who would love to earn $2k doing what we love for an hour or so…"]}),w.jsx("p",{className:aTe,children:"For our full analysis of the leaked Twitch streamer earnings, check out the table below."}),w.jsx("div",{className:iTe,children:w.jsx("iframe",{title:"Twitch Income Calculator",frameBorder:0,src:"https://nnm-twitch-streamers.netlify.app/table/",scrolling:"yes",className:rTe})}),w.jsx("h2",{id:"methodology-&-sources",children:"Methodology & Sources"}),w.jsxs("p",{className:aTe,children:["We used data from the recent"," ",w.jsx("a",{href:"https://twitter.com/Sinoc229/status/1445639738707251200",target:"_blank",rel:"noopener noreferrer",children:"Twitch data leak"})," ","to discover the top 100 earning Twitch streamers. Then we used"," ",w.jsx("a",{href:"https://twitchtracker.com/xqcow/statistics",target:"_blank",rel:"noopener noreferrer",children:"Twitch Tracker"})," ","to find out how long each Twitch streamer spent streaming during the time period used for the leaked figures (August 2019 to October 2021). We took the earnings for each streamer and divided it by the number of hours streamed. The average earnings for UK and US professions came from"," ",w.jsx("a",{href:"https://uk.talent.com/",target:"_blank",rel:"noopener noreferrer",children:"Talent.com"}),"."]}),w.jsx("hr",{}),w.jsxs("p",{className:aTe,children:["Did you enjoy this deep dive into the incomes of popular Twitch streamers? Our team at Kapwing, an"," ",w.jsx("a",{href:"https://www.kapwing.com/video-editor",target:"_blank",rel:"noreferrer noopener",children:"online video editor"}),", loves creating content related to video and internet culture. Learn and read much more on our"," ",w.jsx("a",{href:"https://www.kapwing.com/resources",target:"_blank",rel:"noreferrer noopener",children:"resources section"})," ","and"," ",w.jsx("a",{href:"https://www.kapwing.com/blog",target:"_blank",rel:"noreferrer noopener",children:"blog"}),"."]})]})})}),w.jsx(h8,{})]})},dTe=_.memo((({statusCode:e=301,to:t,...o})=>{const a=h.useCallback((({staticContext:a})=>(a&&Object.assign(a,{statusCode:e,to:t}),w.jsx(Aa,{to:t,...o}))),[o,e,t]);return w.jsx(Yt,{render:a})})),cTe=()=>{Wu();!function(e){amplitude.getInstance().setUserProperties({...e,maxExportDurationNonPro:240})}(Uu())},uTe="TeamInviteAccept-module_backgroundContainer_31pn3",mTe="TeamInviteAccept-module_contentContainer_1ikwb",pTe="TeamInviteAccept-module_bodyContainer_AfTrk",hTe="TeamInviteAccept-module_logoContainer_Dt-0q",gTe="TeamInviteAccept-module_logoHeader_Kc-WT",fTe="TeamInviteAccept-module_header_MPn3m",yTe="TeamInviteAccept-module_description_UGulf",vTe="TeamInviteAccept-module_acceptButton_fQelc",_Te="TeamInviteAccept-module_acceptLoading_k-nZG",wTe=(e,t)=>{const o=t===ppe.EMAIL?`/api/v1/invites/teams/checkLink?inviteKey=${e}`:`/api/v1/team-invite-links/invite/${e}`,a=Ve(),i=il(),s=tl((e=>e.currentUser)),[n,r]=h.useState(null),[l,d]=h.useState(!0),[c,u]=h.useState(null),{isLoading:m,data:p,error:g}=Efe(o),[f,y]=h.useState(null);return h.useEffect((function(){(async()=>{try{if(g&&d(!1),m||wc(s)||d(!1),!p||m||!wc(s))return;const{inviterEmail:e,teamId:t,alreadyInTeam:o}=p;if(o)i(Ip(t)),a.push("/home");else{const o=await function(e){return Yr(`/api/v2/teams/dto/${e}`,{params:{limited:!0}})}(t);u(o);const a=await async function(e){return(await Yr(`/api/v1/users/getUserByEmail?email=${e}`)).user}(e);r(a),i({type:"SET_SHARED_TEAM_OWNER_EMAIL",sharedTeamOwnerEmail:e}),i({type:"SET_SHARED_TEAM_ID",sharedTeamId:t}),d(!1)}}catch(e){y(e),d(!1)}})()}),[p,m,s,i,a,g]),{isFetching:m||l,inviteInfo:p,teamInfo:c,inviterInfo:n,error:g||f}},bTe=()=>{const{inviteKey:e,linkId:t}=ua(),o=il(),a=tl((e=>e.teams.allTeams)),i=Ve(),{location:s}=i,{search:n}=s,r="?redirect=from-joining",l=n===r,d=tl((e=>e.currentUser)),{onboarding:c}=d.user,[u,m]=h.useState(!1),{isFetching:p,inviteInfo:g,error:f}=wTe(e??t,e?ppe.EMAIL:ppe.LINK),{acceptingInvite:y,acceptInvite:v}=gpe(),{pushWithSource:_}=_oe(),b=h.useCallback((async()=>{!((null==c?void 0:c.survey)||(null==c?void 0:c.skipped))&&(await FK({skipped:!0}),await np()),_("/home",e?voe.EMAIL_INVITE:voe.INVITE_LINK)}),[e,null==c?void 0:c.skipped,null==c?void 0:c.survey,_]),T=h.useCallback((async()=>{if(wc(d)){const o=!((null==c?void 0:c.survey)||(null==c?void 0:c.skipped)),a={onSuccess:b,withoutToast:o};await v(e??t,e?hpe.EMAIL:hpe.LINK,a)}else m(!0)}),[v,d,b,e,t,c]);h.useEffect((function(){(async()=>{!l||p||y||await T()})()}),[y,a,o,T,p,l,c]),h.useEffect((function(){!p&&g&&((e,t,o,a)=>{const i=$s(e.email,o),s={"Team ID":t,"Team Owner Email":o,"Team Collaborator Email":e.email||"Anonymous","Owner And Collaborator Domain Match":i,"Entry Point":a};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Team Invite Visited",s)})(d.user,g.teamId,g.inviterEmail,e?"Email Invite Link":"Copied Link")}),[d,g,e,p]);const x=h.useCallback((()=>{m(!1)}),[]),S=h.useCallback((()=>i.push(`${s.pathname}?redirect=from-joining`)),[i,s.pathname,r]),E=()=>w.jsx(bV,{hideSignIn:x,immediateRedirectPathname:`${s.pathname}?redirect=from-joining`,onSuccess:S});return p?w.jsx(Y4,{}):w.jsxs(w.Fragment,{children:[w.jsx(Q9,{}),w.jsx("div",{className:uTe,children:w.jsx("div",{className:mTe,children:w.jsxs("div",{className:pTe,children:[w.jsx("div",{className:hTe,children:w.jsx("img",{alt:"Kapwing Logo",className:gTe,src:"https://cdn-useast1.kapwing.com/static/9_y-transparent-logo.webp"})}),f?(()=>{const t=e?"invite":"invite link";return w.jsxs("div",{"data-testid":"invalid-invite",children:[w.jsxs("div",{className:fTe,children:["This ",t," is invalid"]}),w.jsxs("div",{className:yTe,children:["This ",t," seems to be broken. It's possible that the team has been moved or that you no longer have permission to access this workspace. Reach out to the team admin for a new ",t,"."]}),w.jsx(Ft,{to:"/",children:w.jsx("div",{className:vTe,"data-cy":"home-button",children:"Go Home"})})]})})():w.jsxs("div",{"data-testid":"valid-invite",children:[w.jsxs("div",{className:fTe,children:["You've been invited to join ",w.jsx("strong",{children:null==g?void 0:g.name})," on Kapwing"]}),w.jsx("div",{className:yTe,children:"Kapwing works better as a team. By joining this team workspace, you'll be able to create new content and view, edit, and delete existing content. You can also invite new members and collaborate on content together."}),w.jsx("div",{className:yTe,children:wc(d)?w.jsxs(w.Fragment,{children:["By continuing, you will join this workspace with the account"," ",w.jsx("b",{children:d.user.email}),"."]}):"By continuing, you will sign in and become a member of this workspace."}),y?w.jsx("div",{className:_Te,children:w.jsx(MU,{})}):w.jsx("div",{className:vTe,onClick:T,"data-testid":"join-button",children:"Join Team Workspace"}),u&&E()]})]})})}),w.jsx(h8,{})]})},TTe="InstalledPWAHome-module_background_ya0I9",xTe="InstalledPWAHome-module_backgroundImage_SC592",STe="InstalledPWAHome-module_signInContainer_LEoHq",ETe="InstalledPWAHome-module_signInLogoContainer_6PvKS",ITe="InstalledPWAHome-module_signInLogo_8Xyag",CTe="InstalledPWAHome-module_signInText_VotiI",kTe="InstalledPWAHome-module_text_CQ2oc",ATe=_.memo((()=>{const[e,t]=_.useState(!1);return w.jsxs(w.Fragment,{children:[w.jsx(Mt,{children:w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/"})}),w.jsxs("div",{className:TTe,children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/home/Frame%202.png",alt:"",className:xTe}),w.jsxs("div",{className:STe,children:[w.jsxs("div",{className:ETe,children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",className:ITe,alt:"Kapwing Logo"})," ","KAPWING"]}),w.jsx("div",{className:CTe,children:w.jsx("div",{className:kTe,children:"Trusted by millions of users, Kapwing makes content creation and video editing smart, accessible, and collaborative. Sign in below to continue to the official Play Store app."})}),w.jsx(cV,{ssoSignIn:e,setSSOSignIn:t})]})]})]})})),jTe=_.memo((()=>{var e;const{currentUser:t}=tl((e=>({currentUser:e.currentUser})),ol),o=Ve(),a=il(),[i,s]=h.useState(!0),[n,r]=h.useState(),[l,d]=h.useState(!1),{userId:c}=ua();h.useEffect((()=>{(async()=>{var e;if(null==(e=t.user)?void 0:e.onboarding)d(!0),s(!1);else{const e=await ah();e.length&&r(e[0]),s(!1)}})()}),[null==(e=t.user)?void 0:e.onboarding,a]);const u=h.useMemo((()=>n&&!l?w.jsx(Aa,{to:{pathname:`/team/invite/new-user/${n.inviteKey}`,state:o.location.state}}):w.jsx(Aa,{to:{pathname:"/home",state:o.location.state}})),[o.location.state,l,n]);if(i)return w.jsx(Y4,{});if(wc(t))return u;if("undefined"!=typeof window){if(["4000"].includes(window.location.port)||c)return wl({description:"You're developing locally on localhost:4000. In prod, this page would refresh and show the NextJS home page as you are not currently signed in. If you want to test this behavior, run 'yarn nginx' in the root directory and use port 3000.",type:"warning"}),w.jsx(Aa,{to:"/signin"});window.location.href="/"}return null}));function NTe(e){const t=h.useRef();return h.useEffect((()=>{t.current=e}),[e]),t.current}const RTe="AccountSettings-module_container_5VbXV",PTe="AccountSettings-module_pageHeader_VXSX1",DTe="AccountSettings-module_sectionHeader_OwDPi",OTe="AccountSettings-module_sectionContent_by-VJ",LTe="AccountSettings-module_subItem_bahuF",FTe="AccountSettings-module_deleteAccountLink_Mb-r9",MTe="NotificationSettings-module_notificationsTable_ec0zC",UTe="NotificationSettings-module_helpIcon_0BYJn",BTe="NotificationSettings-module_exportTooltip_rnuUR",VTe="NotificationSettings-module_disabledHeader_3PTr7",WTe="NotificationSettings-module_disabledOption_nvRXx",GTe="NotificationSettings-module_switch_3MQ3k",HTe="NotificationSettings-module_slider_h8jlO",$Te=_.memo((({checked:e,onSwitch:t,disabled:o})=>{const a=h.useRef(!1);return w.jsxs("label",{className:`${GTe} ${o?WTe:""}`,children:[w.jsx("input",{type:"checkbox",checked:e,onChange:async()=>{a.current||(a.current=!0,await t(!e),a.current=!1)},disabled:o}),w.jsx("span",{className:HTe})]})})),KTe=_.memo((()=>{var e,t,o,a,i,n,r,l;const d=tl((e=>e.currentUser.user)),c=tl(vQ),u=!!(null==d?void 0:d.email),[m,p]=h.useState(!1),[g,f]=h.useState(void 0),[y,v]=h.useState(!1),_=h.useCallback((async()=>{try{const{failed:e,isUnsubscribed:t}=await async function(e){try{return await Yr("/api/v1/users/marketingEmailPreferences",{params:{email:e}})}catch(IGe){return!1}}(d.email);f(t),v(e)}catch(IGe){console.error(IGe)}}),[d.email]);h.useEffect((()=>{c&&u&&_()}),[c,u,_]);const b=h.useCallback((e=>dp(xl.Comment,e,Tl.InApp)),[]),T=h.useCallback((e=>dp(xl.Comment,e,Tl.Email)),[]),x=h.useCallback((()=>{p(!0)}),[]),S=h.useCallback((()=>{p(!1)}),[]),E=h.useCallback((e=>dp(xl.Export,e,Tl.InApp)),[]),I=h.useCallback((e=>dp(xl.Export,e,Tl.Email)),[]),C=h.useCallback((e=>dp(xl.Joined,e,Tl.InApp)),[]),k=h.useCallback((e=>dp(xl.Joined,e,Tl.Email)),[]),A=h.useCallback((e=>dp(xl.Request,e,Tl.InApp)),[]),j=h.useCallback((e=>dp(xl.Request,e,Tl.Email)),[]),N=h.useMemo((()=>s.throttle((async e=>{f(!e),await async function(e,t){try{await Jr("/api/v1/users/marketingEmailPreferences",{body:{email:e,unsubscribe:t}})}catch(IGe){console.error(IGe)}}(d.email,!e)}),1e3)),[d.email]);return w.jsxs("table",{className:MTe,children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{children:"Notifications"}),w.jsx("th",{children:"IN APP"}),w.jsx("th",{className:u?"":VTe,children:"EMAIL"})]})}),w.jsxs("tbody",{children:[w.jsxs("tr",{children:[w.jsx("td",{children:"Comment notifications"}),w.jsx("td",{children:w.jsx($Te,{checked:!(null==(e=d.optOutNotifs)?void 0:e.includes(xl.Comment)),onSwitch:b})}),w.jsx("td",{children:w.jsx($Te,{checked:u&&!(null==(t=d.optOutEmails)?void 0:t.includes(xl.Comment)),onSwitch:T,disabled:!u})})]}),w.jsxs("tr",{children:[w.jsxs("td",{children:["Export finished"," ",w.jsx(Qe,{size:16,className:UTe,onMouseEnter:x,onMouseLeave:S}),m&&w.jsx("div",{className:BTe,children:"Notifications will only be sent out if project export fails or takes longer than 60 seconds to complete."})]}),w.jsx("td",{children:w.jsx($Te,{checked:!(null==(o=d.optOutNotifs)?void 0:o.includes(xl.Export)),onSwitch:E})}),w.jsx("td",{children:w.jsx($Te,{checked:u&&!(null==(a=d.optOutEmails)?void 0:a.includes(xl.Export)),onSwitch:I,disabled:!u})})]}),w.jsxs("tr",{children:[w.jsx("td",{children:"Team member joined"}),w.jsx("td",{children:w.jsx($Te,{checked:!(null==(i=d.optOutNotifs)?void 0:i.includes(xl.Joined)),onSwitch:C})}),w.jsx("td",{children:w.jsx($Te,{checked:u&&!(null==(n=d.optOutEmails)?void 0:n.includes(xl.Joined)),onSwitch:k,disabled:!u})})]}),w.jsxs("tr",{children:[w.jsx("td",{children:"Request notifications"}),w.jsx("td",{children:w.jsx($Te,{checked:!(null==(r=d.optOutNotifs)?void 0:r.includes(xl.Request)),onSwitch:A})}),w.jsx("td",{children:w.jsx($Te,{checked:u&&!(null==(l=d.optOutEmails)?void 0:l.includes(xl.Request)),onSwitch:j,disabled:!u})})]}),c&&w.jsxs("tr",{children:[w.jsx("td",{children:"Product tips and updates"}),w.jsx("td",{}),w.jsx("td",{children:w.jsx($Te,{checked:u&&void 0!==g&&!g,onSwitch:N,disabled:!u||y||void 0===g})})]})]})]})})),zTe="EditableProfilePictureEditor-module_wrapper_kc-FQ",YTe="EditableProfilePictureEditor-module_editor_VdqAy",JTe="EditableProfilePictureEditor-module_frameTop_svxIJ",qTe="EditableProfilePictureEditor-module_frameBottom_u6Gbr",XTe="EditableProfilePictureEditor-module_windowRow_Cm6Et",QTe="EditableProfilePictureEditor-module_frameLeft_rmRpu",ZTe="EditableProfilePictureEditor-module_frameRight_Iye8W",exe="EditableProfilePictureEditor-module_image_t3MN-",txe="EditableProfilePictureEditor-module_squareWindow_MV-Jm",oxe="EditableProfilePictureEditor-module_controlsWrapper_-0jdE",axe="EditableProfilePictureEditor-module_controlsHeader_s9AgJ",ixe="EditableProfilePictureEditor-module_controls_TyiHq",sxe="EditableProfilePictureEditor-module_zoom_xHKPt",nxe="EditableProfilePictureEditor-module_position_6cBLJ",rxe="EditableProfilePictureEditor-module_label_NGo2n",lxe="EditableProfilePictureEditor-module_button_G0nuo",dxe="EditableProfilePictureEditor-module_arrow_3-yIm",cxe="EditableProfilePictureEditor-module_footer_qC1qN",uxe="EditableProfilePictureEditor-module_submit_9y1ps",mxe="EditableProfilePictureEditor-module_uploading_eaAOr",pxe="EditableProfilePictureEditor-module_cancel_70r8X",hxe=_.memo((({inputFile:e,image:t,cancel:o})=>{const[a,i]=h.useState({width:0,height:0,top:0,left:0}),[s,n]=h.useState(0),[r,l]=h.useState(!1),{token:d}=tl((e=>e.currentUser)),c=il(),u=h.useRef(null);h.useEffect((()=>{const e=new Image;e.onload=()=>{i({...m(e.width,e.height)})},e.src=t}),[t]);const m=(e,t)=>{let o=200,a=200;e>t?o=Math.round(200*e/t):e<t&&(a=Math.round(200*t/e));let i=50,s=180;if(u&&u.current){const e=u.current.offsetWidth;i=(u.current.offsetHeight-a)/2,s=(e-o)/2}return{width:o,height:a,top:i,left:s}},p=()=>{let e=560,t=300;u&&u.current&&(e=u.current.offsetWidth,t=u.current.offsetHeight);const o=(e-200)/2,a=(t-200)/2;return{leftSide:o,rightSide:o+200,topSide:a,bottomSide:a+200}};return w.jsxs("div",{className:zTe,children:[w.jsxs("div",{className:YTe,ref:u,children:[w.jsx("img",{src:t,className:exe,alt:"New Profile Pic",style:{...a}}),w.jsx("div",{className:JTe}),w.jsxs("div",{className:XTe,children:[w.jsx("div",{className:QTe}),w.jsx("div",{className:txe}),w.jsx("div",{className:ZTe})]}),w.jsx("div",{className:qTe})]}),w.jsxs("div",{className:oxe,children:[w.jsx("div",{className:axe,children:"Use the controls below to adjust your new profile image:"}),w.jsxs("div",{className:ixe,children:[w.jsxs("div",{className:sxe,children:[w.jsx("div",{className:rxe,children:"Zoom:"}),w.jsxs("div",{className:lxe,onClick:()=>{const{width:e,height:t,top:o,left:s}=a,n=e+10,r=Math.round(t/e*n);i({width:n,height:r,top:o-(r-t)/2,left:s-5})},children:[w.jsx(ja,{})," Zoom In"]}),w.jsxs("div",{className:lxe,onClick:()=>{const{width:e,height:t,top:o,left:s}=a,n=e-10,r=Math.round(t/e*n),l=o-(r-t)/2,d=s+5,{leftSide:c,rightSide:u,topSide:m,bottomSide:h}=p();d>c||d+n<u||l>m||l+r<h||i({width:n,height:r,top:l,left:d})},children:[w.jsx(Na,{})," Zoom Out"]})]}),w.jsxs("div",{className:nxe,children:[w.jsx("div",{className:rxe,children:"Position:"}),w.jsx("div",{className:lxe,onClick:()=>{const{top:e}=a;let t=e+10;const{topSide:o}=p();t>o&&(t=o),i((e=>({...e,top:t})))},children:w.jsx(Ra,{className:dxe})}),w.jsx("div",{className:lxe,onClick:()=>{const{top:e,height:t}=a;let o=e-10;const{bottomSide:s}=p();o+t<s&&(o=s-t),i((e=>({...e,top:o})))},children:w.jsx(Pa,{className:dxe})}),w.jsx("div",{className:lxe,onClick:()=>{const{left:e}=a;let t=e+10;const{leftSide:o}=p();t>o&&(t=o),i((e=>({...e,left:t})))},children:w.jsx(Da,{className:dxe})}),w.jsx("div",{className:lxe,onClick:()=>{const{left:e,width:t}=a;let o=e-10;const{rightSide:s}=p();o+t<s&&(o=s-t),i((e=>({...e,left:o})))},children:w.jsx(Oa,{className:dxe})})]})]})]}),w.jsxs("div",{className:cxe,children:[w.jsx("div",{className:pxe,onClick:o,children:"Cancel"}),r?w.jsxs("div",{className:mxe,children:["Uploading ... ",s,"%"]}):w.jsx("div",{className:uxe,onClick:async()=>{try{l(!0);const i=(e,t,o)=>fetch(e).then((e=>e.arrayBuffer())).then((e=>new File([e],t,{type:o}))),s=await i(t,e.name,e.type),r=new FormData;let m;if(r.append("file",s),u&&u.current){const{left:e,top:t,width:o,height:i}=a,s=u.current.offsetWidth,n=u.current.offsetHeight;m={relativeLeftCrop:(s-200)/2-e,relativeTopCrop:(n-200)/2-t,relativeWidth:o,relativeHeight:i}}r.append("cropInfo",JSON.stringify(m));const p=new XMLHttpRequest;await new Promise(((e,t)=>{p.upload.onprogress=e=>{e.lengthComputable&&n(Math.floor(e.loaded/e.total*100))},p.addEventListener("loadend",(()=>{n(0);const t=JSON.parse(p.response);e(t)})),p.onreadystatechange=()=>{4===p.readyState&&200!==p.status&&(l(!1),t(new Error(p.responseText)))},p.open("POST","/api/v1/users/uploadProfilePicture",!0),p.setRequestHeader("x-access-token",d),p.send(r)}))&&(c(wl({description:"Upload complete!",type:"success"})),l(!1),o(),np(),Fm(ym.USER_UPDATE,{property:"picture"}))}catch(IGe){mh({description:"Error updating profile picture",error:IGe}),l(!1)}},children:"Upload Image"})]})]})})),gxe="EditableProfilePictureOverlay-module_container_vKLx-",fxe="EditableProfilePictureOverlay-module_header_OKDhI",yxe="EditableProfilePictureOverlay-module_uploader_d4k3-",vxe="EditableProfilePictureOverlay-module_icon_2zLZD",_xe="EditableProfilePictureOverlay-module_filePickerButton_fOdAn",wxe="EditableProfilePictureOverlay-module_filePickerInput_69zY6",bxe="EditableProfilePictureOverlay-module_buttonSubheader_-IIDX",Txe=_.memo((({closeModal:e})=>{const[t,o]=h.useState(null),[a,i]=h.useState(""),s=async e=>{if(e&&e.target&&e.target.files&&e.target.files.length){const t=e.target.files[0];o(t);const a=new FileReader;a.onload=e=>{if(e&&e.target&&e.target.result){const t=e.target.result;i(t)}},a.readAsDataURL(t)}};return w.jsx(nM,{overlayContainerSmall:!0,usePortal:!0,unsetCancelModal:e,children:w.jsxs("div",{className:gxe,children:[w.jsx("div",{className:fxe,children:"Choose a new profile picture"}),a?w.jsx(hxe,{inputFile:t,image:a,cancel:e}):w.jsxs("div",{className:yxe,children:[w.jsxs("button",{type:"button",className:_xe,children:[w.jsxs("div",{children:[w.jsx(La,{className:vxe})," Select an image"]}),w.jsx("div",{className:bxe,children:"JPG, PNG, WEBP, GIF supported"})]}),w.jsx("input",{type:"file",onChange:s,className:wxe,accept:"image/jpeg, image/png, image/webp, image/gif"})]})]})})})),xxe="EditableProfilePicture-module_container_JTyhj",Sxe="EditableProfilePicture-module_containerOverlay_ufXRZ",Exe="EditableProfilePicture-module_profileImage_lfy1f",Ixe=_.memo((()=>{const[e,t]=h.useState(!1),o=h.useCallback((()=>{t(!1)}),[]);return w.jsxs("div",{children:[w.jsxs("div",{className:xxe,onClick:()=>{t(!0)},children:[w.jsx(b9,{suggestedWidth:300,suggestedHeight:300,className:Exe}),w.jsx("div",{className:Sxe,children:w.jsx(Fa,{})})]}),e?w.jsx(Txe,{closeModal:o}):null]})})),Cxe="ProfileInformation-module_wrapper_Lc-LR",kxe="ProfileInformation-module_container_ukgY6",Axe="ProfileInformation-module_accountText_JBrMd",jxe="ProfileInformation-module_editIcon_Oxj9B",Nxe="ProfileInformation-module_editableText_NLNEW",Rxe="ProfileInformation-module_hovered_hFRfr",Pxe="ProfileInformation-module_email_sJf09",Dxe="ProfileInformation-module_fullName_Tfelb",Oxe="ProfileInformation-module_overlayAltButton_dg4ti",Lxe="ProfileInformation-module_overlayControls_u5d4b",Fxe="ProfileInformation-module_overlayDescription_sbyXu",Mxe="ProfileInformation-module_overlayForm_Q0nuV",Uxe="ProfileInformation-module_overlayHeader_OBbE5",Bxe="ProfileInformation-module_overlayInput_xFGJ4",Vxe="ProfileInformation-module_overlayLabel_rQqSs",Wxe="ProfileInformation-module_overlaySubmitButton_cjsiM",Gxe="ProfileInformation-module_profileInformationContainer_Ml01l",Hxe="ProfileInformation-module_signOutButton_cp5LP",$xe="ProfileInformation-module_note_-y-KP";var Kxe=(e=>(e.Onboarding="onboarding",e.SongCategories="songCategories",e.SFXCategories="sfxCategories",e))(Kxe||{});function zxe(e,t){sessionStorage.setItem(e,JSON.stringify(t))}function Yxe(e){const t=sessionStorage.getItem(e);return t?JSON.parse(t):null}function Jxe(e,t){const o=sessionStorage.getItem(e)??"{}";sessionStorage.setItem(e,JSON.stringify({...JSON.parse(o),...t}))}const qxe=_.memo((({closeOverlay:e})=>{const t=il(),[o,a]=h.useState(!1),[i,s]=h.useState(!1),[n,r]=h.useState(""),[l,d]=h.useState(""),[c,u]=h.useState(!1),m=ou(),{executeRecaptcha:p}=Ce(),g=tl((e=>e.currentUser)),f=tl((e=>e.config.RECAPTCHA_V3_SITEKEY)),y=tl((e=>e.config.RECAPTCHA_V2_SITEKEY)),v=h.useRef(null);return w.jsx(nM,{unsetCancelModal:e,overlayContainerSmall:!0,usePortal:!0,children:w.jsxs("div",{className:kxe,children:[w.jsx("div",{className:Uxe,children:"Update email"}),w.jsx("div",{className:Fxe,children:w.jsx("div",{className:$xe,children:o?"Please enter the confirmation code we sent to your email to confirm you want to transfer account ownership to this address. If you did not receive your code, please check your spam folder.":w.jsxs(w.Fragment,{children:["Use this form to update the email address you use to log into your account."," ",w.jsx("span",{children:m.isPaid&&"Please note that changing your account email will not update the billing email for your team. To update your billing email, please visit Billing settings."})]})})}),w.jsxs("form",{className:Mxe,children:[o?w.jsxs("label",{htmlFor:"code-input",className:Vxe,children:["Code:",w.jsx("input",{placeholder:"Code",className:Bxe,value:n,onChange:e=>{return t=e.target.value,void r(t.toUpperCase());var t},id:"code-input"})]}):w.jsxs("label",{htmlFor:"email-input",className:Vxe,children:["New email:",w.jsx("input",{placeholder:"YourNewEmail@example.com",className:Bxe,value:l,onChange:e=>d(e.target.value),id:"email-input"})]}),!o&&c&&w.jsx("div",{style:{marginBottom:"10px"},children:w.jsx(Ae,{sitekey:y,ref:v})}),w.jsxs("div",{className:Lxe,children:[w.jsx("button",{type:"submit",onClick:async i=>{var r;i.preventDefault();const{token:d,user:c}=g,{_id:m}=c||{};if(o){try{s(!0),await Jr("/api/v1/users/updateProfile/email/validateCode",{body:{token:d,userId:m,email:l,code:n},parseJSON:!1}),np(),t(wl({description:"Your email has been updated and you can now sign in with your new email.",type:"success"})),Fm(ym.USER_UPDATE,{property:"email"}),e()}catch(h){mh({description:"Error updating email",error:h})}s(!1)}else if(Yp(l)){try{if(!p)throw new Error("Recaptcha loading ... please try again in a few seconds.");const e=await p("emailSignIn"),t=null==(r=v.current)?void 0:r.getValue();s(!0),await Jr("/api/v1/users/email/signin",{body:{email:l,v3CaptchaToken:e,v2CaptchaToken:t,recaptchaKeyV3:f,recaptchaKeyV2:y}}),a(!0)}catch(h){mh({description:"Error updating email",error:h}),oh(h)&&u(!0)}s(!1)}else t(wl({description:"Please input a valid email address.",type:"error"}))},className:Wxe,children:i?"Loading...":o?"Submit confirmation code":"Update Email"}),!i&&o&&w.jsx("button",{type:"button",onClick:e,className:Oxe,children:"Never mind"})]})]})]})})})),Xxe=_.memo((({closeOverlay:e,firstName:t,lastName:o})=>{const a=il(),[i,s]=h.useState(t||""),[n,r]=h.useState(o||""),[l,d]=h.useState(!1);return w.jsx(nM,{unsetCancelModal:e,overlayContainerSmall:!0,usePortal:!0,children:w.jsxs("div",{className:Cxe,children:[w.jsx("div",{className:Uxe,children:"Update Your Name"}),w.jsx("div",{className:Fxe,children:"Use this form to update the name on your profile."}),w.jsxs("form",{className:Mxe,children:[w.jsxs("label",{htmlFor:"first-name-input",className:Vxe,children:["First Name",w.jsx("input",{placeholder:"First name",className:Bxe,value:i,onChange:e=>s(e.target.value),id:"first-name-input"})]}),w.jsxs("label",{htmlFor:"last-name-input",className:Vxe,children:["Last Name",w.jsx("input",{placeholder:"Last name",className:Bxe,value:n,onChange:e=>r(e.target.value),id:"last-name-input"})]}),w.jsxs("div",{className:Lxe,children:[w.jsx("button",{type:"submit",onClick:async t=>{if(t.preventDefault(),!l){d(!0);try{await async function(e,t){const{state:o}=sr(),{token:a,user:i}=o.currentUser||{},{_id:s}=i||{};await Jr("/api/v1/users/updateProfile/fullName",{body:{token:a,userId:s,firstName:e,lastName:t},parseJSON:!1}),await np()}(i,n),Fm(ym.USER_UPDATE,{property:"name"}),a(wl({description:"Your name has been updated.",type:"success"})),e()}catch(o){mh({description:"Error updating name",error:o})}d(!1)}},className:Wxe,children:l?"Loading...":"Set new account name"}),!l&&w.jsx("button",{type:"button",onClick:e,className:Oxe,children:"Never mind"})]})]})]})})})),Qxe=_.memo((({className:e,children:t,editValue:o,alt:a})=>{const[i,s]=h.useState(!1);return w.jsxs("div",{className:i?`${e} ${Nxe} ${Rxe}`:`${e} ${Nxe}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),onClick:o,translate:"no",children:[t||a,w.jsx(Fa,{className:jxe})]})})),Zxe=_.memo((({currentUser:e,email:t})=>{const o=il(),a=Ve(),[i,s]=h.useState(!1),[n,r]=h.useState(!1),l=h.useCallback((()=>{r(!1)}),[]),d=h.useCallback((()=>{s(!1)}),[]),c=h.useCallback((()=>{r(!0)}),[]),u=h.useCallback((()=>{s(!0)}),[]);return w.jsxs("div",{className:Gxe,children:[n&&w.jsx(Xxe,{closeOverlay:l,firstName:e.user.firstName,lastName:e.user.lastName}),i&&w.jsx(qxe,{closeOverlay:d}),w.jsx(Ixe,{}),w.jsxs("div",{className:Axe,children:[w.jsx(Qxe,{alt:"Add Your Name",className:Dxe,editValue:c,children:Sc(e)}),w.jsx(Qxe,{alt:"Add Email Address",className:Pxe,editValue:u,children:t}),w.jsx(tU,{})]}),w.jsx("div",{onClick:()=>{sessionStorage.clear(),o(Tr()),PU(),window&&window.google&&window.google.accounts.id.disableAutoSelect(),a.push("/")},className:Hxe,"data-cy":"sign-out-button",children:"Sign Out"})]})})),eSe=_.memo((()=>{const{currentUser:e,workspaces:t,currentFolderId:o}=tl((e=>{const t=e.teams.selectedTeamId,o=e.teams.allTeams.find((e=>e._id===t));return{currentUser:e.currentUser,workspaces:e.workspaces,currentFolderId:e.workspaces.selectedWorkspace,allTeams:e.teams.allTeams,currentTeam:o}}),ol),a=Ve(),i=il();h.useState(),h.useEffect((function(){!t.allWorkspaces.length&&o&&xD()}),[o,i,t.allWorkspaces.length]),h.useEffect((()=>{wc(e)||a.push(`/folder/${o}`)}),[e,o,a]);const{user:s}=e||{},n=(null==s?void 0:s.email)||"Signed in with Facebook";return w.jsxs("div",{className:RTe,children:[w.jsx("div",{className:PTe,"data-testid":"account-settings-header",children:"Account Settings"}),w.jsx(Zxe,{currentUser:e,email:n}),w.jsx(KTe,{}),w.jsx("div",{className:DTe,children:"Delete Account"}),w.jsx("div",{className:OTe,children:w.jsx("div",{className:LTe,children:w.jsx("button",{className:FTe,type:"button","data-cy":"delete-account-link",onClick:()=>_h({modalType:gh.DELETE_ACCOUNT}),children:"Delete account and all associated data stored in Kapwing."})})})]})})),tSe=_.memo((({closeAccountSettings:e})=>w.jsx(nM,{usePortal:!0,unsetCancelModal:e,children:w.jsx(eSe,{})}))),oSe="Hub-module_hubContainer_1nL2t",aSe="Hub-module_sidebarSpacer_MjYqb",iSe="Hub-module_mobileSidebarToggle_m3Ny-",sSe="Hub-module_mobileSidebarToggleBtn_3zJU8";const nSe={home:"Modal-module_home_4JMQJ",homeHowBackgroundWhite:"Modal-module_homeHowBackgroundWhite_8TCy1",largeButton:"Modal-module_largeButton_s6TVh",sectionContent:"Modal-module_sectionContent_oVv0S",sectionHeader:"Modal-module_sectionHeader_OOdDr",spacer:"Modal-module_spacer_Scsus",chevron:"Modal-module_chevron_V4qbo",splashText:"Modal-module_splashText_KNYtI",splashSubtext:"Modal-module_splashSubtext_f5BhF",aboutSection:"Modal-module_aboutSection_hvla1",mobile:"Modal-module_mobile_wYOc2",desktop:"Modal-module_desktop_G7Esl",screenReaderOnlyLabel:"Modal-module_screenReaderOnlyLabel_rpv-L",disabled:"Modal-module_disabled_THaXg",noScrollBar:"Modal-module_noScrollBar_GuuPP",textOverflowEllipsis:"Modal-module_textOverflowEllipsis_0JTtf",header:"Modal-module_header_ioGmE",teamName:"Modal-module_teamName_ULr6g",disableTextHighlight:"Modal-module_disableTextHighlight_q-OeJ",genericButtonBlue:"Modal-module_genericButtonBlue_jktwV",background:"Modal-module_background_AyKkN",backgroundImage:"Modal-module_backgroundImage_0qm-5",contentContainer:"Modal-module_contentContainer_GaQSZ",mainContent:"Modal-module_mainContent_0KWDi",inputLabel:"Modal-module_inputLabel_b07lz",secondary:"Modal-module_secondary_0Ym5E",container:"Modal-module_container_GfihW",description:"Modal-module_description_SwK-3",descriptionBold:"Modal-module_descriptionBold_HAKUx",closeContainer:"Modal-module_closeContainer_cLsYb",logoPreview:"Modal-module_logoPreview_z2kQp",removeLogo:"Modal-module_removeLogo_unzw-",uploadLogoContainer:"Modal-module_uploadLogoContainer_Q4RgM",uploadLogoInput:"Modal-module_uploadLogoInput_WXliW",uploadLabelHeader:"Modal-module_uploadLabelHeader_IwwPS",buttonsContainer:"Modal-module_buttonsContainer_XBJne",textInput:"Modal-module_textInput_--jAO",form:"Modal-module_form_SuMGf",disabledConfirmButtonMessage:"Modal-module_disabledConfirmButtonMessage_GXt0q",createNewWorkspaceTile:"Modal-module_createNewWorkspaceTile_UQnXf",modal:"Modal-module_modal_jBkFq",modalWithImageContainer:"Modal-module_modalWithImageContainer_ILKVt",right:"Modal-module_right_ajESI",left:"Modal-module_left_5Q4sE",exit:"Modal-module_exit_2hgpP",dark:"Modal-module_dark_Vr6wu",light:"Modal-module_light_WFFRk",modalConfirmButtons:"Modal-module_modalConfirmButtons_gy-8f",modalFlowButtons:"Modal-module_modalFlowButtons_zMLWC",firstStep:"Modal-module_firstStep_nZSiX",continue:"Modal-module_continue_eUkC0",back:"Modal-module_back_hO4-S",dots:"Modal-module_dots_yO7ST",dot:"Modal-module_dot_dgrmi",selected:"Modal-module_selected_fWDG-",mTop16:"Modal-module_mTop16_H6TIY",mTop32:"Modal-module_mTop32_HqUtA",input:"Modal-module_input_HZ2eN",buttonIcon:"Modal-module_buttonIcon_Oiswr",link:"Modal-module_link_Eg0V7",modalContainer:"Modal-module_modalContainer_-qfcq",buttonContainer:"Modal-module_buttonContainer_86bwQ",modalPrimaryButton:"Modal-module_modalPrimaryButton_YC3fT",modalSecondaryButton:"Modal-module_modalSecondaryButton_-5jW8"},rSe=_.createContext({goToNextModal:()=>{},goToPreviousModal:()=>{},goToModalIndex:()=>{},onClose:()=>{},currentModalIndex:-1,modalSteps:[],exists:!1}),lSe=({onClick:e,primaryButtonText:t="Next",secondaryButtonText:o="Back",primaryButtonDisabled:a=!1,loadingText:i})=>{const s=h.useContext(rSe),n=h.useCallback((()=>{e?e():s.goToNextModal()}),[s,e]),r=0===s.currentModalIndex;return w.jsxs("div",{className:`${nSe.modalFlowButtons} ${r&&nSe.firstStep}`,children:[w.jsx(Iie,{buttonText:o,className:nSe.back,onClick:s.goToPreviousModal,testId:"modal-flow-back-button"}),w.jsx("div",{className:nSe.dots,children:s.modalSteps.map(((e,t)=>w.jsx("div",{className:`${nSe.dot} ${s.currentModalIndex===t&&nSe.selected}`,onClick:()=>s.goToModalIndex(t)},t)))}),w.jsx(Iie,{buttonText:i||t,className:`${nSe.continue} ${a&&nSe.disabled}`,onClick:n,testId:"modal-flow-next-button"})]})},dSe=_.memo((({modalSteps:e,onClose:t,onFlowComplete:o=(()=>{}),onFlowDismissed:a=(()=>{}),testId:i})=>{const[s,n]=h.useState(0),r=s===e.length-1,l=0===s,d=h.useCallback((({skipDismissFn:e}={})=>{e&&a(),t()}),[t,a]),c=h.useCallback((()=>{const a=e[s];(null==a?void 0:a.onNext)&&a.onNext(),r?(o(),t()):n((e=>e+1))}),[r,o,s,t,e]),u=h.useCallback((()=>{l||n((e=>e-1))}),[l]),m=e=>{n(e)},p=h.useMemo((()=>({goToNextModal:c,goToPreviousModal:u,goToModalIndex:m,onClose:d,modalSteps:e,currentModalIndex:s,exists:!0})),[c,u,d,e,s]);return w.jsx(rSe.Provider,{value:p,children:w.jsx("div",{"data-testid":i,children:(()=>{const t=e[s];return null==t?void 0:t.modal})()})})})),cSe=_.memo((({previousResponseRef:e,previousCustomResponseRef:t,onClose:o})=>{const a=tl((e=>e.currentUser)),[i,s]=h.useState((null==e?void 0:e.current)??""),[n,r]=h.useState((null==t?void 0:t.current)??""),l=ku(),d=h.useContext(rSe);h.useEffect((function(){Fm(ym.BEGIN_HOW_DID_YOU_HEAR_ABOUT_US)}),[]);const c=d.exists,u=h.useCallback((async t=>{null==t||t.preventDefault(),((e,t)=>{const{state:o}=sr(),{currentUser:a}=o||{},{user:i}=a||{},{_id:s}=i||{},n={"Discovery Path":e,"Custom Response":t};s&&amplitude.getInstance().setUserId(s),amplitude.getInstance().setUserProperties(n),Fm(ym.COMPLETED_HOW_DID_YOU_HEAR_ABOUT_US,n)})(i,n),e&&(e.current=i),d.goToNextModal()}),[i,n,d,e]),m=h.useCallback((e=>{s(e.value)}),[]),p=document.querySelector(".app-container");if(!p){const e="Couldn't find .app-container to mount OnboardingDialog to.";return kr()?console.error(`${e} ${Ar}`):console.error(e),null}const g=()=>{c?d.onClose():o&&o()},f=()=>w.jsxs("div",{className:nSe.modalWithImageContainer,"data-cy":"how-did-you-hear-about-us-modal","data-testid":"how-did-you-hear-about-us-modal",children:[w.jsxs("div",{className:nSe.left,children:[w.jsx("div",{className:nSe.header,children:"We're happy you're here"+((null==a?void 0:a.name)?`, ${a.name}`:".")}),w.jsx("p",{children:"You’re about to create content, quicker and easier. One last thing before we customize your workspace:"}),w.jsxs("div",{children:[w.jsx("div",{className:nSe.inputLabel,children:"How did you hear about us?"}),w.jsx(tt,{"aria-label":"discovery-path-dropdown",onChange:m,styles:DK,options:PK,placeholder:"",theme:e=>OK(e),isSearchable:!l,maxMenuHeight:l?150:250,menuPortalTarget:p})]}),i===AK&&(i===AK?w.jsxs("div",{children:[w.jsx("div",{className:nSe.inputLabel,children:"Please specify below:"}),w.jsx("input",{className:nSe.input,type:"text",name:"Discovery Path Custom Response",placeholder:"",value:n,onChange:({target:e})=>{r(e.value),t&&(t.current=e.value)},autoComplete:"off"})]}):null),w.jsx("form",{className:nSe.form,onSubmit:u,children:w.jsx(Iie,{className:nSe.modalPrimaryButton,onClick:u,testId:"how-did-you-hear-about-us-continue-button",buttonText:"Continue"})})]}),w.jsx("div",{className:nSe.right,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/nij-how-did-you-hear-about-us-modal.webp"\n          )'}}),w.jsx("div",{className:`${nSe.exit} ${nSe.dark}`,onClick:g,children:w.jsx(ve,{})})]});return c?w.jsx(w.Fragment,{children:f()}):w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:o,children:f()})}));var uSe=(e=>(e.LANDING_PAGE_GET_STARTED="LANDING_PAGE_GET_STARTED",e.LANDING_PAGE_ADD_SAMPLE="LANDING_PAGE_ADD_SAMPLE",e.PASTE_LINK="PASTE_LINK",e.UPLOAD_FILES="UPLOAD_FILES",e.EDIT_THIS_TEMPLATE="EDIT_THIS_TEMPLATE",e.WORKSPACE="WORKSPACE",e.ONBOARDING_MODAL="ONBOARDING_MODAL",e.HOME_PAGE="HOME_PAGE",e))(uSe||{});const mSe=({entry:e,template:t,defaultOrigin:o=""})=>{const{dispatch:a}=sr();setTimeout((()=>{switch(e){case"PASTE_LINK":yae({callToAction:Rm.PasteALink});break;case"UPLOAD_FILES":yae({callToAction:Rm.UploadFiles});break;case"WORKSPACE":yae({callToAction:Rm.NewContentWorkspace});break;case"LANDING_PAGE_ADD_SAMPLE":yae({callToAction:Rm.Sample,template:t,originOverride:o});break;case"EDIT_THIS_TEMPLATE":a(zoe("explore")),yae({callToAction:Rm.EditThisTemplate,template:t});break;case"HOME_PAGE":case"LANDING_PAGE_GET_STARTED":a(pS(o)),yae({callToAction:Rm.GetStarted,originOverride:o})}a(vb())})),a(A_())};async function pSe(e){if("templates"===e.origin)return;const{dispatch:t,state:o}=sr();if(!nu(o))return;const a=Object.keys(e.thisProjectCMLFiles||{});0!==a.length&&(await async function(e){return await Jr("/api/v1/cloudMediaLibrary/myMedia/addFiles",{body:{cmlFileIds:e}})}(a),t(jb(a)))}function hSe(e=!1){const{dispatch:t,state:{currentUser:o,studio:a},history:i}=sr();t(_D(!0));const s=!a._id;t(Y_("http")),Zae({currentUser:o,publish:!1,auto:e,createLocation:`studio-save-${e}`}).then((o=>{if(t(J_("http")),t(_D(!1)),s&&pSe(a),iE()){if(!e||s){const e=i.location.pathname,{search:t}=i.location;oE(e,t)}else t(vD(!1));o&&o._id&&fSe(o._id,Mge.FIRST_SAVE)}})).catch((e=>{mh({description:"Failed to save video",error:e})})).finally((()=>{t(_D(!1))}))}function gSe(e){var t,o;return e&&e._id&&e.scenes&&(null==(o=null==(t=e.scenes[0])?void 0:t.layers)?void 0:o.length)>0&&!function(e){for(const t of e)for(const e of t.layers)if(e.uploadPending&&"pastedLink"===e.source)return!0;return!1}(e.scenes)}async function fSe(e,t){const{dispatch:o}=sr();if(!gSe(e))return!1;try{const[a,i]=await Jae(e,Rv.Thumbnail),s=hB(a,i);eq([s],{eventHandlers:{handleFinish:t=>{if(!e._id)return;o(tie(t.url));const[a,i]=O$(t.url),s={image_url:t.url,thumbnail_blob_name:i};aie(e._id,s)},handleError:()=>{e._id&&Fm(ym.GENERATE_THUMBNAIL,{"Video ID":e._id,"Entry Point":t,Success:!1})}},uploadOptions:{analyticsUploadSource:"Thumbnail upload",omitFromIDB:!0,isThumbnail:!0,skipUploadStatusUpdates:!0,uploadSourceComponent:"Save"}})}catch(a){if(Math.random()<.1){const e={tags:{thumbnailFailure:!0}};if(a instanceof ErrorEvent){const e={message:a.message,extra:{filename:a.filename,lineno:a.lineno,colno:a.colno,errorObject:a.error?a.error.toString():null}};Ma(e)}else R(a,e)}console.error(a)}return!0}const ySe=w.jsx("div",{className:nSe.buttonIcon,children:w.jsx(Io,{})}),vSe=_.memo((({onClose:e})=>{const t=tl((e=>e.currentUser)),o=h.useContext(rSe),a=Ve(),{location:i}=a,{search:n}=i,r=new URLSearchParams(n),l=Ac(),d=r.get("videoId"),c=r.get("projectName"),{pushWithSource:u}=_oe(),m=(null==l?void 0:l.name)&&d&&c,p=ku();h.useEffect((function(){(async()=>{try{const e=await(async e=>await Yr(`/api/v2/teams/${e}/onboarding`))(l._id),t={...e,survey:{...e.survey,date:new Date}};await FK(t)}catch(IGe){console.error(IGe)}})()}),[l._id,t]);const g=o.exists,f=h.useCallback((()=>{Fm(ym.TOOK_WELCOME_SCREEN_ACTION,{Action:Zl.DISMISS}),g&&o.onClose(),e&&e()}),[g,o,e]),y=h.useCallback((e=>{null==e||e.preventDefault(),Fm(ym.TOOK_WELCOME_SCREEN_ACTION,{Action:Zl.CREATE_NEW_PROJECT}),az({source:ad.Onboarding}),mSe({entry:uSe.ONBOARDING_MODAL}),rE(),o.onClose()}),[o]),v=h.useCallback((()=>{m?(Fm(ym.TOOK_WELCOME_SCREEN_ACTION,{Action:Zl.GO_TO_PROJECT}),yae({callToAction:Rm.OnboardingModal}),a.push(`/${d}/studio/editor`)):y()}),[y,a,m,d]),_=h.useCallback((e=>{try{sh.set("LANDING_PAGE_SAMPLE",JSON.stringify("video-editor"))}catch(t){console.error(t)}null==e||e.preventDefault(),yae({callToAction:Rm.OnboardingModal}),az({source:ad.Onboarding,startTour:!0}),u("/studio/editor",voe.ONBOARDING_MODAL),o.onClose()}),[o,u]),b=h.useCallback((()=>{Fm(ym.TOOK_WELCOME_SCREEN_ACTION,{Action:Zl.TRY_A_SAMPLE}),_()}),[_]);if(!document.querySelector(".app-container")){const e="Couldn't find .app-container to mount OnboardingDialog to.";return kr()?console.error(`${e} ${Ar}`):console.error(e),null}const T=()=>{const e=""+((null==t?void 0:t.user.firstName)?`You're in, ${s.capitalize(t.user.firstName)}! 🎉`:"You're in! 🎉"),o=m?`Congrats on joining ${l.name}! You can now edit ${c}.`:"Get started by creating a new project or playing around with one of our videos";return w.jsxs("div",{className:nSe.modalWithImageContainer,"data-testid":"invite-accepted-modal",children:[w.jsxs("div",{className:nSe.left,children:[w.jsx("div",{className:nSe.header,children:e}),w.jsx("p",{children:o}),w.jsx("form",{className:nSe.form,children:w.jsxs("div",{className:nSe.buttonContainer,children:[w.jsx(Iie,{className:nSe.modalPrimaryButton,onClick:v,buttonText:c&&d&&l.name?"Go to Project":"Create New Project",testId:"primary-button"}),w.jsx(Iie,{className:nSe.modalSecondaryButton,onClick:b,buttonText:"Start with a sample",testId:"secondary-button",icon:ySe})]})})]}),w.jsx("div",{className:nSe.right,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/YZE-TellYourStory.webp"\n          )'}}),w.jsx("div",{className:`${nSe.exit} ${p?nSe.dark:nSe.light}`,onClick:f,"data-testid":"close-button",children:w.jsx(ve,{})})]})};return g?w.jsx(w.Fragment,{children:T()}):w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:f,children:T()})})),_Se="GetStartedWithBrandkitModal-module_font_fiiTa",wSe="GetStartedWithBrandkitModal-module_color_2M-Al",bSe="GetStartedWithBrandkitModal-module_logo_m4b6C",TSe="GetStartedWithBrandkitModal-module_placeholder_Svpy9",xSe="AssetCarousel-module_arrowContainer_3VS-P",SSe="AssetCarousel-module_assetCarousel_2VEYG",ESe="AssetCarousel-module_assets_iTThd",ISe="AssetCarousel-module_rightArrow_6swWP",CSe="AssetCarousel-module_leftArrow_qCNQz",kSe="AssetCarousel-module_hidden_ra5ZN",ASe=_.memo((({children:e})=>{const t=h.useRef(null),o=h.useRef(null),[a,i]=h.useState(!1),[s,n]=h.useState(!1),r=h.useCallback((()=>{if(!o.current||!t.current)return;const e=t.current.children;if(e&&e[0]){const t=e[e.length-1].getBoundingClientRect().right,a=o.current.getBoundingClientRect().right;i(t>a+1)}}),[]),l=h.useCallback((()=>{if(!o.current||!t.current)return;const e=t.current.children;if(e&&e[0]){const t=e[0].getBoundingClientRect().x,a=o.current.getBoundingClientRect().left;n(t<a-1)}}),[]),d=h.useCallback(((e,a=1)=>{if(!o.current||!t.current)return;const i=t.current,s=i.children;if(s&&s[0]){const o=(s[0].getBoundingClientRect().width+12)*a,n=i.scrollLeft;t.current.scrollTo({left:n+o*("left"===e?-1:1),behavior:"smooth"})}}),[]),c=h.useCallback((()=>{l(),r()}),[l,r]);return h.useEffect((function(){const e=t.current;return c(),window.addEventListener("resize",c),e&&e.addEventListener("scroll",c),()=>{window.removeEventListener("resize",c),e&&e.removeEventListener("scroll",c)}}),[c]),w.jsxs("div",{className:xSe,children:[w.jsx("div",{className:`${ISe} ${!a&&kSe}`,onClick:()=>d("right",2),children:w.jsx(Ua,{})}),w.jsx("div",{className:`${CSe} ${!s&&kSe}`,onClick:()=>d("left",2),children:w.jsx(Ba,{})}),w.jsx("div",{className:SSe,ref:o,children:w.jsx("div",{className:ESe,ref:t,children:e})})]})})),jSe=_.memo(ASe),NSe=e=>{const{logos:t,images:o,colors:a,fonts:i}=e,s={logos:[],images:[],colors:[],fonts:[]};return null==t||t.forEach((e=>{var t;null==(t=null==e?void 0:e.formats)||t.forEach((t=>{const o=null==t?void 0:t.src,a="svg"===(null==t?void 0:t.format);o&&!a&&s.logos.push({type:e.type,theme:e.theme,src:o})}))})),null==o||o.forEach((e=>{var t;null==(t=null==e?void 0:e.formats)||t.forEach((t=>{const o=null==t?void 0:t.src,a="svg"===(null==t?void 0:t.format);o&&!a&&s.images.push({type:e.type,src:o})}))})),null==a||a.forEach((e=>{const{hex:t}=e;t&&s.colors.push({value:t,default:!1,isPrepopulated:!0})})),null==i||i.forEach((e=>{const{name:t,origin:o}=e;t&&o&&"google"===o&&s.fonts.push({fontFamily:t,type:"default",isPrepopulated:!0})})),s},RSe=async e=>{const{state:t,dispatch:o}=sr(),{selectedTeamId:a}=t.teams,{brandkit:i}=await qr(`/api/v2/teams/${a}/brandkit/brandfetch`,{body:{assets:e}});await nW(),o(Rp(i))},PSe=async e=>{const t=Hu();if(!t)return;const o=await fetch(e).then((e=>e.blob())),a=`team_assets/${t.name}-${oe.v4()}-${e}`,i=new File([o],a,{type:o.type});await CP(i,t._id),await Lp()},DSe=(e,t,o)=>{const a=e.startsWith("#")?e.substring(1,7):e;return.299*parseInt(a.substring(0,2),16)+.587*parseInt(a.substring(2,4),16)+.114*parseInt(a.substring(4,6),16)>186?o:t},OSe=w.jsx(PF,{}),LSe=()=>{},FSe=_.memo((({onClose:e=LSe})=>{const t=h.useContext(rSe),[o,a]=h.useState(!0),[i,s]=h.useState(!1),{emailDomain:n}=Ac(),[r,l]=h.useState(),d=t.exists,[c,u]=h.useState(""),m=!(o||(null==r?void 0:r.logos.length)||(null==r?void 0:r.images.length)||(null==r?void 0:r.colors.length)||(null==r?void 0:r.fonts.length));h.useEffect((function(){Fm(ym.BEGIN_SUGGESTED_BRANDKIT_ASSETS)}),[]);const p=h.useCallback((()=>{d?t.goToNextModal():e()}),[d,t,e]),g=h.useCallback((()=>{Fm(ym.DECLINED_BRANDKIT_ASSETS),p()}),[p]),f=h.useCallback((async()=>{if(r&&!m)try{await Promise.all([RSe(r),PSe(c)]),p()}catch(e){mh({description:"Error updating team brandkit. Please try again",error:e}),p()}else p()}),[r,p,c,m]),y=h.useCallback((async e=>{if(null==e||e.preventDefault(),!r||m)return p();s(!0);try{Fm(ym.CONFIRMED_BRANDKIT_ASSETS),await Promise.all([RSe(r),PSe(c)]),p()}catch(t){mh({description:"Error updating team brandkit. Please try again",error:t}),s(!1),p()}}),[r,p,c,m]);if(h.useEffect((function(){m&&p()}),[p,m]),h.useEffect((function(){try{(async()=>{const e=await(async()=>{const{state:e}=sr(),{selectedTeamId:t}=e.teams;return await Yr(`/api/v2/teams/${t}/brandkit/brandfetch`)})();var t,o,i;l(NSe(e)),u(((t=e.logos).sort(((e,t)=>"icon"===e.type&&"icon"!==t.type?-1:"icon"===t.type&&"icon"!==e.type?1:"dark"===e.theme?-1:1)),(null==(i=null==(o=t[0])?void 0:o.formats.find((e=>"svg"!==e.format)))?void 0:i.src)??"")),a(!1)})()}catch(e){R(e),p()}}),[p]),m)return null;const v=()=>Array(5).fill(0).map(((e,t)=>w.jsx("div",{className:TSe},t))),_=()=>w.jsxs("div",{className:nSe.modal,"data-cy":"get-started-with-brandkit-modal","data-testid":"get-started-with-brandkit-modal",children:[w.jsx("div",{className:nSe.header,children:"Get Started with Brand Kit"}),w.jsxs("p",{children:["We found these brand assets from ",n," for you. We’ve added them to your team’s Brand Kit so everyone in the workspace can use them in projects and stay visually consistent from the get-go."]}),w.jsxs(w.Fragment,{children:[o?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:nSe.inputLabel,children:"Logos"}),w.jsx(jSe,{children:v()})]}):(null==r?void 0:r.logos)?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:nSe.inputLabel,children:"Logos"}),w.jsx(jSe,{children:w.jsxs(w.Fragment,{children:[null==r?void 0:r.logos.map(((e,t)=>w.jsx("div",{className:bSe,"data-testid":`logo-${t}`,children:w.jsx("img",{src:e.src,alt:e.src})},`logo-${t}`))),null==r?void 0:r.images.map(((e,t)=>w.jsx("div",{className:bSe,"data-testid":`image-${t}`,children:w.jsx("img",{src:e.src,alt:e.src})},`image-${t}`)))]})})]}):null,w.jsx("div",{className:nSe.inputLabel,children:"Colors"}),o?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:nSe.inputLabel,children:"Colors"}),w.jsx(jSe,{children:v()})]}):(null==r?void 0:r.colors)?w.jsx(jSe,{children:null==r?void 0:r.colors.map(((e,t)=>w.jsx("div",{className:wSe,style:{backgroundColor:e.value},"data-testid":`color-${t}`,children:w.jsx("p",{style:{color:DSe(e.value,"#ffffff","#000000")},children:e.value})},`color-${t}`)))}):null,w.jsx("div",{className:nSe.inputLabel,children:"Fonts"}),o?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:nSe.inputLabel,children:"Fonts"}),w.jsx(jSe,{children:v()})]}):(null==r?void 0:r.fonts)?w.jsx(jSe,{children:null==r?void 0:r.fonts.map(((e,t)=>w.jsxs("div",{className:_Se,style:{fontFamily:e.fontFamily},"data-testid":`font-${t}`,children:[w.jsx("h3",{children:"Aa"}),w.jsx("p",{children:e.fontFamily})]},`font-${t}`)))}):null,w.jsx("form",{className:nSe.form,onSubmit:y,children:w.jsxs("div",{className:nSe.buttonContainer,children:[w.jsx(Iie,{className:`${nSe.modalPrimaryButton} ${(o||i)&&nSe.disabled}}`,onClick:y,buttonText:o||i?OSe:"Keep these in my Brand Kit",testId:"primary-button"}),w.jsx(Iie,{className:nSe.modalSecondaryButton,onClick:g,buttonText:"Remove",testId:"secondary-button"})]})})]}),w.jsx("div",{className:`${nSe.exit} ${nSe.dark}`,onClick:f,"data-testid":"close",children:w.jsx(ve,{})})]});return d?w.jsx(w.Fragment,{children:_()}):w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:e,children:_()})})),MSe=_.memo((()=>{const e=bW(),t=tl((e=>e.currentUser.user.onboarding)),o=null==t?void 0:t.skipped,a=cu();h.useEffect((function(){Jxe(Kxe.Onboarding,{inProgress:!0})}),[]);const i=h.useMemo((()=>a?[{modal:w.jsx(cSe,{})},{modal:w.jsx(FSe,{})}]:[{modal:w.jsx(cSe,{})}]),[a]),s=h.useMemo((()=>[{modal:w.jsx(vSe,{})}]),[]),n=h.useCallback((async()=>{await FK({...t,firstSessionOnboarding:{...null==t?void 0:t.firstSessionOnboarding,dateDismissed:new Date}}),await np(),Jxe(Kxe.Onboarding,{inProgress:!1}),!(null==t?void 0:t.skipped)&&e((()=>{}),{action:Vl.ONBOARDING_SURVEY})()}),[t,e]),r=h.useCallback((async()=>{await FK({...t,firstSessionOnboarding:{...null==t?void 0:t.firstSessionOnboarding,dateComplete:new Date}}),await np(),Jxe(Kxe.Onboarding,{inProgress:!1}),!(null==t?void 0:t.skipped)&&e((()=>{}),{action:Vl.ONBOARDING_SURVEY})()}),[t,e]);return w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:n,children:w.jsx(dSe,{modalSteps:o?s:i,onClose:n,onFlowDismissed:n,onFlowComplete:r,testId:"first-session-onboarding"})})})),USe="OnboardingSurvey-module_disabled_vf2IN",BSe="OnboardingSurvey-module_header_dGD2A",VSe="OnboardingSurvey-module_inputLabel_nKxiP",WSe="OnboardingSurvey-module_modalWithImageContainer_kmIlj",GSe="OnboardingSurvey-module_right_U2J-2",HSe="OnboardingSurvey-module_left_mJJmS",$Se="OnboardingSurvey-module_selected_u4HXZ",KSe="OnboardingSurvey-module_input_u-crW",zSe="OnboardingSurvey-module_modalPrimaryButton_I0p6O",YSe="OnboardingSurvey-module_dialogButtonsContainer_25y-p",JSe="OnboardingSurvey-module_dialogButton_PbzJy",qSe="OnboardingSurvey-module_dropdown_mvRh1",XSe="OnboardingSurvey-module_subHeader_INyYz",QSe=w.jsx(PF,{}),ZSe=w.jsx("span",{children:"Continue"}),eEe=()=>{const[e,t]=h.useState(),[o,a]=h.useState(""),[i,s]=h.useState(""),[n,r]=h.useState(""),[l,d]=h.useState(""),[c,u]=h.useState(!1),m=ku(),p=h.useContext(rSe).exists;h.useEffect((function(){zxe(Kxe.Onboarding,{inFirstSession:!0,inProgress:!0})}),[]),h.useEffect((function(){Fm(ym.BEGAN_ONBOARDING_SURVEY)}),[]);const g=h.useCallback((()=>{const t=!o,a=!i;return!e||(e===od.Work?t||a:e===od.School?!o:a)}),[o,i,e]),f=h.useCallback((async()=>{if(!g()&&!c&&e)try{u(!0),await LK(e,o,i,n,l),e===od.Work&&await dD()}catch(t){mh({description:"Error submitting onboarding survey. Please try again.",error:t}),u(!1)}}),[g,c,e,o,i,n,l]),y=h.useCallback((async()=>{await f()}),[f]),v=h.useCallback((e=>OK(e)),[]),_=h.useCallback((e=>{a(e.value)}),[]),b=h.useCallback((e=>{a(e.value)}),[]),T=h.useCallback((e=>{s(e.value)}),[]),x=document.querySelector(".app-container");if(!x){const e="Couldn't find .app-container to mount OnboardingDialog to.";return kr()?console.error(`${e} ${Ar}`):console.error(e),null}const S=()=>w.jsxs("div",{className:qSe,"data-testid":"project-usage-dropdown",children:[w.jsx("div",{className:VSe,children:"What kind of content do you plan to make?"}),w.jsx(tt,{"aria-label":"project-usage-dropdown",onChange:T,styles:DK,options:RK,placeholder:"",theme:v,isSearchable:!m,maxMenuHeight:m?150:250,menuPortalTarget:x,menuPlacement:"auto"})]}),E=()=>i===AK?w.jsx("input",{className:KSe,type:"text",name:"Project Usage Custom Response",placeholder:"Ex: I'm creating podcasts",value:l,onChange:({target:e})=>{d(e.value)},autoComplete:"off"}):null,I=()=>w.jsxs("div",{className:qSe,"data-testid":"school-role-dropdown",children:[w.jsx("div",{className:VSe,children:"I am a..."}),w.jsx(tt,{"aria-label":"school-role-dropdown",onChange:b,styles:DK,options:NK,placeholder:"",theme:v,isSearchable:!m,maxMenuHeight:250,menuPortalTarget:x,menuPlacement:"auto"})]}),C=()=>w.jsxs("div",{className:WSe,"data-testid":"onboarding-survey",children:[w.jsxs("div",{className:HSe,children:[w.jsx("div",{className:BSe,"data-cy":"onboarding-wizard-title",children:"Let's get you set up"}),w.jsx("p",{className:XSe,children:"Kapwing is a collaborative video editor that empowers creators and teams to share their stories."}),w.jsx("div",{className:VSe,children:"I'm using Kapwing primarily for..."}),w.jsxs("div",{className:YSe,children:[w.jsx("div",{className:`${JSe} ${e===od.Work?$Se:""}`,onClick:()=>{a(""),s(""),t(od.Work)},"data-cy":"onboarding-work-button","data-testid":"onboarding-work-button",children:"Work"}),w.jsx("div",{className:`${JSe} ${e===od.School?$Se:""}`,onClick:()=>{a(""),s(""),t(od.School)},"data-cy":"onboarding-school-button","data-testid":"onboarding-school-button",children:"School"}),w.jsx("div",{className:`${JSe} ${e===od.PersonalProjects?$Se:""}`,onClick:()=>{a(""),s(""),t(od.PersonalProjects)},"data-cy":"onboarding-personal-projects-button","data-testid":"onboarding-personal-projects-button",children:"Personal Projects"})]}),e===od.Work&&w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:qSe,"data-testid":"work-dropdown",children:[w.jsx("div",{className:VSe,children:"What kind of work do you do?"}),w.jsx(tt,{"aria-label":"work-usage-dropdown",onChange:_,styles:DK,options:jK,placeholder:"",theme:v,isSearchable:!m,maxMenuHeight:m?150:250,menuPortalTarget:x,menuPlacement:"auto"})]}),o===AK?w.jsx("input",{className:KSe,type:"text",name:"Occupation Custom Response",placeholder:"Ex: CEO",value:n,onChange:({target:e})=>{r(e.value)},autoComplete:"off"}):null,S(),E()]}),e===od.School&&I(),e===od.PersonalProjects&&w.jsxs(w.Fragment,{children:[S(),E()]}),e&&w.jsx(Iie,{className:`${zSe} ${g()||c?USe:""}`,onClick:y,testId:"onboarding-continue-button",buttonText:c?QSe:ZSe})]}),w.jsx("div",{className:GSe,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/28U-onboarding-modal.webp"\n          )'}})]});return p?C():w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,children:C()})},tEe="PlanNote-module_memberPaymentNote_f4haL";var oEe=(e=>(e.Charge="charge",e.Cancel="cancel",e))(oEe||{});const aEe=({type:e})=>w.jsx("div",{className:tEe,children:"cancel"===e?w.jsxs(w.Fragment,{children:[w.jsx("strong",{children:"Note:"})," Your workspace is on an upgraded plan that is billed per seat. If you would like, you may also set the unused seats to cancel starting next billing cycle. Learn more about how we bill"," ",w.jsx("a",{href:"/help/subscription-faq/",target:"_blank",rel:"noopener noreferrer",children:"here."})]}):w.jsxs(w.Fragment,{children:[w.jsx("strong",{children:"Note:"})," You will be charged for each team member who joins your workspace."," ",w.jsx("a",{href:"/help/subscription-faq/",target:"_blank",rel:"noopener noreferrer",children:"Visit our FAQ"})," ","to learn more about how your plan is billed."]})}),iEe=e=>{let{planTier:t}=e;t||(t=Cl.Free);return!(!$c(t).isPaid||e.stripeId)},sEe=(e,t)=>!t.isFree&&!iEe(e),nEe="TeamInviteByEmail-module_inputLabel_JDsDR",rEe="TeamInviteByEmail-module_emaillControlsContainer_JKa7k",lEe="TeamInviteByEmail-module_emailControl_0yxNM",dEe="TeamInviteByEmail-module_emailControlError_PIRxp",cEe="TeamInviteByEmail-module_emailInput_HemF7",uEe="TeamInviteByEmail-module_emailControlErrorMessage_PHHI-",mEe=_.memo((({name:e,placeholder:t,value:o,isValid:a=!0,readOnly:i=!1,readOnlyMessage:s="",errorMessage:n="Invalid email address added. Please double check the entered email",onChange:r})=>w.jsxs("div",{className:cEe,children:[!a&&w.jsx("p",{className:uEe,children:n}),w.jsx("input",{className:(()=>{let e=lEe;return a||(e=`${e} ${dEe}`),e})(),type:"text",name:e,placeholder:t,value:i?`${o} - ${s}`:o,readOnly:i,onChange:r,autoComplete:"off","data-cy":"team-invite-member-email-input"},e)]}))),pEe=_.memo((({emails:e,setEmails:t,emailsPlaceholder:o,validateInviteEmail:a,emailExists:i})=>{const s=e=>i&&i(e.email)?"User is already a member of this workspace.":"Invalid email address added. Please double check the entered email.";h.useEffect((function(){if(e.length<3){const o=Array(3-e.length).fill(void 0).map((()=>({email:""})));t([...e,...o])}}),[e,t]);const n=h.useMemo((()=>e.map(((o,i)=>({target:s})=>{const{value:n}=s;o.email=n,!1===o.isValid&&(o.isValid=!n||a(n)),e[i]=o,t([...e])}))),[e,t,a]);return w.jsxs(w.Fragment,{children:[w.jsx("div",{className:nEe,children:"Invite members by email"}),w.jsx("div",{className:rEe,"data-testid":"email-fields-container",children:e.map(((e,t)=>w.jsx(mEe,{name:`invite-by-email-input-${t}`,placeholder:o,value:e.email,isValid:e.isValid,readOnly:e.invited,readOnlyMessage:"invite pending",onChange:n[t],errorMessage:s(e)},t)))})]})}));function hEe(e){return navigator.clipboard.writeText(e)}const gEe="TeamInviteByLink-module_inputLabel_iPidK",fEe="TeamInviteByLink-module_linkContainer_3FyBt",yEe="TeamInviteByLink-module_inviteLink_qQL3C",vEe="TeamInviteByLink-module_copyButton_OtV6H",_Ee="TeamInviteByLink-module_loaderWrapper_GZvOI",wEe="TeamInviteByLink-module_copyLink_TtsfJ",bEe="TeamInviteByLink-module_linkIcon_8SeIb",TEe=_.memo((({onCopy:e,teamId:t,disabled:o=!1,linkTextOnly:a=!1})=>{const i=il(),s=rU(),[n,r]=h.useState(""),l=h.useRef(null),d=h.useCallback((async e=>{hEe(e).then((()=>i(wl({description:"Invite link added to clipboard.",type:"success"})))).catch((e=>{mh({description:"Copy failed",error:e})}))}),[i]),c=h.useCallback((()=>{var t,o,a;d((null==(t=l.current)?void 0:t.innerHTML)||"");const i=document.createRange();l.current&&i.selectNode(l.current),null==(o=window.getSelection())||o.removeAllRanges(),null==(a=window.getSelection())||a.addRange(i),e&&e()}),[d,e]),u=h.useCallback((()=>{if(!n)return"";const{hostname:e}=window.location;return`${"localhost"===e?"localhost:3000":`https://${e}`}/team/sharing/${n}`}),[n]);h.useEffect((function(){(async()=>{const e=await function(e){return Yr(`/api/v1/team-invite-links/team/${e}`)}(t);s.current&&r(e.inviteLink)})()}),[t,s]);const m=h.useCallback((()=>{n&&d(u()),e&&e()}),[n,d,u,e]);return o?null:a?w.jsx("div",{className:fEe,children:w.jsxs("button",{type:"button",className:wEe,onClick:m,children:[w.jsx(Va,{className:bEe}),"Copy Invite Link"]})}):w.jsxs(w.Fragment,{children:[e&&w.jsx("div",{className:gEe,children:"Invite by link"}),w.jsxs("div",{className:fEe,children:[w.jsx("div",{className:yEe,onClick:c,id:"inviteLink",ref:l,"data-testid":"invite-link-url",children:u()}),w.jsx("button",{type:"button",className:vEe,onClick:m,children:n?"Copy Link":w.jsx("div",{className:_Ee,children:w.jsx(PF,{theme:RF.Workspace})})})]})]})})),xEe=w.jsx(PF,{}),SEe=()=>{},EEe=_.memo((({entryPoint:e,onClose:t=SEe,setPendingInvites:o})=>{const a=il(),{executeRecaptcha:i}=Ce(),s=Ac(),n=ou(),r=sEe(s,n),{subscription:l}=pM(),d=l?rD(s,l):0,{currentUser:c,selectedTeamId:u,recaptchaKeyV3:m,recaptchaKeyV2:p}=tl((e=>({currentUser:e.currentUser,selectedTeamId:e.teams.selectedTeamId,recaptchaKeyV3:e.config.RECAPTCHA_V3_SITEKEY,recaptchaKeyV2:e.config.RECAPTCHA_V2_SITEKEY})),ol),{token:g,user:{_id:f}}=c,[y,v]=h.useState(!1),_=h.useRef(),[b,T]=h.useState(!1),[x,S]=h.useState([]),E=h.useContext(rSe),I=E.exists,C=x.some((e=>!1===e.isValid)),k=e=>{for(const t of(null==s?void 0:s.users)??[])if(e===t.email)return!0;return!1},A=e=>Yp(e)&&!k(e),j=()=>{var t;s&&wM({teamId:s._id,inviterEmail:null==(t=null==c?void 0:c.user)?void 0:t.email,origin:e,shareType:"copy link"})},N=async()=>{var t;if(x.length>0){const n=x.map((e=>({...e,isValid:!e.email||A(e.email)})));if(n.some((e=>!e.isValid)))return S(n),!1;const r=n.filter((e=>e.email&&!e.invited)).map((e=>e.email));r.length&&(T(!0),await(async e=>{var t;if(e.length<=0)return;if(b)return void a(wl({description:"Please wait for pending sent emails to load first.",type:"error"}));if(!i)return void a(wl({description:"Recaptcha has not been loaded. Please wait a few seconds and try again.",type:"error"}));const n=await i("teamInvite"),r=null==(t=_.current)?void 0:t.getValue(),l={emails:e,token:g,teamId:null==s?void 0:s._id,v3CaptchaToken:n,v2CaptchaToken:r,recaptchaKeyV3:m,recaptchaKeyV2:p};if(window.Cypress){try{await Jr("/api/v1/invites/teams",{body:{emails:e,token:g,userId:f,teamId:"641b74d390ea88312c239c0b",cypress:!0}})}catch(IGe){console.error(IGe)}return a(wl({description:"Invites were sent successfully",type:"success"})),void(o&&o([{_id:"randomId",email:"testinvite@kapwing.com"}]))}try{const t=await Jr("/api/v1/invites/teams",{body:l});if(a(wl({description:"Invites were sent successfully",type:"success"})),S(x.map((({email:t,isValid:o,invited:a})=>({email:t,isValid:o,invited:a?!!a:e.includes(t)})))),t.notifError&&(a(wl({description:"Invites created but there was an error sending the notifications",type:"warning"})),console.error(`Error sending team invite notifications: ${t.notifError}`)),o){const e=await NP(s._id);o(e.invites)}}catch(IGe){oh(IGe)&&v(!0),mh({description:"An error has occurred when sending invites!",error:IGe})}})(r),T(!1),s&&wM({teamId:s._id,inviterEmail:null==(t=null==c?void 0:c.user)?void 0:t.email,origin:e,shareType:"send email"}))}return!0},R=()=>{I?E.goToNextModal():t()},P=async e=>{null==e||e.preventDefault(),await N()&&R()},D=()=>w.jsxs("div",{className:nSe.modalWithImageContainer,"data-cy":"add-members-modal","data-testid":"add-members-modal",children:[w.jsxs("div",{className:nSe.left,children:[w.jsxs("div",{className:nSe.header,children:["Add Members to: ",w.jsx("span",{className:nSe.teamName,children:null==s?void 0:s.name})]}),w.jsxs("form",{className:nSe.form,onSubmit:P,children:[w.jsx(pEe,{emails:x,setEmails:S,emailsPlaceholder:"name@company.com",validateInviteEmail:A,emailExists:k}),r&&0===d&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:nSe.spacer}),w.jsx(aEe,{type:oEe.Charge})]}),I?w.jsx(lSe,{primaryButtonDisabled:C,primaryButtonText:"Next",onClick:P}):w.jsx(Iie,{className:`${nSe.modalPrimaryButton} ${b||C?nSe.disabled:""}`,onClick:P,testId:"continue-button",buttonText:b?xEe:"Invite Members"}),w.jsx("input",{type:"submit",style:{display:"none"}})]}),w.jsx(TEe,{teamId:u,onCopy:j,disabled:!s.settings.inviteByLink,linkTextOnly:!0})]}),w.jsx("div",{className:nSe.right,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/zS3-invite-members-modal.webp"\n          )'}}),w.jsx("div",{className:`${nSe.exit} ${nSe.dark}`,onClick:R,children:w.jsx(ve,{})})]});return I?w.jsxs(w.Fragment,{children:[y&&w.jsx(Ae,{sitekey:p,ref:_}),D()]}):w.jsxs(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:t,children:[y&&w.jsx(Ae,{sitekey:p,ref:_}),D()]})})),IEe="Upload-module_screenReaderOnlyLabel_baMDH",CEe="Upload-module_uploadContainer_MYAJF",kEe="Upload-module_uploadTextContainer_kXzce",AEe="Upload-module_uploadButton_NxLkR",jEe="Upload-module_uploadLabel_yZj96",NEe="Upload-module_uploadLabelLight_62HKO",REe="Upload-module_uploadLabelHeader_e0noq",PEe="Upload-module_darkHeader_EqxrZ",DEe="Upload-module_uploadLabelSubheader_m-oZq",OEe="Upload-module_uploadIcon_wjPHn",LEe=_.memo((({handleMultiFileUpload:e,multiple:t,acceptedFileTypes:o,uploadText:a="Click to Upload",uploadSubtext:i="or, drag and drop a file here",theme:s=RF.Workspace})=>{const n=`upload-button-input-${P()}`,r=h.useCallback((t=>{var o;e(null==(o=null==t?void 0:t.target)?void 0:o.files)}),[e]);return w.jsx("div",{className:CEe,children:w.jsxs("label",{htmlFor:n,className:s===RF.Workspace?NEe:jEe,children:[w.jsx("span",{className:IEe,children:a}),w.jsx("input",{"data-cy":"upload-input","data-testid":"upload-input",id:n,className:AEe,accept:o,onChange:r,type:"file",multiple:t}),w.jsx("div",{className:kEe,children:w.jsxs("div",{className:s===RF.Workspace?PEe:REe,children:[w.jsxs("div",{className:REe,children:[a,w.jsx(Wa,{className:OEe})]}),w.jsx("div",{className:DEe,children:i})]})})]})})})),FEe="LogoUpload-module_logoContainer_Z6tVc",MEe="LogoUpload-module_replaceLogoButton_JE0rJ",UEe="LogoUpload-module_updating_wg8Yc",BEe="LogoUpload-module_logoUploadContainer_gU8Zb",VEe="LogoUpload-module_defaultLogosText_-omJQ",WEe="LogoUpload-module_defaultLogos_bwBc-",GEe="LogoUpload-module_logoWrapper_SoEFn",HEe=_.memo((({entryPoint:e,hasPermission:t=!0})=>{const o=il(),a=Ac(),[i,s]=h.useState(!1),[n,r]=h.useState(null==a?void 0:a.picture),l=async e=>{const t=null==e?void 0:e[0];if(t&&a&&(e=>{const{dispatch:t}=sr(),o=e[0];if(!o)return!1;const a=vB(o);return!!(null==a?void 0:a.includes("image"))||(t(wl({description:`Your file type ${a} is not supported. Please upload an image.`,type:"error"})),!1)})(e)){const e=`team_assets/${a.name}-${oe.v4()}-${t.name}`,o=new File([t],e,{type:t.type});d(o)}},d=async t=>{var o;s(!0),await(async e=>{const t=Hu();if(t)try{await CP(e,t._id),await Lp()}catch(IGe){mh({description:"There was an error updating your logo. Please try again.",error:IGe})}})(t),o=e,Fm(ym.ADDED_WORKSPACE_LOGO,{Origin:o}),r(t.name),s(!1)},c=()=>w.jsxs("div",{className:FEe,children:[i?w.jsx("div",{className:UEe,children:"Updating..."}):w.jsx(b9,{suggestedWidth:120,suggestedHeight:120,team:a}),t&&w.jsx("div",{className:MEe,onClick:()=>r(void 0),"data-testid":"logo-remove-button","data-cy":"logo-remove-button",children:w.jsx(ve,{})})]});return t?n||i?c():w.jsxs("div",{className:BEe,"data-testid":"logo-upload","data-cy":"logo-upload",children:[w.jsx(LEe,{handleMultiFileUpload:l,acceptedFileTypes:$B({logoUpload:!0}),multiple:!0,theme:RF.Workspace}),w.jsx("div",{className:VEe,children:"Or, select an icon from our sample library:"}),w.jsx("div",{className:WEe,"data-testid":"default-logos",children:Dn.map(((e,t)=>w.jsx("div",{className:GEe,onClick:()=>(async e=>{r(e),o({type:"UPDATE_TEAM_LOGO",id:a._id,picture:e}),await PSe(e)})(e),style:{backgroundImage:`url(${e})`}},t)))})]}):c()})),$Ee={home:"Team-module_home_9Lybd",homeHowBackgroundWhite:"Team-module_homeHowBackgroundWhite_n8imj",largeButton:"Team-module_largeButton_Jnrfp",sectionContent:"Team-module_sectionContent_kEdU-",sectionHeader:"Team-module_sectionHeader_BuUSv",spacer:"Team-module_spacer_SAgVv",chevron:"Team-module_chevron_lEUW7",splashText:"Team-module_splashText_m2qf6",splashSubtext:"Team-module_splashSubtext_-2EHm",aboutSection:"Team-module_aboutSection_jf8PD",mobile:"Team-module_mobile_JTOsw",desktop:"Team-module_desktop_ZE7i5",screenReaderOnlyLabel:"Team-module_screenReaderOnlyLabel_PT6eb",disabled:"Team-module_disabled_8vItG",noScrollBar:"Team-module_noScrollBar_t3Wy0",textOverflowEllipsis:"Team-module_textOverflowEllipsis_HELwI",disableTextHighlight:"Team-module_disableTextHighlight_vIikJ",genericButtonBlue:"Team-module_genericButtonBlue_1u-wX",tooltip:"Team-module_tooltip_MWVES",tooltipBubble:"Team-module_tooltipBubble_GSKAY",permissionsTooltip:"Team-module_permissionsTooltip_f3mho",tooltipTextBottomAlignRight:"Team-module_tooltipTextBottomAlignRight_sWAK-",tooltipTextBottomAlignLeft:"Team-module_tooltipTextBottomAlignLeft_tJB7T",tooltipTextSlightTop:"Team-module_tooltipTextSlightTop_g2yQV",tooltipTextTop:"Team-module_tooltipTextTop_vZH6G",keyboardShortcut:"Team-module_keyboardShortcut_6bGY1",keyboardShortcutWithOutline:"Team-module_keyboardShortcutWithOutline_dv3R-",defaultFont:"Team-module_defaultFont_PnVVr",subItem:"Team-module_subItem_ufTH6",fullWidthSubItem:"Team-module_fullWidthSubItem_hybxr",contentContainer:"Team-module_contentContainer_elU1F",sectionWrapper:"Team-module_sectionWrapper_iPHqF",inviteSection:"Team-module_inviteSection_2lgES",openSeats:"Team-module_openSeats_vwzQ-",inviteText:"Team-module_inviteText_o6ePO",pendingInviteSection:"Team-module_pendingInviteSection_mZWzh",sectionContainer:"Team-module_sectionContainer_agcEv",secondaryButton:"Team-module_secondaryButton_3kpZR",leftSecondaryButton:"Team-module_leftSecondaryButton_SM4qc",tabContainer:"Team-module_tabContainer_rCoCl",tabHeader:"Team-module_tabHeader_Y-Xvr",selectedTab:"Team-module_selectedTab_SjwLF",inlineBtnContainer:"Team-module_inlineBtnContainer_y9NDG",membersContainer:"Team-module_membersContainer_gIWxV",profileImage:"Team-module_profileImage_Pkaaw",fullName:"Team-module_fullName_DqYcU",email:"Team-module_email_MQyBY",role:"Team-module_role_6-MCd",roleOption:"Team-module_roleOption_xG-VE",pendingRole:"Team-module_pendingRole_gyNLg",roleTitle:"Team-module_roleTitle_ElFzU",requestControlButtons:"Team-module_requestControlButtons_jKYiu",requestButton:"Team-module_requestButton_ZZmsF",hotpink:"Team-module_hotpink_eFj7B",blue:"Team-module_blue_28JqR",closeIcon:"Team-module_closeIcon_k3Fww",removeIcon:"Team-module_removeIcon_-r-u-",removeButton:"Team-module_removeButton_FY7uw",disabledTab:"Team-module_disabledTab_Qa94M",dropdownWrapper:"Team-module_dropdownWrapper_v3Owp",inviteMembersButtonContainer:"Team-module_inviteMembersButtonContainer_AJwS-",inviteMembersButton:"Team-module_inviteMembersButton_Hstc7",discoverabilityDropdown:"Team-module_discoverabilityDropdown_j9-48",header:"Team-module_header_gZdQw",copy:"Team-module_copy_-qOH1",radioSubHeader:"Team-module_radioSubHeader_2py9R",radioCopy:"Team-module_radioCopy_kcmAi",previewContainer:"Team-module_previewContainer_IwBzd",optionContainer:"Team-module_optionContainer_DGyHl",selected:"Team-module_selected_QDFTs",dropdownOptions:"Team-module_dropdownOptions_0pO79"},KEe="TeamMemberControls-module_loadingDiscoverabilityContainer_Ku49k",zEe="TeamMemberControls-module_loadingDiscoverabilityText_UqTLn",YEe=_.memo((()=>{var e;const t=Ac(),[o,a]=h.useState(null==(e=t.settings)?void 0:e.discoverability),[i,s]=h.useState(""),[n,r]=h.useState(!1),l={[cd.AlwaysInvitationOnly]:{header:"Invitation only",copy:"Only users who have been invited with a link or email can find and join this workspace when they log in.",discoverabilitySetting:cd.AlwaysInvitationOnly},[cd.InvitationOnly]:{header:"Invitation only",copy:"Only users who have been invited with a link or email can find and join this workspace when they log in.",discoverabilitySetting:cd.InvitationOnly},[cd.RequestToJoin]:{header:`Anyone at ${t.emailDomain??"your email domain"} can request to join`,copy:"Only users in your domain can find your workspace when they log in. They can request to join but need approval from an admin.",discoverabilitySetting:cd.RequestToJoin},[cd.AnyoneCanJoin]:{header:`Anyone at ${t.emailDomain??"your email domain"} can join`,copy:"Only users in your domain can find your workspace when they log in. They can join your workspace without approval.",discoverabilitySetting:cd.AnyoneCanJoin}},d=[l[0],l[1],l[2]];if(h.useEffect((function(){void 0===o&&(async()=>{const e=await Hp(t._id,cd.RequestToJoin);e.discoverability&&(a(e.discoverability),await Lp())})()}),[]),void 0===o)return null;if(o===cd.AlwaysInvitationOnly)return w.jsxs("div",{"data-testid":"discoverability-settings",children:[w.jsx("div",{className:$Ee.header,children:"Invitation Only"}),w.jsx("div",{className:$Ee.copy,children:"Only users with an invite link or email can join this workspace"})]});const c=async e=>{r(!1),a(e),await Hp(t._id,e),s("Updated discoverability!"),setTimeout((()=>{s("")}),2e3)},u=({...e})=>w.jsx(Ga.ValueContainer,{...e,children:w.jsxs("div",{className:$Ee.previewContainer,onClick:()=>r((e=>!e)),children:[w.jsxs("div",{className:$Ee.header,children:[l[o].header,n?w.jsx(Ha,{}):w.jsx($a,{})]}),w.jsx("div",{className:$Ee.copy,children:l[o].copy})]})}),m=e=>w.jsxs("div",{id:`discoverability-radio-button-${e.discoverabilitySetting}`,className:`${$Ee.optionContainer} ${o===e.discoverabilitySetting?$Ee.selected:""}`,onClick:()=>(async e=>{e.discoverabilitySetting===cd.AnyoneCanJoin?(await c(e.discoverabilitySetting),await Lp()):await c(e.discoverabilitySetting)})(e),children:[w.jsx("div",{className:$Ee.header,children:e.header}),w.jsx("div",{className:$Ee.copy,children:e.copy})]}),p={control:()=>({}),option:()=>({}),menu:e=>({...e,maxWidth:"700px"}),menuList:()=>({}),indicatorSeparator:()=>({display:"none"}),menuPortal:e=>({...e}),dropdownIndicator:()=>({display:"none"}),valueContainer:()=>({padding:0})};return w.jsxs("div",{"data-testid":"discoverability-settings",children:[w.jsx(tt,{value:l[o],options:d,formatOptionLabel:m,styles:p,menuIsOpen:n,menuPlacement:"auto",isSearchable:!1,components:{ValueContainer:u},controlShouldRenderValue:!1}),i&&w.jsx("div",{className:KEe,children:w.jsx("span",{className:zEe,children:i})})]})})),JEe="CustomizeWorkspaceModal-module_textOverflowEllipsis_gtPCe",qEe="CustomizeWorkspaceModal-module_previewContainer_XHrGZ",XEe="CustomizeWorkspaceModal-module_container_LYinw",QEe="CustomizeWorkspaceModal-module_sidebar_xA35h",ZEe="CustomizeWorkspaceModal-module_placeholder_eeViF",eIe="CustomizeWorkspaceModal-module_logo_XCNcl",tIe="CustomizeWorkspaceModal-module_app_h9vIO",oIe="CustomizeWorkspaceModal-module_header_pHkXZ",aIe="CustomizeWorkspaceModal-module_teamInfo_w79--",iIe="CustomizeWorkspaceModal-module_name_0Efjh",sIe="CustomizeWorkspaceModal-module_members_AWZAo",nIe="CustomizeWorkspaceModal-module_filler_XhQiO",rIe="CustomizeWorkspaceModal-module_group1_2VCDw",lIe="CustomizeWorkspaceModal-module_one_nSfYi",dIe="CustomizeWorkspaceModal-module_two_USP6M",cIe="CustomizeWorkspaceModal-module_three_M0tql",uIe="CustomizeWorkspaceModal-module_darkGray_89UNg",mIe="CustomizeWorkspaceModal-module_divider_JCGsl",pIe="CustomizeWorkspaceModal-module_group2_RK4Sq",hIe="CustomizeWorkspaceModal-module_four_p4rU1",gIe="CustomizeWorkspaceModal-module_five_BIc4n",fIe="CustomizeWorkspaceModal-module_six_INIBz",yIe=()=>{},vIe=_.memo((({entryPoint:e,onClose:t=yIe})=>{const o=il(),{isQualifiedDomain:a,currentUser:i}=tl((e=>{var t;return{currentUser:e.currentUser,isQualifiedDomain:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.isQualifiedDomain}}),ol),s=Ac(),[n,r]=h.useState("My Workspace"===s.name?"":s.name),l=h.useContext(rSe);h.useEffect((()=>{(e=>{Fm(ym.BEGIN_ADD_WORKSPACE_DETAILS,{"Entry Point":e})})(e)}),[e]);const d=l.exists,c=e=>{r(e.target.value)},u=()=>{d?l.onClose():t()},m=e=>{""===e.target.value&&r(EP(i.user.firstName,a,s.emailDomain))},p=h.useCallback((async()=>{if(n!==(null==s?void 0:s.name))try{const t=""===n?EP(i.user.firstName,a,s.emailDomain):n;o(Np(s._id,t)),Mp(s._id,{name:t}),t!==EP(i.user.firstName,a,s.emailDomain)&&xM(e)}catch(IGe){mh({description:"Couldn't update team name.",error:IGe})}}),[s._id,s.emailDomain,null==s?void 0:s.name,i.user.firstName,o,e,a,n]),g=h.useCallback((async()=>{await p()}),[p]),f=h.useCallback((async e=>{null==e||e.preventDefault(),await g(),d?l.goToNextModal():t()}),[g,d,l,t]),y=h.useMemo((()=>({...s,name:n})),[s,n]),v=()=>{const e=()=>w.jsx(b9,{team:y,className:eIe});return w.jsxs("div",{className:XEe,children:[w.jsxs("div",{className:QEe,children:[e(),w.jsx("div",{className:ZEe}),w.jsx("div",{className:ZEe})]}),w.jsxs("div",{className:tIe,children:[w.jsxs("div",{className:oIe,children:[e(),w.jsxs("div",{className:aIe,children:[w.jsx("div",{className:iIe,children:w.jsx("div",{className:JEe,children:n||"Your Team Name"})}),w.jsx("div",{className:sIe,children:w.jsx("span",{children:"Members"})})]})]}),w.jsxs("div",{className:nIe,children:[w.jsxs("div",{className:rIe,children:[w.jsx("div",{className:lIe}),w.jsx("div",{className:dIe}),w.jsx("div",{className:cIe})]}),w.jsx("div",{className:uIe}),w.jsx("div",{className:mIe}),w.jsxs("div",{className:pIe,children:[w.jsx("div",{className:lIe}),w.jsx("div",{className:dIe}),w.jsx("div",{className:cIe}),w.jsx("div",{className:hIe}),w.jsx("div",{className:gIe}),w.jsx("div",{className:fIe})]})]})]})]})},_=()=>w.jsxs("div",{className:nSe.modalWithImageContainer,"data-cy":"customize-workspace-modal","data-testid":"customize-workspace-modal",children:[w.jsxs("div",{className:nSe.left,children:[w.jsx("div",{className:nSe.header,children:"Customize Your Team Workspace"}),w.jsxs("form",{className:nSe.form,onSubmit:f,children:[w.jsxs(w.Fragment,{children:[w.jsx("label",{className:nSe.inputLabel,htmlFor:"new-team-name",children:"Name your workspace"}),w.jsx("input",{id:"new-team-name",type:"text",className:nSe.textInput,value:n||"",onChange:c,onBlur:m,placeholder:EP(i.user.firstName,a,s.emailDomain),autoFocus:!0,required:!0,"data-testid":"new-team-name-input"})]}),w.jsxs(w.Fragment,{children:[w.jsxs("label",{className:nSe.inputLabel,htmlFor:"upload-logo",children:["Set your workspace icon",w.jsx("div",{className:nSe.secondary,children:"This helps future members recognize your workspace"})]}),w.jsx("div",{className:nSe.uploadLogoContainer,children:w.jsx(HEe,{entryPoint:e})})]}),a&&w.jsxs("div",{className:nSe.mTop32,children:[w.jsx("label",{className:nSe.inputLabel,htmlFor:"upload-logo",children:"Set who can discover your team workspace"}),w.jsx("div",{className:nSe.mTop16,children:w.jsx(YEe,{})})]}),d?w.jsx(lSe,{onClick:f}):w.jsx(Iie,{className:nSe.modalPrimaryButton,onClick:f,testId:"customize-workspace-modal-confirm-button",buttonText:"Update Team"})]})]}),w.jsx("div",{className:`${nSe.right} ${qEe}`,children:v()}),w.jsx("div",{className:`${nSe.exit} ${nSe.light}`,onClick:u,children:w.jsx(ve,{})})]});return d?_():w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:t,children:_()})}));var _Ie=(e=>(e.DISABLE="Disable",e.ENABLE="Enable",e.RESET="Reset",e))(_Ie||{}),wIe=(e=>(e.SIDEBAR="Add Members in Sidebar",e.WORKSPACE_HEADER="Workspace Header",e.USER_ONBOARDING="New User Onboarding",e.TEAM_SETTINGS="Team Settings",e.TEAM_CREATION="Team Creation",e.WORKSPACE_SIDEBAR_UPSELL="Workspace Sidebar Upsell",e.PROJECT_SHARE_DIALOG="Project Share Dialog",e))(wIe||{});const bIe=_.memo((()=>{const e=tl((e=>e.currentUser.user.onboarding));h.useEffect((function(){Jxe(Kxe.Onboarding,{inProgress:!0})}),[]);const t=h.useMemo((()=>[{modal:w.jsx(vIe,{entryPoint:wIe.USER_ONBOARDING}),onNext:BM},{modal:w.jsx(EEe,{entryPoint:wIe.USER_ONBOARDING})}]),[]),o=h.useCallback((async()=>{await FK({...e,secondSessionOnboarding:{...null==e?void 0:e.secondSessionOnboarding,dateDismissed:new Date}}),await np(),Jxe(Kxe.Onboarding,{inProgress:!1})}),[e]),a=h.useCallback((async()=>{await FK({...e,secondSessionOnboarding:{...null==e?void 0:e.secondSessionOnboarding,dateComplete:new Date}}),await np(),Jxe(Kxe.Onboarding,{inProgress:!1})}),[e]);return w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:o,children:w.jsx(dSe,{modalSteps:t,onClose:o,onFlowDismissed:o,onFlowComplete:a,testId:"second-session-onboarding"})})}));var TIe=(e=>(e.PersonalizeWorkspace="personalizeWorkspace",e.TwoWeekPostOnboarding="twoWeekPostOnboarding",e.BrandkitInfoBanner="brandkitInfoBanner",e.Survey="survey",e.BrandkitPrepopulated="brandkitPrepopulated",e.CreateYourFirstVideo="createYourFirstVideo",e.IntroducingRepurposeStudio="introducingRepurposeStudio",e))(TIe||{});function xIe(){const e=tl((e=>e.currentUser)),t=Ac(),o=h.useCallback((o=>SIe(e,t._id,o)),[t._id,e]),a=h.useCallback((o=>EIe(e,t._id,o)),[t._id,e]),i=h.useCallback((async o=>{await IIe(e,t._id,o)}),[t._id,e]),s=h.useCallback((async o=>{await CIe(e,t._id,o)}),[t._id,e]);return h.useMemo((()=>({getUpsellDateShown:o,getUpsellDateAcknowledged:a,setUpsellAcknowledged:s,setUpsellShown:i})),[a,o,s,i])}const SIe=(e,t,o)=>{var a;const i=null==(a=e.user)?void 0:a.upsells;if(i)switch(o){case"brandkitPrepopulated":case"personalizeWorkspace":{const e=i[`${o}_${t}`];if(!e||!e.dateShown)return;return new Date(String(e.dateShown))}default:{const e=i[o];if(!e||!e.dateShown)return;return new Date(String(e.dateShown))}}},EIe=(e,t,o)=>{var a;const i=null==(a=e.user)?void 0:a.upsells;if(i)switch(o){case"brandkitPrepopulated":case"personalizeWorkspace":{const e=i[`${o}_${t}`];if(!e||!e.dateAcknowledged)return;return new Date(String(e.dateAcknowledged))}default:{const e=i[o];if(!e||!e.dateAcknowledged)return;return new Date(String(e.dateAcknowledged))}}},IIe=async(e,t,o)=>{var a;const i=null==(a=e.user)?void 0:a.upsells,s=null==i?void 0:i[o];switch(o){case"brandkitPrepopulated":case"personalizeWorkspace":{const e=`${o}_${t}`;await pp({...i,[e]:{...s,dateShown:new Date}});break}default:await pp({...i,[o]:{...s,dateShown:new Date}})}},CIe=async(e,t,o)=>{var a;const i=null==(a=e.user)?void 0:a.upsells,s=null==i?void 0:i[o];switch(o){case"brandkitPrepopulated":case"personalizeWorkspace":{const e=`${o}_${t}`;await pp({...i,[e]:{...s,dateAcknowledged:new Date}});break}default:{const e=null==i?void 0:i[o];await pp({...i,[o]:{...e,dateAcknowledged:new Date}});break}}},kIe=_.memo((()=>{const{getUpsellDateShown:e,setUpsellShown:t}=xIe(),o=bW(),a=tl((e=>e.currentUser)),i=!!e(TIe.TwoWeekPostOnboarding);return Kp(a)||(i?(t(TIe.TwoWeekPostOnboarding),o((()=>{}),{action:Vl.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT_UPSELL})()):(t(TIe.TwoWeekPostOnboarding),o((()=>{}),{action:Vl.TWO_WEEK_RECURRING_SINGLE_ACCOUNT_UPSELL})())),null})),AIe=()=>{var e,t,o,a,i,s,n,r,l,d;const c=new Date,u=tl((e=>e.currentUser)),m=Ac(),p=null==(e=null==m?void 0:m.users)?void 0:e.find((e=>e.userId===u.user._id)),{onboarding:g}=u.user,f=(null==g?void 0:g.skipped)||(null==g?void 0:g.survey),y=(null==(t=null==g?void 0:g.survey)?void 0:t.usage)===od.School,v=new Date("Thu Aug 31 2023 14:19:01 GMT-0700 (Pacific Daylight Time)")>((null==g?void 0:g.survey)&&(null==(o=null==g?void 0:g.survey)?void 0:o.date)?new Date(null==(a=null==g?void 0:g.survey)?void 0:a.date):new Date),[_,w]=h.useState(),b=null==_?void 0:_.inFirstSession,[T,x]=h.useState(!0),{getUpsellDateShown:S}=xIe(),E=(null==(i=null==g?void 0:g.survey)?void 0:i.date)?new Date(g.survey.date):c,I=S(TIe.TwoWeekPostOnboarding),C=I?new Date(I):c,k=((e,t,o)=>{const a=ur(e,t);return xn.map((e=>Tn[e].activeOnDay)).filter((e=>e<o)).filter((e=>e>a)).length>0})(E,C,ur(E,c)),A=!!I&&ur(C,c)>=14,j=(null==(s=null==g?void 0:g.survey)?void 0:s.usage)!==od.School,N=IP(null==p?void 0:p.role),R=(null==m?void 0:m.users)&&1===(null==m?void 0:m.users.length),P=au().isPaid;h.useEffect((function(){w(Yxe(Kxe.Onboarding)),x(!1)}),[]);return{showOnboardingSurvey:!window.Cypress&&!(null==g?void 0:g.survey)&&!(null==g?void 0:g.skipped),showFirstSessionOnboarding:!(null==(n=null==g?void 0:g.firstSessionOnboarding)?void 0:n.dateDismissed)&&!(null==(r=null==g?void 0:g.firstSessionOnboarding)?void 0:r.dateComplete)&&!v&&!y&&f,showSecondSessionOnboarding:!(null==(l=null==g?void 0:g.secondSessionOnboarding)?void 0:l.dateDismissed)&&!(null==(d=null==g?void 0:g.secondSessionOnboarding)?void 0:d.dateComplete)&&!(null==g?void 0:g.skipped)&&f&&!v&&!y&&!b&&!T,showPostOnboardingUpsell:(k||A)&&!P&&N&&j&&R}},jIe=_.memo((()=>{const{showOnboardingSurvey:e,showFirstSessionOnboarding:t,showSecondSessionOnboarding:o,showPostOnboardingUpsell:a}=AIe();return tl((e=>e.currentUser)).impersonatingAdminEmail?null:e?w.jsx(eEe,{}):t?w.jsx(MSe,{}):o?w.jsx(bIe,{}):a?w.jsx(kIe,{}):null})),NIe="Folder-module_mainContent_2OfDX",RIe="Folder-module_mainContainer_KmVHe",PIe=e=>{const{workspaces:t}=e,{currentFolderSettings:o,SWMFolderSettings:a}=t,i="shared-with-me"===e.workspaces.selectedWorkspace;return!(!i||(null==a?void 0:a.view)!==Qw.GRID_VIEW)||!i&&((null==o?void 0:o.view)===Qw.GRID_VIEW||!o)},DIe=e=>!PIe(e),OIe=e=>{const{workspaces:t}=e,{currentFolderSettings:o,SWMFolderSettings:a}=t;if("shared-with-me"===e.workspaces.selectedWorkspace){if((null==a?void 0:a.sortOrder)===eb.ASCENDING)return!0;if(!a)return!0}else{if((null==o?void 0:o.sortOrder)===eb.ASCENDING)return!0;if(!o)return!0}return!1},LIe=e=>!OIe(e),FIe="UpsellTooltip-module_upsellTooltipContainer_w38I3",MIe="UpsellTooltip-module_warning_Y7Dn3",UIe="UpsellTooltip-module_iconWrapper_ZImlF",BIe="UpsellTooltip-module_button_VIE1C",VIe=()=>{},WIe=_.memo((({action:e,onPaywallSuccess:t=VIe,body:o=null,buttonText:a="Upgrade"})=>w.jsxs("div",{className:FIe,children:[w.jsxs("div",{className:MIe,children:[w.jsx("div",{className:UIe,children:w.jsx(to,{})}),w.jsx("span",{children:o})]}),w.jsx(jie,{className:BIe,action:e,onPaywallSuccess:t,buttonText:a,hasIcon:!0})]}))),GIe={home:"ProjectElement-module_home_UVHGp",homeHowBackgroundWhite:"ProjectElement-module_homeHowBackgroundWhite_RDLC8",largeButton:"ProjectElement-module_largeButton_bULc7",sectionContent:"ProjectElement-module_sectionContent_PgtVU",sectionHeader:"ProjectElement-module_sectionHeader_LNGaC",spacer:"ProjectElement-module_spacer_B-gq6",chevron:"ProjectElement-module_chevron_Ccwou",splashText:"ProjectElement-module_splashText_ehTQ-",splashSubtext:"ProjectElement-module_splashSubtext_1D1q-",aboutSection:"ProjectElement-module_aboutSection_lR3el",mobile:"ProjectElement-module_mobile_TuJ82",desktop:"ProjectElement-module_desktop_Vvn-K",screenReaderOnlyLabel:"ProjectElement-module_screenReaderOnlyLabel_cG5xC",disabled:"ProjectElement-module_disabled_CE-EZ",noScrollBar:"ProjectElement-module_noScrollBar_u9mFt",textOverflowEllipsis:"ProjectElement-module_textOverflowEllipsis_-e8fv",disableTextHighlight:"ProjectElement-module_disableTextHighlight_PWcXP",genericButtonBlue:"ProjectElement-module_genericButtonBlue_Dtccr",elementTopRow:"ProjectElement-module_elementTopRow_9MIZq",elementBottomRow:"ProjectElement-module_elementBottomRow_gYpk3",timestamp:"ProjectElement-module_timestamp_-jGYC",icon:"ProjectElement-module_icon_HzT1Y",dummyProjectElement:"ProjectElement-module_dummyProjectElement_9ezlV",listView:"ProjectElement-module_listView_7UNZv",gridView:"ProjectElement-module_gridView_J-k2E",projectWrapper:"ProjectElement-module_projectWrapper_WYM7p",sharedWithMe:"ProjectElement-module_sharedWithMe_-X2lM",selectProjectButton:"ProjectElement-module_selectProjectButton_OagAA",locked:"ProjectElement-module_locked_gDjAX",uploadProject:"ProjectElement-module_uploadProject_lOLFD",projectSelected:"ProjectElement-module_projectSelected_gJeTI",thumbnailContainer:"ProjectElement-module_thumbnailContainer_20Rr8",projectPlaceholder:"ProjectElement-module_projectPlaceholder_Wq-9x",contentInfo:"ProjectElement-module_contentInfo_TN-46",projectContainer:"ProjectElement-module_projectContainer_UTpod",lockedProject:"ProjectElement-module_lockedProject_ZacLf",thumbnailWrapper:"ProjectElement-module_thumbnailWrapper_yBmrn",selectProjectButtonWrapperListView:"ProjectElement-module_selectProjectButtonWrapperListView_K9L-q",projectThumbnail:"ProjectElement-module_projectThumbnail_PYU15",selectProjectButtonFixed:"ProjectElement-module_selectProjectButtonFixed_4LwOY",projectIsSelectable:"ProjectElement-module_projectIsSelectable_YH3h6",type:"ProjectElement-module_type_OhXPQ",draft:"ProjectElement-module_draft_V6s29",more:"ProjectElement-module_more_hWTEx",checked:"ProjectElement-module_checked_qWFiA",visible:"ProjectElement-module_visible_MyTgw",hamburger:"ProjectElement-module_hamburger_ThxCb",belowProjects:"ProjectElement-module_belowProjects_bEdan",projectName:"ProjectElement-module_projectName_aJVsu",projectNameTooltipContainer:"ProjectElement-module_projectNameTooltipContainer_QvRuj",projectNameTooltip:"ProjectElement-module_projectNameTooltip_YroBo",listViewNameContainer:"ProjectElement-module_listViewNameContainer_r845G",dateInfo:"ProjectElement-module_dateInfo_D4geD",authorInfo:"ProjectElement-module_authorInfo_oepsE",contentContainer:"ProjectElement-module_contentContainer_fQEwj",placeholderIcon:"ProjectElement-module_placeholderIcon_ad0l6",lockIcon:"ProjectElement-module_lockIcon_CpxB2",thumbnailIcon:"ProjectElement-module_thumbnailIcon_DRkPA",pendingDeletion:"ProjectElement-module_pendingDeletion_BPPvC",accessIconBackground:"ProjectElement-module_accessIconBackground_ImALY",accessIcon:"ProjectElement-module_accessIcon_pxmbb",inputNameWrapper:"ProjectElement-module_inputNameWrapper_v-b-d",typeInput:"ProjectElement-module_typeInput_vlBhm",draftInput:"ProjectElement-module_draftInput_583w6",moreIcon:"ProjectElement-module_moreIcon_moPDj",listViewUploadThumbnail:"ProjectElement-module_listViewUploadThumbnail_twniY",uploading:"ProjectElement-module_uploading_Z3I2a",cancelled:"ProjectElement-module_cancelled_5WAot",cancelUpload:"ProjectElement-module_cancelUpload_uh6q8",cancelText:"ProjectElement-module_cancelText_btllJ",cancelUploadText:"ProjectElement-module_cancelUploadText_Dr3tN",sharedDropdown:"ProjectElement-module_sharedDropdown_xTQ0-",sidenav:"ProjectElement-module_sidenav_JOTOk",main:"ProjectElement-module_main_zOUr8",getStarted:"ProjectElement-module_getStarted_JoQ-9",lockedWrapper:"ProjectElement-module_lockedWrapper_kFJbx"},HIe="ProjectElementAdminData-module_header_1heN8",$Ie="ProjectElementAdminData-module_stat_WNLln",KIe="ProjectElementAdminData-module_container_a9cNV",zIe=g.connect((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace}))),YIe=h.memo(zIe((({video:e,currentUser:t,locked:o})=>{if(!Kp(t))return null;let a=0;if(e.scenes)for(const i of e.scenes)a+=i.layers.length;return w.jsxs("div",{className:KIe,children:[w.jsx("div",{className:HIe,children:"Admin Data"}),w.jsxs("div",{className:$Ie,children:["Locked: ",w.jsx("span",{children:o?"YES":"NO"})]}),w.jsxs("div",{className:$Ie,children:["Created: ",e.createdAt]}),w.jsxs("div",{className:$Ie,children:["Last Viewed: ",e.lastSeen]}),w.jsxs("div",{className:$Ie,children:["# of Scenes: ",w.jsx("span",{children:e.scenes&&e.scenes.length||0})]}),w.jsxs("div",{className:$Ie,children:["# of Layers: ",a]}),w.jsxs("div",{className:$Ie,children:["Publish Count: ",e.publishCount]}),w.jsx(Ft,{className:$Ie,to:`/videos/${e._id}/debug`,children:"Debug"})]})})));function JIe(e){const t=new Date(e);return(Date.now()-t.getTime())/864e5}function qIe(e=!1,t,o,a=3e4,i=!1,s,n=!1){const{state:r}=sr(),{currentUser:{user:l}}=r,{createdAt:d,creatorId:c,done:u,draft:m,finishedAt:p,lastEditorName:h,lastSaved:g,originalUser:f,publishedClientside:y,submittedAt:v,isBrandKitTemplate:_}=t;let w="",b="",T="",x="";const S=Math.abs(new Date(p||y||d).getTime()-new Date(g||v).getTime())<a||new Date(p||y||v||d)>new Date(g||v),E=new Date(p||y||v||d)<new Date(g||v),I=!u&&!m&&!d,C=h||(null==f?void 0:f.name)||c===l._id&&l.name||I&&l.name||"Anonymous User";return i&&s?e&&!o?(w=`${f.name}`,b=`${mr(new Date(s))}`,x=pr(new Date(s))):(T=f.name,x=pr(new Date(s)),w=`Shared by ${T}`,b=`Shared ${mr(new Date(s))}`):m||_?e&&!o?(w=`${C}`,b=`${mr(g||v||d)}`,x=pr(g||v||d)):(T=C,x=pr(g||v||d),w=`Last edited by ${T}`,b=`${"published"===_?"Published":"Draft saved"} ${mr(g||v||d)}`):S||I?e&&!o?(w=`${C}`,b=`${mr(p||y||v||d)}`,x=pr(p||y||v||d)):(T=C,x=pr(p||y||v||d),w=`Last exported by ${T}`,b=`Exported ${mr(p||y||v||d)}`):E&&(e&&!o?(x=pr(g||v||d),w=`${C}`,b=`${mr(g||v||d)}`):(T=C,x=pr(g||v||d),w=`Last edited by ${T}`,b=`Draft saved ${mr(g||v||d)}`)),C||(w=""),n&&(x=pr(d)),{lastAuthor:w,lastDate:b,onlyLastAuthor:T||w,onlyLastDate:x}}const XIe=_.memo((({videoId:e})=>{const t=il(),[o,a]=h.useState(!1),i=h.useCallback((async()=>{a(!0);try{await zr(`/api/v1/videos/${e}/removeUser`),t(wl({description:"You have been removed from this project as a video collaborator.",type:"success"})),cO({projectId:e,folderId:Vn})}catch(IGe){mh({description:"There was an error removing this project from your shared with me view.",error:IGe})}a(!1),vh()}),[t,e]);return w.jsxs("div",{className:tfe,children:[w.jsx("div",{className:ofe,children:"Remove yourself as a collaborator from this project?"}),w.jsx("div",{className:afe,children:"You'll lose access to this project and it will disappear from your Shared with Me view. This action cannot be undone."}),w.jsx(GF,{cancelFn:vh,confirmFn:i,confirmText:"Remove",cancelText:"Cancel",loadingMsg:o?"Removing...":void 0,confirmButtonClassName:`${ife} ${sfe}`})]})})),QIe="DropdownMenu-module_dropdownContainer_oQMxf",ZIe="DropdownMenu-module_item_wZWmr",eCe="DropdownMenu-module_icon_-X3XL";var tCe=(e=>(e.Generic="DropdownItemType.Generic",e.Custom="DropdownItemType.Custom",e))(tCe||{});const oCe=_.memo((({icon:e,label:t,onClick:o})=>{const a=`dropdown-section-${t.toLowerCase().replace(" ","-")}`;return w.jsxs(Ye,{"data-cy":a,"data-testid":a,className:ZIe,onClick:o,children:[e&&w.jsx("div",{className:eCe,children:e}),w.jsx("span",{children:t})]},t)})),aCe=_.memo((({children:e,onClick:t})=>w.jsx(Ye,{onClick:t,children:e}))),iCe=_.memo((({children:e,items:t,maxWidth:o=200,side:a="bottom",sideOffset:i=4,align:s="center",alignOffset:n=0,disabled:r=!1})=>{const l=h.useCallback((e=>e.preventDefault()),[]),d=h.useMemo((()=>t.map(((e,t)=>{const{type:o}=e;switch(o){case"DropdownItemType.Generic":return h.createElement(oCe,{...e,key:t});case"DropdownItemType.Custom":return h.createElement(aCe,{...e,key:t});default:throw new Error(`No implementation for ${o}.`)}}))),[t]),c=h.useMemo((()=>({maxWidth:o})),[o]);return w.jsxs(He,{modal:!1,children:[w.jsx($e,{asChild:!0,disabled:r,children:e}),w.jsx(Ke,{container:sM(),children:w.jsx(ze,{className:QIe,style:c,onClick:l,side:a,sideOffset:i,align:s,alignOffset:n,children:d})})]})})),sCe="WorkspaceElement-module_elementContainer_Yt-12",nCe="WorkspaceElement-module_selectionButton_yJ6Mi",rCe="WorkspaceElement-module_thumbnailWrapper_kJVGu",lCe="WorkspaceElement-module_projectThumbnail_YeLIg",dCe="WorkspaceElement-module_blurredThumbnailWrapper_XYbZK",cCe="WorkspaceElement-module_blurredThumbnail_Yms-X",uCe="WorkspaceElement-module_elementTextContainer_-d5-q",mCe="WorkspaceElement-module_titleRow_Nstu4",pCe="WorkspaceElement-module_title_I1wzQ",hCe="WorkspaceElement-module_renameInput_5kRed",gCe="WorkspaceElement-module_subtitleWrapper_FMp9M",fCe="WorkspaceElement-module_subtitle_W6W54",yCe="WorkspaceElement-module_subtitleLink_2-uTf",vCe="WorkspaceElement-module_multiLine_Q1oHB",_Ce="WorkspaceElement-module_separator_Vc8nn",wCe="WorkspaceElement-module_thumbnailContainer_lXD1J",bCe="WorkspaceElement-module_lockIcon_mLegI",TCe="WorkspaceElement-module_duration_rNnpY",xCe="WorkspaceElement-module_iconWrapper_iTtpD",SCe="WorkspaceElement-module_icon_kbcQR",ECe="WorkspaceElement-module_lockedElement_bKUG3",ICe="WorkspaceElement-module_privateIcon_gVhqo",CCe="WorkspaceElement-module_lockedText_AC1t2",kCe="WorkspaceElement-module_outerSelectionButton_SJhOl",ACe="WorkspaceElement-module_selectionMode_eIzhB",jCe="WorkspaceElement-module_checkWrapper_0GJ8k",NCe="WorkspaceElement-module_selected_I70Rj",RCe="WorkspaceElement-module_checkIcon_qDTuT",PCe="WorkspaceElement-module_dropdownIcon_8qUmO",DCe="WorkspaceElement-module_marginRight_JVeBZ",OCe=_.memo((({project:e,onRename:t,onDelete:o})=>{const a=il(),i=Ve(),s=tl((e=>e.explorer.folders)),n=tl((e=>e.workspaces.selectedWorkspace===Vn)),r=tl((e=>e.currentUser)),{user:l}=r,{code:d}=(e=>{const t=tl((t=>t.projects.byId[e])),[o,a]=h.useState(null==t?void 0:t.content.code),i=null==t?void 0:t.content._id;return h.useEffect((()=>{o||(async()=>{if(!i)return;const e=await qr(`/api/v2/videos/${i}/share`);a(e.code)})()}),[i,o]),{code:o}})(e._id),c=e.content,u=NU(Bl.BRANDKIT),m=NU(Bl.CHANGE_PRIVACY),p=bW(),g=xh(),f=Rge(),y=Pge();h.useEffect((()=>{bh()}),[]);const v=h.useCallback((async()=>{if(!d)return;let e="";const t=c.draft?"w":"c";c.draft&&ep(l,c._id,c.creatorEmail,"Workspace","Copy Link");try{if(!d)throw new Error("No share code");e=qye(d,t)}catch(o){mh({description:"Failed to copy link",error:o})}try{await hEe(e),a(wl({description:"Link to project added to clipboard.",type:"success"}))}catch(o){mh({description:"Failed to copy link",error:o})}}),[d,a,l,c._id,c.creatorEmail,c.draft]),_=h.useCallback((async()=>{if(u)try{Fm(ym.CONVERT_PROJECT_TO_BRAND_TEMPLATE_DROPDOWN),await Age(Lge.PROJECT_DROPDOWN,e._id)}catch(t){console.error(t)}else p((()=>null),{action:Vl.BRANDKIT})()}),[u,p,e._id]),b=h.useCallback((()=>{const e=new URL(k0(c,"fullPath"));pye(e.href)}),[c]),T=h.useCallback((async()=>{m?await(async e=>{const{dispatch:t}=sr(),o=e.content;try{const e=o.privacy===Ln.private?Ln.unlisted:Ln.private,a=await oK(o._id,e);t(pO({projectId:o.projectId,updateDict:{privacy:a.privacy}}))}catch(a){mh({description:"Failed to change privacy",error:a})}})(e):p((()=>null),{action:Vl.PRIVACY})()}),[m,p,e]),x=h.useCallback((async()=>{const{destinationFolder:t}=await f([e._id],Fge.WORKSPACE_BULK_MOVE);s.some((e=>e._id===t._id))&&(i.push(`/folder/${t._id}`),Nge({workspaceId:t._id,teamId:t.teamId}))}),[s,i,f,e._id]),S=h.useCallback((async()=>{try{const{copiedProject:t,destinationFolder:o}=await y(e._id,{duplicate:!n,entryPoint:Lge.PROJECT_DROPDOWN});o&&t?(a(wl({description:`Created ${t.name}`,type:"success"})),i.push(`/folder/${o._id}`),Nge({workspaceId:o._id,teamId:o.teamId})):a(wl({description:"Error copying project to folder. Please try again.",type:"error"}))}catch(t){}}),[y,a,i,e._id,n]),E=h.useCallback((()=>{i.push(`/${c._id}/studio/editor`)}),[i,c._id]),I=h.useCallback((()=>{nfe([e._id],(()=>{o&&o()}))}),[e._id,o]),C=h.useCallback((()=>{var t;t=e._id,_h({modalType:gh.SWM_REMOVE_PROJECT,projectId:t})}),[e._id]),k=!c.draft&&c.done&&!n,A=g&&!n,j=c.privacy===Ln.private,N=h.useMemo((()=>{const e=[];return k&&e.push({label:"Download latest export",icon:w.jsx(Ka,{}),onClick:b,type:tCe.Generic}),t&&e.push({label:"Rename",icon:w.jsx(za,{}),onClick:t,type:tCe.Generic}),e.push({label:"Edit",icon:w.jsx(Fa,{}),onClick:E,type:tCe.Generic}),e.push({label:n?"Make a copy":"Duplicate",icon:w.jsx(Qo,{}),onClick:S,type:tCe.Generic}),A&&e.push({label:"Move to",icon:w.jsx(Ya,{}),onClick:x,type:tCe.Generic}),n||(e.push({label:"Make "+(j?"unlisted":"private"),icon:j?w.jsx(qo,{}):w.jsx(Jo,{}),onClick:T,type:tCe.Generic}),e.push({label:"Delete",icon:w.jsx(fa,{}),onClick:I,type:tCe.Generic})),e.push({label:"Copy Link",icon:w.jsx(Ja,{}),onClick:v,type:tCe.Generic}),n||e.push({label:"Save as Brand Template",icon:w.jsx(qa,{}),onClick:_,type:tCe.Generic}),n&&e.push({label:"Remove",icon:w.jsx(ve,{}),onClick:C,type:tCe.Generic}),e}),[b,t,E,S,A,x,n,j,T,I,v,_,C,k]);return w.jsx(iCe,{items:N,children:w.jsx("div",{className:mt(PCe,DCe),onClick:e=>{e.preventDefault(),e.stopPropagation()},children:w.jsx(Xa,{size:22})})})})),LCe="SearchResultElement-module_iconThumbnail_Bd5ZQ",FCe="SearchResultElement-module_blurredThumbnailBackground_6igb5",MCe="SearchResultElement-module_blurredImage_psxRn",UCe="SearchResultElement-module_imageWrapper_bolt3",BCe="SearchResultElement-module_thumbnailImg_ctat1",VCe="SearchResultElement-module_workspaceHeight_K0nyh",WCe="SearchResultElement-module_workflowHeight_yPel5",GCe="SearchResultElement-module_wrapper_sYK33";var HCe=(e=>(e.BRANDKIT_TEMPLATE="brandkit_template",e.FOLDER="folder",e.RECENT_SEARCH="recent_search",e.VIDEO="video",e.WORKFLOW="workflow",e.WORKFLOW_VIDEO="workflow_video",e))(HCe||{});const $Ce=_.memo((()=>w.jsx("svg",{width:"87",height:"73",viewBox:"0 0 87 73",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{d:"M2 61.1429V11.8571C2 9.24287 3.22588 6.73566 5.40796 4.88709C7.59005 3.03852 10.5496 2 13.6355 2H26.8224L38.4579 11.8571H73.3645C76.4504 11.8571 79.41 12.8957 81.592 14.7442C83.7741 16.5928 85 19.1 85 21.7143V61.1429C85 63.7571 83.7741 66.2643 81.592 68.1129C79.41 69.9615 76.4504 71 73.3645 71H13.6355C10.5496 71 7.59005 69.9615 5.40796 68.1129C3.22588 66.2643 2 63.7571 2 61.1429Z",stroke:"#505050",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})}))),KCe=_.memo((({thumbnailUrl:e,elementType:t})=>{const o=t===HCe.WORKFLOW_VIDEO,a=t===HCe.WORKFLOW_VIDEO,[i,s]=_.useState(!1);return t===HCe.FOLDER?w.jsx("div",{className:LCe,children:w.jsx($Ce,{})}):w.jsxs("div",{className:GCe,children:[!o&&w.jsx("div",{className:MCe,children:w.jsx("div",{className:`${FCe}`,style:{backgroundImage:`url(${i?zn:e||zn})`}})}),w.jsx("div",{className:UCe,children:w.jsx("img",{src:e,alt:"Thumbnail",className:`${BCe} ${a?WCe:VCe}`,onError:e=>{s(!0),e.currentTarget.src=zn}})})]})})),zCe={home:"WorkspaceElementTypeIcon-module_home_op9qp",homeHowBackgroundWhite:"WorkspaceElementTypeIcon-module_homeHowBackgroundWhite_RxKeb",largeButton:"WorkspaceElementTypeIcon-module_largeButton_QCo5o",sectionContent:"WorkspaceElementTypeIcon-module_sectionContent_Pt1Sr",sectionHeader:"WorkspaceElementTypeIcon-module_sectionHeader_orqDs",spacer:"WorkspaceElementTypeIcon-module_spacer_N-w2T",chevron:"WorkspaceElementTypeIcon-module_chevron_oBPnN",splashText:"WorkspaceElementTypeIcon-module_splashText_EzV0M",splashSubtext:"WorkspaceElementTypeIcon-module_splashSubtext_kQVWP",aboutSection:"WorkspaceElementTypeIcon-module_aboutSection_0MXkO",mobile:"WorkspaceElementTypeIcon-module_mobile_emzWU",desktop:"WorkspaceElementTypeIcon-module_desktop_M4DGI",screenReaderOnlyLabel:"WorkspaceElementTypeIcon-module_screenReaderOnlyLabel_YvLJB",disabled:"WorkspaceElementTypeIcon-module_disabled_BMGr6",noScrollBar:"WorkspaceElementTypeIcon-module_noScrollBar_687jO",textOverflowEllipsis:"WorkspaceElementTypeIcon-module_textOverflowEllipsis_ub2FS",disableTextHighlight:"WorkspaceElementTypeIcon-module_disableTextHighlight_EeK-4",genericButtonBlue:"WorkspaceElementTypeIcon-module_genericButtonBlue_ncQc-",projectIcon:"WorkspaceElementTypeIcon-module_projectIcon_Q3YPX",absolute:"WorkspaceElementTypeIcon-module_absolute_10kwo",projectIconText:"WorkspaceElementTypeIcon-module_projectIconText_OT3Ia","icon-video":"WorkspaceElementTypeIcon-module_icon-video_2Utom","icon-workflow":"WorkspaceElementTypeIcon-module_icon-workflow_Pv-gR"},YCe=_.memo((({elementType:e,text:t,absolute:o})=>{const a=(e=>e===HCe.WORKFLOW?w.jsx(Qa,{size:18}):null)(e),i=a||t?w.jsxs(w.Fragment,{children:[a||null,t?w.jsx("span",{className:zCe.projectIconText,children:t}):null]}):null;return i?w.jsx("div",{className:mt(zCe.projectIcon,o?zCe.absolute:void 0,zCe[`icon-${e}`]),children:i}):null})),JCe=w.jsxs("span",{children:["Your access to Pro is ending. Once on the Free plan, projects can only be stored in your workspace for ",3," days from their creation date.",w.jsx("br",{}),w.jsx("br",{}),"Reactivate your Pro plan to continue saving all projects with unlimited workspace storage."]}),qCe=w.jsxs("span",{children:["This project will be deleted soon. Since you’re on the Free plan, projects are stored in your workspace for only ",3," days from their creation date.",w.jsx("br",{}),w.jsx("br",{}),"Upgrade to save all projects and get unlimited workspace storage."]}),XCe=_.memo((({gridView:e})=>w.jsx("div",{className:`${GIe.projectWrapper} ${e?GIe.gridView:GIe.listView} ${GIe.dummyProjectElement}`}))),QCe=kt((e=>({"Days Since Video Created":e})));class ZCe extends h.Component{constructor(e){super(e),i(this,"buttonPressTimer",null),i(this,"linkComponentRef"),i(this,"routerLinkTo"),i(this,"nameInputListener",(e=>{13===e.keyCode&&this.unselectName()})),i(this,"handleNameChange",(e=>{this.setState({name:e.target.value.substring(0,1024)})})),i(this,"selectName",(()=>{this.hideDropdown();const{locked:e,selectionMode:t}=this.props;e||t||this.setState({nameSelected:!0,name:this.props.project.name||""})})),i(this,"unselectName",(()=>{const{currentUser:e,project:t,locked:o,setProjectName:a}=this.props;if(o)return;this.setState({nameSelected:!1});const i=this.state.name.trim();if(i&&i.length&&i!==this.props.project.name){a(i),TK(t._id,{name:i},e);const{dispatch:o}=sr();o(hO({projectId:t._id,name:i}))}})),i(this,"getDaysUntilDeletion",(()=>{const{currentTeam:e,video:t,subscription:o}=this.props,a=RU(Bl.UNLIMITED_STORAGE),i=null==o?void 0:o.cancel_at_period_end;if(a&&!i)return null;const s=[null==t?void 0:t.createdAt,null==t?void 0:t.lastSaved,null==t?void 0:t.submittedAt].filter((e=>e));if(s.sort(),0===s.length)return null;let n=3-JIe(s[s.length-1]);if(o&&(null==o?void 0:o.cancel_at_period_end)){n=Rc(new Date(1e3*(o.cancel_at||0)),new Date)+14}if(null==e?void 0:e.downgradedAt){const t=Rc(new Date,new Date(e.downgradedAt));t<14&&(n=14-t)}return n})),i(this,"hideDropdown",(()=>{this.setState({showDropdown:!1})})),i(this,"closePaywallModal",(()=>{this.setState({showPaywallModal:!1})})),i(this,"renderPendingDeletionNotice",(()=>{const{isGridView:e,subscription:t,video:o,shared:a}=this.props,i="Tutorial Project"===o.projectName&&"Team Kapwing"===o.lastEditorName;if(!e||i||a)return null;if(t){if(Rc(new Date(1e3*(t.cancel_at||0)),new Date)+14>30)return null}const s=RU(Bl.UNLIMITED_STORAGE),n=s?JCe:qCe,r=this.getDaysUntilDeletion();return null==r?null:w.jsxs(T,{delayDuration:200,children:[w.jsx(C,{asChild:!0,children:w.jsxs("div",{className:GIe.pendingDeletion,"data-testid":"project-deletion-pending-badge",children:[w.jsx(ho,{})," ",w.jsx("span",{children:r>0?`Deletion in ${Math.ceil(r)} days`:"Deletion pending"})]})}),w.jsx(S,{children:w.jsx(E,{sideOffset:5,children:w.jsx(WIe,{body:n,action:Vl.DELETION_WARNING,buttonText:s?"Reactivate":"Upgrade"})})})]})})),i(this,"renderThumbnail",(()=>{const{locked:e,video:t,isGridView:o,isListView:a}=this.props,i=k0(t,"image_url","original");return w.jsxs("div",{className:e?`${GIe.projectThumbnail} ${a&&GIe.listView} ${GIe.locked}`:`${GIe.projectThumbnail} ${a&&GIe.listView}`,style:a?{backgroundImage:`url(${i||zn})`}:{},"data-cy":"project-thumbnail",children:[!a&&w.jsx("div",{className:GIe.thumbnailWrapper,children:w.jsx(KCe,{thumbnailUrl:i,elementType:t.searchType})}),!e&&!a&&this.renderSelectProjectButton(),e&&w.jsx("div",{className:GIe.lockIcon,children:w.jsx(Za,{})}),w.jsx("div",{className:GIe.elementTopRow,children:w.jsx(YCe,{absolute:!0,elementType:HCe.VIDEO})}),w.jsxs("div",{className:GIe.elementBottomRow,children:[this.renderPendingDeletionNotice(),o&&this.renderAccessIcon(),this.renderDuration()]})]})})),this.state={nameSelected:!1,name:this.getName(),nameInDb:this.getName(),showPaywallModal:!1,showPaywallTooltip:!1},this.linkComponentRef=_.createRef(),this.routerLinkTo={pathname:this.getLink(),state:this.props.shared?{from:Vn}:void 0}}componentDidMount(){var e;null==(e=this.linkComponentRef.current)||e.addEventListener("contextmenu",(e=>e.preventDefault()))}componentDidUpdate(e,t){!t.nameSelected&&this.state.nameSelected&&this.addNameInputListener(),this.props.shared===e.shared&&this.props.video===e.video||(this.routerLinkTo={pathname:this.getLink(),state:this.props.shared?{from:Vn}:void 0})}addNameInputListener(){document.getElementById("nameInput").addEventListener("keyup",this.nameInputListener)}getLink(){const{video:e,locked:t}=this.props;return t?"/":`/${e._id}/studio/editor`}getName(){const{video:e,project:t}=this.props,o=this.state&&this.state.name.trim&&this.state.name.trim();return this.state&&(o||this.state.nameSelected)?this.state.name:e.draft?t.name||An:t.name||e.projectName||e.name||xm(e)}renderDuration(){const{video:{duration:e}}=this.props;if(!e)return null;if("number"!=typeof e)return null;const t=cr(e),o=t.indexOf("."),a=o>0?o:t.length,i=t.substring(0,a);return w.jsx("div",{className:GIe.timestamp,children:i})}renderAccessIcon(){const{video:{privacy:e},isListView:t}=this.props;return!(1===e)||t&&this.state.nameSelected?null:w.jsx("div",{className:`${GIe.accessIconBackground} ${t&&GIe.listView}`,children:w.jsx(Jo,{className:GIe.accessIcon})})}renderName(){const{video:e,locked:t,selectionMode:o,shared:a,isListView:i}=this.props,s=e.draft?GIe.draft:GIe.type,n=e.draft?GIe.draftInput:GIe.typeInput,r=this.getName(),l=e=>{a&&i||(e.stopPropagation(),e.preventDefault(),this.selectName())};return!this.state.nameSelected||o?w.jsx("div",{className:t||e.pendingWorkspaceUpload?`${s} ${GIe.locked} ${i&&GIe.listView}`:`${s} ${i&&GIe.listView}`,onClick:l,children:r}):i&&!this.state.nameSelected?w.jsx("div",{className:t?`${n} ${GIe.locked} ${i&&GIe.listView}`:`${s} ${i&&GIe.listView}`,children:r}):w.jsx("div",{className:GIe.inputNameWrapper,children:w.jsx("input",{type:"text",id:"nameInput","data-cy":"workspace-project-name-input",className:t?`${n} ${GIe.locked} ${i&&GIe.listView}`:`${s} ${i&&GIe.listView}`,placeholder:An,value:r,onClick:this.selectName,onBlur:this.unselectName,onChange:this.handleNameChange,onKeyDown:e=>{e.metaKey&&"a"===e.key&&e.stopPropagation()},autoFocus:!0})})}renderSelectProjectButton(){const{onSelect:e,project:t,isSelected:o,selectionMode:a,shared:i,locked:s,isListView:n}=this.props;if(i)return null;const r=a=>{a.stopPropagation(),a.preventDefault(),e&&e(t._id,!o,a.shiftKey)};return n?w.jsx("div",{className:GIe.selectProjectButtonWrapperListView,children:w.jsx("input",{type:"radio",className:[GIe.selectProjectButton,GIe.listView,a?GIe.selectProjectButtonFixed:"",a&&!s?GIe.visible:"",o?GIe.checked:""].join(" "),checked:o,readOnly:!0,onMouseDown:e=>e.stopPropagation(),onClick:r})}):w.jsx("input",{type:"radio",className:[GIe.selectProjectButton,a?GIe.selectProjectButtonFixed:"",o?GIe.checked:""].join(" "),checked:o,readOnly:!0,onMouseDown:e=>e.stopPropagation(),onClick:r})}render(){const{isSelected:e,locked:t,onSelect:o,project:a,selectionMode:i,shared:s,sharedAt:n,video:r,projectContainerRef:l,isListView:d,currentFolderSettings:c,SWMFolderSettings:u}=this.props,m=(null==c?void 0:c.sortField)===Zw.DATE_CREATED&&!s||(null==u?void 0:u.sortField)===Zw.DATE_CREATED&&s||!c&&!s,{lastAuthor:p,lastDate:h,onlyLastAuthor:g,onlyLastDate:f}=qIe(d,r,this.props.isMobile,3e4,s,n,m),y=()=>{t||(this.buttonPressTimer=window.setTimeout((()=>{o&&o(a._id,!0)}),500))},v=()=>{this.buttonPressTimer&&clearTimeout(this.buttonPressTimer)},_=s=>{!t&&i&&o&&o(a._id,!e,s.shiftKey)},b=i=>{d&&!s&&(i.stopPropagation(),o&&o(a._id,!e,i.shiftKey)),d&&t&&T(i)},T=e=>{t?(e.preventDefault(),this.setState({showPaywallModal:!0})):i&&e.preventDefault()},x=()=>{const o=[];return o.push(t?GIe.lockedProject:GIe.projectContainer),t?o.push(GIe.lockedProject):(o.push(GIe.projectContainer),e&&o.push(GIe.projectSelected),i&&o.push(GIe.projectIsSelectable)),d&&o.push(GIe.listView),o.join(" ")};return d?(()=>w.jsxs(Ft,{className:`${GIe.projectWrapper} ${e&&GIe.projectSelected} ${GIe.listView} ${s&&GIe.sharedWithMe} ${t?GIe.lockedWrapper:""}`,onClick:T,to:this.routerLinkTo,"data-cy":"project-list-view-element","data-testid":`project-list-view-${a._id}`,draggable:"false",children:[this.renderSelectProjectButton(),w.jsxs("div",{ref:l,className:x(),onTouchStart:y,onTouchMove:v,onTouchEnd:v,onClick:_,children:[this.state.showPaywallModal&&w.jsx(gW,{action:Vl.STORAGE_LIMIT,onClose:this.closePaywallModal}),this.renderThumbnail(),w.jsxs("div",{className:t?`${GIe.contentInfo} ${GIe.locked} ${GIe.listView}`:`${GIe.contentInfo} ${d&&GIe.listView}`,children:[w.jsxs("div",{className:`${GIe.projectName} ${GIe.listView}`,"data-cy":"workspace-project-name",children:[w.jsx("div",{className:GIe.listViewNameContainer,translate:"no",children:this.renderName()}),this.renderAccessIcon()]}),w.jsxs("div",{className:`${GIe.dateInfo} ${GIe.listView}`,"data-cy":"workspace-project-status",children:[h.charAt(0).toUpperCase()+h.slice(1)," "]}),w.jsxs("div",{className:`${GIe.authorInfo} ${d&&GIe.listView}`,"data-cy":"workspace-project-status",translate:"no",children:[p," "]}),!r.pendingWorkspaceUpload&&d&&!this.props.isMobile&&w.jsx("div",{className:t?`${GIe.more} ${GIe.locked}`:`${GIe.more} ${GIe.listView} ${s&&GIe.sharedDropdown}`,"data-cy":"workspace-project-more-menu-toggle",children:!i&&w.jsx(OCe,{project:a,onRename:this.selectName})}),!i&&!d&&!this.props.isMobile&&w.jsx(OCe,{project:a,onRename:this.selectName})]}),!i&&this.props.isMobile&&w.jsx(OCe,{project:a,onRename:this.selectName}),w.jsx(YIe,{video:r,locked:this.props.lockedForUser})]})]}))():(()=>{const{nameSelected:o}=this.state,s=RU(Bl.UNLIMITED_STORAGE),n=s?JCe:qCe,c=JIe(r);return w.jsxs("div",{className:`${GIe.projectWrapper} ${e&&GIe.projectSelected}`,onClick:b,"data-cy":"project-grid-view-element","data-testid":`project-grid-view-${a._id}`,onMouseLeave:()=>this.setState({showPaywallTooltip:!1}),children:[!this.props.isMobile&&this.state.showPaywallTooltip&&w.jsx(WIe,{body:n,action:Vl.DELETION_WARNING,buttonText:s?"Reactivate":"Upgrade"}),w.jsxs("div",{ref:l,className:x(),onTouchStart:y,onTouchMove:v,onTouchEnd:v,onClick:_,children:[this.state.showPaywallModal&&w.jsx(gW,{action:Vl.STORAGE_LIMIT,onClose:this.closePaywallModal,extraAmplitudeEventProperties:QCe(c)}),w.jsx(Ft,{ref:this.linkComponentRef,onClick:T,to:this.routerLinkTo,"data-testid":"project-link",children:this.renderThumbnail()}),w.jsxs("div",{className:t?`${GIe.contentInfo} ${GIe.locked}`:`${GIe.contentInfo}`,children:[!r.pendingWorkspaceUpload&&!d&&w.jsx("div",{className:t?`${GIe.more} ${GIe.locked}`:`${GIe.more}`,"data-cy":"workspace-project-more-menu-toggle",children:!i&&w.jsx(OCe,{project:a,onRename:this.selectName})}),o?w.jsx("div",{className:GIe.projectName,"data-cy":"workspace-project-name",translate:"no",children:this.renderName()}):w.jsxs("div",{className:GIe.projectNameTooltipContainer,translate:"no",children:[w.jsx("span",{className:`${GIe.projectNameTooltip}`,children:this.getName()}),w.jsx("div",{className:GIe.projectName,"data-cy":"workspace-project-name",children:this.renderName()})]}),w.jsxs("div",{className:GIe.authorInfo,"data-cy":"workspace-project-status",children:[w.jsx("span",{translate:"no",children:g}),`${g?", ":""}${f}`]})]}),w.jsx(YIe,{video:r,locked:this.props.lockedForUser})]})]})})()}}const eke=g.connect((e=>({currentFolderId:e.workspaces.selectedWorkspace,currentUser:e.currentUser,currentTeam:Hu(e),currentFolderSettings:e.workspaces.currentFolderSettings,selectedTeamId:e.teams.selectedTeamId,isGridView:PIe(e),isListView:DIe(e),shared:"shared-with-me"===e.workspaces.selectedWorkspace,SWMFolderSettings:e.workspaces.SWMFolderSettings,subscription:e.subscription.subscription})),(e=>ye({setProjectName:SK,showToast:wl,showToastForUnexpectedError:mh},e))),tke=eke(ZCe),oke="WorkspaceSubfolder-module_mainContainer_XyI-e",ake="WorkspaceSubfolder-module_subfolderContainer_JIfyk",ike="WorkspaceSubfolder-module_folderNameContainer_9yIMz",ske="WorkspaceSubfolder-module_folderIcon_syPbz",nke="WorkspaceSubfolder-module_folderName_g3Inf",rke="WorkspaceSubfolder-module_SWMwrapper_4xktE",lke="WorkspaceSubfolder-module_gridView_6dAb4",dke="WorkspaceSubfolder-module_SWMfolderWrapper_uLZpJ",cke="WorkspaceSubfolder-module_SWMcontentContainer_vHHzJ",uke="WorkspaceSubfolder-module_SWMthumbnail_7huec",mke="WorkspaceSubfolder-module_SWMfolderIcon_Hs0HO",pke="WorkspaceSubfolder-module_SWMfolderDetails_QgmeZ",hke="WorkspaceSubfolder-module_SWMsharedByInfo_e3ML7",gke="WorkspaceSubfolder-module_SWMdateSharedInfo_Fc6bS",fke="WorkspaceSubfolder-module_SWMname_kKVB6",yke="WorkspaceSubfolder-module_SWMnameWrapper_Z0cte",vke=_.memo((({folder:e,projectContainerRef:t,sharedWithMe:o,isMobile:a})=>{var i;const s=tl((e=>PIe(e)));if(!o)return w.jsx("div",{className:oke,children:w.jsx("div",{ref:t,className:ake,onClick:()=>{k9(e._id)},children:w.jsxs("div",{className:ike,children:[w.jsx(ei,{className:ske}),w.jsx("div",{className:nke,translate:"no",children:e.name})]})})});const{name:n}=e,r=`${null==(i=null==e?void 0:e.originalUser)?void 0:i.name}`,l=`${(null==e?void 0:e.sharedAt)?e.sharedAt:""}`;return w.jsx("div",{className:`${rke} ${s&&lke}`,onClick:()=>k9(e._id),"data-cy":"SWM-folder-name","data-testid":`folder-${s?"grid-view":"list-view"}-${e._id}`,children:w.jsx("div",{className:`${dke} ${s&&lke}`,"data-cy":"folder-in-workspace",children:w.jsxs("div",{className:`${cke} ${s&&lke}`,children:[w.jsx("div",{children:w.jsx("div",{className:`${uke} ${s&&lke}`,children:w.jsx("div",{className:mke,children:w.jsx(ei,{})})})}),w.jsxs("div",{className:`${pke} ${s&&lke}`,children:[w.jsx("div",{className:`${fke} ${s&&lke}`,children:w.jsx("div",{className:yke,translate:"no",children:n})}),s?w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:`${hke}`,children:["Shared by",w.jsxs("span",{translate:"no",children:[" ",r]})," "]}),w.jsxs("div",{className:`${gke}`,children:[l?`Shared ${mr(new Date(l))}`:""," "]})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:`${gke}`,children:l?`${a?`Shared ${mr(new Date(l))}`:mr(new Date(l)).charAt(0).toLocaleUpperCase()+mr(new Date(l)).slice(1)}`:""}),w.jsxs("div",{className:`${hke}`,translate:"no",children:[r," "]})]})]})]})})})})),_ke="FolderView-module_emptySharedWithMe_Elk1Q",wke="FolderView-module_emptySharedImage_p9xQP",bke="FolderView-module_emptySharedText_exRMu",Tke="FolderView-module_noProjectsContainer_8Dix3",xke="FolderView-module_listView_7CKlB",Ske="FolderView-module_projectsPlaceholderText_4joME",Eke="FolderView-module_foldersContainer_fXwci",Ike="FolderView-module_projectsContainerGrid_OTehA",Cke="FolderView-module_projectsContainerList_4-Z5b",kke="FolderView-module_emptyProjectWrapper_YtRlU",Ake="FolderView-module_emptyProject_LNc5V",jke=(e,t,o)=>{var a,i,s,n;const r=Date.parse(null==(i=null==(a=null==e?void 0:e.content)?void 0:a.lastSaved)?void 0:i.toString()),l=Date.parse(null==(n=null==(s=null==t?void 0:t.content)?void 0:s.lastSaved)?void 0:n.toString());return r?l?r<l?o===eb.ASCENDING?1:-1:r>l?o===eb.ASCENDING?-1:1:0:1:-1},Nke=e=>(t,o)=>Rke(t,o,e),Rke=(e,t,o)=>{const a=!!e.sharedAt&&new Date(e.sharedAt),i=!!t.sharedAt&&new Date(t.sharedAt);return a?i?a<i?o===eb.ASCENDING?1:-1:a>i?o===eb.ASCENDING?-1:1:0:1:-1},Pke=(e,t,o)=>{let a=null==e?void 0:e.name,i=null==t?void 0:t.name;return a||(a=An),i||(i=An),0===a.localeCompare(i)?jke(e,t,o):o===eb.ASCENDING?a.localeCompare(i):i.localeCompare(a)},Dke=(e,t,o)=>{var a,i;let s=null==(a=null==e?void 0:e.content)?void 0:a.lastEditorName,n=null==(i=null==t?void 0:t.content)?void 0:i.lastEditorName;return s||(s=""),n||(n=""),0===s.localeCompare(n)?jke(e,t,o):s.localeCompare(n)&&o===eb.ASCENDING?s.localeCompare(n):n.localeCompare(s)},Oke=(e,t,o)=>{var a,i,s,n,r,l;let d=(null==e?void 0:e.content)?null==(i=null==(a=null==e?void 0:e.content)?void 0:a.originalUser)?void 0:i.name:null==(s=null==e?void 0:e.originalUser)?void 0:s.name,c=(null==t?void 0:t.content)?null==(r=null==(n=null==t?void 0:t.content)?void 0:n.originalUser)?void 0:r.name:null==(l=null==t?void 0:t.originalUser)?void 0:l.name;return d||(d=""),c||(c=""),0===d.localeCompare(c)?jke(e,t,o):d.localeCompare(c)&&o===eb.ASCENDING?d.localeCompare(c):c.localeCompare(d)},Lke=e=>(t,o)=>Fke(t,o,e),Fke=(e,t,o)=>{var a,i;const s=Date.parse(((null==(a=null==e?void 0:e.content)?void 0:a.createdAt)??"").toString()),n=Date.parse(((null==(i=null==t?void 0:t.content)?void 0:i.createdAt)??"").toString());return s?n?s<n?o===eb.ASCENDING?1:-1:s>n?o===eb.ASCENDING?-1:1:0:1:-1},Mke="FolderViewController-module_disabled_-JhoL",Uke="FolderViewController-module_dropdownContainer_vtrM-",Bke="FolderViewController-module_item_C-GFY",Vke="FolderViewController-module_selected_pbgNo",Wke="FolderViewController-module_ddItemLabel_Ft4IO",Gke="FolderViewController-module_dropdownSelector_FPlPg",Hke="FolderViewController-module_folderViewControllerContainer_AfODR",$ke="FolderViewController-module_listView_Vfqhs",Kke="FolderViewController-module_sortField_Dh6Md",zke="FolderViewController-module_sortOrder_8Z-qD",Yke="FolderViewController-module_projectNameLabel_BAG7M",Jke="FolderViewController-module_projectLastEditorLabel_PyAdp",qke="FolderViewController-module_projectDateEditedLabel_ahtU-",Xke="FolderViewController-module_icon_ZMZqC",Qke="FolderViewController-module_viewControllerRight_6PfBZ",Zke="FolderViewController-module_hidden_-lSiQ",eAe="FolderViewController-module_sortOptionsContainer_vHPXV",tAe="FolderViewController-module_sharedWithMe_vU191",oAe="FolderViewController-module_viewOptionsContainer_qk4t1",aAe="FolderViewController-module_gridIcon_yroO5",iAe="FolderViewController-module_createButtonsContainer_YDkMJ",sAe="FolderViewController-module_settings_MYYh8",nAe="FolderViewController-module_settingsRight_x6xFK",rAe="FolderViewController-module_settingsContainer_R7VMo",lAe="FolderViewController-module_settingsIcon_fXq5w",dAe=_.memo((()=>{const{setUpsellShown:e}=xIe();return h.useEffect((function(){Fm(ym.SHOWN_CREATE_NEW_PROJECT_TOOLTIP)}),[]),h.useEffect((function(){e(TIe.CreateYourFirstVideo)}),[e]),w.jsx("div",{className:yhe.popoverContent,"data-testid":"split-popover",children:w.jsx("p",{children:"Hop into the editor to create a video in just a few clicks."})})})),cAe={header:"Create your first video!",content:w.jsx(dAe,{}),rainbowBorderOptions:{borderRadius:8,borderWidth:3}},uAe="ProjectLimitOverlay-module_upgradeButton_jLGeK",mAe="ProjectLimitOverlay-module_overlayContainer_4R5tz",pAe="ProjectLimitOverlay-module_header_DbtDZ",hAe="ProjectLimitOverlay-module_contentContainer_7t8hU",gAe="ProjectLimitOverlay-module_buttonsContainer_7G-4V",fAe="ProjectLimitOverlay-module_primaryButton_yJk9X",yAe="ProjectLimitOverlay-module_bold_D420r",vAe="ProjectLimitOverlay-module_text_rndS1",_Ae=_.memo((({exitOverlay:e,goToStudio:t,currentFolderId:o})=>{const a=bW(),{nextLockedProjectName:i}=tl((e=>{var t;const a=e.projects.projectIdsByFolderId[o]||[];let i;if(a.length>=3){const o=a[a.length-3];o&&(i=null==(t=e.projects.byId[o])?void 0:t.name)}return{nextLockedProjectName:i}}),g.shallowEqual),s=ou(),n=h.useCallback((()=>{a((()=>{}),{action:Vl.STORAGE_LIMIT})()}),[a]);return w.jsx(nM,{unsetCancelModal:e,overlayContainerSmall:!0,usePortal:!0,children:w.jsxs("div",{className:mAe,children:[w.jsxs("div",{className:pAe,children:["You have used ",3," of"," ",3," free projects"]}),w.jsxs("div",{className:hAe,children:[w.jsxs("div",{className:vAe,children:["As a ",w.jsx("span",{children:s.is(Cl.Basic)?"Basic":"Free"})," ","plan user, you only have access to the 3 most recently created projects in a folder.",w.jsx("br",{}),w.jsx("br",{}),"Creating a new project will lock your most recent project"," ",w.jsx("span",{className:yAe,children:i}),", making it no longer editable. Get access to all projects, create as many projects as you want, and gain premium features when you upgrade to Kapwing Pro."]}),w.jsxs("div",{className:gAe,children:[w.jsxs("div",{className:uAe,onClick:()=>n(),children:["Upgrade ",w.jsx(EW,{})]}),w.jsx("div",{className:fAe,onClick:()=>t(),children:"Create a New Project"})]})]})]})})})),wAe="CreateNewProjectButton-module_createButtonContainer_tBvzl",bAe="CreateNewProjectButton-module_disabled_qfN2R",TAe="CreateNewProjectButton-module_createText_RJL3k",xAe="CreateNewProjectButton-module_createButton_ZmpTV",SAe="CreateNewProjectButton-module_plusIcon_-u-rR",EAe="CreateNewProjectButton-module_dropdownContainer_QYFMQ",IAe="CreateNewProjectButton-module_caretIcon_JGPlk",CAe="CreateNewProjectButton-module_leftSection_rPoPa",kAe="CreateNewProjectButton-module_loader_4WwMB",AAe=()=>{const e=tl((e=>{const t=e.workspaces.selectedWorkspace,o=e.projects.byId,a=e.projects.projectIdsByFolderId[t],i=null==a?void 0:a.map((e=>o[e]));return(null==i?void 0:i.filter((e=>null==e?void 0:e.content)).length)??0}));return!RU(Bl.UNLIMITED_STORAGE)&&e>=3?{atLimit:!0,projectsNum:e}:{atLimit:!1,projectsNum:e}},jAe=_.memo((()=>{var e,t;const{currentFolderId:o,selectionMode:a,onboarding:i,currentUser:s,hasBrandkitTemplates:n}=tl((e=>{var t;return{currentFolderId:e.workspaces.selectedWorkspace,hasBrandkitTemplates:!!(null==(t=e.teams.brandkitTemplates)?void 0:t.length),selectionMode:e.workspaces.selectionMode,onboarding:e.currentUser.user.onboarding,currentUser:e.currentUser}}),ol),{atLimit:r,projectsNum:l}=AAe(),[d,c]=h.useState(!1),u=Ve(),m=il(),p=ku(),g=s.impersonatingAdminEmail,[f,y]=h.useState(!1),[v,_]=h.useState(!1),b=0===l,{getUpsellDateAcknowledged:T,setUpsellAcknowledged:x}=xIe(),S=new Date("Thu Aug 31 2023 14:19:01 GMT-0700 (Pacific Daylight Time)")>((null==i?void 0:i.survey)&&(null==(e=null==i?void 0:i.survey)?void 0:e.date)?new Date(null==(t=null==i?void 0:i.survey)?void 0:t.date):new Date),E=!T(TIe.CreateYourFirstVideo)&&b&&!S&&!p&&!g,[I,C]=h.useState(E),k=h.useCallback((()=>{const e=lD(o);e&&m(sL({_id:e._id,name:e.name,teamId:e.teamId})),(async()=>{let e;try{e=(await Yr(`/api/v1/workspaces/${o}/getUsers`)).keys.length>1}catch(IGe){e=void 0}m({type:"RESET_STUDIO"}),mSe({entry:uSe.WORKSPACE}),u.push("/studio/editor"),az({source:ad.Onboarding}),MM({workspaceId:o,source:"Create New",workspaceHasCollaborators:e})})()}),[o,m,u]),A=h.useCallback((async()=>{await x(TIe.CreateYourFirstVideo),C(!1)}),[x]),j=h.useCallback((async()=>{r?c(!0):(y(!0),I&&await x(TIe.CreateYourFirstVideo),k())}),[r,I,k,x]),N=h.useCallback((()=>{c(!1)}),[]),R=h.useCallback((()=>{n?_h({modalType:gh.START_FROM_BRAND_TEMPLATE}):u.push("/brandkit")}),[n,u]),P=h.useCallback((()=>{_h({modalType:gh.FOLDER_UPLOAD})}),[]),D=h.useMemo((()=>[{label:"Use a Brand Template",icon:w.jsx(ti,{}),onClick:R,type:tCe.Generic},{label:"Upload",icon:w.jsx(vt,{}),onClick:P,type:tCe.Generic}]),[R,P]);return w.jsxs(w.Fragment,{children:[d&&w.jsx(_Ae,{exitOverlay:N,currentFolderId:o,goToStudio:k}),w.jsx(fhe,{...cAe,side:"bottom",withRainbowBorder:I,open:I,sideOffset:8,onClose:A,children:w.jsx(iCe,{items:D,maxWidth:800,align:"center",disabled:v,children:w.jsxs("div",{className:`${wAe} ${(a||f)&&bAe}`,children:[w.jsx("div",{className:xAe,onClick:j,"data-cy":"workspace-new-project-button",onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),children:w.jsx("div",{className:CAe,children:f?w.jsx("div",{className:kAe}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:SAe,children:w.jsx(oi,{})}),w.jsx("div",{className:TAe,children:"Create new"})]})})}),w.jsx("div",{className:EAe,children:w.jsx(ht,{className:IAe})})]})})})]})})),NAe="RepurposeCreateButton-module_repurposeButton_ytpzu",RAe="RepurposeCreateButton-module_repurposeIcon_8ac4j",PAe="RepurposeCreateButton-module_glimmer_HBAOP",DAe="RepurposeCreateButton-module_glimmerWrapper_42uNj",OAe={top:"unset",left:"unset",bottom:"32px",right:"32px",transform:"translate(0%, 0%)",zIndex:17},LAe=()=>{const{setUpsellAcknowledged:e,setUpsellShown:t}=xIe();h.useEffect((function(){t(TIe.IntroducingRepurposeStudio)}),[t]);const o=h.useCallback((async()=>{await e(TIe.IntroducingRepurposeStudio),await np()}),[e]);return w.jsx(nM,{noCloseButton:!0,noScrollBar:!0,noPadding:!0,style:OAe,unsetCancelModal:o,children:w.jsxs("div",{className:nSe.modalWithImageContainer,children:[w.jsxs("div",{className:nSe.left,children:[w.jsx("div",{className:nSe.header,children:"Introducing Repurpose Studio ✨"}),w.jsx("p",{children:"Turn a long video into many short clips 10x faster. In just a few clicks, we’ll find the most interesting parts of your video and transform them into social-ready clips which you can download right away or adjust in the editor."}),w.jsx(Iie,{className:nSe.modalPrimaryButton,onClick:o,buttonText:"Got it",testId:"repurpose-promo-modal-button"})]}),w.jsx("video",{playsInline:!0,autoPlay:!0,muted:!0,loop:!0,className:nSe.right,children:w.jsx("source",{src:"https://cdn-useast1.kapwing.com/static/BlG-repurpose_animation_promo_V1.mp4"})}),w.jsx("div",{className:`${nSe.exit} ${nSe.dark}`,onClick:o,"data-testid":"dismiss-button",children:w.jsx(ve,{})})]})})},FAe=_.memo((()=>{const e=Ve(),{getUpsellDateAcknowledged:t,setUpsellAcknowledged:o}=xIe(),a=ku(),{showOnboardingSurvey:i,showFirstSessionOnboarding:s,showSecondSessionOnboarding:n,showPostOnboardingUpsell:r}=AIe(),l=!(i||s||n||r||t(TIe.IntroducingRepurposeStudio)||a||window.Cypress),d=h.useCallback((()=>{Fm(ym.REPURPOSE_BUTTON_CLICKED),l&&o(TIe.IntroducingRepurposeStudio),e.push("/repurpose/create")}),[e,o,l]),c=()=>w.jsx(Die,{noPadding:!0,lightWeight:!0,overrideColor:"mediumBlue",onClick:d,children:w.jsxs("div",{className:NAe,children:[w.jsx(ai,{className:RAe}),w.jsx("div",{children:"Repurpose video"})]})});return l?w.jsxs("div",{className:DAe,children:[w.jsx(LAe,{}),w.jsx(MAe,{children:c()})]}):c()})),MAe=_.memo((({children:e})=>w.jsx("div",{className:PAe,children:e}))),UAe=_.memo((({folderProjectsIsEmpty:e,foldersArray:t})=>{const{currentFolderSettings:o,isAscendingSortOrder:a,isDescendingSortOrder:i,isGridView:s,isListView:n,SWMFolderSettings:r,sharedWithMe:l}=tl((e=>({sharedWithMe:e.workspaces.selectedWorkspace===Vn,currentFolderSettings:e.workspaces.currentFolderSettings,isAscendingSortOrder:OIe(e),isDescendingSortOrder:LIe(e),isGridView:PIe(e),isListView:DIe(e),SWMFolderSettings:e.workspaces.SWMFolderSettings})),ol),[d,c]=h.useState(!1),u=h.useRef(null),m=il(),p=ku(),g=Ve(),f=0===(null==t?void 0:t.length),y=(null==o?void 0:o.sortField)===Zw.PROJECT_NAME&&!l||(null==r?void 0:r.sortField)===Zw.PROJECT_NAME&&l,v=(null==o?void 0:o.sortField)===Zw.DATE_EDITED&&!l||(null==r?void 0:r.sortField)===Zw.DATE_EDITED&&l||!r&&l||!o&&!l,_=(null==o?void 0:o.sortField)===Zw.LAST_EDITOR&&!l||(null==r?void 0:r.sortField)===Zw.LAST_EDITOR&&l,b=(null==o?void 0:o.sortField)===Zw.DATE_CREATED&&!l||(null==r?void 0:r.sortField)===Zw.DATE_CREATED&&l,T=e=>{m(l?pb({view:e,sortField:(null==r?void 0:r.sortField)??Zw.DATE_EDITED,sortOrder:(null==r?void 0:r.sortOrder)??eb.ASCENDING}):mb({view:e,sortField:(null==o?void 0:o.sortField)??Zw.DATE_CREATED,sortOrder:(null==o?void 0:o.sortOrder)??eb.ASCENDING}))},x=e=>{m(l?pb({view:(null==r?void 0:r.view)??Qw.LIST_VIEW,sortField:(null==r?void 0:r.sortField)??Zw.DATE_EDITED,sortOrder:e}):mb({view:(null==o?void 0:o.view)??Qw.GRID_VIEW,sortField:(null==o?void 0:o.sortField)??Zw.DATE_CREATED,sortOrder:e}))},S=()=>{x(a?eb.DESCENDING:eb.ASCENDING)},E=()=>{l?((null==r?void 0:r.sortField)!==Zw.DATE_EDITED&&r?m(pb({view:(null==r?void 0:r.view)??Qw.LIST_VIEW,sortField:Zw.DATE_EDITED,sortOrder:eb.ASCENDING})):x((null==r?void 0:r.sortOrder)===eb.ASCENDING?eb.DESCENDING:eb.ASCENDING),((null==r?void 0:r.view)===Qw.GRID_VIEW||p)&&j()):((null==o?void 0:o.sortField)!==Zw.DATE_EDITED&&o?m(mb({view:(null==o?void 0:o.view)??Qw.GRID_VIEW,sortField:Zw.DATE_EDITED,sortOrder:eb.ASCENDING})):x((null==o?void 0:o.sortOrder)===eb.ASCENDING?eb.DESCENDING:eb.ASCENDING),(null==o?void 0:o.view)!==Qw.GRID_VIEW&&o&&!p||j())},I=()=>{l?((null==r?void 0:r.sortField)===Zw.PROJECT_NAME?x((null==r?void 0:r.sortOrder)===eb.ASCENDING?eb.DESCENDING:eb.ASCENDING):m(pb({view:(null==r?void 0:r.view)??Qw.LIST_VIEW,sortField:Zw.PROJECT_NAME,sortOrder:eb.ASCENDING})),((null==r?void 0:r.view)===Qw.GRID_VIEW||p)&&j()):((null==o?void 0:o.sortField)===Zw.PROJECT_NAME?x((null==o?void 0:o.sortOrder)===eb.ASCENDING?eb.DESCENDING:eb.ASCENDING):m(mb({view:(null==o?void 0:o.view)??Qw.GRID_VIEW,sortField:Zw.PROJECT_NAME,sortOrder:eb.ASCENDING})),(null==o?void 0:o.view)!==Qw.GRID_VIEW&&o&&!p||j())},C=()=>{l?((null==r?void 0:r.sortField)===Zw.LAST_EDITOR?x((null==r?void 0:r.sortOrder)!==eb.ASCENDING&&r?eb.ASCENDING:eb.DESCENDING):m(pb({view:(null==r?void 0:r.view)??Qw.LIST_VIEW,sortField:Zw.LAST_EDITOR,sortOrder:eb.ASCENDING})),((null==r?void 0:r.view)===Qw.GRID_VIEW||p)&&j()):((null==o?void 0:o.sortField)===Zw.LAST_EDITOR?x((null==o?void 0:o.sortOrder)!==eb.ASCENDING&&o?eb.ASCENDING:eb.DESCENDING):m(mb({view:(null==o?void 0:o.view)??Qw.GRID_VIEW,sortField:Zw.LAST_EDITOR,sortOrder:eb.ASCENDING})),(null==o?void 0:o.view)!==Qw.GRID_VIEW&&o&&!p||j())},k=()=>{l?((null==r?void 0:r.sortField)===Zw.DATE_CREATED?x((null==r?void 0:r.sortOrder)===eb.ASCENDING?eb.DESCENDING:eb.ASCENDING):m(pb({view:(null==r?void 0:r.view)??Qw.LIST_VIEW,sortField:Zw.DATE_CREATED,sortOrder:eb.ASCENDING})),((null==r?void 0:r.view)===Qw.GRID_VIEW||p)&&j()):((null==o?void 0:o.sortField)===Zw.DATE_CREATED?x((null==o?void 0:o.sortOrder)===eb.ASCENDING?eb.DESCENDING:eb.ASCENDING):m(mb({view:(null==o?void 0:o.view)??Qw.GRID_VIEW,sortField:Zw.DATE_CREATED,sortOrder:eb.ASCENDING})),(null==o?void 0:o.view)!==Qw.GRID_VIEW&&o&&!p||j())},A=()=>{var e;c(!0),null==(e=null==u?void 0:u.current)||e.focus()},j=()=>{c(!1)},N=()=>w.jsxs("div",{className:`${Uke} ${!d&&Zke}`,ref:u,"data-testid":"grid-view-sort-field-dropdown",children:[w.jsx("div",{className:`${Bke} ${v&&Vke}`,onClick:E,"data-testid":"grid-view-sort-field-dd-item-date-edited",children:w.jsx("span",{className:Wke,children:l?"Share date":"Date edited"})}),w.jsx("div",{className:`${Bke} ${y&&Vke}`,onClick:I,"data-testid":"grid-view-sort-field-dd-item-item-name",children:w.jsx("span",{className:Wke,children:"Item name"})}),w.jsx("div",{className:`${Bke} ${_&&Vke}`,onClick:C,"data-testid":"grid-view-sort-field-dd-item-last-editor",children:w.jsx("span",{className:Wke,children:l?"Shared by":"Last editor"})}),w.jsx("div",{className:`${Bke} ${b&&Vke}`,onClick:k,"data-testid":"grid-view-sort-field-dd-item-date-created",children:w.jsx("span",{className:Wke,children:"Date created"})})]}),R=()=>w.jsx(sU,{message:"Toggle sort order",children:w.jsxs("div",{className:`${zke}`,onClick:S,"data-testid":"grid-view-sort-order",children:[a&&w.jsx(Pa,{"data-testid":"sort-order-ascending"}),i&&w.jsx(Ra,{"data-testid":"sort-order-descending"})]})}),P=h.useCallback((()=>{g.push("/settings/folder")}),[g]);return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:`${Hke} ${l&&Qke}`,"data-testid":"view-controller-container",children:[!l&&w.jsxs("div",{className:iAe,"data-testid":"create-new-project-button",children:[w.jsx(jAe,{}),!p&&w.jsx(FAe,{})]}),w.jsxs("div",{className:sAe,children:[w.jsx("div",{className:mt(eAe,{[Mke]:e&&f}),children:!n&&w.jsxs(w.Fragment,{children:[w.jsxs("div",{tabIndex:0,onBlur:j,className:Gke,children:[w.jsx(sU,{message:"Sort projects by",children:w.jsxs("div",{className:Kke,onClick:A,"data-testid":"grid-view-sort-field",children:[w.jsx("span",{children:y&&"Item name"}),w.jsx("span",{children:v&&(l?"Share date":"Date edited")}),w.jsx("span",{children:_&&(l?"Shared by":"Last editor")}),w.jsx("span",{children:b&&"Date created"})]})}),N()]}),R()]})}),w.jsxs("div",{className:nAe,children:[w.jsxs("div",{className:mt(oAe,{[Mke]:e&&f}),children:[w.jsx(sU,{message:"View projects in a list",children:w.jsx("div",{className:`${Xke} ${n&&Vke}`,onClick:()=>T(Qw.LIST_VIEW),"data-testid":"view-options-list-icon",children:w.jsx(si,{})})}),w.jsx(sU,{message:"View projects in a grid",children:w.jsx("div",{className:`${Xke} ${s&&Vke}`,onClick:()=>T(Qw.GRID_VIEW),"data-testid":"view-options-grid-icon",children:w.jsx(ni,{className:aAe})})})]}),w.jsx("div",{"data-cy":"workspace-settings-button",onClick:P,className:rAe,children:w.jsx(ii,{className:lAe})})]})]})]}),n&&!p&&w.jsxs("div",{className:mt(eAe,$ke,{[tAe]:l,[Mke]:e&&f}),children:[w.jsxs("div",{className:`${Yke} ${y&&Vke}`,onClick:I,"data-testid":"list-view-sort-field-item-name",children:["Item name",y&&R()]}),w.jsxs("div",{className:`${qke} ${v&&Vke}`,onClick:E,"data-testid":"list-view-sort-field-date-edited",children:[w.jsx("span",{children:l?"Share date":"Date edited"}),v&&R()]}),w.jsxs("div",{className:`${Jke} ${_&&Vke}`,onClick:C,"data-testid":"list-view-sort-field-last-editor",children:[w.jsx("span",{children:l?"Shared by":"Last editor"}),_&&R()]})]})]})})),BAe="FolderToolbar-module_topRow_rWhX-",VAe="FolderToolbar-module_iconActions_yxz9s",WAe="Facepile-module_members_XyzkN",GAe="Facepile-module_facePile_cnXK2",HAe="Facepile-module_membersInfo_j-izx",$Ae="Facepile-module_face_eIkAa",KAe="Facepile-module_membersIcon_jVAl7",zAe=(e,t)=>e.picture&&t.picture?new Date(String(t.createdAt))<new Date(String(e.createdAt))?1:new Date(String(e.createdAt))<new Date(String(t.createdAt))?-1:(e.firstName??"").localeCompare(t.firstName??""):!e.picture&&t.picture?-1:e.picture&&!t.picture||new Date(String(t.createdAt))<new Date(String(e.createdAt))?1:new Date(String(e.createdAt))<new Date(String(t.createdAt))?-1:(e.firstName??"").localeCompare(t.firstName??""),YAe=_.memo((({users:e,url:t})=>{const o=((e,t=5)=>{if(e&&e.length>t){const o=e.filter((e=>e.picture));return o.length>t?o.sort(zAe).slice(0,5):e.sort(zAe).slice(0,5)}return e?e.sort(zAe):[]})(e);let a=0;return e&&e.length&&(a=e.length),a<2?w.jsx(sU,{message:"See and manage workspace members",children:w.jsx(Ft,{to:t,"data-cy":"facepile-container",className:KAe,children:w.jsx(ri,{})})}):w.jsx("div",{className:WAe,children:w.jsx(Ft,{to:t,children:w.jsxs("div",{className:HAe,children:[w.jsx("div",{className:GAe,"data-testid":"facepile-container","data-cy":"facepile-container",children:null==o?void 0:o.map((e=>w.jsx(b9,{user:e,className:$Ae},e._id)))}),w.jsx("div",{"data-testid":"facepile-additional",children:a>5?"+"+(a-5):""})]})})})})),JAe="WorkspaceNotifications-module_icon_IXMVf",qAe="WorkspaceNotifications-module_iconWrapper_3vNHZ",XAe="WorkspaceNotifications-module_alertCircle_6kM8K",QAe="WorkspaceNotifications-module_notifContainer_bnFNU",ZAe="WorkspaceNotifications-module_mobileNotifContainer_TKKI0",eje="WorkspaceNotifications-module_notifHeader_rUAuJ",tje="WorkspaceNotifications-module_settingsGear_j9nXA",oje="WorkspaceNotifications-module_notifListContainer_WJ5Au",aje="WorkspaceNotifications-module_notification_fQI3Z",ije="WorkspaceNotifications-module_iconAndMessageConatiner_RY-6x",sje="WorkspaceNotifications-module_notifIconContainer_SUWHu",nje="WorkspaceNotifications-module_unreadNotifCircle_OqM3R",rje="WorkspaceNotifications-module_notifIcon_q0SUX",lje="WorkspaceNotifications-module_exportSuccessIcon_cf4XZ",dje="WorkspaceNotifications-module_exportFailureIcon_nNUC1",cje="WorkspaceNotifications-module_notifMessageContainer_P2wmh",uje="WorkspaceNotifications-module_exportMessage_R2W70",mje="WorkspaceNotifications-module_notifName_L0lrL",pje="WorkspaceNotifications-module_notifLink_RGLcK",hje="WorkspaceNotifications-module_notifTimeStamp_lmFtg",gje="WorkspaceNotifications-module_emptyNotifContainer_J-gL4",fje="WorkspaceNotifications-module_emptyIconContainer_tXhcm",yje="WorkspaceNotifications-module_emptyNotifIcon_zDL4t",vje="WorkspaceNotifications-module_emptyNotifMessage_lqrnK",_je=_.memo((({openAccountSettings:e})=>{const t=Ve(),o=il(),a=ku(),{redirectSource:i}=_oe(),s=tl((e=>e.notifications.notifications)),[n,r]=h.useState(!1),l=h.useRef([]),d=h.useRef(null),c=h.useRef(null),[u,m]=h.useState(!1);h.useEffect((function(){(async()=>{if(i===voe.NEW_USER_INVITE_ACCEPTED||i===voe.EMAIL_INVITE){m(!0);const t=null==s?void 0:s.filter((e=>e.info.type!==xl.Welcome)).map((e=>e._id));if(null==t?void 0:t.length)try{await $r("api/v1/notifsRead",{body:{notifIds:JSON.stringify(t)}})&&t.forEach((e=>l.current.push(e.toString())))}catch(e){console.error(e)}p(),m(!1)}})()}),[]),h.useEffect((function(){const e=e=>{var t,o;(null==(t=d.current)?void 0:t.contains(e.target))||(null==(o=c.current)?void 0:o.contains(e.target))||r(!1)};return n?(document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}):()=>{}}),[n]);const p=h.useCallback((()=>{l.current.length&&(o(nO(l.current)),l.current=[])}),[o]);h.useEffect((()=>{(async()=>{var e;if(n){const o=null==(e=null==s?void 0:s.filter((e=>e.state!==Sl.read)))?void 0:e.map((e=>e._id));if(null==o?void 0:o.length)try{await $r("api/v1/notifsRead",{body:{notifIds:JSON.stringify(o)}})&&o.forEach((e=>l.current.push(e.toString())))}catch(t){console.error(t)}}else p()})()}),[o,s,n,p]);const g=(null==s?void 0:s.filter((e=>e.state!==Sl.read)).length)||0,f=e=>{let t,o;const a=e.createdAt?`${lr(new Date(e.createdAt),"moments")} ago`:null;if(e.info.type===xl.Export)e.info.success?(o=w.jsxs("span",{className:uje,children:["Your export"," ",w.jsx("span",{className:pje,children:e.info.projectName})," ","is finished"]}),t=w.jsx("div",{className:lje,children:w.jsx("span",{children:"🎉"})})):(o=w.jsxs("span",{className:uje,children:["Your project"," ",w.jsx("span",{className:pje,children:e.info.projectName})," ","failed to export"]}),t=w.jsx("div",{className:dje,children:w.jsx("span",{children:"🙁"})}));else if(e.info.type===xl.Comment){const{commenterName:a,projectName:i,commenterIcon:s,commentReply:n}=e.info;o=w.jsxs(w.Fragment,{children:[w.jsx("span",{className:mje,children:a})," ",w.jsx("br",{}),w.jsx("span",{children:n?"replied to your comment on ":"commented on "}),w.jsx("span",{className:pje,children:i})]}),t=w.jsx(b9,{user:{name:a,picture:s,pending:!1},className:rje})}else if(e.info.type===xl.Invite){const{inviterName:a,inviterIcon:i,inviteType:s,sharedName:n}=e.info;o=w.jsxs(w.Fragment,{children:[w.jsx("span",{className:mje,children:a}),w.jsx("br",{}),"invited you to ",s," ",w.jsx("span",{className:pje,children:n})]}),t=w.jsx(b9,{user:{name:a,picture:i,pending:!1},className:rje})}else if(e.info.type===xl.Request){const{requestType:a,requesterName:i,requesterIcon:s,sharedName:n}=e.info;o=w.jsxs(w.Fragment,{children:[w.jsx("span",{className:mje,children:i}),w.jsx("br",{}),"requested to join your ",a," ",w.jsx("span",{className:pje,children:n})]}),t=w.jsx(b9,{user:{name:i||"",picture:s,pending:!1},className:rje})}else if(e.info.type===xl.Joined){const{info:{email:a,joinedFullName:i,teamName:s,picture:n}}=e;o=w.jsxs(w.Fragment,{children:[" ",w.jsxs("span",{className:mje,children:[i," (",a,")"]}),w.jsx("br",{})," joined ",w.jsx("span",{className:pje,children:s})," "]}),t=w.jsx(b9,{user:{name:i||"",picture:n,pending:!1},className:rje})}else if(e.info.type===xl.Welcome){const{info:{teamName:t}}=e;o=w.jsxs(w.Fragment,{children:[" ",w.jsx("span",{className:mje,children:"Welcome to your new team:"}),w.jsx("span",{className:pje,children:t})," "]})}return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:ije,children:[w.jsxs("div",{className:sje,children:[e.state!==Sl.read&&w.jsx("div",{className:nje}),t]}),w.jsx("div",{className:cje,children:o})]}),w.jsx("div",{className:hje,children:w.jsx("span",{children:a})})]})};return w.jsxs(w.Fragment,{children:[w.jsx(sU,{message:"Notifications related to your exports and workspace invites will appear here.",children:w.jsxs("div",{className:qAe,ref:c,onClick:()=>{n||Fm(ym.NOTIFICATIONS_OPENED,{unreadNotifs:g,readNotifs:s?s.length-g:0}),r(!n)},"data-testid":"ws-header-notifs-icon",children:[w.jsx(li,{className:JAe}),!!g&&!u&&w.jsx("div",{className:XAe,children:g})]})}),n&&w.jsxs("div",{className:`${QAe} ${a?ZAe:""}`,ref:d,children:[w.jsxs("div",{className:eje,children:[w.jsx("div",{children:"Notifications"}),w.jsx("div",{children:w.jsx(di,{className:tje,size:20,onClick:e})})]}),(null==s?void 0:s.length)?w.jsx("div",{className:oje,children:null==s?void 0:s.map((e=>w.jsx("div",{className:aje,onClick:()=>{p();const a={notificationType:e.info.type};if(e.info.type===xl.Invite&&(a.inviteType=e.info.inviteType),Fm(ym.NOTIFICATION_CLICKED,a),e.info.type===xl.Invite&&e.info.inviteType===El.project){const t=`${window.location.protocol}//${Jye()}${e.info.link} `;window.location.href=t}else e.info.type===xl.Request?(o(Ip(e.info.teamId)),t.push(`/team/${e.info.teamId}/members`)):e.info.type===xl.Welcome?I9(e.info.teamId):e.info.type===xl.Joined?(o(Ip(e.info.teamId)),t.push(e.info.teamSettingsPath)):t.push(e.info.link)},children:f(e)},e._id.toString())))}):w.jsxs("div",{className:gje,children:[w.jsx("div",{className:fje,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/s5N-empty-notifs.svg",alt:"empty inbox icon",className:yje})}),w.jsx("div",{className:vje,children:"No notifications yet!"})]})]})]})})),wje="FolderName-module_folderName_b2e2r",bje="FolderName-module_folderNameContainer_9fFFi",Tje="FolderName-module_folderNameInputWrapper_wQzhM",xje="FolderName-module_shareCrumb_NEGJ6",Sje=_.memo((()=>{const{folderId:e,folderName:t}=tl((e=>{const t=e.workspaces.selectedWorkspace;return{folderId:t,folderName:MP(t)??"Untitled Folder"}}),ol),o=Ac(),[a,i]=h.useState(!1),[s,n]=h.useState(t),r=Ve(),l=il(),d=(e=>{const t=DP(e);return t&&!!(null==t?void 0:t.sharedAt)})(e),c=e===Vn,u=h.useCallback((()=>{const t=s.trim()||"Untitled Folder";n(t),l(nb({workspaceId:e,newName:t})),xK(e,{name:t}),i(!1)}),[l,s,e]),m=h.useCallback((e=>{n(e.target.value)}),[]),p=h.useCallback((e=>{e.preventDefault(),u()}),[u]),g=h.useCallback((()=>{u()}),[u]),f=h.useCallback((()=>{i(!0)}),[]),y=h.useCallback((()=>{Fm(ym.OPEN_SHARED_WITH_ME,{location:"breadcrumb"}),l(ib(Vn)),r.push("/shared-with-me")}),[l,r]),v=h.useCallback((()=>{d||(n(t),i(!0))}),[t,d]);return w.jsxs("div",{className:bje,children:[w.jsx(Mt,{children:w.jsx("title",{children:`${t} — ${o.name} — Kapwing`})}),d&&!c&&w.jsxs("div",{onClick:y,className:xje,"data-cy":"swm-breadcrumb",children:["Shared with Me ",">"]}),d||!a?w.jsx("div",{className:wje,onClick:v,"data-cy":"folder-name","data-testid":"folder-name",children:t}):w.jsx(ci,{onSubmit:p,className:Tje,children:w.jsx(ui,{name:"Folder Name",children:w.jsx(mi,{asChild:!0,children:w.jsx("input",{type:"text",className:wje,value:a?s:t,onChange:m,onBlur:g,onFocus:f,"data-cy":"workspace-header-input",autoComplete:"off",autoFocus:!0,"data-testid":"folder-name-input"})})})})]})})),Eje=_.memo((({onClose:e,entryPoint:t,setPendingInvites:o})=>{var a;const i=Hu(),s=null==(a=null==i?void 0:i.users)?void 0:a.length,n=i&&SP(null==i?void 0:i._id),r=IP(null==n?void 0:n.role),l=fW(Hl.Create),d=h.useMemo((()=>[{modal:w.jsx(vIe,{entryPoint:t})},{modal:w.jsx(EEe,{entryPoint:t,setPendingInvites:o})}]),[t,o]);return l?(s??0)>1||!r?w.jsx(EEe,{entryPoint:t,onClose:e,setPendingInvites:o}):w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:e,children:w.jsx(dSe,{modalSteps:d,onClose:e})}):null})),Ije="InviteMembersButton-module_button_uf3Ez",Cje="InviteMembersButton-module_icon_AzQVC",kje=_.memo((()=>{const[e,t]=h.useState(!1),o=ou(),a=fW(Hl.Create),i=h.useCallback((()=>{t(!1)}),[]),s=h.useCallback((()=>{t(!0)}),[]);return w.jsxs(w.Fragment,{children:[w.jsx(sU,{message:"Invite new members to your workspace",children:!o.isEdu&&a&&w.jsx("button",{className:Ije,onClick:s,"data-testid":"ws-header-invite-members-button","data-cy":"ws-header-invite-members-button",children:w.jsx(pi,{className:Cje})})}),w.jsx(d9,{children:e&&w.jsx(Eje,{onClose:i,entryPoint:wIe.WORKSPACE_HEADER})})]})})),Aje="SearchButton-module_button_14XV5",jje="SearchButton-module_icon_tcw3l",Nje=_.memo((()=>{const e=Ve();return w.jsx(sU,{message:"Search for projects in this workspace",children:w.jsx("button",{className:Aje,onClick:()=>{e.push("/search")},"data-cy":"workspace-search-icon-button",children:w.jsx(hi,{className:jje})})})})),Rje="SettingsButton-module_button_6wTYn",Pje="SettingsButton-module_icon_9bCva",Dje=_.memo((()=>{const{selectedTeamId:e}=tl((e=>({selectedTeamId:e.teams.selectedTeamId})),ol),t=Ve();return w.jsx(sU,{message:"Access workspace settings",children:w.jsx("button",{className:Rje,onClick:()=>{t.push(`/team/${e}/settings`)},children:w.jsx(gi,{className:Pje})})})})),Oje=_.memo((()=>{const{selectedTeamId:e}=tl((e=>({selectedTeamId:e.teams.selectedTeamId})),ol),t=Ac(),[o,a]=h.useState(!1),i=h.useCallback((()=>{a(!0)}),[]),s=h.useCallback((()=>{a(!1),window.history.replaceState({},document.title)}),[]);return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:BAe,children:[w.jsx(Sje,{}),w.jsxs("div",{className:VAe,children:[w.jsx(Nje,{}),w.jsx(_je,{openAccountSettings:i}),w.jsx(Dje,{}),w.jsx(kje,{}),w.jsx(YAe,{users:t.users,url:`/team/${e}/members`})]})]}),o&&w.jsx(tSe,{closeAccountSettings:s})]})})),Lje=e=>{const{id:t,name:o,fileUploadProgress:a,cancelUpload:i}=e,s=tl((e=>DIe(e)));let n="Loading";n="100%"!==a?a:"Creating assets";return w.jsx("div",{className:`${GIe.projectWrapper} ${s&&GIe.listView} ${GIe.uploadProject}`,children:w.jsxs("div",{className:`${GIe.projectPlaceholder} ${s&&GIe.listView}`,"data-cy":"workspace-project-placeholder",children:[s?w.jsx("div",{className:`${GIe.uploading} ${s&&GIe.listView}`,children:w.jsx(MU,{text:""})}):w.jsx("div",{className:GIe.uploading,children:w.jsx(MU,{text:n})}),s?w.jsxs("div",{className:`${GIe.contentInfo} ${s&&GIe.listView}`,children:[w.jsx("div",{className:`${GIe.projectName} ${s&&GIe.listView}`,children:w.jsx("div",{className:`${GIe.type} ${s&&GIe.listView} ${GIe.uploadProject}`,children:n})}),w.jsxs("div",{className:`${GIe.cancelUpload} ${s&&GIe.listView}`,onClick:()=>{i(t)},children:[w.jsx("span",{className:GIe.cancelUploadText,children:"Cancel"}),w.jsx(ve,{})]})]}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:GIe.contentInfo,children:[w.jsx("div",{className:GIe.projectName,children:w.jsx("div",{className:GIe.type,children:"Creating assets"===n||o})}),w.jsx("div",{className:GIe.dateInfo,children:"Uploading"})]}),w.jsxs("div",{className:`${GIe.cancelUpload} ${s&&GIe.listView}`,onClick:()=>{i(t)},children:[w.jsx("span",{className:GIe.cancelUploadText,children:"Cancel"}),w.jsx(ve,{})]})]})]})})},Fje=({workflowId:e})=>{const t=Ve(),o=il(),a=tl((t=>e?t.workflows.workflowById[e]:void 0),ol),i=tl((t=>{var o;return e?null==(o=t.workflows.workflowById[e])?void 0:o.status:void 0})),s=h.useRef(0);h.useEffect((function(){void 0===i&&e&&(o($L.workflowFetchStarted(e)),Vje(e))}),[o,i,e]),xhe((async()=>{if(!(!e||"success"!==(null==a?void 0:a.status)||a&&fd(a.data)))try{const t=await Bje(e);o($L.workflowFetched({settings:t.settings,workflowId:e,workflow:t.highlights})),s.current=0}catch(i){s.current++,console.error(i),s.current>5&&(mh({description:"There was an error fetchning your clips. Please try again.",error:i}),t.push("/repurpose/create"))}}),5e3);const n=e&&(!i||"fetching"===i);return{workflow:"success"===(null==a?void 0:a.status)?a.data:void 0,isLoading:n}},Mje=async(e,t)=>{const{dispatch:o}=sr();await qr(`/api/v2/workflows/highlights/${e}/name`,{body:{name:t}}),o($L.updateWorkflow({workflowId:e,updates:{name:t}})),o(wl({type:"success",description:"Workflow renamed successfully"}))},Uje=async e=>{const{dispatch:t}=sr(),o=await zr(`/api/v2/workflows/${e}`);return t($L.removeWorkflow(e)),o},Bje=async e=>await Yr(`/api/v2/workflows/highlights/${e}`),Vje=async e=>{const{dispatch:t}=sr();try{const{highlights:o,settings:a}=await Bje(e);t($L.workflowFetched({workflowId:e,workflow:o,settings:a}))}catch(IGe){t($L.workflowFetchError({workflowId:e,error:IGe.message}))}};const Wje=_.memo((({thumbnailUrl:e,elementType:t})=>e||t===HCe.VIDEO?w.jsxs("div",{className:rCe,"data-cy":"workspace-thumbnail",children:[w.jsx("div",{className:dCe,children:w.jsx("img",{src:e||zn,alt:"Thumbnail",className:cCe,onError:e=>{e.currentTarget.src=zn}})}),w.jsx("img",{src:e||zn,alt:"Thumbnail",className:lCe,onError:e=>{e.currentTarget.src=zn}})]}):t===HCe.FOLDER?w.jsx("div",{className:xCe,"data-cy":"workspace-thumbnail",children:w.jsx("div",{className:SCe,children:w.jsx("svg",{width:"87",height:"73",viewBox:"0 0 87 73",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{d:"M2 61.1429V11.8571C2 9.24287 3.22588 6.73566 5.40796 4.88709C7.59005 3.03852 10.5496 2 13.6355 2H26.8224L38.4579 11.8571H73.3645C76.4504 11.8571 79.41 12.8957 81.592 14.7442C83.7741 16.5928 85 19.1 85 21.7143V61.1429C85 63.7571 83.7741 66.2643 81.592 68.1129C79.41 69.9615 76.4504 71 73.3645 71H13.6355C10.5496 71 7.59005 69.9615 5.40796 68.1129C3.22588 66.2643 2 63.7571 2 61.1429Z",stroke:"#505050",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})})})}):w.jsxs("div",{className:rCe,"data-cy":"workspace-thumbnail",children:[w.jsx("div",{className:dCe,children:w.jsx("img",{src:zn,alt:"Thumbnail",className:cCe})}),w.jsx("img",{src:zn,alt:"Thumbnail",className:lCe})]}))),Gje=e=>{if(!e)return null;const t=cr(e),o=t.indexOf("."),a=o>0?o:t.length;return t.substring(0,a)},Hje=_.memo((({onClick:e,workspaceElement:t,multiLineSubtitles:o,dropdown:a,onRename:i,paywallModalAction:s,isSelected:n,selectionMode:r,selectable:l,onSelect:d})=>{const c=bW(),{handleClick:u,fullDropdown:m,title:p,subtitles:g,isRenaming:f,setIsRenaming:y,newName:v,setNewName:_,handleRename:b,handleSelectionClick:T}=((e,t,o,a,i,s,n)=>{var r;const l=Ve(),[d,c]=h.useState(!1),[u,m]=h.useState(e.title),p=o&&!e.locked?null==t?void 0:t.concat([{icon:w.jsx(za,{}),label:"Rename",onClick:async()=>c(!0),type:tCe.Generic}]):t;let g=An;e.elementType===HCe.BRANDKIT_TEMPLATE?g="Untitled Template":e.elementType===HCe.FOLDER&&(g="New Folder");const f=e.title||g,y=h.useCallback((e=>{e.stopPropagation()}),[]),v=h.useCallback((async()=>{d&&o&&(null==u?void 0:u.trim().length)&&u!==e.title&&await o(u),c(!1)}),[u,o,e.title,d]),_=null==(r=e.subtitles)?void 0:r.map(((e,t)=>e.linkAddress?w.jsx(Ft,{to:e.linkAddress,onClick:y,className:`${fCe} ${yCe}`,children:e.label},t):w.jsx("div",{className:fCe,children:e.label},t))).reduce(((e,t,o)=>a?null===e?[t]:[...e,t]:null===e?[t]:[...e,w.jsx("span",{className:_Ce,children:"•"},`${o}_separator`),t]),null),b=h.useCallback((e=>{e.stopPropagation(),e.preventDefault(),i&&i(!1)}),[i]);return{handleClick:h.useCallback((t=>{t.stopPropagation(),t.preventDefault(),s?i&&i():e.locked||(n?n():e.linkAddress&&l.push(e.linkAddress))}),[s,e.locked,e.linkAddress,n,i,l]),fullDropdown:p,isRenaming:d,setIsRenaming:c,title:f,subtitles:_,newName:u,setNewName:m,handleRename:v,handleSelectionClick:b}})(t,a,i,o,d,r,e),x=(Date.now()-new Date(t.createdAt||"").getTime())/864e5,S=w.jsxs(w.Fragment,{children:[w.jsx(Wje,{thumbnailUrl:t.thumbnailUrl,elementType:t.elementType}),!!t.duration&&w.jsx("div",{className:TCe,children:Gje(t.duration)}),t.locked&&w.jsx("div",{className:bCe,children:w.jsx(Za,{})}),t.isPrivate&&w.jsx("div",{className:ICe,children:w.jsx(Jo,{})}),w.jsx(YCe,{absolute:!0,elementType:t.elementType,text:t.iconText?t.iconText.toString():void 0}),l&&w.jsx("div",{className:kCe,onClick:T,onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),children:w.jsx("div",{className:`${nCe} ${r?ACe:""}`,children:n?w.jsx("div",{className:jCe,children:w.jsx(fi,{className:RCe,fontSize:12})}):w.jsx("div",{className:jCe,children:w.jsx(yi,{fontSize:16})})})})]});return w.jsxs("div",{className:`${sCe} ${n?NCe:""}\n         ${t.locked?ECe:""}`,onClick:()=>{(s||t.locked)&&c((()=>null),{action:s||Vl.STORAGE_LIMIT,extraAmplitudeEventProperties:{"Days Since Video Created":x}})()},children:[w.jsx("div",{className:wCe,onClick:u,onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),children:S}),w.jsxs("div",{className:`${uCe} ${t.locked?CCe:""}`,onClick:e=>{t.locked||(e.preventDefault(),e.stopPropagation())},children:[w.jsxs("div",{className:mCe,onClick:()=>y(!0),children:[f&&!t.locked?w.jsx("input",{type:"text",className:hCe,"data-cy":"workspace-element-input",placeholder:t.elementType===HCe.BRANDKIT_TEMPLATE?"Untitled Template":An,value:v,onChange:e=>_(e.target.value),onBlur:b,onKeyUp:e=>{"Enter"===e.key&&b()},autoFocus:!0}):w.jsx("div",{className:pCe,"data-cy":"workspace-element-title",children:p}),m&&!!m.length&&w.jsx(iCe,{items:m,children:w.jsx("div",{className:PCe,onClick:e=>{e.preventDefault(),e.stopPropagation()},children:w.jsx(Xa,{size:22})})})]}),w.jsx("div",{className:`${gCe} ${o?vCe:""}`,children:g})]})]})})),$je=e=>t=>!(null==t?void 0:t.duration)||t.duration>=e,Kje=e=>!!e.content_type&&((!wB(e.content_type)||void 0!==e.dimensions)&&(!MB(e.content_type)&&!bB(e.content_type)||void 0!==e.duration)),zje={type:"loading",message:"Processing your upload...",isValid:e=>!!e&&Kje(e)};function Yje(e,t,o){return UH(e,o).then((()=>async function(e,t){t.getContext("2d").drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,t.width,t.height);const o=await function(e){return new Promise((t=>{e.toBlob((e=>t(e)),"image/jpeg",.6)}))}(t);if(!o)throw new Error("Unable to get canvas blob");return o}(e,t)))}async function Jje(e){const t=sr().state.mediaCache.assetIdToMediaCacheId[e._id];if(!t)return null;const o=await d$(t);if(!o)return null;const a={};await async function(e,t,o){var a,i;o.metadata_stage=1;const s="video"===t.type,n="audio"!==t.type?null==(a=t.file_v2)?void 0:a.file:t.file;if(!n)throw Error("No file found");o.file_size=n.size,o.size=n.size,(t.type===zl.Video||t.type===zl.Audio)&&(o.duration=s?t.file_v2.duration:t.duration);t.type!==zl.Video&&t.type!==zl.Image||(o.dimensions={width:t.file_v2.width,height:t.file_v2.height});if(t.type===zl.Video){o.hasAudio=null==(i=t.file_v2)?void 0:i.hasAudio;const a=await(r=t,l=10,new Promise(((e,t)=>{const o=[],a=document.createElement("canvas"),i=document.createElement("video");i.crossOrigin="anonymous",i.preload="auto",i.addEventListener("loadeddata",(async()=>{a.width=480;const s=i.videoHeight/i.videoWidth;a.height=480*s;const{duration:n}=i;for(let e=0;e<Math.max(0,n-.3);e+=n/l){const t=await Yje(i,a,e);o.push(t)}0===o.length?t(new Error("Generated 0 frames")):e(o)}));const s=y$(r,["original","preview"]);s?(i.src=URL.createObjectURL(s),i.load()):t(new Error("No video file"))}))),s=ae(),n=a.map(((t,o)=>new File([t],`asset_thumbnails/${e._id}_${s}_${o}.jpg`,{type:"image/jpeg"}))),d=await async function(e){return Promise.all(e.map((e=>new Promise(((t,o)=>{new wP({file:e,layer:{id:P(),name:e.name,type:zl.Image},useNameDirectly:!0,analyticsUploadSource:"CML Fetcher",uploadSourceComponent:"AssetInitialization",onError:e=>{o(e)},onFinish:async()=>{t(e.name)}}).upload()})))))}(n);o.thumbnails=d}var r,l}(e,o,a);return await H$(e._id,a)}async function qje(e){let t=null;try{t=await Jje(e)}catch(o){console.error(o)}if(!t)try{t=await async function(e){return"complete"===(await J$(e)).status?null:await new Promise(((t,a)=>{const i=setInterval((async()=>{try{const o=await Yr(`/api/v1/assets/${e}`);"metadata_init_in_progess"in o&&!o.metadata_init_in_progess&&(t(o),clearInterval(i))}catch(o){a(o),clearInterval(i)}}),5e3)}))}(e._id)}catch(o){console.error(o)}return t}var Xje=(e=>(e.Unknown="unknown",e.Uploading="uploading",e.Processing="processing",e.Optimizing="optimizing",e.Complete="complete",e))(Xje||{});const Qje=()=>{const e=tl((e=>e.uploadStatuses)),t=tl((e=>e.assets.byId)),o=tl((e=>e.assets.estimatedDurationsById)),a=il(),i=h.useCallback((async(e,t)=>await eq(e,{...t,eventHandlers:{...t.eventHandlers,handleFinish:async e=>{var o,i;if(!e.asset_id)throw Error("File uploaded, but had no asset id");null==(i=null==(o=t.eventHandlers)?void 0:o.handleFinish)||i.call(o,e);const s=await W$(e.asset_id);a(JP([s]));try{const e=await Jje(s);e&&a(JP([e]))}catch(n){console.error(n),R(n,{tags:{feature:bd.fhInWorkspace}})}}}})),[a]),s=h.useCallback((o=>{if("assetId"in o){const e=t[o.assetId];if(e){if((e=>Kje(e))(e))return{data:e,status:"complete"};if(!Kje(e))return{data:e,status:"processing"}}return{data:void 0,status:"unknown"}}const a=o.uploadId?null==e?void 0:e[o.uploadId]:void 0;return a?{data:a,status:"uploading"}:{data:void 0,status:"unknown"}}),[t,e]),n=h.useCallback(((e,a)=>{let i,s,n,r=t[e];if(r&&!r.duration){const t=o[e];r={...r,duration:r.duration??t}}for(let t=0;t<a.length;t++){const e=a[t];if(!(null==e?void 0:e.isValid(r))){if("loading"===(null==e?void 0:e.type)){s=e;break}if("error"===(null==e?void 0:e.type)){i=e;break}"warning"!==(null==e?void 0:e.type)||(n=e)}}return s??i??n}),[t,o]),r=h.useCallback((async e=>{var t,o;const{status:i}=s({assetId:e});if("processing"!==i)return;const n=await W$(e);if(!n)throw new Error("Asset does not exist.");const r=(null==n?void 0:n.url)&&!(null==n?void 0:n.metadata_init_started_at),l=n.metadata_init_started_at&&(null==(t=null==n?void 0:n.metadata_init_failed)?void 0:t.last_attempted)&&new Date(String(n.metadata_init_started_at))<new Date(String(null==(o=null==n?void 0:n.metadata_init_failed)?void 0:o.last_attempted));(r||l)&&await J$(e),a(JP([n]))}),[a,s]);return{getUploadStatus:s,uploadFiles:i,pollProcessingAssetIfNeeded:r,validateUpload:n}},Zje=({preferredTeamId:e}={})=>{const t=il(),{currentTeamId:o,teams:a,loggedIn:i,isFetchingTeams:s}=tl((e=>({currentTeamId:e.teams.selectedTeamId,teams:e.teams.allTeams,loggedIn:nu(e),isFetchingTeams:e.teams.isFetchingTeams})),ol),[n,r]=h.useState(!0),l=h.useRef(!0),d=h.useMemo((()=>a.find((e=>e._id===o))),[o,a]),c=h.useMemo((()=>a.find((t=>t._id===e))),[e,a]),u=h.useCallback((()=>{const e=a[0];if(!e)throw new Error("No teams found");t(Ip(e._id)),r(!1)}),[t,a]);return h.useEffect((function(){i&&(!d||e)?d&&d._id===e?r(!1):!d||d._id===e||l.current?(async()=>{if(!d&&!a.length||e&&!c&&l.current){if(s)return;t(Cp(!0));const o=await(async()=>{const{state:e}=sr(),{currentUser:t}=e,{token:o,user:a}=t||{},{_id:i}=a||{},s={token:o,userId:i};try{return await Yr("/api/v2/teams/user",{params:s})}catch(IGe){return[]}})();if(!o.length)throw f("User has no teams. Captured in useCurrentTeamV2.ts",{extra:{preferredTeamId:e}}),new Error("User has no teams.");t(kp(o)),t(Cp(!1))}else e?(c?t(Ip(c._id)):u(),l.current=!1):u(),r(!1)})():r(!1):r(!1)}),[d,t,s,i,e,c,u,a]),h.useMemo((()=>({currentTeam:d,isLoading:n})),[d,n])},eNe=({preferredFolderId:e,preferredTeamId:t}={})=>{const o=il(),{isLoading:a,currentTeam:i}=Zje({preferredTeamId:t}),{currentFolderId:s,folders:n,loggedIn:r,isFetchingFolders:l}=tl((e=>({currentFolderId:e.workspaces.selectedWorkspace,folders:e.workspaces.allWorkspaces,loggedIn:nu(e),isFetchingFolders:e.workspaces.isFetchingFolders})),ol),[d,c]=h.useState(!0),u=h.useRef(!0),m=h.useMemo((()=>n.find((e=>e._id===s))),[n,s]),p=h.useMemo((()=>n.find((t=>t._id===e))),[n,e]),g=h.useCallback((()=>{const e=n[0];if(!e)throw new Error("No folders found");o(ib(e._id))}),[o,n]);return h.useEffect((function(){if(r)if(s!==Vn){if(!a){if(!i)throw new Error("Cannot find current team");!m||e?m&&m._id===e?c(!1):!m||m._id===e||u.current?(async()=>{if(!m&&!n.length||e&&!p&&u.current){if(l)return;o(fb(!0));const e=await(async e=>{const{state:t}=sr(),{currentUser:o}=t,{token:a}=o||{},[i,s]=await Promise.all([Yr("/api/v1/teamFolders",{params:{token:a,teamId:e}}),Yr("/api/v1/workspaces",{params:{token:a,teamId:e}})]);return[...i,...s]})(i._id);if(!e.length)throw f("User has no folders. Captured in useCurrentFolder.ts",{extra:{}}),new Error("Team has no folders.");o(ab(e)),o(fb(!1))}else e?(p?o(ib(p._id)):g(),u.current=!1):g(),c(!1)})():c(!1):c(!1)}}else c(!1);else c(!1)}),[m,s,i,null==i?void 0:i._id,o,n,l,a,r,e,p,g]),h.useMemo((()=>({currentFolder:m,currentTeam:i,isLoading:d||a})),[m,i,a,d])},tNe=["_id","copiedProjectId","copiedVideoId","createdAt","creatorId","deletedLayerLocalBlobDict","finishedAt","fullPath","presence","presentUserId","projectId","submittedAt","teamId","workspaceId"];function oNe(e,t){return{id:oe.v4(),url:e.url,asset_id:e._id.toString(),preview:e.preview,track_preview:e.track_preview,duration:e.duration,startTime:0,endTime:e.duration,hasAudio:!0,name:e.name||"Unknown",originalName:e.name,addedFromMediaLibrary:!1,usedProFeatures:[],position:{x:"0%",y:"0%",rotation:0,width:"100%",height:"100%"},metadataGathered:!0,timelineRow:0,volume:1,isTrimmed:!0,videoDelay:0,...t}}function aNe(e,t){var o,a;return{...oNe(e,t),type:zl.Video,width:null==(o=e.dimensions)?void 0:o.width,height:null==(a=e.dimensions)?void 0:a.height}}function iNe(e,t){return{...oNe(e,t),type:zl.Audio}}const sNe=e=>{var t,o;return(null==(t=e.content_type)?void 0:t.includes("audio"))?iNe(e,{conversion_id:e.conversion_id,source:"workspaceUpload"}):(null==(o=e.content_type)?void 0:o.includes("image"))?function(e,t){var o,a;return{id:oe.v4(),type:zl.Image,url:e.url,asset_id:e._id.toString(),source:t,name:e.name||"Unknown",originalName:e.name,addedFromMediaLibrary:!1,usedProFeatures:[],position:{x:"0%",y:"0%",rotation:0,width:"100%",height:"100%"},metadataGathered:!0,timelineRow:0,width:null==(o=e.dimensions)?void 0:o.width,height:null==(a=e.dimensions)?void 0:a.height}}(e,"workspaceUpload"):aNe(e,{conversion_id:e.conversion_id,source:"workspaceUpload"})},nNe=({languageCode:e,maxCharsPerSubtitle:t,transcription:o})=>({byId:DC({languageCode:e,maxCharsPerSubtitle:t,separator:" ",words:o}).map((e=>{const t=e[0],o=e[e.length-1];if(!t||!o)throw Error("Missing subtitle");const a=t.start_time,i=o.end_time,s=e.map((e=>({start:e.start_time,end:e.end_time,text:e.word})));return{id:oe.v4(),start:a,end:i,words:s}})).reduce(((e,t)=>(e[t.id]=t,e)),{})});class rNe{constructor({aspectRatio:e,creatorId:t,name:o,teamId:a,workspaceId:s,studio:n={}}){i(this,"video"),i(this,"assetTranscriptions"),this.video=((e={})=>{const t=new Date;return{isCreator:!0,isStudio:!0,analytics:{},projectVersion:"0.9",ratio:"1:1",hasCustomOutput:!1,topFontsLoaded:!1,origin:"",overlayMounted:!1,isDragging:!1,scenes:[{id:de(),background:"#ffffff",duration:0,userSelectedDuration:0,userSetDuration:!1,layers:[]}],animations:{byId:{},allIds:[]},allLayers:{byId:{}},localId:de(),deletedLayerLocalBlobDict:{},deletedLayerDict:{},selectedLayerId:"",selectedTimelineRows:[0],groups:{},pendingGoogleDriveUploads:[],timelineGap:null,clipboardCopyId:null,clipboard:{itemType:"empty",item:{}},safeZoneChosen:"none",snapToGrid:!0,privacy:0,showCanvas:!1,background:"#ffffff",canvasBlur:!1,isImageVideo:!1,duration:0,toolTip:"",videoType:"mp4",imageType:"png",gifType:"gif",exportFrameTime:-1,quality:"standard",addedOptimizedLayer:!1,draft:!0,done:!1,createdAt:t,fullPath:"",image_url:"",updateKey:de(),refreshKey:0,lastSaved:t,canvasDimensions:{canvasWidth:0,canvasHeight:0},canvasX:0,canvasY:0,containerX:0,containerY:0,containerWidth:0,containerHeight:0,workspaceId:"",projectId:"",creatorId:"",teamId:"",canvasPreviewSeekerTimestampId:de(),contextMenuUsed:0,customFontsFetched:!1,playCanvasPreviewOnMount:!1,usedEyedropper:!1,layerDuplicated:!1,enhanceJobIds:{},userSpecificSettings:{},userSpecificSettingsAnonymous:{},selectedTransition:null,magicSubtitles:{},magicSubtitlesGlobal:{},magicSubtitleFramesByAsset:{},assetUploadedSubtitles:{},isCollaborating:!1,presence:{},presentUserId:"",readonly:!1,exportQuality:"Standard",exportResolution:"AUTO",isBrandKitTemplate:null,fromBrandKitTemplate:null,keyframing:{},historyIndex:-1,usedUndo:!1,layersPendingUpload:{},editorPath:"/studio/editor",lastSeen:t,parentId:"",progressText:"copied",sourceVideo:{},submittedAt:t,createLocation:"studio-save-true",creatorHasLicense:!1,magicSubtitlesOnExport:{},gitCommit:"a9fb2ebb",build:{},heartbeat:Date.now(),useragent:{isAuthoritative:!0,isChrome:!0,isDesktop:!0,isMac:!0,browser:!0,version:!0,os:!0,platform:!0,geoIp:!0,source:!0},lastEditorName:"",lastUpdatedByPOST:t,publishCount:0,code:"",lastUpdatedByShareDB:t,version:1,...e}})(n),this.video.name=o,this.video.projectName=o,this.video.creatorId=t,this.video.teamId=a,this.video.workspaceId=s,this.setAspectRatio(e)}setAspectRatio(e){const t=`${e.width}:${e.height}`;this.video.ratio=t;const{width:o,height:a,containerWidth:i,containerHeight:s,canvasX:n,canvasY:r,containerX:l,containerY:d}=Tj(t,{x:0,y:0,width:this.video.containerWidth||1500,height:this.video.containerHeight||1500});this.video.width=o,this.video.height=a,this.video.containerWidth=i,this.video.containerHeight=s,this.video.canvasX=n,this.video.canvasY=r,this.video.containerX=l,this.video.containerY=d}updateVideo(e){this.video={...this.video,...e}}resize(e){var t;this.setAspectRatio(e.ratio);const{ratio:o,prevRatio:a,resizeMode:i,visionJobByAssetId:s}=e,n=this.video.scenes[0].layers,{resizeLayerUpdates:r,resizeLayersToAdd:l}=ON({aspectRatioWidth:o.width,aspectRatioHeight:o.height,layers:n,prevCanvasHeight:a.height,prevCanvasWidth:a.width,resizeMethod:"fit",shouldSmartReframe:"speaker-focus"===i,visionJobByAssetId:s}),d=n.map((e=>{const t=r[e.id];return{...e,...t}}));for(const{layerIndex:c,layersToAdd:u}of l)d.splice(c,0,...u);if(this.setLayers(d),null==(t=this.video.magicSubtitlesGlobal)?void 0:t.style){const e=LN({currentFontSize:this.video.magicSubtitlesGlobal.style.fontSize,newRatio:{width:o.width,height:o.height},prevRatio:{width:a.width,height:a.height}});this.video.magicSubtitlesGlobal.style.fontSize=e}}setCanvasBlur(e){this.video.canvasBlur=e}setMagicSubtitles({asset:e,languageCode:t,words:o,magicSubtitlePreset:a,maxCharsPerSubtitle:i}){const{ratioHeight:s,ratioWidth:n}=bj(this.video.ratio),{magicSubtitleFramesByAsset:r,magicSubtitles:l,magicSubtitlesGlobal:d}=(({aspectRatio:e,asset:t,languageCode:o,maxCharsPerSubtitle:a,transcription:i,magicSubtitlePreset:s})=>({magicSubtitleFramesByAsset:{[t._id.toString()]:nNe({languageCode:o,maxCharsPerSubtitle:a,transcription:i})},magicSubtitles:{[t._id.toString()]:{languageKey:o,enabled:!0}},magicSubtitlesGlobal:{...gU(s||Yh,{aspectRatio:e})}}))({aspectRatio:{width:n,height:s},asset:e,languageCode:t,magicSubtitlePreset:a,maxCharsPerSubtitle:i,transcription:o});this.video.magicSubtitleFramesByAsset=r,this.video.magicSubtitles=l,this.video.magicSubtitlesGlobal=d}setLayers(e){var t;this.video.showCanvas=!0,this.video.scenes[0].layers=e,this.video.allLayers={byId:e.reduce(((e,t)=>(e[t.id]=t,e)),{})};const{duration:o}=uC(this.video.scenes[0],null==(t=this.video.magicSubtitleFramesByAsset)?void 0:t["background-asset"]);this.video.duration=o,this.video.scenes[0].duration=o}createVideoFromAsset(e){const t=sNe(e);this.video.scenes=[{id:oe.v4(),background:"#FFFFFF",duration:0,userSelectedDuration:0,userSetDuration:!1,layers:[]}],this.setLayers([t])}createVideoFromHighlight(e,t,o,a=!1){if(!e.asset)throw new Error("No asset found");this.video.appliedHighlight={highlightId:t.id};const i=((e,t,o,a)=>{var i;const s=null==(i=t.content_type)?void 0:i.includes("audio"),n=[];for(let r=0;r<e.sections.length;r++){const i=e.sections[r],l=n.reduce(((e,t)=>t.endTime&&t.startTime?t.endTime-t.startTime+e:e),0);if(i){const e={duration:t.duration,startTime:i.start,endTime:i.end,isTrimmed:!0,videoDelay:l,isSample:a};if(s){const a=o[t._id.toString()];n.push({...iNe(t,{source:"workspaceWorkflow"}),local_url:a,...e})}else{const a=o[t._id.toString()];n.push({...aNe(t,{source:"workspaceWorkflow"}),local_url:a,...e})}}}return n})(t,e.asset,o,a);this.video.workflowId=e._id,this.video.scenes=[{id:oe.v4(),background:"#FFFFFF",duration:0,userSelectedDuration:0,userSetDuration:!1,layers:[]}],this.setLayers(i),this.assetTranscriptions={assetTranscriptionId:"",state:"completed",languageKey:e.languageCode,words:e.words,job_params:void 0},this.video.analytics.activeFindHighlightsJobInfo={assetDuration:e.asset.duration,jobId:e.highlightId,highlightId:t.id}}getVideoForExport(){var e;const t=s.cloneDeep(this.video),o=null==(e=t.scenes[0].layers[0])?void 0:e.asset_id;if(!o)return;const a=ij({studio:t,comments:{},studioLocal:t,loadedFonts:{},assetTranscriptions:{byId:{[o]:this.assetTranscriptions}}});let i;if(t.canvasBlur){const e=Hz(t.scenes[0].layers);e.length>0&&(i=e.map((e=>e.layer)).filter(Ir))}const n={backgroundLayers:i,magicSubtitleExportInfo:a};if(n.magicSubtitleExportInfo){const{animations:e,magicSubtitlesOnExport:o}=n.magicSubtitleExportInfo;t.animations.allIds.push(...e.allIds),t.animations.byId={...t.animations.byId,...e.byId},t.magicSubtitlesOnExport=o}return n.backgroundLayers&&(t.backgroundLayers=n.backgroundLayers),t}}async function lNe({video:e}){return{videoId:(await Jr("/api/v2/video-creation/create",{body:{video:e}})).videoId}}const dNe={analyticsUploadSource:"Folder Upload",uploadSourceComponent:"WorkspaceUploadContainer",doDuplicateHandling:!1,skipAddTimelineLayer:!0,isMediaLibraryUpload:!0},cNe=_.memo((()=>{const e=il(),t=Ac(),{assetsById:o,currentFolderUploads:a,currentUserId:i,currentFolderId:s}=tl((e=>{const t=e.workspaces.selectedWorkspace,o=e.workspaces.workspaceUploads;return{assetsById:e.assets.byId,currentUserId:e.currentUser.user._id,currentFolderUploads:null==o?void 0:o[t],currentFolderId:t}}),ol),{getUploadStatus:n,pollProcessingAssetIfNeeded:r}=Qje(),l=h.useMemo((()=>(null==a?void 0:a.map((e=>e.assetId)).filter(Ir))??[]),[a]),d=h.useMemo((()=>(null==a?void 0:a.map((e=>e.uploadId)).filter(Ir))??[]),[a]),c=h.useCallback((async a=>{var n,r;try{if(!s)throw new Error("Could not find folder.");const l=o[a]??await eK(a),d=new rNe({aspectRatio:{width:(null==(n=l.dimensions)?void 0:n.width)??1920,height:(null==(r=l.dimensions)?void 0:r.height)??1080},name:l.name??An,creatorId:i,teamId:t._id,workspaceId:s});d.createVideoFromAsset(l);const c=await lNe({video:d.video}),u=await AD({id:c.videoId});if(!u.projectId)throw new Error("Could not find project.");const m={_id:u.projectId,content:{...u,_id:c.videoId},creatorId:u.creatorId??i,name:u.projectName,teamId:u.teamId,workspaceId:u.workspaceId??s};e(dO({projects:[m],folderId:s}))}catch(IGe){console.error(IGe)}}),[o,s,t._id,i,e]);xhe((async function(){if(s)try{const e=null==l?void 0:l.filter((e=>{const{status:t}=n({assetId:e});return t!==Xje.Complete})).map((e=>(async()=>{await r(e)})()));e&&await Promise.all(e)}catch(IGe){console.error(IGe)}}),5e3);const u=h.useCallback((()=>{s&&al((()=>{d.forEach((t=>{const{status:o,data:a}=n({uploadId:t});switch(o){case Xje.Unknown:e(db({folderId:s,uploadId:t}));break;case Xje.Uploading:100===(i=a).progress&&i.assetId&&(e(db({folderId:s,uploadId:t})),e(lb({folderId:s,assetId:a.assetId})))}var i}))}))}),[s,e,n,d]),m=h.useCallback((()=>{s&&al((()=>{l.forEach((t=>{const{status:o}=n({assetId:t});switch(o){case Xje.Unknown:e(db({folderId:s,assetId:t}));break;case Xje.Complete:e(db({folderId:s,assetId:t})),c(t)}}))}))}),[l,c,s,e,n]);return h.useEffect((function(){u(),m()}),[m,u]),null})),uNe={home:"PasteLink-module_home_UPQqz",homeHowBackgroundWhite:"PasteLink-module_homeHowBackgroundWhite_5KQ96",largeButton:"PasteLink-module_largeButton_EFzOG",sectionContent:"PasteLink-module_sectionContent_PuecO",sectionHeader:"PasteLink-module_sectionHeader_Suz0S",spacer:"PasteLink-module_spacer_RJx0R",chevron:"PasteLink-module_chevron_zD5mb",splashText:"PasteLink-module_splashText_28pjN",splashSubtext:"PasteLink-module_splashSubtext_4U6pJ",aboutSection:"PasteLink-module_aboutSection_l5Fsp",mobile:"PasteLink-module_mobile_FzSNu",desktop:"PasteLink-module_desktop_2QKES",screenReaderOnlyLabel:"PasteLink-module_screenReaderOnlyLabel_-hb1P",disabled:"PasteLink-module_disabled_HUr0n",noScrollBar:"PasteLink-module_noScrollBar_O-EfO",textOverflowEllipsis:"PasteLink-module_textOverflowEllipsis_308O8",disableTextHighlight:"PasteLink-module_disableTextHighlight_01Cv0",genericButtonBlue:"PasteLink-module_genericButtonBlue_MefRJ",container:"PasteLink-module_container_RIHGR",input:"PasteLink-module_input_fU4WY",lightInput:"PasteLink-module_lightInput_-EZBn",newTimelineInputMobile:"PasteLink-module_newTimelineInputMobile_IF4aK",oneOffContainer:"PasteLink-module_oneOffContainer_1m1sV",newTimelineInputDesktop:"PasteLink-module_newTimelineInputDesktop_qDA14"},mNe=new Set(["https://www.youtube.com/watch?app=desktop","https://www.png","https://www.youtube.com","https://www.youtube.com/","https://www.youtube.com/watch?reload=9","https://www.google.com/url?sa=t",""]),pNe=/^https:\/\/www.kapwing.com\/videos.*/;class hNe extends h.Component{constructor(e){super(e),i(this,"handleChange",(async e=>{var t;const{audiogramUpload:o,disallowVideo:a,projectName:i,setProgressText:s,setProjectName:n,stopUpload:r,videoId:l,audiogramUploadStart:d,isMediaLibraryUpload:c,analyticsUploadSource:u}=this.props;let m=e.target.value,p={didError:!1,stage:wd.PreExtractValidation,pastedUrl:m,uploadSource:u,isMediaLibraryUpload:c};if(!P6(m)){const e=`${m} is not a valid URL`;return void this.logPastedLinkUploadFinish(p,e)}if(m.includes("www.kapwing.com")&&!pNe.test(m)){const e=`${m} is not a valid URL. Try a link to a specific video instead such as https://www.kapwing.com/videos/63503f4177ecc9008b7011a3`;return void this.logPastedLinkUploadFinish(p,e)}if(mNe.has(m)){const e=`${m} is not a valid URL. Try a link to a specific video instead such as https://www.youtube.com/shorts/EwAsLiM3vgs`;return void this.logPastedLinkUploadFinish(p,e)}if(_B(m)){const e="MPD files are not currently supported. Please try a different file format.";return void this.logPastedLinkUploadFinish({...p,fileType:"mpd"},e)}m.includes("instagram.com/reel/")&&(m=m.replace("/reel/","/p/")),(m.includes("youtu.be/")||m.includes("youtube.com/"))&&(m=this.cleanUpYoutubeUrl(m));let h=m.substring(0,Math.min(50,m.length));m.length>50&&(h+=" ..."),s(`Fetching ${h} ...`),o&&(null==d||d()),i&&""!==i||n(An);const g=e=>{p={...p,...e}};try{p.stage=wd.Extraction;const{asset:e,cmlFile:i,extractInfo:n}=await D6({acceptAudio:!a||o||!1,acceptVideo:!a,additionalAssetParams:{video_id:l},progressCallback:s,analyticsCallback:g,url:m,doDuplicateHandling:!0});if("skipLayerCreation"in this.props){const t=await AB(n.url,{name:n.url,type:n.mime});this.props.handleFinish(e._id,e.name??e.input_url,t)}else{p.stage=wd.LayerCreation;const o=await(async(e,t,o,a,i,s)=>{const n=await AB(i.url,{name:i.url,type:i.mime}),r=null==n?void 0:n.type;if(!r)throw Error("Could not identify media type");const l=((null==a?void 0:a.duplicate)||i.hasUploadedAssetDuplicate)&&o.status===On.uploaded?"upload":"pastedLink",d={...Qz(),name:Jz(),asset_id:o._id,conversion_id:o.conversion_id||i.conversion_id,mime:i.mime,pastedUrl:e,requireConversion:i.requireConversion,conversion_type:i.conversion_type,soundUrl:i.soundUrl,source:l,url:i.url,objectFit:"cover",isMediaLibraryUpload:s,...n,type:r};return bu(d),a&&(d.cmlFileId=a.id),s||Um(d.type,"paste link"),i.thumbnailUrl&&(d.thumbnailUrl=i.thumbnailUrl),d})(m,0,e,i,n,!!c);o.requireConversion&&o.conversion_type&&o.conversion_type.includes("gif-to")&&(o.type=zl.Video),(null==(t=o.url)?void 0:t.includes("googlevideo.com/video"))&&(o.assetSource="Youtube");const a=sr().state.studioLocal.localProjectId,s=sr().state.studioLocal.localProjectId;if(s!==a)return;p.stage=wd.HandleFinish,this.props.handleFinish(o,{singleFileUpload:!0})}s(""),p.stage=wd.Finish;const r=!!(null==i?void 0:i.duplicate);Fm(ym.ADD_FROM_PASTED_LINK,{...p,isDuplicate:r}),c||"createLayer"in this.props||JJ({assetId:e._id,source:"Pasted Link"})}catch(f){console.error(f);const e=f instanceof Hr&&422===f.status;e||(p.didError=!0),p.errorMessage=ph(f).message;const t=e?"Sorry, we don't support that URL, please try a different one":`Sorry, that pasted URL (${h}) didn't work. ${p.errorMessage}`;this.logPastedLinkUploadFinish(p,t),s(""),r()}})),i(this,"cleanUpYoutubeUrl",(e=>{let t=e;if((t.includes("/shorts/")||t.includes("/live/"))&&(t=this.convertYtLinkToWatchLink(t)),t.includes("/youtu.be/")){const e=t.split("/")[3];return e?`https://www.youtube.com/watch?v=${e.split("?")[0]}`:t}return t.includes("app=")&&(t=`${t.split("app=")[0]}${t.split("&")[1]}`),t.split("&")[0]})),i(this,"logPastedLinkUploadFinish",((e,t)=>{const{showToast:o}=this.props;t&&o({description:t,type:"error"}),Fm(ym.ADD_FROM_PASTED_LINK,{...e})})),i(this,"renderPlaceholder",(()=>{const{audioUpload:e}=this.props;return e?"Paste an audio or video URL (e.g. https://www.youtube.com/watch?v=C0DPdy98e4c)":"Paste an image or video URL (e.g. https://www.youtube.com/watch?v=C0DPdy98e4c)"})),i(this,"renderShortPlaceholder",(()=>{const{audioUpload:e}=this.props;return e?"Paste audio or video URL":"Paste image or video URL"})),this.state={pastedLink:""}}convertYtLinkToWatchLink(e){const t=e.split("/shorts/")[1]||e.split("/live/")[1];return`https://www.youtube.com/watch?v=${null==t?void 0:t.split("?")[0]}`}render(){const{pastedLink:e}=this.state,{classNames:t,isTimeline:o,lightTheme:a}=this.props,i=`upload-link-input-${P()}`,s=[uNe.input];t&&s.push(t),a&&s.push(uNe.lightInput);const n={className:s.join(" "),type:"url",value:e,onChange:this.handleChange},r={...n,placeholder:this.renderPlaceholder(),className:[...s,uNe.newTimelineInputDesktop].join(" ")},l={...n,placeholder:this.renderShortPlaceholder(),className:[...s,uNe.newTimelineInputMobile].join(" ")};return w.jsx("div",{className:uNe.container,children:o?w.jsxs(w.Fragment,{children:[w.jsx("input",{...r,"data-cy":"pasted-link-input"}),w.jsx("input",{...l,"data-cy":"pasted-link-input"})]}):w.jsxs("label",{htmlFor:i,children:[w.jsx("span",{className:uNe.screenReaderOnlyLabel,children:"Paste a URL"}),w.jsx("input",{placeholder:this.renderPlaceholder(),id:i,...n,"data-cy":"pasted-link-input"})]})})}}const gNe=g.connect((e=>({videoId:e.studio._id,projectName:e.projectName,currentUser:e.currentUser})),(e=>ye({setProjectName:SK,setSnapInTimelineBasedOnLandingPage:vb,showToast:wl},e))),fNe=gNe(hNe),yNe="UploadContainer-module_screenReaderOnlyLabel_udalY",vNe="UploadContainer-module_disabled_oiq7Z",_Ne="UploadContainer-module_name_RYC9K",wNe="UploadContainer-module_uploadStatusContainer_riBO3",bNe="UploadContainer-module_pillContainer_fygqH",TNe="UploadContainer-module_pill_iNNK1",xNe="UploadContainer-module_content_e0Vq5",SNe="UploadContainer-module_status_U09Mq",ENe="UploadContainer-module_light_kt6Wk",INe="UploadContainer-module_x_8iB9y",CNe="UploadContainer-module_checkmark_YFi1j",kNe="UploadContainer-module_uploadContainer_kTyL7",ANe="UploadContainer-module_uploadTextContainer_Et6t9",jNe="UploadContainer-module_uploadText_5d-bR",NNe="UploadContainer-module_uploadButton_5bHgH",RNe="UploadContainer-module_uploadLabel_V-Tlq",PNe="UploadContainer-module_dropActive_t8a70",DNe="UploadContainer-module_uploadLabelHeader_o5QF4",ONe="UploadContainer-module_uploadLabelSubheader_Fl102",LNe="UploadContainer-module_uploadIcon_9rDlV",FNe="UploadContainer-module_validationMessage_PvKn1",MNe="UploadContainer-module_validationMessageHeader_IGpo5",UNe="UploadContainer-module_validationLoading_vdlLy",BNe="UploadContainer-module_error_34aY3",VNe="UploadContainer-module_warning_VHyQo",WNe="UploadContainer-module_loading_axo6v",GNe=_.memo((e=>{const t=!QM()&&"light"===e.theme,{getUploadStatus:o,validateUpload:a}=Qje(),i=e.assetId&&e.validators?a(e.assetId,e.validators):void 0,{setUploadValidationInfo:s}=e;switch(h.useEffect((()=>{s(i)}),[s,i]),e.type){case Av.File:{const{data:a,status:s}=e.assetId?o({assetId:e.assetId}):o({uploadId:e.uploadId});if(s===Xje.Unknown)return w.jsx("div",{className:mt(TNe,{[ENe]:t}),children:w.jsx(eme,{})});let n="";s===Xje.Uploading?n=(null==a?void 0:a.progressText)??"Uploading ...":s===Xje.Processing&&(n="Processing upload ...");const r=s===Xje.Uploading?null==a?void 0:a.fileName:null==a?void 0:a.name;return w.jsxs("div",{className:bNe,children:[i&&w.jsx(HNe,{message:i.message,type:i.type}),w.jsxs("div",{className:mt(TNe,{[ENe]:t}),children:[w.jsxs("div",{className:xNe,children:[w.jsx("div",{className:_Ne,children:r}),w.jsxs("div",{className:SNe,children:[w.jsx("div",{children:s!==Xje.Uploading?"Upload complete!":n}),s!==Xje.Uploading&&w.jsx("div",{className:CNe,children:w.jsx(wt,{})})]})]}),s!==Xje.Uploading&&w.jsx("span",{className:INe,onClick:e.handleRemove,children:w.jsx(vi,{})})]})]})}case Av.Link:return w.jsxs("div",{className:bNe,children:[i&&w.jsx(HNe,{message:i.message,type:i.type}),w.jsxs("div",{className:mt(TNe),children:[w.jsxs("div",{className:xNe,children:[!(null==e?void 0:e.progress)&&w.jsx("div",{className:_Ne,children:e.name}),w.jsxs("div",{className:SNe,children:[w.jsx("div",{children:(null==e?void 0:e.progress)?"Uploading...":"Upload complete!"}),!(null==e?void 0:e.progress)&&w.jsx("div",{className:CNe,children:w.jsx(wt,{})})]})]}),w.jsx("span",{className:INe,onClick:e.handleRemove,children:w.jsx(vi,{})})]})]});default:return null}})),HNe=_.memo((({message:e,type:t})=>w.jsxs("div",{className:mt(FNe,{[VNe]:"warning"===t,[BNe]:"error"===t,[WNe]:"loading"===t}),children:["loading"===t&&w.jsxs("div",{className:UNe,children:[w.jsx(eme,{})," "]}),w.jsxs("div",{children:["loading"!==t?w.jsx("span",{className:MNe,children:"error"!==t?"Note:":"Error:"}):null,e]})]}))),$Ne=()=>{},KNe=_.memo((({handleRemoveAsset:e,handleFileUploadFinish:t,handleFileUploadStarted:o,acceptedFileTypes:a,className:i,setUploading:s,disabled:n=!1,initialUploadAssetIds:r,theme:l="dark",validators:d,uploadOptions:c,setUploadValidationInfo:u,multiple:m=!1,...p})=>{const g=il(),[f,y]=h.useState(""),[v,_]=h.useState(!1),[b,T]=h.useState({}),[x,S]=h.useState({}),{uploadFiles:E,pollProcessingAssetIfNeeded:I}=Qje(),[C,k]=h.useState(!1),A=h.useRef(!!(null==r?void 0:r.length)),j=!QM()&&"light"===l;h.useEffect((function(){r&&A.current&&((async()=>{const e=await(async e=>{const{dispatch:t}=sr(),o=await G$(e);return o.length&&t(JP(o)),o})(r),o={};e.forEach((e=>{o[e._id]={type:Av.File,assetId:e._id,assetName:e.name??""},t([e._id])})),T(o)})(),A.current=!1)}),[t,r]);const N=!(!Object.values(b).length&&!Object.values(x).length),D=!(!v&&!f),O=h.useCallback((e=>{mh(e)}),[]),L=h.useCallback((e=>{null==s||s(e),_(e)}),[s]),F=h.useCallback((e=>{null==s||s(!!e),y(e)}),[s]),M=h.useCallback((async e=>{if(!e.asset_id)throw Error("File uploaded, but had no asset id");T((()=>{if(!e.asset_id)throw Error("File uploaded, but had no asset id");const t={};return t[e.asset_id]={type:Av.File,assetId:e.asset_id,assetName:e.name},t})),t([e.asset_id]),L(!1)}),[t,L]),U=h.useCallback((async e=>{try{if(!e)throw new Error("No files added.");L(!0);const t=await E(e,{uploadOptions:c,eventHandlers:{handleFinish:M}});null==o||o(t),T((e=>{const o={...e};return t.forEach((e=>{o[e]={uploadId:e,type:Av.File}})),o}))}catch(IGe){O(IGe)}}),[o,L,O,M,E,c]),B=h.useCallback(((e,t,o)=>{o&&"duration"in o?g(ZP.addEstimatedDuration({assetId:e,duration:o.duration})):(console.info("unable to get pasted link media duration"),console.info(o)),S((o=>{const a={...o};return a[e]={assetId:e,name:t,type:Av.Link},a})),"handlePasteLinkFinish"in p&&p.handlePasteLinkFinish(e)}),[g,p]),V=h.useCallback((e=>{e.preventDefault(),k(!0)}),[]),W=h.useCallback((()=>{k(!1)}),[]),G=h.useCallback((e=>{e.preventDefault(),k(!1),U(e.dataTransfer.files)}),[U]);xhe((async function(){const e=[...Object.keys(b),...Object.keys(x)].map((e=>I(e)));try{await Promise.all(e)}catch(t){R(t,{tags:{feature:bd.fhInWorkspace}})}}),5e3);const H=h.useMemo((()=>Object.keys(b).map((t=>()=>{T((e=>{const o={...e};return delete o[t],o})),e(t)}))),[b,e]),$=h.useMemo((()=>Object.keys(x).map((t=>()=>{S((e=>{const o={...e};return delete o[t],o})),e(t)}))),[e,x]),K=`upload-button-input-${P()}`;return w.jsx("div",{className:i,children:w.jsx("div",{className:kNe,children:N||D?w.jsxs("div",{className:wNe,children:[Object.values(b).map(((e,t)=>w.jsx(GNe,{...e,handleRemove:H[t]??$Ne,theme:j?"light":"dark",validators:d,setUploadValidationInfo:u},t))),Object.values(x).map(((e,t)=>w.jsx(GNe,{...e,handleRemove:$[t]??$Ne,theme:j?"light":"dark",validators:d,setUploadValidationInfo:u},t))),!!f&&w.jsx(GNe,{type:Av.Link,progress:f,handleRemove:$Ne,theme:j?"light":"dark",validators:d,setUploadValidationInfo:u},"link upload")]}):w.jsxs("div",{className:mt({[vNe]:n}),children:[w.jsxs("label",{htmlFor:K,className:mt(RNe,{[PNe]:C,[ENe]:j}),onDragEnter:V,onDragLeave:W,onDragOver:e=>e.preventDefault(),onDrop:G,children:[w.jsx("span",{className:yNe,children:"Click to Upload"}),w.jsx("input",{"data-cy":"upload-input","data-testid":"upload-input",id:K,className:NNe,accept:a,onChange:e=>{var t;return U(null==(t=null==e?void 0:e.target)?void 0:t.files)},type:"file",multiple:m}),w.jsx("div",{className:ANe,children:w.jsxs("div",{className:jNe,children:[w.jsxs("div",{className:DNe,children:["Click to Upload",w.jsx(Wa,{className:LNe})]}),w.jsx("div",{className:ONe,children:"or, drag and drop a file here"})]})})]}),"handlePasteLinkFinish"in p&&w.jsx(fNe,{analyticsUploadSource:c.analyticsUploadSource,stopUpload:$Ne,setProgressText:F,handleFinish:B,skipLayerCreation:!0,lightTheme:"light"===l})]})})})})),zNe=()=>{},YNe=_.memo((()=>{const e=il(),{currentFolder:t,isLoading:o}=eNe(),[a,i]=h.useState(!1),s=QM(),n=h.useCallback((async o=>{if(!(null==t?void 0:t._id))throw new Error("Could not find current folder.");al((()=>{o.forEach((o=>{e(lb({folderId:t._id,uploadId:o}))}))})),vh()}),[null==t?void 0:t._id,e]),r=h.useCallback((async o=>{if(!(null==t?void 0:t._id))throw new Error("Could not find current folder.");e(lb({folderId:t._id,assetId:o})),vh()}),[null==t?void 0:t._id,e]);return o?null:w.jsx("div",{className:nSe.modalContainer,children:a?w.jsx("div",{style:{marginTop:"24px"},children:w.jsx(MU,{text:"Starting your upload..."})}):w.jsx(KNe,{handleRemoveAsset:zNe,handleFileUploadFinish:zNe,handleFileUploadStarted:n,handlePasteLinkFinish:r,acceptedFileTypes:$B(),theme:s?"dark":"light",setUploading:i,uploadOptions:dNe,setUploadValidationInfo:zNe,multiple:!0})})})),JNe=_.memo((({children:e})=>{const t=il(),{currentFolder:o}=eNe(),{uploadFiles:a}=Qje(),i=tl((e=>e.workspaces.selectedWorkspace===Vn)),s=h.useCallback((e=>{e.preventDefault(),_h({modalType:gh.FOLDER_UPLOAD})}),[]),n=h.useCallback((e=>{e.preventDefault()}),[]),r=h.useCallback((async e=>{if(e.preventDefault(),!(null==o?void 0:o._id))throw new Error("Could not find folder.");const i=await a(e.dataTransfer.files,{uploadOptions:dNe});al((()=>{i.forEach((e=>{t(lb({uploadId:e,folderId:null==o?void 0:o._id}))}))}))}),[null==o?void 0:o._id,t,a]);return i?e:w.jsx("div",{onDragEnter:s,onDragOver:n,onDrop:r,children:e})})),qNe="65788f6b7bcf069debcd7d0b",XNe="63d94a3bd5add700e9ef5efb",QNe="WorkflowListViewElement-module_workflowWrapper_Tt9Ms",ZNe="WorkflowListViewElement-module_workflowListViewContainer_J-gyO",eRe="WorkflowListViewElement-module_workflowThumbnailContainer_QqsWj",tRe="WorkflowListViewElement-module_workflowThumbnail_XdpRO",oRe="WorkflowListViewElement-module_contentInfo_gIEmR",aRe="WorkflowListViewElement-module_workflowName_W8FTg",iRe="WorkflowListViewElement-module_workflowDropdownWrapper_jc8Tg",sRe="WorkflowListViewElement-module_workflowIconWrapper_puhFr",nRe="WorkflowListViewElement-module_selectWorkflowSpacer_sSBpy",rRe="WorkflowListViewElement-module_dropdownIcon_KGaf4",lRe=_.memo((({workflow:e})=>{var t;const o=h.useCallback((e=>[{label:"Delete",type:tCe.Generic,onClick:async t=>{t.stopPropagation(),await Uje(e)},icon:w.jsx(fa,{})}]),[]);return w.jsxs(Ft,{to:`/repurpose/${e._id}`,className:QNe,children:[w.jsx("div",{className:nRe}),w.jsxs("div",{className:ZNe,children:[w.jsx("div",{className:eRe,children:w.jsx("div",{className:tRe,style:{backgroundImage:`url(${e.thumbnailUrl||zn})`},children:w.jsx("div",{className:sRe,children:w.jsx(YCe,{elementType:HCe.WORKFLOW,text:null==(t=e.numHighlights)?void 0:t.toString()})})})}),w.jsxs("div",{className:oRe,children:[w.jsx("div",{className:aRe,children:e.name}),w.jsx("div",{children:mr(e.lastSaved)}),w.jsx("div",{children:e.lastEditorName}),w.jsx("div",{className:iRe,children:w.jsx(iCe,{items:o(e._id),children:w.jsx("div",{className:rRe,onClick:e=>{e.preventDefault(),e.stopPropagation()},children:w.jsx(Xa,{size:22})})})})]})]})]},e._id)})),dRe=()=>{},cRe={rainbowBorderOptions:{borderRadius:5,borderWidth:1}},uRe=_.memo((({projectElementRefs:e,selectedProjectIds:t,onSelectProject:o,setUnlockedProjectsArray:a,initialProjectsLoaded:i,startFetchingProjects:s,workflows:n})=>{const r=ou(),l=Ve(),{currentFolderId:d,isSWM:c,selectionMode:u,selectedTeamId:m,currentFolderUploads:p,currentUser:g,currentFolderSettings:f}=tl((e=>{var t;const o=e.workspaces.selectedWorkspace,a=o===Vn;return{currentFolderId:o,isSWM:a,currentFolderSettings:a?e.workspaces.SWMFolderSettings:e.workspaces.currentFolderSettings,selectionMode:e.workspaces.selectionMode,selectedTeamId:e.teams.selectedTeamId,currentUser:e.currentUser,currentFolderUploads:null==(t=e.workspaces.workspaceUploads)?void 0:t[o]}}),ol),{getUploadStatus:y}=Qje(),v=tl((e=>{const t=e.projects.projectIdsByFolderId[d];return null==t?void 0:t.map((t=>e.projects.byId[t])).filter(Ir)}),ol),_=tl((e=>e.workspaces.allWorkspaces.filter((e=>e._id&&e.sharedAt))),ol),b=tl((e=>{const t=(e.projects.projectIdsByFolderId[d]||[]).map((t=>e.projects.byId[t])).filter(Ir).filter((e=>e.content)).map((e=>e._id));if(!r.hasPermission(Bl.UNLIMITED_STORAGE)&&t&&t.length>3)return[...t].slice(0,t.length-3)}),ol),T=il(),[x,S]=h.useState([]),[E,I]=h.useState([]),{isOpen:C}=wue(gL.REPURPOSE_REVIST_PROJECTS),k=tl(PIe),A=!k,j=ku(),N=!(null==_?void 0:_.length),R=!(null==v?void 0:v.length),P=!i,D=!(null==n?void 0:n.length)&&!P&&R&&(!c||N),O=i&&R&&!(null==n?void 0:n.length),L=x.map((e=>e._id)).toString();h.useEffect((function(){wc(g)||l.push("/")}),[g,l]),h.useEffect((function(){(async()=>{const e=await LP(d);if(404===e.status||403===e.status)if(m){const e=VP(m);k9(e)}else{const e=BP();k9(e)}})()}),[d,m]),h.useEffect((function(){s(d,{workspaceId:d,teamId:m,token:g.token,userId:g.user._id})}),[d,g.token,g.user._id,m,s]),h.useEffect((()=>{var e;null==(e=_i)||e()}),[L]),h.useEffect((function(){const e=f?f.sortOrder:eb.ASCENDING;(()=>{let t=c?Nke(e):Lke(e);if((null==f?void 0:f.sortField)===Zw.PROJECT_NAME&&(t=(e=>(t,o)=>Pke(t,o,e))(e)),(null==f?void 0:f.sortField)===Zw.DATE_EDITED&&(t=c?Nke(e):(e=>(t,o)=>jke(t,o,e))(e)),(null==f?void 0:f.sortField)===Zw.LAST_EDITOR&&(t=c?(e=>(t,o)=>Oke(t,o,e))(e):(e=>(t,o)=>Dke(t,o,e))(e)),(null==f?void 0:f.sortField)===Zw.DATE_CREATED&&(t=Lke(e)),v){const e=[...v].sort(t);a(b?e.filter((e=>!(null==b?void 0:b.includes(e._id)))):e),S(e)}if(_){const e=[..._].sort(t);I(e)}})()}),[v,b,_,f,c,t,a,n]);const F=h.useMemo((()=>D&&!(null==p?void 0:p.length)&&!P),[null==p?void 0:p.length,D,P]),M=()=>{const e=null==E?void 0:E.map((e=>w.jsx(vke,{folder:e,sharedWithMe:c,isMobile:j},e._id)));return c&&!N&&k?w.jsx("div",{className:Eke,"data-testid":"folder-view-folders-container",children:e}):e},U=h.useMemo((()=>w.jsx(XCe,{gridView:k})),[k]),B=()=>w.jsx(w.Fragment,{children:null==x?void 0:x.filter((e=>!e.workflowId)).map(((a,i)=>{var s,n;if(!(n=a).content||n.content.isBrandKitTemplate)return null;const r=!(!(null==(s=a.content)?void 0:s.createdAt)||!b)&&(null==b?void 0:b.includes(a._id));return w.jsx(wi,{placeholder:U,offset:100,children:w.jsx(tke,{video:a.content,project:a,locked:!c&&!Kp(g)&&r,lockedForUser:r,sharedAt:a.sharedAt,isSelected:u&&t.includes(a._id),onSelect:o,selectionMode:u,projectContainerRef:e[i],isMobile:j},a._id)},a._id)}))}),V=h.useMemo((()=>null==p?void 0:p.map((e=>()=>T(db({...e,folderId:d}))),[])),[d,p,T]),W=()=>{const e=d===Vn;return p&&p.length?w.jsx(w.Fragment,{children:p.map(((t,o)=>{const a=t.assetId&&y({assetId:t.assetId})||t.uploadId&&y({uploadId:t.uploadId})||null;if(!a)return null;const{data:i,status:s}=a;return s===Xje.Unknown?null:s===Xje.Uploading?w.jsx(Lje,{id:i.assetId??i.id,name:i.fileName??An,fileUploadProgress:i.progressText??bi.startCase(s),cancelUpload:(null==V?void 0:V[o])??dRe,shared:e},o):s!==Xje.Complete?w.jsx(Lje,{id:i._id,name:i.name??An,fileUploadProgress:bi.startCase(s),cancelUpload:(null==V?void 0:V[o])??dRe,shared:e},o):null}))}):null},G=h.useCallback((e=>{const t=e.status===gd.COMPLETE?e.numHighlights:void 0,o=e.thumbnailUrl||zn,a=e.status===gd.PENDING||e.status===gd.RUNNING?[{label:"Processing..."}]:[{label:`${e.lastEditorName}, ${mr(e.lastSaved)}`}];return{elementType:HCe.WORKFLOW,iconText:t,title:e.name?e.name:"Find Highlights",thumbnailUrl:o,subtitles:a}}),[]),H=h.useCallback((async(e,t)=>{await Mje(e,t)}),[]),$=h.useCallback((e=>[{label:"Delete",type:tCe.Generic,onClick:async t=>{t.stopPropagation(),await Uje(e)},icon:w.jsx(fa,{})}]),[]),K=h.useMemo((()=>null==n?void 0:n.map((e=>t=>H(e._id,t)))),[H,n]),z=h.useMemo((()=>null==n?void 0:n.map(((e,t)=>()=>{0===t&&C&&JK(),l.push(`/repurpose/${e._id}`)}))),[l,C,n]);return w.jsxs(w.Fragment,{children:[w.jsx(Oje,{}),w.jsx(UAe,{folderProjectsIsEmpty:R&&!(null==n?void 0:n.length),foldersArray:_,initialProjectsLoaded:i}),w.jsx(JNe,{children:F?c?w.jsxs("div",{className:_ke,children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/NvQ-cat handshake.webp",className:wke,alt:"No shared content, yet!","data-testid":"folder-view-no-shared-content"}),w.jsx("div",{className:bke,children:"No content has been shared with you yet. If someone shares a project with you, it will show up here for easy access."})]}):w.jsxs("div",{className:Tke,"data-testid":"folder-view-no-projects",children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/HNq-kit-surfing-web.webp",alt:"kit"}),w.jsx("div",{className:Ske,children:w.jsx("p",{children:"No projects in this folder yet. Your projects will appear here as you create them."})})]}):w.jsx("div",{className:mt({[Ike]:k||O,[Cke]:!(k||O)}),children:P?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:`${kke} ${A&&!R&&xke}`,"data-loading":!0,children:w.jsx("div",{className:Ake,"data-cy":"empty-project-tile"})}),w.jsx("div",{className:`${kke} ${A&&!R&&xke}`,"data-loading":!0,children:w.jsx("div",{className:Ake})}),w.jsx("div",{className:`${kke} ${A&&!R&&xke}`,"data-loading":!0,children:w.jsx("div",{className:Ake})})]}):c?w.jsxs(w.Fragment,{children:[!N&&M(),!R&&B()]}):w.jsxs(w.Fragment,{children:[W(),n&&(Y=n,A?w.jsx("div",{children:Y.filter((e=>e._id!==qNe)).map((e=>w.jsx(lRe,{workflow:e},e._id)))}):Y.filter((e=>e._id!==qNe)).map(((e,t)=>w.jsx(fhe,{header:"Revisit and edit previously repurposed projects",content:w.jsxs(w.Fragment,{children:["Find all suggested clips and projects you've created under each Repurpose Studio project.",w.jsx("div",{style:{marginTop:"12px"},children:w.jsx("i",{children:"Note: Repurpose Studio projects are marked with a video icon."})})]}),size:"small",open:0===t&&C,onClose:JK,sideOffset:8,side:"left",rainbowBorderOptions:cRe.rainbowBorderOptions,align:"start",children:w.jsx(Hje,{workspaceElement:G(e),onRename:null==K?void 0:K[t],dropdown:$(e._id),onClick:null==z?void 0:z[t]})},e._id)))),B()]})})})]});var Y})),mRe="SelectionModeToolbar-module_selectionModeToolbar_M4Jfx",pRe="SelectionModeToolbar-module_active_Ochr3",hRe="SelectionModeToolbar-module_actions_Ef78Z",gRe="SelectionModeToolbar-module_button_tbIbi",fRe="SelectionModeToolbar-module_icon_sBxIN",yRe=_.memo((({projectIds:e})=>{const t=xh(),o=Rge(),a=Ve(),i=tl((e=>e.explorer.folders));if(!t)return null;return w.jsxs("button",{className:gRe,onClick:async()=>{const{destinationFolder:t}=await o(e,Fge.WORKSPACE_BULK_MOVE);i.some((e=>e._id===t._id))&&(a.push(`/folder/${t._id}`),Nge({workspaceId:t._id,teamId:t.teamId}))},children:[w.jsx("div",{className:fRe,children:w.jsx(Ya,{})}),"Move"]})})),vRe=_.memo((({selectedProjectIds:e,exitSelection:t})=>{const o=tl((e=>e.workspaces.selectionMode)),a=e.length,i=ku(),s=e.length,n=`${e.length} ${Nc("item","items",s)} selected`;return w.jsxs("div",{className:`${mRe} ${o&&pRe}`,"data-cy":"selection-mode-toolbar",onMouseDown:e=>e.stopPropagation(),children:[w.jsx("p",{"data-cy":"selection-mode-toolbar-text",children:n}),w.jsxs("div",{className:hRe,children:[w.jsx(yRe,{projectIds:e}),w.jsxs("button",{onClick:()=>{var o,i;o="Delete",i=a,Fm(ym.MULTI_SELECT_PROJECT_MANAGEMENT_ACTION_INITIATED,{"Project Action":o,"Number of Projects":i}),nfe(e,t)},className:gRe,children:[w.jsx("div",{className:fRe,children:w.jsx(Ti,{})}),"Delete"]}),!i&&w.jsxs("div",{className:gRe,onClick:t,children:[w.jsx("div",{className:fRe,children:w.jsx(xi,{})}),"Cancel"]})]})]})})),_Re=_.memo((({initialProjectsLoaded:e,startFetchingProjects:t})=>{const o=h.useRef([]),[a,i]=h.useState({lastVerticalScroll:0,vertical:0,horizontal:0}),[s,n]=h.useState(),r=il(),l=ku(),d=(()=>{const e=Cu("(max-width: 980px)"),t=ku(),[o,a]=h.useState(e&&!t);return h.useEffect((()=>{const i=e&&!t;i!==o&&a(i)}),[o,e,t]),o})(),[c,u]=h.useState([]),{currentFolderId:m,boxSelectedIds:p,sharedWithMe:g,selectionMode:f}=tl((e=>{const t=e.workspaces.selectedWorkspace;return{currentFolderId:t,sharedWithMe:t===Vn,boxSelectedIds:e.studioLocal.boxSelectedIds,selectionMode:e.workspaces.selectionMode}}),ol),[y,v]=h.useState(!1),[b,T]=h.useState(!1),[x,S]=h.useState(0),[E,I]=h.useState([]),{workflows:C}=(({folderId:e})=>{const t=il(),o=tl((t=>{const o=t.workflows.workflowIdsByFolderId[e];if("success"===(null==o?void 0:o.status))return o.data.map((e=>t.workflows.folderWorkflowsById[e])).map((e=>"success"===(null==e?void 0:e.status)?e.data:void 0)).filter(Ir)}),ol),a=tl((t=>{var o;return null==(o=t.workflows.workflowIdsByFolderId[e])?void 0:o.status}));return h.useEffect((function(){void 0===a&&(t($L.folderWorkflowsFetchStarted(e)),async function(){const{workflows:o}=await Yr(`/api/v2/workflows/folder/${e}`);t($L.folderWorkflowsFetched({folderId:e,workflows:o}))}().catch((o=>{t($L.folderWorkflowsFetchError({folderId:e,error:o.message}))})))}),[t,a,e]),{workflows:o,isLoading:!a||"fetching"===a}})({folderId:m}),k=h.useCallback((e=>e&&m!==Vn?(o.current=Array(e.length).fill(null).map(((e,t)=>o.current[t]||_.createRef())),e.map(((e,t)=>{var a;const i=null==(a=o.current[t])?void 0:a.current;if(!i)return e;const{top:s,left:n,width:r,height:l}=i.getBoundingClientRect(),d={top:s+window.scrollY,left:n+window.scrollX,width:r,height:l};return{...e,position:d}}))):[]),[m,o]),A=h.useCallback((()=>{u([]),n(void 0),r(ub(!1))}),[r]),j=h.useCallback((()=>{b&&(v(!1),T(!1))}),[b]),N=h.useCallback((()=>{if(y){const e=Object.keys(p);T(!0),u(e),r(ub(e.length>0))}}),[p,r,y]),R=h.useCallback((()=>{if(b){const e=window.scrollY-a.lastVerticalScroll;0!==a.lastVerticalScroll&&(a.vertical+=e),N(),a.lastVerticalScroll=window.scrollY}else S(-1*window.scrollY)}),[N,a,b]),P=h.useCallback((e=>{I(k(e))}),[k]),D=h.useCallback((e=>{if(!(m===Vn)&&f&&(e.ctrlKey||e.metaKey)&&"a"===e.key){e.preventDefault();const t=E.map((e=>e._id));r(ub(t.length>0)),u(t)}}),[m,r,f,E]),O=h.useCallback((()=>{i({vertical:0,horizontal:0,lastVerticalScroll:0})}),[]),L=h.useCallback((e=>{const t=o.current.some((t=>{var o;return null==(o=null==t?void 0:t.current)?void 0:o.contains(e.target)}));0!==e.button||g||t||(n({x:e.clientX,y:e.clientY}),v(!0))}),[o,g]),F=h.useCallback((()=>{!b&&y&&A(),S(-1*window.scrollY),O(),T(!1),v(!1)}),[O,A,y,b]),M=h.useCallback(((e,t,o=!1)=>{let a=[];if(a=t?[...c,e]:c.filter((t=>t!==e)),o){const t=E.findIndex((t=>t._id===e)),o=E.findIndex((e=>e._id===c[c.length-1])),i=Math.min(t,o),s=Math.max(t,o),n=E.filter(((e,t)=>t>=i&&t<=s&&!a.includes(e._id))).map((e=>e._id));a=[...a,...n]}u(a),r(ub(a.length>0))}),[r,c,E]),U=h.useCallback((()=>{n(void 0)}),[]);return h.useEffect((function(){(l||d)&&r(ub(!1))}),[r,d,l]),h.useEffect((function(){r({type:"RESET_EDITOR"}),r({type:"RESET_STUDIO"}),A()}),[r,A]),h.useEffect((function(){return window.addEventListener("mouseup",j),window.addEventListener("scroll",R),()=>{window.removeEventListener("mouseup",j),window.removeEventListener("scroll",R)}}),[j,R,k,E]),w.jsxs("div",{onMouseDown:L,onMouseMove:N,onMouseUp:F,onKeyDown:D,className:NIe,children:[w.jsxs("div",{className:RIe,children:[w.jsx(uRe,{projectElementRefs:o.current,selectedProjectIds:c,onSelectProject:M,setUnlockedProjectsArray:P,initialProjectsLoaded:e,startFetchingProjects:t,workflows:C}),E.length>0&&!g&&s&&w.jsx(d4,{boxSelectStartCoords:s,setBoxSelectStartCoordsToNull:U,containerOffsetX:0,containerOffsetY:x,autoScrollDisplacement:a,unlockedProjectsArray:E,location:"workspace"})]}),w.jsx(vRe,{selectedProjectIds:c,exitSelection:A}),w.jsx(cNe,{})]})})),wRe=Object.freeze(Object.defineProperty({__proto__:null,default:_Re},Symbol.toStringTag,{value:"Module"})),bRe="SearchPage-module_searchPageWrapper_eacpM",TRe="SearchPage-module_innerWrapper_lSF4m",xRe="SearchPage-module_query_jUVJv",SRe="SearchPage-module_numResults_JZ6Ix",ERe="SearchPage-module_projectsWrapper_2vN05",IRe="SearchPage-module_queryWrapper_LNXnh",CRe="SearchPage-module_closeButton_I3fZY",kRe="SearchPage-module_emptyProject_55Ke-",ARe="SearchPage-module_loader_l-nEN",jRe="SearchPage-module_header_M1IH4",NRe="SearchPage-module_searchFieldWrapper_y1W2p",RRe="SearchPage-module_searchIcon_2MgLE",PRe="SearchPage-module_inputEl_1mEnZ",DRe="SearchPage-module_clearSearch_F4Qna",ORe="SearchPage-module_noResults_FY55K",LRe=_.memo((({searchResult:e,onDelete:t})=>{const o=il(),[a,i]=h.useState((e=>e.searchType!==HCe.RECENT_SEARCH?e.data.name||(e.searchType===HCe.BRANDKIT_TEMPLATE?"Untitled Template":An):e.data.query)(e)),s=tl((e=>e.currentUser)),n=Ve(),r=NU(Bl.UNLIMITED_STORAGE),l=NU(Bl.BRANDKIT),d=e.searchType===HCe.BRANDKIT_TEMPLATE||e.searchType===HCe.VIDEO,c=!r&&e.searchType===HCe.VIDEO&&e.data.locked,u=d&&e.data.lastEditorName||"Anonymous User",m=d&&e.data.folderName,p=h.useCallback((()=>{nfe([e.data._id],(()=>{t&&t(e.data._id)})),t(e.data._id)}),[t,e.data._id]);let g=d?`/${e.data.videoId}/studio/editor`:`/folder/${e.data._id}`;e.searchType===HCe.WORKFLOW&&(g=`/repurpose/${e.data._id}`);const f=d&&e.data.folderId,y=h.useCallback((()=>{const e=[];return u&&e.push({label:u}),m&&f&&e.push({label:m,linkAddress:`/folder/${f}`}),e}),[u,m,f]),v=d?e.data.thumbnailUrl:void 0,_=h.useMemo((()=>({elementType:e.searchType,title:a,thumbnailUrl:v,linkAddress:g,locked:c,subtitles:y()})),[y,c,g,e.searchType,v,a]),b=h.useMemo((()=>d?[{icon:w.jsx(Si,{}),label:"Open in folder",onClick:()=>{n.push(`/folder/${f}`)},type:tCe.Generic},{icon:w.jsx(fa,{}),label:"Delete",onClick:p,type:tCe.Generic}]:[]),[p,n,d,f]);let T;!r&&c?T=Vl.STORAGE_LIMIT:l||e.searchType!==HCe.BRANDKIT_TEMPLATE||(T=Vl.BRANDKIT);const x=h.useCallback((async t=>{if(d){const n=t.trim();n.length&&n!==a&&(e.searchType===HCe.BRANDKIT_TEMPLATE?(i(n),TK(e.data._id,{name:n},s)):(i(n),TK(e.data._id,{name:n},s),o(hO({projectId:e.data._id,name:n}))))}else e.searchType===HCe.FOLDER&&(i(t),o(nb({workspaceId:e.data._id,newName:t})),xK(e.data._id,{name:t}))}),[a,e.searchType,e.data._id,s,d,o]);return w.jsx(Hje,{workspaceElement:_,dropdown:b,onRename:x,paywallModalAction:T})})),FRe="LoadingShimmer-module_loadingShimmer_ePPBL",MRe="LoadingShimmer-module_lightShimmer_oMncV",URe=_.memo((({height:e,borderRadius:t,theme:o,widthPct:a})=>{const i={height:`${e}px`,borderRadius:`${t}px`,width:`${a??100}%`};return w.jsx("div",{className:o===RF.Workspace?MRe:FRe,style:i})}));function BRe(e,t){const[o,a]=h.useState(e);return h.useEffect((()=>{const o=setTimeout((()=>{a(e)}),t);return()=>{clearTimeout(o)}}),[e,t]),o}const VRe="RecentSearches-module_title_-CAm0",WRe="RecentSearches-module_icon_LXHJC",GRe="RecentSearches-module_recentSearches_hc6-t",HRe="RecentSearches-module_recentSearchesHeader_VRQmD",$Re="RecentSearches-module_result_ydgbx",KRe="RecentSearches-module_empty_tmsCu",zRe=_.memo((({handleSearch:e})=>{const[t,o]=h.useState([]),a=Ac(),[i,s]=h.useState(!0);h.useEffect((function(){!async function(){try{s(!0);const e=await Yr(`/api/v2/search/${a._id}/recent`);o(e.data),s(!1)}catch(IGe){o([]),s(!1)}}()}),[a._id]);return t&&t.length?w.jsx("div",{className:GRe,children:w.jsxs("div",{className:HRe,children:[w.jsx("div",{className:VRe,children:"Recent Searches"}),t.map(((t,o)=>w.jsxs("div",{className:$Re,onClick:()=>(t=>{e(t.data.query)})(t),"data-cy":"recent-search",children:[w.jsx(Ei,{fontSize:12,className:WRe}),t.data.query]},o)))]})}):i?null:w.jsx("div",{className:KRe,children:"Get started with searching your workspace by using the bar above. Type a query to find videos, projects, folders, and more."})})),YRe=_.memo((()=>{const e=be(),t=new URLSearchParams(e.search).get("q"),[o,a]=h.useState(t||""),i=Ac(),[s,n]=h.useState(!1),[r,l]=h.useState([]),[d,c]=h.useState(0),u=h.useRef(null),m=BRe(o,500),p=h.useCallback((async e=>{const t=new AbortController;if(e&&e.length)try{n(!0);const o=await Kr(`/api/v2/search/${i._id}/results`,{params:{query:e},signal:t.signal});n(!1),l(o.objects),c(o.totalCount),window.history.pushState("","",`/search/${i._id}?q=${e}`)}catch(o){if(n(!1),"AbortError"===o.name)return;console.error(o)}}),[i._id]),g=async e=>{a(e),n(!0)};h.useEffect((()=>{p(m)}),[m,p]),h.useEffect((()=>{u.current&&u.current.focus()}),[]);const f=h.useCallback((e=>{l(r.filter((t=>t.data._id!==e))),c(d-1)}),[r,d]),y=h.useCallback((()=>{l([]),a(""),n(!1),window.history.pushState("","","/search")}),[]);h.useEffect((()=>{o||y()}),[o,y]);const v=h.useCallback((()=>{u.current&&u.current.focus()}),[u]);return w.jsxs("div",{className:bRe,"data-cy":"search-page",children:[w.jsx("div",{className:jRe,children:w.jsxs("div",{className:NRe,onClick:v,children:[w.jsx(Ei,{className:RRe}),w.jsx("input",{ref:u,className:PRe,type:"text",placeholder:"Search",value:o,"data-cy":"workspace-search-input",onChange:e=>{e.target.value&&n(!0),a(e.target.value)}}),s&&!!o.length&&w.jsx("div",{children:w.jsx(eme,{})}),!!o.length&&w.jsx("div",{"data-cy":"workspace-search-clear",className:DRe,onClick:()=>{a(""),l([])},children:w.jsx(Ii,{fontSize:18})})]})}),o.length||r.length||s?null:w.jsx(zRe,{handleSearch:g}),w.jsxs("div",{className:TRe,children:[!!o.length&&w.jsxs("div",{className:IRe,children:[w.jsxs("div",{className:xRe,children:['Search results for "',o,'"']}),w.jsx("div",{className:CRe,onClick:y,children:"Clear"})]}),!s&&r.length&&d?w.jsxs("div",{className:SRe,children:["Showing ",r.length," of ",d," results:"]}):null,s&&w.jsxs("div",{className:SRe,children:[w.jsx("span",{children:"Loading..."})," ",w.jsx("div",{className:ARe})]}),s?w.jsxs("div",{className:ERe,children:[w.jsx("div",{className:kRe,children:w.jsx(URe,{height:177.5,borderRadius:5,theme:RF.Workspace})}),w.jsx("div",{className:kRe,children:w.jsx(URe,{height:177.5,borderRadius:5,theme:RF.Workspace})}),w.jsx("div",{className:kRe,children:w.jsx(URe,{height:177.5,borderRadius:5,theme:RF.Workspace})})]}):r.length?w.jsx("div",{className:ERe,"data-cy":"search-results",children:r.map((e=>w.jsx("span",{"data-cy":"search-result",children:w.jsx(LRe,{searchResult:e,onDelete:f})},e.data._id)))}):o.length?s?null:w.jsxs("div",{className:ORe,"data-cy":"no-search-results-container",children:['No results found for "',o,'". Try searching for something else.']}):null]})]})})),JRe="WorkspaceSidebar-module_sideBarContainer_Qb-lx",qRe="WorkspaceSidebar-module_sideHeader_0ugQw",XRe="WorkspaceSidebar-module_personalFoldersHeader_A5JVM",QRe="WorkspaceSidebar-module_sideHeaderCopy_8pxYT",ZRe="WorkspaceSidebar-module_addFolderButton_HAuvU",ePe="WorkspaceSidebar-module_addFolderIcon_mUlIy",tPe="WorkspaceSidebar-module_svgSparkle_3uAbR",oPe="WorkspaceSidebar-module_top_3T8Um",aPe="WorkspaceSidebar-module_bottom_3iFS6",iPe="WorkspaceSidebar-module_folders_04tMC",sPe="WorkspaceSidebar-module_mobileControl_kG4bg",nPe="WorkspaceSidebar-module_sidebarIcon_7mK4E",rPe="WorkspaceSidebar-module_mobileBackground_lNV62";function lPe({onHide:e,folderType:t}){const o=Ve(),[a,i]=h.useState(!1),[s,n]=h.useState(null),[r,l]=h.useState(""),d=h.useCallback((()=>{a||(e(),s&&o.push(`/folder/${s}`))}),[o,a,s,e]),c=e=>{l(e.target.value)},u=async()=>{i(!0);const e=(await GP(r,t))._id;n(e),i(!1),d()};return w.jsx(nM,{usePortal:!0,noScrollBar:!0,unsetCancelModal:d,children:w.jsxs(w.Fragment,{children:[w.jsx("div",{className:nSe.modal}),w.jsxs("div",{className:nSe.mainContent,"data-testid":t===kn.personal?"workspace-create-folder-modal-personal":"workspace-create-folder-modal-team",children:[w.jsx("div",{className:nSe.header,children:"Create a New Folder"}),w.jsx("label",{className:nSe.inputLabel,children:w.jsx("form",{onSubmit:e=>{e.preventDefault(),u()},children:w.jsx("input",{type:"text",className:nSe.textInput,value:r||"",onChange:c,placeholder:"Untitled Folder",readOnly:a,autoFocus:!0,"data-cy":"new-workspace-input"})})})]}),w.jsx(GF,{confirmFn:u,loadingMsg:a?"Loading...":void 0,confirmText:"Finish",cancelText:"Back",cancelFn:void 0})]})})}const dPe="SidebarItem-module_sidebarItem_FZFiA",cPe="SidebarItem-module_label_fFXuP",uPe="SidebarItem-module_contentContainer_ycWoV",mPe="SidebarItem-module_wrapper_YlFd6",pPe="SidebarItem-module_sparkle_ADuCq",hPe="SidebarItem-module_icon_Djxrt",gPe="SidebarItem-module_selected_5O9RF",fPe=_.memo((({hrefOrOnClick:e,testId:t,folderId:o,children:a})=>"string"==typeof e?"/"===e[0]?w.jsx(Ft,{to:e,"data-cy":t,"data-testid":t,"data-folder-id":o,children:a}):w.jsx("a",{href:e,"data-cy":t,"data-testid":t,"data-folder-id":o,children:a}):w.jsx("div",{onClick:e,"data-cy":t,"data-testid":t,"data-folder-id":o,children:a})));fPe.displayName="LinkOrButtonWrapper";const yPe=_.forwardRef(((e,t)=>{const{selected:o=!1,testId:a,label:i,hrefOrOnClick:s,icon:n,sparkle:r,arrow:l,folderId:d,...c}=e;return w.jsx("div",{ref:t,...c,className:mPe,children:w.jsx(fPe,{hrefOrOnClick:s,testId:a,folderId:d,children:w.jsxs("div",{className:mt(dPe,{[gPe]:o}),children:[w.jsxs("div",{className:uPe,children:[n&&w.jsx("div",{className:hPe,children:n}),w.jsx("span",{className:cPe,children:i}),r&&w.jsx(EW,{className:pPe})]}),l&&w.jsx("div",{className:hPe,children:w.jsx(Ua,{})})]})})})})),vPe=_.memo(yPe),_Pe=w.jsx(ei,{}),wPe=w.jsx(ei,{}),bPe=_.memo((({folderId:e,folderName:t,dataCy:o,isPrivate:a=!1})=>{const i=be(),s=tl((e=>e.workspaces.selectedWorkspace)),n=h.useCallback((()=>{k9(e)}),[e]);let r="workspace-sidebar-link";return o&&(r=o),w.jsx(vPe,{testId:r,folderId:e,selected:s===e&&i.pathname.includes("/folder"),label:t,icon:a?wPe:_Pe,hrefOrOnClick:n})})),TPe="HeaderLinks-module_headerBarEmpty_dN408",xPe=w.jsx(hi,{}),SPe=w.jsx(ti,{}),EPe=w.jsx(Ci,{}),IPe=_.memo((()=>{const{selectedTeamId:e}=tl((e=>({selectedTeamId:e.teams.selectedTeamId})),ol),t=be(),o=NU(Bl.BRANDKIT);return w.jsx("div",{className:TPe,children:w.jsxs(w.Fragment,{children:[w.jsx(vPe,{selected:t.pathname.includes("/search"),label:"Search",icon:xPe,hrefOrOnClick:"/search"}),w.jsx(vPe,{selected:t.pathname.includes("/brandkit"),label:"Brand Kit",icon:SPe,sparkle:!o,testId:"brandkit-button",hrefOrOnClick:"/brandkit"}),w.jsx(vPe,{selected:t.pathname.includes("/team/")&&(t.pathname.includes("/settings")||t.pathname.includes("/billing")),label:"Settings",icon:EPe,testId:"team-settings-link",hrefOrOnClick:`/team/${e}/settings`})]})})})),CPe="AccountInfo-module_wrapper_2rMZr",kPe="AccountInfo-module_container_3f4lq",APe="AccountInfo-module_imageContainer_ZYaaV",jPe="AccountInfo-module_profileImage_sCgFj",NPe="AccountInfo-module_text_fKHeh",RPe="AccountInfo-module_name_Rl36n",PPe="AccountInfo-module_email_GDov2",DPe=_.memo((({openAccountSettings:e})=>{const{currentUser:t}=tl((e=>({currentUser:e.currentUser})),ol),o=Ec(t),a=Ic(t);return w.jsx("div",{className:CPe,"data-testid":"ws-header-signin-container",onClick:()=>{null==e||e()},children:w.jsxs("div",{className:kPe,"data-cy":"account-nav-link","data-testid":"ws-header-account-link",children:[w.jsx("div",{className:APe,children:w.jsx(b9,{suggestedWidth:80,suggestedHeight:80,className:jPe})}),w.jsxs("div",{className:NPe,children:[w.jsx("div",{className:RPe,"data-testid":"ws-header-name-container",children:w.jsx("span",{translate:"no",children:o})||"My Account"}),a&&w.jsx("div",{className:PPe,"data-testid":"ws-header-email-container",children:a})]})]})})})),OPe="FloatingLinkMenu-module_openButton_kIXkr",LPe="FloatingLinkMenu-module_label_P8ZZ8",FPe="FloatingLinkMenu-module_linkMenu_Y6bvR",MPe="FloatingLinkMenu-module_linkSection_wqHHm",UPe="FloatingLinkMenu-module_icon_Ltjqe",BPe=()=>{const e=tl((e=>e.currentUser));return e.user.accountType===Mn.admin||Kp(e)},VPe="AdminDebugContext-module_table_4oUdt",WPe="AdminDebugContext-module_center_oHy-i",GPe=_.memo((()=>{const[e,t]=h.useState({x:0,y:0}),o=h.useRef(!1),a=h.useRef({x:0,y:0}),i=tl((e=>Hu(e))),s=h.useCallback((()=>{o.current=!1}),[]),n=h.useCallback((e=>{if(o.current){const o=e.clientX-a.current.x,i=e.clientY-a.current.y;t((e=>({x:e.x+o,y:e.y+i}))),a.current={x:e.clientX,y:e.clientY}}}),[]);h.useEffect((function(){return window.addEventListener("mousemove",n),window.addEventListener("mouseup",s),()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",s)}}),[n,s]);const r=_Q();return w.jsxs("div",{style:{position:"fixed",left:`${e.x}px`,top:`${e.y}px`,border:"1px solid black",background:"white",zIndex:1e3},children:[w.jsx("div",{onMouseDown:e=>{o.current=!0,a.current={x:e.clientX,y:e.clientY}},style:{cursor:"move",backgroundColor:"grey",color:"white"},className:WPe,children:"Admin Debug Tools"}),w.jsxs("div",{style:{padding:10},children:[w.jsx("div",{children:"Set team limits"}),w.jsxs("table",{className:VPe,children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{children:"Category"}),w.jsx("th",{children:"Limit"}),w.jsx("th",{children:"Usage"}),w.jsx("th",{children:"Remaining"}),w.jsx("th",{children:"Reset limit"}),w.jsx("th",{children:"Set limit > 50%"}),w.jsx("th",{children:"Set limit > 90%"}),w.jsx("th",{children:"Set limit 100%"})]})}),w.jsx("tbody",{children:Object.entries(r).map((([e,t])=>{async function o(o){const a=o*t.limitForPlan,{dispatch:s}=sr();if((null==i?void 0:i._id)===vc._id||!i)return;const n=(await Jr(`/api/v1/admin/teams/${i._id}/limits`,{body:{updates:{[e]:a}}})).updatedLimits;s(jp(i._id,{...i,limits:n}))}return w.jsxs("tr",{children:[w.jsx("td",{children:Lc[e].name}),w.jsx("td",{children:t.limitForPlan}),w.jsx("td",{children:t.usage}),w.jsx("td",{children:t.remainingUsage}),w.jsx("td",{children:w.jsx("button",{type:"button",className:WPe,onClick:()=>o(0),children:"reset"})}),w.jsx("td",{children:w.jsx("button",{type:"button",className:WPe,onClick:()=>o(.51),children:"> 50%"})}),w.jsx("td",{children:w.jsx("button",{type:"button",className:WPe,onClick:()=>o(.91),children:"> 90%"})}),w.jsx("td",{children:w.jsx("button",{type:"button",className:WPe,onClick:()=>o(1),children:"100%"})})]},e)}))})]}),w.jsx("div",{children:w.jsx("button",{type:"button",onClick:async()=>{i&&(await Jr(`/api/v1/admin/teams/${i._id}/reset-dismissals`,{parseJSON:!1}),nW())},children:"Reset team user dismissals"})})]})]})})),HPe=h.createContext({debugEnabled:!1,toggleDebugEnabled:()=>{}}),$Pe=_.memo((({children:e})=>{const[t,o]=h.useState(!1),a=BPe(),i=h.useMemo((()=>({debugEnabled:t,toggleDebugEnabled:()=>o(!t)})),[t]);return w.jsxs(HPe.Provider,{value:i,children:[w.jsx(w.Fragment,{children:e}),a&&t&&w.jsx(GPe,{})]})})),KPe=w.jsx(ki,{}),zPe=_.memo((()=>{const[e,t]=h.useState(!1),[o,a]=h.useState(!1),i=Pr(),s=ou(),n=[h.useMemo((()=>[{name:"Tools",href:"/tools",target:"_self"},{name:"Templates",href:"/templates",target:"_self"},{name:"Help Center",href:"https://www.kapwing.com/help"},{name:"Resources",href:"https://www.kapwing.com/resources"},{name:"Kapwing Youtube",href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1"},{name:"Blog",href:"https://www.kapwing.com/blog"},{name:"Release Notes",href:"https://www.kapwing.com/help/tag/release-notes/"},{name:"Contact Us",href:"/contact-us"}]),[]),h.useMemo((()=>[{name:"Careers",href:"/careers"},{name:"Partnerships",href:"/partnerships"},{name:"Creators Fund",href:"/creators-fund"},{name:"Affiliates",href:"/partnerships"}]),[]),h.useMemo((()=>[{name:"Refund Policy",href:"/policies/refund"},{name:"Privacy Policy",href:"/policies/privacy"},{name:"Terms of Service",href:"/policies/terms-of-service"}]),[])],r=BPe(),{debugEnabled:l,toggleDebugEnabled:d}=h.useContext(HPe),c=h.useRef(null),u=h.useCallback((e=>{const{target:o}=e;c.current&&o instanceof Node&&c.current.contains(o)||t(!1)}),[]);h.useEffect((()=>e?(document.addEventListener("mouseup",u),()=>document.removeEventListener("mouseup",u)):()=>{}),[u,e]);const m=h.useCallback((()=>{a(!1)}),[]),p=(e,t)=>{const{name:o,href:a,target:i="_blank"}=e;return w.jsx("a",{target:i,rel:"noreferrer",href:a,children:o},t)},g=w.jsxs("div",{className:FPe,children:[s.isPaid&&w.jsx("div",{className:MPe,children:w.jsx("div",{onClick:()=>{a(!0),t(!1)},children:"Report a Problem"})}),n.map(((e,t)=>w.jsx("div",{className:MPe,children:e.map(p)},t))),r&&w.jsx("div",{className:MPe,children:w.jsx("div",{onClick:()=>{d(),t(!1)},children:(l?"Disable":"Enable")+" Debug Mode"})}),w.jsxs("span",{children:["© ",(new Date).getFullYear()," Kapwing. Release ","v2023.12.22.1","—",i,"."]})]}),f=w.jsxs("button",{className:OPe,type:"button",onClick:()=>{t(!e)},children:[w.jsx("div",{className:UPe,children:KPe}),w.jsx("div",{className:LPe,children:"Help and Resources"})]});return w.jsxs("div",{ref:c,children:[o&&w.jsx(u_e,{hide:m,fromWorkspace:!0}),e&&g,f]})})),YPe="MoreLinks-module_wrapper_koQFT",JPe=w.jsx(Ai,{}),qPe=_.memo((({openAccountSettings:e})=>{const t=be(),o=h.useCallback((()=>{(e=>{const{history:t,dispatch:o}=sr();Fm(ym.OPEN_SHARED_WITH_ME,{location:e}),o(ib(Vn)),t.push("/shared-with-me")})("Sidebar")}),[]);return w.jsxs("div",{className:YPe,children:[w.jsx(sU,{message:"Projects that others have shared with you will appear here.",children:w.jsx(vPe,{label:"Shared with Me",testId:"shared-with-me-nav",icon:JPe,hrefOrOnClick:o,selected:t.pathname.includes("/shared-with-me")})}),w.jsx(zPe,{}),w.jsx(DPe,{openAccountSettings:e})]})})),XPe="LimitWarning-module_upsellWarningBlockContainer_afSkv",QPe="LimitWarning-module_featureOut_KuEcZ",ZPe="LimitWarning-module_warningIcon_GJeY7",eDe="LimitWarning-module_button_JvDcm",tDe="LimitWarning-module_outerSpacerBlock_vIEPS",oDe="LimitWarning-module_warning_8Q8hw",aDe="LimitWarning-module_body_aUupy",iDe="LimitWarning-module_close_clk9i",sDe="LimitWarning-module_upsellBlock_dLKCT";function nDe(e){var t,o;const a=Ac(),i=tl((e=>e.currentUser.user)),{openEnterpriseTypeform:s}=sW(),n=_Q(),r=tl(yQ),[l,d]=h.useState(!1),c=h.useCallback((async()=>{await Jr(`/api/v2/teams/${a._id}/enterprise-form-dismissal`,{body:{userId:i._id},parseJSON:!1}),Lp()}),[a._id,i._id]),u=null==(t=Object.entries(n).find((([e,t])=>t.hasConsumedLimit&&Lc[e].showWarnings)))?void 0:t[0],m=null==(o=Object.entries(n).find((([e,t])=>t.is90PercentConsumed&&!t.hasConsumedLimit&&Lc[e].showWarnings)))?void 0:o[0],p=u||m,g=!!u,f=u||m&&!r;return h.useEffect((function(){f&&!l&&(Fm(ym.ENTERPRISE_USAGE_UI_SHOWN,{"Limit Exceeded":p,"Team ID":a._id,touchPoint:e}),d(!0))}),[f,a._id,e,l,p]),{shouldShow:!!f,showEnterprise:bP(a.planTier),feature:p,dismiss:c,openEnterpriseTypeform:s,usageAtLimit:g}}const rDe=_.memo((()=>{const{shouldShow:e,usageAtLimit:t,dismiss:o,openEnterpriseTypeform:a,feature:i,showEnterprise:s}=nDe("Workspace Block"),n=bW(),r=ou(),l=r.upgradesTo?$c(r.upgradesTo):null,{subscription:d}=pM(),c=NU(Bl.CREATE_NEW_FOLDER);if(!e||!i||!l)return c||(null==d?void 0:d.cancel_at_period_end)?null:w.jsx("div",{className:sDe,children:w.jsx(Nie,{action:Vl.SIDEBAR,topLeftImg:!0,testId:"workspace-sidebar-upsell-block"})});const{name:u,unit:m}=Lc[i],p=t?"You've reached a workspace limit":`You're running\n  out of ${u} ${m}s`,h=`You've${t?"":" almost"} used up your ${u} ${m}s for this month.\n  To get more auto ${u} ${m}s, ${s?"get in touch with us.":r.type===Cl.Free?"upgrade to one of our paid plans.":`upgrade to the ${l.name} plan.`}`;return w.jsx("div",{"data-cy":"pro-limit-warning",className:`${tDe} ${t?QPe:""}`,children:w.jsxs("div",{className:XPe,children:[w.jsxs("div",{className:oDe,children:[w.jsx("div",{className:ZPe,children:t?w.jsx(ji,{}):w.jsx(Ni,{})}),w.jsx("div",{children:p}),!t&&w.jsx("div",{className:iDe,onClick:o,children:w.jsx(ve,{})})]}),w.jsx("span",{className:aDe,children:h}),w.jsx(Iie,{className:eDe,onClick:s?a:n((()=>{}),{action:Vl.LIMITS_WARNING}),buttonText:s?"Contact sales":"Upgrade now"})]})})})),lDe="InvitesPopover-module_header_P9PX4",dDe="InvitesPopover-module_teamName_p9pSC",cDe="InvitesPopover-module_infoTooltip_kA6xD",uDe="InvitesPopover-module_inviteRow_vlejs",mDe="InvitesPopover-module_actionsContainer_FwUNB",pDe="InvitesPopover-module_accept_zkQA9",hDe="InvitesPopover-module_delete_zJt5S",gDe="InvitesPopover-module_smallProfilePicture_g8ubK",fDe="InvitesPopover-module_mobileInvites_olX26",yDe=w.jsx(Ri,{}),vDe=_.memo((({invite:e})=>{const{acceptInvite:t}=gpe(),{team:o}=e,a=h.useCallback((()=>{I9(e.team._id)}),[e.team._id]),i=h.useCallback((()=>{t(e.inviteKey,hpe.WORKSPACE_DROPDOWN,{onSuccess:a})}),[t,a,e.inviteKey]),s=h.useCallback((()=>{!async function(e){const{dispatch:t,state:o}=sr(),{teams:a}=o,{userTeamInvites:i=[]}=a,s={inviteId:e._id};try{await zr("/api/v1/invites/teams",{body:s,parseJSON:!1}),t(Ap([...i].filter((t=>t._id!==e._id))))}catch(IGe){console.error(IGe)}}(e)}),[e]);return w.jsxs("div",{className:uDe,"data-testid":"workspace-selector-invite",children:[w.jsx(b9,{team:o,className:gDe}),w.jsx("div",{className:dDe,children:o.name}),w.jsxs("div",{className:mDe,children:[w.jsx(Iie,{testId:"invite-join-button",buttonText:"Join",className:pDe,onClick:i}),w.jsx(Iie,{icon:yDe,className:hDe,onClick:s})]})]})})),_De=_.memo((({invites:e,tooltipPosition:t={x:0,y:0}})=>{const o=ku(),a=_.useRef(null),i=h.useCallback((e=>{o||e.stopPropagation()}),[o]);if(!e||!e.length)return w.jsx(w.Fragment,{});return w.jsxs("div",{className:o?fDe:cDe,style:o?{}:{left:t.x,top:t.y},onClick:i,"data-testid":"invite-actions",ref:a,children:[w.jsx("div",{className:lDe,children:"Your Workspace Invitations"}),e.map((e=>w.jsx(vDe,{invite:e},e._id)))]})})),wDe="WorkspaceInvites-module_newBadge_Sgdj-",bDe="WorkspaceInvites-module_buttonLeft_-jieq",TDe="WorkspaceInvites-module_button_60VNg",xDe=_.memo((({invites:e,visiblePopover:t,setVisiblePopover:o})=>{const a=ku(),[i,s]=h.useState(!1),[n,r]=h.useState({x:0,y:0}),l=h.useCallback((e=>{const t=e.currentTarget.getBoundingClientRect(),{x:o}=t,a=t.top;r({x:o+200,y:a})}),[]);h.useEffect((()=>{"WorkspaceInvite"!==t&&s(!1)}),[t]);const d=h.useCallback((()=>{i?(s(!1),o("None")):(s(!0),o("WorkspaceInvite"))}),[i,o]);return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:bDe,onClick:d,onMouseEnter:l,"data-testid":"workspace-invites-button",children:[w.jsx("div",{className:TDe,children:"Workspace Invitations"}),w.jsx("div",{className:wDe,children:e.length})]}),a||i&&"WorkspaceInvite"===t?w.jsx(_De,{invites:e,tooltipPosition:n}):void 0]})})),SDe="SuggestedWorkspacesAction-module_disabled_0LHKs",EDe="SuggestedWorkspacesAction-module_swTeamName_I5Fql",IDe="SuggestedWorkspacesAction-module_suggestedWorkspaceHeader_vzleq",CDe="SuggestedWorkspacesAction-module_suggestedWorkspaceTooltip_CRB9r",kDe="SuggestedWorkspacesAction-module_swTeamsContainer_b6BkH",ADe="SuggestedWorkspacesAction-module_smallProfilePicture_uM-n0",jDe="SuggestedWorkspacesAction-module_infoTooltip_oIbqA",NDe="SuggestedWorkspacesAction-module_checkmark_BaJI2",RDe="SuggestedWorkspacesAction-module_suggestedWorkspaceButton_tHxXe",PDe="SuggestedWorkspacesAction-module_actionsContainer_ZlZ7j",DDe="SuggestedWorkspacesAction-module_deleteSuggestionButton_w0RZ1",ODe=w.jsx(Ri,{}),LDe=_.memo((({suggestedWorkspaces:e,close:t,tooltipPosition:o={x:0,y:0}})=>{const{currentUser:a,teamEmailDomain:i}=tl((e=>{var t,o;return{currentUser:e.currentUser,teamEmailDomain:null==(o=null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.teams[0])?void 0:o.emailDomain}}),ol),s=il(),n=ku(),[r,l]=h.useState([]),d=h.useRef(null);h.useEffect((function(){(async()=>{const e=await nD();l(e.map((e=>e.teamId)))})()}),[]);const c=h.useCallback((async t=>{try{const o=null==e?void 0:e.teams.filter((e=>e._id!==t));s(gb({isQualifiedDomain:(null==e?void 0:e.isQualifiedDomain)??!1,teams:o??[]})),await Jr("/api/v2/teams/deleteSuggestion",{body:{teamId:t}})}catch(IGe){console.error(IGe)}}),[s,null==e?void 0:e.isQualifiedDomain,null==e?void 0:e.teams]),u=async t=>{await oD(t),(async(e,t,o)=>{const a=await Fp(t,o,!1),{interval:i,status:s}=await gM(),n=au(),r={"Team ID":a._id,"Entry Point":e,"Number of Workspace Members":a.numberOfUsers,"Current Plan":n.type,"Monthly/Annual":i,"Subscription Status":s,"Quantity Legacy Members":0};Fm(ym.REQUEST_TO_JOIN,r)})(WM.Sidebar,t,a),(()=>{const o=null==e?void 0:e.teams.map((e=>(e._id===t&&(e.requestSent=!0),e)));s(gb({teams:o??[],isQualifiedDomain:(null==e?void 0:e.isQualifiedDomain)??!1}))})(),l((e=>[...e,t])),setTimeout((()=>{c(t)}),3e3)},m=e=>{var o;switch(null==(o=e.settings)?void 0:o.discoverability){case cd.AnyoneCanJoin:return()=>(async e=>{try{if(!(await Jr(`/api/v2/teams/${e}/join`)).success)throw new Error;s(wl({description:"Successfully joined team.",type:"success"})),Op(),s(Ip(e)),await I9(e),await c(e),t()}catch(o){mh({description:"Something went wrong with joining the team, please try again later.",error:o})}})(e._id);case cd.RequestToJoin:default:return()=>u(e._id)}},p=e=>{var t;if(e.requestSent||r.includes(e._id))return w.jsxs("div",{children:[w.jsx(Pi,{className:NDe}),"Request Sent"]});switch(null==(t=e.settings)?void 0:t.discoverability){case cd.AnyoneCanJoin:return"Join";case cd.RequestToJoin:default:return"Ask to Join"}},g=e=>e.requestSent||r.includes(e._id)?SDe:RDe,f=h.useMemo((()=>null==e?void 0:e.teams.reduce(((e,t)=>(e[t._id]=()=>c(t._id),e)),{})),[c,null==e?void 0:e.teams]);return w.jsx("div",{className:n?"":jDe,style:{left:o.x,top:d.current?o.y-d.current.clientHeight/2<0?o.y+(d.current.clientHeight/2-20):o.y+d.current.clientHeight/2>window.innerHeight?o.y-(d.current.clientHeight/2-20):o.y:o.y},onClick:e=>{n||e.stopPropagation()},ref:d,children:w.jsxs("div",{className:CDe,children:[w.jsxs("div",{className:IDe,children:["Suggested Workspaces"," ",i?`for ${i}`:""]}),e.teams.map((e=>w.jsxs("div",{className:kDe,children:[w.jsx(b9,{team:e,className:ADe}),w.jsx("div",{className:EDe,children:e.name}),w.jsxs("div",{className:PDe,children:[w.jsx(Iie,{buttonText:p(e),className:g(e),onClick:m(e)}),!e.requestSent&&w.jsx(Iie,{icon:ODe,className:DDe,onClick:f[e._id]})]})]},e._id)))]})})})),FDe="SuggestedWorkspaces-module_suggestedWorkspaceButton_Rgtd0",MDe="SuggestedWorkspaces-module_buttonLeft_fFpMh",UDe="SuggestedWorkspaces-module_badge_5fJ6h",BDe=_.memo((({suggestedWorkspaces:e,visiblePopover:t,setVisiblePopover:o})=>{const{currentUser:a,allTeams:i,pendingInvites:s,isQualifiedDomain:n}=tl((e=>{var t;return{currentUser:e.currentUser.user,allTeams:e.teams.allTeams,pendingInvites:e.teams.userTeamInvites,isQualifiedDomain:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.isQualifiedDomain}}),ol),[r,l]=h.useState(!1),[d,c]=h.useState({x:0,y:0}),u=a.upsells,m=ku(),p=h.useCallback((e=>{const t=e.currentTarget.getBoundingClientRect(),{x:o}=t,a=t.top;c({x:o+200,y:a})}),[]);h.useEffect((function(){const t=null==e?void 0:e.teams.map((e=>e._id));i.some((e=>null==t?void 0:t.includes(e._id)))&&dD()}),[i,null==e?void 0:e.teams]),h.useEffect((()=>{"SuggestedWorkspaces"!==t&&l(!1)}),[t]);const g=h.useCallback((()=>{l(!1)}),[]);return(null==e?void 0:e.isQualifiedDomain)?w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:FDe,onMouseEnter:p,onClick:()=>{(null==u?void 0:u.suggestedWorkspacesSidebar)||(()=>{const e=new Date;pp({...u,suggestedWorkspacesSidebar:{dateShown:e}}),np()})(),r?(l(!1),o("None")):(VM({numPendingInvites:s?s.length:0,suggestedWorkspaces:e,entryPoint:WM.Sidebar,isQualifiedDomain:n}),l(!0),o("SuggestedWorkspaces"))},children:[w.jsx("div",{className:MDe,children:"Suggested Workspaces"}),(null==u?void 0:u.suggestedWorkspacesSidebar)?null:w.jsx("div",{className:UDe,children:null==e?void 0:e.teams.length})]}),(()=>{if(m||r&&"SuggestedWorkspaces"===t)return w.jsx(LDe,{suggestedWorkspaces:e,close:g,tooltipPosition:d})})()]}):null})),VDe="TitleSection-module_textOverflowEllipsis_7D3hW",WDe="TitleSection-module_headerRow_YlZHa",GDe="TitleSection-module_headerRowLeft_Gz1Lk",HDe="TitleSection-module_headerRowRight_HoAVc",$De="TitleSection-module_workspaceName_z-xdw",KDe="TitleSection-module_workspaceThumbnail_5w5-l",zDe="TitleSection-module_limitWarningBlock_y93FZ",YDe="TitleSection-module_DropdownMenuContent_5g-Gw",JDe="TitleSection-module_DropdownMenuSeparator_NMbEa",qDe="TitleSection-module_themeSwitchItem_t3jYJ",XDe="TitleSection-module_themeSwitchLabel_V95zy",QDe="TitleSection-module_loader_FGMHt",ZDe="WorkspaceSelector-module_teamName_-uFrR",eOe="WorkspaceSelector-module_workspaceContainer_iaAYC",tOe="WorkspaceSelector-module_wrapper_ENg9C",oOe="WorkspaceSelector-module_container_kqx6F",aOe="WorkspaceSelector-module_workspaceWrapper_R42WE",iOe="WorkspaceSelector-module_workspaceInfo_ZkXey",sOe="WorkspaceSelector-module_workspaceInfoRight_0gNMH",nOe="WorkspaceSelector-module_planName_65-uZ",rOe="WorkspaceSelector-module_selected_1d40c",lOe="WorkspaceSelector-module_workspaceThumbnail_ipcXR",dOe="WorkspaceSelector-module_profilePicture_QnIVa",cOe="WorkspaceSelector-module_DropdownMenuItem_9cy3y",uOe="WorkspaceSelector-module_members_JWa-p",mOe="WorkspaceSelector-module_checkmark_V2cEV",pOe="WorkspaceSelector-module_checkmarkIcon_3oc8y",hOe="WorkspaceSelector-module_loading_Y-717",gOe=_.memo((({setLoadingNewWorkspace:e})=>{const t=il(),{allTeams:o,currentTeamId:a,notifications:i}=tl((e=>({currentTeamId:e.teams.selectedTeamId,allTeams:e.teams.allTeams,notifications:e.notifications.notifications})),ol),[s,n]=Ld(!1);h.useEffect((()=>{(async()=>{try{await ah()}catch(IGe){mh({description:"There was a problem fetching your invites. Please try again later.",error:IGe})}})()}),[t,i]),h.useEffect((function(){dD()}),[]);const r=t=>{var o,i;if(!t)return null;const r=su(t);let l=`${r.name} Plan`;r.isEdu&&(l="Edu Plan");const d=t._id===a;return w.jsx(Ye,{className:cOe,children:w.jsxs("div",{className:aOe,onClick:async()=>{(async t=>{if(!s()){n(!0),e(!0);try{await I9(t)}catch(IGe){console.error(IGe)}finally{n(!1),e(!1)}}})(t._id)},"data-workspace-id":t._id,children:[w.jsx("div",{className:eOe,children:w.jsx("div",{className:`${lOe} ${d?rOe:""}`,"data-cy":"workspace-selector-workspace-thumbnail","data-testid":"workspace-selector-workspace-thumbnail",children:w.jsx(b9,{team:t,className:dOe})})},t._id),w.jsxs("div",{className:iOe,children:[w.jsx("div",{className:ZDe,translate:"no",children:t.name}),w.jsxs("div",{className:sOe,children:[w.jsxs("div",{className:uOe,children:[null==(o=t.users)?void 0:o.length,w.jsx("span",{children:" Member"}),(null==(i=t.users)?void 0:i.length)>1&&w.jsx("span",{children:"s"})]}),"•",w.jsx("div",{className:nOe,children:l})]})]}),d?w.jsx("div",{className:mOe,children:s()?w.jsx("div",{className:hOe}):w.jsx(Wo,{className:pOe})}):null]})},t._id)};return w.jsx("div",{className:tOe,"data-cy":"workspace-selector","data-testid":"workspace-selector","data-loading":s(),children:w.jsx("div",{className:oOe,children:null==o?void 0:o.map((e=>r(e)))})})})),fOe=_.memo((()=>{var e,t;const o=Ac(),[a,i]=h.useState(!1),{userTeamInvites:s,suggestedWorkspaces:n,currentUser:r}=tl((e=>({userTeamInvites:e.teams.userTeamInvites,suggestedWorkspaces:e.workspaces.suggestedWorkspaces,currentUser:e.currentUser.user})),ol),[l,d]=h.useState("None"),c=(null==(t=null==(e=r.onboarding)?void 0:e.survey)?void 0:t.usage)===od.School,u=(null==n?void 0:n.isQualifiedDomain)&&n.teams.length>0&&!c;return w.jsxs(w.Fragment,{children:[w.jsxs(He,{modal:!1,children:[w.jsx($e,{asChild:!0,"data-testid":"workspace-dropdown-trigger","data-cy":"workspace-dropdown-trigger",children:w.jsxs("div",{className:WDe,children:[w.jsxs("div",{className:GDe,children:[w.jsx("button",{"data-testid":"team-workspace-logo",children:w.jsx(b9,{team:o,className:KDe})}),w.jsx("button",{className:$De,"data-cy":"team-workspace-name","data-testid":"team-workspace-name",translate:"no",children:w.jsx("span",{className:VDe,children:null==o?void 0:o.name})})]}),w.jsxs("div",{className:HDe,children:[a?w.jsx("div",{className:QDe,"data-loading":"true"}):null,w.jsx(Di,{})]})]})}),w.jsx(Ke,{children:w.jsxs(ze,{className:YDe,sideOffset:5,children:[w.jsx(gOe,{setLoadingNewWorkspace:i}),w.jsx(Je,{className:JDe}),s&&s.length>0&&w.jsx(xDe,{invites:s,visiblePopover:l,setVisiblePopover:d}),u&&w.jsx(BDe,{suggestedWorkspaces:n,visiblePopover:l,setVisiblePopover:d}),w.jsxs("div",{className:qDe,children:[w.jsx("div",{className:XDe,children:"Dark Mode"}),w.jsx(tU,{})]})]})})]}),w.jsxs("div",{className:zDe,children:[w.jsx(rDe,{}),w.jsx(tse,{})]})]})})),yOe=_.memo((({showSidebar:e,setShowSidebar:t,openAccountSettings:o})=>{var a;const i=h.useRef(null),{allFolders:s,workspaceIsInSelectionMode:n,selectedTeamId:r}=tl((e=>({allFolders:e.workspaces.allWorkspaces,workspaceIsInSelectionMode:e.workspaces.selectionMode,selectedTeamId:e.teams.selectedTeamId})),ol),l=((e,t)=>e.filter((e=>{const o=e.teamId===t&&e.type===kn.personal&&!e.sharedAt,a=!(e.teamId&&"personal"!==e.teamId||"personal"!==t||e.sharedAt);return o||a})))(s,r),d=xP(s,r),c=ku(),u=Ve(),m=Ac(),[p,g]=h.useState(!1),f=fW(Hl.Create)&&(null==(a=u.location.state)?void 0:a.redirectSource)===voe.TEAMS,[y,v]=h.useState(f),[_,b]=h.useState(kn.team),T=NU(Bl.CREATE_NEW_FOLDER);h.useEffect((function(){!window.sessionStorage.getItem("TEAM_WORKSPACE_ACCESS_LOGGED")&&r&&"personal"!==r&&yM(r)}));const x=h.useCallback((e=>{n||(g(!0),b(e))}),[n]),S=h.useCallback((()=>{var e;g(!1),null==(e=null==i?void 0:i.current)||e.scrollTo(0,0)}),[]),E=h.useCallback((()=>{v(!1)}),[]),I=h.useCallback((e=>{T?x(e):TW((()=>{}),{action:Vl.CREATE_NEW_FOLDER,teamId:m._id})()}),[T,m._id,x]),C=h.useCallback((()=>{I(kn.personal)}),[I]),k=h.useCallback((()=>{I(kn.team)}),[I]),A=()=>{t(!e)};return w.jsxs(w.Fragment,{children:[e?w.jsx("div",{className:rPe,onClick:A}):null,w.jsxs("div",{className:JRe,style:(()=>{let t={width:282,left:0};return c&&(t=e?{...t,left:0}:{...t,left:-302}),t})(),"data-cy":"workspace-sidebar-container",children:[c?w.jsx("div",{className:sPe,onClick:A,"data-cy":"workspace-sidebar-nav-menu-toggle",children:w.jsx(Eo,{className:nPe})}):null,w.jsxs("div",{className:oPe,children:[w.jsx(fOe,{}),w.jsx(IPe,{}),w.jsxs("div",{className:qRe,children:[w.jsx(sU,{message:"All workspace members have access to these folders.",children:w.jsx("span",{children:"Team Folders"})}),w.jsx(sU,{message:"Create a new workspace folder",children:w.jsxs("div",{className:ZRe,onClick:k,"data-cy":"new-folder-button","data-testid":"workspace-new-folder-button-team",children:[w.jsx(Oi,{className:ePe}),!T&&w.jsx(EW,{className:tPe})]})})]}),w.jsxs("div",{"data-testid":"section-workspace-folders",className:iPe,children:[w.jsx(w.Fragment,{children:d.map((e=>w.jsx(bPe,{folderId:e._id,folderName:e.name,dataCy:"team-folder-link"},e._id)))}),w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:XRe,children:[w.jsx(sU,{message:"Only you have access to these folders. Projects in these folders are private unless you share them.",children:w.jsx("span",{children:"Private Folders"})}),w.jsx(sU,{message:"Create a new personal folder",children:w.jsxs("div",{className:ZRe,onClick:C,"data-cy":"new-folder-button-personal","data-testid":"workspace-new-folder-button-personal",children:[w.jsx(Oi,{className:ePe}),!T&&w.jsx(EW,{className:tPe})]})})]}),!l.length&&w.jsx("div",{className:QRe,children:"Projects in these folders are only accessible by you."}),l.map((e=>w.jsx(bPe,{folderId:e._id,folderName:e.name,dataCy:"private-folder-link",isPrivate:!0},e._id)))]})]})]}),w.jsx("div",{className:aPe,"data-testid":"workspace-sidebar-divider",children:w.jsx(qPe,{openAccountSettings:o})})]}),p&&w.jsx(lPe,{onHide:S,folderType:_}),y&&w.jsx(Eje,{onClose:E,entryPoint:wIe.SIDEBAR})]})})),vOe=_.memo((()=>{const e=rU(),{currentUser:t,currentFolderId:o,allFolders:a,teamId:i}=tl((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,allFolders:e.workspaces.allWorkspaces,teamId:e.teams.selectedTeamId})),ol),s=ke(),n=il(),r=Ve(),l=be(),d=NTe(l.pathname),c=xfe(),[u,m]=h.useState({}),[p,g]=h.useState(""),[f,y]=h.useState(!1),[v,_]=h.useState(!1),[b,T]=h.useState(!0),[x,S]=h.useState(!1),[E,I]=h.useState(""),C=ku(),[k,A]=h.useState(!C);h.useEffect((()=>{C&&k&&l.pathname&&d&&l.pathname!==d&&A(!1)}),[l.pathname,d,C,k]),h.useEffect((function(){wc(t)?j():(r.push(`/signin?next=${l.pathname}${l.search}`),n(wl({description:"You must be signed in to view this page.",type:"error"})))}),[]),h.useEffect((function(){i&&NP(i)}),[i]),h.useEffect((function(){const e=new URLSearchParams(l.search);if(e.has(Wn.ScheduledMarketingEmail)){const t=e.get(Wn.ScheduledMarketingEmail)||void 0;Fm(ym.VISIT_FROM_MARKETING_EMAIL,{"Template Id":t})}}),[l.search]);const j=h.useCallback((async()=>{const e=s.params.teamId||!1,t=s.path.includes(Vn)?Vn:s.params.id,a=!e&&(t??o)||"";await Op();const i=await xD(a,e);["/brandkit","/team/request","/shared-with-me"].includes(s.url)||l.pathname.includes("members")||l.pathname.includes("settings")||l.pathname.includes("billing")||l.pathname.includes("search")||r.push({pathname:`/folder/${i}`,state:r.location.state,search:r.location.search}),T(!1),Dp()}),[r,s.url]);h.useEffect((function(){return()=>{n(yl())}}),[n]),h.useEffect((()=>{S(!1)}),[i]),h.useEffect((function(){var e;(null==(e=l.state)?void 0:e.openModal)===c9.account&&_(!0)}),[l.state]),h.useEffect((()=>{!async function(){var o;if(a.length<2)return void I(i);if(x||!i)return;S(!0);const{token:s,user:n}=t,r={token:s,userId:null==n?void 0:n._id,teamId:i};let l,d=!0;for(;d;){if(!e.current)return;let t;try{t=await Yr("/api/v1/workspaces/loadVideos",{params:r,signal:c.signal})}catch(IGe){break}const a=t||[],i={};if(l=null==(o=a.slice(-1)[0])?void 0:o._id,r.lastId=l,a){a.forEach((e=>{const t=i[e.workspaceId];t?t.push(e):i[e.workspaceId]=[e]}));for(const e of Object.keys(i)){if(e===p)continue;const t=i[e];t&&P(t,e)}r.lastId||(d=!1)}else d=!1}I(i)}()}),[i,a,t]);h.useEffect((()=>{(async(e,t)=>{var o,a;if(!e)return;y(!1);let i=!0;for(t.lastId="";i;){let r;try{e===Vn?(r=await Yr("/api/v1/sharedProjects",{params:t,signal:c.signal}),y(!0)):(r=await Yr("/api/v1/home",{params:t,signal:c.signal}),y(!0))}catch(IGe){IGe instanceof Error&&(s=IGe,console.error(s),Fm(ym.FAILED_TO_LOAD_WORKSPACE,{message:ZU(s),status:s instanceof Hr?s.status:void 0}));break}const l=r.projects,d=null==(o=r.workspace)?void 0:o._id,{brandkitTemplates:u}=r;d!==p&&g(d),u&&n(Pp(u)),l?(P(l,e),t.lastId=null==(a=l.slice(-1)[0])?void 0:a[d===Vn?"sharedId":"_id"],(!t.lastId||l.length<50)&&(i=!1)):i=!1,e!==p&&(i=!1)}var s})(p,{...u})}),[p]),h.useEffect((()=>{E&&function(e){if(UM.has(e))return;UM.add(e);const{workspaces:t,projects:o}=sr().state,{allWorkspaces:a}=t,i=new Set(a.filter((t=>t.teamId===e)).map((e=>e._id))),s=Object.keys(o.projectIdsByFolderId).filter((e=>i.has(e))).reduce(((e,t)=>e+Object.keys(t).length),0),n=i.size;Fm(ym.ALL_WORKSPACE_FOLDERS_LOADED,{"Workspace ID":e,"Number of Projects":s,"Number of Folders":n})}(E)}),[E]);const N=h.useCallback((async()=>{if(["/folder","/folder/"].includes(s.url))o?r.push(`/folder/${o}`):L();else if("/folder/:id"===s.path&&s.params.id){const t=s.params.id;if(t!==o&&!["invite","create"].includes(t))if(OP(t))n(ib(t));else{const o=await(e=t,e?Yr(`/api/v1/workspaces/${e}`):null);if(o)I9(o.teamId,t),n(ib(t));else{n(wl({description:`There was an error with navigating to folder ${t}.`,type:"error"}));const e=BP();n(ib(e)),r.push(`/folder/${e}`)}}}else["/shared-with-me","/shared-with-me/"].includes(s.url)&&o!==Vn&&n(ib(Vn));var e}),[s.url]);h.useEffect((()=>{N()}),[N,s.url]);const R=h.useCallback(((e,t)=>{m(t),g(e)}),[]),P=h.useCallback(((e,t)=>{n(dO({projects:e,folderId:t}))}),[n]),D=h.useCallback((()=>w.jsx(_Re,{startFetchingProjects:R,initialProjectsLoaded:f})),[f,R]),O=h.useCallback((()=>D()),[D]),L=h.useCallback((async()=>{let e;T(!0);try{e=await xD("",i)}catch(IGe){console.error(IGe)}return e?(T(!1),r.push(`/folder/${e}`)):(n(wl({description:"There was an error loading your folders.",type:"error"})),n(Ip("")),wc(t)?r.push("/home"):r.push("/signin"))}),[n,r,t,i]),F=h.useCallback((()=>{_(!0)}),[]),M=h.useCallback((()=>{_(!1),window.history.replaceState({},document.title)}),[]);return wc(t)?b?w.jsx(Y4,{title:"Loading your workspace..."}):w.jsxs($Pe,{children:[w.jsx(Y9,{}),w.jsx(yOe,{showSidebar:k,setShowSidebar:A,openAccountSettings:F}),w.jsxs("div",{className:oSe,children:[C?k||!C?null:w.jsx("div",{className:iSe,children:w.jsx("button",{className:sSe,onClick:()=>A(!k),"data-cy":"mobile-nav-menu-toggle",children:w.jsx(Li,{})})}):null,w.jsx("div",{className:aSe}),v&&w.jsx(tSe,{closeAccountSettings:M}),w.jsx(jIe,{}),w.jsxs(zt,{children:[w.jsx(Yt,{exact:!0,path:"/brandkit",component:e9}),w.jsx(Yt,{exact:!0,path:"/folder/:id",render:O}),w.jsx(Yt,{exact:!0,path:"/folder/:id/rename",render:O}),w.jsx(Yt,{exact:!0,path:"/folder/create",render:O}),w.jsx(Yt,{exact:!0,path:"/folder/:id/create",render:O}),w.jsx(Yt,{exact:!0,path:"/shared-with-me",render:O}),w.jsx(Yt,{exact:!0,path:"/search",component:YRe}),w.jsx(Yt,{path:"/search/:teamId",component:YRe}),w.jsx(Yt,{path:"/team/:id",component:X4}),w.jsx(Yt,{path:"/settings",component:Q4}),w.jsx(Yt,{path:"/settings/folder/cancel",component:Q4})]})]})]}):w.jsx(Aa,{to:"/signin"})})),_Oe=_.memo((()=>{const e=tl((e=>{var t;return null==(t=e.currentUser.user)?void 0:t._id})),t=il(),o=h.useRef(null);return h.useEffect((function(){const a=(()=>{const{token:e}=sr().state.currentUser;return e})();if(a){const i=new Fi(`${function(){let e;e=_r?_r.replace("http","ws"):`wss://notifications.${Ur()||Fr().includes("dev")?"kapwing-dev":"kapwing"}.com`;return`${e}/websocket`}()}?token=${a}&userId=${e}`,[],{maxReconnectionDelay:7e3});let s;i.addEventListener("open",(()=>{s=window.setInterval((()=>{i.send('{"keepAlive":"heartbeat"}')}),1e4)})),i.addEventListener("message",(e=>{const o=JSON.parse(e.data);o.userNotifs&&t(iO(o.userNotifs)),o.newNotifs&&t(sO(o.newNotifs))})),i.addEventListener("error",(e=>{console.error("Error connecting to notifications websocket",e),window.clearInterval(s)})),i.addEventListener("close",(()=>{window.clearInterval(s)})),o.current=i}return()=>{var e;null==(e=o.current)||e.close()}}),[t,e]),null})),wOe="ActionDialog-module_section_gUotP",bOe="ActionDialog-module_sectionLabel_ZGnw6",TOe="ActionDialog-module_nameInput_hio-R",xOe="ActionDialog-module_buttonContainer_vCK2-",SOe="ActionDialog-module_actionButton_Ub-Ks",EOe=e=>tl((t=>{var o;if(!e||!e.length)return t.projectName||An;if(e.length>1)return"Projects";const a=e[0];return t.projectName||a&&((null==(o=t.projects.byId[a])?void 0:o.name)||t.studio.projectName)||An})),IOe="TeamUserRow-module_userRow_9vAPY",COe="TeamUserRow-module_userInfo_CUcTw",kOe="TeamUserRow-module_profilePic_Mgzws",AOe="TeamUserRow-module_nameBlock_l3RWW",jOe="TeamUserRow-module_name_1XLhX",NOe="TeamUserRow-module_email_5dzfn",ROe="TeamUserRow-module_role_-sZSl",POe=_.memo((({teamUser:e,onClick:t})=>{const{user:o}=e;return o?w.jsxs("div",{className:IOe,onClick:t?()=>t(o):void 0,children:[w.jsxs("div",{className:COe,children:[w.jsx("div",{className:kOe,children:w.jsx(b9,{suggestedHeight:60,suggestedWidth:60,user:o})}),w.jsxs("div",{className:AOe,children:[w.jsx("div",{className:jOe,children:o.name}),w.jsx("div",{className:NOe,children:o.email})]})]}),w.jsx("div",{className:ROe,children:e.role===kl.Admin?"Admin":"Editor"})]}):null})),DOe="Modal-module_modalContainer_5Unq-",OOe="Modal-module_headerContainer_OyWj9",LOe="Modal-module_header_KC9qk",FOe="Modal-module_subheader_-DyNh",MOe=_.memo((({title:e,subHeader:t})=>w.jsxs("div",{className:OOe,children:[e&&w.jsx("div",{"data-cy":"modal-title",className:LOe,children:e}),t&&w.jsx("div",{"data-cy":"modal-subheader",className:FOe,children:t})]}))),UOe="Chooser-module_container_eRF4d",BOe="Chooser-module_chooserBar_2mgUb",VOe="Chooser-module_disabledBar_byZeP",WOe="Chooser-module_team_h6hG0",GOe="Chooser-module_name_PA6sa",HOe="Chooser-module_nameText_dUjUJ",$Oe="Chooser-module_chooser_AZWDB",KOe="Chooser-module_teamRow_PKkVd",zOe="Chooser-module_folderName_RonTp",YOe="Chooser-module_middleArrow_dES8C",JOe="Chooser-module_dropdownChevron_X3e87",qOe="Chooser-module_rotateChevron_Cn8Q5",XOe="Chooser-module_chooserRow_KsiaA",QOe="Chooser-module_selected_7Rpnw",ZOe="Chooser-module_nameIcon_RoXZA",eLe="Chooser-module_chevron_l-HOJ",tLe="Chooser-module_sectionTitle_ltcTl",oLe="Chooser-module_explorerBodyWrapper_Rul90",aLe="Chooser-module_show_LiUuA",iLe="Chooser-module_disabled_ROhdT",sLe="Chooser-module_explorerBody_IUVk9",nLe="Chooser-module_folderSection_haXPb",rLe="Chooser-module_explorer_hos6-",lLe="Chooser-module_explorerHeader_0-UCB",dLe="Chooser-module_clickableArea_tqMod",cLe="Chooser-module_selectWorkspace_rjOcL",uLe="Chooser-module_loadingHeader_fVjHu",mLe="Chooser-module_spinner_VCI5G",pLe="Chooser-module_leftArrow_GZuaS",hLe="Chooser-module_userRow_NlpIA",gLe="Chooser-module_teamUserWrapper_Am94t",fLe="Chooser-module_permissionDialog_9vcVJ",yLe="Chooser-module_chooserFolderContainer_dFoSe",vLe=_.memo((({onClick:e,selected:t,icon:o,label:a,chevron:i})=>w.jsxs("div",{className:`${XOe} ${t?QOe:""}`,onClick:e,children:[w.jsxs("div",{className:GOe,children:[o?w.jsx("div",{className:ZOe,children:o}):null,w.jsx("div",{className:HOe,children:a})]}),i&&w.jsx("div",{className:eLe,children:w.jsx(bo,{})})]}))),_Le=w.jsx(Ui,{size:25}),wLe=_.memo((({selectedTeam:e,setSelectedFolder:t,selectedFolderId:o,setSelectedTeam:a,show:i,disabled:s})=>{const{teams:n,teamFolders:r,privateFolders:l}=(e=>{const t=tl((e=>e.explorer.teams),ol),o=tl((t=>t.explorer.folders.filter((t=>t.teamId===e))),ol);return{teams:t,teamFolders:o.filter((e=>e.type===kn.team)),privateFolders:o.filter((e=>e.type===kn.personal))}})(null==e?void 0:e._id),d=h.useMemo((()=>[...r,...l].reduce(((e,o)=>(e[o._id]=()=>t(o),e)),{})),[r,l,t]),c=h.useMemo((()=>n.reduce(((e,t)=>(e[t._id]=()=>a(t),e)),{})),[n,a]),u=(e,t)=>e.length?w.jsxs("div",{className:nLe,children:[w.jsx("div",{className:tLe,children:t}),w.jsx("div",{"data-cy":"chooser-folder-container",className:yLe,children:e.map((e=>w.jsx(vLe,{label:e.name,icon:ei({}),onClick:d[e._id],selected:o===e._id},e._id)))})]}):null,m=h.useMemo((()=>n.reduce(((e,t)=>(e[t._id]=w.jsx(b9,{suggestedHeight:30,suggestedWidth:30,team:t}),e)),{})),[n]);return n&&n.length?w.jsxs("div",{className:`${oLe} ${i?aLe:""} ${s?iLe:""}`,children:[w.jsx("div",{className:lLe,children:!!e&&w.jsx("div",{className:WOe,children:w.jsxs("div",{className:`${cLe} ${dLe}`,onClick:()=>a(void 0),children:[w.jsx("span",{className:pLe,children:w.jsx(Mi,{})}),"Select a different team workspace"]})})}),w.jsx("div",{className:sLe,children:e?w.jsxs(w.Fragment,{children:[u(r,(null==e?void 0:e._id)===Vn?"Shared Folders":"Team Folders"),u(l,"Private Folders")]}):w.jsx("div",{"data-cy":"chooser-folder-container",className:yLe,children:n.map((e=>w.jsx(vLe,{label:e.name,onClick:c[e._id],icon:e._id===Vn?_Le:m[e._id],chevron:!0},e._id)))})})]}):w.jsx("div",{children:"Loading..."})})),bLe="TeamRow-module_team_cY9aX",TLe="TeamRow-module_profilePic_K3D3u",xLe="TeamRow-module_name_WC82v",SLe=_.memo((({team:e,onClick:t,short:o})=>w.jsxs("div",{className:bLe,onClick:t?()=>t(e):void 0,children:[w.jsx("div",{className:TLe,children:e._id===Vn?w.jsx(Ui,{size:30}):w.jsx(b9,{suggestedHeight:30,suggestedWidth:30,team:e})}),!o&&w.jsx("div",{className:xLe,children:e.name})]}))),ELe=_.memo((({selectedTeam:e,folder:t,onTeamClick:o,setShowExplorer:a,showExplorer:i,disabled:s})=>{const n=ku();if(!e)return null;const r=i&&!!e;return w.jsxs("div",{"data-cy":"folder-chooser-header",className:`${BOe} ${s?VOe:""}`,onClick:()=>!s&&a(),children:[w.jsxs("div",{className:$Oe,children:[w.jsx("div",{className:KOe,onClick:e=>r&&e.stopPropagation(),children:w.jsx(SLe,{team:e,onClick:r?o:void 0,short:n})}),w.jsx("div",{className:YOe,children:w.jsx(bo,{})}),t&&w.jsx("div",{children:w.jsx("div",{className:zOe,children:t.name})})]}),w.jsx("div",{className:`${JOe} ${i?qOe:""}`,children:w.jsx(xt,{})})]})})),ILe=_.memo((({setDestinationFolderId:e,disabled:t,startOpen:o})=>{const{showExplorer:a,setShowExplorer:i,selectedFolder:s,setSelectedFolder:n,selectedTeam:r,setSelectedTeam:l,isLoading:d}=((e,t)=>{Th(!0);const{currentFolder:o,isLoading:a,currentTeam:i}=eNe(),[s,n]=h.useState(o),r=tl((e=>e.explorer.teams)),[l,d]=h.useState(r.find((e=>(null==o?void 0:o.teamId)?e._id===(null==o?void 0:o.teamId):e._id===(null==i?void 0:i._id)))),c=!r.length||a,[u,m]=h.useState(!!t||!l),[p,g]=h.useState(!0);h.useEffect((()=>{e((null==s?void 0:s.teamId)?s._id:"")}),[null==s?void 0:s._id,null==s?void 0:s.teamId,e]);const f=tl((e=>{const t=e.explorer.folders.filter((e=>e.teamId===(null==l?void 0:l._id)));return 1===t.length?t[0]:void 0}));return h.useEffect((function(){l?f&&n(f):n(void 0)}),[l,f]),{viewingFolder:p,setViewingFolder:g,showExplorer:u,setShowExplorer:m,selectedFolder:s,setSelectedFolder:n,selectedTeam:l,setSelectedTeam:d,isLoading:c}})(e,o),c=h.useCallback((()=>{i(!0),l(void 0)}),[l,i]),u=h.useCallback((e=>i((t=>void 0!==e?e:!t))),[i]);return w.jsx("div",{className:UOe,children:d?w.jsx("div",{className:uLe,children:w.jsx(Fo,{className:mLe})}):w.jsxs(w.Fragment,{children:[!!r&&w.jsx(ELe,{disabled:t,selectedTeam:r,folder:s,onTeamClick:c,showExplorer:a,setShowExplorer:u}),w.jsx("div",{className:rLe,children:w.jsx(wLe,{disabled:t,show:a||!r,selectedTeam:r,setSelectedTeam:l,selectedFolderId:null==s?void 0:s._id,setSelectedFolder:n})})]})})})),CLe="AdminMoveDialog-module_input_2j5CX",kLe=_.memo((({setDestinationFolderId:e,setHideDropdown:t})=>{const[o,a]=h.useState(""),i=ku();if(!Tc(tl((e=>e.currentUser)))||i)return null;return w.jsx("input",{type:"text",className:CLe,value:o,onChange:o=>(o=>{t(!0);const i=o.target.value.trim();a(i),e(i)})(o),placeholder:"ADMIN: Enter folder ID to move project to"})})),ALe=_.memo((({actionType:e,comparePermissionsDTO:t,destinationFolderName:o,numProjects:a})=>{var i,s;const{permissionResult:n}=t;if(n===md.SAME)return null;const{sourceTeam:r,destinationTeam:l}=t;if(n===md.PRIVATE_TO_SHARED){if(!(null==(i=t.users)?void 0:i.length))throw new Error(`No users found - private to shared team:${t.destinationTeam._id}`);return w.jsxs("span",{children:[w.jsx("span",{children:e===pd.COPY?"Copying":"Moving"})," ","this project to"," ",w.jsx("strong",{children:r._id===l._id?o:l.name})," ","will give access to ",null==(s=t.users)?void 0:s.length," ",Nc("collaborator","collaborators",t.users.length),":"]})}return n===md.SHARED_TO_PRIVATE?w.jsxs("span",{children:["All members of ",w.jsx("strong",{children:r.name})," will lose access unless the ",Nc("project has","projects have",a)," ","been explicitly shared with them"]}):w.jsxs("span",{children:[e===pd.MOVE&&w.jsxs("span",{children:["All members of ",w.jsx("strong",{children:r.name})," will lose access unless the ",Nc("project has","projects have",a)," ","been explicitly shared with them."]}),w.jsxs("span",{children:["All members of ",w.jsx("strong",{children:l.name})," will gain access."]})]})})),jLe=(e,t,o,a)=>{const i=xfe(),[s,n]=h.useState(),[r,l]=h.useState(!1),[d,c]=h.useState(),[u,m]=h.useState(),[p,g]=h.useState(!1),{destinationFolder:f,currentUser:y}=tl((e=>({destinationFolder:e.explorer.folders.find((e=>e._id===s)),currentUser:e.currentUser})),ol),v=async()=>{if(!r&&s)try{if(l(!0),await t(s),i.signal.aborted)return;l(!1)}catch(IGe){mh({description:"Error moving project",error:IGe}),l(!1)}};return{destinationFolderId:s,setDestinationFolderId:n,processing:r,showPermissions:p,permissionText:d,permissionUsers:u,handleSubmit:p?v:async()=>{if((()=>{const t=s&&24===s.length&&!f;return e===pd.MOVE&&Tc(y)&&t})())return void v();if(!s||!f||!(null==a?void 0:a.length))return;l(!0);const t=await Jr("/api/v1/explorer/comparePermissions",{body:{projectIds:a,destinationFolderId:s}});t.permissionResult!==md.SAME&&(t.permissionResult!==md.CHANGE_TEAMS||t.destinationFolder.type!==kn.personal||t.sourceFolder.type!==kn.personal)&&(e!==pd.COPY||t.destinationFolder.type!==kn.personal&&t.permissionResult!==md.SHARED_TO_PRIVATE)?(g(!0),c(w.jsx(ALe,{actionType:e,comparePermissionsDTO:t,destinationFolderName:null==f?void 0:f.name,numProjects:a.length})),m(t.users),l(!1)):v()},handleBack:p?()=>{g(!1),c(""),m(void 0)}:o}},NLe=_.memo((({actionType:e,children:t,submitText:o,header:a,onSubmit:i,onCancel:s=vh,validationFunction:n,projectIds:r})=>{const{destinationFolderId:l,setDestinationFolderId:d,showPermissions:c,permissionText:u,permissionUsers:m,handleSubmit:p,handleBack:g,processing:f}=jLe(e,i,s,r),[y,v]=h.useState(!1);return w.jsxs("div",{className:fLe,onKeyUp:e=>{"Enter"===e.key&&p()},tabIndex:0,children:[w.jsx(MOe,{title:a,subHeader:u}),c?m&&m.length&&w.jsx("div",{className:gLe,children:m.map((e=>e.user&&w.jsx("div",{className:hLe,children:w.jsx(POe,{teamUser:e})},e._id)))}):w.jsxs(w.Fragment,{children:[!!t&&t,w.jsxs(RLe,{label:e===pd.COPY?"Copy to:":"Move to:",children:[e===pd.MOVE&&w.jsx(kLe,{setDestinationFolderId:d,setHideDropdown:v}),w.jsx(ILe,{disabled:f||y,setDestinationFolderId:d,startOpen:e===pd.MOVE})]})]}),w.jsx("div",{className:wOe,children:w.jsxs("div",{className:xOe,children:[w.jsx("div",{className:SOe,children:w.jsx(Die,{testId:"permission-confirm-button",disabled:n?f||!l||!n(l):f||!l,loading:f,fullWidth:!0,onClick:p,children:o||"Confirm"})}),w.jsx("div",{className:SOe,children:w.jsx(Die,{fullWidth:!0,overrideColor:"gray",onClick:g,disabled:f,children:c?"Back":"Cancel"})})]})})]})})),RLe=_.memo((e=>{const{children:t,label:o}=e;return w.jsxs("div",{className:wOe,children:[w.jsx("div",{className:bOe,children:o}),t]})})),PLe=kt((e=>[e])),DLe=_.memo((({projectId:e,onSubmit:t,name:o})=>{const a=EOe([e]),[i,s]=h.useState(o||(e=>{const t=e.match(/^(.*) \((\d+)\)$/);if(t)return`${t[1]} (${parseInt(t[2]??"0")+1})`;return`${e} (1)`})(a)),n=PLe(e),r=h.useMemo((()=>w.jsxs("span",{children:["Copy ",w.jsx("strong",{children:o||a})," "]})),[o,a]),l=h.useCallback((e=>t({destinationFolderId:e,name:i})),[t,i]);return w.jsx(NLe,{actionType:pd.COPY,header:r,submitText:"Copy",onSubmit:l,projectIds:n,children:w.jsx(RLe,{label:"Name",children:w.jsx("div",{className:TOe,children:w.jsx("input",{"data-cy":"copy-project-name-input",type:"text",value:i,onChange:e=>s(e.target.value)})})})})}));const OLe={home:"DeleteAccountDialog-module_home_Qy1p-",homeHowBackgroundWhite:"DeleteAccountDialog-module_homeHowBackgroundWhite_5vrqM",largeButton:"DeleteAccountDialog-module_largeButton_h2PKs",sectionContent:"DeleteAccountDialog-module_sectionContent_6qcDC",sectionHeader:"DeleteAccountDialog-module_sectionHeader_ItYW9",spacer:"DeleteAccountDialog-module_spacer_Y4qhY",chevron:"DeleteAccountDialog-module_chevron_naSaT",splashText:"DeleteAccountDialog-module_splashText_4nLL-",splashSubtext:"DeleteAccountDialog-module_splashSubtext_gZdO0",aboutSection:"DeleteAccountDialog-module_aboutSection_71h7k",mobile:"DeleteAccountDialog-module_mobile_2zyNO",desktop:"DeleteAccountDialog-module_desktop_aF2sB",screenReaderOnlyLabel:"DeleteAccountDialog-module_screenReaderOnlyLabel_XKEKm",disabled:"DeleteAccountDialog-module_disabled_4xGKa",noScrollBar:"DeleteAccountDialog-module_noScrollBar_46jsu",textOverflowEllipsis:"DeleteAccountDialog-module_textOverflowEllipsis_rOly5",disableTextHighlight:"DeleteAccountDialog-module_disableTextHighlight_aaMom",genericButtonBlue:"DeleteAccountDialog-module_genericButtonBlue_piiJU",deleteDialogBackground:"DeleteAccountDialog-module_deleteDialogBackground_gA2AW",deleteDialogContainer:"DeleteAccountDialog-module_deleteDialogContainer_LJLDS",header:"DeleteAccountDialog-module_header_I1ivc",description:"DeleteAccountDialog-module_description_Ribr-",deleteCloseContainer:"DeleteAccountDialog-module_deleteCloseContainer_AVeX5",buttonsContainer:"DeleteAccountDialog-module_buttonsContainer_g-4V6",primaryButton:"DeleteAccountDialog-module_primaryButton_9jXzj",secondaryAction:"DeleteAccountDialog-module_secondaryAction_067Qv",loading:"DeleteAccountDialog-module_loading_WMwqn",checkBoxContainer:"DeleteAccountDialog-module_checkBoxContainer_OGqPY",checkBox:"DeleteAccountDialog-module_checkBox_8ZfOY",checkBoxText:"DeleteAccountDialog-module_checkBoxText_B6PNC",italicBold:"DeleteAccountDialog-module_italicBold_I-A-q"},LLe=_.memo((()=>{const e=il(),t=Ve(),[o,a]=h.useState(!1),[i,s]=h.useState(!0);h.useEffect((function(){((e,t)=>{const{dispatch:o}=sr();o({type:yh.setModalTitle.type,payload:{title:e,subtitle:t}})})("Delete Account")}),[]);return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:OLe.description,children:[w.jsxs("p",{children:["Deleting your account will delete"," ",w.jsx("b",{children:"all private workspaces and content"})," associated with your account — all links and embeds to existing content will no longer work. Shared workspaces will still exist for you and others who have access."]}),w.jsxs("p",{children:["To get help with your subscription or account, contact us at",w.jsx("a",{href:"mailto:help@kapwing.com",children:" help@kapwing.com"})," before deleting your data."]}),w.jsxs("div",{className:OLe.checkBoxContainer,children:[w.jsx("input",{type:"checkbox",className:OLe.checkBox,onClick:()=>s(!i)}),w.jsx("div",{className:OLe.checkBoxText,children:"I acknowledge that I will no longer receive support regarding my projects, workspaces, or subscription from Kapwing's customer support team. After deleting, I will not be eligible for any refund for past purchases or remaining subscription time."})]}),w.jsx("p",{className:OLe.italicBold,children:"This action cannot be undone. You will be signed out once your account deletion is complete. All data will be erased from Kapwing's database."})]}),w.jsx("div",{className:OLe.buttonsContainer,children:o?w.jsx("div",{className:OLe.loading,children:"Deleting..."}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:`${OLe.primaryButton} ${i?OLe.disabled:""}`,onClick:async()=>{if(!i){a(!0);try{await function(){const{user:e}=sr().state.currentUser||{},{_id:t}=e||{};return zr("/api/v1/account",{params:{userId:t},parseJSON:!1})}(),e(wl({description:"Your account has been successfully deleted and you have been signed out of Kapwing. Sign in again to create a new account.",type:"success"})),e(Tr()),t.push("/"),sh.remove("state")}catch(IGe){IGe instanceof Hr&&429===IGe.status?hh({description:"Accounts with this email address have been deleted too recently. Please try again tomorrow."}):mh({description:"There were errors when deleting your account. Not all of your content may be deleted.",error:IGe})}finally{a(!1)}}},children:"Delete Account"}),w.jsx("div",{onClick:()=>vh(),className:OLe.secondaryAction,children:"Never mind"})]})})]})})),FLe=_.memo((({projectIds:e,onSubmit:t,onCancel:o})=>{const a=tl((e=>e.workspaces.selectedWorkspace)),i=EOe(e),s=h.useMemo((()=>w.jsxs("span",{children:["Move ",w.jsx("strong",{children:i})]})),[i]),n=h.useCallback((e=>e!==a),[a]);return w.jsx(NLe,{actionType:pd.MOVE,onSubmit:t,onCancel:o,validationFunction:n,header:s,projectIds:e,submitText:"Move"})})),MLe="BrandkitTemplates-module_sectionHeader_mOHDb",ULe="BrandkitTemplates-module_templateSectionContainer_zRbnK",BLe="BrandkitTemplates-module_sectionHeaderContainer_yKegm",VLe="BrandkitTemplates-module_sectionHeaderControls_dCBw-",WLe="BrandkitTemplates-module_templatesContainer_4zsk3",GLe="BrandkitTemplates-module_templateContainer_vkD3R",HLe="BrandkitTemplates-module_blurredThumbnail_qw2Dl",$Le="BrandkitTemplates-module_blurred_lZsWy",KLe="BrandkitTemplates-module_templateThumbnail_NQauH",zLe="BrandkitTemplates-module_plusButton_vuD5Q",YLe="BrandkitTemplates-module_templateName_8E4iS",JLe="BrandkitTemplates-module_templateContent_cYyjW",qLe="BrandkitTemplates-module_plusButtonText_k2wNo",XLe="BrandkitTemplates-module_plusSvg_DUrVK",QLe="BrandkitTemplates-module_proSparkle_-4xyc",ZLe=_.memo((({template:e})=>{const t=Ve(),o=NU(Bl.BRANDKIT),a=bW(),{selectedWorkspace:i}=tl((e=>({selectedWorkspace:e.workspaces.selectedWorkspace})),ol),[s,n]=h.useState(!1),r=async()=>{if(!e.projectId)return;const o={workspaceId:i,fromBrandkitTemplate:!0},a=(await Yr(`/api/v1/workspaces/${i}/getUsers`)).keys.length>1;MM({workspaceId:i,source:"Brand Template",workspaceHasCollaborators:a});const s=await Jr(`/api/v1/projects/${e.projectId}/copy`,{body:o});s&&s._id&&t.push(`/${s._id}/studio/editor`)};return w.jsxs("div",{className:GLe,children:[(()=>{const t=k0(e,"thumbnailUrl","original")||zn;return w.jsxs("div",{className:HLe,style:{backgroundImage:`url(${t})`},children:[w.jsx("div",{className:$Le}),w.jsx("div",{onClick:async()=>{o?(n(!0),await r(),vh()):a((()=>null),{action:Vl.BRANDKIT})()},className:KLe,style:{backgroundImage:`url(${t})`},"data-testid":"start-from-template-button",children:w.jsxs("span",{className:zLe,children:[s?w.jsx(eme,{}):w.jsx(Bi,{className:XLe}),w.jsx("div",{className:qLe,children:"Start from this template"})]})})]})})(),w.jsx("div",{className:JLe,children:w.jsxs("span",{className:YLe,children:[w.jsx("span",{children:w.jsx("span",{translate:"no",children:e.name||"Untitled Template"})})," "]})})]})})),eFe=_.memo((()=>{const e=NU(Bl.BRANDKIT),{brandkitTemplates:t,selectedWorkspace:o}=tl((e=>({brandkitTemplates:e.teams.brandkitTemplates,selectedWorkspace:e.workspaces.selectedWorkspace})),ol);return o===Vn?null:!e||t&&(null==t?void 0:t.length)?w.jsxs("div",{className:ULe,children:[w.jsxs("div",{className:BLe,children:[w.jsxs("div",{className:MLe,children:["Get started from a Brand Template",!e&&w.jsx(EW,{className:QLe})]}),w.jsx("div",{className:VLe})]}),w.jsx("div",{className:WLe,style:{flexWrap:"wrap"},children:!!(null==t?void 0:t.length)&&t.map((e=>w.jsx(ZLe,{template:e},e.videoId)))})]}):null})),tFe=_.memo((()=>{Th();const{modalType:e,title:t,name:o,subtitle:a,projectIds:i,projectId:s,modalStyle:n,onSubmit:r,onCancel:l,immediateRedirectPathname:d,noOverlay:c}=(()=>{const e=tl((e=>e.modal)),{title:t,subtitle:o}=e,{modalType:a,name:i,projectId:s,projectIds:n,teamId:r,onSubmit:l,onCancel:d,modalStyle:c,immediateRedirectPathname:u,noOverlay:m}=e.modalProps;return{modalType:a,name:i,title:t,subtitle:o,projectId:s,projectIds:n,modalStyle:c,teamId:r,onSubmit:l,onCancel:d,immediateRedirectPathname:u,noOverlay:m}})();if(!e)return null;const u=()=>{switch(e){case gh.EMBED_CODE:return w.jsx(dve,{hideOverlay:vh});case gh.COPY_PROJECT:if(s&&r&&l)return w.jsx(DLe,{onSubmit:r,projectId:s,onCancel:l,name:o});break;case gh.MOVE_PROJECT:if((null==i?void 0:i.length)&&r&&l)return w.jsx(FLe,{onSubmit:r,onCancel:l,projectIds:i});break;case gh.DELETE_ACCOUNT:return w.jsx(LLe,{});case gh.DELETE_PROJECT:if(null==i?void 0:i.length)return w.jsx(rfe,{projectIds:i,onSubmit:r});break;case gh.SWM_REMOVE_PROJECT:if(s)return w.jsx(XIe,{videoId:s});break;case gh.START_FROM_BRAND_TEMPLATE:return w.jsx(eFe,{});case gh.FOLDER_UPLOAD:return w.jsx(YNe,{});case gh.SIGN_IN:return w.jsx(bV,{hideSignIn:vh,immediateRedirectPathname:d})}return w.jsx("div",{})};return c?u():w.jsx(nM,{unsetCancelModal:l||vh,usePortal:!0,noPadding:null==n?void 0:n.noPadding,noCloseButton:null==n?void 0:n.noClose,noWidth:null==n?void 0:n.noWidth,children:w.jsxs("div",{className:(null==n?void 0:n.noPadding)?"":DOe,"data-cy":"kapwing-modal-overlay",children:[!!t&&w.jsx(MOe,{title:t,subHeader:a}),w.jsx("div",{children:u()})]})})})),oFe="ExamplesAdmin-module_container_OMUJg",aFe="ExamplesAdmin-module_thumbnailContainer_yYdpH",iFe="ExamplesAdmin-module_thumbnail_1AR1M",sFe="ExamplesAdmin-module_header_S1iUl";class nFe extends h.Component{constructor(e){super(e),i(this,"getTemplateChildren",(()=>{const{currentTemplate:e}=this.props;Woe(e._id).then((e=>{this.setState({children:e,loading:!1})})).catch((e=>{console.error(e),this.setState({loading:!1})}))})),this.state={children:[],loading:!0}}componentDidMount(){this.getTemplateChildren()}renderChildren(){const{children:e}=this.state;return e.length?w.jsx(w.Fragment,{children:e.map((e=>{const t=j0(e);return w.jsx(Ft,{className:aFe,to:`/videos/${e._id}`,children:w.jsx("img",{src:t,className:iFe,alt:"Thumbnail",loading:"lazy"})},e._id)}))}):w.jsx("div",{children:"No children found."})}render(){const{loading:e}=this.state;return w.jsxs("div",{className:oFe,children:[w.jsx("div",{className:sFe,children:"Content created with this template:"}),w.jsx("div",{children:"Click to view the content. Use the admin actions on the content page to add the selected video to this template's examples."}),w.jsx("span",{children:e?"Loading children...":this.renderChildren()})]})}}const rFe=je(g.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,currentTemplate:e.currentTemplate})))(nFe)),lFe="TemplateActions-module_container_PvTei",dFe="TemplateActions-module_header_uhiup",cFe="TemplateActions-module_actions_RMikg",uFe="TemplateActions-module_button_xLXlv",mFe="TemplateActions-module_monospace_5pLR3",pFe=g.connect((e=>({currentTemplate:e.currentTemplate})),(e=>ye({showToast:wl},e))),hFe=_.memo(je(pFe((e=>{const{currentTemplate:t}=e;return w.jsxs("div",{className:lFe,children:[w.jsx("div",{className:dFe,children:"Template admin actions"}),w.jsxs("div",{children:["This section is visible only to admin accounts. The current template ID is:"," ",w.jsxs("span",{className:mFe,children:['ObjectId("',t._id,'")']})]}),w.jsxs("div",{className:cFe,children:[w.jsx("div",{className:uFe,onClick:()=>{const{history:t}=e;t.push("/admin/templates/update")},children:"Edit template"}),w.jsx("div",{className:uFe,onClick:()=>{const{showToast:t,history:o,currentTemplate:a}=e;window.confirm(`Are you sure you want to delete ${a.title}?`)&&$oe(a).then((e=>{t({description:"Template deleted!",type:"success"}),o.push("/admin/templates")})).catch((e=>{mh({description:"An error occurred while deleting template.",error:e})}))},children:"Delete template"}),w.jsx("div",{className:uFe,onClick:t=>{const{history:o,currentTemplate:a}=e,i=`/videos/${a.video_id}`;o.push(i)},children:"View video asset"}),w.jsx("div",{className:uFe,onClick:()=>{const{history:t}=e;t.push("/admin/templates")},children:"Back to all templates"})]}),w.jsx(rFe,{})]})})))),gFe="AdminLongTailAnalytics-module_container_8q1rk",fFe="AdminLongTailAnalytics-module_adminLabel_Mspap",yFe="AdminLongTailAnalytics-module_analyticsRow_Faemz",vFe="AdminLongTailAnalytics-module_box_kteIn",_Fe="AdminLongTailAnalytics-module_metricName_RigA8",wFe="AdminLongTailAnalytics-module_metricValue_I-nX5";class bFe extends h.Component{constructor(e){super(e),this.state={loaded:!1,error:void 0}}async componentDidMount(){var e;const{currentUser:t}=this.props;if(!Tc(t))return;let o=new URLSearchParams(window.location.search).get("path");o||(o=window.location.pathname);const{token:a}=t,i={token:a,userId:null==(e=null==t?void 0:t.user)?void 0:e._id,path:o};try{const e=await Yr("/api/v1/admin/longTailAnalytics",{params:i});this.setState({...e,loaded:!0})}catch(IGe){const t=IGe instanceof Error?IGe.message:"Unknown error";this.setState({error:t,loaded:!0})}}render(){const{currentUser:e}=this.props,{loaded:t,pageViews:o,bounceRate:a,avgTimeOnPage:i,error:s}=this.state;return Tc(e)&&t?w.jsxs("div",{className:gFe,children:[w.jsx("span",{className:fFe,children:"Page Analytics - Last 7 Days (Only Admins See This)"}),s&&w.jsx("span",{children:s}),!s&&w.jsxs("div",{className:yFe,children:[w.jsxs("div",{className:vFe,children:[w.jsx("span",{className:_Fe,children:"Page Views"}),w.jsx("span",{className:wFe,children:o})]}),w.jsxs("div",{className:vFe,children:[w.jsx("span",{className:_Fe,children:"Bounce Rate"}),w.jsxs("span",{className:wFe,children:[a&&a.toFixed(2),"%"]})]}),w.jsxs("div",{className:vFe,children:[w.jsx("span",{className:_Fe,children:"Average Time on Page"}),w.jsxs("span",{className:wFe,children:[i&&i.toFixed(2)," seconds"]})]})]})]}):null}}const TFe=je(g.connect((e=>({currentUser:e.currentUser})))(bFe)),xFe=Object.freeze(Object.defineProperty({__proto__:null,default:TFe},Symbol.toStringTag,{value:"Module"})),SFe="LetterLinks-module_letterLinksContainer_QwlZ6",EFe="LetterLinks-module_letterLinksHeader_N5w6H",IFe="LetterLinks-module_letterLink_MD-Ac",CFe="LetterLinks-module_selectedLetterLink_ETw7G",kFe="LetterLinks-module_more_IoQTr",AFe="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),jFe=_.memo((({className:e,keyword:t,routePrefix:o})=>{const{letter:a}=ua();let i="";return a&&(i=a.toUpperCase()),w.jsxs("div",{className:`${SFe} ${e||""}`,children:[w.jsxs("div",{className:EFe,children:["Browse ",t," starting with:"]}),AFe.map((e=>w.jsx("div",{className:i===e?CFe:IFe,"data-cy":"letter-link",children:w.jsx(Ft,{to:`/${o}/directory/${e}`,children:e})},e))),w.jsx("div",{className:"MORE"===i?CFe:IFe,children:w.jsx(Ft,{to:`/${o}/directory/more`,className:kFe,children:"*"})},a),w.jsx("div",{className:IFe,children:w.jsxs(Ft,{to:`/${o}`,className:kFe,children:["All ",t]})},"all")]})})),NFe="ExploreTemplate-module_splash_NuUxD",RFe="ExploreTemplate-module_subtext_sgdJk",PFe="ExploreTemplate-module_makeItSubtext_zveaE",DFe="ExploreTemplate-module_wrapper_HwPsJ",OFe="ExploreTemplate-module_container_5quob",LFe="ExploreTemplate-module_infoContainer_qWYEA",FFe="ExploreTemplate-module_contentContainer_KEVeX",MFe="ExploreTemplate-module_video_ImBWU",UFe="ExploreTemplate-module_image_3pgvL",BFe="ExploreTemplate-module_mobileButton_uDFmq",VFe="ExploreTemplate-module_desktopButton_DHIl1",WFe="ExploreTemplate-module_buttonText_-5p0O",GFe="ExploreTemplate-module_browseContainer_y97Be",HFe="ExploreTemplate-module_keywordHeader_5M1P9",$Fe="ExploreTemplate-module_keywords_scFRn",KFe="ExploreTemplate-module_keyword_IasdR",zFe="ExploreTemplate-module_infoRow_YXndy",YFe="ExploreTemplate-module_bullet_0k1ZV",JFe="ExploreTemplate-module_genericDescription_cZeSt",qFe="ExploreTemplate-module_row_TZTsE",XFe="ExploreTemplate-module_icon_SNoVK";class QFe extends h.Component{constructor(e){super(e),i(this,"image"),i(this,"loadImage",(e=>{const t=e.getAttribute("src"),o=e.getAttribute("data-src");if(o){if(t===o)return;e.setAttribute("src",e.getAttribute("data-src")),e.onload=()=>{e.removeAttribute("data-src")}}})),i(this,"updateCurrentTemplate",(()=>{const{match:e,history:t}=this.props,{params:o}=e,{slug:a}=o;this.setState({loading:!0}),Loe(a).then((e=>{this.setState({loading:!1}),this.loadTemplateFonts(e)})).catch((e=>{mh({description:"Error loading template",error:e}),t.replace("/explore"),this.setState({loading:!1})}))})),i(this,"loadTemplateFonts",(e=>{var t;if(null==(t=null==e?void 0:e.video)?void 0:t.layers){const t=[];for(const o of e.video.layers)"text"===o.type&&o.fontFamily&&t.push(o.fontFamily);t.length>0&&VY(t)}})),i(this,"goToEditor",(async()=>{const{history:e,isSingleMedia:t,setTemplateSource:o,showToast:a,video_id:i}=this.props;if(this.setState({loadingTemplate:!0}),i)o("explore"),e.push(`/editor/videos/${i}`);else if(t){const{resetStudio:e,addLayers:t,singleMedia:a}=this.props,{url:i}=a;e();const s=await eY(i,{source:"upload"});o("explore"),t({layers:[s]}),rE()}else a({description:"The template could not be loaded. Please try again later.",type:"error"}),this.setState({loadingTemplate:!1})})),i(this,"isMp4",(e=>{if("string"!=typeof e)return!0;try{return new URL(e).pathname.endsWith(".mp4")}catch(IGe){return e.endsWith(".mp4")}})),this.state={loading:!1,loadingTemplate:!1},this.image=_.createRef()}componentDidMount(){const{setParentId:e,currentTemplate:t,match:o}=this.props,{params:a}=o,{slug:i}=a;(null==t?void 0:t._id)&&e(t._id),(s.isEmpty(t)||t.slug!==i)&&this.updateCurrentTemplate();const n=this.image.current;n&&this.loadImage(n)}componentDidUpdate(e){const{_id:t,setParentId:o}=this.props;e._id!==t&&o(t);const a=this.image.current;a&&this.loadImage(a)}renderMedia(){const{title:e,thumbnail:t}=this.props,o=k0(this.props,"image_url"),a=k0(this.props,"video_url")||o,i=!this.isMp4(a);let n=o,r=480,l=480;if(!s.isEmpty(t)){const{url:e,width:o,height:a}=t;n=e,o>=a?l=Math.round(a*r/o):r=Math.round(o*l/a)}return i?w.jsx("img",{src:n,"data-src":o,alt:e,className:UFe,ref:this.image,width:r,height:l}):w.jsx("video",{className:MFe,controls:!0,src:a,playsInline:!0,preload:"auto",poster:o,autoPlay:!0,muted:!0,width:r,height:l})}renderKeywords(){const{keywords:e,description:t}=this.props;if(t)return null;if(e&&e.length){const t=e.split(", ");return w.jsxs("div",{className:$Fe,children:[w.jsx("span",{className:HFe,children:"Keywords:"}),t.map((e=>w.jsx("span",{className:KFe,children:`${e} `},e)))]})}return null}renderGenericDescription(){return w.jsxs("div",{className:JFe,children:[w.jsxs("div",{className:qFe,children:[w.jsx("div",{className:XFe,children:w.jsx(Vi,{})}),w.jsx("div",{children:"100% customizable online"})]}),w.jsxs("div",{className:qFe,children:[w.jsx("div",{className:XFe,children:w.jsx(Wi,{})}),w.jsx("div",{children:"No watermarks (just sign in!)"})]}),w.jsxs("div",{className:qFe,children:[w.jsx("div",{className:XFe,children:w.jsx(Gi,{})}),w.jsx("div",{children:"Fast and powerful"})]}),w.jsxs("div",{className:qFe,children:[w.jsx("div",{className:XFe,children:w.jsx(Hi,{})}),w.jsx("div",{children:"Edit and download from any device"})]}),w.jsxs("div",{className:qFe,children:[w.jsx("div",{className:XFe,children:w.jsx($i,{})}),w.jsx("div",{children:"Add video, audio, and images"})]})]})}renderContent(){const{title:e,description:t,currentUser:o,height:a,width:i}=this.props,{loadingTemplate:s}=this.state,n=k0(this.props,"video_url");let r=!0;return n&&n.endsWith("mp4")&&(r=!1),w.jsxs(w.Fragment,{children:[w.jsx("div",{className:DFe,"data-cy":"explore-template-container",children:w.jsx("div",{className:OFe,children:w.jsxs("div",{className:LFe,children:[w.jsx("h1",{className:NFe,children:e}),w.jsx("div",{onClick:this.goToEditor,className:FFe,children:this.renderMedia()}),s?w.jsx("button",{type:"button",className:BFe,disabled:!0,children:"Loading ..."}):w.jsxs("button",{type:"button",className:BFe,"data-cy":"edit-template-button-mobile",onClick:this.goToEditor,children:[w.jsx("div",{className:WFe,children:"Edit This Template"}),w.jsx(bo,{className:"collage-chevron",size:18})]}),w.jsxs("div",{children:[w.jsxs("div",{className:zFe,children:[a&&i?w.jsxs(w.Fragment,{children:[w.jsxs("div",{children:[Math.round(i),"px ×"," ",Math.round(a),"px"]}),w.jsx("div",{className:YFe,children:"•"})]}):null,w.jsx("div",{children:r?"Image Template":"Video Template"})]}),t?w.jsx("h3",{className:RFe,dangerouslySetInnerHTML:{__html:t}}):this.renderGenericDescription(),w.jsx("button",{type:"button",className:VFe,"data-cy":"edit-template-button-desktop",disabled:s,onClick:this.goToEditor,children:s?"Loading...":w.jsxs(w.Fragment,{children:[w.jsx("div",{className:WFe,children:"Edit This Template"}),w.jsx(bo,{className:"collage-chevron",size:18})]})}),w.jsx("div",{className:PFe,children:"Click above to edit this template directly in your browser. Easily remix this template with your own text, images, and videos."}),this.renderKeywords()]})]})})}),w.jsx("div",{className:GFe,children:w.jsx(jFe,{keyword:"templates",routePrefix:"explore"})}),w.jsxs(d9,{children:[w.jsx(TFe,{}),Tc(o)&&w.jsx(hFe,{})]})]})}render(){const{loading:e}=this.state,{title:t,description:o,keywords:a,currentTemplate:i}=this.props,{match:n}=this.props,{params:r}=n,{slug:l}=r;if(s.isEmpty(i)||i.slug!==l)return w.jsx(Y4,{});const d=k0(this.props,"image_url");let c=o;return c||(c=`Use this customizable ${t} page as a starting point for your content. Create and edit this template for free in just a few clicks. Find and discover new content on Kapwing.`),w.jsxs(w.Fragment,{children:[w.jsxs(Mt,{children:[w.jsx("title",{children:t}),w.jsx("meta",{name:"description",content:c}),w.jsx("meta",{name:"keywords",content:a}),w.jsx("meta",{property:"og:title",content:t}),w.jsx("meta",{property:"og:description",content:c}),w.jsx("meta",{property:"og:image",content:d}),w.jsx("meta",{property:"twitter:image",content:d}),w.jsx("link",{rel:"canonical",href:`https://www.kapwing.com/explore/${l}`})]}),w.jsx(Q9,{}),e?w.jsx(Y4,{}):this.renderContent(),w.jsx(h8,{})]})}}const ZFe=je(g.connect((e=>{var t,o,a,i,s,n,r,l,d,c,u,m,p,h,g;return{currentUser:e.currentUser,currentTemplate:e.currentTemplate,_id:null==(t=e.currentTemplate)?void 0:t._id,description:null==(o=e.currentTemplate)?void 0:o.description,keywords:null==(a=e.currentTemplate)?void 0:a.keywords,og_description:null==(i=e.currentTemplate)?void 0:i.og_description,image_url:null==(s=e.currentTemplate)?void 0:s.image_url,title:null==(n=e.currentTemplate)?void 0:n.title,video_id:null==(r=e.currentTemplate)?void 0:r.video_id,video_url:null==(l=e.currentTemplate)?void 0:l.video_url,video:null==(d=e.currentTemplate)?void 0:d.video,slug:null==(c=e.currentTemplate)?void 0:c.slug,height:null==(u=e.currentTemplate)?void 0:u.height,width:null==(m=e.currentTemplate)?void 0:m.width,thumbnail:null==(p=e.currentTemplate)?void 0:p.thumbnail,isSingleMedia:null==(h=e.currentTemplate)?void 0:h.isSingleMedia,singleMedia:null==(g=e.currentTemplate)?void 0:g.singleMedia}}),(e=>ye({addLayers:Fv,setEditorPath:q6,setParentId:Poe,setTemplateSource:zoe,resetStudio:uD,showToast:wl},e)))(QFe)),eMe="snapshot-body-module_snapshotContainer_MD-tQ",tMe="snapshot-body-module_mobileButtons_gdnca",oMe="snapshot-body-module_buttonWrapper_NezeG",aMe="snapshot-body-module_desktopButtons_IG9xD",iMe="snapshot-body-module_leftButtonContainer_6AbI-",sMe="snapshot-body-module_rightButtonContainer_W8VpL",nMe="snapshot-body-module_mainContainer_-kmC5",rMe="snapshot-body-module_videoContainer_-xrtQ",lMe="snapshot-body-module_innerVideoContainer_Wq5ta",dMe="snapshot-body-module_video_BFs4Q",cMe="snapshot-body-module_image_bftEk",uMe="snapshot-body-module_bottomContainer_et9wx",mMe="snapshot-body-module_shareText_XUHep",pMe="snapshot-body-module_sidebarContainer_EtH2N",hMe="snapshot-body-module_mobileOnly_G65R3",gMe="snapshot-body-module_desktopOnly_R-QoI",fMe="snapshot-body-module_underButtons_npefi",yMe=h.createContext({userInTeam:!1,team:{},snapshot:{},refetch:()=>{},isLoading:!0}),vMe=_.memo((({snapshot:e,snapshotId:t,videoId:o})=>{var a;const i=Ve(),s=xfe(),[n,r]=_.useState(0),[l,d]=_.useState(e);h.useEffect((()=>{(async()=>{if(t&&!e){const e=await Yr(`/api/v2/snapshots/${t}/snapshotPreview`,{signal:s.signal});(null==e?void 0:e.snapshot)&&d(e.snapshot)}else if(o&&!e&&!t){const e=await Yr(`/api/v2/videos/${o}/snapshotPreview`,{signal:s.signal});(null==e?void 0:e.snapshot)&&d(e.snapshot)}})()}),[t,e,o,s.signal]);const c=()=>{if(!n)return r(1),void(l&&d({...l,downloadUrl:`${l.downloadUrl}&retry=1`}));e&&(Fm(ym.ACCESS_EXPIRED_EXPORT,{"Video ID":e.videoId,"Snapshot ID":e._id,"Entry Point":Oge.SNAPSHOT_PAGE}),i.push(`/videos/${e.videoId}`))};return l?!l.duration||(null==(a=l.downloadUrl)?void 0:a.includes(".gif"))?w.jsx("img",{alt:"Final",src:l.downloadUrl,className:cMe,"data-cy":"final-image",loading:"lazy",onError:c}):w.jsx("video",{className:dMe,controls:!0,playsInline:!0,preload:"auto",src:l.downloadUrl,controlsList:"nodownload",onError:c}):null})),_Me=_.memo((()=>{const e=Ve(),{snapshot:t}=h.useContext(yMe),o=tl((e=>e.currentVideo)),a=bc(),i=Dge(),s=w.jsx(Qo,{}),n=w.jsx(la,{}),r=h.useCallback((async()=>{if(!t)return;const{copiedProject:o,destinationFolder:a}=await i(t._id,t.projectId,{entryPoint:Lge.FINAL_VIDEO_PAGE,name:t.name});o&&a&&e.push(`/${o.videoId}/studio/editor`)}),[i,e,t]),l=h.useCallback((()=>{e.push("/")}),[e]),d=()=>w.jsx(Kfe,{label:"Make a copy",icon:s,dataCy:"copy-and-edit-button",onClick:r});return w.jsxs("div",{className:eMe,children:[w.jsxs("div",{className:nMe,children:[t&&(c=t,w.jsxs("div",{className:aMe,children:[w.jsxs("div",{className:iMe,children:[a&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:oMe,children:w.jsx(mye,{videoId:c.videoId,commentingView:!0})}),w.jsx("div",{className:oMe,children:d()})]}),w.jsx(Yfe,{})]}),w.jsxs("div",{className:sMe,children:[w.jsx("div",{className:oMe,children:w.jsx(Sye,{metadata:{filesize:c.filesize,quality:c.quality,format:c.format,resolution:c.resolution}})}),w.jsx(gye,{downloadUrl:c.downloadUrl,entryPoint:Oge.SNAPSHOT_PAGE})]})]})),w.jsx("div",{className:rMe,children:w.jsx("div",{className:lMe,children:t?w.jsx(vMe,{snapshot:t}):w.jsx(eme,{})})}),w.jsx("div",{className:`${uMe} ${gMe}`,children:w.jsxs("div",{className:mMe,children:["Tag ",w.jsx("strong",{children:"#kapwing"})," so we can find you on social media!"," "]})})]}),w.jsxs("div",{className:pMe,children:[t&&(e=>w.jsxs("div",{className:tMe,children:[!!a&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:oMe,children:w.jsx(mye,{videoId:e.videoId})}),w.jsx("div",{className:oMe,children:d()})]}),w.jsx("div",{className:oMe,children:w.jsx(gye,{inRightSidebar:!0,downloadUrl:e.downloadUrl,entryPoint:Oge.SNAPSHOT_PAGE})}),w.jsx("div",{className:oMe,children:w.jsx(Yfe,{})}),w.jsx("div",{className:oMe,children:w.jsx(Kfe,{label:"Return to workspace",icon:n,onClick:l})})]}))(t),w.jsx(Kie,{video:o}),w.jsx("div",{className:`${fMe} ${hMe}`,children:w.jsxs("div",{className:mMe,children:["Tag ",w.jsx("strong",{children:"#kapwing"})," so we can find you on social media!"]})})]})]});var c})),wMe=()=>{const{snapshot:e,userInTeam:t,isLoading:o,refetch:a}=h.useContext(yMe),i=!t,s=h.useCallback((async t=>{e&&a&&(await Jr(`/api/v2/snapshots/${e._id}/rename`,{body:{name:t}}),a())}),[a,e]);return w.jsxs("div",{className:Ife,children:[w.jsxs("div",{className:Cfe,children:[w.jsx(ffe,{}),w.jsx(Ft,{className:kfe,to:"/",children:"KAPWING"})]}),w.jsx("div",{className:Ife,children:w.jsxs("div",{className:jfe,children:[!o&&e&&a?w.jsx("div",{className:Afe,children:t?w.jsx(Tfe,{value:e.name||"Untitled Export",onSave:s}):w.jsx("span",{children:e.name||"Untitled Export"})}):w.jsx(eme,{}),i&&e&&w.jsx(_pe,{})]})}),w.jsx("div",{className:Nfe,children:w.jsx(hfe,{})})]})},bMe=()=>{const{snapshot_id:e}=ua(),{snapshotData:t}=(e=>{const t=il(),o=Ve(),{data:a,refetch:i,isLoading:s,error:n}=Efe(`/api/v2/snapshots/${e}/snapshotPreview`),[r,l]=h.useState({isLoading:!0});return h.useEffect((()=>{(null==a?void 0:a.snapshot._id)&&Fm(ym.ACCESS_SNAPSHOT_PAGE,{"Snapshot ID":null==a?void 0:a.snapshot._id,"Is Team Member":null==a?void 0:a.userInTeam})}),[null==a?void 0:a.snapshot._id,null==a?void 0:a.userInTeam]),h.useEffect((function(){a&&a.snapshot||!n||(mh({error:n,description:"Unable to load export"}),o.push("/")),(null==a?void 0:a.snapshot)&&a.team&&(l({...a,refetch:i,isLoading:s}),t(Ip(a.team._id)))}),[a,i,s,n,o,t]),{data:a,snapshotData:r}})(e),o=tl((e=>e.config.FACEBOOK_APP_ID));return w.jsxs(yMe.Provider,{value:t,children:[(()=>{var e,a,i;const s=`${(null==(e=t.snapshot)?void 0:e.name)||"Export"} - Kapwing`,n=`${(null==(a=t.snapshot)?void 0:a.name)||"Export"} made on Kapwing`;return w.jsxs(Mt,{children:[w.jsx("title",{children:s}),w.jsx("meta",{name:"description",content:n}),w.jsx("meta",{property:"fb:app_id",content:o}),w.jsx("meta",{property:"og:description",content:n}),w.jsx("meta",{property:"og:title",content:(null==(i=t.snapshot)?void 0:i.name)||"Export"}),w.jsx("meta",{property:"og:url",content:`${window.location.href}`}),w.jsx("meta",{name:"robots",content:"noindex, nofollow"})]})})(),w.jsx(wMe,{}),w.jsx(_Me,{}),w.jsx(h8,{})]})},TMe="Toasts-module_viewport_k-GHD",xMe="Toast-module_toast_pIgA0",SMe="Toast-module_iconContainer_Z2lS5",EMe="Toast-module_icon_iy6jw",IMe="Toast-module_body_HQtZr",CMe="Toast-module_header_-ZlZx",kMe="Toast-module_description_IfpLw",AMe="Toast-module_link_OXE-x",jMe="Toast-module_success_CHkuZ",NMe="Toast-module_warning_rPCnd",RMe="Toast-module_error_SPqoO",PMe="Toast-module_info_84tbL",DMe="Toast-module_close_dYbI7",OMe={[Nv.BROWSER_WARN]:()=>{sh.set("BROWSER_COOLDOWN_DATE",(new Date).toString())}},LMe=_.memo((({id:e,toast:t})=>{const o=il(),a=[xMe],{description:i,link:s,open:n,subDescription:r,type:l,callbackId:d}=t,c=h.useCallback((()=>{(e=>{e&&OMe[e]()})(d),o(vl(e)),setTimeout((()=>{o(_l(e))}),400)}),[d,o,e]);let u,m,p;switch(l){case"success":a.push(jMe),u=Xi,m=28,p="Success";break;case"warning":a.push(NMe),u=Ni,m=24,p="Warning";break;case"error":a.push(RMe),u=ji,m=24,p="Error";break;case"info":a.push(PMe),u=to,m=24,p=""}const g=s?(f=s).onClick?w.jsx("span",{className:AMe,onClick:f.onClick,"data-testid":"toast__link",children:f.text}):w.jsx("a",{href:f.href,className:AMe,target:"_blank",rel:"noopener noreferrer","data-testid":"toast__link",children:f.text}):null;var f;const y=h.useCallback((e=>{e||c()}),[c]);return w.jsxs(Ki,{open:n,className:a.join(" "),onOpenChange:y,duration:1e4,"data-cy":`${l}-toast`,children:[w.jsx("div",{className:SMe,children:w.jsx(u,{className:EMe,size:m})}),w.jsxs("div",{className:IMe,children:[w.jsx(zi,{className:CMe,children:p}),w.jsxs(Yi,{children:[w.jsxs("div",{className:kMe,children:[i,(null==s?void 0:s.inline)&&g,r?` (${r})`:""]}),!(null==s?void 0:s.inline)&&g]})]}),w.jsx(Ji,{className:DMe,"data-cy":"toast-close","data-testid":"toast__close",children:w.jsx(qi,{size:16})})]})})),FMe=_.memo((()=>{const e=tl((e=>e.toasts));return w.jsxs(w.Fragment,{children:[w.jsx(Qi,{className:TMe}),Object.entries(e).map((([e,t])=>w.jsx(LMe,{id:e,toast:t},e)))]})})),MMe="TeamInfo-module_teamName_A6ALj",UMe="TeamInfo-module_numberCount_P4oT8",BMe="TeamInfo-module_teamContainer_VZuWB",VMe="TeamInfo-module_teamNameContainer_0d9Oh",WMe="TeamInfo-module_center_Zj8fV",GMe="TeamInfo-module_profilePicture_Xdk9F",HMe=_.memo((({teamId:e,teamName:t,teamPicture:o,teamMemberCount:a,button:i})=>{const s=h.useMemo((()=>({_id:e,name:t,picture:o})),[e,t,o]);return w.jsxs("div",{className:BMe,children:[w.jsx(b9,{className:GMe,team:s,absoluteHeight:40,absoluteWidth:40})," ",w.jsxs("div",{className:`${VMe} ${a?"":WMe}`,children:[w.jsx("div",{className:MMe,children:t}),w.jsx("div",{className:UMe,children:a?`${a} ${Nc("Member","Members",a)}`:""})]}),i]})})),$Me={pathname:"/home"},KMe=()=>{const e=tl((e=>e.currentUser.user.onboarding)),{inviteKey:t}=ua(),{acceptInvite:o,acceptingInvite:a}=gpe(),{isFetching:i,teamInfo:n,inviterInfo:r,error:l}=wTe(t,ppe.EMAIL),{pushWithSource:d}=_oe(),c=()=>{d("/home",voe.NEW_USER_INVITE_DISMISSED)},u=h.useCallback((async()=>{await FK({skipped:!0}),await np(),d("/home",voe.NEW_USER_INVITE_ACCEPTED)}),[d]),m=h.useCallback((async()=>{const a=!((null==e?void 0:e.survey)||(null==e?void 0:e.skipped)),i={onSuccess:u,withoutToast:a};await o(t,hpe.ONBOARDING_MODAL,i)}),[o,u,t,null==e?void 0:e.skipped,null==e?void 0:e.survey]),p=h.useCallback((async()=>{await m()}),[m]);if(l&&!i)return w.jsx("div",{"data-testid":"redirect-to-home",children:w.jsx(Aa,{to:$Me})});if(i||!n||!r)return w.jsx(Y4,{});return w.jsx("div",{className:nSe.backgroundImage,style:{backgroundImage:'url("https://cdn-useast1.kapwing.com/static/MTK-abstracted-workspace-2.webp")'},children:w.jsx(nM,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,children:(()=>{const e=r.firstName?`Join ${s.capitalize(r.firstName)}'s team`:`Join ${n.name} on Kapwing`,t=r.firstName?`${s.capitalize(r.firstName)} has invited you to join their team workspace. Accept the invitation to start collaborating on projects with them!`:`You have been invited to ${n.name}. Accept the invitation to start collaborating on projects now!`;return w.jsxs("div",{className:nSe.modalWithImageContainer,children:[w.jsxs("div",{className:nSe.left,children:[w.jsx("div",{className:nSe.header,children:e}),w.jsx("p",{children:t}),w.jsx(HMe,{teamId:n._id,teamName:n.name,teamMemberCount:n.memberCount,teamPicture:n.picture}),w.jsx(Iie,{className:nSe.modalPrimaryButton,onClick:p,buttonText:a?"Joining Team...":"Accept Invite",testId:"accept-invite-button"})]}),w.jsx("div",{className:nSe.right,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/mJA-NewUserInviteAcceptModal.webp"\n          )'}}),w.jsx("div",{className:`${nSe.exit} ${nSe.dark}`,onClick:c,"data-testid":"dismiss-button",children:w.jsx(ve,{})})]})})()})})},zMe=_.memo((()=>{const e=Ve(),t="SSO Sign In — Kapwing",o="Kapwing works better if you sign in. Sign in to access your projects, save content to your workspace, preview beta features, and much more.",a=h.useCallback((()=>{e.push("/signin")}),[e]);return w.jsxs(w.Fragment,{children:[w.jsx(Q9,{}),w.jsxs(Mt,{children:[w.jsx("title",{children:t}),w.jsx("meta",{name:"description",content:o}),w.jsx("meta",{name:"keywords",content:"sign in, login, signup, sign in to Kapwing"}),w.jsx("meta",{property:"og:title",content:t}),w.jsx("meta",{property:"og:description",content:o})]}),w.jsxs("div",{className:poe,children:[w.jsx("div",{className:hoe,children:w.jsxs("div",{className:goe,children:[w.jsx("div",{className:pV,children:"Sign in with SSO"}),w.jsx("div",{className:hV,children:"Sign in with your company provided credentials to access all of the benefits of your Enterprise team workspace."}),w.jsx(lV,{onEmailSignIn:a})]})}),w.jsx("div",{className:foe,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/7ne-sign-in-illustration.webp",className:yoe,alt:"Benefits to signing in to Kapwing"})})]}),w.jsx(h8,{})]})})),YMe={upload:"DedicatedUploadPage-module_upload_Pm-d7",uploadContainer:"DedicatedUploadPage-module_uploadContainer_0V6gG",uploadHeader:"DedicatedUploadPage-module_uploadHeader_LDm30",kapwing:"DedicatedUploadPage-module_kapwing_-nImu",uploadContent:"DedicatedUploadPage-module_uploadContent_sOOKL",uploadInstructions:"DedicatedUploadPage-module_uploadInstructions_vTnpT",cmlDirective:"DedicatedUploadPage-module_cmlDirective_8jEtM",projectTitle:"DedicatedUploadPage-module_projectTitle_jpUWS",loading:"DedicatedUploadPage-module_loading_WB8S6",shimmer:"DedicatedUploadPage-module_shimmer_1-Hvb",uploadArea:"DedicatedUploadPage-module_uploadArea_wLJKW",uploadInput:"DedicatedUploadPage-module_uploadInput_xEEdM",uploadLabel:"DedicatedUploadPage-module_uploadLabel_Hrbjh",uploadIcon:"DedicatedUploadPage-module_uploadIcon_OLeyw",labelContainer:"DedicatedUploadPage-module_labelContainer_7vB9W",uploadInfoText:"DedicatedUploadPage-module_uploadInfoText_cdovg",uploadInfo:"DedicatedUploadPage-module_uploadInfo_OL4xc",uploadGrid:"DedicatedUploadPage-module_uploadGrid_qWiSs",pendingUpload:"DedicatedUploadPage-module_pendingUpload_pIQXm",spinner:"DedicatedUploadPage-module_spinner_c89cm",spin:"DedicatedUploadPage-module_spin_ex1AL",error:"DedicatedUploadPage-module_error_XxZBq",success:"DedicatedUploadPage-module_success_zVLSj",pending:"DedicatedUploadPage-module_pending_KJcKk",progress:"DedicatedUploadPage-module_progress_4tyXW"};const JMe=_.memo((function({file:e,onUploadSucceeded:t,onUploadFailed:o,planTier:a,videoId:i}){const s=il(),n=h.useRef(null),[r,l]=h.useState(!0),[d,c]=h.useState(!1),[u,m]=h.useState(0),[p,g]=h.useState("https://cdn-useast1.kapwing.com/static/FHR-Untitled_Export-dcLoANEQZ.webp"),f=h.useRef({}),y=h.useCallback((()=>{t(),c(!0),Fm(ym.UPLOADED_FROM_MOBILE)}),[t]),v=h.useCallback((async(e,t)=>{const o="video"===t?document.createElement("video"):document.createElement("img");new Promise(((t,a)=>{o.onload=()=>{t()},o instanceof HTMLVideoElement&&(o.preload="metadata",o.currentTime=0,o.muted=!0,o.playsInline=!0,o.onload=null,o.autoplay=!0,o.oncanplaythrough=()=>{o.play()},o.onplay=()=>{o.pause(),t()}),o.onerror=()=>{a()},o.src=e})).then((()=>{const e=document.createElement("canvas"),t=e.getContext("2d");if(e.style.left="-10000px",e.style.top="-10000px",e.style.position="absolute",!t)return;let a=0,i=0;if(o instanceof HTMLVideoElement?(a=o.videoWidth||o.width,i=o.videoHeight||o.height):(a=o.naturalWidth,i=o.naturalHeight),!a||!i)return;f.current.dimensions={width:a,height:i},e.width=a,e.height=i,t.drawImage(o,0,0);const s=e.toDataURL("image/jpeg",.8);g(s)})).catch((()=>{}))}),[]),_=h.useCallback((e=>{if(e.lengthComputable){const t=Math.round(e.loaded/e.total*100);m(t)}}),[]),b=h.useCallback(((e,t)=>new Promise(((o,a)=>{const s=new XMLHttpRequest;s.open("PUT",e,!0),s.onload=()=>{const s=new URL(e).searchParams.get("name");if(!s||!i.current)return a();F$({...f.current,bucket:hn,name:s||t.name,blob_name:s,size:t.size},{skipSigning:!0,video_id:i.current,linkCMLToThisProject:!0}).then((({asset:a})=>{y(),LB(t).then((o=>{if(o)return pK({asset_id:a._id,resource:s,type:"blob",conversion_type:yB(e,t.type)})})).catch((()=>{})),o()})).catch((()=>{a()}))},s.upload.onprogress=_,s.setRequestHeader("Content-Type",t.type),s.send(t),s.onerror=()=>{a()}}))),[y,_,i]),T=h.useCallback((async e=>{try{const t=await yP({files:[{file:e}]}),{upload_uri:o}=t.uris[0];await b(o,e)}catch(t){s(wl({description:t.message,type:"error"})),l(!1)}}),[s,b]),x=h.useCallback((async e=>{var t;const o=!!(null==(t=a.current)?void 0:t.hasPermission(Bl.UNLIMITED_UPLOAD_SIZE_LIMIT));if(!e)return void s(wl({description:"Please choose a file to upload.",type:"error"}));const i=URL.createObjectURL(e),n=vB(e);AB(i,e).then((e=>{if("video"===(null==e?void 0:e.type)||"image"===(null==e?void 0:e.type))return v(i,e.type)})).catch((e=>{console.error(e)})),n?wB(n)||bB(n)?e.size>6442450944?s(wl({description:"Your content must be under 6GB",type:"warning"})):(!o&&e.size>262144e3&&s(wl({description:"Your upload is over 250MB. You may need to upgrade to use some Kapwing features.",type:"warning"})),await T(e)):s(wl({description:"Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, .ogg, .mpeg formats.",type:"error"})):s(wl({description:"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension.",type:"error"}))}),[s,v,T,a]),S=h.useCallback((async e=>{if(n.current)return n.current;l(!0);try{n.current=x(e),await n.current}catch(IGe){s(wl({description:`An error occurred uploading ${e.name||"your file"}. Please refresh the page and try again.`,type:"warning"})),console.error(IGe)}l(!1)}),[x,s]),E=h.useMemo((function(){return p?{backgroundImage:`url(${p})`,backgroundSize:"cover",backgroundPosition:"center"}:{}}),[p]);h.useEffect((function(){S(e)}),[e,S]),h.useEffect((function(){r||d||o()}),[r,d,o]);const I=!r&&!d,C=r&&!d;return w.jsxs("div",{className:YMe.pendingUpload,style:E,children:[C&&w.jsx("div",{className:YMe.spinner}),I&&w.jsx(Zi,{className:YMe.error}),!I&&w.jsx("div",{className:YMe.progress,style:{height:100-u+"%"}}),!I&&w.jsx(es,{className:[YMe.success,r&&YMe.pending].join(" ")})]})}));function qMe(){const e=il(),{id:t}=ua(),[o,a]=h.useState(!0),i=h.useRef(null),[s,n]=h.useState(null),r=h.useRef(null),[l,d]=h.useState([]),[c,u]=h.useState(0),[m,p]=h.useState(0),g=h.useCallback((()=>{u((e=>e-1))}),[]),f=h.useCallback((()=>{p((e=>e+1)),u((e=>e-1))}),[]);h.useEffect((function(){function o(){e(wl({description:"This upload link is no longer valid. Please create a new one and try again.",type:"warning"})),eE("/")}!async function(){try{const e=await Yr("/api/v1/upload-link",{params:{uploadCode:t}});if(!e.videoId)return void o();a(!1),i.current=e.videoId,n(e.videoName),r.current=$c(e.planTier),Fm(ym.MOBILE_UPLOAD_PAGE_ACCESSED)}catch(IGe){o()}}()}),[e,t,s]);const y=h.useCallback((e=>{if(!e.target.files)return;const t=Array.from(e.target.files);d((e=>{const o=[];for(const a of t)e.some((e=>e.name===a.name&&e.size===a.size))||o.push(a);return 0===o.length?e:(u((e=>e+o.length)),[...o,...e])}))}),[]),v=h.useMemo((()=>0!==c?`${rW(c,"file")} uploading`:0!==m?`${rW(m,"upload")} failed`:`${rW(l.length,"file")} uploaded`),[m,c,l.length]);return w.jsx("div",{className:YMe.uploadContainer,children:w.jsxs("div",{className:YMe.upload,children:[l.length?w.jsxs("div",{className:YMe.uploadInfo,children:[w.jsx("div",{className:YMe.uploadInfoText,children:v}),w.jsx("div",{className:YMe.cmlDirective,children:"Your files will appear in the Media tab of your project"}),w.jsx("div",{className:YMe.uploadGrid,children:l.map((e=>w.jsx(JMe,{file:e,onUploadFailed:f,onUploadSucceeded:g,planTier:r,videoId:i},e.name)))})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:YMe.uploadHeader,children:w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/gdu-kapwing-logo-transparent.webp",className:YMe.kapwing,alt:""})}),w.jsxs("div",{className:YMe.uploadInstructions,children:["Upload files from your phone to"," ",w.jsx("span",{className:[YMe.projectTitle,o&&YMe.loading].join(" "),children:s})," ","on Kapwing"]})]}),w.jsxs("div",{className:YMe.uploadArea,children:[w.jsx("input",{type:"file",id:"file",className:YMe.uploadInput,accept:"video/*,image/*,audio/*",onChange:y,multiple:!0}),w.jsxs("div",{className:YMe.labelContainer,children:[w.jsx(ts,{className:YMe.uploadIcon}),w.jsx("label",{htmlFor:"file",className:YMe.uploadLabel,children:0===l.length?w.jsx("span",{children:"Click here to upload"}):w.jsxs("span",{children:["Upload more files to"," ",w.jsx("span",{className:YMe.projectTitle,children:s})]})})]})]})]})})}const XMe="Header-module_breadcrumbContainer_ES-I1",QMe="Header-module_headerContainer_h3TiH",ZMe="Header-module_headerLeft_tzLN5",eUe="Header-module_headerRight_8Dy3L",tUe="Header-module_breadcrumbLink_ykDCl",oUe="Header-module_breadcrumbHomeLink_9V1ro",aUe="Header-module_upgradeLabel_rbpuI",iUe="Header-module_projectName_pPENb",sUe="Header-module_noEdit_Gy7ez",nUe="Header-module_projectNameContainer_Tz7Z6",rUe=({workflow:e})=>{const t=tl((e=>e.currentUser)),{showUpgrades:o}=ou(),[a,i]=h.useState((null==e?void 0:e.name)||"Untitled Repurpose Project"),s=Ac(),{currentFolder:n}=eNe(),r=(null==n?void 0:n._id)===(null==e?void 0:e.folderId),l=(null==s?void 0:s._id)===(null==e?void 0:e.teamId),d=!(null==e?void 0:e.folderId)||r&&l,{tour:c,isOpen:u}=wue(),m=c===fL.RepurposeSample&&u,p=(null==e?void 0:e._id)===qNe||m,g=e=>{e.stopPropagation()};return w.jsxs("div",{className:QMe,children:[w.jsxs("div",{className:ZMe,children:[w.jsx(ffe,{currentFolderId:null==n?void 0:n._id}),w.jsxs("div",{className:XMe,"data-cy":"breadcrumbs",children:[wc(t)?w.jsxs(w.Fragment,{children:[w.jsx(Ft,{to:"/home",onClick:g,className:oUe,"data-testid":"header-breadcrumb-link",translate:"no",children:"Repurpose Studio"}),d&&n&&!p&&w.jsx(Ft,{to:`/folder/${n._id}`,onClick:g,className:tUe,"data-testid":"header-breadcrumb-link",translate:"no",children:(null==n?void 0:n.name)||w.jsx(PF,{})})]}):w.jsx(Ft,{to:"/",onClick:g,className:tUe,children:"Kapwing"}),w.jsx(Io,{})]}),w.jsx("span",{className:iUe,children:!d||p?w.jsx("div",{className:sUe,children:a}):w.jsx("input",{disabled:!d||p,className:nUe,onChange:e=>i(e.target.value),onBlur:()=>{e&&Mje(e._id,a)},onKeyDown:e=>i(e.target.value),placeholder:"Highlight Clips",value:a})}),o&&w.jsx(p9,{className:aUe,action:Vl.STUDIO}),wc(t)&&w.jsx(y9,{className:aUe})]}),w.jsx("div",{className:eUe,children:w.jsx(hfe,{currentUser:t})})]})},lUe="Select-module_disabled_NXlEL",dUe="Select-module_select_pyZ8p",cUe="Select-module_dark_N9K3c",uUe="Select-module_trigger_HcEZU",mUe="Select-module_item_qkLet",pUe="Select-module_icon_PFBTq",hUe="Select-module_viewport_k06dA",gUe=_.memo((e=>{const{label:t,icon:o,className:a,value:i,theme:s,...n}=e,r=s===RF.Studio?cUe:"";return w.jsx(os,{className:mt(mUe,a,r),value:i,...n,children:w.jsxs(as,{children:[t," ",w.jsx("div",{className:pUe,children:o})]})})})),fUe=_.memo((({value:e,onValueChange:t,items:o,className:a,theme:i,disabled:s=!1})=>{const n=i===RF.Studio?cUe:"";return w.jsx("div",{className:mt(dUe,n,{[lUe]:s},a),children:w.jsxs(is,{value:e,onValueChange:t,children:[w.jsxs(ss,{className:mt(uUe,n),children:[w.jsx(ns,{}),w.jsx(rs,{className:pUe,children:w.jsx(xt,{})})]}),w.jsx(ls,{children:w.jsx(ds,{children:w.jsx(cs,{className:mt(hUe,n),children:o})})})]})})})),yUe=_.memo((({setLanguageCode:e,defaultLanguageCode:t,className:o,theme:a,disabled:i})=>{const[s,n]=h.useState(t??"en-US"),r=h.useCallback((t=>{e(t),n(t)}),[e]),l=h.useMemo((()=>Xn.map((({en:e,code:t,label:o},i)=>w.jsx(gUe,{label:`${e} - ${o}`,value:t,theme:a},i)))),[a]);return w.jsx(fUe,{value:s,onValueChange:r,items:l,className:o,theme:a,disabled:i})})),vUe="RepurposeCreate-module_wrapper_pdvxQ",_Ue="RepurposeCreate-module_container_11j64",wUe="RepurposeCreate-module_slotLeft_al6l8",bUe="RepurposeCreate-module_slotRight_F9Jha",TUe="RepurposeCreate-module_createHeader_lwL-G",xUe="RepurposeCreate-module_description_Hfz76",SUe="RepurposeCreate-module_body_a1nxr",EUe="RepurposeCreate-module_createContainer_evwLt",IUe="RepurposeCreate-module_languageSection_Fj9x-",CUe="RepurposeCreate-module_label_XpIkK",kUe="RepurposeCreate-module_callout_ZbFj5",AUe="RepurposeCreate-module_table_SyPkt",jUe="RepurposeCreate-module_column_r1oHt",NUe="RepurposeCreate-module_item_3YthD",RUe="RepurposeCreate-module_calloutTitle_pqrsn",PUe="RepurposeCreate-module_checkmark_wDG0t",DUe="RepurposeCreate-module_x_n2GWE",OUe="RepurposeCreate-module_confirmButtonWrapper_-vzck";function LUe(e){const{conformed:t,done:o,downloaded:a,extracted:i,speech:s,trimmed:n}=e;if(o)return{stage:5,text:null,stageProgress:0};if(t&&n){let e="Step 4/4: Transcribing";return s&&(e+=` ${Math.floor(s)}%`),{stage:4,text:e,stageProgress:s}}return i?{stage:3,text:"Step 3/4: Preparing audio",stageProgress:0}:a?{stage:2,text:"Step 2/4: Preprocessing",stageProgress:0}:{stage:1,text:"Step 1/4: Downloading",stageProgress:0}}function FUe(e){if("pending"!==e.state)return null;const{progress:t}=e;if(!t)return"Starting transcription";const{text:o}=LUe(t);return o}function MUe(e){const t=e.filter((e=>"pending"===e.state)),o=t[0];if(!o)return null;return t.reduce(((e,t)=>{const o=LUe(t.progress);return o.stage<e.stage?o:(o.stageProgress,e.stageProgress,e)}),LUe(o.progress))}function UUe({languageCode:e,translateCode:t}){let o=e;return t&&"none"!==t&&(o+=`_${t}`),o}function BUe({onAllTranscriptionFinished:e,type:t}){var o;const a=wQ(),i=bW(),s=NU(Bl.TRANSCRIBE),n=(null==(o=_Q()[Oc.TRANSCRIBE])?void 0:o.remainingUsage)??0,[r,l]=h.useState(!1),[d,c]=h.useState(null),u=h.useCallback((e=>{c((t=>{if(!t)return null;const{assetIds:o}=t,a=o.filter((t=>t!==e));return 0===a.length?null:{...t,assetIds:a}}))}),[]),m=tl((e=>{if(!d)return[];const{assetIds:t,languageCode:o,translateCode:a}=d,i=UUe({languageCode:o,translateCode:a});return t.map((t=>{var o;return null==(o=e.assetTranscriptions.byId[t])?void 0:o[i]}))}),ol),p=tl((e=>e.studio.allLayers.byId)),g=tl((e=>e.assets.byId)),y=tl((e=>e.assets.estimatedDurationsById)),{isOpen:v}=wue(),_=h.useCallback(((e,t=!0)=>{const{assetIds:o,languageCode:a,translateCode:i}=e,s=UUe({languageCode:a,translateCode:i}),n=new Map;let r=0;return o.forEach((e=>{if(function(e,t){var o;const{state:a}=sr(),i=null==(o=a.assetTranscriptions.byId[e])?void 0:o[t];if(i&&"completed"===i.state&&i.words.length>0)return!0;const s=a.assets.byId[e],n=s&&!Zr.forceNewAssets?s.transcriptionIds:null,r=null==n?void 0:n[t],{result:l}=r||{};return!!l}(e,s)&&t)return;const o=g[e],a=Object.values(p).find((t=>ak(t)===e)),i=(null==o?void 0:o.duration)??(null==a?void 0:a.duration)??y[e];void 0!==i&&n.set(e,i);const l=Math.ceil((i??60)/60);r+=l})),{transcribeCost:r,assetDurationsSecById:n}}),[g,p,y]),w=h.useCallback((async e=>{const{assetIds:o,languageCode:r,translateCode:d}=e,{dispatch:u,state:m}=sr(),p=UUe({languageCode:r,translateCode:d}),{assetDurationsSecById:h,transcribeCost:y}=_(e);if(!s&&y>n){let e=Vl.MAGIC_TRANSCRIBE;switch(t){case"magic-subtitles":e=Vl.MAGIC_TRANSCRIBE;break;case"trim-with-transcript":e=Vl.TRIM_WITH_TRANSCRIPT_TRANSCRIBE;break;case"b-roll":e=Vl.GENERATE_B_ROLL}return i((()=>{}),{action:e})(),{started:!1}}let w=!0;const b={[Oc.TRANSCRIBE]:y};if(d&&(b[Oc.TRANSLATE]=y),a((()=>{w=!1}),b)(),w)return{started:!1};const T=m.studio._id;if(!T&&!v)return u(wl({description:"Cannot start transcription before video saves",type:"warning"})),{started:!1};l(!0);try{await Promise.all(o.map((async e=>{const o=Object.values(m.studio.allLayers.byId).find((t=>ak(t)===e));if(!o)return void console.error("Could not find timeline layer for ",e);let a=h.get(e);if(!a){const t=g[e];f("No asset duration for transcription",{extra:{assetId:e,asset:t,timelineLayer:o}}),a=60}await uN({assetId:e,assetDuration:a,languageCode:r,languageKey:p,requestingFeature:t,timelineLayer:o,translateCode:d,videoId:T??""})})))}finally{l(!1)}return c(e),{started:!0}}),[g,s,a,_,i,v,t,n]);h.useEffect((function(){if(!d)return;const t=0===m.length||m.every((e=>"completed"===(null==e?void 0:e.state)||"failed"===(null==e?void 0:e.state))),o=m.some((e=>!!e&&("completed"===e.state&&e.words.length>0)));t&&(c(null),null==e||e({assetIds:d.assetIds,oneHasWords:o}))}),[d,m,e]);const b=m.some((e=>"completed"===(null==e?void 0:e.state))),T=m.filter(Ir),x=MUe(T),S=function(e){var t;const o=e.filter((e=>"pending"===e.state));return o[0]?o.some((e=>!e.progress))?"Starting transcription":(null==(t=MUe(e))?void 0:t.text)||"Starting transcription":null}(T);return{getTranscribeCost:_,isGenerating:!!d||r,onAssetGenerationCancelled:u,oneFinished:b,progress:x,progressText:S,startTranscription:w}}const VUe=_.memo((({assetIds:e,languageCode:t})=>{const o=tl((e=>e.currentUser)),{validateUpload:a}=Qje(),{TRANSCRIBE:i}=_Q(),{getTranscribeCost:s}=BUe({type:"find-highlights"}),n=s({assetIds:e,languageCode:t,translateCode:void 0},!0).transcribeCost,r=ou(),l=h.useCallback((()=>{window.history.pushState({},"",`/repurpose/create/?asset_id=${e[0]}`)}),[e]),d=!(e[0]&&a(e[0],[zje])),c=`/repurpose/create?asset_id=${e[0]}`,u=h.useMemo((()=>{if(!i||!e.length)return null;const t=(null==i?void 0:i.remainingUsage)-n;return t<=0?{text:"You’ve reached your workspace’s transcription limit for this month. To increase your transcription minutes, upgrade now to one of our paid plans."}:t<.1*i.limitForPlan?{text:`The file you have uploaded will cost ${n} transcription minutes. After you generate clips, your workspace will have ${t.toFixed(0)} minutes remaining this month.`}:null}),[e.length,i,n]);return u&&r.type===Cl.Free&&wc(o)&&d?w.jsx(kse,{warning:u.text,action:Vl.REPURPOSE_STUDIO,buttonText:"Upgrade",onPaywallSuccess:l,immediateRedirectPathname:c}):null})),WUe="RepurposeGenerateButton-module_disabled_Tir8i",GUe="RepurposeGenerateButton-module_primaryButton_rgX-1",HUe="RepurposeGenerateButton-module_loading_KCUnk";function $Ue({onConfirm:e}){return w.jsxs("div",{className:yhe.popoverContent,"data-testid":"sample-popover",children:[w.jsx("p",{children:"Take a quick tour of the Repurpose Studio to explore how to transform a long video into social-ready clips in just a few clicks"}),w.jsxs("div",{className:yhe.actions,children:[w.jsx("button",{className:yhe.defer,onClick:YK,children:"Maybe Later"}),w.jsx("button",{className:yhe.confirm,onClick:()=>{XK(),ez(gL.REPURPOSE_SAMPLE),e()},children:"Start Tour"})]})]})}const KUe=_.memo((({assetIds:e,languageCode:t,setLoading:o,disabled:a})=>{const i=tl((e=>e.currentUser)),{TRANSCRIBE:s}=_Q(),{getTranscribeCost:n}=BUe({type:"find-highlights"}),r=bW(),{isOpen:l}=wue(gL.REPURPOSE_SAMPLE),d=n({assetIds:e,languageCode:t,translateCode:void 0},!0).transcribeCost,c=null==s?void 0:s.remainingUsage,u=c?c-d:null,m=Ac(),p=null!==u&&u<=0,{currentFolder:g,isLoading:f}=eNe(),y=Ve(),[v,_]=h.useState(!1),b=`/repurpose/create?asset_id=${e[0]}`,T=v||f,{isOpen:x}=wue(gL.REPURPOSE_SAMPLE),S=x||e[0]===XNe,E=h.useCallback((()=>{window.history.pushState({},"",b)}),[b]),I=h.useCallback((e=>{null==o||o(e),_(e)}),[o]),C=h.useCallback((async()=>{try{if(!g)throw new Error("Current folder cannot be found.");const{workflows:o}=await(async(e,t,o)=>await Jr("/api/v2/workflows",{body:{assetIds:e,folderId:t,languageCode:o}}))(e,g._id,t),a=o[0];if(!a)throw new Error("No workflow created");const i=a.workflowId;Fm(ym.REPURPOSE_GENERATION_STARTED,{"Find Highlights Workflow ID":i,"Asset Duration (min)":d}),await PP({[Oc.TRANSCRIBE]:d}),y.push(`/repurpose/${i}`)}catch(o){console.error(o),mh({description:"Failed to generate clips. Please try again.",error:o})}}),[y,g,e,t,d]),k=h.useCallback((async()=>{S?y.push(`/repurpose/${qNe}`):wc(i)?p?r(E,{action:Vl.REPURPOSE_STUDIO,teamId:m._id,immediateRedirectPathname:b})():(I(!0),await C(),I(!1)):_h({immediateRedirectPathname:b,modalType:gh.SIGN_IN})}),[m._id,i,C,E,I,y,S,r,b,p]),A=h.useMemo((()=>S?"Try a sample":wc(i)?"Generate Clips":"Sign in to generate clips"),[i,S]),j=h.useMemo((()=>w.jsx($Ue,{onConfirm:k})),[k]),N=h.useCallback((()=>{ez(gL.REPURPOSE_SAMPLE)}),[]);return w.jsx(fhe,{header:"Magically get the best clips",content:j,sideOffset:8,open:l,onClose:N,children:w.jsx("div",{className:mt(GUe,{[WUe]:a||T}),onClick:k,children:T?w.jsx("div",{className:HUe}):w.jsxs("span",{children:[w.jsx("span",{children:A}),w.jsx(Io,{})]})})})})),zUe=[zje,{type:"error",message:"Your upload file type is unsupported. Please upload a video or audio file.",isValid:(YUe=["audio","video"],e=>!!((null==e?void 0:e.content_type)&&(YUe.includes("image")&&wB(e.content_type)||YUe.includes("audio")&&MB(e.content_type)||YUe.includes("video")&&bB(e.content_type))))},{type:"error",message:"Your upload is too short to generate clips from. Repurpose Studio works best with videos that are 10 minutes or longer; upload a longer video to get started.",isValid:$je(300)},{type:"warning",message:"Your upload is less than 10 minutes long. Repurpose Studio works best with videos that are 10 minutes or longer; upload a longer video to get better results.",isValid:$je(600)}];var YUe;const JUe=_.memo((()=>{const e=tl((e=>{var t;return null==(t=e.currentUser.user.transcriptionPreferences)?void 0:t.languageCode}))??"en-US",[t,o]=h.useState(e),[a,i]=h.useState(new Set),[s,n]=h.useState(!1),[r,l]=h.useState(!1),[d,c]=h.useState(),u=!d||d&&"warning"===d.type,{isOpen:m}=wue(gL.REPURPOSE_SAMPLE),p=h.useMemo((()=>{if(m)return[XNe];const e=new URLSearchParams(window.location.search).get("asset_id");return e?[e]:void 0}),[m]),g=h.useCallback((e=>{const t=new Set(e);i(t)}),[]),f=h.useCallback((e=>{o(e),wp({languageCode:e})}),[]),y=h.useCallback((e=>{i(new Set([e]))}),[]),v=h.useCallback((e=>{i((t=>{const o=new Set(t);return e===XNe&&YK(),o.delete(e),o}))}),[]),_=!r&&!s&&u,b=h.useMemo((()=>({analyticsUploadSource:"Workspace Find Highlights",uploadSourceComponent:"WorkspaceFindHighlights",doDuplicateHandling:!1,skipAddTimelineLayer:!0,skipCMLCreation:!0})),[]);return w.jsx(w.Fragment,{children:w.jsxs("div",{className:EUe,children:[w.jsx(VUe,{assetIds:Array.from(a),languageCode:t}),w.jsx(KNe,{handleRemoveAsset:v,handleFileUploadFinish:g,handlePasteLinkFinish:y,acceptedFileTypes:$B({audioUpload:!0}),setUploading:n,disabled:r,initialUploadAssetIds:p,validators:zUe,uploadOptions:b,setUploadValidationInfo:c}),(!!a.size||s)&&w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:IUe,children:[w.jsx("span",{className:CUe,children:"Video language:"}),w.jsx(yUe,{defaultLanguageCode:t,setLanguageCode:f,theme:RF.Studio,disabled:r})]}),w.jsx("div",{className:OUe,children:w.jsx(KUe,{assetIds:Array.from(a),languageCode:t,disabled:!_,setLoading:l})})]}),!a.size&&!s&&w.jsxs("div",{className:kUe,children:[w.jsx("div",{className:RUe,children:"TIP: Repurpose Studio works best with longform talking videos!"}),w.jsxs("div",{className:AUe,children:[w.jsxs("div",{className:jUe,children:[w.jsxs("div",{className:NUe,children:[w.jsx("span",{className:PUe,children:w.jsx(wt,{})})," ","Webinars"]}),w.jsxs("div",{className:NUe,children:[w.jsx("span",{className:PUe,children:w.jsx(wt,{})})," ","Video Podcasts"]}),w.jsxs("div",{className:NUe,children:[w.jsx("span",{className:PUe,children:w.jsx(wt,{})})," ","Interviews"]})]}),w.jsxs("div",{className:jUe,children:[w.jsxs("div",{className:NUe,children:[w.jsx("span",{className:PUe,children:w.jsx(wt,{})})," ","Product Reviews"]}),w.jsxs("div",{className:NUe,children:[w.jsx("span",{className:PUe,children:w.jsx(wt,{})})," ","Speeches"]}),w.jsxs("div",{className:NUe,children:[w.jsx("span",{className:PUe,children:w.jsx(wt,{})})," ","Lectures"]})]}),w.jsxs("div",{className:jUe,children:[w.jsxs("div",{className:NUe,children:[w.jsxs("span",{className:DUe,children:[" ",w.jsx(vi,{})]})," ","Music Videos"]}),w.jsxs("div",{className:NUe,children:[w.jsxs("span",{className:DUe,children:[" ",w.jsx(vi,{})]})," ","Gaming"]}),w.jsxs("div",{className:NUe,children:[w.jsxs("span",{className:DUe,children:[" ",w.jsx(vi,{})]})," ","Vlogs"]})]})]})]})]})})})),qUe=_.memo((()=>w.jsx("div",{className:vUe,children:w.jsxs("div",{className:_Ue,children:[w.jsxs("div",{className:wUe,children:[w.jsxs("div",{className:TUe,children:[w.jsx("h1",{children:"All the best clips from one video"}),w.jsx("div",{className:xUe,children:"Magically transform a long video into multiple short-form clips that are already optimized for social media. Track active speakers, customize subtitles, and make additional edits to your video clips."})]}),w.jsx("div",{className:SUe,children:w.jsx(JUe,{})})]}),w.jsx("div",{className:bUe,children:w.jsx("video",{playsInline:!0,autoPlay:!0,muted:!0,loop:!0,children:w.jsx("source",{src:"https://cdn-useast1.kapwing.com/static/Q_m-repurpose_animation_V1.mp4"})})})]})}))),XUe="RepurposeEditor-module_editorWrapper_3Obyn",QUe="RepurposeWorkflow-module_loadingMessage_WFZId",ZUe="RepurposeWorkflow-module_loader_7VSna",eBe="RepurposeWorkflow-module_editor_eEwk2",tBe="RepurposeWorkflow-module_highlightsToolbar_ouuuw",oBe="RepurposeWorkflow-module_highlightsHeaderTitle_cf9-B",aBe="RepurposeWorkflow-module_highlightsHeader_KP7kj",iBe="RepurposeWorkflow-module_highlightsHeaderProgress_Kd6h5",sBe="RepurposeWorkflow-module_highlightsProgressText_l0D-P",nBe="RepurposeWorkflow-module_highlightSettings_wNrl0",rBe="RepurposeWorkflow-module_highlightsList_ibGZJ",lBe="RepurposeWorkflow-module_highlightsContainer_GTkhm",dBe="RepurposeWorkflow-module_projectsContainer_A-UyS",cBe="RepurposeWorkflowSettings-module_triggers_saQg3",uBe="RepurposeWorkflowSettings-module_settingsTile_YnhYS",mBe="RepurposeWorkflowSettings-module_selectedSettingsTile_JAcRS",pBe="RepurposeWorkflowSettings-module_option_U6S2S",hBe="RepurposeWorkflowSettings-module_popoverContent_x21i-",gBe="RepurposeWorkflowSettings-module_settingsTileLabel_a4u3c",fBe="RepurposeWorkflowSettings-module_ratioText_et-rW",yBe="RepurposeWorkflowSettings-module_ratioBackground_fHkWl",vBe="RepurposeWorkflowSettings-module_ratioBackgroundSelected_h4RoQ",_Be="RepurposeWorkflowSettings-module_iconButton_qJcW6",wBe="RepurposeWorkflowSettings-module_speakerFocusPopover_EY6lX",bBe="RepurposeWorkflowSettings-module_speakerFocusToggle_UPUUt",TBe="RepurposeWorkflowSettings-module_speakerFocusDescription_jLVem",xBe="RepurposeWorkflowSettingsPopover-module_arrow_h6TBK",SBe="RepurposeWorkflowSettingsPopover-module_popoverMenu_cKvkb",EBe="RepurposeWorkflowSettingsPopover-module_popoverHeader_-DE9G",IBe="RepurposeWorkflowSettingsPopover-module_popoverTitle_BH0cr",CBe="RepurposeWorkflowSettingsPopover-module_popoverClose_dALtX",kBe="RepurposeWorkflowSettingsPopover-module_popoverContent_Y5Yuy",ABe=_.memo((({children:e,onOpenChange:t,open:o,trigger:a,title:i})=>w.jsxs(Ro,{open:o,onOpenChange:t,children:[w.jsx(Po,{asChild:!0,children:a()}),w.jsxs(Do,{className:SBe,children:[w.jsx(Lo,{className:xBe}),w.jsxs("div",{className:EBe,children:[w.jsx("div",{className:IBe,children:i}),w.jsx(Oo,{asChild:!0,children:w.jsx("button",{className:CBe,children:w.jsx(ve,{size:18})})})]}),w.jsx("div",{className:kBe,children:e})]})]}))),jBe="BlueprintPreviewSettings-module_container_kWHyf",NBe="BlueprintPreviewSettings-module_tile_QHKKs",RBe="BlueprintPreviewSettings-module_selected_pGSq8",PBe=_.memo((({children:e,id:t,getEPTime:o,setEPTime:a,selectElementPoolLayers:i,selectPossibleReferenceLayers:n})=>{const[r]=h.useState((()=>{const e=new A2({id:t});return window.elementPoolById||(window.elementPoolById={}),window.elementPoolById[t]=e,e})),[l]=h.useState((()=>{const e=new RH({elementPool:r,getEPTime:o,setEPTime:a});return window.elementPoolPlayerById||(window.elementPoolPlayerById={}),window.elementPoolPlayerById[t]=e,e}));h.useLayoutEffect((()=>()=>{l.pause(),r.destroyDomPool(),window.elementPoolById&&delete window.elementPoolById[t],window.elementPoolPlayerById&&delete window.elementPoolPlayerById[t]}),[r,l,t]);const{globalPlaybackRate:d}=tl((e=>({globalPlaybackRate:e.studioLocal.playbackRate})),ol),c=tl((e=>{var o;return null==(o=e.elementPool.byElementPoolId[t])?void 0:o.paused}),s.isEqual),u=tl(n,s.isEqual),m=il(),p=tl(i,s.isEqual);h.useLayoutEffect((()=>{l.cancelPreviousPlayOrSeek(),r.regenerateDomPool(p)}),[p,r,l]),h.useLayoutEffect((()=>{c&&l.pause()}),[c,l]),h.useLayoutEffect((function(){c&&l.seek(o())}),[c,p,l,o]),h.useLayoutEffect((()=>{const e=()=>{l.seek(0)};return document.addEventListener("studioLooped",e),()=>{document.removeEventListener("studioLooped",e)}}),[l]);const g=tl((e=>{var o;return null==(o=e.elementPool.byElementPoolId[t])?void 0:o.userManualSeekTime}));h.useLayoutEffect((()=>{!async function(){if("number"!=typeof g)return;const e="number"==typeof g?g:o();await l.seek(e,!c),setTimeout((()=>{((e,t)=>{var o;const{state:a,dispatch:i}=sr();(null==(o=a.elementPool.byElementPoolId[t])?void 0:o.userManualSeekTime)===e&&i(nS({elementPoolId:t,time:null}))})(e,t)}),0)}()}),[g,m,c,l,t,o]),h.useLayoutEffect((function(){if(c)return()=>{};const e=setInterval((()=>{l.playOrPreseekElementsWhileStudioIsPlaying(u,d)}),33.333333333333336);return()=>{clearInterval(e)}}),[c,u,d,l]);const f=h.useMemo((()=>({elementPool:r,getEPTime:o,setEPTime:a,selectElementPoolLayers:i,selectPossibleReferenceLayers:n})),[r,o,a,i,n]);return w.jsx(uE.Provider,{value:f,children:e})})),DBe=_.memo((({children:e,id:t,getEPTime:o=bE,setEPTime:a=TE,selectElementPoolLayers:i=$0,selectPossibleReferenceLayers:s=Y0,selectCanvasElementPoolLayers:n=G0})=>w.jsx(PBe,{id:t,getEPTime:o,setEPTime:a,selectElementPoolLayers:i,selectPossibleReferenceLayers:s,children:w.jsx(N2,{id:t,selectElementPoolLayers:i,selectCanvasElementPoolLayers:n,children:e})}))),OBe="HighlightVideoPreview-module_canvasPreview_t5rDF",LBe="HighlightVideoPreview-module_videoCover_wHKD2",FBe="HighlightVideoPreview-module_hidden_1F3Rm",MBe="HighlightVideoPreview-module_playIconContainer_JBM5A",UBe="HighlightVideoPreview-module_playIcon_cXetl",BBe="HighlightVideoPreview-module_durationContainer_RWpJJ",VBe="HighlightVideoPreview-module_duration_qSNdH",WBe=_.memo((({duration:e,playbackRate:t})=>{const o=il(),a=_E(),{elementPool:i,getEPTime:s,setEPTime:n,selectElementPoolLayers:r,selectPossibleReferenceLayers:l}=mE(),d=i.id,c=h.useMemo((()=>J0({selectElementPoolLayers:r,selectPossibleReferenceLayers:l})),[r,l]),u=h.useMemo((()=>q0({selectElementPoolLayers:r,selectPossibleReferenceLayers:l})),[r,l]),m=tl((e=>!c(e,a)&&!u(e,a)&&!QN(e,d))),p=tl((e=>QN(e,d)));return h.useEffect((function(){p||s()>=wS(sr().state.studio.scenes[0].duration)&&(document.dispatchEvent(new CustomEvent("studioLooped")),aR(0,{id:d,setEPTime:n}))}),[o,d,s,n,p]),h.useEffect((function(){if(!m)return;let a=performance.now();const i=window.setInterval((()=>{const i=performance.now();(a=>{const i=wS(e),r=s()+(performance.now()-a)/1e3*t;if(r>=i)return o(rS.setPaused({paused:!0,elementPoolId:d})),void aR(i,{id:d,setEPTime:n});aR(r,{id:d,setEPTime:n})})(a),a=i}),33.333333333333336);return()=>{window.clearInterval(i)}}),[o,e,d,s,t,n,m]),null}));function GBe({assetId:e,containerSize:t,languageCode:o,words:a,video:i}){const s={...{assetTranscriptions:{byId:{[o]:{[e]:{state:"completed",assetTranscriptionId:"1",job_params:void 0,languageKey:o,words:a}}}},loadedFonts:{}},studio:i,studioLocal:{magicSubtitleFramesByAsset:{},magicSubtitlesGlobal:{}}};return ej({filterEmpty:!0,filterInvalid:!0,canvasHeight:t.height,canvasWidth:t.width,canvasX:0,canvasY:0})(s)}const HBe=_.memo((({highlight:e,highlightDTO:t,video:o,setHighlightTime:a,playingClip:i,setPlayingClip:s})=>{var n;const r=il(),[l,d]=h.useState({width:0,height:0}),c=h.useMemo((()=>{const[e,t]=o.ratio.split(":").map(Number);return{width:e,height:t}}),[o.ratio]),u=h.useMemo((()=>{var a,i;const s=(null==(a=o.magicSubtitlesGlobal)?void 0:a.transitionDuration)??0,n=t.words.find((t=>e.sections.some((e=>e.start<=t.start_time&&t.end_time<=e.end)))),r=(null==(i=e.sections[0])?void 0:i.start)??0;return((null==n?void 0:n.start_time)??0)-r+s}),[e.sections,t.words,null==(n=o.magicSubtitlesGlobal)?void 0:n.transitionDuration]),[m,p]=h.useState(u),g=h.useRef(u),f=h.useCallback((()=>g.current),[]),y=h.useCallback((e=>{g.current=e,p(e),a(e)}),[a]),v=o.scenes[0].layers,_=h.useMemo((()=>GBe({assetId:t.assetId,containerSize:l,languageCode:t.languageCode,words:t.words,video:o})),[l,t.assetId,t.languageCode,t.words,o]),b=h.useMemo((()=>[...v,..._]),[v,_]),T=h.useMemo((()=>v.map((e=>Ql(e)?H0({dragOverride:void 0,layer:e,layerTempValues:{},mediaCacheId:null,sceneDuration:3}):null)).filter(Er)),[v]),x=h.useMemo((()=>b.map((e=>ql(e)?H0({dragOverride:void 0,layer:e,layerTempValues:{},mediaCacheId:null,sceneDuration:3}):null)).filter(Er)),[b]),S=h.useCallback((()=>T),[T]),E=h.useCallback((()=>x),[x]),I=h.useMemo((()=>[...T.map((e=>z0(e,"ep"))),...x.map((e=>z0(e,"canvas")))]),[T,x]),C=h.useCallback((()=>I),[I]),k=h.useMemo((()=>`fh-preview-${e.id}`),[e.id]),A=h.useCallback((()=>{const e=QN(sr().state,k),t=QN(sr().state,i);i===k||t||r(rS.togglePaused({elementPoolId:i})),e?(y(0),g.current=0,s(k)):(y(u),g.current=u),r(rS.togglePaused({elementPoolId:k}))}),[r,k,u,i,y,s]),j=tl((e=>!QN(e,k))),N=cr(v.reduce(((e,t)=>e+(t.endTime??0)-(t.startTime??0)),0),!1,{excludeMs:!0});return w.jsxs("div",{className:OBe,onClick:A,children:[!!l.width&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:BBe,style:{width:l.width,height:l.height},children:w.jsx("div",{className:mt(VBe,j?FBe:void 0),children:N})}),w.jsx("div",{className:mt(LBe,j?FBe:void 0),children:w.jsx("div",{className:mt(MBe),children:j?w.jsx(us,{className:UBe}):w.jsx(ms,{className:UBe})})})]}),w.jsx(DBe,{id:k,getEPTime:f,setEPTime:y,selectElementPoolLayers:S,selectPossibleReferenceLayers:C,selectCanvasElementPoolLayers:E,children:w.jsxs(pE.Provider,{value:m,children:[w.jsx(WBe,{duration:o.duration,playbackRate:1}),w.jsx(O4,{background:o.background,canvasBlur:o.canvasBlur,layers:b,ratio:c,onContainerSizeChange:d})]})})]})})),$Be=_.memo((({settings:e})=>{const[t,o]=h.useState({width:0,height:0}),a=h.useMemo((()=>{const{ratioHeight:t,ratioWidth:o}=bj(e.ratio);return{width:o,height:t}}),[e.ratio]),i=h.useMemo((()=>{const o="loading-preview",i=[{word:"This",start_time:0,end_time:.1},{word:"is",start_time:.1,end_time:.2},{word:"a",start_time:.2,end_time:.3},{word:"preview",start_time:.3,end_time:.4},{word:"of",start_time:.4,end_time:.5},{word:"what",start_time:.5,end_time:.6},{word:"your",start_time:.6,end_time:.7},{word:"clips",start_time:.7,end_time:.8},{word:"will",start_time:.8,end_time:.9},{word:"look",start_time:.9,end_time:1},{word:"like",start_time:1,end_time:1.1}],s=new rNe({aspectRatio:a,creatorId:"loading-preview",name:"Loading Preview",teamId:"loading-preview",workspaceId:"loading-preview"});return s.setMagicSubtitles({asset:{_id:o},languageCode:"en",magicSubtitlePreset:e.subtitlePreset,maxCharsPerSubtitle:1e3,words:i}),s.setLayers([{id:"loading-layer",type:zl.Video,asset_id:o}]),GBe({assetId:o,containerSize:t,languageCode:"en",video:s.video,words:i})}),[t,a,e.subtitlePreset]);return w.jsx(pE.Provider,{value:.3,children:w.jsx(O4,{background:"#000000",canvasBlur:!0,ratio:a,layers:i,onContainerSizeChange:o})})})),KBe={byId:{},all:[]},zBe=(e=null)=>{const t=il(),o=tl((e=>e.teamBlueprints)),a=e&&e!==vc._id?o[e]:KBe,[i,s]=h.useState(!a);return h.useEffect((()=>{!e||e===vc._id||a||(async()=>{try{s(!0);const o=await Yr(`/api/v1/blueprints?teamId=${e}`);t(BL.set({teamId:e,blueprints:o}))}catch(IGe){console.error(IGe),t(BL.set({teamId:e,blueprints:[]}))}finally{s(!1)}})()}),[t,s,a,e]),{loading:i,...a||KBe}},YBe={width:1,height:1},JBe=_.memo((({blueprint:e,highlightDTO:t,selected:o,selectBlueprint:a})=>{const i=h.useRef(0),[n,r]=h.useState({width:0,height:0}),l=h.useCallback((()=>{a(e)}),[e,a]),d=h.useMemo((()=>{var o,a,r,l;if((null==t?void 0:t.status)!==gd.COMPLETE)return null;const d=t.highlights[0];if(!d)return null;const c=t.asset.dimensions||YBe,u=e.studio.ratio,[m=0,p=0]=u?u.split(":").map((e=>+e)):[c.width,c.height],h=new rNe({aspectRatio:{width:m,height:p},name:d.title,creatorId:t.creatorId,teamId:t.teamId,workspaceId:t.folderId});h.video._id=`bpp-${e._id}`,h.createVideoFromHighlight(t,d,{}),h.setMagicSubtitles({asset:t.asset,languageCode:t.languageCode,magicSubtitlePreset:(null==(a=null==(o=e.studio)?void 0:o.magicSubtitlesGlobal)?void 0:a.preset)||void 0,maxCharsPerSubtitle:16,words:t.words}),h.setCanvasBlur(s.get(e,"studio.canvasBlur",!0)),h.updateVideo(e.studio);const g=GBe({assetId:t.assetId,containerSize:n,languageCode:t.languageCode,words:t.words,video:h.video}),f=Math.max(.01,(null==(r=h.video.magicSubtitlesGlobal)?void 0:r.transitionOverlapDuration)||0);i.current=((null==(l=g[0])?void 0:l.startTime)||0)+f;const y={id:h.video._id,type:zl.Image,name:t.asset.name||"Preview Image",startTime:i.current,endTime:i.current+3,url:ok({asset:t.asset,idbAsset:null,timelineLayer:null}),position:{x:"0%",y:"0%",height:"100%",width:"100%",rotation:0}};if(u){const{resizeLayerUpdates:e}=ON({aspectRatioWidth:m,aspectRatioHeight:p,layers:[y],prevCanvasHeight:c.height,prevCanvasWidth:c.width,resizeMethod:"fit",shouldSmartReframe:!1,visionJobByAssetId:{}});Object.assign(y,e[y.id])}return h.setLayers([y,...g]),h}),[e,t,i,n]),c=null==d?void 0:d.video,u=h.useMemo((()=>({width:(null==c?void 0:c.width)||0,height:(null==c?void 0:c.height)||0})),[null==c?void 0:c.width,null==c?void 0:c.height]);if(!d||(null==t?void 0:t.status)!==gd.COMPLETE)return null;const m=d.video.scenes[0].layers;return w.jsx("div",{className:mt(NBe,{[RBe]:o}),onClick:l,children:w.jsx(pE.Provider,{value:i.current,children:w.jsx(O4,{onContainerSizeChange:r,background:d.video.background,canvasBlur:d.video.canvasBlur,layers:m,ratio:u})})})})),qBe=_.memo((({selectedBlueprint:e,selectBlueprint:t})=>{const{workflowId:o}=ua(),{workflow:a}=Fje({workflowId:o}),{all:i}=zBe(null==a?void 0:a.teamId);return(null==a?void 0:a.status)!==gd.COMPLETE?null:w.jsx("div",{className:jBe,children:i.map((o=>w.jsx(JBe,{blueprint:o,highlightDTO:a,selected:(null==e?void 0:e._id)===o._id,selectBlueprint:t},o._id)))})})),XBe=()=>tl(LL),QBe=e=>{const t=XBe()[e];return(null==t?void 0:t.userCanAccess)||!1};m(((e,t)=>e.featureFlags.flags[t]),(e=>(null==e?void 0:e.userCanAccess)||!1));var ZBe=(e=>(e.OFF="OFF",e.ON="ON",e.ADMIN_ONLY="ADMIN_ONLY",e.LOCATION_BASED="LOCATION_BASED",e.BETA="BETA",e))(ZBe||{}),eVe=(e=>(e.BASIC_PLAN="BASIC_PLAN",e.FIND_HIGHLIGHT_BLUEPRINTS="FIND_HIGHLIGHT_BLUEPRINTS",e.SMART_REFRAME="SMART_REFRAME",e.SMART_REFRAME_V2="SMART_REFRAME_V2",e.SERVICE_INSTABILITY="SERVICE_INSTABILITY",e.NETFLIX_WRAPPED_USE_REELGOOD="NETFLIX_WRAPPED_USE_REELGOOD",e.BYPASS_CAPTCHA="BYPASS_CAPTCHA",e.REPURPOSE_SAMPLE_TOUR="REPURPOSE_SAMPLE_TOUR",e))(eVe||{});const tVe=[{label:"Youtube",ratio:"16:9"},{label:"Tiktok, Reels, Shorts",ratio:"9:16"},{label:"Instagram Post Square",ratio:"1:1"},{label:"Instagram Post Portrait",ratio:"4:5"}],oVe=_.memo((({isSelected:e,ratio:t})=>{const[o,a]=t.split(":").map((e=>Number(e))),i=o>a?"width":"height";return w.jsxs(w.Fragment,{children:[w.jsx("div",{className:mt(yBe,e?vBe:null),style:{aspectRatio:`${o} / ${a}`,[i]:"80%"}}),w.jsx("div",{className:fBe,children:t})]})})),aVe="Aspect Ratio",iVe="Speaker Focus",sVe="Subtitles",nVe="Templates",rVe=_.memo((({aspectRatio:e,setAspectRatio:t,subtitlePreset:o,setSubtitlePreset:a,useSpeakerFocus:i,setUseSpeakerFocus:s,selectedBlueprint:n,selectBlueprint:r})=>{const l=QBe(eVe.FIND_HIGHLIGHT_BLUEPRINTS),[d,c]=h.useState(null),u=h.useCallback((e=>{e||c(null)}),[c]),m=h.useCallback((()=>w.jsx("div",{className:uBe,onClick:()=>c("aspectRatio"),children:w.jsx(oVe,{ratio:e,isSelected:!1})})),[e]),p=h.useCallback((()=>w.jsx("div",{className:uBe,onClick:()=>c("subtitle"),children:w.jsx(tZ,{preset:o,width:52,height:52})})),[o]),g=h.useCallback((()=>w.jsx("div",{className:uBe,onClick:()=>c("resize"),children:w.jsx("div",{className:_Be,children:w.jsx(ps,{})})})),[]),f=h.useCallback((()=>w.jsx("div",{className:uBe,onClick:()=>c("blueprints"),children:w.jsx("div",{className:_Be,children:w.jsx(hs,{})})})),[]),y=h.useCallback((()=>{s(!i)}),[i,s]);return w.jsxs("div",{className:cBe,children:[l&&w.jsx(ABe,{onOpenChange:u,open:"blueprints"===d,title:nVe,trigger:f,children:w.jsx(qBe,{selectedBlueprint:n,selectBlueprint:r})}),w.jsx(ABe,{onOpenChange:u,open:"aspectRatio"===d,title:aVe,trigger:m,children:w.jsx("div",{className:hBe,children:tVe.map((o=>{const a=e===o.ratio;return w.jsxs("div",{children:[w.jsx("div",{className:mt(uBe,pBe,a?mBe:null),onClick:()=>{t(o.ratio),c(null)},style:{width:72,height:72},children:w.jsx(oVe,{ratio:o.ratio,isSelected:a})}),w.jsx("div",{className:gBe,children:o.label})]},o.ratio)}))})}),w.jsx(ABe,{onOpenChange:u,open:"subtitle"===d,title:sVe,trigger:p,children:w.jsx("div",{className:hBe,children:Eg.map((e=>{const t=e.presetId===o.presetId;return w.jsxs("div",{children:[w.jsx("div",{className:mt(uBe,pBe,t?mBe:null),onClick:()=>{a(e),c(null)},style:{width:72,height:72},children:w.jsx(tZ,{preset:e,width:72,height:72})}),w.jsx("div",{className:gBe,children:e.title})]},e.presetId)}))})}),w.jsx(ABe,{onOpenChange:u,open:"resize"===d,title:iVe,trigger:g,children:w.jsxs("div",{className:wBe,children:[w.jsxs("div",{className:bBe,children:[w.jsx(bde,{toggled:i,onClick:y}),w.jsx(w.Fragment,{children:i?"On":"Off"})]}),w.jsx("div",{className:TBe,children:i?"Active speakers are always centered in-frame.":"Original video size fits within the given aspect ratio, without stretching or zooming in."})]})})]})})),lVe="ProjectsList-module_empty_KZ8ox",dVe="ProjectsList-module_header_VMIb-",cVe="ProjectsList-module_projectsListContainer_rjB1K",uVe="ProjectsList-module_projectsGrid_YQyPX",mVe="ProjectsList-module_mobileNote_puV7q",pVe="RepurposeWorkflowProject-module_wrapper_Zr5me",hVe="RepurposeWorkflowProject-module_buttonWrapper_1mAGf",gVe="RepurposeWorkflowProject-module_top_RS5nW",fVe="RepurposeWorkflowProject-module_bottom_i88iQ",yVe="RepurposeWorkflowProject-module_backgroundThumbnail_7Tp4M",vVe="RepurposeWorkflowProject-module_thumbnailOverlay_8zyMt",_Ve="RepurposeWorkflowProject-module_iconBar_5dq-h",wVe="RepurposeWorkflowProject-module_timestamp_HQ9Va",bVe="RepurposeWorkflowProject-module_button_7gjAS",TVe="DownloadButton-module_disabled_i7fsL",xVe="DownloadButton-module_downloadButton_BbxVk",SVe="DownloadButton-module_exporting_FPxdg",EVe="DownloadButton-module_progressTextWrapper_G92gY",IVe="DownloadButton-module_progressNum_WcOmL",CVe="DownloadButton-module_progressPercent_-kkyz",kVe="DownloadButton-module_progressBar_9FHV5",AVe="DownloadButton-module_icon_CD8C-",jVe="DownloadButton-module_text_WbwDA",NVe=_.memo((({disabled:e,progress:t,handleDownload:o,size:a=36,text:i,className:s,icon:n=!0})=>{const r=h.useMemo((()=>({width:i&&void 0===t?"fit-content":a,height:a})),[t,a,i]);return w.jsxs("button",{className:mt(xVe,s,{[TVe]:e,[SVe]:void 0!==t}),onClick:o,style:r,children:[void 0!==t&&w.jsx("div",{className:kVe,style:{height:`${t}%`}}),void 0!==t?w.jsx("div",{className:EVe,children:w.jsxs("span",{className:IVe,children:[t,w.jsx("span",{className:CVe,children:"%"})]})}):w.jsxs(w.Fragment,{children:[!!i&&w.jsx("div",{className:jVe,style:{paddingLeft:n?"4px":"8px",paddingRight:n?"0px":"8px"},children:i}),n&&w.jsx(ta,{size:a/2,className:AVe})]})]})})),RVe={rainbowBorderOptions:{borderRadius:12,borderWidth:2}},PVe=_.memo((({project:e,workflow:t,showRepurposeTourPopover:o})=>{const{downloadURL:a,duration:i,id:s,name:n=An,thumbnailURL:r=zn}=e,l=Ve(),d=il(),[c,u]=h.useState(!1),[m,p]=h.useState(!1),{currentFolder:g}=eNe(),f=Ac(),y=(null==g?void 0:g._id)===t.folderId&&f._id===t.teamId,v=t._id,_=tl((e=>e.workflows.exportProgressByVideoId[s])),b=h.useCallback((()=>{ez(gL.REPURPOSE_REEDIT_CLIPS)}),[]),T=h.useCallback((()=>{d($L.updateWorkflow({workflowId:v,updates:{projects:t.projects.map((e=>e.id===s?{...e,downloadURL:void 0}:e))}})),b(),l.push(`/${s}/studio/editor`)}),[d,b,l,s,t.projects,v]),x=h.useCallback((async e=>{e.stopPropagation();try{u(!0),await(async({videoId:e,workflowId:t})=>{await zr(`/api/v2/workflows/${t}/videos/${e}`)})({videoId:s,workflowId:v}),d($L.updateWorkflow({workflowId:v,updates:{projects:t.projects.filter((e=>e.id!==s))}}))}catch(o){mh({description:"Failed to delete project",error:o})}finally{u(!1)}}),[s,v,d,t.projects]),S=h.useCallback((async e=>{p(!0),e.stopPropagation(),a&&(Fm(ym.REPURPOSE_DL_FROM_REPURPOSE_EDITOR,{"Asset Duration (min)":(t.asset.duration??0)/60,"Find Highlights Workflow ID":t._id,"Project Source":"edited"}),pye(a)),p(!1)}),[a,t._id,t.asset.duration]);return w.jsx(fhe,{header:"Re-edit your existing clips",content:"All the suggested clips you download or edit are saved here as projects. Feel free to make more edits to them at any time.",size:"small",open:o,onClose:b,sideOffset:4,side:"left",align:"start",rainbowBorderOptions:RVe.rainbowBorderOptions,children:w.jsxs("div",{className:pVe,onClick:T,children:[w.jsxs("div",{className:gVe,children:[w.jsx("div",{className:yVe,children:w.jsx(KCe,{thumbnailUrl:r,elementType:HCe.WORKFLOW_VIDEO})}),w.jsxs("div",{className:vVe,children:[w.jsx("div",{className:_Ve,children:y&&w.jsxs(w.Fragment,{children:[a||_?w.jsx(NVe,{handleDownload:S,progress:null==_?void 0:_.progress,size:34,className:hVe,disabled:m,text:"Download Ready"}):w.jsx("div",{}),w.jsx("button",{onClick:x,className:mt(bVe,hVe),disabled:c,children:w.jsx(gs,{size:20})})]})}),w.jsx("div",{className:wVe,children:cr(Math.round(i))})]})]}),w.jsx("div",{className:fVe,children:n})]})})})),DVe=_.memo((({workflow:e})=>{const{isOpen:t}=wue(gL.REPURPOSE_REEDIT_CLIPS);return fd(e)&&e.projects.length?w.jsxs("div",{className:cVe,children:[w.jsx("div",{className:dVe,children:"Projects made from suggested clips"}),w.jsx("div",{className:uVe,children:e.projects.map(((o,a)=>w.jsx(PVe,{project:o,workflow:e,showRepurposeTourPopover:t&&0===a},a)))}),w.jsx("div",{className:mVe,children:"Use the Repurpose Studio on desktop in order to see your suggested clips, or to generate clips from a new video."})]}):w.jsxs("div",{className:cVe,children:[w.jsx("div",{className:dVe,children:"Projects made from suggested clips"}),w.jsx("div",{className:lVe,children:w.jsxs("div",{children:[w.jsx("img",{src:"https://cdn-useast1.kapwing.com/static/TEe-Vector.webp",alt:"repurpose"}),w.jsx("div",{children:"You don't have any projects yet! Edit or download one of your highlights to save it as a project."})]})})]})})),OVe="AssetTranscript-module_assetTranscript_sj19H",LVe="AssetTranscript-module_paragraph_eU1cQ",FVe="AssetTranscript-module_word_Fxc-z",MVe="AssetTranscript-module_highlighted_FROj3",UVe="AssetTranscript-module_spoken_NGJql",BVe="AssetTranscript-module_anchorRef_TlQk-";function VVe(e,t){let o=0,a=e.length-1;for(;o<a;){const i=Math.floor((o+a)/2);if(t<e[i].val){if(i>0&&t>e[i-1].val)return e[i-1];a=i}else{if(i<e.length-1&&t<e[i+1].val)return e[i];o=i+1}}return e[o]}const WVe=({assetId:e,includeDeleted:t})=>m((t=>{var o;const a=zVe(t),i=null==(o=t.assetTranscriptions.byId[e])?void 0:o[a];return"completed"===(null==i?void 0:i.state)?i.words:null}),jA([e]),((o,a)=>{var i;if(!o||0===o.length||0===a.length)return[];const s=[],n=a.map((e=>[{val:e.startTime??0,item:e,type:"left"},{val:e.endTime??3,item:e,type:"right"}])).flat().sort(((e,t)=>e.val-t.val)),r=[];for(const e of a){const{startTime:t=0,endTime:o=e.duration||3}=e;r.push({type:"layer-start",layer:e,time:t}),r.push({type:"layer-end",layer:e,time:o})}o.forEach(((e,t)=>{const a=o[t-1];let i=0;if(a){const t=e.start_time-a.end_time;i=t>0?Math.min(t/2,.5):0}const s=o[t+1];let n=0;if(s){const t=s.start_time-e.end_time;n=t>0?Math.min(t/2,.5):0}const l={leadingGapToRemove:i,trailingGapToRemove:n};r.push({type:"word-start",word:e,time:e.start_time,transcriptionNdx:t,gap:l}),r.push({type:"word-end",word:e,time:e.end_time,transcriptionNdx:t,gap:l})}));r.sort(((e,t)=>{const o=e.time-t.time;return o||("layer-start"===e.type&&"word-end"===t.type?1:"layer-end"===e.type&&"word-start"===t.type||"word-end"===e.type&&"layer-start"===t.type?-1:"word-start"===e.type&&"layer-end"===t.type?1:0)}));const l=new Map;function d(t,o,a,i){const n=null!==a,{startTime:r,endTime:d,videoDelay:c,playbackRate:u}=dm(t),{start:m,end:p}=cm(t),h=n?o.word.start_time:Math.max(o.word.start_time,r),g=n?o.word.end_time:Math.min(o.word.end_time,d),f=(g-h)/u,y=c+(h-r)/u,v="left"===a?m:p,_=(w=n?v:y+f/2,b=2,Math.round(w*10**b)/10**b);var w,b;s.push({assetId:e,closestLayerId:i,deleted:n,tetheredDirection:a,layerId:t.id,transcriptionNdx:o.transcriptionNdx,start:o.gap.leadingGapToRemove?h-o.gap.leadingGapToRemove:h,end:o.gap.trailingGapToRemove?g+o.gap.trailingGapToRemove:g,sortTime:_,text:o.word.word,textLowercaseAndTrailingSpace:o.word.word.toLowerCase()+" ",timelineRow:t.timelineRow??0,timelineStart:n?v:y-o.gap.leadingGapToRemove,timelineEnd:n?v:y+f+o.gap.trailingGapToRemove}),"word-start"===o.type&&l.set(t.id,(l.get(t.id)||new Set).add(o.transcriptionNdx))}const c=new Set;let u=null;for(const e of r)switch(e.type){case"layer-start":u=null,c.add(e.layer);break;case"layer-end":c.delete(e.layer);break;case"word-start":{let o=!1;if(0!==c.size){for(const t of c){const{startTime:a,endTime:i}=dm(t),s=e.word.end_time-e.word.start_time;(Math.min(i,e.word.end_time)-Math.max(a,e.word.start_time))/s>0&&(d(t,e,null,t.id),o=!0)}u=null}if(t&&!o){(u?e.time-u.lastTime:1/0)>1&&(u=null);const t=VVe(n,e.time),o=(null==u?void 0:u.layerInfo)||t;d(o.item,e,o.type,t.item.id),u?u.lastTime=e.time:u={layerInfo:t,lastTime:e.time}}break}case"word-end":for(const t of c){if(null==(i=l.get(t.id))?void 0:i.has(e.transcriptionNdx))continue;const{startTime:o,endTime:a}=dm(t),s=e.word.end_time-e.word.start_time;(Math.min(a,e.word.end_time)-Math.max(o,e.word.start_time))/s>=1&&(d(t,e,null,t.id),u=null)}}return s.sort(((e,t)=>e.sortTime-t.sortTime)),s})),GVe=m((e=>{var t;return null==(t=e.projectSessionSettings.trimWithTranscriptEnabledAssets)?void 0:t.assetIds}),((e,t)=>t??e.trimWithTranscript.showDeleted),((e=[],t)=>e.map((e=>WVe({assetId:e,includeDeleted:t}))))),HVe=m((e=>e.projectSessionSettings.trimWithTranscriptEnabledAssets),bk,((e,t)=>{const o=new Set(t);return((null==e?void 0:e.assetIds)||[]).filter((e=>o.has(e)))})),$Ve=s.memoize((e=>m((t=>{const o=zVe(t);return Ik(e,o)(t)}),(e=>e)))),KVe=ll((e=>bk(e).map((t=>[t,$Ve(t)(e)]))),(e=>{const t={};for(const[o,a]of e)t[o]=a||null;return t})),zVe=e=>{var t;return(null==(t=e.projectSessionSettings.trimWithTranscriptEnabledAssets)?void 0:t.languageCode)||"en-US"};function YVe(e,t){const o=[];for(const a of e){let e=o[o.length-1];e||(e=[],o.push(e));const i=e[e.length-1];if(!i){e.push(a);continue}const s=a.start-i.end>1,n=!i||a.transcriptionNdx===i.transcriptionNdx+1,r=s||!n||a.assetId!==i.assetId,l=e.length>=50&&EC(a.text,t);r?(o.push([]),e=o[o.length-1],null==e||e.push(a)):l?(null==e||e.push(a),o.push([]),e=o[o.length-1]):null==e||e.push(a)}return o.filter((e=>e.length>0))}function JVe(e,t){return YVe(e.flat().sort(((e,t)=>e.sortTime-t.sortTime)),t)}function qVe({includeDeletedOverride:e}={}){const{state:t}=sr(),{languageCode:o}=t.projectSessionSettings.trimWithTranscriptEnabledAssets||{};return JVe(GVe(t,e).map((e=>e(t))),o)}function XVe(){const e=tl((e=>{var t;return null==(t=e.projectSessionSettings.trimWithTranscriptEnabledAssets)?void 0:t.languageCode})),t=tl((e=>GVe(e).map((t=>t(e)))),ol);return h.useMemo((()=>JVe(t,e)),[t,e])}const QVe=()=>w.jsxs("div",{className:OVe,children:[w.jsx(URe,{height:16,borderRadius:4,widthPct:70}),w.jsx("div",{}),w.jsx(URe,{height:12,borderRadius:4}),w.jsx(URe,{height:12,borderRadius:4,widthPct:50}),w.jsx("div",{}),w.jsx(URe,{height:12,borderRadius:4}),w.jsx(URe,{height:12,borderRadius:4}),w.jsx(URe,{height:12,borderRadius:4,widthPct:50})]}),ZVe=_.memo((({words:e,languageCode:t,highlight:o,highlightTime:a})=>{const i=h.useRef(null),[n,r]=h.useState(null),l=h.useMemo((()=>{const e=o.sections[0];if(!e)throw new Error("No sections in highlight");let t=0,i=0;for(let s=0;s<o.sections.length;s++){const e=o.sections[s];if(!e)throw new Error("No current section");const n=e.end-e.start,r=a-t;if(r<n){t+=r;break}{t+=n;const a=o.sections[s+1];a&&(i+=a.start-e.end)}}return t+i+e.start}),[o.sections,a]),d=h.useMemo((()=>{var e,t;return null==(t=null==(e=o.sections[0])?void 0:e.sentences[0])?void 0:t.start}),[o.sections]),c=h.useCallback((e=>{for(const t of o.sections)if(e.end>=t.start&&e.start<=t.end)return!0;return!1}),[o.sections]),u=h.useMemo((()=>{var a,i,s;const n=YVe(e,t),r=null==(i=null==(a=o.sections[0])?void 0:a.sentences[0])?void 0:i.start;if(void 0===r)return n;const l=o.sections[o.sections.length-1],d=null==(s=null==l?void 0:l.sentences[l.sentences.length-1])?void 0:s.end;if(void 0===d)return n;const c=n.findIndex((e=>{const t=e[0];return!!t&&t.start>=r})),u=n.findIndex((e=>{const t=e[e.length-1];return!!t&&t.end>=d})),m=Math.max(0,c-4),p=Math.min(n.length,u+4);return n.slice(m,p)}),[o.sections,t,e]),m=h.useMemo((()=>s.throttle((e=>{const t=i.current;if(!t)return;const o=e.offsetTop-40;o<0||t.scrollTo({top:o,behavior:"smooth"})}),400,{leading:!0,trailing:!0})),[]);return h.useEffect((()=>{n&&m(n)}),[n,m]),w.jsx("div",{className:OVe,ref:i,children:u.map(((e,t)=>w.jsx("div",{className:LVe,children:e.map(((e,o)=>{if(!e.text)return null;const a=c(e),i=e.start<=l&&e.end>=l,s=e.start===d,n=i||s;return w.jsx(_.Fragment,{children:w.jsxs("div",{className:mt(FVe,{[MVe]:a,[UVe]:i}),children:[n&&w.jsx("div",{ref:r,className:BVe}),e.text]})},`paragraph ${t} word ${o}`)}))},`paragraph ${t}`)))})})),eWe="HighlightCard-module_disabled_8Qwug",tWe="HighlightCard-module_highlightCard_44yH1",oWe="HighlightCard-module_title_g6TpI",aWe="HighlightCard-module_titleRow_C-sjM",iWe="HighlightCard-module_previewContainer_Xjipd",sWe="HighlightCard-module_toolbar_G8iyQ",nWe="HighlightCard-module_assetTranscript_C1DXi",rWe="HighlightCard-module_editAsProjectButton_5EhsP",lWe="HighlightCard-module_loader_amOe6",dWe="HighlightCard-module_highlightVideoPreview_Itvh3",cWe={rainbowBorderOptions:{borderRadius:6,borderWidth:2}},uWe=_.memo((({settings:e})=>w.jsx("div",{className:tWe,children:w.jsxs("div",{className:iWe,children:[w.jsx("div",{className:dWe,children:w.jsx($Be,{settings:e})}),w.jsx(QVe,{})]})}))),mWe=_.memo((({assetDimensions:e,highlightDTO:t,highlight:o,localUrls:a,words:i,settings:s,showRepurposeTourPopover:n,playingClip:r,setPlayingClip:l})=>{const{isVisible:d,ref:c,wasVisible:u}=kZ(),m=il(),{title:p}=o,[g,f]=h.useState(!1),[y,v]=h.useState(!1),_=tl((e=>{const a=t.projects.find((e=>e.highlightJobId===o.id));if(a)return e.workflows.exportProgressByVideoId[a.id]})),{atLimit:b}=AAe(),[T,x]=h.useState(!1),S=h.useMemo((()=>{const{ratioHeight:e,ratioWidth:t}=bj(s.ratio);return{width:t,height:e}}),[s.ratio]),E=t._id,[I,C]=h.useState(0),{currentFolder:k}=eNe(),A=Ac(),j=tl((e=>nu(e))),N=be().pathname??"/repurpose/create",R=t.folderId,P=(null==k?void 0:k._id)===R&&A._id===t.teamId,{tour:D,isOpen:O}=wue(),L=D===fL.RepurposeSample&&O,F=t._id===qNe||L,M=Ve(),U=g||y,B=h.useMemo((()=>{var i,n;const r=new rNe({aspectRatio:{width:e.width,height:e.height},name:o.title,creatorId:t.creatorId,teamId:t.teamId,workspaceId:R});return r.createVideoFromHighlight(t,o,a,F),r.resize({prevRatio:{width:e.width,height:e.height},ratio:{width:S.width,height:S.height},resizeMode:s.blueprint?"fill":s.resizeMode,visionJobByAssetId:t.visionJob?{[t.assetId]:{[ld.ObjectTrackingV2]:t.visionJob}}:{}}),r.setMagicSubtitles({asset:t.asset,languageCode:t.languageCode,magicSubtitlePreset:s.subtitlePreset,maxCharsPerSubtitle:16,words:t.words}),r.setCanvasBlur((null==(i=s.blueprint)?void 0:i.studio.canvasBlur)??!0),(null==(n=s.blueprint)?void 0:n.studio)&&r.updateVideo(s.blueprint.studio),r}),[e.width,e.height,s.blueprint,o,t,R,F,a,S.width,S.height,s.resizeMode,s.subtitlePreset]),V=h.useCallback((()=>{ez(gL.REPURPOSE_EDIT_HIGHLIGHT,{numSteps:L?1:2})}),[L]),W=h.useCallback((()=>{(null==B?void 0:B.video.workspaceId)&&!F?(async(e,t)=>{const{dispatch:o}=sr();await qr(`/api/v2/workflows/folder/${e}/settings`,{body:{settings:t}}),o($L.updateFolderSettings({folderId:e,settings:t}))})(B.video.workspaceId,s).catch(console.error):console.error("Video had no workspace id, can't update settings")}),[B.video.workspaceId,F,s]),G=h.useCallback((async()=>{if(F){const e=B.video;return delete e._id,delete e.teamId,delete e.workspaceId,delete e.creatorEmail,delete e.creatorId,m(fD(B.video)),ez(gL.REPURPOSE_EDIT_HIGHLIGHT),await eK(XNe),void M.push("/studio/editor/transcript")}if(j){if(B){b&&x(!0),f(!0);try{W(),Fm(ym.REPURPOSE_EDIT_IN_STUDIO,{"Find Highlights Workflow ID":E,"Asset Duration (min)":(t.asset.duration??0)/60});const e=await(async({source:e,video:t,workflowId:o})=>(GM({newFolderId:t.workspaceId,projectId:void 0,source:e,stateBeforeCopy:sr().state,workflowId:o}),await Jr("/api/v2/video-creation/create",{body:{video:t}})))({source:"Repurpose Editor",video:B.video,workflowId:E});V();const o={[VK.STUDIO_TOUR_STEP]:gL.TRIM_WITH_TRANSCRIPT,[VK.STUDIO_TOUR_SOURCE]:ad.RepurposeOnboarding},a=Object.entries(o).map((([e,t])=>`${e}=${t}`)).join("&"),i=`/${e.videoId}/studio/editor/transcript?${a}`;window.open(i,"_blank"),Vje(E),f(!1)}catch(IGe){f(!1)}}}else _h({immediateRedirectPathname:N,modalType:gh.SIGN_IN})}),[F,j,B,b,M,m,N,W,E,t.asset.duration,V]),H=h.useCallback((async e=>{if(e.preventDefault(),!B||F)return;v(!0);const o=B.getVideoForExport();if(!o)return;Fm(ym.REPURPOSE_EXPORT_FROM_REPURPOSE_EDITOR,{"Asset Duration (min)":(t.asset.duration??0)/60,"Find Highlights Workflow ID":E,"Subtitle Preset":s.subtitlePreset.presetId,"Use Speaker Focus":"speaker-focus"===s.resizeMode,Ratio:s.ratio,"Project Source":"suggestions"}),W();const{processVideoJob:a}=await(async({exportLocation:e,video:t})=>(fae({exportLocation:e,video:t}),await Jr("/api/v2/video-creation/export",{body:{video:t}})))({exportLocation:"repurpose-editor-suggestion",video:o});await Vje(E),a&&m($L.exportProgressUpdated({processVideoJobId:a._id,progress:0,videoId:a.video_id})),v(!1)}),[B,F,t.asset.duration,E,s.subtitlePreset.presetId,s.resizeMode,s.ratio,W,m]),$=h.useCallback((()=>{x(!1)}),[]),K=u||d;return w.jsxs(w.Fragment,{children:[w.jsx("div",{className:tWe,ref:c,children:w.jsxs("div",{className:iWe,children:[w.jsx("div",{className:dWe,children:K&&w.jsx(HBe,{highlight:o,highlightDTO:t,video:B.video,setHighlightTime:C,playingClip:r,setPlayingClip:l})}),w.jsxs("div",{children:[w.jsxs("div",{className:aWe,children:[w.jsx("div",{className:oWe,children:p}),w.jsxs("div",{className:sWe,children:[P&&!F&&w.jsx(NVe,{progress:(null==_?void 0:_.progress)??(y?0:void 0),disabled:U,handleDownload:H,text:"Export",className:rWe,icon:!1}),w.jsx("div",{children:w.jsx(fhe,{header:"Edit your suggested clips",content:"Not completely satisfied with this clip? Turn it into a project to edit the transcript, add custom subtitle styles, and refine it for socials.",sideOffset:8,size:"small",open:n,onClose:V,rainbowBorderOptions:cWe.rainbowBorderOptions,children:w.jsx("button",{className:mt(rWe,{[eWe]:U||g}),onClick:G,children:g?w.jsx("div",{className:lWe}):"Edit as project"})})})]})]}),w.jsx("div",{className:nWe,children:w.jsx(ZVe,{words:i,highlight:o,languageCode:t.languageCode||"en-US",highlightTime:I})})]})]})}),T&&w.jsx(_Ae,{exitOverlay:$,goToStudio:G,currentFolderId:R})]})})),pWe="HighlightsList-module_highlightList_9MaJx",hWe=async({url:e,name:t})=>{try{const o=await c(e,{mode:"no-cors"});if(404===o.status)return{error:"Not Found",file:void 0,status:o.status};const a=await o.blob();return{file:new File([a],t,{type:a.type}),status:o.status}}catch(IGe){return console.error(`Failed to fetch ${t}`,IGe),{error:"unknown"}}},gWe=[e=>"media.gettyimages.com"===e.hostname&&!!e.searchParams.get("s")],fWe=new Set([zl.Video,zl.Image,zl.Audio]);let yWe=0;const vWe={},_We={},wWe=e=>fWe.has(e.type),bWe=e=>{const{state:t}=sr(),{mediaCache:o}=t;return Tu(e,o)||e.asset_id||e.id},TWe=(e,t)=>{if(e.type===zl.Video)switch(t){case"original":return!!e.file_v2;case"preview":return!!e.optimizedPreviewFile_v2;case"track":return!!e.trackOptimizedPreviewFile_v2;case"waveform":return!!e.waveformData_v5;case"thumbnail_sheet":return!!e.thumbnailSheet}else if(e.type===zl.Audio)switch(t){case"original":return!!e.file;case"waveform":return!!e.waveformData_v5;default:return!1}else switch(t){case"original":return!!e.file_v2;case"preview":return!!e.optimizedPreviewFile_v2;case"track":return!!e.trackOptimizedPreviewFile_v2;default:return!1}},xWe=async(e,t)=>{var o;let a=!1,i=!1,s=!1,n=!1,r=!1;const{state:l}=sr();if(e.type===zl.Video||e.type===zl.Audio){C0(e,"waveform",l)&&(a=!0)}if(!t)if(e.type===zl.Video){const t=C0(e,"original",l);C0(e,"thumbnail_sheet",l)&&(r=!0);C0(e,"track",l)&&(n=!0);const a=C0(e,"preview",l),d=(null==(o=e.preview)?void 0:o.fragmented)&&BI({isCanvas:!0,mediaPipe:!0});!a||d||Zr.remotePlayback||(s=!0);const c=e.optimization_failed||e.optimization_id;a||d||Zr.remotePlayback||!c||!t||(i=!0)}else if(e.type===zl.Audio){k0(e,void 0,"original",l)&&!Zr.remotePlayback&&(i=!0)}else if(e.type===zl.Image){const t=C0(e,"original",l),o=C0(e,"preview",l);C0(e,"track",l)&&(n=!0),o&&(s=!0),o||!t||(e=>{try{const t=new URL(e);return gWe.some((e=>e(t)))}catch{return!1}})(t)||(i=!0)}if(!(a||i||s||n||r))return[];const{mediaCache:d}=sr().state,c=Tu(e,d),u=c?await d$(c):void 0;u&&(a&&TWe(u,"waveform")&&(a=!1),i&&TWe(u,"original")&&(i=!1),s&&TWe(u,"preview")&&(s=!1),n&&TWe(u,"track")&&(n=!1),r&&TWe(u,"thumbnail_sheet")&&(r=!1)),e.preemptiveDownloadError&&(a=!1,i=!1,s=!1,n=!1);const m=[];return a&&m.push("waveform"),i&&m.push("original"),s&&m.push("preview"),n&&m.push("track"),r&&m.push("thumbnail_sheet"),m},SWe=(e,t,o)=>{if(o.startsWith("blob:"))return Promise.resolve(void 0);switch(e.type){case zl.Video:return IWe({assetId:e.asset_id,fileName:e.name,layer:e,type:t,url:o});case zl.Image:return CWe(e,t,o);case zl.Audio:return AWe({assetId:e.asset_id,layer:e,fileName:e.name,type:"waveform"===t?"waveform":"original",url:o});default:throw Error("downloadMediaBlob unexpected layer",e)}},EWe=(e,t)=>!e||"application/xml"===e.type||t&&t>=400,IWe=async({assetId:e,layer:t,fileName:o,type:a,url:i})=>{var s;RWe(`Downloading ${a} video asset ${i}`);const n=bu({asset_id:e,uploadId:null==t?void 0:t.uploadId}),r=t&&(!1!==t.hasAudio||"waveform"===a);r&&KJ(n,a);const{file:l,status:d,error:c}=await hWe({url:i,name:`${a}_${o}`});if(t&&("preview"===a||"track"===a)&&("Not Found"===c||(null==l?void 0:l.type)&&!l.type.includes("video")))return RWe(`Reoptimizing: ${t.id}`),void OI({[t.id]:{preview:void 0,track_preview:void 0}},"downloadLayer.ts",!1);if(t&&"waveform"===a&&EWe(l,d))return Z$(t.asset_id,!1),void(t.asset_id&&d&&d>=400&&Q$(t.asset_id,{waveformInfo:void 0}));if(l){if(r&&zJ(n,a),"original"===a||"preview"===a||"track"===a){new URL(i).hostname.endsWith("kapwing.com")&&hF(a,n,l.size)}if("preview"===a)await n$({mediaCacheId:n,type:zl.Video,optimizedPreviewFile:l});else if("track"===a)await n$({mediaCacheId:n,type:zl.Video,trackOptimizedPreviewFile:l});else if("original"===a)await n$({mediaCacheId:n,type:zl.Video,file:l});else if("thumbnail_sheet"===a){if(!l.type.includes("image"))return void console.error(`Error fetching thumbnail sheet. File is of type: ${l.type}`);const{state:e,dispatch:o}=sr();if(t&&t.asset_id&&(null==(s=e.assets.byId[t.asset_id])?void 0:s.thumbnail_sheet)){const{thumbnail_width:a,thumbnail_height:i,fps:s}=e.assets.byId[t.asset_id].thumbnail_sheet;await n$({mediaCacheId:n,type:zl.Video,thumbnailSheet:{file:l,thumbnail_width:a,thumbnail_height:i,fps:s}});const r=URL.createObjectURL(l),d=await d$(n);(null==d?void 0:d.thumbnailSheet)&&o(c_(n,{thumbnailSheetLocalInfo:{url:r,thumbnail_width:a,thumbnail_height:i,fps:s,sheet_height:d.thumbnailSheet.height,sheet_width:d.thumbnailSheet.width}}))}}else if(t&&"waveform"===a){const e=kWe(t);if(!e)return console.error("no metadata for waveform. should not happen"),void Z$(t.asset_id,!1);const o={file:l,duration:e.duration,sampleRate:e.sampleRate,isFfmpeg:e.isFfmpeg,scalingFactor:e.scalingFactor};await i$(n,o,zl.Video),Z$(t.asset_id,!0)}return r&&YJ(n,a),"waveform"!==a?l:void 0}},CWe=async(e,t,o)=>{const a=bu(e);RWe(`Downloading ${t} image asset ${o}`);const i=e.emojiDescription||e.name,{file:s}=await hWe({url:o,name:i});if(s){if("preview"===t?await n$({mediaCacheId:a,type:zl.Image,optimizedPreviewFile:s}):"track"===t?await n$({mediaCacheId:a,type:zl.Image,trackOptimizedPreviewFile:s}):"original"===t&&await n$({mediaCacheId:a,type:zl.Image,file:s}),"image/webp"===e.mime&&"unknown"===e.webpType){let t="static";try{t=await pB(s)}catch{console.error("Failed to determine webp file type")}OI({[e.id]:{webpType:t}},"downloadLayer.ts")}return s}},kWe=(e,t)=>{var o;const a=e.asset_id;if(!a)return null;return null==(o=(t||sr().state).assets.byId[a])?void 0:o.waveformInfo},AWe=async({assetId:e,layer:t,fileName:o,type:a,url:i})=>{const s=bu({asset_id:e,uploadId:null==t?void 0:t.uploadId});RWe(`Downloading audio asset ${i}`),KJ(s,a);const{file:n,status:r}=await hWe({url:i,name:o});if("waveform"===a&&EWe(n,r))return Z$(e,!1),void(e&&r&&r>=400&&Q$(e,{waveformInfo:void 0}));if(!n)return;zJ(s,a);const l=n.type.includes("audio")?zl.Audio:zl.Video;if("original"===a)await n$({mediaCacheId:s,type:l,file:n});else if(t){const o=kWe(t);if(!o)return console.error("no metadata for waveform. should not happen"),void Z$(e,!1);const a={file:n,duration:o.duration,sampleRate:o.sampleRate,isFfmpeg:o.isFfmpeg,scalingFactor:o.scalingFactor};await i$(s,a,l),Z$(e,!0)}return YJ(s,a),"waveform"!==a?n:void 0},jWe=async({onlyDownloadWaveforms:e,onDownload:t})=>{var o;const{state:a,dispatch:i}=sr(),{layers:s}=a.studio.scenes[0],n=new Map;for(const p of s){if(!wWe(p))continue;const e=bWe(p);n.has(e)?null==(o=n.get(e))||o.push(p):n.set(e,[p])}const r=[],l=Array.from(n.entries()),d=new Set;l.forEach((([e,t])=>{t.forEach((e=>{!e||"pastedLink"!==e.source||!e.asset_id||"preemptiveDownloadError"in e&&e.preemptiveDownloadError||d.add(e.asset_id)}))}));const c=new Map;if(d.size>0){const e=await G$(Array.from(d));e.forEach((e=>{c.set(e._id,e)})),i(JP(e))}if(await Promise.all(l.map((async([t,o])=>{const a=o[0].asset_id;if(!e&&a&&c.has(a)){((e,t)=>{for(const o of e)if(o&&"pastedLink"===o.source&&o.asset_id&&!o.preemptiveDownloadError)switch(t.status){case On.uploaded:{const o={};for(const a of e)if(!a.isMediaLibraryUpload){const e={source:"upload",uploadPending:!1,url:t.url,soundUrl:null};t.source_dimensions&&(e.height=t.source_dimensions.height,e.width=t.source_dimensions.width),o[a.id]=e}return void OI(o,"downloadLayer.ts")}case On.failed:return void(o.pastedUrl&&z$(o.pastedUrl))}})(o,c.get(a))}return(async(e,t,o)=>{const a=await xWe(t,o);for(const i of a){if(vWe[`${e}_${i}`])continue;const o=C0(t,i);o&&(o.startsWith("blob:")||r.push({downloadID:e,type:i,layer:t,url:o}))}})(t,o[0],e)}))),0===r.length)return;r.sort(((e,t)=>"waveform"===e.type?-1:"waveform"===t.type?1:"thumbnail_sheet"===e.type?-1:"thumbnail_sheet"===t.type?1:"track"===e.type?-1:"track"===t.type?1:0));const u=Math.min(5-yWe,r.length),m=r.slice(0,u);await Promise.all(m.map((async({downloadID:e,layer:o,type:a,url:i})=>{vWe[`${e}_${a}`]=!0,yWe+=1;try{const e=await SWe(o,a,i);e&&t(o,a,e)}catch(s){console.error(s)}yWe-=1,delete vWe[`${e}_${a}`]})))},NWe=async()=>{const{state:e}=sr(),{overlay:t}=e.projectSessionSettings;if(!t||t.key!==Ev.trim||"remote"!==t.params.source)return;const o=t.params;if(!_We[o.asset_id]){_We[o.asset_id]=!0;const e=await eY(o.url,{asset_id:o.asset_id});await SWe(e,"original",o.url)}},RWe=e=>{kr()||console.debug(e)},PWe=_.memo((({settings:e,workflow:t})=>{var o,a,i;const{assetId:s}=t,[n,r]=h.useState(""),{isOpen:l}=wue(gL.REPURPOSE_EDIT_HIGHLIGHT),d=h.useMemo((()=>{var e;return null==(e=t.words)?void 0:e.map(((e,o)=>({start:e.start_time,end:e.end_time,text:e.word,transcriptionNdx:o,assetId:t.assetId})))}),[t]),[c,u]=h.useState({}),m=h.useRef(!1),[p,g]=h.useState(t.asset.dimensions||null),f=tl((e=>e.mediaCache.assetIdToMediaCacheId[s])),y=f$(f);return h.useEffect((function(){az({startTour:!0,source:ad.RepurposeOnboarding})}),[]),h.useEffect((()=>{!async function(){var e,o;const a=null==(e=t.asset.content_type)?void 0:e.includes("audio");if(!(f?await d$(f):null))if(a){const e=t.asset.url;if(!e)return;AWe({assetId:s,fileName:t.name,layer:void 0,type:"original",url:e})}else{const e=null==(o=t.asset.preview)?void 0:o.url;if(!e)return;IWe({assetId:s,fileName:t.name,layer:void 0,type:"preview",url:e})}}()}),[s,f,t.asset.content_type,null==(o=t.asset.preview)?void 0:o.url,t.asset.url,t.name]),h.useEffect((()=>{if(!y)return;const e=y$(y,["preview"]);if(!e)return;const t=URL.createObjectURL(e);u({[s]:t})}),[s,y]),h.useEffect((function(){p||m.current||async function(){var e;try{m.current=!0;const o=(null==(e=t.asset.preview)?void 0:e.url)||t.asset.url;if(!o)throw new Error("No asset URL");const a=vB({name:o}),i=await xB(o,a||"video/mp4");if(i.success)return g({width:i.properties.width,height:i.properties.height}),!0;throw i.errorEvent}catch(o){return console.error(o),R(o,{tags:{"Repurpose Load Fail":!0,feature:bd.fhInWorkspace}}),!1}}().then((e=>{e||sr().dispatch(wl({type:"error",description:"Error loading highlights"}))}))}),[p,null==(a=t.asset.preview)?void 0:a.url,t.asset.url]),p?w.jsx(w.Fragment,{children:null==(i=null==t?void 0:t.highlights)?void 0:i.filter((e=>e.sections)).map(((o,a)=>w.jsx(mWe,{assetDimensions:p,settings:e,highlightDTO:t,highlight:o,localUrls:c,words:d,showRepurposeTourPopover:l&&0===a,playingClip:n,setPlayingClip:r},o.id)))}):null})),DWe=_.memo((({workflow:e,settings:t})=>{if(fd(e))return w.jsx("div",{className:pWe,children:w.jsx(PWe,{settings:t,workflow:e})});return yd(e)?w.jsx("div",{className:pWe,children:bi.times(5,String).map(((e,o)=>w.jsx(uWe,{settings:t},o)))}):w.jsx("div",{children:"Failed to generate highlights, please try again."})})),OWe=_.memo(DWe),LWe="KapwingProgressBar-module_progressBar_kjq3V",FWe="KapwingProgressBar-module_progress_AHFOa",MWe=_.memo((({progress:e})=>w.jsx("div",{className:LWe,children:w.jsx("div",{className:FWe,style:{width:`${e||0}%`}})}))),UWe=[{name:"Youtube Video (1920x1080 - 16:9)",aspectRatio:[1920,1080],shortAspectRatio:[16,9],key:"youtube-video"},{name:"Youtube Shorts (1080x1920 - 9:16)",aspectRatio:[1080,1920],shortAspectRatio:[9,16],key:"youtube-shorts"},{name:"TikTok (1080x1920 - 9:16)",aspectRatio:[1080,1920],shortAspectRatio:[9,16],key:"tiktok"},{name:"Instagram Post Square (1080x1080 - 1:1)",aspectRatio:[1080,1080],shortAspectRatio:[1,1],key:"instagram-post-square"},{name:"Instagram Post Portrait (1080x1350 - 4:5)",aspectRatio:[1080,1350],shortAspectRatio:[4,5],key:"instagram-post-portrait"},{name:"Instagram Story / Reel (1080x1920 - 9:16)",aspectRatio:[1080,1920],shortAspectRatio:[9,16],key:"instagram-story"},{name:"Twitter Post (1600x900 - 16:9)",aspectRatio:[1600,900],shortAspectRatio:[16,9],key:"twitter-post"},{name:"LinkedIn Post (1200x1200 - 1:1)",aspectRatio:[1200,1200],shortAspectRatio:[1,1],key:"linkedin-post"},{name:"Facebook Post (1200x630 - 1.91:1)",aspectRatio:[1200,630],shortAspectRatio:[1.91,1],key:"facebook-post"},{name:"Facebook Video (1080x1080 - 1:1)",aspectRatio:[1080,1080],shortAspectRatio:[1,1],key:"facebook-video"},{name:"OG Image (1200x630 - 1.91:1)",aspectRatio:[1200,630],shortAspectRatio:[1.91,1],key:"og-image"}],BWe=[{name:"Instagram Post Square (1:1)",aspectRatio:[1080,1080],shortAspectRatio:[1,1],key:"instagram-post-square"},{name:"Instagram Story Post (9:16)",aspectRatio:[1080,1920],shortAspectRatio:[9,16],key:"instagram-story"},{name:"Instagram Post Portrait (4:5)",aspectRatio:[1080,1350],shortAspectRatio:[4,5],key:"instagram-post-portrait"},{name:"Youtube Video Thumbnail (16:9)",aspectRatio:[1920,1080],shortAspectRatio:[16,9],key:"youtube-video"},{name:"Youtube Shorts Thumbnail (9:16)",aspectRatio:[1080,1920],shortAspectRatio:[9,16],key:"youtube-shorts"},{name:"TikTok Image (9:16)",aspectRatio:[1080,1920],shortAspectRatio:[9,16],key:"tiktok"},{name:"Twitter Post (16:9)",aspectRatio:[1600,900],shortAspectRatio:[16,9],key:"twitter-post"},{name:"LinkedIn Post (1:1)",aspectRatio:[1200,1200],shortAspectRatio:[1,1],key:"linkedin-post"},{name:"Facebook Post (1.91:1)",aspectRatio:[1200,630],shortAspectRatio:[1.91,1],key:"facebook-post"},{name:"OG Image (1200x630 - 1.91:1)",aspectRatio:[1200,630],shortAspectRatio:[1.91,1],key:"og-image"}],VWe=[{name:"Youtube Video (1280x720 - 16:9)",aspectRatio:[1280,720],shortAspectRatio:[16,9],key:"youtube-video"},{name:"Youtube Shorts (720x1280 - 9:16)",aspectRatio:[720,1280],shortAspectRatio:[9,16],key:"youtube-shorts"},{name:"TikTok (720x1280 - 9:16)",aspectRatio:[720,1280],shortAspectRatio:[9,16],key:"tiktok"},{name:"Instagram Post Square (1080x1080 - 1:1)",aspectRatio:[1080,1080],shortAspectRatio:[1,1],key:"instagram-post-square"},{name:"Instagram Post Portrait (864x1080 - 4:5)",aspectRatio:[864,1080],shortAspectRatio:[4,5],key:"instagram-post-portrait"},{name:"Instagram Story / Reel (720x1280 - 9:16)",aspectRatio:[720,1280],shortAspectRatio:[9,16],key:"instagram-story"},{name:"Twitter Post (1280x720 - 16:9)",aspectRatio:[1280,720],shortAspectRatio:[16,9],key:"twitter-post"},{name:"LinkedIn Post (1200x1200 - 1:1)",aspectRatio:[1200,1200],shortAspectRatio:[1,1],key:"linkedin-post"},{name:"Facebook Post (940x788 - 1.91:1)",aspectRatio:[940,788],shortAspectRatio:[1.91,1],key:"facebook-post"},{name:"Facebook Video (1080x1080 - 1:1)",aspectRatio:[1080,1080],shortAspectRatio:[1,1],key:"facebook-video"},{name:"OG Image (1200x630 - 1.91:1)",aspectRatio:[1200,630],shortAspectRatio:[1.91,1],key:"og-image"}],WWe=_.memo((({workflow:e})=>{const t=Ve(),{estimatedTimeRemaining:o,progress:a}=(e=>{if(!e.assetDurationSec)return{progress:0,estimatedTimeRemaining:0};const t=new Date,o=new Date(e.createdAt),a=310*e.assetDurationSec+42e4,i=t.getTime()-o.getTime(),s=Math.min(100,i/a*100),n=Math.max(0,a-i);return{progress:s,estimatedTimeRemaining:Math.max(n/1e3/60,2)}})(e),i=tl((t=>t.workflows.settingsByFolderId[e.folderId])),[s,n]=h.useState((null==i?void 0:i.ratio)||"9:16"),[r,l]=h.useState((null==i?void 0:i.subtitlePreset)||hg),[d,c]=h.useState("speaker-focus"===(null==i?void 0:i.resizeMode)||!0),[u,m]=h.useState(null),p=h.useCallback((e=>{var t;if(m(e),e.studio.ratio){const t=e.studio.ratio,o=UWe.find((e=>e.aspectRatio.join(":")===t||e.shortAspectRatio.join(":")===t));n((null==o?void 0:o.shortAspectRatio.join(":"))||t)}(null==(t=e.studio.magicSubtitlesGlobal)?void 0:t.preset)&&l(e.studio.magicSubtitlesGlobal.preset)}),[m,n,l]),g=h.useMemo((()=>({ratio:s,resizeMode:d?"speaker-focus":"fit-to-center",subtitlePreset:r,blueprint:u})),[s,r,d,u]),f=ku(),y=yd(e),v="failed"===e.status;const b=fd(e),T=e._id,x=b?e.asset.duration:0;h.useEffect((function(){b&&Fm(ym.REPURPOSE_VIEWED_COMPLETED_EDITOR,{"Asset Duration (min)":(x??0)/60,"Find Highlights Workflow ID":T})}),[b,x,T]),h.useEffect((function(){v&&(async()=>{await Uje(e._id),t.push(`/repurpose/create?asset_id=${e.assetId}`),hh({description:"There was an error generating your clips. Please try again."})})()}),[t,v,e._id,e.assetId]),h.useEffect((function(){e._id===qNe&&rz()}),[e._id]);const S=_.useRef(null),E=fd(e)?e.projects.length:0;h.useEffect((function(){S.current&&E>0&&S.current.scrollTo({top:0,behavior:"smooth"})}),[E]),xhe((function(){if(!fd(e))return;const t=e.projects.filter((e=>e.hasPendingExport));Promise.all(t.map((e=>async function(e,t){const{dispatch:o,state:a}=sr(),i=a.workflows.exportProgressByVideoId[e.id];let s;if(i)s=i.processVideoJobId;else{const t=await Yr(`/api/v2/video-creation/${e.id}/runningExport`);if(!t.success||!t.processVideoJob)return;s=t.processVideoJob._id}const{createdAt:n,progressDict:r,status:l}=await Yr(`/api/v2/video-creation/progress/${s}`);if("running"===l){let t=0;r&&(t=Che({progressDict:r,createdAt:n})),o($L.exportProgressUpdated({videoId:e.id,progress:t,processVideoJobId:s}))}else Vje(t),o($L.exportProgressCleared(e.id))}(e,T)))).catch(console.error)}),5e3);const I=h.useMemo((()=>{var t,i,s;if(!y)return w.jsx("div",{className:oBe,children:"Your suggested clips"});const n=(null==(t=e.jobData)?void 0:t.totalStages)||0,r=Math.min(((null==(i=e.jobData)?void 0:i.stage)||0)+1,n);return w.jsxs("div",{className:aBe,children:[w.jsxs("div",{className:oBe,children:[w.jsx("div",{children:"Your suggested clips"}),w.jsxs("div",{className:QUe,children:[w.jsx("div",{className:ZUe}),w.jsx("div",{children:"Generating clips... you’ll receive an email when they’re ready to review. Feel free to leave this page for now."})]})]}),!!o&&!!a&&w.jsxs("div",{className:iBe,children:[w.jsx(MWe,{progress:Math.min((null==(s=e.jobData)?void 0:s.percent)||a,95)}),e.jobData&&!!o&&w.jsxs("div",{className:sBe,children:[w.jsx("div",{children:`Step ${r} of ${n}`}),w.jsxs("div",{children:["~",Math.round(o)," minutes remaining"]})]})]})]})}),[o,y,a,e.jobData]);return w.jsx(w.Fragment,{children:w.jsxs("div",{className:eBe,children:[!f&&w.jsxs("div",{className:lBe,children:[w.jsxs("div",{className:tBe,children:[I,w.jsx("div",{className:nBe,children:w.jsx(rVe,{aspectRatio:s,setAspectRatio:n,subtitlePreset:r,setSubtitlePreset:l,useSpeakerFocus:d,setUseSpeakerFocus:c,selectedBlueprint:u,selectBlueprint:p})})]}),w.jsx("div",{className:rBe,children:w.jsx(OWe,{workflow:e,settings:g})})]}),w.jsx("div",{className:dBe,ref:S,children:w.jsx(DVe,{workflow:e})})]})})})),GWe="RepurposeLimitBanner-module_banner_qiBqh",HWe="RepurposeLimitBanner-module_icon_ozV-g",$We="RepurposeLimitBanner-module_button_ktIm5",KWe="RepurposeLimitBanner-module_warning_IgRzZ",zWe="RepurposeLimitBanner-module_blocked_-99m8",YWe=_.memo((()=>{var e,t;const o=_Q(),a=null==(e=o.TRANSCRIBE)?void 0:e.hasConsumedLimit,i=null==(t=o.TRANSCRIBE)?void 0:t.is90PercentConsumed,s=ou(),n=h.useMemo((()=>i?{icon:w.jsx(fs,{}),text:"You’ve almost reached your workspace’s transcription limit for this month. To increase your transcription minutes, upgrade now to one of our paid plans.",className:KWe,theme:"dark"}:a?{icon:w.jsx(ys,{}),text:"You’ve reached your workspace’s transcription limit for this month. To increase your transcription minutes, upgrade now to one of our paid plans.",className:zWe,theme:"light"}:null),[a,i]);return n&&s.type!==Cl.Free?w.jsxs("div",{className:mt([GWe,n.className]),children:[w.jsx("div",{className:HWe,children:n.icon}),w.jsx("span",{children:n.text}),w.jsx(jie,{action:Vl.REPURPOSE_STUDIO,darkStyle:"dark"===n.theme,className:$We,buttonText:"Contact Sales",hasIcon:!1})]}):null})),JWe=_.memo((()=>{const{workflowId:e}=ua(),{workflow:t,isLoading:o}=Fje({workflowId:"sample"===e?qNe:e}),{isLoading:a}=eNe({preferredFolderId:null==t?void 0:t.folderId,preferredTeamId:null==t?void 0:t.teamId}),i=tl((e=>nu(e))),{isOpen:s}=wue(),n=QBe(eVe.REPURPOSE_SAMPLE_TOUR);return zBe(null==t?void 0:t.teamId),h.useEffect((function(){n&&(i||az({source:ad.LandingPage}),(null==t?void 0:t._id)!==qNe||s||az({tour:fL.RepurposeSample,source:ad.Unknown,startStep:gL.REPURPOSE_EDIT_HIGHLIGHT}))}),[n,i,s,null==t?void 0:t._id]),o||a?w.jsx(Y4,{theme:RF.Studio,title:"Just a second... loading project"}):w.jsxs(w.Fragment,{children:[w.jsx(Mt,{children:w.jsx("meta",{name:"robots",content:"noindex, nofollow"})}),w.jsx(rUe,{workflow:t}),!e&&w.jsx(YWe,{}),w.jsx("div",{className:XUe,children:t?w.jsx(WWe,{workflow:t}):w.jsx(qUe,{})})]})})),qWe={pathname:"/home",state:{openModal:c9.account}},XWe={pathname:"/home",state:{openModal:c9.account}},QWe={pathname:"/home",state:{openModal:c9.accountChange}},ZWe={style:{verticalAlign:"middle"}};class eGe extends h.Component{constructor(e){super(e),i(this,"refreshCurrentUser"),i(this,"checkBrowser",(()=>{var e;if(Kg()||(null==(e=Hg.browser.name)?void 0:e.includes("Edge"))||Jg())return;const{location:t}=this.props,{pathname:o}=t,a=o.startsWith("/folder"),i=o.endsWith("/studio/editor");if(!a&&!i)return;const s=sh.get("BROWSER_COOLDOWN_DATE",{disabled:""});if(s){const e=l(s).add(14,"days").endOf("day");if(l().isBefore(e))return}const{showToast:n}=this.props;n({type:"warning",callbackId:Nv.BROWSER_WARN,description:"For the best editing experience, please consider switching to the ",link:{inline:!0,text:"Google Chrome Browser.",href:"https://www.google.com/chrome/"}}),Fm(ym.SHOWN_BROWSER_WARNING)})),i(this,"getCustomPageRedirects",(()=>{const e=[];return v7.forEach((t=>{if(t.redirect)if("string"==typeof t.redirect)e.push(w.jsx(dTe,{from:t.redirect,exact:!0,to:t.url},t.redirect));else if(Array.isArray(t.redirect))for(const o of t.redirect)e.push(w.jsx(dTe,{from:o,exact:!0,to:t.url},o))})),e})),i(this,"renderSnapshotDebugContainer",(()=>w.jsx(r9,{snapshot:!0}))),i(this,"renderVideoContainer",(()=>w.jsx(jbe,{hostDomain:this.props.hostDomain}))),i(this,"renderHealthCheckSuccess",(()=>"Success")),i(this,"render404Routes",(({staticContext:e})=>(e&&(e.statusCode=404),w.jsx(Mee,{})))),i(this,"renderSwitch",(()=>w.jsxs(zt,{children:[Cm()&&!this.props.currentUser.token&&w.jsx(dTe,{exact:!0,from:"/",to:"/pwaHome"}),this.props.currentUser.token&&w.jsx(dTe,{exact:!0,from:"/pwaHome",to:"/"}),w.jsx(Yt,{exact:!0,path:"/",component:jTe}),w.jsx(Yt,{exact:!0,path:"/user/:userId",component:jTe}),w.jsx(Yt,{exact:!0,path:"/pwaHome",component:ATe}),w.jsx(dTe,{exact:!0,from:"/join",to:"/"}),w.jsx(dTe,{exact:!0,from:"/join/:code",to:"/"}),w.jsx(Yt,{path:"/admin",component:i9}),w.jsx(Yt,{path:"/videos/:id/debug",component:r9}),w.jsx(Yt,{path:"/videos/:id/snapshots",exact:!0,component:Ube}),w.jsx(Yt,{path:"/exports/:snapshot_id",exact:!0,component:bMe}),w.jsx(Yt,{path:"/videos/:id/snapshots/:snapshot_id/debug",render:this.renderSnapshotDebugContainer}),w.jsx(Yt,{exact:!0,path:"/videos/:id/comment/:commentId",render:this.renderVideoContainer}),w.jsx(Yt,{exact:!0,path:"/videos/:id",render:this.renderVideoContainer}),w.jsx(Yt,{path:"/handleCheckout",component:w7}),w.jsx(dTe,{from:"/workspace/:subpath",to:"/folder/:subpath"}),w.jsx(dTe,{from:"/workspace",to:"/home"}),w.jsx(Yt,{exact:!0,path:"/home",component:vOe}),w.jsx(Yt,{exact:!0,path:"/brandkit",component:vOe}),w.jsx(Yt,{exact:!0,path:"/workflows",component:vOe}),w.jsx(Yt,{exact:!0,path:"/folder",component:vOe}),w.jsx(Yt,{exact:!0,path:"/folder/:id",component:vOe}),w.jsx(Yt,{exact:!0,path:"/folder/:id/rename",component:vOe}),w.jsx(Yt,{exact:!0,path:"/folder/create",component:vOe}),w.jsx(Yt,{exact:!0,path:"/folder/:id/create",component:vOe}),w.jsx(Yt,{exact:!0,path:"/search",component:vOe}),w.jsx(Yt,{exact:!0,path:"/search/:teamId",component:vOe}),w.jsx(Yt,{exact:!0,path:"/shared-with-me",component:vOe}),w.jsx(dTe,{from:"/my/videos",to:"/home"}),w.jsx(dTe,{from:"/my/account",to:qWe}),w.jsx(Aa,{exact:!0,path:"/settings/account",to:XWe}),w.jsx(Aa,{exact:!0,path:"/settings/account/change",to:QWe}),w.jsx(dTe,{from:"/my",to:"/home"}),w.jsx(Yt,{path:"/settings",component:vOe}),w.jsx(Yt,{path:"/workflows",component:vOe}),w.jsx(Yt,{path:"/settings/folder/cancel",component:vOe}),w.jsx(Yt,{exact:!0,path:"/team/sharing/:linkId",component:bTe}),w.jsx(Yt,{exact:!0,path:"/team/invite/:inviteKey",component:bTe}),w.jsx(Yt,{exact:!0,path:"/team/invite/new-user/:inviteKey",component:KMe}),w.jsx(Yt,{path:"/defaultTeamFolder/:teamId",component:vOe}),w.jsx(Yt,{path:"/team/:teamId",component:vOe}),this.getCustomPageRedirects(),v7.map((e=>w.jsx(Yt,{path:e.url,exact:!0,component:e.component},e.url))),w.jsx(Yt,{exact:!0,path:"/upload/:id",component:qMe}),w.jsx(dTe,{from:"/editor",exact:!0,to:"/"}),w.jsx(dTe,{from:"/editor/trimmer",to:"/tools/trim-video"}),w.jsx(dTe,{from:"/editor/subtitles",to:"/subtitles"}),w.jsx(dTe,{from:"/editor/add-audio-to-video",to:"/tools/add-audio"}),w.jsx(dTe,{from:"/editor/convert",to:"/tools/convert"}),w.jsx(dTe,{from:"/editor/video-speed",to:"/tools/resize"}),w.jsx(dTe,{from:"/editor/audio-trimmer",to:"/tools/trim-audio"}),w.jsx(dTe,{from:"/editor/resize",to:"/tools/resize"}),w.jsx(Yt,{path:"/editor/videos/:id",component:Z4}),w.jsx(Yt,{path:"/editor/memes",component:t9}),w.jsx(Yt,{path:"/editor/watermarker",component:t9}),w.jsx(Yt,{path:"/editor/confirm",component:t9}),w.jsx(Yt,{path:"/editor/adjust",component:t9}),w.jsx(Yt,{path:"/editor/loop-video",component:t9}),w.jsx(Yt,{path:"/editor/filters",component:t9}),w.jsx(Yt,{path:"/editor/mute-video",component:t9}),w.jsx(Yt,{path:"/editor/image-to-video",component:t9}),w.jsx(Yt,{path:"/editor/add-text",component:t9}),w.jsx(Yt,{path:"/editor/rotate",component:t9}),w.jsx(Yt,{path:"/editor/volume-adjust",component:t9}),w.jsx(Yt,{path:"/editor/stop-motion",component:t9}),w.jsx(Yt,{path:"/editor/reverse",component:t9}),w.jsx(dTe,{from:"/:id?/studio/editor/layer/:layerId",to:"/:id?/studio/editor"}),w.jsx(Yt,{path:"/:id?/studio/editor/sharing",component:a9}),w.jsx(Yt,{path:"/:id?/studio/editor/comment/:commentId",component:a9}),w.jsx(Yt,{path:"/:id?/studio/editor/",component:a9}),w.jsx(Yt,{path:"/repurpose/create",component:JWe}),w.jsx(Yt,{path:"/repurpose/:workflowId",component:JWe}),w.jsx(Yt,{path:"/explore/:slug",component:ZFe}),w.jsx(dTe,{from:"/exploreall",exact:!0,to:"/explore"}),w.jsx(dTe,{from:"/explore-all",to:"/explore"}),w.jsx(dTe,{from:"/explore/directory",exact:!0,to:"/explore"}),w.jsx(dTe,{statusCode:404,from:"/browse",to:"/404"}),w.jsx(dTe,{statusCode:404,from:"/posts",to:"/404"}),w.jsx(dTe,{from:"/maker",exact:!0,to:"/video-maker"}),w.jsx(dTe,{exact:!0,from:"/maker/editor",to:"/studio/editor/scenes"}),w.jsx(dTe,{from:"/maker",to:"/video-maker"}),w.jsx(Yt,{path:"/startup-demo-videos",exact:!0,component:Roe}),w.jsx(Yt,{path:"/startup-demo-videos/:id",component:Aoe}),w.jsx(Yt,{path:"/rick-roller",component:Vee}),w.jsx(Yt,{path:"/logo-redesigns",component:Jbe}),w.jsx(Yt,{path:"/how-much-twitch-streamers-make",component:lTe}),w.jsx(Yt,{path:"/new-tab-stretches",component:Nee}),w.jsx(Yt,{path:"/museum-of-websites",exact:!0,component:P8}),w.jsx(Yt,{path:"/museum-of-websites/:id",component:F8}),w.jsx(Yt,{path:"/evolution-of-products",exact:!0,component:P8}),w.jsx(Yt,{path:"/evolution-of-products/:id",component:F8}),w.jsx(Yt,{path:"/mobile-mockup",component:k7}),w.jsx(Yt,{path:"/motion",component:mee}),w.jsx(Yt,{path:"/sidedoor",component:moe}),w.jsx(Yt,{path:"/404-illustrations",component:g6}),w.jsx(Yt,{path:"/sonoma-county-fire-map",component:K8}),w.jsx(Yt,{path:"/sound-effects",component:Ioe}),w.jsx(Yt,{path:"/off-site/long-tail-analytics",component:s9}),w.jsx(Yt,{path:"/edu/login",component:T8}),w.jsx(Yt,{path:"/edu/signup",component:I8}),w.jsx(Yt,{path:"/edu/admin-signup",component:C8}),w.jsx(Yt,{path:"/signin-redirect/",component:Uee}),w.jsx(Yt,{path:"/signin/onetap",component:pee}),w.jsx(Yt,{path:"/signin",component:woe}),w.jsx(Yt,{path:"/sso-signin",component:zMe}),w.jsx(dTe,{from:"/sign-in",to:"/sigin"}),w.jsx(dTe,{from:"/gif-meme-generator",to:"/"}),w.jsx(dTe,{from:"/editor/montage",to:"/maker/editor"}),w.jsx(dTe,{from:"/create/editor",to:"/studio/editor"}),w.jsx(dTe,{from:"/:id?/editor/subtitles",to:"/:id?/studio/editor"}),w.jsx(dTe,{from:"/2020-election-meme-templates",to:"/explore/2020-new-york-times-election-needle-meme-template"}),w.jsx(dTe,{from:"/blade-runner-generator",to:"/explore"}),w.jsx(dTe,{from:"/tools/resources/video-editor-for-youtube/",to:"https://www.kapwing.com/resources/video-editor-for-youtube/"}),w.jsx(Yt,{path:"/health",render:this.renderHealthCheckSuccess}),w.jsx(Yt,{path:"/404",render:this.render404Routes}),w.jsx(Yt,{render:this.render404Routes})]})));const{config:t}=e;e.setConfig(t),this.refreshCurrentUser=s.debounce(np,3e3,{leading:!0,trailing:!1})}componentDidMount(){const{setKapwingInit:e,currentUser:t}=this.props;e(),"undefined"!=typeof window&&(this.refreshCurrentUser().catch((e=>{mh({description:"Failed to refresh user profile.",error:e})})),cTe(),this.checkBrowser());const o=new d,a=o.get("samlSignedInCookie");if(a){const[e,t]=a.split("."),i=atob(t.replace(/-/g,"+").replace(/_/g,"/")),s=JSON.parse(i),n=a;this.props.receiveUserAndSetToken(s,n),o.remove("samlSignedInCookie")}wc(t)&&$p()}componentDidUpdate(e){const{location:t}=this.props,{location:o}=e;t.pathname!==o.pathname&&this.onRouteChanged(o),"/pricing"!==t.pathname&&window.fcWidget&&window.fcWidget.hide()}onRouteChanged(e){const{location:t}=this.props,{pathname:o}=t,{pathname:a}=e;o.includes("/studio/editor")&&a.includes("/studio/editor")||this.refreshCurrentUser()}renderApp(){const{showSignIn:e}=this.props,t="Kapwing — Create more content in less time",o="Kapwing is a collaborative, online content creation platform that you can use to edit video and create content. Join over 10 million modern creators who trust Kapwing to create, edit, and grow their content on every channel.",a="https://cdn-useast1.kapwing.com/static/jQ9-og-image-(1).webp";return w.jsxs("div",{className:Du({"app-container":!0,"col-resize":this.props.isResizingMediabar}),children:[w.jsxs(Mt,{children:[w.jsx("title",{children:t}),w.jsx("meta",{name:"description",content:o}),w.jsx("meta",{name:"keywords",content:"video editor, meme maker, video resizer, gif editor, video subtitles"}),w.jsx("meta",{property:"og:title",content:t}),w.jsx("meta",{property:"og:description",content:o}),w.jsx("meta",{property:"og:image",content:a}),w.jsx("meta",{property:"og:image:url",content:a}),w.jsx("meta",{property:"twitter:image",content:a}),w.jsx("meta",{property:"og:type",content:"website"}),w.jsx("meta",{property:"og:image:width",content:"1200"}),w.jsx("meta",{property:"og:image:height",content:"630"}),w.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),w.jsx("link",{rel:"canonical",href:"https://www.kapwing.com/"}),w.jsx("link",{rel:"apple-touch-icon",sizes:"180x180",href:"https://cdn-useast1.kapwing.com/static/pjS-apple-touch-icon.png"}),w.jsx("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"https://cdn-useast1.kapwing.com/static/eAW-favicon-32x32.png"}),w.jsx("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"https://cdn-useast1.kapwing.com/static/5SL-favicon-16x16.png"}),w.jsx("link",{rel:"shortcut icon",type:"image/x-icon",href:"https://cdn-useast1.kapwing.com/static/TwE-favicon.ico"}),w.jsx("link",{rel:"manifest",href:"/manifest.webmanifest"}),w.jsx("link",{rel:"mask-icon",href:"https://cdn-useast1.kapwing.com/static/PeB-safari-pinned-tab.svg",color:"#0083e2"}),w.jsx("meta",{name:"msapplication-TileColor",content:"#18e1d6"}),w.jsx("meta",{name:"theme-color",content:"#ffffff"})]}),w.jsx(FMe,{}),w.jsx(yW,{}),w.jsx(tFe,{}),this.renderSwitch(),w.jsxs(d9,{children:[e&&w.jsx(bV,{hideSignIn:Rj}),w.jsx(n9,{}),w.jsx(_Oe,{}),w.jsxs("div",{style:{display:"none",position:"absolute",zIndex:-1},children:[w.jsx("canvas",{id:"canvas-scratchpad"}),w.jsx("div",{id:"scene-list-premount"})]}),w.jsx(l9,{})]})]})}render(){const{location:e}=this.props;return new URLSearchParams(e.search).get("isTWA")&&sh.set("isTWA","true"),w.jsx(vs.Provider,{value:ZWe,children:w.jsx(G4,{children:w.jsx(vE,{children:this.renderApp()})})})}}const tGe=je(g.connect((e=>({showSignIn:e.studioLocal.showSignIn,currentUser:e.currentUser,isResizingMediabar:e.studioLocal.isResizingMediaBar})),(e=>ye({setConfig:Bbe,setKapwingInit:gD,receiveUserAndSetToken:sp,showToast:wl},e)))(eGe)),oGe=_.memo((()=>{const e=il(),t=tl(FL),o=bc();return h.useEffect((()=>{t&&o&&(async()=>{try{const t=(await Yr("/api/v2/flags",{retries:3})).reduce(((e,t)=>(e[t.name]=t,e)),{});e(ML.setFlags(t))}catch(IGe){console.error(IGe),e(ML.setErrorMessage((null==IGe?void 0:IGe.message)||"An error has occured"))}})()}),[e,t,o]),null})),aGe="ServiceOutageWarning-module_banner_zHEqK",iGe="ServiceOutageWarning-module_leftSideContainer_lXogB",sGe="ServiceOutageWarning-module_warningIcon_g3f47",nGe="ServiceOutageWarning-module_ctaButton_YJr4C",rGe="ServiceOutageWarning-module_close_g7zC0",lGe="ServiceOutageWarning-module_text_p5LdX";const dGe=_.memo((function(){const e=XBe().SERVICE_INSTABILITY,t=sh.get("lastSeenServiceInstability",{disabled:null}),[o,a]=h.useState(!0),i=h.useCallback((()=>{sh.set("lastSeenServiceInstability",Date.now()),a(!1)}),[]);return e?e.status!==ZBe.ON?null:o?t&&Date.now()-t<18e5?null:_e.createPortal(w.jsxs("div",{className:aGe,children:[w.jsxs("div",{className:iGe,children:[w.jsx(Ni,{className:sGe}),w.jsx("div",{className:lGe,children:e.message||"We are currently experiencing a service outage. Please check back later."}),w.jsx("button",{className:nGe,type:"button",onClick:()=>{window.location.href="https://kapwing.com/help/status"},children:"Learn More"})]}),w.jsx(ve,{className:rGe,onClick:i})]}),document.body):null:null})),cGe={async:!0,defer:!0},uGe={enableMouseEvents:!0},mGe=_.memo(_s((e=>{const{config:t,store:o}=e;return h.useEffect((()=>{const e=document.createElement("script");e.src="https://connect.facebook.net/en_US/sdk.js",e.async=!0,setTimeout((()=>{document.body&&document.body.appendChild(e)}),3e3)}),[]),w.jsx(g.Provider,{store:o,children:w.jsxs(QU,{refreshOnError:!0,children:[w.jsx(oGe,{}),w.jsx(dGe,{}),w.jsx(ws,{reCaptchaKey:t.RECAPTCHA_V3_SITEKEY,useRecaptchaNet:!0,scriptProps:cGe,children:w.jsx(EF,{children:w.jsx(AF,{children:w.jsx(bs,{backend:Ts,options:uGe,children:w.jsxs(xs,{history:ir,children:[w.jsx(B4,{}),w.jsx(eU,{children:w.jsx(V4,{children:w.jsx(cM,{children:w.jsx(tGe,{config:t})})})})]})})})})})]})})})));function pGe(){const e={};"deviceMemory"in navigator&&(e.deviceMemoryGB=navigator.deviceMemory);const t=au();return e.isPayingCustomer=t.isPaid,e}async function hGe(){const e={...ip()},{totalAssetSize:t}=bH();e["IndexedDB Size Estimate (GB)"]=Number((t/_n).toFixed(2));try{const t=await yH({actionDescription:"Estimating storage usage",promise:navigator.storage.estimate(),timeoutMs:2e3}),{quota:o,usage:a}=t;if(void 0!==a&&(e["Storage Usage (GB)"]=Number((a/_n).toFixed(2))),void 0!==o&&(e["Storage Quota (GB)"]=Number((o/_n).toFixed(2))),void 0!==a&&void 0!==o&&(e["Storage Usage (%)"]=Number((a/o*100).toFixed(2))),"usageDetails"in t){const o=t.usageDetails;Object.entries(o).forEach((([t,o])=>{e[`${t} Storage Usage (GB)`]=Number((Number(o)/_n).toFixed(2))}))}}catch(o){}return e}const gGe=["AbortError","FetchStatusError"],fGe=["The play() request was interrupted by a call to pause()","The element has no supported source","The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission","The operation is not supported.","Network request failed","A network error occurred.","ResizeObserver loop"],yGe=[{key:"IDB Connection Closing",test:({message:e})=>e.includes("IDBDatabase")&&e.includes("database connection is closing")||e.includes("mutation operation was attempted on a database that did not allow mutations"),timeSec:180},{key:"QuotaExceededError",test:({message:e,name:t})=>e.includes("QuotaExceededError")||t.includes("QuotaExceededError"),timeSec:180},{key:"Large IDB",test:({message:e})=>e.includes("large IndexedDB value"),timeSec:180},{key:"IDB timeout",test:({message:e})=>e.includes("IDB")&&e.includes("timed out in"),timeSec:180}],vGe=new Map;const _Ge=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function wGe(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const o=e.installing;null!=o&&(o.onstatechange=()=>{"installed"===o.state&&t&&t.onUpdate&&t.onUpdate(e)})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}const{domain:bGe}=document,TGe=bGe.startsWith("localhost"),xGe={CLOUD_FUNCTIONS_PREFIX:"",COMMIT:"fb81cb8c",FACEBOOK_APP_ID:"713985848677391",FRESH_CHAT_TOKEN:"6c78e084-ae7a-4b7b-8968-358ae3123d5b",GIPHY_SEARCH_KEY:"rfMjRmVqUkVPENBuewLHtXp6kXPjSBvq",GOOGLE_ANALYTICS_CODE:"UA-100629017-1",GOOGLE_PLUGINS_CLIENT_ID:"823730063895-iqn5t0hivtu1ss7c2mhpfdmh1ghlf9fa.apps.googleusercontent.com",GOOGLE_PLUGINS_KEY:"AIzaSyDi2438fC9BfPQygJUdixA3nq_NjihWTTQ",RECAPTCHA_V2_SITEKEY:"6Ldl1T0nAAAAAGBso1ybOyel1edUwslYZd7jF2Io",RECAPTCHA_V3_SITEKEY:"6LciWYwhAAAAAP9IBiJn1FoBRXISf74l3U6TvAL8",SENTRY_ENV:"production",STRIPE_PUBLIC_KEY:"pk_live_2sDMAtDohnudYHgRDvCSQelo",UNSPLASH_KEY:"GzIAtsrV-zOLLJXWiLhxxd_2hcWz1JCHsIXWAYJ5rE0"};(bGe.endsWith(".kapwing-dev.com")||bGe.startsWith("kapwing-dev")&&bGe.endsWith(".herokuapp.com")||TGe&&["3000","4000","5000"].includes(window.location.port)||bGe.startsWith("192.")||bGe.startsWith("10.0.")||bGe.startsWith("10.1."))&&(Object.assign(xGe,{FACEBOOK_APP_ID:"2545197755522838",RECAPTCHA_V2_SITEKEY:"6LdpYicdAAAAALsID-RPNNp91_n_4otjuyj-CG6U",RECAPTCHA_V3_SITEKEY:"6Leu-AgdAAAAADasOHy2VJPi1xbcAnWrI8mE8t0d",STRIPE_PUBLIC_KEY:"pk_test_7MMbY1maBR111EJDSqeWIhHR"}),window.Cypress||(xGe.CLOUD_FUNCTIONS_PREFIX="dev_")),Object.assign(Zr,sh.get("devModeDebugFlags",{disabled:{}})??{}),zme.dispatchEvent(new Event("update"));try{!function(){if(window.SENTRY_ENV="production",Ss({enabled:!wr&&!window.Cypress,beforeSend:async(e,t)=>{var o,a,i,s,n,r,l;if(null==(o=t.originalException)?void 0:o.__SKIP_SENTRY)return null;if(null==(a=e.extra)?void 0:a.__FORCE_SAMPLE)return e;const d=t.originalException&&"object"==typeof t.originalException&&"message"in t.originalException&&"string"==typeof t.originalException.message?null==(i=t.originalException)?void 0:i.message:e.message||"",c=t.originalException&&"object"==typeof t.originalException&&"name"in t.originalException&&"string"==typeof t.originalException.name?null==(s=t.originalException)?void 0:s.name:"";if(gGe.includes(c))return null;for(const m of fGe)if(d.includes(m))return null;for(const{key:m,test:p,timeSec:h}of yGe)if(p({message:d,name:c})){const e=vGe.get(m),t=Date.now();if(e&&t-e<1e3*h)return null;vGe.set(m,t)}if(((null==(l=null==(r=null==(n=e.exception)?void 0:n.values)?void 0:r[0])?void 0:l.type)||"").toLowerCase()==="UnhandledRejection".toLowerCase()&&Math.random()<.95)return null;try{e.tags={...e.tags,...pGe()},e.extra={...e.extra,...await hGe()}}catch(u){console.error("Error setting Sentry tags",u)}return e},dsn:"https://a5bf03f4085d4c9eae3716d84c1869c4@sentry.io/267538",environment:"production",autoSessionTracking:!0,integrations:[new Es,new Is.BrowserTracing({routingInstrumentation:Cs(ir)})],release:"v2023.12.22.1",normalizeDepth:7,maxBreadcrumbs:10}),"undefined"!=typeof window){let e=null;bF.subscribe((()=>{const t=bF.getState(),o=au(),{_id:a}=t.currentUser.user||{},i=!!a&&o.isPaid;i!==e&&(N("pro",i),e=i)}))}}()}catch(CGe){console.error(CGe)}bGe.startsWith("localhost")||window.Cypress||!xGe.SENTRY_ENV||console.log("%cLooking for a creative challenge? Come work at Kapwing - we're hiring. kapwing.com/careers","font-weight: bold; font-size: 16px; color: #0083e2;"),window.releaseVersion="v2023.12.22.1",window.commitHash=Pr(),r.initialize(xGe.GOOGLE_ANALYTICS_CODE),r.pageview(window.location.pathname),bF.subscribe(s.throttle((()=>{PU()}),3e3)),Z.extend(ks),Z.extend(As),Z.extend(js),"undefined"==typeof window||ir||window.location.replace("/404"),window.Buffer=Ns.Buffer;const SGe=document.getElementById("root"),EGe=w.jsx(mGe,{config:xGe,store:bF});Rs.hydrateRoot(SGe,EGe),window.Cypress||"localhost"===window.location.hostname?"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch((e=>{console.error(e.message)})):function(e){if("serviceWorker"in navigator){if(new URL("/",window.location.href).origin!==window.location.origin)return;const t=()=>{const t="/service-worker.js";_Ge?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((o=>{const a=o.headers.get("content-type");404===o.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):wGe(e,t)})).catch((()=>{console.error("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):wGe(t,e)};window.addEventListener("load",t)}}({onUpdate:async e=>{console.debug("New service worker will update on page refresh."),e&&e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"})}});export{Rp as $,wD as A,Dfe as B,RF as C,Ofe as D,KO as E,wl as F,il as G,BPe as H,tl as I,A$ as J,ol as K,Y4 as L,pQ as M,Am as N,ku as O,NU as P,Bl as Q,EW as R,sh as S,ey as T,sT as U,iy as V,MY as W,MU as X,bW as Y,Ac as Z,Vl as _,a$ as a,dTe as a$,Mp as a0,gA as a1,iA as a2,nU as a3,YC as a4,JC as a5,nM as a6,MP as a7,FP as a8,zr as a9,cr as aA,om as aB,Ir as aC,Ive as aD,jc as aE,Fn as aF,Q9 as aG,cK as aH,Mn as aI,rU as aJ,bV as aK,gK as aL,eE as aM,fK as aN,Zae as aO,k0 as aP,$6 as aQ,K6 as aR,aK as aS,dr as aT,Y6 as aU,J6 as aV,_6 as aW,c7 as aX,d7 as aY,l7 as aZ,u7 as a_,A9 as aa,UP as ab,tD as ac,Bn as ad,Tc as ae,wc as af,DP as ag,xD as ah,kn as ai,Yr as aj,LP as ak,b9 as al,WP as am,c9 as an,Jr as ao,Pge as ap,Lge as aq,j9 as ar,_h as as,gh as at,aie as au,oie as av,eD as aw,gr as ax,fr as ay,SD as az,i$ as b,Oc as b$,Hc as b0,jie as b1,Die as b2,QM as b3,efe as b4,nT as b5,hEe as b6,Pp as b7,bK as b8,cO as b9,ok as bA,tk as bB,ZC as bC,yn as bD,fn as bE,Rn as bF,jf as bG,pU as bH,tZ as bI,iZ as bJ,xU as bK,Pf as bL,hU as bM,Zge as bN,vZ as bO,NZ as bP,F4 as bQ,EZ as bR,zZ as bS,Wy as bT,mZ as bU,sv as bV,GZ as bW,HW as bX,wQ as bY,Ep as bZ,PP as b_,qIe as ba,HCe as bb,tCe as bc,TK as bd,Hje as be,uD as bf,mSe as bg,uSe as bh,TW as bi,Efe as bj,aJ as bk,WY as bl,Fm as bm,ym as bn,eq as bo,LEe as bp,$B as bq,BRe as br,gW as bs,kh as bt,Eh as bu,Nn as bv,zb as bw,Vb as bx,Sv as by,nY as bz,n$ as c,sq as c$,Cl as c0,kq as c1,uQ as c2,Dp as c3,hQ as c4,pp as c5,rr as c6,sM as c7,Nie as c8,B5 as c9,XK as cA,fhe as cB,YK as cC,Ol as cD,hH as cE,fO as cF,yO as cG,bue as cH,CF as cI,jF as cJ,DB as cK,LX as cL,ph as cM,rE as cN,H_ as cO,f5 as cP,YD as cQ,Gg as cR,Wg as cS,ic as cT,N_ as cU,nu as cV,qr as cW,I6 as cX,fNe as cY,JG as cZ,pH as c_,cm as ca,oC as cb,sr as cc,X3 as cd,On as ce,G$ as cf,JP as cg,Wb as ch,Nb as ci,j$ as cj,Db as ck,Bb as cl,jb as cm,zl as cn,SK as co,l_ as cp,aY as cq,$b as cr,yu as cs,gz as ct,H5 as cu,U$ as cv,Mz as cw,eY as cx,yhe as cy,zK as cz,t$ as d,CM as d$,H$ as d0,qP as d1,Mb as d2,W$ as d3,TIe as d4,q$ as d5,jv as d6,BW as d7,Td as d8,Yn as d9,Th as dA,rSe as dB,EP as dC,RP as dD,vIe as dE,wIe as dF,EEe as dG,dSe as dH,SP as dI,_c as dJ,NTe as dK,Fp as dL,Ip as dM,Lp as dN,Np as dO,xM as dP,fW as dQ,PM as dR,Bp as dS,Op as dT,C9 as dU,Vp as dV,kM as dW,np as dX,$l as dY,HEe as dZ,Iie as d_,iY as da,Tu as db,ek as dc,Hw as dd,$w as de,LM as df,Sq as dg,xq as dh,i0 as di,a0 as dj,HJ as dk,JJ as dl,Um as dm,Cb as dn,Ob as dp,s0 as dq,n0 as dr,Cj as ds,Ev as dt,Ln as du,Gp as dv,nSe as dw,GF as dx,IP as dy,OLe as dz,r$ as e,S0 as e$,tb as e0,xfe as e1,ou as e2,pM as e3,rD as e4,AP as e5,OM as e6,_Ie as e7,bde as e8,aEe as e9,AM as eA,Ju as eB,Gl as eC,Gm as eD,iEe as eE,hr as eF,qs as eG,Ws as eH,NM as eI,Qu as eJ,Ul as eK,Il as eL,bn as eM,DM as eN,qu as eO,$c as eP,EM as eQ,Ic as eR,Sc as eS,IM as eT,SM as eU,sW as eV,bP as eW,_Q as eX,sU as eY,Lc as eZ,Lg as e_,oEe as ea,TEe as eb,jP as ec,Xr as ed,Nc as ee,RM as ef,$_e as eg,PF as eh,Up as ei,_M as ej,Du as ek,Hl as el,NP as em,Wn as en,jM as eo,kl as ep,$Ee as eq,Wp as er,Al as es,eme as et,YEe as eu,Eje as ev,sEe as ew,aD as ex,rW as ey,iD as ez,l$ as f,sY as f$,Oz as f0,_E as f1,_x as f2,Aq as f3,VG as f4,Oq as f5,zq as f6,YG as f7,GG as f8,BG as f9,An as fA,xm as fB,M$ as fC,RU as fD,VX as fE,hR as fF,oE as fG,sC as fH,HX as fI,$X as fJ,v9 as fK,_9 as fL,Un as fM,bM as fN,lf as fO,ep as fP,kP as fQ,wM as fR,Yp as fS,kye as fT,qye as fU,oK as fV,Hu as fW,yK as fX,Pl as fY,Fl as fZ,vK as f_,UG as fa,M_ as fb,af as fc,tf as fd,nh as fe,tR as ff,ch as fg,qg as fh,Ps as fi,rh as fj,lh as fk,XV as fl,Tb as fm,xb as fn,_b as fo,wb as fp,vS as fq,mQ as fr,Lb as fs,r0 as ft,kb as fu,Uge as fv,P4 as fw,xIe as fx,jm as fy,F_ as fz,o$ as g,UH as g$,Rl as g0,jl as g1,Nl as g2,Ml as g3,ff as g4,bm as g5,al as g6,OI as g7,aR as g8,vC as g9,Mv as gA,Xd as gB,bj as gC,ej as gD,DBe as gE,oS as gF,pE as gG,O4 as gH,lT as gI,rR as gJ,bE as gK,kj as gL,Iv as gM,Cpe as gN,Epe as gO,uC as gP,Sb as gQ,Kf as gR,qpe as gS,sf as gT,FS as gU,US as gV,BS as gW,MS as gX,xS as gY,CH as gZ,C_ as g_,bb as ga,Kn as gb,yC as gc,yb as gd,GB as ge,cV as gf,OW as gg,ffe as gh,hfe as gi,k9 as gj,zg as gk,Hr as gl,$ae as gm,Yg as gn,yj as go,T3 as gp,Pj as gq,Dj as gr,Hae as gs,hB as gt,fz as gu,UW as gv,kQ as gw,Md as gx,Tp as gy,tC as gz,d$ as h,LS as h$,Nw as h0,VS as h1,S1 as h2,QJ as h3,e2 as h4,Mg as h5,_1 as h6,w1 as h7,A3 as h8,LE as h9,Rx as hA,Pv as hB,Dv as hC,ez as hD,gL as hE,n_ as hF,W_ as hG,dc as hH,ed as hI,xu as hJ,wk as hK,uL as hL,gp as hM,qS as hN,XS as hO,YS as hP,uI as hQ,I3 as hR,iB as hS,RS as hT,a4 as hU,DQ as hV,j3 as hW,VJ as hX,bJ as hY,R_ as hZ,E3 as h_,dz as ha,FE as hb,N3 as hc,Zu as hd,S_ as he,DS as hf,Ru as hg,F1 as hh,o_ as hi,fI as hj,jE as hk,Mm as hl,xJ as hm,IJ as hn,gR as ho,Jv as hp,bC as hq,HN as hr,hz as hs,G_ as ht,gf as hu,n5 as hv,s5 as hw,PS as hx,fT as hy,Lle as hz,c$ as i,_ae as i$,Ux as i0,jR as i1,PR as i2,AR as i3,LR as i4,wR as i5,OR as i6,qm as i7,ex as i8,Bx as i9,SB as iA,K$ as iB,$$ as iC,E5 as iD,ud as iE,bc as iF,pye as iG,Jf as iH,vae as iI,Oge as iJ,Aj as iK,Che as iL,MWe as iM,Y$ as iN,Tfe as iO,jn as iP,Cve as iQ,Ihe as iR,$ye as iS,Spe as iT,KD as iU,BL as iV,kc as iW,vc as iX,IK as iY,dY as iZ,rhe as i_,uk as ia,TS as ib,SJ as ic,qv as id,FR as ie,wx as ig,$R as ih,ck as ii,Hm as ij,d5 as ik,Zz as il,mD as im,Fv as io,l5 as ip,Az as iq,Qz as ir,B_ as is,L_ as it,U_ as iu,lme as iv,Kd as iw,ES as ix,tY as iy,Bm as iz,u$ as j,c_ as j$,yD as j0,PU as j1,aL as j2,zpe as j3,L$ as j4,Qae as j5,Hn as j6,Fae as j7,Gn as j8,Lae as j9,O9 as jA,fM as jB,L9 as jC,P9 as jD,hd as jE,zs as jF,bD as jG,D9 as jH,hh as jI,Qr as jJ,PX as jK,$oe as jL,ZBe as jM,XBe as jN,FL as jO,ML as jP,NSe as jQ,jSe as jR,DSe as jS,ld as jT,h8 as jU,pK as jV,hK as jW,qn as jX,xB as jY,kr as jZ,Zr as j_,mK as ja,Eb as jb,zf as jc,EK as jd,$n as je,xhe as jf,iS as jg,gX as jh,yX as ji,j0 as jj,lr as jk,M9 as jl,V9 as jm,Voe as jn,Loe as jo,Woe as jp,Koe as jq,Goe as jr,Hoe as js,su as jt,U9 as ju,F9 as jv,nfe as jw,R9 as jx,N9 as jy,ir as jz,m$ as k,d3 as k$,cz as k0,aq as k1,i2 as k2,Jz as k3,iq as k4,nE as k5,lp as k6,AB as k7,Kb as k8,AN as k9,wz as kA,Cr as kB,gT as kC,Fg as kD,qj as kE,Qj as kF,NJ as kG,o4 as kH,Kg as kI,yH as kJ,YO as kK,e5 as kL,Q3 as kM,SZ as kN,hv as kO,tme as kP,EJ as kQ,Ype as kR,Qpe as kS,Jpe as kT,R5 as kU,rf as kV,oc as kW,W5 as kX,V5 as kY,G5 as kZ,c5 as k_,B$ as ka,zv as kb,N$ as kc,lS as kd,CK as ke,_u as kf,tc as kg,pD as kh,rw as ki,O_ as kj,Fz as kk,xv as kl,Tv as km,XN as kn,cE as ko,jWe as kp,NWe as kq,qje as kr,GD as ks,Zg as kt,PJ as ku,Hv as kv,$v as kw,Kv as kx,lR as ky,dR as kz,p$ as l,u3 as l$,kv as l0,Xb as l1,Qb as l2,xye as l3,z3 as l4,xE as l5,$S as l6,rT as l7,ih as l8,td as l9,t5 as lA,SS as lB,ik as lC,IS as lD,rk as lE,kS as lF,wS as lG,NS as lH,jS as lI,f3 as lJ,gJ as lK,OJ as lL,pk as lM,qVe as lN,XVe as lO,K3 as lP,u0 as lQ,m0 as lR,mk as lS,sk as lT,PL as lU,i5 as lV,UR as lW,nk as lX,$5 as lY,Ud as lZ,Bd as l_,gc as la,uj as lb,lj as lc,LA as ld,OA as le,O5 as lf,h5 as lg,P5 as lh,Tye as li,HA as lj,dk as lk,WS as ll,ME as lm,lk as ln,J3 as lo,q3 as lp,u5 as lq,Y3 as lr,CS as ls,D_ as lt,P_ as lu,b_ as lv,f_ as lw,OS as lx,m5 as ly,a5 as lz,h$ as m,ON as m$,p3 as m0,h3 as m1,Xpe as m2,d4 as m3,AS as m4,zN as m5,s_ as m6,r_ as m7,E_ as m8,sc as m9,mS as mA,NN as mB,PN as mC,jN as mD,RN as mE,ay as mF,rL as mG,Kz as mH,VWe as mI,UWe as mJ,BWe as mK,nn as mL,sn as mM,an as mN,lNe as mO,GM as mP,QBe as mQ,eVe as mR,wN as mS,Hj as mT,FN as mU,mC as mV,gC as mW,hp as mX,up as mY,TN as mZ,zj as m_,i_ as ma,hw as mb,I_ as mc,v_ as md,vhe as me,wue as mf,yS as mg,x5 as mh,Tf as mi,bf as mj,yr as mk,k8 as ml,X_ as mm,ohe as mn,hl as mo,KS as mp,GS as mq,HS as mr,cp as ms,En as mt,Zn as mu,k1 as mv,wE as mw,YN as mx,ZN as my,sS as mz,g$ as n,bX as n$,IA as n0,LN as n1,Lce as n2,yUe as n3,mz as n4,RR as n5,NR as n6,ER as n7,IR as n8,gx as n9,I4 as nA,mY as nB,w0 as nC,Fx as nD,Yl as nE,bR as nF,DR as nG,lI as nH,p_ as nI,z2 as nJ,yI as nK,cc as nL,IE as nM,gI as nN,vd as nO,kI as nP,wI as nQ,CI as nR,nI as nS,Lz as nT,Fle as nU,Gs as nV,Pz as nW,Iz as nX,EQ as nY,Nz as nZ,Rz as n_,Nx as na,vx as nb,xR as nc,SR as nd,KN as ne,kN as nf,qN as ng,Dl as nh,fC as ni,pR as nj,Sj as nk,MI as nl,Dne as nm,GW as nn,vR as no,_R as np,um as nq,vI as nr,QE as ns,g0 as nt,iR as nu,v0 as nv,_0 as nw,dI as nx,r1 as ny,U2 as nz,f$ as o,iJ as o$,V1 as o0,B1 as o1,U1 as o2,kJ as o3,CJ as o4,wJ as o5,BJ as o6,MJ as o7,RJ as o8,gk as o9,AQ as oA,jQ as oB,Hx as oC,PQ as oD,MO as oE,Dz as oF,iT as oG,aT as oH,op as oI,IQ as oJ,bQ as oK,pc as oL,Vn as oM,hb as oN,xK as oO,XY as oP,VY as oQ,tJ as oR,eJ as oS,RQ as oT,NQ as oU,pJ as oV,mJ as oW,OO as oX,FO as oY,LO as oZ,nJ as o_,rm as oa,Ou as ob,$N as oc,HR as od,GR as oe,BR as of,VR as og,WR as oh,rI as oi,BE as oj,_I as ok,D0 as ol,x0 as om,B0 as on,cx as oo,bI as op,TI as oq,xI as or,SI as os,EI as ot,PI as ou,Kx as ov,$x as ow,yx as ox,EX as oy,pw as oz,y$ as p,tw as p$,sJ as p0,$C as p1,KC as p2,zC as p3,m_ as p4,Gx as p5,b1 as p6,T1 as p7,DE as p8,h0 as p9,hC as pA,MN as pB,pC,cY as pD,Jae as pE,Rv as pF,lL as pG,Ys as pH,MQ as pI,Q_ as pJ,Ix as pK,Bh as pL,zk as pM,Of as pN,uU as pO,Rf as pP,sZ as pQ,mU as pR,wU as pS,TU as pT,Sf as pU,vU as pV,Yh as pW,kf as pX,Ig as pY,TA as pZ,kA as p_,Z3 as pa,HI as pb,SQ as pc,jj as pd,Zs as pe,Qs as pf,tn as pg,en as ph,on as pi,Ll as pj,Xg as pk,aB as pl,$g as pm,Nj as pn,Hs as po,Jx as pp,qx as pq,y_ as pr,Iu as ps,zx as pt,dx as pu,II as pv,Yx as pw,_J as px,QU as py,SN as pz,_$ as q,uZ as q$,YA as q0,A5 as q1,rA as q2,nA as q3,M5 as q4,nK as q5,uK as q6,Dge as q7,In as q8,cD as q9,kre as qA,Cre as qB,Are as qC,Ire as qD,qX as qE,JX as qF,Ore as qG,Fc as qH,kse as qI,Sn as qJ,Ld as qK,Sde as qL,yse as qM,GX as qN,WX as qO,xc as qP,UX as qQ,Ede as qR,Yxe as qS,Kxe as qT,zxe as qU,dE as qV,pZ as qW,lJ as qX,oU as qY,cZ as qZ,Hy as q_,Sfe as qa,bk as qb,CL as qc,zVe as qd,HVe as qe,Ik as qf,kL as qg,jA as qh,fk as qi,dm as qj,vk as qk,yk as ql,uA as qm,hc as qn,dw as qo,WL as qp,pl as qq,zce as qr,UN as qs,ef as qt,$D as qu,WW as qv,WG as qw,Lq as qx,FM as qy,jre as qz,w$ as r,TX as r$,dZ as r0,Vy as r1,wZ as r2,LZ as r3,My as r4,jy as r5,AZ as r6,rv as r7,WZ as r8,BZ as r9,fv as rA,hle as rB,yle as rC,vle as rD,Xn as rE,sle as rF,BUe as rG,Sle as rH,Tle as rI,BX as rJ,lw as rK,jX as rL,Lre as rM,rd as rN,Fre as rO,DX as rP,MX as rQ,RX as rR,Tm as rS,zoe as rT,kD as rU,hO as rV,Moe as rW,Uoe as rX,Boe as rY,lz as rZ,or as r_,iv as ra,KZ as rb,M4 as rc,VZ as rd,tv as re,Yy as rf,Cx as rg,oR as rh,tI as ri,$I as rj,Y2 as rk,SX as rl,FX as rm,Ooe as rn,xX as ro,NX as rp,p0 as rq,Mre as rr,dle as rs,NW as rt,cle as ru,pv as rv,fle as rw,URe as rx,mv as ry,tle as rz,b$ as s,DN as s$,Pr as s0,iw as s1,Rr as s2,IX as s3,fx as s4,Qx as s5,CC as s6,j5 as s7,p5 as s8,UC as s9,Sr as sA,S5 as sB,rj as sC,KA as sD,pL as sE,Qn as sF,AC as sG,Er as sH,b5 as sI,nN as sJ,zre as sK,ile as sL,zT as sM,YX as sN,XX as sO,Dre as sP,GA as sQ,MC as sR,sw as sS,pj as sT,vA as sU,RC as sV,zA as sW,hL as sX,mc as sY,QO as sZ,XO as s_,_C as sa,fU as sb,ak as sc,Ek as sd,Tk as se,NA as sf,KVe as sg,$A as sh,uc as si,wC as sj,rN as sk,FUe as sl,id as sm,sd as sn,nd as so,FC as sp,jC as sq,ew as sr,w5 as ss,Nr as st,hj as su,y5 as sv,mj as sw,DA as sx,nj as sy,aj as sz,T$ as t,SE as t$,qT as t0,kC as t1,cL as t2,eL as t3,ZO as t4,tL as t5,fL as t6,L5 as t7,oL as t8,ZS as t9,rY as tA,qE as tB,Ej as tC,uz as tD,CY as tE,TJ as tF,WN as tG,y4 as tH,VN as tI,m3 as tJ,Zp as tK,v4 as tL,Eu as tM,yY as tN,sR as tO,aE as tP,xY as tQ,f4 as tR,FJ as tS,cS as tT,K_ as tU,z_ as tV,Xv as tW,fY as tX,vY as tY,yc as tZ,x1 as t_,AX as ta,ow as tb,ln as tc,rn as td,aw as te,dn as tf,cn as tg,of as th,lQ as ti,pbe as tj,_d as tk,x_ as tl,k_ as tm,zm as tn,TH as to,xH as tp,bH as tq,_n as tr,cu as ts,Gfe as tt,Yf as tu,Qm as tv,Km as tw,fS as tx,Pu as ty,WB as tz,s$ as u,kK as u$,R4 as u0,wle as u1,ele as u2,Yre as u3,Ug as u4,c0 as u5,xz as u6,sI as u7,bye as u8,lE as u9,T_ as uA,nR as uB,eR as uC,LJ as uD,Y5 as uE,q5 as uF,Q5 as uG,e4 as uH,Z5 as uI,X5 as uJ,z5 as uK,J5 as uL,NI as uM,JA as uN,cC as uO,_ue as uP,cw as uQ,one as uR,zde as uS,$de as uT,Kde as uU,nDe as uV,Jn as uW,h_ as uX,iK as uY,q6 as uZ,eie as u_,w3 as ua,g3 as ub,UE as uc,IN as ud,sE as ue,WQ as uf,__ as ug,fR as uh,iI as ui,FI as uj,LI as uk,yR as ul,_5 as um,v5 as un,BC as uo,Z_ as up,LC as uq,pY as ur,qQ as us,D4 as ut,WBe as uu,Nu as uv,BN as uw,w4 as ux,Jme as uy,Cv as uz,x$ as v,C2 as v$,yl as v0,qf as v1,GN as v2,v3,_3 as v4,dfe as v5,u_e as v6,ND as v7,GO as v8,dF as v9,Cn as vA,yp as vB,Rie as vC,hSe as vD,gS as vE,tNe as vF,Y_ as vG,J_ as vH,er as vI,wn as vJ,Ipe as vK,HB as vL,sN as vM,N5 as vN,fSe as vO,Mge as vP,tr as vQ,gSe as vR,U5 as vS,WK as vT,UK as vU,fue as vV,Ql as vW,zh as vX,Mh as vY,Uh as vZ,UI as v_,nF as va,rF as vb,xw as vc,pu as vd,g_ as ve,hD as vf,cU as vg,oJ as vh,lD as vi,sL as vj,gw as vk,jD as vl,RD as vm,$J as vn,vM as vo,Mr as vp,Qp as vq,Sw as vr,_ye as vs,fp as vt,ID as vu,CD as vv,vp as vw,_p as vx,th as vy,Ow as vz,S$ as w,YVe as w0,jL as w1,NL as w2,Xl as w3,R1 as w4,az as w5,ad as w6,rz as w7,nz as w8,QK as w9,j1 as wa,ZJ as wb,L1 as wc,ac as wd,E$ as x,AD as y,mh as z};
//# sourceMappingURL=index-666560ee.js.map
